/*! For license information please see ml5.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ml5=t():e.ml5=t()}(self,(()=>(()=>{var __webpack_modules__={513:function(e,t,n){(function(){"use strict";var e;function t(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},i=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function o(e,t){if(t)e:{var n=i;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];if(!(a in n))break e;n=n[a]}(t=t(o=n[e=e[e.length-1]]))!=o&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}function a(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function s(e){var n="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return n?n.call(e):{next:t(e)}}function u(e){if(!(e instanceof Array)){e=s(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}o("Symbol",(function(e){function t(e,t){this.h=e,r(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.h};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+i++,r)}})),o("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var n="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),o=0;o<n.length;o++){var s=i[n[o]];"function"==typeof s&&"function"!=typeof s.prototype[e]&&r(s.prototype,e,{configurable:!0,writable:!0,value:function(){return a(t(this))}})}return e}));var l="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};o("Object.assign",(function(e){return e||l}));var c,p="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)c=Object.setPrototypeOf;else{var d;e:{var h={};try{h.__proto__={a:!0},d=h.a;break e}catch(e){}d=!1}c=d?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var f=c;function g(e,t){if(e.prototype=p(t.prototype),e.prototype.constructor=e,f)f(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.za=t.prototype}function m(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function y(e){if(e.m)throw new TypeError("Generator is already running");e.m=!0}function b(e,t){e.l={ma:t,na:!0},e.h=e.s||e.v}function v(e,t,n){return e.h=n,{value:t}}function x(e){this.h=new m,this.i=e}function _(e,t,n,r){try{var i=t.call(e.h.j,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.h.m=!1,i;var o=i.value}catch(t){return e.h.j=null,b(e.h,t),w(e)}return e.h.j=null,r.call(e.h,o),w(e)}function w(e){for(;e.h.h;)try{var t=e.i(e.h);if(t)return e.h.m=!1,{value:t.value,done:!1}}catch(t){e.h.i=void 0,b(e.h,t)}if(e.h.m=!1,e.h.l){if(t=e.h.l,e.h.l=null,t.na)throw t.ma;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function k(e){this.next=function(t){return y(e.h),e.h.j?t=_(e,e.h.j.next,t,e.h.u):(e.h.u(t),t=w(e)),t},this.throw=function(t){return y(e.h),e.h.j?t=_(e,e.h.j.throw,t,e.h.u):(b(e.h,t),t=w(e)),t},this.return=function(t){return function(e,t){y(e.h);var n=e.h.j;return n?_(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.h.return):(e.h.return(t),w(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function S(e){return function(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise((function(r,i){!function e(o){o.done?r(o.value):Promise.resolve(o.value).then(t,n).then(e,i)}(e.next())}))}(new k(new x(e)))}function C(e){return e||Array.prototype.fill}m.prototype.u=function(e){this.i=e},m.prototype.return=function(e){this.l={return:e},this.h=this.v},o("Promise",(function(e){function t(e){this.i=0,this.j=void 0,this.h=[],this.u=!1;var t=this.l();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.h=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.i=function(e){if(null==this.h){this.h=[];var t=this;this.j((function(){t.m()}))}this.h.push(e)};var o=i.setTimeout;n.prototype.j=function(e){o(e,0)},n.prototype.m=function(){for(;this.h&&this.h.length;){var e=this.h;this.h=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.l(e)}}}this.h=null},n.prototype.l=function(e){this.j((function(){throw e}))},t.prototype.l=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.I),reject:e(this.m)}},t.prototype.I=function(e){if(e===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.L(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.F(e):this.s(e)}},t.prototype.F=function(e){var t=void 0;try{t=e.then}catch(e){return void this.m(e)}"function"==typeof t?this.M(t,e):this.s(e)},t.prototype.m=function(e){this.v(2,e)},t.prototype.s=function(e){this.v(1,e)},t.prototype.v=function(e,t){if(0!=this.i)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.i);this.i=e,this.j=t,2===this.i&&this.K(),this.H()},t.prototype.K=function(){var e=this;o((function(){if(e.D()){var t=i.console;void 0!==t&&t.error(e.j)}}),1)},t.prototype.D=function(){if(this.u)return!1;var e=i.CustomEvent,t=i.Event,n=i.dispatchEvent;return void 0===n||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=i.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.j,n(e))},t.prototype.H=function(){if(null!=this.h){for(var e=0;e<this.h.length;++e)a.i(this.h[e]);this.h=null}};var a=new n;return t.prototype.L=function(e){var t=this.l();e.T(t.resolve,t.reject)},t.prototype.M=function(e,t){var n=this.l();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){o(e)}}:t}var i,o,a=new t((function(e,t){i=e,o=t}));return this.T(r(e,i),r(n,o)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.T=function(e,t){function n(){switch(r.i){case 1:e(r.j);break;case 2:t(r.j);break;default:throw Error("Unexpected state: "+r.i)}}var r=this;null==this.h?a.i(n):this.h.push(n),this.u=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var i=s(e),o=i.next();!o.done;o=i.next())r(o.value).T(t,n)}))},t.all=function(e){var n=s(e),i=n.next();return i.done?r([]):new t((function(e,t){function o(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).T(o(a.length-1),t),i=n.next()}while(!i.done)}))},t})),o("Array.prototype.keys",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e){return e}))}})),o("Array.prototype.fill",(function(e){return e||function(e,t,n){var r=this.length||0;for(0>t&&(t=Math.max(0,r+t)),(null==n||n>r)&&(n=r),0>(n=Number(n))&&(n=Math.max(0,r+n)),t=Number(t||0);t<n;t++)this[t]=e;return this}})),o("Int8Array.prototype.fill",C),o("Uint8Array.prototype.fill",C),o("Uint8ClampedArray.prototype.fill",C),o("Int16Array.prototype.fill",C),o("Uint16Array.prototype.fill",C),o("Int32Array.prototype.fill",C),o("Uint32Array.prototype.fill",C),o("Float32Array.prototype.fill",C),o("Float64Array.prototype.fill",C),o("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),o("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length;for(0>(t=t||0)&&(t=Math.max(t+r,0));t<r;t++){var i=n[t];if(i===e||Object.is(i,e))return!0}return!1}})),o("String.prototype.includes",(function(e){return e||function(e,t){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(e,t||0)}}));var M=this||self;function T(e,t){e=e.split(".");var n,r=M;e[0]in r||void 0===r.execScript||r.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}function E(e){var t;return(t=M.navigator)&&(t=t.userAgent)||(t=""),-1!=t.indexOf(e)}var A=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=Array(n),i="string"==typeof e?e.split(""):e,o=0;o<n;o++)o in i&&(r[o]=t.call(void 0,i[o],o,e));return r},F={},O=null;function R(){if(!O){O={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=e.concat(t[n].split(""));F[n]=r;for(var i=0;i<r.length;i++){var o=r[i];void 0===O[o]&&(O[o]=i)}}}}var N="undefined"!=typeof Uint8Array,D=!(E("Trident")||E("MSIE"))&&"function"==typeof M.btoa;function I(e){if(!D){var t;void 0===t&&(t=0),R(),t=F[t];for(var n=Array(Math.floor(e.length/3)),r=t[64]||"",i=0,o=0;i<e.length-2;i+=3){var a=e[i],s=e[i+1],u=e[i+2],l=t[a>>2];a=t[(3&a)<<4|s>>4],s=t[(15&s)<<2|u>>6],u=t[63&u],n[o++]=l+a+s+u}switch(l=0,u=r,e.length-i){case 2:u=t[(15&(l=e[i+1]))<<2]||r;case 1:e=e[i],n[o]=t[e>>2]+t[(3&e)<<4|l>>4]+u+r}return n.join("")}for(t="";10240<e.length;)t+=String.fromCharCode.apply(null,e.subarray(0,10240)),e=e.subarray(10240);return t+=String.fromCharCode.apply(null,e),btoa(t)}var B,L=RegExp("[-_.]","g");function P(e){switch(e){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function $(e){if(!D)return function(e){var t=e.length,n=3*t/4;n%3?n=Math.floor(n):-1!="=.".indexOf(e[t-1])&&(n=-1!="=.".indexOf(e[t-2])?n-2:n-1);var r=new Uint8Array(n),i=0;return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=O[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}R();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;t(i<<2|o>>4),64!=a&&(t(o<<4&240|a>>2),64!=s&&t(a<<6&192|s))}}(e,(function(e){r[i++]=e})),i!==n?r.subarray(0,i):r}(e);L.test(e)&&(e=e.replace(L,P)),e=atob(e);for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function z(){return B||(B=new Uint8Array(0))}var j={},G="function"==typeof Uint8Array.prototype.slice,U=0,W=0;function V(e){var t=0>e,n=(e=Math.abs(e))>>>0;e=Math.floor((e-n)/4294967296),t&&(t=(n=s(X(n,e))).next().value,e=n.next().value,n=t),U=n>>>0,W=e>>>0}var H,q="function"==typeof BigInt;function X(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}function Y(e,t){this.i=e>>>0,this.h=t>>>0}function K(e){if(!e)return H||(H=new Y(0,0));if(!/^-?\d+$/.test(e))return null;if(16>e.length)V(Number(e));else if(q)e=BigInt(e),U=Number(e&BigInt(4294967295))>>>0,W=Number(e>>BigInt(32)&BigInt(4294967295));else{var t=+("-"===e[0]);W=U=0;for(var n=e.length,r=t,i=(n-t)%6+t;i<=n;r=i,i+=6)r=Number(e.slice(r,i)),W*=1e6,4294967296<=(U=1e6*U+r)&&(W+=U/4294967296|0,U%=4294967296);t&&(e=(t=s(X(U,W))).next().value,t=t.next().value,U=e,W=t)}return new Y(U,W)}function J(e,t){return Error("Invalid wire type: "+e+" (at position "+t+")")}function Z(){return Error("Failed to read varint, encoding is invalid.")}function Q(e,t){return Error("Tried to read past the end of the data "+t+" > "+e)}function ee(){throw Error("Invalid UTF8")}function te(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}var ne,re,ie,oe=void 0,ae="undefined"!=typeof TextDecoder,se="undefined"!=typeof TextEncoder;function ue(e){if(e!==j)throw Error("illegal external caller")}function le(e,t){if(ue(t),this.V=e,null!=e&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}function ce(){return ie||(ie=new le(null,j))}function pe(e){ue(j);var t=e.V;return null==(t=null==t||N&&null!=t&&t instanceof Uint8Array?t:"string"==typeof t?$(t):null)?t:e.V=t}function de(e,t){this.i=null,this.m=!1,this.h=this.j=this.l=0,he(this,e,t)}function he(e,t,n){n=void 0===n?{}:n,e.S=void 0!==n.S&&n.S,t&&(t=function(e){if("string"==typeof e)return{buffer:$(e),C:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),C:!1};if(e.constructor===Uint8Array)return{buffer:e,C:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),C:!1};if(e.constructor===le)return{buffer:pe(e)||z(),C:!0};if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}(t),e.i=t.buffer,e.m=t.C,e.l=0,e.j=e.i.length,e.h=e.l)}function fe(e,t){if(e.h=t,t>e.j)throw Q(e.j,t)}function ge(e){var t=e.i,n=e.h,r=t[n++],i=127&r;if(128&r&&(i|=(127&(r=t[n++]))<<7,128&r&&(i|=(127&(r=t[n++]))<<14,128&r&&(i|=(127&(r=t[n++]))<<21,128&r&&(i|=(r=t[n++])<<28,128&r&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++])))))throw Z();return fe(e,n),i}function me(e,t){if(0>t)throw Error("Tried to read a negative byte length: "+t);var n=e.h,r=n+t;if(r>e.j)throw Q(t,e.j-n);return e.h=r,n}de.prototype.reset=function(){this.h=this.l};var ye=[];function be(){this.h=[]}function ve(e,t,n){for(;0<n||127<t;)e.h.push(127&t|128),t=(t>>>7|n<<25)>>>0,n>>>=7;e.h.push(t)}function xe(e,t){for(;127<t;)e.h.push(127&t|128),t>>>=7;e.h.push(t)}function _e(e,t){if(ye.length){var n=ye.pop();he(n,e,t),e=n}else e=new de(e,t);this.h=e,this.j=this.h.h,this.i=this.l=-1,this.setOptions(t)}function we(e){var t=e.h;if(t.h==t.j)return!1;e.j=e.h.h;var n=ge(e.h)>>>0;if(t=n>>>3,!(0<=(n&=7)&&5>=n))throw J(n,e.j);if(1>t)throw Error("Invalid field number: "+t+" (at position "+e.j+")");return e.l=t,e.i=n,!0}function ke(e){switch(e.i){case 0:if(0!=e.i)ke(e);else e:{for(var t=(e=e.h).h,n=t+10,r=e.i;t<n;)if(0==(128&r[t++])){fe(e,t);break e}throw Z()}break;case 1:fe(e=e.h,e.h+8);break;case 2:2!=e.i?ke(e):(t=ge(e.h)>>>0,fe(e=e.h,e.h+t));break;case 5:fe(e=e.h,e.h+4);break;case 3:for(t=e.l;;){if(!we(e))throw Error("Unmatched start-group tag: stream EOF");if(4==e.i){if(e.l!=t)throw Error("Unmatched end-group tag");break}ke(e)}break;default:throw J(e.i,e.j)}}be.prototype.length=function(){return this.h.length},be.prototype.end=function(){var e=this.h;return this.h=[],e},_e.prototype.setOptions=function(e){e=void 0===e?{}:e,this.ca=void 0!==e.ca&&e.ca},_e.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};var Se=[];function Ce(){this.j=[],this.i=0,this.h=new be}function Me(e,t){0!==t.length&&(e.j.push(t),e.i+=t.length)}var Te="function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol():void 0;function Ee(e,t){return Te?e[Te]|=t:void 0!==e.A?e.A|=t:(Object.defineProperties(e,{A:{value:t,configurable:!0,writable:!0,enumerable:!1}}),t)}function Ae(e,t){Te?e[Te]&&(e[Te]&=~t):void 0!==e.A&&(e.A&=~t)}function Fe(e){var t;return null==(t=Te?e[Te]:e.A)?0:t}function Oe(e,t){Te?e[Te]=t:void 0!==e.A?e.A=t:Object.defineProperties(e,{A:{value:t,configurable:!0,writable:!0,enumerable:!1}})}function Re(e){return Ee(e,1),e}function Ne(e,t){Oe(t,-51&(0|e))}function De(e,t){Oe(t,-41&(18|e))}var Ie={};function Be(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)&&e.constructor===Object}var Le,Pe,$e=[];function ze(e){if(2&Fe(e.o))throw Error("Cannot mutate an immutable Message")}function je(e){var t=e.length;(t=t?e[t-1]:void 0)&&Be(t)?t.g=1:(t={},e.push((t.g=1,t)))}function Ge(e){var t=e.i+e.G;return e.B||(e.B=e.o[t]={})}function Ue(e,t){return-1===t?null:t>=e.i?e.B?e.B[t]:void 0:e.o[t+e.G]}function We(e,t,n,r){ze(e),Ve(e,t,n,r)}function Ve(e,t,n,r){e.j&&(e.j=void 0),t>=e.i||r?Ge(e)[t]=n:(e.o[t+e.G]=n,(e=e.B)&&t in e&&delete e[t])}function He(e,t,n,r){var i=Ue(e,t);Array.isArray(i)||(i=Le);var o=Fe(i);if(1&o||Re(i),r)2&o||Ee(i,2),1&n||Object.freeze(i);else{r=!(2&n);var a=2&o;1&n||!a?r&&16&o&&!a&&Ae(i,16):Ve(e,t,i=Re(Array.prototype.slice.call(i)))}return i}function qe(e,t){var n=Ue(e,t),r=null==n?n:"number"==typeof n||"NaN"===n||"Infinity"===n||"-Infinity"===n?Number(n):void 0;return null!=r&&r!==n&&Ve(e,t,r),r}function Xe(e,t,n,r,i){e.h||(e.h={});var o=e.h[n],a=He(e,n,3,i);if(!o){var s=a;o=[];var u=!!(16&Fe(e.o));a=!!(2&Fe(s));var l=s;!i&&a&&(s=Array.prototype.slice.call(s));for(var c=a,p=0;p<s.length;p++){var d=s[p],h=t,f=!1;if(f=void 0!==f&&f,void 0!==(d=Array.isArray(d)?new h(d):f?new h:void 0)){var g=f=Fe(h=d.o);a&&(g|=2),u&&(g|=16),g!=f&&Oe(h,g),h=g,c=c||!!(2&h),o.push(d)}}return e.h[n]=o,t=33|(u=Fe(s)),u!=(t=c?-9&t:8|t)&&(c=s,Object.isFrozen(c)&&(c=Array.prototype.slice.call(c)),Oe(c,t),s=c),l!==s&&Ve(e,n,s),(i||r&&a)&&Ee(o,2),r&&Object.freeze(o),o}return i||(i=Object.isFrozen(o),r&&!i?Object.freeze(o):!r&&i&&(o=Array.prototype.slice.call(o),e.h[n]=o)),o}function Ye(e,t,n){var r=!!(2&Fe(e.o));if(t=Xe(e,t,n,r,r),e=He(e,n,3,r),!(r||8&Fe(e))){for(r=0;r<t.length;r++){if(2&Fe((n=t[r]).o)){var i=st(n,!1);i.j=n}else i=n;n!==i&&(t[r]=i,e[r]=i.o)}Ee(e,8)}return t}function Ke(e,t,n){if(null!=n&&"number"!=typeof n)throw Error("Value of float/double field must be a number|null|undefined, found "+typeof n+": "+n);We(e,t,n)}function Je(e,t,n,r,i){ze(e);var o=Xe(e,n,t,!1,!1);return n=null!=r?r:new n,e=He(e,t,2,!1),null!=i?(o.splice(i,0,n),e.splice(i,0,n.o)):(o.push(n),e.push(n.o)),n.C()&&Ae(e,8),n}function Ze(e,t){return null==e?t:e}function Qe(e,t,n){return n=void 0===n?0:n,Ze(qe(e,t),n)}function et(e,t,n,r){if(null!=e){if(Array.isArray(e))e=tt(e,t,n,void 0!==r);else if(Be(e)){var i,o={};for(i in e)o[i]=et(e[i],t,n,r);e=o}else e=t(e,r);return e}}function tt(e,t,n,r){var i=Fe(e);r=r?!!(16&i):void 0,e=Array.prototype.slice.call(e);for(var o=0;o<e.length;o++)e[o]=et(e[o],t,n,r);return n(i,e),e}function nt(e){return e.ja===Ie?e.toJSON():function(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"object":if(e)if(Array.isArray(e)){if(0!=(128&Fe(e)))return je(e=Array.prototype.slice.call(e)),e}else{if(N&&null!=e&&e instanceof Uint8Array)return I(e);if(e instanceof le){var t=e.V;return null==t?"":"string"==typeof t?t:e.V=I(t)}}}return e}(e)}function rt(e,t){128&e&&je(t)}function it(e,t,n){if(n=void 0===n?De:n,null!=e){if(N&&e instanceof Uint8Array)return e.length?new le(new Uint8Array(e),j):ce();if(Array.isArray(e)){var r=Fe(e);return 2&r?e:!t||32&r||!(16&r||0===r)?(4&(t=Fe(e=tt(e,it,4&r?De:n,!0)))&&2&t&&Object.freeze(e),e):(Oe(e,2|r),e)}return e.ja===Ie?at(e):e}}function ot(e,t,n,r,i,o,a){if(e=e.h&&e.h[n]){if(2&(r=Fe(e))?r=e:(De(r,o=A(e,at)),Object.freeze(o),r=o),ze(t),a=null==r?Le:Re([]),null!=r){for(o=!!r.length,e=0;e<r.length;e++){var s=r[e];o=o&&!(2&Fe(s.o)),a[e]=s.o}o=1|(o?8:0),((e=Fe(a))&o)!==o&&(Object.isFrozen(a)&&(a=Array.prototype.slice.call(a)),Oe(a,e|o)),t.h||(t.h={}),t.h[n]=r}else t.h&&(t.h[n]=void 0);Ve(t,n,a,i)}else We(t,n,it(r,o,a),i)}function at(e){return 2&Fe(e.o)||Ee((e=st(e,!0)).o,2),e}function st(e,t){var n=e.o,r=[];Ee(r,16);var i=e.constructor.h;if(i&&r.push(i),i=e.B){r.length=n.length,r.fill(void 0,r.length,n.length);var o={};r[r.length-1]=o}0!=(128&Fe(n))&&je(r),t=t||e.C()?De:Ne,o=e.constructor,Pe=r,r=new o(r),Pe=void 0,e.R&&(r.R=e.R.slice()),o=!!(16&Fe(n));for(var a=i?n.length-1:n.length,s=0;s<a;s++)ot(e,r,s-e.G,n[s],!1,o,t);if(i)for(var u in i)ot(e,r,+u,i[u],!0,o,t);return r}function ut(e,t,n){null==e&&(e=Pe),Pe=void 0;var r,i=this.constructor.i||0,o=0<i,a=this.constructor.h,s=!1;if(null==e){var u=48,l=!0;o&&(i=0,u|=128),Oe(e=a?[a]:[],u)}else{if(!Array.isArray(e))throw Error();if(a&&a!==e[0])throw Error();var c=u=Ee(e,0);if((l=0!=(16&c))&&((s=0!=(32&c))||(c|=32)),o){if(128&c)i=0;else if(0<e.length){var p=e[e.length-1];if(Be(p)&&"g"in p){i=0,c|=128,delete p.g;var d,h=!0;for(d in p){h=!1;break}h&&e.pop()}}}else if(128&c)throw Error();u!==c&&Oe(e,c)}if(this.G=(a?0:-1)-i,this.h=void 0,this.o=e,i=(a=this.o.length)-1,a&&Be(a=this.o[i])?(this.B=a,this.i=i-this.G):void 0!==t&&-1<t?(this.i=Math.max(t,i+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE,!o&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(n)for(t=l&&!s&&!0,o=this.i,l=0;l<n.length;l++)(s=n[l])<o?(i=e[s+=this.G])?lt(i,t):e[s]=Le:(r||(r=Ge(this)),(i=r[s])?lt(i,t):r[s]=Le)}function lt(e,t){if(Array.isArray(e)){var n=Fe(e),r=1;!t||2&n||(r|=16),(n&r)!==r&&Oe(e,n|r)}}function ct(e,t,n){if(n){var r,i={};for(r in n){var o=n[r],a=o.ra;a||(i.J=o.xa||o.oa.W,o.ia?(i.aa=bt(o.ia),a=function(e){return function(t,n,r){return e.J(t,n,r,e.aa)}}(i)):o.ka?(i.Z=vt(o.da.P,o.ka),a=function(e){return function(t,n,r){return e.J(t,n,r,e.Z)}}(i)):a=i.J,o.ra=a),a(t,e,o.da),i={J:i.J,aa:i.aa,Z:i.Z}}}!function(e,t){if(t=t.R){Me(e,e.h.end());for(var n=0;n<t.length;n++)Me(e,pe(t[n])||z())}}(t,e)}Oe($e,23),Le=Object.freeze($e),ut.prototype.toJSON=function(){return tt(this.o,nt,rt)},ut.prototype.C=function(){return!!(2&Fe(this.o))},ut.prototype.ja=Ie,ut.prototype.toString=function(){return this.o.toString()};var pt=Symbol();function dt(e,t,n){return e[pt]||(e[pt]=function(e,r){return t(e,r,n)})}function ht(e){var t=e[pt];if(!t){var n=Ot(e);t=function(e,t){return Rt(e,t,n)},e[pt]=t}return t}function ft(e){var t=function(e){var t=e.ia;return t?ht(t):(t=e.wa)?dt(e.da.P,t,e.ka):void 0}(e),n=e.da,r=e.oa.U;return t?function(e,i){return r(e,i,n,t)}:function(e,t){return r(e,t,n)}}function gt(e,t){var n=e[t];return"function"==typeof n&&0===n.length&&(n=n(),e[t]=n),Array.isArray(n)&&(Mt in n||xt in n||0<n.length&&"function"==typeof n[0])?n:void 0}function mt(e,t,n,r,i,o){t.P=e[0];var a=1;if(e.length>a&&"number"!=typeof e[a]){var s=e[a++];n(t,s)}for(;a<e.length;){n=e[a++];for(var u=a+1;u<e.length&&"number"!=typeof e[u];)u++;switch(s=e[a++],u-=a){case 0:r(t,n,s);break;case 1:(u=gt(e,a))?(a++,i(t,n,s,u)):r(t,n,s,e[a++]);break;case 2:i(t,n,s,u=gt(e,u=a++),e[a++]);break;case 3:o(t,n,s,e[a++],e[a++],e[a++]);break;case 4:o(t,n,s,e[a++],e[a++],e[a++],e[a++]);break;default:throw Error("unexpected number of binary field arguments: "+u)}}return t}var yt=Symbol();function bt(e){var t=e[yt];if(!t){var n=Ct(e);t=function(e,t){return Nt(e,t,n)},e[yt]=t}return t}function vt(e,t){var n=e[yt];return n||(n=function(e,n){return ct(e,n,t)},e[yt]=n),n}var xt=Symbol();function _t(e,t){e.push(t)}function wt(e,t,n){e.push(t,n.W)}function kt(e,t,n,r){var i=bt(r),o=Ct(r).P,a=n.W;e.push(t,(function(e,t,n){return a(e,t,n,o,i)}))}function St(e,t,n,r,i,o){var a=vt(r,o),s=n.W;e.push(t,(function(e,t,n){return s(e,t,n,r,a)}))}function Ct(e){var t=e[xt];return t||(t=mt(e,e[xt]=[],_t,wt,kt,St),Mt in e&&xt in e&&(e.length=0),t)}var Mt=Symbol();function Tt(e,t){e[0]=t}function Et(e,t,n,r){var i=n.U;e[t]=r?function(e,t,n){return i(e,t,n,r)}:i}function At(e,t,n,r,i){var o=n.U,a=ht(r),s=Ot(r).P;e[t]=function(e,t,n){return o(e,t,n,s,a,i)}}function Ft(e,t,n,r,i,o,a){var s=n.U,u=dt(r,i,o);e[t]=function(e,t,n){return s(e,t,n,r,u,a)}}function Ot(e){var t=e[Mt];return t||(t=mt(e,e[Mt]={},Tt,Et,At,Ft),Mt in e&&xt in e&&(e.length=0),t)}function Rt(e,t,n){for(;we(t)&&4!=t.i;){var r=t.l,i=n[r];if(!i){var o=n[0];o&&(o=o[r])&&(i=n[r]=ft(o))}if(!i||!i(t,e,r)){r=e,o=(i=t).j,ke(i);var a=i;if(!a.ca){if(i=a.h.h-o,a.h.h=o,a=a.h,0==i)i=ce();else{if(o=me(a,i),a.S&&a.m)i=a.i.subarray(o,o+i);else{a=a.i;var s=o;i=s===(i=o+i)?z():G?a.slice(s,i):new Uint8Array(a.subarray(s,i))}i=0==i.length?ce():new le(i,j)}(o=r.R)?o.push(i):r.R=[i]}}}return e}function Nt(e,t,n){for(var r=n.length,i=1==r%2,o=i?1:0;o<r;o+=2)(0,n[o+1])(t,e,n[o]);ct(e,t,i?n[0]:void 0)}function Dt(e,t){return{U:e,W:t}}var It=Dt((function(e,t,n){if(5!==e.i)return!1;var r=(e=e.h).i,i=e.h,o=r[i],a=r[i+1],s=r[i+2];return r=r[i+3],fe(e,e.h+4),e=2*((a=(o<<0|a<<8|s<<16|r<<24)>>>0)>>31)+1,o=a>>>23&255,a&=8388607,We(t,n,255==o?a?NaN:1/0*e:0==o?e*Math.pow(2,-149)*a:e*Math.pow(2,o-150)*(a+Math.pow(2,23))),!0}),(function(e,t,n){if(null!=(t=qe(t,n))){xe(e.h,8*n+5),e=e.h;var r=+t;0===r?0<1/r?U=W=0:(W=0,U=2147483648):isNaN(r)?(W=0,U=2147483647):34028234663852886e22<(r=(n=0>r?-2147483648:0)?-r:r)?(W=0,U=(2139095040|n)>>>0):11754943508222875e-54>r?(r=Math.round(r/Math.pow(2,-149)),W=0,U=(n|r)>>>0):(t=Math.floor(Math.log(r)/Math.LN2),r*=Math.pow(2,-t),16777216<=(r=Math.round(8388608*r))&&++t,W=0,U=(n|t+127<<23|8388607&r)>>>0),n=U,e.h.push(n>>>0&255),e.h.push(n>>>8&255),e.h.push(n>>>16&255),e.h.push(n>>>24&255)}})),Bt=Dt((function(e,t,n){if(0!==e.i)return!1;var r=e.h,i=0,o=e=0,a=r.i,s=r.h;do{var u=a[s++];i|=(127&u)<<o,o+=7}while(32>o&&128&u);for(32<o&&(e|=(127&u)>>4),o=3;32>o&&128&u;o+=7)e|=(127&(u=a[s++]))<<o;if(fe(r,s),!(128>u))throw Z();return r=i>>>0,(e=2147483648&(u=e>>>0))&&(u=~u>>>0,0==(r=1+~r>>>0)&&(u=u+1>>>0)),r=4294967296*u+(r>>>0),We(t,n,e?-r:r),!0}),(function(e,t,n){null!=(t=Ue(t,n))&&("string"==typeof t&&K(t),null!=t&&(xe(e.h,8*n),"number"==typeof t?(e=e.h,V(t),ve(e,U,W)):(n=K(t),ve(e.h,n.i,n.h))))})),Lt=Dt((function(e,t,n){return 0===e.i&&(We(t,n,ge(e.h)),!0)}),(function(e,t,n){if(null!=(t=Ue(t,n))&&null!=t)if(xe(e.h,8*n),e=e.h,0<=(n=t))xe(e,n);else{for(t=0;9>t;t++)e.h.push(127&n|128),n>>=7;e.h.push(1)}})),Pt=Dt((function(e,t,n){if(2!==e.i)return!1;var r=ge(e.h)>>>0,i=me(e=e.h,r);if(e=e.i,ae){var o,a=e;(o=ne)||(o=ne=new TextDecoder("utf-8",{fatal:!0})),e=i+r,a=0===i&&e===a.length?a:a.subarray(i,e);try{var s=o.decode(a)}catch(e){if(void 0===oe){try{o.decode(new Uint8Array([128]))}catch(e){}try{o.decode(new Uint8Array([97])),oe=!0}catch(e){oe=!1}}throw!oe&&(ne=void 0),e}}else{r=(s=i)+r,i=[];for(var u,l,c=null;s<r;)128>(u=e[s++])?i.push(u):224>u?s>=r?ee():(l=e[s++],194>u||128!=(192&l)?(s--,ee()):i.push((31&u)<<6|63&l)):240>u?s>=r-1?ee():128!=(192&(l=e[s++]))||224===u&&160>l||237===u&&160<=l||128!=(192&(a=e[s++]))?(s--,ee()):i.push((15&u)<<12|(63&l)<<6|63&a):244>=u?s>=r-2?ee():128!=(192&(l=e[s++]))||0!=l-144+(u<<28)>>30||128!=(192&(a=e[s++]))||128!=(192&(o=e[s++]))?(s--,ee()):(u=(7&u)<<18|(63&l)<<12|(63&a)<<6|63&o,u-=65536,i.push(55296+(u>>10&1023),56320+(1023&u))):ee(),8192<=i.length&&(c=te(c,i),i.length=0);s=te(c,i)}return We(t,n,s),!0}),(function(e,t,n){if(null!=(t=Ue(t,n))){var r=!1;if(r=void 0!==r&&r,se){if(r&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(t))throw Error("Found an unpaired surrogate");t=(re||(re=new TextEncoder)).encode(t)}else{for(var i=0,o=new Uint8Array(3*t.length),a=0;a<t.length;a++){var s=t.charCodeAt(a);if(128>s)o[i++]=s;else{if(2048>s)o[i++]=s>>6|192;else{if(55296<=s&&57343>=s){if(56319>=s&&a<t.length){var u=t.charCodeAt(++a);if(56320<=u&&57343>=u){s=1024*(s-55296)+u-56320+65536,o[i++]=s>>18|240,o[i++]=s>>12&63|128,o[i++]=s>>6&63|128,o[i++]=63&s|128;continue}a--}if(r)throw Error("Found an unpaired surrogate");s=65533}o[i++]=s>>12|224,o[i++]=s>>6&63|128}o[i++]=63&s|128}}t=i===o.length?o:o.subarray(0,i)}xe(e.h,8*n+2),xe(e.h,t.length),Me(e,e.h.end()),Me(e,t)}})),$t=Dt((function(e,t,n,r,i){if(2!==e.i)return!1;t=Je(t,n,r),n=e.h.j,r=ge(e.h)>>>0;var o=e.h.h+r,a=o-n;if(0>=a&&(e.h.j=o,i(t,e,void 0,void 0,void 0),a=o-e.h.h),a)throw Error("Message parsing ended unexpectedly. Expected to read "+r+" bytes, instead read "+(r-a)+" bytes, either the data ended unexpectedly or the message misreported its own length");return e.h.h=o,e.h.j=n,!0}),(function(e,t,n,r,i){if(null!=(t=Ye(t,r,n)))for(r=0;r<t.length;r++){var o=e;xe(o.h,8*n+2);var a=o.h.end();Me(o,a),a.push(o.i),o=a,i(t[r],e),a=e;var s=o.pop();for(s=a.i+a.h.length()-s;127<s;)o.push(127&s|128),s>>>=7,a.i++;o.push(s),a.i++}}));function zt(e){return function(t,n){e:{if(Se.length){var r=Se.pop();r.setOptions(n),he(r.h,t,n),t=r}else t=new _e(t,n);try{var i=Ot(e),o=Rt(new i.P,t,i);break e}finally{(i=t.h).i=null,i.m=!1,i.l=0,i.j=0,i.h=0,i.S=!1,t.l=-1,t.i=-1,100>Se.length&&Se.push(t)}o=void 0}return o}}function jt(e){return function(){var t=new Ce;Nt(this,t,Ct(e)),Me(t,t.h.end());for(var n=new Uint8Array(t.i),r=t.j,i=r.length,o=0,a=0;a<i;a++){var s=r[a];n.set(s,o),o+=s.length}return t.j=[n],n}}function Gt(e){ut.call(this,e)}g(Gt,ut);var Ut=[Gt,1,Lt,2,It,3,Pt,4,Pt];function Wt(e){ut.call(this,e,-1,Vt)}Gt.prototype.l=jt(Ut),g(Wt,ut),Wt.prototype.addClassification=function(e,t){return Je(this,1,Gt,e,t),this};var Vt=[1],Ht=zt([Wt,1,$t,Ut]);function qt(e){ut.call(this,e)}g(qt,ut);var Xt=[qt,1,It,2,It,3,It,4,It,5,It];function Yt(e){ut.call(this,e,-1,Kt)}qt.prototype.l=jt(Xt),g(Yt,ut);var Kt=[1],Jt=zt([Yt,1,$t,Xt]);function Zt(e){ut.call(this,e)}g(Zt,ut);var Qt=[Zt,1,It,2,It,3,It,4,It,5,It,6,Bt],en=zt(Qt);function tn(e,t,n){if(n=e.createShader(0===n?e.VERTEX_SHADER:e.FRAGMENT_SHADER),e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+e.getShaderInfoLog(n));return n}function nn(e){return Ye(e,Gt,1).map((function(e){var t=Ue(e,1);return{index:null==t?0:t,qa:Qe(e,2),label:null!=Ue(e,3)?Ze(Ue(e,3),""):void 0,displayName:null!=Ue(e,4)?Ze(Ue(e,4),""):void 0}}))}function rn(e){return{x:Qe(e,1),y:Qe(e,2),z:Qe(e,3),visibility:null!=qe(e,4)?Qe(e,4):void 0}}function on(e,t){this.i=e,this.h=t,this.m=0}function an(e,t,n){return function(e,t){var n=e.h;if(void 0===e.s){var r=tn(n,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),i=tn(n,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),o=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+n.getProgramInfoLog(o));r=e.s=o,n.useProgram(r),i=n.getUniformLocation(r,"sampler0"),e.l={O:n.getAttribLocation(r,"aVertex"),N:n.getAttribLocation(r,"aTex"),ya:i},e.v=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.v),n.enableVertexAttribArray(e.l.O),n.vertexAttribPointer(e.l.O,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),e.u=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.u),n.enableVertexAttribArray(e.l.N),n.vertexAttribPointer(e.l.N,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.uniform1i(i,0)}r=e.l,n.useProgram(e.s),n.canvas.width=t.width,n.canvas.height=t.height,n.viewport(0,0,t.width,t.height),n.activeTexture(n.TEXTURE0),e.i.bindTexture2d(t.glName),n.enableVertexAttribArray(r.O),n.bindBuffer(n.ARRAY_BUFFER,e.v),n.vertexAttribPointer(r.O,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.N),n.bindBuffer(n.ARRAY_BUFFER,e.u),n.vertexAttribPointer(r.N,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER?n.DRAW_FRAMEBUFFER:n.FRAMEBUFFER,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.colorMask(!0,!0,!0,!0),n.drawArrays(n.TRIANGLE_FAN,0,4),n.disableVertexAttribArray(r.O),n.disableVertexAttribArray(r.N),n.bindBuffer(n.ARRAY_BUFFER,null),e.i.bindTexture2d(0)}(e,t),"function"==typeof e.h.canvas.transferToImageBitmap?Promise.resolve(e.h.canvas.transferToImageBitmap()):n?Promise.resolve(e.h.canvas):"function"==typeof createImageBitmap?createImageBitmap(e.h.canvas):(void 0===e.j&&(e.j=document.createElement("canvas")),new Promise((function(t){e.j.height=e.h.canvas.height,e.j.width=e.h.canvas.width,e.j.getContext("2d",{}).drawImage(e.h.canvas,0,0,e.h.canvas.width,e.h.canvas.height),t(e.j)})))}function sn(e){this.h=e}Zt.prototype.l=jt(Qt);var un=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function ln(e,t){return t+e}function cn(e,t){window[e]=t}function pn(e){if(this.h=e,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=e&&e.locateFile||ln,"object"==typeof window)var t=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if("undefined"==typeof location)throw Error("solutions can only be loaded on a web page or in a web worker");t=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.ha=t,e.options)for(var n=(t=s(Object.keys(e.options))).next();!n.done;n=t.next()){n=n.value;var r=e.options[n].default;void 0!==r&&(this.l[n]="function"==typeof r?r():r)}}function dn(e,t){var n,r;return S((function(i){return t in e.L?i.return(e.L[t]):(n=e.locateFile(t,""),r=fetch(n).then((function(e){return e.arrayBuffer()})),e.L[t]=r,i.return(r))}))}function hn(e,t){for(var n=t.name||"$",r=[].concat(u(t.wants)),i=new e.i.StringList,o=s(t.wants),a=o.next();!a.done;a=o.next())i.push_back(a.value);o=e.i.PacketListener.implement({onResults:function(i){for(var o={},a=0;a<t.wants.length;++a)o[r[a]]=i.get(a);var u=e.listeners[n];u&&(e.I=function(e,t,n){var r,i,o,a,u,l,c,p,d,h,f,g,m,y;return S((function(b){switch(b.h){case 1:if(!n)return b.return(t);for(r={},i=0,o=s(Object.keys(n)),a=o.next();!a.done;a=o.next())u=a.value,"string"!=typeof(l=n[u])&&"texture"===l.type&&void 0!==t[l.stream]&&++i;1<i&&(e.M=!1),c=s(Object.keys(n)),a=c.next();case 2:if(a.done){b.h=4;break}if(p=a.value,"string"==typeof(d=n[p]))return m=r,y=p,v(b,function(e,t,n){var r;return S((function(i){return"number"==typeof n||n instanceof Uint8Array||n instanceof e.i.Uint8BlobList?i.return(n):n instanceof e.i.Texture2dDataOut?((r=e.v[t])||(r=new on(e.i,e.K),e.v[t]=r),i.return(an(r,n,e.M))):i.return(void 0)}))}(e,p,t[d]),14);if(h=t[d.stream],"detection_list"===d.type){if(h){for(var x=h.getRectList(),_=h.getLandmarksList(),w=h.getClassificationsList(),k=[],C=0;C<x.size();++C){var M=en(x.get(C)),T=void 0;T=void 0===T?0:T,M={la:{sa:Qe(M,1),ta:Qe(M,2),height:Qe(M,3),width:Qe(M,4),rotation:Qe(M,5,0),pa:Ze(Ue(M,6),T)},ea:Ye(Jt(_.get(C)),qt,1).map(rn),ba:nn(Ht(w.get(C)))},k.push(M)}x=k}else x=[];r[p]=x,b.h=7;break}if("proto_list"===d.type){if(h){for(x=Array(h.size()),_=0;_<h.size();_++)x[_]=h.get(_);h.delete()}else x=[];r[p]=x,b.h=7;break}if(void 0===h){b.h=3;break}if("float_list"===d.type){r[p]=h,b.h=7;break}if("proto"===d.type){r[p]=h,b.h=7;break}if("texture"!==d.type)throw Error("Unknown output config type: '"+d.type+"'");return(f=e.v[p])||(f=new on(e.i,e.K),e.v[p]=f),v(b,an(f,h,e.M),13);case 13:g=b.i,r[p]=g;case 7:d.transform&&r[p]&&(r[p]=d.transform(r[p])),b.h=3;break;case 14:m[y]=b.i;case 3:a=c.next(),b.h=2;break;case 4:return b.return(r)}}))}(e,o,t.outs).then((function(n){n=u(n);for(var i=0;i<t.wants.length;++i){var a=o[r[i]];"object"==typeof a&&a.hasOwnProperty&&a.hasOwnProperty("delete")&&a.delete()}n&&(e.I=n)})))}}),e.j.attachMultiListener(i,o),i.delete()}function fn(e){return void 0===e&&(e=0),1===e?"selfie_segmentation_landscape.tflite":"selfie_segmentation.tflite"}function gn(e){var t=this;e=e||{},this.h=new pn({locateFile:e.locateFile,files:function(e){return[{simd:!0,url:"selfie_segmentation_solution_simd_wasm_bin.js"},{simd:!1,url:"selfie_segmentation_solution_wasm_bin.js"},{data:!0,url:fn(e.modelSelection)}]},graph:{url:"selfie_segmentation.binarypb"},listeners:[{wants:["segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"object"==typeof window&&void 0!==window.navigator&&("iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelSelection:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelSelection",fieldName:"int_value"},onChange:function(e){var n,r,i;return S((function(o){return 1==o.h?(n=fn(e),r="third_party/mediapipe/modules/selfie_segmentation/"+n,v(o,dn(t.h,n),2)):(i=o.i,t.h.overrideFile(r,i),o.return(!0))}))}}}})}(e=pn.prototype).close=function(){return this.j&&this.j.delete(),Promise.resolve()},e.reset=function(){var e=this;return S((function(t){e.j&&(e.j.reset(),e.s={},e.v={}),t.h=0}))},e.setOptions=function(e,t){var n=this;if(t=t||this.h.options){for(var r=[],i=[],o={},a=s(Object.keys(e)),u=a.next();!u.done;o={X:o.X,Y:o.Y},u=a.next())if(!((u=u.value)in this.l)||this.l[u]!==e[u]){this.l[u]=e[u];var l=t[u];void 0!==l&&(l.onChange&&(o.X=l.onChange,o.Y=e[u],r.push(function(e){return function(){return S((function(t){if(1==t.h)return v(t,e.X(e.Y),2);!0===t.i&&(n.u=!0),t.h=0}))}}(o))),l.graphOptionXref&&(u=Object.assign({},{calculatorName:"",calculatorIndex:0},l.graphOptionXref,{valueNumber:1===l.type?e[u]:0,valueBoolean:0===l.type&&e[u],valueString:2===l.type?e[u]:""}),i.push(u)))}0===r.length&&0===i.length||(this.u=!0,this.H=(void 0===this.H?[]:this.H).concat(i),this.F=(void 0===this.F?[]:this.F).concat(r))}},e.initialize=function(){var e=this;return S((function(t){return 1==t.h?v(t,function(e){var t,n,r,i,o,a,s,l,c,p,d;return S((function(h){switch(h.h){case 1:return e.ga?(t=void 0===e.h.files?[]:"function"==typeof e.h.files?e.h.files(e.l):e.h.files,v(h,S((function(e){switch(e.h){case 1:return e.s=2,v(e,WebAssembly.instantiate(un),4);case 4:e.h=3,e.s=0;break;case 2:return e.s=0,e.l=null,e.return(!1);case 3:return e.return(!0)}})),2)):h.return();case 2:if(n=h.i,"object"==typeof window)return cn("createMediapipeSolutionsWasm",{locateFile:e.locateFile}),cn("createMediapipeSolutionsPackedAssets",{locateFile:e.locateFile}),a=t.filter((function(e){return void 0!==e.data})),s=t.filter((function(e){return void 0===e.data})),l=Promise.all(a.map((function(t){var n=dn(e,t.url);if(void 0!==t.path){var r=t.path;n=n.then((function(t){return e.overrideFile(r,t),Promise.resolve(t)}))}return n}))),c=Promise.all(s.map((function(t){return void 0===t.simd||t.simd&&n||!t.simd&&!n?function(e){var t=document.createElement("script");return t.setAttribute("src",e),t.setAttribute("crossorigin","anonymous"),new Promise((function(e){t.addEventListener("load",(function(){e()}),!1),t.addEventListener("error",(function(){e()}),!1),document.body.appendChild(t)}))}(e.locateFile(t.url,e.ha)):Promise.resolve()}))).then((function(){var t,n,r;return S((function(i){if(1==i.h)return t=window.createMediapipeSolutionsWasm,n=window.createMediapipeSolutionsPackedAssets,r=e,v(i,t(n),2);r.i=i.i,i.h=0}))})),p=S((function(t){return e.h.graph&&e.h.graph.url?t=v(t,dn(e,e.h.graph.url),0):(t.h=0,t=void 0),t})),v(h,Promise.all([c,l,p]),7);if("function"!=typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return r=t.filter((function(e){return void 0===e.simd||e.simd&&n||!e.simd&&!n})).map((function(t){return e.locateFile(t.url,e.ha)})),importScripts.apply(null,u(r)),i=e,v(h,createMediapipeSolutionsWasm(Module),6);case 6:i.i=h.i,e.m=new OffscreenCanvas(1,1),e.i.canvas=e.m,o=e.i.GL.createContext(e.m,{antialias:!1,alpha:!1,va:"undefined"!=typeof WebGL2RenderingContext?2:1}),e.i.GL.makeContextCurrent(o),h.h=4;break;case 7:if(e.m=document.createElement("canvas"),!(d=e.m.getContext("webgl2",{}))&&!(d=e.m.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),h.return();e.K=d,e.i.canvas=e.m,e.i.createContext(e.m,!0,!0,{});case 4:e.j=new e.i.SolutionWasm,e.ga=!1,h.h=0}}))}(e),2):3!=t.h?v(t,function(e){var t,n,r,i,o,a,u,l;return S((function(c){if(1==c.h)return e.h.graph&&e.h.graph.url&&e.fa===e.h.graph.url?c.return():(e.u=!0,e.h.graph&&e.h.graph.url?(e.fa=e.h.graph.url,v(c,dn(e,e.h.graph.url),3)):void(c.h=2));for(2!=c.h&&(t=c.i,e.j.loadGraph(t)),n=s(Object.keys(e.D)),r=n.next();!r.done;r=n.next())i=r.value,e.j.overrideFile(i,e.D[i]);if(e.D={},e.h.listeners)for(o=s(e.h.listeners),a=o.next();!a.done;a=o.next())u=a.value,hn(e,u);l=e.l,e.l={},e.setOptions(l),c.h=0}))}(e),3):v(t,function(e){var t,n,r,i,o,a;return S((function(u){switch(u.h){case 1:if(!e.u)return u.return();if(!e.F){u.h=2;break}t=s(e.F),n=t.next();case 3:if(n.done){u.h=5;break}return v(u,(0,n.value)(),4);case 4:n=t.next(),u.h=3;break;case 5:e.F=void 0;case 2:if(e.H){for(r=new e.i.GraphOptionChangeRequestList,i=s(e.H),o=i.next();!o.done;o=i.next())a=o.value,r.push_back(a);e.j.changeOptions(r),r.delete(),e.H=void 0}e.u=!1,u.h=0}}))}(e),0)}))},e.overrideFile=function(e,t){this.j?this.j.overrideFile(e,t):this.D[e]=t},e.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},e.send=function(e,t){var n,r,i,o,a,u,l,c,p,d=this;return S((function(h){switch(h.h){case 1:return d.h.inputs?(n=1e3*(null==t?performance.now():t),v(h,d.I,2)):h.return();case 2:return v(h,d.initialize(),3);case 3:for(r=new d.i.PacketDataList,i=s(Object.keys(e)),o=i.next();!o.done;o=i.next())if(a=o.value,u=d.h.inputs[a]){e:{var f=e[a];switch(u.type){case"video":var g=d.s[u.stream];if(g||(g=new on(d.i,d.K),d.s[u.stream]=g),0===g.m&&(g.m=g.i.createTexture()),"undefined"!=typeof HTMLVideoElement&&f instanceof HTMLVideoElement)var m=f.videoWidth,y=f.videoHeight;else"undefined"!=typeof HTMLImageElement&&f instanceof HTMLImageElement?(m=f.naturalWidth,y=f.naturalHeight):(m=f.width,y=f.height);y={glName:g.m,width:m,height:y},(m=g.h).canvas.width=y.width,m.canvas.height=y.height,m.activeTexture(m.TEXTURE0),g.i.bindTexture2d(g.m),m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,f),g.i.bindTexture2d(0),g=y;break e;case"detections":for((g=d.s[u.stream])||(g=new sn(d.i),d.s[u.stream]=g),g.data||(g.data=new g.h.DetectionListData),g.data.reset(f.length),y=0;y<f.length;++y){m=f[y];var b=g.data,x=b.setBoundingBox,_=y,w=m.la,k=new Zt;if(Ke(k,1,w.sa),Ke(k,2,w.ta),Ke(k,3,w.height),Ke(k,4,w.width),Ke(k,5,w.rotation),We(k,6,w.pa),w=k.l(),x.call(b,_,w),m.ea)for(b=0;b<m.ea.length;++b){k=m.ea[b],_=(x=g.data).addNormalizedLandmark,w=y,k=Object.assign({},k,{visibility:k.visibility?k.visibility:0});var S=new qt;Ke(S,1,k.x),Ke(S,2,k.y),Ke(S,3,k.z),k.visibility&&Ke(S,4,k.visibility),k=S.l(),_.call(x,w,k)}if(m.ba)for(b=0;b<m.ba.length;++b)_=(x=g.data).addClassification,w=y,k=m.ba[b],Ke(S=new Gt,2,k.qa),k.index&&We(S,1,k.index),k.label&&We(S,3,k.label),k.displayName&&We(S,4,k.displayName),k=S.l(),_.call(x,w,k)}g=g.data;break e;default:g={}}}switch(l=g,c=u.stream,u.type){case"video":r.pushTexture2d(Object.assign({},l,{stream:c,timestamp:n}));break;case"detections":(p=l).stream=c,p.timestamp=n,r.pushDetectionList(p);break;default:throw Error("Unknown input config type: '"+u.type+"'")}}return d.j.send(r),v(h,d.I,4);case 4:r.delete(),h.h=0}}))},e.onResults=function(e,t){this.listeners[t||"$"]=e},T("Solution",pn),T("OptionType",{BOOL:0,NUMBER:1,ua:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(e=gn.prototype).close=function(){return this.h.close(),Promise.resolve()},e.onResults=function(e){this.h.onResults(e)},e.initialize=function(){var e=this;return S((function(t){return v(t,e.h.initialize(),0)}))},e.reset=function(){this.h.reset()},e.send=function(e){var t=this;return S((function(n){return v(n,t.h.send(e),0)}))},e.setOptions=function(e){this.h.setOptions(e)},T("SelfieSegmentation",gn),T("VERSION","0.1.1675465747")}).call(this)},8713:(e,t,n)=>{"use strict";n.d(t,{JL:()=>r,Zu:()=>i});class r{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class i{refCount(e){return o("refCount")}incRef(e){return o("incRef")}timerAvailable(){return!0}time(e){return o("time")}read(e){return o("read")}readSync(e){return o("readSync")}readToGPU(e,t){return o("readToGPU")}numDataIds(){return o("numDataIds")}disposeData(e,t){return o("disposeData")}write(e,t,n){return o("write")}move(e,t,n,r,i){return o("move")}createTensorFromGPUData(e,t,n){return o("createTensorFromGPUData")}memory(){return o("memory")}floatPrecision(){return o("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return o("dispose")}}function o(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}},3337:(e,t,n)=>{"use strict";function r(e,t,n){const r=function(e,t,n){return function(e,t,n){let r=0,i=e.length,o=0,a=!1;for(;r<i;){o=r+(i-r>>>1);const s=n(t,e[o]);s>0?r=o+1:(i=o,a=!s)}return a?r:-r-1}(e,t,n||i)}(e,t,n),o=r<0?-(r+1):r;e.splice(o,0,t)}function i(e,t){return e>t?1:e<t?-1:0}function o(e,t,n,r,i){return u(e,t,n,r,i,0)}function a(e,t,n,r,i,o){return u(e,t,n,r,i,0,!1,o,!0)}function s(e,t,n,r,i,o){return u(e,t,n,r,i,o,!0)}function u(e,t,n,i,o,a,s=!1,u=!1,d=!1){const h=[];for(let e=0;e<t.length;e++)t[e]>o&&h.push({score:t[e],boxIndex:e,suppressBeginIndex:0});h.sort(p);const f=a>0?-.5/a:0,g=[],m=[];for(;g.length<n&&h.length>0;){const t=h.pop(),{score:n,boxIndex:a,suppressBeginIndex:s}=t;if(n<o)break;let u=!1;for(let n=g.length-1;n>=s;--n){const r=l(e,a,g[n]);if(r>=i){u=!0;break}if(t.score=t.score*c(i,f,r),t.score<=o)break}t.suppressBeginIndex=g.length,u||(t.score===n?(g.push(a),m.push(t.score)):t.score>o&&r(h,t,p))}const y=g.length,b=n-y;u&&b>0&&(g.push(...new Array(b).fill(0)),m.push(...new Array(b).fill(0)));const v={selectedIndices:g};return s&&(v.selectedScores=m),d&&(v.validOutputs=y),v}function l(e,t,n){const r=e.subarray(4*t,4*t+4),i=e.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),p=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),h=(s-o)*(u-a),f=(p-l)*(d-c);if(h<=0||f<=0)return 0;const g=Math.max(o,l),m=Math.max(a,c),y=Math.min(s,p),b=Math.min(u,d),v=Math.max(y-g,0)*Math.max(b-m,0);return v/(h+f-v)}function c(e,t,n){const r=Math.exp(t*n*n);return n<=e?r:0}function p(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}n.d(t,{GP:()=>o,qP:()=>a,pA:()=>s})},8333:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(2657);function i(e,t){const n=[];for(let e=0;e<t.length;e++)t[e]&&n.push(e);const i=(0,r.f)(e,"int32"),o=(0,r.f)([n.length,e.length],"int32");for(let t=0;t<n.length;t++){const r=i.indexToLoc(n[t]),a=t*e.length;o.values.set(r,a)}return o.toTensor()}},7097:(e,t,n)=>{"use strict";n.d(t,{BV:()=>x,wv:()=>v});var r=n(8713),i=n(2885),o=n(5938),a=n(9121),s=n(6151),u=n(4706),l=n(9122),c=n(569);class p{constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new h)}profileKernel(e,t,n){let r;const o=()=>{r=n()};let a;const s=l.now();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(o);else{o();for(const e of r)e.dataSync();a=Promise.resolve({kernelMs:l.now()-s})}if((0,i.OB)().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let t=0;t<r.length;t++){const n=r[t];n.data().then((t=>{d(t,n.dtype,e)}))}return{kernelName:e,outputs:r,inputs:t,timeMs:a.then((e=>e.kernelMs)),extraInfo:a.then((e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""))}}logKernelProfile(e){const{kernelName:t,outputs:n,timeMs:r,inputs:i,extraInfo:o}=e;n.forEach((e=>{Promise.all([e.data(),r,o]).then((n=>{this.logger.logKernelProfile(t,e,n[0],n[1],i,n[2])}))}))}}function d(e,t,n){if("float32"!==t)return!1;for(let t=0;t<e.length;t++){const r=e[t];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class h{logKernelProfile(e,t,n,r,i,o){const a="number"==typeof r?c.oj(`${r}ms`,9):r.error,s=c.oj(e,25),u=t.rank,l=t.size,p=c.oj(t.shape.toString(),14);let d="";for(const e in i){const n=i[e];if(null!=n){const r=n.shape||t.shape,i=r.length;d+=`${e}: ${i}D ${i>0?r:""} `}}console.log(`%c${s}\t%c${a}\t%c${u}D ${p}\t%c${l}\t%c${d}\t%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}var f=n(4077),g=n(747);function m(e){return null!=e.kernelName}class y{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((e=>e.name))))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class b{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new y}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{const{asyncInit:t}=this.initializeBackend(e);if(t)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,n=1){return e in this.registryFactory?(u.Z(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(null==this.registryFactory[e])throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;const{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new p(this.backendInstance),!0}setupRegisteredKernels(){(0,s.tr)(this.backendName).forEach((e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(e){(0,s.tr)(e).forEach((t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])}))}initializeBackend(e){const t=this.registryFactory[e];if(null==t)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const n=t.factory();if(!n||n instanceof r.Zu||"function"!=typeof n.then)return this.registry[e]=n,{success:!0,asyncInit:!1};{const t=++this.pendingBackendInitId,r=n.then((n=>!(t<this.pendingBackendInitId||(this.registry[e]=n,this.pendingBackendInit=null,0)))).catch((n=>(t<this.pendingBackendInitId||(this.pendingBackendInit=null,u.Z(`Initialization of backend ${e} failed`),u.Z(n.stack||n.message)),!1)));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(t){return u.Z(`Initialization of backend ${e} failed`),u.Z(t.stack||t.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority))}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t],{success:r,asyncInit:i}=this.initializeBackend(n);if(i||r)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const n=this.state.tensorInfo.get(t),r=n.backend,i=this.readSync(t),o=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,i,n.shape,n.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n,r=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}return this.scopedRun((()=>this.startScope(r)),(()=>this.endScope(n)),(()=>(n=t(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n)))}scopedRun(e,t,n){e();try{const e=n();return t(),e}catch(e){throw t(),e}}nextTensorId(){return b.nextTensorId++}nextVariableId(){return b.nextVariableId++}clone(e){const t=x.runKernel(a.iJz,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(e=>({x:()=>{const t={x:e};return x.runKernel(a.RFZ,t,{dtype:"float32"})}})),[],{}),t}runKernel(e,t,n){if(null==this.backendName&&this.backend,null==(0,s.pI)(e,this.backendName))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){const r=this.backend.numDataIds();let i=0;n.forEach((e=>{i+="complex64"===e.dtype?3:1}));const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-t-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let t,n=[];const r=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;let a,u;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const l=m(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(m(e)){const{kernelName:t,inputs:i,attrs:o}=e;null==this.backendName&&this.backend;const l=(0,s.pI)(t,this.backendName);c.hu(null!=l,(()=>`Cannot find registered kernel '${t}' for backend '${this.backendName}'`)),a=()=>{const e=this.backend.numDataIds();u=l.kernelFunc({inputs:i,attrs:o,backend:this.backend});const a=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,a);const s=a.map((e=>null!=e.rank?e:this.makeTensorFromTensorInfo(e)));if(r){const e=this.getTensorsForGradient(t,i,s);n=this.saveTensorsForBackwardMode(e)}return s}}else{const{forwardFunc:t}=e,i=e=>{r&&(n=e.map((e=>this.keep(this.clone(e)))))};a=()=>{const e=this.backend.numDataIds();u=this.tidy((()=>t(this.backend,i)));const n=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,e,n),n}}const{inputs:p,attrs:d}=e,h=m(e)?null:e.backwardsFunc;let f;return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(f=this.profiler.profileKernel(l,p,(()=>a())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),t=f.outputs):t=a()})),r&&this.addTapeNode(l,p,t,h,n,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(p).map((e=>null!=p[e]?p[e].shape:null)),outputShapes:t.map((e=>e.shape)),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(u)?t:t[0]}saveTensorsForBackwardMode(e){const t=e.map((e=>this.keep(this.clone(e))));return t}getTensorsForGradient(e,t,n){const r=(0,s.uk)(e);if(null!=r){const e=r.inputsToSave||[],i=r.outputsToSave||[];let o;r.saveAllInputs?(c.hu(Array.isArray(t),(()=>"saveAllInputs is true, expected inputs to be an array.")),o=Object.keys(t).map((e=>t[e]))):o=e.map((e=>t[e]));const a=n.filter(((e,t)=>i[t]));return o.concat(a)}return[]}makeTensor(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let i=e;"string"===n&&c.HD(e[0])&&(i=e.map((e=>l.encodeString(e))));const o=r.write(i,t,n),a=new f.es(t,n,o,this.nextTensorId());if(this.trackTensor(a,r),"string"===n){const e=this.state.tensorInfo.get(o),t=(0,c.Ub)(i);this.state.numBytes+=t-e.bytes,e.bytes=t}return a}makeTensorFromDataId(e,t,n,r){const i={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,t){const{dataId:n,shape:r,dtype:i}=e,o=new f.es(r,i,n,this.nextTensorId());return this.trackTensor(o,t),o}makeVariable(e,t=!0,n,r){n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));const i=new f._w(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*c.bT(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof f._w||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){const t=e.size*c.bT(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((e=>e.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const e of this.state.activeProfile.kernels)e.kernelTimeMs=await e.kernelTimeMs,e.extraInfo=await e.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,n,r,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:i},u=(0,s.uk)(e);null!=u&&(r=u.gradFunc),null!=r&&(a.gradient=e=>(e=e.map(((e,t)=>{if(null==e){const e=n[t],r=c.wT(e.size,e.dtype);return this.makeTensor(r,e.shape,e.dtype)}return e})),r(e.length>1?e:e[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=(0,g.getTensorsInContainer)(e),n=new Set(t.map((e=>e.id)));for(let e=0;e<this.state.activeScope.track.length;e++){const t=this.state.activeScope.track[e];t.kept||n.has(t.id)||t.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach((e=>{e.kept||e.scopeId!==r.id||this.track(e)}))}gradients(e,t,n,r=!1){if(c.hu(t.length>0,(()=>"gradients() received an empty list of xs.")),null!=n&&"float32"!==n.dtype)throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);const i=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",e)));c.hu(i instanceof f.es,(()=>"The result y returned by f() must be a tensor."));const o=function(e,t,n){const r={},i={};for(let e=0;e<t.length;e++)r[t[e].id]=!0;for(let n=0;n<e.length;n++){const o=e[n],a=o.inputs;for(const e in a){const n=a[e];let s=!1;for(let e=0;e<t.length;e++)if(r[n.id]){o.outputs.forEach((e=>r[e.id]=!0)),s=!0,i[o.id]=!0;break}if(s)break}}const o={};o[n.id]=!0;const a={};for(let t=e.length-1;t>=0;t--){const n=e[t],r=n.inputs;for(let e=0;e<n.outputs.length;e++)if(o[n.outputs[e].id]){for(const e in r)o[r[e].id]=!0,a[n.id]=!0;break}}const s=[];for(let t=0;t<e.length;t++){const n=e[t];if(i[n.id]&&a[n.id]){const e={};for(const t in n.inputs){const i=n.inputs[t];r[i.id]&&(e[t]=i)}const t=Object.assign({},n);t.inputs=e,t.outputs=n.outputs,s.push(t)}}return s}(this.state.activeTape,t,i);if(!r&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{const e={};e[i.id]=null==n?function(e){const t=(0,c.p8)((0,c.NA)(e),"float32");return x.makeTensor(t,e,"float32")}(i.shape):n,function(e,t,n,r){for(let i=t.length-1;i>=0;i--){const o=t[i],a=[];if(o.outputs.forEach((t=>{const n=e[t.id];null!=n?a.push(n):a.push(null)})),null==o.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const s=o.gradient(a);for(const t in o.inputs){if(!(t in s))throw new Error(`Cannot backprop through input ${t}. Available gradients found: ${Object.keys(s)}.`);const i=n((()=>s[t]()));if("float32"!==i.dtype)throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${t} must have 'float32' dtype, but has '${i.dtype}'`);const a=o.inputs[t];if(!c.cO(i.shape,a.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${t}' has shape '${i.shape}', which does not match the shape of the input '${a.shape}'`);if(null==e[a.id])e[a.id]=i;else{const t=e[a.id];e[a.id]=r(t,i),t.dispose()}}}}(e,o,(e=>this.tidy(e)),_);const r=t.map((t=>e[t.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((e=>{for(const t of e.saved)t.dispose()})),this.state.activeTape=null),{value:i,grads:r}}))}customGrad(e){return c.hu(c.mf(e),(()=>"The f passed in customGrad(f) must be a function.")),(...t)=>{let n;c.hu(t.every((e=>e instanceof f.es)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));const r={};return t.forEach(((e,t)=>{r[t]=e})),this.runKernelFunc({forwardFunc:(r,i)=>(n=e(...t,i),c.hu(n.value instanceof f.es,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),c.hu(c.mf(n.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),n.value),backwardsFunc:(e,r)=>{const i=n.gradFunc(e,r),o=Array.isArray(i)?i:[i];c.hu(o.length===t.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),c.hu(o.every((e=>e instanceof f.es)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));const a={};return o.forEach(((e,t)=>{a[t]=()=>e})),a},inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=(0,l.now)(),n=await this.backend.time(e);return n.wallMs=(0,l.now)()-t,n}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new y;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function v(){const e=(0,o.D)();if(null==e._tfengine){const t=new i.qA(e);e._tfengine=new b(t)}return(0,i.iG)(e._tfengine.ENV),(0,f.Vi)((()=>e._tfengine)),e._tfengine}b.nextTensorId=0,b.nextVariableId=0;const x=v();function _(e,t){const n={a:e,b:t};return x.runKernel(a.mm_,n)}},2885:(e,t,n)=>{"use strict";n.d(t,{OB:()=>s,Vi:()=>u,iG:()=>l,qA:()=>o});var r=n(569);const i="tfjsflags";class o{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=a,this.populateURLFlags()}setPlatform(e,t){null!=this.platform&&(s().getBool("IS_TEST")||s().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){const t=this.urlFlags[e];s().getBool("IS_TEST")||s().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${t}.`),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if((0,r.tI)(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;const e=this.getQueryParams(this.global.location.search);i in e&&e[i].split(",").forEach((e=>{const[t,n]=e.split(":");this.urlFlags[t]=function(e,t){const n=t.toLowerCase();return"true"===n||"false"===n?"true"===n:""+ +n===n?+n:t}(0,n)}))}}function a(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,((e,...n)=>(function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,n[0],n[1]),n.join("=")))),t}function s(){return u}let u=null;function l(e){u=e}},5938:(e,t,n)=>{"use strict";let r;function i(){if(null==r){let e;if("undefined"!=typeof window)e=window;else if(void 0!==n.g)e=n.g;else if("undefined"!=typeof process)e=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}r=e}return r}function o(e,t){const n=function(){const e=i();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);{const r=t();return n.set(e,r),n.get(e)}}n.d(t,{D:()=>i,R:()=>o})},4368:(e,t,n)=>{"use strict";n.d(t,{B9:()=>m,CQ:()=>v,Cd:()=>x,Cn:()=>y,G4:()=>s,MX:()=>c,N5:()=>f,N8:()=>p,N_:()=>_,R:()=>u,SR:()=>d,VY:()=>T,XV:()=>b,cF:()=>l,cj:()=>w,jq:()=>C,lu:()=>g,sq:()=>h,x3:()=>k,y3:()=>M,ze:()=>S});var r=n(7097),i=n(2885),o=n(4077),a=n(747);function s(){(0,i.OB)().set("PROD",!0)}function u(){(0,i.OB)().set("DEBUG",!0)}function l(){(0,i.OB)().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function c(e){(0,i.OB)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function p(){r.BV.disposeVariables()}function d(){return r.BV}function h(){return r.BV.memory()}function f(e){return r.BV.profile(e)}function g(e,t){return r.BV.tidy(e,t)}function m(e){(0,a.getTensorsInContainer)(e).forEach((e=>e.dispose()))}function y(e){return r.BV.keep(e)}function b(e){return r.BV.time(e)}function v(e){return r.BV.setBackend(e)}function x(){return r.BV.ready()}function _(){return r.BV.backendName}function w(e){r.BV.removeBackend(e)}function k(e){return r.BV.findBackend(e)}function S(e){return r.BV.findBackendFactory(e)}function C(e,t,n=1){return r.BV.registerBackend(e,t,n)}function M(){return r.BV.backend}function T(e,t){(0,i.OB)().setPlatform(e,t)}(0,o.FZ)(c)},633:(e,t,n)=>{"use strict";n.d(t,{UQ:()=>s,cb:()=>d,fN:()=>c,h7:()=>l,pn:()=>p,ti:()=>u});var r=n(7097),i=n(4077),o=n(3740),a=n(569);function s(e){return a.hu(a.mf(e),(()=>"The f passed in grad(f) must be a function")),(t,n)=>{const i=(0,o._1)(t,"x","tf.grad","string_or_numeric"),s=null!=n?(0,o._1)(n,"dy","tf.grad"):null;return r.BV.tidy((()=>{const{value:t,grads:n}=r.BV.gradients((()=>e(i)),[i],s);return null!=s&&a.k5(t.shape,s.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),h(n),n[0]}))}}function u(e){return a.hu(a.mf(e),(()=>"The f passed in grads(f) must be a function")),(t,n)=>{a.hu(Array.isArray(t),(()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"));const i=(0,o.sI)(t,"args","tf.grads","string_or_numeric"),s=null!=n?(0,o._1)(n,"dy","tf.grads"):null;return r.BV.tidy((()=>{const{value:t,grads:n}=r.BV.gradients((()=>e(...i)),i,s);return null!=s&&a.k5(t.shape,s.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),h(n),n}))}}function l(e){return a.hu(a.mf(e),(()=>"The f passed in valueAndGrad(f) must be a function")),(t,n)=>{a.hu(t instanceof i.es,(()=>"The x passed in valueAndGrad(f)(x) must be a tensor")),a.hu(null==n||n instanceof i.es,(()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"));const{grads:o,value:s}=r.BV.gradients((()=>e(t)),[t],n);return h(o),{grad:o[0],value:s}}}function c(e){return a.hu(a.mf(e),(()=>"The f passed in valueAndGrads(f) must be a function")),(t,n)=>{a.hu(Array.isArray(t)&&t.every((e=>e instanceof i.es)),(()=>"The args passed in valueAndGrads(f)(args) must be array of tensors")),a.hu(null==n||n instanceof i.es,(()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"));const o=r.BV.gradients((()=>e(...t)),t,n);return null!=n&&a.k5(o.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),h(o.grads),o}}function p(e,t){a.hu(a.mf(e),(()=>"The f passed in variableGrads(f) must be a function")),a.hu(null==t||Array.isArray(t)&&t.every((e=>e instanceof i._w)),(()=>"The varList passed in variableGrads(f, varList) must be an array of variables"));const n=null!=t;if(!n){t=[];for(const e in r.BV.registeredVariables)t.push(r.BV.registeredVariables[e])}const o=n?t.filter((e=>!e.trainable)):null,s=t.length;t=t.filter((e=>e.trainable)),a.hu(t.length>0,(()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`));const{value:u,grads:l}=r.BV.gradients(e,t,null,!0);a.hu(l.some((e=>null!=e)),(()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize().")),a.hu(0===u.rank,(()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${u.rank} tensor`));const c={};return t.forEach(((e,t)=>{null!=l[t]&&(c[e.name]=l[t])})),null!=o&&o.forEach((e=>c[e.name]=null)),{value:u,grads:c}}function d(e){return r.BV.customGrad(e)}function h(e){if(e.filter((e=>null==e)).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}},9882:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Abs:()=>Ot.SYM,Acos:()=>Ot.VGw,Acosh:()=>Ot.SpW,AdadeltaOptimizer:()=>Ve,AdagradOptimizer:()=>qe,AdamOptimizer:()=>Ke,AdamaxOptimizer:()=>Qe,Add:()=>Ot.mm_,AddN:()=>Ot.Xze,All:()=>Ot.oT6,Any:()=>Ot.IKK,ArgMax:()=>Ot.sJF,ArgMin:()=>Ot.aJk,Asin:()=>Ot.M2y,Asinh:()=>Ot.qw7,Atan:()=>Ot.jMg,Atan2:()=>Ot.QCc,Atanh:()=>Ot.Oyi,AvgPool:()=>Ot.JhU,AvgPool3D:()=>Ot._k9,AvgPool3DGrad:()=>Ot.IMb,AvgPoolGrad:()=>Ot.ROF,BatchMatMul:()=>Ot.XLW,BatchToSpaceND:()=>Ot.zws,Bincount:()=>Ot.zvY,BitwiseAnd:()=>Ot.hCO,BroadcastArgs:()=>Ot.eEB,BroadcastTo:()=>Ot.Ly9,Cast:()=>Ot.RFZ,Ceil:()=>Ot.gJX,ClipByValue:()=>Ot.xnO,Complex:()=>Ot.Zz9,ComplexAbs:()=>Ot.yj2,Concat:()=>Ot.Eh3,Conv2D:()=>Ot.mhS,Conv2DBackpropFilter:()=>Ot.wUP,Conv2DBackpropInput:()=>Ot.wm,Conv3D:()=>Ot.x12,Conv3DBackpropFilterV2:()=>Ot.o2y,Conv3DBackpropInputV2:()=>Ot.ik2,Cos:()=>Ot.mc4,Cosh:()=>Ot.TR1,CropAndResize:()=>Ot.VcC,Cumprod:()=>Ot.Byc,Cumsum:()=>Ot.iHb,DataStorage:()=>Cr.JL,DenseBincount:()=>Ot.QRR,DepthToSpace:()=>Ot.T0n,DepthwiseConv2dNative:()=>Ot.cie,DepthwiseConv2dNativeBackpropFilter:()=>Ot.sL$,DepthwiseConv2dNativeBackpropInput:()=>Ot.y7R,Diag:()=>Ot.$w,Dilation2D:()=>Ot.p4S,Dilation2DBackpropFilter:()=>Ot.Vn9,Dilation2DBackpropInput:()=>Ot.ekb,Draw:()=>Ot.hGc,ENV:()=>b.Vi,Einsum:()=>Ot.$g6,Elu:()=>Ot.SX0,EluGrad:()=>Ot.HEU,Environment:()=>b.qA,Equal:()=>Ot.hdR,Erf:()=>Ot.Omj,Exp:()=>Ot.NEP,ExpandDims:()=>Ot.YFo,Expm1:()=>Ot.Y0y,FFT:()=>Ot.vwp,Fill:()=>Ot.deh,FlipLeftRight:()=>Ot.Uyb,Floor:()=>Ot.OR,FloorDiv:()=>Ot.jeX,FromPixels:()=>Ot.eBW,FusedBatchNorm:()=>Ot.sHE,FusedConv2D:()=>Ot._V0,FusedDepthwiseConv2D:()=>Ot.luS,GatherNd:()=>Ot.q1x,GatherV2:()=>Ot.qi_,Greater:()=>Ot.iZT,GreaterEqual:()=>Ot.Acj,IFFT:()=>Ot.Qg5,Identity:()=>Ot.iJz,Imag:()=>Ot.J_u,IsFinite:()=>Ot.avt,IsInf:()=>Ot.iWB,IsNan:()=>Ot.r7n,KernelBackend:()=>Cr.Zu,LRN:()=>Ot.eZ0,LRNGrad:()=>Ot.Hhh,LeakyRelu:()=>Ot.J$2,Less:()=>Ot.vtC,LessEqual:()=>Ot.CAk,LinSpace:()=>Ot.e7N,Log:()=>Ot.ZbH,Log1p:()=>Ot.kU,LogSoftmax:()=>Ot.qCd,LogicalAnd:()=>Ot.PYm,LogicalNot:()=>Ot.VfG,LogicalOr:()=>Ot.MZg,LogicalXor:()=>Ot.w6g,LowerBound:()=>Ot.qIC,MatrixBandPart:()=>Ot.J7O,Max:()=>Ot.YoZ,MaxPool:()=>Ot.mTV,MaxPool3D:()=>Ot.OAf,MaxPool3DGrad:()=>Ot.OU7,MaxPoolGrad:()=>Ot.OV7,MaxPoolWithArgmax:()=>Ot.vFR,Maximum:()=>Ot.BMI,Mean:()=>Ot.q2K,Min:()=>Ot.c17,Minimum:()=>Ot.q8u,MirrorPad:()=>Ot.jQs,Mod:()=>Ot.Vbg,MomentumOptimizer:()=>tt,Multinomial:()=>Ot.NZg,Multiply:()=>Ot.wYn,Neg:()=>Ot.kuV,NonMaxSuppressionV3:()=>Ot.uv1,NonMaxSuppressionV4:()=>Ot.cye,NonMaxSuppressionV5:()=>Ot.W0H,NotEqual:()=>Ot.yQU,OP_SCOPE_SUFFIX:()=>cn.zvA,OneHot:()=>Ot.we_,OnesLike:()=>Ot.qWM,Optimizer:()=>We,OptimizerConstructors:()=>un,Pack:()=>Ot.QiL,PadV2:()=>Ot.lyA,Pool:()=>Ot.Kgp,Pow:()=>Ot.pe_,Prelu:()=>Ot.o0g,Prod:()=>Ot.DlI,RMSPropOptimizer:()=>nt,RaggedGather:()=>Ot.dDz,RaggedRange:()=>Ot.CQl,RaggedTensorToTensor:()=>Ot.BiW,Range:()=>Ot.e6w,Rank:()=>ln.yw,Real:()=>Ot.xJR,RealDiv:()=>Ot.oHH,Reciprocal:()=>Ot.$HU,Reduction:()=>pn.I,Relu:()=>Ot.qkr,Relu6:()=>Ot.SbG,Reshape:()=>Ot.HZH,ResizeBilinear:()=>Ot._Yw,ResizeBilinearGrad:()=>Ot.zbQ,ResizeNearestNeighbor:()=>Ot.dpD,ResizeNearestNeighborGrad:()=>Ot.Hmb,Reverse:()=>Ot.mKl,RotateWithOffset:()=>Ot.b9H,Round:()=>Ot.e07,Rsqrt:()=>Ot.bV0,SGDOptimizer:()=>et,ScatterNd:()=>Ot.xQA,SearchSorted:()=>Ot.nr8,Select:()=>Ot.PhF,Selu:()=>Ot.oFR,Sigmoid:()=>Ot.a5O,Sign:()=>Ot.i5y,Sin:()=>Ot.RQH,Sinh:()=>Ot.wYB,Slice:()=>Ot.p2w,Softmax:()=>Ot.Gcp,Softplus:()=>Ot.MRv,SpaceToBatchND:()=>Ot.TQc,SparseFillEmptyRows:()=>Ot.O3z,SparseReshape:()=>Ot.nhH,SparseSegmentMean:()=>Ot.w3H,SparseSegmentSum:()=>Ot.ZjV,SparseToDense:()=>Ot.D2d,SplitV:()=>Ot.L8s,Sqrt:()=>Ot.FKq,Square:()=>Ot.bK0,SquaredDifference:()=>Ot._tC,StaticRegexReplace:()=>Ot.e0R,Step:()=>Ot.h8e,StridedSlice:()=>Ot.jQk,StringNGrams:()=>Ot._JP,StringSplit:()=>Ot.s1s,StringToHashBucketFast:()=>Ot.XkS,Sub:()=>Ot.Tr8,Sum:()=>Ot.GBy,Tan:()=>Ot.sEM,Tanh:()=>Ot.MIZ,Tensor:()=>Te.es,TensorBuffer:()=>Te.YD,TensorScatterUpdate:()=>Ot.SIB,Tile:()=>Ot.n9L,TopK:()=>Ot.cWu,Transform:()=>Ot.wx7,Transpose:()=>Ot.G3Y,Unique:()=>Ot.kpP,Unpack:()=>Ot.ToN,UnsortedSegmentSum:()=>Ot.Qvg,UpperBound:()=>Ot.XDQ,Variable:()=>Te._w,ZerosLike:()=>Ot.RuY,_FusedMatMul:()=>Ot.usg,abs:()=>cn.WnP,acos:()=>cn.Khb,acosh:()=>cn.__u,add:()=>cn.IHx,addN:()=>cn.QBD,all:()=>cn.$6P,any:()=>cn.YjB,argMax:()=>cn.NqF,argMin:()=>cn.vHJ,asin:()=>cn.ZRM,asinh:()=>cn.VfV,atan:()=>cn.z4N,atan2:()=>cn.fvJ,atanh:()=>cn.C80,avgPool:()=>cn.wS1,avgPool3d:()=>cn.uR5,backend:()=>Ae.y3,backend_util:()=>p,basicLSTMCell:()=>cn.zEQ,batchNorm:()=>cn.tgs,batchNorm2d:()=>cn.Dxk,batchNorm3d:()=>cn.JY5,batchNorm4d:()=>cn.p3b,batchToSpaceND:()=>cn.E4h,bincount:()=>cn.yE8,bitwiseAnd:()=>cn.ycw,booleanMaskAsync:()=>cn.anm,broadcastArgs:()=>cn.XsQ,broadcastTo:()=>cn.UFq,broadcast_util:()=>Ft,browser:()=>s,buffer:()=>cn.f3b,cast:()=>cn.pju,ceil:()=>cn.mDi,clipByValue:()=>cn.iUl,clone:()=>cn.d9v,complex:()=>cn.PYB,concat:()=>cn.zoF,concat1d:()=>cn.gME,concat2d:()=>cn.Izb,concat3d:()=>cn.MNy,concat4d:()=>cn.ZaL,conv1d:()=>cn.PAt,conv2d:()=>cn.Tek,conv2dTranspose:()=>cn.bc,conv3d:()=>cn.pdZ,conv3dTranspose:()=>cn.$QV,copyRegisteredKernels:()=>Rt.T3,cos:()=>cn.mCk,cosh:()=>cn.f9Y,cosineWindow:()=>cn.mew,cumprod:()=>cn.$Gn,cumsum:()=>cn.zbp,customGrad:()=>Be.cb,denseBincount:()=>cn.ppE,deprecationWarn:()=>Ae.MX,depthToSpace:()=>cn.nTT,depthwiseConv2d:()=>cn.B10,device_util:()=>r,diag:()=>cn.Ka3,dilation2d:()=>cn.WmZ,disableDeprecationWarnings:()=>Ae.cF,dispose:()=>Ae.B9,disposeVariables:()=>Ae.N8,div:()=>cn.hiC,divNoNan:()=>cn.NTj,dot:()=>cn.AKD,dropout:()=>cn.rvX,einsum:()=>cn.WYO,elu:()=>cn.pyx,enableDebugMode:()=>Ae.R,enableProdMode:()=>Ae.G4,enclosingPowerOfTwo:()=>cn.GRh,engine:()=>Ae.SR,ensureShape:()=>cn.EDe,env:()=>b.OB,equal:()=>cn.DgJ,erf:()=>cn.qNN,euclideanNorm:()=>cn.d2q,exp:()=>cn.Qqt,expandDims:()=>cn.dt4,expm1:()=>cn.t$B,eye:()=>cn.iyy,fft:()=>cn.kp_,fill:()=>cn.hlL,findBackend:()=>Ae.x3,findBackendFactory:()=>Ae.ze,floor:()=>cn.GWj,floorDiv:()=>cn.qPi,fused:()=>cn.imm,gather:()=>cn.Iqj,gatherND:()=>cn.dbB,gather_util:()=>u,getBackend:()=>Ae.N_,getGradient:()=>Rt.uk,getKernel:()=>Rt.pI,getKernelsForBackend:()=>Rt.tr,grad:()=>Be.UQ,grads:()=>Be.ti,greater:()=>cn.pjt,greaterEqual:()=>cn.brS,ifft:()=>cn.Sxn,imag:()=>cn.asL,image:()=>cn.BHj,inTopKAsync:()=>cn.V3u,io:()=>o,irfft:()=>cn.wx0,isFinite:()=>cn.xVT,isInf:()=>cn.UWc,isNaN:()=>cn.i2d,keep:()=>Ae.Cn,kernel_impls:()=>d,leakyRelu:()=>cn.hi7,less:()=>cn.d9m,lessEqual:()=>cn.zN1,linalg:()=>cn.$r2,linspace:()=>cn.SX3,localResponseNormalization:()=>cn.G9k,log:()=>cn.cM7,log1p:()=>cn.Krr,logSigmoid:()=>cn.e_t,logSoftmax:()=>cn.CmS,logSumExp:()=>cn.l_t,logicalAnd:()=>cn.HvI,logicalNot:()=>cn.hJK,logicalOr:()=>cn.K5V,logicalXor:()=>cn.egP,losses:()=>cn.MB5,lowerBound:()=>cn.eab,matMul:()=>cn.OI3,math:()=>a,max:()=>cn.Fp7,maxPool:()=>cn._sB,maxPool3d:()=>cn.YQQ,maxPoolWithArgmax:()=>cn.Ip$,maximum:()=>cn.gWQ,mean:()=>cn.J69,memory:()=>Ae.sq,meshgrid:()=>cn.ry_,min:()=>cn.VV$,minimum:()=>cn.LTh,mirrorPad:()=>cn.VdP,mod:()=>cn.wQq,moments:()=>cn.Gi7,movingAverage:()=>cn.p_,mul:()=>cn.dC7,multiRNNCell:()=>cn.rq4,multinomial:()=>cn.SJ_,neg:()=>cn.W76,nextFrame:()=>fn,norm:()=>cn.KOy,notEqual:()=>cn.Quu,oneHot:()=>cn.lfX,ones:()=>cn.iUs,onesLike:()=>cn.JpU,op:()=>cn.op,outerProduct:()=>cn.N2O,pad:()=>cn.vku,pad1d:()=>cn.pNR,pad2d:()=>cn.koy,pad3d:()=>cn.t1L,pad4d:()=>cn.lGY,pool:()=>cn.d_R,pow:()=>cn.sQ3,prelu:()=>cn.AL3,print:()=>cn.S0v,prod:()=>cn.WVs,profile:()=>Ae.N5,raggedGather:()=>cn.$gW,raggedRange:()=>cn.VT$,raggedTensorToTensor:()=>cn.N89,rand:()=>cn.TN_,randomGamma:()=>cn.wzB,randomNormal:()=>cn.nGf,randomStandardNormal:()=>cn.ruB,randomUniform:()=>cn.LGj,randomUniformInt:()=>cn.pe5,range:()=>cn.w6H,ready:()=>Ae.Cd,real:()=>cn.kwC,reciprocal:()=>cn.M25,registerBackend:()=>Ae.jq,registerGradient:()=>Rt.Li,registerKernel:()=>Rt.wC,relu:()=>cn.UYe,relu6:()=>cn.btT,removeBackend:()=>Ae.cj,reshape:()=>cn.XLQ,reverse:()=>cn.GYS,reverse1d:()=>cn.SDf,reverse2d:()=>cn.diP,reverse3d:()=>cn.sx7,reverse4d:()=>cn.mG2,rfft:()=>cn.QEs,round:()=>cn.NMM,rsqrt:()=>cn.bp0,scalar:()=>cn.iD$,scatterND:()=>cn.snQ,scatter_util:()=>Ut,searchSorted:()=>cn.zcT,selu:()=>cn.U8D,separableConv2d:()=>cn.U_I,serialization:()=>i,setBackend:()=>Ae.CQ,setPlatform:()=>Ae.VY,setdiff1dAsync:()=>cn.ODp,sigmoid:()=>cn.XD2,sign:()=>cn.Xxe,signal:()=>cn.tdS,sin:()=>cn.O$l,sinh:()=>cn.R_K,slice:()=>cn.tPi,slice1d:()=>cn.jZU,slice2d:()=>cn.SmN,slice3d:()=>cn.CnO,slice4d:()=>cn.p0P,slice_util:()=>Wt,softmax:()=>cn.XAC,softplus:()=>cn.Wvh,spaceToBatchND:()=>cn.fBT,sparse:()=>cn.rVs,sparseToDense:()=>cn.ers,spectral:()=>cn.uN7,split:()=>cn.Vl2,sqrt:()=>cn._b3,square:()=>cn.h62,squaredDifference:()=>cn.$i,squeeze:()=>cn.L9e,stack:()=>cn.knu,step:()=>cn.Nbs,stridedSlice:()=>cn.NXj,string:()=>cn.Z_8,sub:()=>cn.luU,sum:()=>cn.Smz,sumOutType:()=>ln.z4,tan:()=>cn.ORZ,tanh:()=>cn.AEp,tensor:()=>cn.XeE,tensor1d:()=>cn.RRF,tensor2d:()=>cn.odF,tensor3d:()=>cn.wOQ,tensor4d:()=>cn.yXz,tensor5d:()=>cn.Bfx,tensor6d:()=>cn.xZs,tensorScatterUpdate:()=>cn.Pg0,tensor_util:()=>Vt,test_util:()=>l,tidy:()=>Ae.lu,tile:()=>cn.Gg6,time:()=>Ae.XV,topk:()=>cn.hg7,train:()=>dn,transpose:()=>cn.p4s,truncatedNormal:()=>cn.Xu6,unique:()=>cn.Two,unregisterGradient:()=>Rt.bt,unregisterKernel:()=>Rt.nE,unsortedSegmentSum:()=>cn.pUJ,unstack:()=>cn.HHK,upcastType:()=>ln.x8,upperBound:()=>cn.GaM,util:()=>S,valueAndGrad:()=>Be.h7,valueAndGrads:()=>Be.fN,variable:()=>cn.VD$,variableGrads:()=>Be.pn,version_core:()=>sn,where:()=>cn.arb,whereAsync:()=>cn.itS,zeros:()=>cn.lls,zerosLike:()=>cn.P84});var r={};n.r(r),n.d(r,{isBrowser:()=>y,isMobile:()=>m,mockIsMobile:()=>g});var i={};n.r(i),n.d(i,{Serializable:()=>ze,SerializationMap:()=>je,getRegisteredName:()=>Ue,registerClass:()=>Ge});var o={};n.r(o),n.d(o,{CompositeArrayBuffer:()=>C,browserFiles:()=>st,browserHTTPRequest:()=>mt,concatenateArrayBuffers:()=>R,copyModel:()=>be,decodeWeights:()=>E,encodeWeights:()=>T,fromMemory:()=>xt,fromMemorySync:()=>_t,getLoadHandlers:()=>W,getModelArtifactsForJSON:()=>B,getModelArtifactsForJSONSync:()=>I,getModelArtifactsInfoForJSON:()=>L,getSaveHandlers:()=>U,getWeightSpecs:()=>P,http:()=>gt,isHTTPScheme:()=>ht,listModels:()=>me,loadWeights:()=>ct,moveModel:()=>ve,registerLoadRouter:()=>G,registerSaveRouter:()=>j,removeModel:()=>ye,weightsLoaderFactory:()=>pt,withSaveHandler:()=>wt,withSaveHandlerSync:()=>kt});var a={};n.r(a),n.d(a,{confusionMatrix:()=>At});var s={};n.r(s),n.d(s,{draw:()=>zt,fromPixels:()=>jt,fromPixelsAsync:()=>Lt,toPixels:()=>$t});var u={};n.r(u),n.d(u,{prepareAndValidate:()=>Gt});var l={};n.r(l),n.d(l,{TEST_EPSILON_FLOAT16:()=>qt,createVideoElement:()=>on,encodeStrings:()=>rn,expectArrayBuffersEqual:()=>nn,expectArraysClose:()=>Xt,expectArraysEqual:()=>Zt,expectNumbersClose:()=>Qt,expectPromiseToFail:()=>Jt,expectValuesInRange:()=>tn,play:()=>an,testEpsilon:()=>Yt});var c={};n.r(c),n.d(c,{collectGatherOpShapeInfo:()=>xr,computeOutShape:()=>vr,segOpComputeOptimalWindowSize:()=>br});var p={};n.r(p),n.d(p,{ERF_A1:()=>In,ERF_A2:()=>Bn,ERF_A3:()=>Ln,ERF_A4:()=>Pn,ERF_A5:()=>$n,ERF_P:()=>Dn,PARALLELIZE_THRESHOLD:()=>Cn,RowPartitionType:()=>bn,SELU_SCALE:()=>Nn.$,SELU_SCALEALPHA:()=>Nn.y,applyActivation:()=>xn.QH,assertAndGetBroadcastShape:()=>Ft.assertAndGetBroadcastShape,assertAxesAreInnerMostDims:()=>gn.lB,assertParamsConsistent:()=>mn,assignToTypedArray:()=>Hn,axesAreInnerMostDims:()=>gn.YB,calculateShapes:()=>Ut.calculateShapes,checkEinsumDimSizes:()=>tr,checkPadOnDimRoundingMode:()=>vn.m,combineLocations:()=>gn.Vh,combineRaggedTensorToTensorShapes:()=>_n,complexWithEvenIndex:()=>Un,complexWithOddIndex:()=>Wn,computeConv2DInfo:()=>vn.Ix,computeConv3DInfo:()=>vn.jw,computeDefaultPad:()=>vn.aO,computeDilation2DInfo:()=>vn.Rf,computeOptimalWindowSize:()=>Mn,computeOutAndReduceShapes:()=>gn.kz,computeOutShape:()=>yn,computePool2DInfo:()=>vn.Xw,computePool3DInfo:()=>vn.pl,convertConv2DDataFormat:()=>vn.sl,decodeEinsumEquation:()=>Qn,eitherStridesOrDilationsAreOne:()=>vn.jT,expandShapeToKeepDim:()=>gn.rv,exponent:()=>Xn,exponents:()=>qn,fromStringArrayToUint8:()=>wr,fromUint8ToStringArray:()=>_r,getAxesPermutation:()=>gn.Q3,getBroadcastDims:()=>Ft.getBroadcastDims,getComplexWithIndex:()=>Vn,getEinsumComputePath:()=>nr,getEinsumPermutation:()=>er,getFusedBiasGradient:()=>xn.pf,getFusedDyActivation:()=>xn.Fr,getImageCenter:()=>Tn,getInnerMostAxes:()=>gn.sY,getPermuted:()=>An,getRaggedRank:()=>kn,getReductionAxes:()=>Ft.getReductionAxes,getReshaped:()=>En,getReshapedPermuted:()=>Fn,getRowPartitionTypesHelper:()=>wn,getSliceBeginCoords:()=>On,getSliceSize:()=>Rn,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>ar,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>sr,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>ur,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>pr,getSparseReshapeInputOutputMismatchErrorMessage:()=>hr,getSparseReshapeInputOutputMultipleErrorMessage:()=>dr,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>lr,getSparseReshapeNegativeOutputDimErrorMessage:()=>cr,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>yr,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>fr,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>gr,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>mr,getUndoAxesPermutation:()=>gn.LJ,isIdentityPermutation:()=>rr,log:()=>zn.c,mergeRealAndImagArrays:()=>jn,prepareAndValidate:()=>Gt,prepareSplitSize:()=>or,segment_util:()=>c,shouldFuse:()=>xn.uy,slice_util:()=>Wt,splitRealAndImagArrays:()=>Gn,stridesOrDilationsArePositive:()=>vn.U3,tupleValuesAreOne:()=>vn.I0,upcastType:()=>ln.x8,validateDefaultValueShape:()=>Sn,validateInput:()=>Ut.validateInput,validateUpdateShape:()=>Ut.validateUpdateShape,warn:()=>zn.Z});var d={};n.r(d),n.d(d,{nonMaxSuppressionV3Impl:()=>kr.GP,nonMaxSuppressionV4Impl:()=>kr.qP,nonMaxSuppressionV5Impl:()=>kr.pA,whereImpl:()=>Sr.Z});var h=n(7097);let f;function g(e){f=e}function m(e){if(void 0!==f)return f;if(e||"undefined"!=typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;const t=e.userAgent||e.vendor||("undefined"!=typeof window?window.opera:"");if(!t){const t=e;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function y(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var b=n(2885);const v=(0,b.OB)();v.registerFlag("DEBUG",(()=>!1),(e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),v.registerFlag("IS_BROWSER",(()=>y())),v.registerFlag("IS_NODE",(()=>"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node)),v.registerFlag("IS_CHROME",(()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),v.registerFlag("IS_SAFARI",(()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor))),v.registerFlag("PROD",(()=>!1)),v.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>v.getBool("DEBUG"))),v.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),v.registerFlag("IS_TEST",(()=>!1)),v.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(()=>v.getBool("DEBUG"))),v.registerFlag("WRAP_TO_IMAGEBITMAP",(()=>!1)),v.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(()=>!1)),v.registerFlag("USE_SETTIMEOUTCUSTOM",(()=>!1));var x=n(1661),_=n(701),w=n(569);const k={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};var S=n(9122);class C{static join(e){return new C(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,null==e)return;if(e instanceof Array||(e=[e]),0===(e=e.map((e=>S.isTypedArray(e)?e.buffer:e))).length)return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){const r=e[n];n!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=t+r.byteLength;this.shards.push({buffer:r,start:t,end:i}),t=i}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(0===this.shards.length)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),(t=Math.min(this.byteLength,t))<=e)return new ArrayBuffer(0);const n=this.findShardForByte(e);if(-1===n)throw new Error(`Could not find start shard for byte ${e}`);const r=new ArrayBuffer(t-e),i=new Uint8Array(r);let o=0;for(let r=n;r<this.shards.length;r++){const n=this.shards[r],a=e+o-n.start,s=o,u=Math.min(t,n.end)-n.start,l=new Uint8Array(n.buffer,a,u-a);if(i.set(l,s),o+=l.length,t<n.end)break}return r}findShardForByte(e){if(0===this.shards.length||e<0||e>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:e>=t.end?1:0}if(0===t(this.shards[this.previousShardIndex]))return this.previousShardIndex;const n=function(e,t){let n=0,r=e.length;for(;n<=r;){const i=Math.floor((r-n)/2)+n,o=t(e[i]);if(0===o)return i;o<0?r=i:n=i+1}return-1}(this.shards,t);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}const M=4;async function T(e,t){const n=[],r=[],i=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);for(let o=0;o<i.length;++o){const a=i[o],s=Array.isArray(e)?e[o].tensor:e[a];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error(`Unsupported dtype in weight '${a}': ${s.dtype}`);const u={name:a,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){const e=new Promise((async e=>{const t=await s.bytes(),n=t.reduce(((e,t)=>e+t.length),0)+M*t.length,r=new Uint8Array(n);let i=0;for(let e=0;e<t.length;e++){const n=t[e],o=new Uint8Array(new Uint32Array([n.length]).buffer);r.set(o,i),i+=M,r.set(n,i),i+=n.length}e(r)}));r.push(e)}else r.push(s.data());null!=t&&(u.group=t),n.push(u)}return{data:A(await Promise.all(r)),specs:n}}function E(e,t){const n=new C(e),r={};let i,o=0;for(const e of t){const t=e.name,a=e.dtype,s=e.shape,u=(0,w.NA)(s);let l;if("quantization"in e){const r=e.quantization;if("uint8"===r.dtype||"uint16"===r.dtype){if(!("min"in r)||!("scale"in r))throw new Error(`Weight ${e.name} with quantization ${r.dtype} doesn't have corresponding metadata min and scale.`)}else{if("float16"!==r.dtype)throw new Error(`Weight ${e.name} has unknown quantization dtype ${r.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);if("float32"!==a)throw new Error(`Weight ${e.name} is quantized with ${r.dtype} which only supports weights of type float32 not ${a}.`)}const s=k[r.dtype],c=n.slice(o,o+u*s),p="uint8"===r.dtype?new Uint8Array(c):new Uint16Array(c);if("float32"===a)if("uint8"===r.dtype||"uint16"===r.dtype){l=new Float32Array(p.length);for(let e=0;e<p.length;e++){const t=p[e];l[e]=t*r.scale+r.min}}else{if("float16"!==r.dtype)throw new Error(`Unsupported quantization type ${r.dtype} for weight type float32.`);void 0===i&&(i=$()),l=i(p)}else{if("int32"!==a)throw new Error(`Unsupported dtype in weight '${t}': ${a}`);if("uint8"!==r.dtype&&"uint16"!==r.dtype)throw new Error(`Unsupported quantization type ${r.dtype} for weight type int32.`);l=new Int32Array(p.length);for(let e=0;e<p.length;e++){const t=p[e];l[e]=Math.round(t*r.scale+r.min)}}o+=u*s}else if("string"===a){const t=(0,w.NA)(e.shape);l=[];for(let e=0;e<t;e++){const e=new Uint32Array(n.slice(o,o+M))[0];o+=M;const t=new Uint8Array(n.slice(o,o+e));l.push(t),o+=e}}else{const e=k[a],i=n.slice(o,o+u*e);if("float32"===a)l=new Float32Array(i);else if("int32"===a)l=new Int32Array(i);else if("bool"===a)l=new Uint8Array(i);else{if("complex64"!==a)throw new Error(`Unsupported dtype in weight '${t}': ${a}`);{l=new Float32Array(i);const e=new Float32Array(l.length/2),n=new Float32Array(l.length/2);for(let t=0;t<e.length;t++)e[t]=l[2*t],n[t]=l[2*t+1];const o=(0,_.X)(e,s,"float32"),a=(0,_.X)(n,s,"float32");r[t]=(0,x.P)(o,a),o.dispose(),a.dispose()}}o+=u*e}"complex64"!==a&&(r[t]=(0,_.X)(l,s,a))}return r}function A(e){if(null===e)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0;const n=[];e.forEach((e=>{if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${e.constructor.name}`)}));const r=new Uint8Array(t);let i=0;return n.forEach((e=>{r.set(new Uint8Array(e.buffer),i),i+=e.byteLength})),r.buffer}const F="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function O(e){return F?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function R(e){return C.join(e)}function N(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);const t=e.split("/");return t[t.length-1]}function D(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function I(e,t,n){const r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(r.initializerSignature=e.initializerSignature),r}async function B(e,t){let n,r;return null!=e.weightsManifest&&([n,r]=await t(e.weightsManifest)),I(e,n,r)}function L(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:O(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:O(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:new C(e.weightData).byteLength}}function P(e){const t=[];for(const n of e)t.push(...n.weights);return t}function $(){const e=function(){const e=e=>{let t=e<<13,n=0;for(;0==(8388608&t);)n-=8388608,t<<=1;return t&=-8388609,n+=947912704,t|n},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let e=1024;e<2048;e++)t[e]=939524096+(e-1024<<13);return t}(),t=function(){const e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}(),n=function(){const e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return r=>{const i=new ArrayBuffer(4*r.length),o=new Uint32Array(i);for(let i=0;i<r.length;i++){const a=r[i],s=e[n[a>>10]+(1023&a)]+t[a>>10];o[i]=s}return new Float32Array(i)}}class z{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==z.instance&&(z.instance=new z),z.instance}static registerSaveRouter(e){z.getInstance().saveRouters.push(e)}static registerLoadRouter(e){z.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return z.getHandlers(e,"save")}static getLoadHandlers(e,t){return z.getHandlers(e,"load",t)}static getHandlers(e,t,n){const r=[];return("load"===t?z.getInstance().loadRouters:z.getInstance().saveRouters).forEach((t=>{const i=t(e,n);null!==i&&r.push(i)})),r}}const j=e=>z.registerSaveRouter(e),G=e=>z.registerLoadRouter(e),U=e=>z.getSaveHandlers(e),W=(e,t)=>z.getLoadHandlers(e,t),V="tensorflowjs",H="models_store",q="model_info_store";function X(){if(!(0,b.OB)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e="undefined"==typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Y(e){const t=e.result;t.createObjectStore(H,{keyPath:"modelPath"}),t.createObjectStore(q,{keyPath:"modelPath"})}class K{constructor(e){if(this.indexedDB=X(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise(((e,n)=>{const r=this.indexedDB.open(V,1);r.onupgradeneeded=()=>Y(r),r.onsuccess=()=>{const i=r.result;if(null==t){const t=i.transaction(H,"readonly"),r=t.objectStore(H).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return i.close(),n(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));e(r.result.modelArtifacts)},r.onerror=e=>(i.close(),n(r.error)),t.oncomplete=()=>i.close()}else{t.weightData=C.join(t.weightData);const r=L(t),o=i.transaction(q,"readwrite");let a,s,u=o.objectStore(q);try{a=u.put({modelPath:this.modelPath,modelArtifactsInfo:r})}catch(e){return n(e)}a.onsuccess=()=>{s=i.transaction(H,"readwrite");const a=s.objectStore(H);let l;try{l=a.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:r})}catch(e){return n(e)}l.onsuccess=()=>e({modelArtifactsInfo:r}),l.onerror=e=>{u=o.objectStore(q);const t=u.delete(this.modelPath);t.onsuccess=()=>(i.close(),n(l.error)),t.onerror=e=>(i.close(),n(l.error))}},a.onerror=e=>(i.close(),n(a.error)),o.oncomplete=()=>{null==s?i.close():s.oncomplete=()=>i.close()}}},r.onerror=e=>n(r.error)}))}}K.URL_SCHEME="indexeddb://";const J=e=>{return(0,b.OB)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(K.URL_SCHEME)?(t=e.slice(K.URL_SCHEME.length),new K(t)):null;var t};z.registerSaveRouter(J),z.registerLoadRouter(J);class Z{constructor(){this.indexedDB=X()}async listModels(){return new Promise(((e,t)=>{const n=this.indexedDB.open(V,1);n.onupgradeneeded=()=>Y(n),n.onsuccess=()=>{const r=n.result,i=r.transaction(q,"readonly"),o=i.objectStore(q).getAll();o.onsuccess=()=>{const t={};for(const e of o.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},o.onerror=e=>(r.close(),t(o.error)),i.oncomplete=()=>r.close()},n.onerror=e=>t(n.error)}))}async removeModel(e){var t;return e=(t=e).startsWith(K.URL_SCHEME)?t.slice(K.URL_SCHEME.length):t,new Promise(((t,n)=>{const r=this.indexedDB.open(V,1);r.onupgradeneeded=()=>Y(r),r.onsuccess=()=>{const i=r.result,o=i.transaction(q,"readwrite"),a=o.objectStore(q),s=a.get(e);let u;s.onsuccess=()=>{if(null==s.result)return i.close(),n(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const r=a.delete(e),o=()=>{u=i.transaction(H,"readwrite");const r=u.objectStore(H).delete(e);r.onsuccess=()=>t(s.result.modelArtifactsInfo),r.onerror=e=>n(s.error)};r.onsuccess=o,r.onerror=e=>(o(),i.close(),n(s.error))}},s.onerror=e=>(i.close(),n(s.error)),o.oncomplete=()=>{null==u?i.close():u.oncomplete=()=>i.close()}},r.onerror=e=>n(r.error)}))}}const Q="/",ee="tensorflowjs_models",te="info",ne="model_topology",re="weight_specs",ie="weight_data",oe="model_metadata";function ae(e){return{info:[ee,e,te].join(Q),topology:[ee,e,ne].join(Q),weightSpecs:[ee,e,re].join(Q),weightData:[ee,e,ie].join(Q),modelMetadata:[ee,e,oe].join(Q)}}function se(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function ue(e){const t=e.split(Q);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(Q)}class le{constructor(e){if(!(0,b.OB)().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=ae(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=L(e),i=C.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(e){if(F)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let e=0,r=t.length;e<r;e++)n+=String.fromCharCode(t[e]);return btoa(n)}(i));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,initializerSignature:null!=e.initializerSignature?e.initializerSignature:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:r}}catch(e){throw se(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(null!=i){const e=JSON.parse(i);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,null!=e.signature&&(t.signature=e.signature),null!=e.userDefinedMetadata&&(t.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(t.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(t.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(t.trainingConfig=e.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(null==o)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=function(e){if(F){const t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;++e)n.set([t.charCodeAt(e)],e);return n.buffer}(o),t}}le.URL_SCHEME="localstorage://";const ce=e=>{return(0,b.OB)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(le.URL_SCHEME)?(t=e.slice(le.URL_SCHEME.length),new le(t)):null;var t};z.registerSaveRouter(ce),z.registerLoadRouter(ce);class pe{constructor(){(0,w.hu)((0,b.OB)().getBool("IS_BROWSER"),(()=>"Current environment is not a web browser")),(0,w.hu)("undefined"==typeof window||void 0!==window.localStorage,(()=>"Current browser does not appear to support localStorage")),this.LS=window.localStorage}async listModels(){const e={},t=ee+Q,n=Q+te;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);i.startsWith(t)&&i.endsWith(n)&&(e[ue(i)]=JSON.parse(this.LS.getItem(i)))}return e}async removeModel(e){var t;const n=ae(e=(t=e).startsWith(le.URL_SCHEME)?t.slice(le.URL_SCHEME.length):t);if(null==this.LS.getItem(n.info))throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return se(n),r}}const de="://";class he{constructor(){this.managers={}}static getInstance(){return null==he.instance&&(he.instance=new he),he.instance}static registerManager(e,t){(0,w.hu)(null!=e,(()=>"scheme must not be undefined or null.")),e.endsWith(de)&&(e=e.slice(0,e.indexOf(de))),(0,w.hu)(e.length>0,(()=>"scheme must not be an empty string."));const n=he.getInstance();(0,w.hu)(null==n.managers[e],(()=>`A model store manager is already registered for scheme '${e}'.`)),n.managers[e]=t}static getManager(e){const t=he.getInstance().managers[e];if(null==t)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(he.getInstance().managers)}}function fe(e){if(-1===e.indexOf(de))throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${he.getSchemes().join(",")}`);return{scheme:e.split(de)[0],path:e.split(de)[1]}}async function ge(e,t,n=!1){(0,w.hu)(e!==t,(()=>`Old path and new path are the same: '${e}'`));const r=z.getLoadHandlers(e);(0,w.hu)(r.length>0,(()=>`Copying failed because no load handler is found for source URL ${e}.`)),(0,w.hu)(r.length<2,(()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${e}.`));const i=r[0],o=z.getSaveHandlers(t);(0,w.hu)(o.length>0,(()=>`Copying failed because no save handler is found for destination URL ${t}.`)),(0,w.hu)(o.length<2,(()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${t}.`));const a=o[0],s=fe(e).scheme,u=fe(e).path,l=s===fe(e).scheme,c=await i.load();n&&l&&await he.getManager(s).removeModel(u);const p=await a.save(c);return n&&!l&&await he.getManager(s).removeModel(u),p.modelArtifactsInfo}async function me(){const e=he.getSchemes(),t={};for(const n of e){const e=await he.getManager(n).listModels();for(const r in e)t[n+de+r]=e[r]}return t}async function ye(e){const t=fe(e);return he.getManager(t.scheme).removeModel(t.path)}async function be(e,t){return ge(e,t,!1)}async function ve(e,t){return ge(e,t,!0)}var xe=n(9742);class _e{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){"undefined"!=typeof window&&(0,b.OB)().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout((()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")}),t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(e=>{e.source===window&&e.data.name===this.messageName&&(e.stopPropagation(),(0,this.functionRefs[e.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0))}),!0))):setTimeout(e,t)}isTypedArray(e){return(0,xe.j)(e)}}if((0,b.OB)().get("IS_BROWSER")){(0,b.OB)().setPlatform("browser",new _e);try{he.registerManager(le.URL_SCHEME,new pe)}catch(e){}try{he.registerManager(K.URL_SCHEME,new Z)}catch(e){}}let we;(0,b.OB)().get("IS_NODE")&&!(0,b.OB)().get("IS_BROWSER")&&(0,b.OB)().setPlatform("node",new class{constructor(){this.util=n(8628),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return null!=(0,b.OB)().global.fetch?(0,b.OB)().global.fetch(e,t):(null==we&&(we=n(5410)),we(e,t))}now(){const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}});var ke=n(2657),Se=n(2271),Ce=n(8723),Me=n(9798),Te=n(4077);(0,h.wv)();const Ee={buffer:ke.f,cast:Se.p,clone:Ce.d,print:Me.S};(0,Te.Vp)(Ee);var Ae=n(4368),Fe=n(6407),Oe=n(1274),Re=n(4841),Ne=n(3261),De=n(248),Ie=n(6577),Be=n(633),Le=n(9494);const Pe=new Map,$e=new Map;class ze{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class je{constructor(){this.classNameMap={}}static getMap(){return null==je.instance&&(je.instance=new je),je.instance}static register(e){je.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Ge(e,t,n){(0,w.hu)(null!=e.className,(()=>"Class being registered does not have the static className property defined.")),(0,w.hu)("string"==typeof e.className,(()=>"className is required to be a string, but got type "+typeof e.className)),(0,w.hu)(e.className.length>0,(()=>"Class being registered has an empty-string as its className, which is disallowed.")),void 0===t&&(t="Custom"),void 0===n&&(n=e.className);const r=t+">"+n;return je.register(e),Pe.set(r,e),$e.set(e,r),e}function Ue(e){return $e.has(e)?$e.get(e):e.className}class We extends ze{minimize(e,t=!1,n){const{value:r,grads:i}=this.computeGradients(e,n);if(null!=n){const e=n.map((e=>({name:e.name,tensor:i[e.name]})));this.applyGradients(e)}else this.applyGradients(i);return(0,Ae.B9)(i),t?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return(0,Be.pn)(e,t)}dispose(){null!=this.iterations_&&(0,Ae.B9)(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:(0,Le.i)(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(We,Symbol.hasInstance,{value:e=>null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients});class Ve extends We{static get className(){return"Adadelta"}constructor(e,t,n=null){super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=h.BV.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=h.BV.registeredVariables[t];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:`${t}/accum_grad`,variable:(0,Ae.lu)((()=>(0,Ie.P)(r).variable(!1)))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:`${t}/accum_var`,variable:(0,Ae.lu)((()=>(0,Ie.P)(r).variable(!1)))});const i=Array.isArray(e)?e[n].tensor:e[t];if(null==i)return;const o=this.accumulatedGrads[n].variable,a=this.accumulatedUpdates[n].variable;(0,Ae.lu)((()=>{const e=(0,Fe.I)((0,Re.d)(o,this.rho),(0,Re.d)((0,De.h)(i),1-this.rho)),t=(0,Re.d)((0,Oe.h)((0,Ne._)((0,Fe.I)(a,this.epsilon)),(0,Ne._)((0,Fe.I)(o,this.epsilon))),i),n=(0,Fe.I)((0,Re.d)(a,this.rho),(0,Re.d)((0,De.h)(t),1-this.rho));o.assign(e),a.assign(n);const s=(0,Fe.I)((0,Re.d)(t,-this.learningRate),r);r.assign(s)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&((0,Ae.B9)(this.accumulatedGrads.map((e=>e.variable))),(0,Ae.B9)(this.accumulatedUpdates.map((e=>e.variable))))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){const t=(e=await this.extractIterations(e)).length/2;this.accumulatedGrads=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(!1)}))),this.accumulatedUpdates=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}var He=n(4006);class qe extends We{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=h.BV.registeredVariables[t];if(null==this.accumulatedGrads[n]){const e=!1;this.accumulatedGrads[n]={originalName:`${t}/accumulator`,variable:(0,Ae.lu)((()=>(0,He.h)(r.shape,this.initialAccumulatorValue).variable(e)))}}const i=Array.isArray(e)?e[n].tensor:e[t];if(null==i)return;const o=this.accumulatedGrads[n].variable;(0,Ae.lu)((()=>{const e=(0,Fe.I)(o,(0,De.h)(i));o.assign(e);const t=(0,Fe.I)((0,Re.d)((0,Oe.h)(i,(0,Ne._)((0,Fe.I)(e,h.BV.backend.epsilon()))),-this.learningRate),r);r.assign(t)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&(0,Ae.B9)(this.accumulatedGrads.map((e=>e.variable)))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e),this.accumulatedGrads=e.map((e=>({originalName:e.name,variable:e.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}var Xe=n(3453),Ye=n(827);class Ke extends We{static get className(){return"Adam"}constructor(e,t,n,r=null){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],(0,Ae.lu)((()=>{this.accBeta1=(0,Le.i)(t).variable(),this.accBeta2=(0,Le.i)(n).variable()})),null==r&&(this.epsilon=h.BV.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);(0,Ae.lu)((()=>{const n=(0,Ye.l)(1,this.accBeta1),r=(0,Ye.l)(1,this.accBeta2);t.forEach(((t,i)=>{const o=h.BV.registeredVariables[t];null==this.accumulatedFirstMoment[i]&&(this.accumulatedFirstMoment[i]={originalName:`${t}/m`,variable:(0,Ae.lu)((()=>(0,Ie.P)(o).variable(!1)))}),null==this.accumulatedSecondMoment[i]&&(this.accumulatedSecondMoment[i]={originalName:`${t}/v`,variable:(0,Ae.lu)((()=>(0,Ie.P)(o).variable(!1)))});const a=Array.isArray(e)?e[i].tensor:e[t];if(null==a)return;const s=this.accumulatedFirstMoment[i].variable,u=this.accumulatedSecondMoment[i].variable,l=(0,Fe.I)((0,Re.d)(s,this.beta1),(0,Re.d)(a,1-this.beta1)),c=(0,Fe.I)((0,Re.d)(u,this.beta2),(0,Re.d)((0,De.h)(a),1-this.beta2)),p=(0,Oe.h)(l,n),d=(0,Oe.h)(c,r);s.assign(l),u.assign(c);const f=(0,Fe.I)((0,Re.d)((0,Oe.h)(p,(0,Fe.I)((0,Ne._)(d),this.epsilon)),-this.learningRate),o);o.assign(f)})),this.accBeta1.assign((0,Re.d)(this.accBeta1,this.beta1)),this.accBeta2.assign((0,Re.d)(this.accBeta2,this.beta2))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&(0,Ae.B9)(this.accumulatedFirstMoment.map((e=>e.variable))),null!=this.accumulatedSecondMoment&&(0,Ae.B9)(this.accumulatedSecondMoment.map((e=>e.variable)))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e),(0,Ae.lu)((()=>{this.accBeta1.assign((0,Xe.s)(this.beta1,this.iterations_+1)),this.accBeta2.assign((0,Xe.s)(this.beta2,this.iterations_+1))}));const t=e.length/2;this.accumulatedFirstMoment=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(!1)}))),this.accumulatedSecondMoment=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}var Je=n(6235),Ze=n(632);class Qe extends We{static get className(){return"Adamax"}constructor(e,t,n,r=null,i=0){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],(0,Ae.lu)((()=>{this.iteration=(0,Le.i)(0).variable(),this.accBeta1=(0,Le.i)(t).variable()})),null==r&&(this.epsilon=h.BV.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);(0,Ae.lu)((()=>{const n=(0,Ye.l)(1,this.accBeta1),r=(0,Oe.h)(-this.learningRate,(0,Fe.I)((0,Re.d)(this.iteration,this.decay),1));t.forEach(((t,i)=>{const o=h.BV.registeredVariables[t];null==this.accumulatedFirstMoment[i]&&(this.accumulatedFirstMoment[i]={originalName:`${t}/m`,variable:(0,Ie.P)(o).variable(!1)}),null==this.accumulatedWeightedInfNorm[i]&&(this.accumulatedWeightedInfNorm[i]={originalName:`${t}/v`,variable:(0,Ie.P)(o).variable(!1)});const a=Array.isArray(e)?e[i].tensor:e[t];if(null==a)return;const s=this.accumulatedFirstMoment[i].variable,u=this.accumulatedWeightedInfNorm[i].variable,l=(0,Fe.I)((0,Re.d)(s,this.beta1),(0,Re.d)(a,1-this.beta1)),c=(0,Re.d)(u,this.beta2),p=(0,Je.W)(a),d=(0,Ze.g)(c,p);s.assign(l),u.assign(d);const f=(0,Fe.I)((0,Re.d)((0,Oe.h)(r,n),(0,Oe.h)(l,(0,Fe.I)(d,this.epsilon))),o);o.assign(f)})),this.iteration.assign((0,Fe.I)(this.iteration,1)),this.accBeta1.assign((0,Re.d)(this.accBeta1,this.beta1))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&(0,Ae.B9)(this.accumulatedFirstMoment.map((e=>e.variable))),null!=this.accumulatedWeightedInfNorm&&(0,Ae.B9)(this.accumulatedWeightedInfNorm.map((e=>e.variable)))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}class et extends We{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;const i=h.BV.registeredVariables[t];(0,Ae.lu)((()=>{const e=(0,Fe.I)((0,Re.d)(this.c,r),i);i.assign(e)}))})),this.incrementIterations()}setLearningRate(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=(0,Ae.Cn)((0,Le.i)(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(0!==(e=await this.extractIterations(e)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}class tt extends et{static get className(){return"Momentum"}constructor(e,t,n=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=(0,Le.i)(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=h.BV.registeredVariables[t];if(null==this.accumulations[n]){const e=!1;this.accumulations[n]={originalName:`${t}/momentum`,variable:(0,Ae.lu)((()=>(0,Ie.P)(r).variable(e)))}}const i=this.accumulations[n].variable,o=Array.isArray(e)?e[n].tensor:e[t];null!=o&&(0,Ae.lu)((()=>{let e;const t=(0,Fe.I)((0,Re.d)(this.m,i),o);e=this.useNesterov?(0,Fe.I)((0,Re.d)(this.c,(0,Fe.I)(o,(0,Re.d)(t,this.m))),r):(0,Fe.I)((0,Re.d)(this.c,t),r),i.assign(t),r.assign(e)}))})),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&(0,Ae.B9)(this.accumulations.map((e=>e.variable)))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e),this.accumulations=e.map((e=>({originalName:e.name,variable:e.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}class nt extends We{static get className(){return"RMSProp"}constructor(e,t=.9,n=0,r=null,i=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,null==r&&(this.epsilon=h.BV.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=h.BV.registeredVariables[t],i=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:`${t}/rms`,variable:(0,Ae.lu)((()=>(0,Ie.P)(r).variable(i)))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:`${t}/momentum`,variable:(0,Ae.lu)((()=>(0,Ie.P)(r).variable(i)))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:`${t}/mg`,variable:(0,Ae.lu)((()=>(0,Ie.P)(r).variable(i)))});const o=Array.isArray(e)?e[n].tensor:e[t];if(null==o)return;const a=this.accumulatedMeanSquares[n].variable,s=this.accumulatedMoments[n].variable;(0,Ae.lu)((()=>{const e=(0,Fe.I)((0,Re.d)(a,this.decay),(0,Re.d)((0,De.h)(o),1-this.decay));if(this.centered){const t=this.accumulatedMeanGrads[n].variable,i=(0,Fe.I)((0,Re.d)(t,this.decay),(0,Re.d)(o,1-this.decay)),u=(0,Oe.h)((0,Re.d)(o,this.learningRate),(0,Ne._)((0,Ye.l)(e,(0,Fe.I)((0,De.h)(i),this.epsilon)))),l=(0,Fe.I)((0,Re.d)(s,this.momentum),u);a.assign(e),t.assign(i),s.assign(l);const c=(0,Ye.l)(r,l);r.assign(c)}else{const e=(0,Fe.I)((0,Re.d)(a,this.decay),(0,Re.d)((0,De.h)(o),1-this.decay)),t=(0,Fe.I)((0,Re.d)(s,this.momentum),(0,Oe.h)((0,Re.d)(o,this.learningRate),(0,Ne._)((0,Fe.I)(e,this.epsilon))));a.assign(e),s.assign(t);const n=(0,Ye.l)(r,t);r.assign(n)}}))})),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&(0,Ae.B9)(this.accumulatedMeanSquares.map((e=>e.variable))),null!=this.accumulatedMeanGrads&&this.centered&&(0,Ae.B9)(this.accumulatedMeanGrads.map((e=>e.variable))),null!=this.accumulatedMoments&&(0,Ae.B9)(this.accumulatedMoments.map((e=>e.variable)))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.accumulatedMoments=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}const rt=[Ve,qe,Ke,Qe,tt,nt,et];function it(e){return new Promise((e=>setTimeout(e))).then(e)}class ot{constructor(e){if(!(0,b.OB)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(ot.URL_SCHEME)&&(e=e.slice(ot.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}async save(e){if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=C.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const t=D(e,[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}]),r=window.URL.createObjectURL(new Blob([JSON.stringify(t)],{type:"application/json"})),i=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=r,await it((()=>i.dispatchEvent(new MouseEvent("click")))),null!=e.weightData){const e=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;e.download=this.weightDataFileName,e.href=n,await it((()=>e.dispatchEvent(new MouseEvent("click"))))}return{modelArtifactsInfo:L(e)}}}}ot.URL_SCHEME="downloads://";class at{constructor(e){if(null==e||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise(((e,t)=>{const n=new FileReader;n.onload=n=>{const r=JSON.parse(n.target.result),i=r.modelTopology;if(null==i)return void t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));if(null==r.weightsManifest)return void t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));if(0===this.weightsFiles.length)return void e({modelTopology:i});const o=B(r,(e=>this.loadWeights(e)));e(o)},n.onerror=e=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),n.readAsText(this.jsonFile)}))}loadWeights(e){const t=[],n=[];for(const r of e)t.push(...r.weights),n.push(...r.paths);const r=this.checkManifestAndWeightFiles(e),i=n.map((e=>this.loadWeightsFile(e,r[e])));return Promise.all(i).then((e=>[t,e]))}loadWeightsFile(e,t){return new Promise(((n,r)=>{const i=new FileReader;i.onload=e=>{const t=e.target.result;n(t)},i.onerror=t=>r(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(t)}))}checkManifestAndWeightFiles(e){const t=[],n=this.weightsFiles.map((e=>N(e.name))),r={};for(const i of e)i.paths.forEach((e=>{const i=N(e);if(-1!==t.indexOf(i))throw new Error(`Duplicate file basename found in weights manifest: '${i}'`);if(t.push(i),-1===n.indexOf(i))throw new Error(`Weight file with basename '${i}' is not provided.`);r[e]=this.weightsFiles[n.indexOf(i)]}));if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}function st(e){return new at(e)}function ut(e,t,n,r){!function(e){(0,w.hu)(null!=e&&Array.isArray(e)&&e.length>0,(()=>"promises must be a none empty array"))}(e),function(e,t){(0,w.hu)(e>=0&&e<=1,(()=>`Progress fraction must be in range [0, 1], but got startFraction ${e}`)),(0,w.hu)(t>=0&&t<=1,(()=>`Progress fraction must be in range [0, 1], but got endFraction ${t}`)),(0,w.hu)(t>=e,(()=>`startFraction must be no more than endFraction, but got startFraction ${e} and endFraction ${t}`))}(n=null==n?0:n,r=null==r?1:r);let i=0;return Promise.all(e.map((o=>(o.then((o=>{const a=n+ ++i/e.length*(r-n);return t(a),o})),o))))}async function lt(e,t){null==t&&(t={});const n=null==t.fetchFunc?(0,b.OB)().platform.fetch:t.fetchFunc,r=e.map((e=>n(e,t.requestInit,{isBinary:!0}))),i=(null==t.onProgress?await Promise.all(r):await ut(r,t.onProgress,0,.5)).map((e=>e.arrayBuffer()));return null==t.onProgress?await Promise.all(i):await ut(i,t.onProgress,.5,1)}async function ct(e,t="",n,r){return pt((e=>lt(e,{requestInit:r})))(e,t,n)}function pt(e){return async(t,n="",r)=>{const i=t.map((()=>!1)),o={},a=null!=r?r.map((()=>!1)):[],s=[];if(t.forEach(((e,t)=>{let n=0;e.weights.forEach((e=>{const u="quantization"in e?e.quantization.dtype:e.dtype,l=k[u]*w.NA(e.shape),c=()=>{i[t]=!0,null==o[t]&&(o[t]=[]),o[t].push({manifestEntry:e,groupOffset:n,sizeBytes:l})};null!=r?r.forEach(((t,n)=>{t===e.name&&(c(),a[n]=!0)})):c(),s.push(e.name),n+=l}))})),!a.every((e=>e))){const e=r.filter(((e,t)=>!a[t]));throw new Error(`Could not find weights in manifest with names: ${e.join(", ")}. \nManifest JSON has weights with names: ${s.join(", ")}.`)}const u=i.reduce(((e,t,n)=>(t&&e.push(n),e)),[]),l=[];u.forEach((e=>{t[e].paths.forEach((e=>{const t=n+(n.endsWith("/")?"":"/")+e;l.push(t)}))}));const c=await e(l),p={};let d=0;return u.forEach((e=>{const n=t[e].paths.length,r=new C(c.slice(d,d+n));o[e].forEach((e=>{const t=E(r.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(const e in t)p[e]=t[e]})),d+=n})),p}}z.registerSaveRouter((e=>(0,b.OB)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(ot.URL_SCHEME)?function(e="model"){return new ot(e)}(e.slice(ot.URL_SCHEME.length)):null));class dt{constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?((0,w.hu)("function"==typeof t.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=t.fetchFunc):this.fetch=(0,b.OB)().platform.fetch,(0,w.hu)(null!=e&&e.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(e)&&(0,w.hu)(2===e.length,(()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`)),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const n=D(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);if(t.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=e.weightData){const n=C.join(e.weightData);t.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}const r=await this.fetch(this.path,t);if(r.ok)return{modelArtifactsInfo:L(e),responses:[r]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${r.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch(e){let t=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=t.modelTopology,r=t.weightsManifest;if(null==n&&null==r)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return B(t,(e=>this.loadWeights(e)))}async loadWeights(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}(t),i=this.weightPathPrefix||n,o=P(e),a=[],s=[];for(const t of e)for(const e of t.paths)null!=this.weightUrlConverter?s.push(this.weightUrlConverter(e)):a.push(i+e+r);return this.weightUrlConverter&&a.push(...await Promise.all(s)),[o,await lt(a,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})]}}function ht(e){return null!=e.match(dt.URL_SCHEME_REGEX)}dt.URL_SCHEME_REGEX=/^https?:\/\//;const ft=(e,t)=>{if("undefined"==typeof fetch&&(null==t||null==t.fetchFunc))return null;{let n=!0;if(n=Array.isArray(e)?e.every((e=>ht(e))):ht(e),n)return gt(e,t)}return null};function gt(e,t){return new dt(e,t)}function mt(e,t){return gt(e,t)}z.registerSaveRouter(ft),z.registerLoadRouter(ft);class yt{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class bt{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class vt{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function xt(e,t,n,r){return new vt(_t(...arguments))}function _t(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new yt(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new yt({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new yt({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function wt(e){return new bt(e)}function kt(e){return new bt(e)}var St=n(3740),Ct=n(8687),Mt=n(6708),Tt=n(2668),Et=n(9065);const At=(0,Tt.op)({confusionMatrix_:function(e,t,n){const r=(0,St._1)(e,"labels","confusionMatrix"),i=(0,St._1)(t,"predictions","confusionMatrix");w.hu(null==n||n>0&&Number.isInteger(n),(()=>`If provided, numClasses must be a positive integer, but got ${n}`)),w.hu(1===r.rank,(()=>`Expected the rank of labels to be 1, but got ${r.rank}`)),w.hu(1===i.rank,(()=>`Expected the rank of predictions to be 1, but got ${i.rank}`)),w.hu(r.shape[0]===i.shape[0],(()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${i.shape[0]}. Labels and predictions should have the same number of elements.`)),w.hu(n>0&&Number.isInteger(n),(()=>`numClasses is required to be a positive integer, but got ${n}`));const o=(0,Mt.l)((0,Se.p)(r,"int32"),n),a=(0,Mt.l)((0,Se.p)(i,"int32"),n),s=(0,Et.p)(o),u=(0,Ct.O)(s,a);return(0,Se.p)(u,"int32")}});var Ft=n(2200),Ot=n(9121),Rt=n(6151),Nt=n(9906);let Dt,It=!1;function Bt(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,i=!1,o=!1,a=!1,s=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)i=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)o=!0;else if(null!=e.getContext)a=!0;else{if(!("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);s=!0}if(null!=(0,Rt.pI)(Ot.eBW,h.BV.backendName)){const n={pixels:e},r={numChannels:t};return h.BV.runKernel(Ot.eBW,n,r)}const[u,l]=i?[e.videoWidth,e.videoHeight]:[e.width,e.height];let c,p;if(a)c=e.getContext("2d").getImageData(0,0,u,l).data;else if(r||n)c=e.data;else if(o||i||s){if(null==Dt)if("undefined"==typeof document){if("undefined"==typeof OffscreenCanvas||"undefined"==typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");Dt=new OffscreenCanvas(1,1).getContext("2d")}else Dt=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Dt.canvas.width=u,Dt.canvas.height=l,Dt.drawImage(e,0,0,u,l),c=Dt.getImageData(0,0,u,l).data}if(4===t)p=new Int32Array(c);else{const e=u*l;p=new Int32Array(e*t);for(let n=0;n<e;n++)for(let e=0;e<t;++e)p[n*t+e]=c[4*n+e]}const d=[l,u,t];return(0,Nt.w)(p,d,"int32")}async function Lt(e,t=3){let n=null;if((0,b.OB)().getBool("WRAP_TO_IMAGEBITMAP")&&function(e){return"undefined"!=typeof window&&"undefined"!=typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(e instanceof ImageBitmap)&&function(e){return null!=e&&0!==e.width&&0!==e.height}(e)&&!function(e){return null!=e&&e.data instanceof Uint8Array}(e)}(e)){let t;try{t=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch(e){t=null}n=null!=t&&t.width===e.width&&t.height===e.height?t:e}else n=e;return Bt(n,t)}function Pt(e){if(2!==e.rank&&3!==e.rank)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);const t=2===e.rank?1:e.shape[2];if(t>4||2===t)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${t}`);if("float32"!==e.dtype&&"int32"!==e.dtype)throw new Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`)}async function $t(e,t){let n=(0,St._1)(e,"img","toPixels");if(!(e instanceof Te.es)){const e=n;n=(0,Se.p)(e,"int32"),e.dispose()}Pt(n);const[r,i]=n.shape.slice(0,2),o=2===n.rank?1:n.shape[2],a=await n.data(),s="float32"===n.dtype?255:1,u=new Uint8ClampedArray(i*r*4);for(let e=0;e<r*i;++e){const t=[0,0,0,255];for(let r=0;r<o;r++){const i=a[e*o+r];if("float32"===n.dtype){if(i<0||i>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${i}.`)}else if("int32"===n.dtype&&(i<0||i>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${i}.`);1===o?(t[0]=i*s,t[1]=i*s,t[2]=i*s):t[r]=i*s}const r=4*e;u[r+0]=Math.round(t[0]),u[r+1]=Math.round(t[1]),u[r+2]=Math.round(t[2]),u[r+3]=Math.round(t[3])}if(null!=t){It||null!=(0,Rt.pI)(Ot.hGc,h.BV.backendName)&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),It=!0),t.width=i,t.height=r;const e=t.getContext("2d"),n=new ImageData(u,i,r);e.putImageData(n,0,0)}return n!==e&&n.dispose(),u}function zt(e,t,n){let r=(0,St._1)(e,"img","draw");if(!(e instanceof Te.es)){const e=r;r=(0,Se.p)(e,"int32"),e.dispose()}Pt(r),function(e){const t=(null==e?void 0:e.alpha)||1;if(t>1||t<0)throw new Error(`Alpha value ${t} is suppoed to be in range [0 - 1].`)}(null==n?void 0:n.imageOptions);const i={image:r},o={canvas:t,options:n};h.BV.runKernel(Ot.hGc,i,o)}const jt=(0,Tt.op)({fromPixels_:Bt});function Gt(e,t){const n=e.shape.length,r=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if("int32"!==t.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(0===(0,w.NA)(e.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);const i=t.shape,o=i[i.length-1];let a=1;for(let e=0;e<i.length-1;++e)a*=i[e];const s=e.shape,u=i.slice();u.pop();let l=1;for(let e=o;e<n;++e)l*=s[e],u.push(s[e]);const c=[...(0,w.e3)(e.shape).map((e=>e/l)),1].slice(0,o);return[u,a,l,c]}var Ut=n(3028),Wt=n(7650),Vt=n(747);const Ht=.001,qt=.1;function Xt(e,t,n){return null==n&&(n=Yt()),Kt(e,t,((e,t)=>en(e,t,n)))}function Yt(){return 32===h.BV.backend.floatPrecision()?Ht:qt}function Kt(e,t,n){let r=!0;if(((0,S.isTypedArray)(e)||(0,S.isTypedArray)(t))&&(r=!1),(0,S.isTypedArray)(e)&&(0,S.isTypedArray)(t)&&(r=!0),r){const n=e.constructor.name,r=t.constructor.name;if(n!==r)throw new Error(`Arrays are of different type. Actual: ${n}. Expected: ${r}`)}if(Array.isArray(e)&&Array.isArray(t)){const n=(0,St.C)(e),r=(0,St.C)(t);if(!(0,w.cO)(n,r))throw new Error(`Arrays have different shapes. Actual: [${n}]. Expected: [${r}]`)}const i=(0,S.isTypedArray)(e)?e:(0,S.flatten)(e),o=(0,S.isTypedArray)(t)?t:(0,S.flatten)(t);if(i.length!==o.length)throw new Error(`Arrays have different lengths actual: ${i.length} vs expected: ${o.length}.\nActual:   ${i}.\nExpected: ${o}.`);for(let e=0;e<o.length;++e){const t=i[e],r=o[e];if(!n(t,r))throw new Error(`Arrays differ: actual[${e}] = ${t}, expected[${e}] = ${r}.\nActual:   ${i}.\nExpected: ${o}.`)}"undefined"!=typeof expect&&expect().nothing()}function Jt(e,t){e().then((()=>t.fail()),(()=>t())),"undefined"!=typeof expect&&expect().nothing()}function Zt(e,t){const n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return(0,w.HD)(e)||(0,w.HD)(e[0])||(0,w.HD)(t)||(0,w.HD)(t[0])?Kt(e,n,((e,t)=>e==t)):Kt(e,t,((e,t)=>en(e,t,0)))}function Qt(e,t,n){if(null==n&&(n=Yt()),!en(e,t,n))throw new Error(`Numbers differ: actual === ${e}, expected === ${t}`);"undefined"!=typeof expect&&expect().nothing()}function en(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function tn(e,t,n){for(let r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error(`Value out of range:${e[r]} low: ${t}, high: ${n}`)}function nn(e,t){const n=new Float32Array(e),r=new Float32Array(t);if(n.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let e=0;e<r.length;e++)if(n[e]!==r[e])throw new Error(`Expected ArrayBuffer value at ${e} to be ${r[e]} but got ${n[e]} instead`)}function rn(e){for(let t=0;t<e.length;t++){const n=e[t];Array.isArray(n)?rn(n):e[t]=(0,S.encodeString)(n)}return e}function on(e){const t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise((e=>{t.addEventListener("loadeddata",(n=>e(t))),t.load()}))}async function an(e){await e.play(),"requestVideoFrameCallback"in e&&await new Promise((t=>{e.requestVideoFrameCallback(t)}))}const sn="4.8.0";class un{static sgd(e){return new et(e)}static momentum(e,t,n=!1){return new tt(e,t,n)}static rmsprop(e,t=.9,n=0,r=null,i=!1){return new nt(e,t,n,r,i)}static adam(e=.001,t=.9,n=.999,r=null){return new Ke(e,t,n,r)}static adadelta(e=.001,t=.95,n=null){return new Ve(e,t,n)}static adamax(e=.002,t=.9,n=.999,r=null,i=0){return new Qe(e,t,n,r,i)}static adagrad(e,t=.1){return new qe(e,t)}}var ln=n(1221),cn=n(2778),pn=n(9876);const dn=un,hn="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:e=>e();function fn(){return new Promise((e=>hn((()=>e()))))}var gn=n(3591);function mn(e,t){const n=e[0].length;e.forEach(((e,t)=>{w.hu(e.length===n,(()=>`Error in concat${n}D: rank of tensors[${t}] must be the same as the rank of the rest (${n})`))})),w.hu(t>=0&&t<n,(()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`));const r=e[0];e.forEach(((e,i)=>{for(let o=0;o<n;o++)w.hu(o===t||e[o]===r[o],(()=>`Error in concat${n}D: Shape of tensors[${i}] (${e}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`))}))}function yn(e,t){const n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}var bn,vn=n(2582),xn=n(9323);function _n(e,t,n){let r=new Array;if(null==n&&null==t)return r;if(null==t)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(null==n)return r;if(e+n.length!==r.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${r.length}`);for(let i=1;i<n.length;++i){const o=n[i],a=r[r.length-n.length+i],s=r[a];if(o>=0)if(s>=0){if(s!==o)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${i+e}] = ${o} but shape[${i+e}] = ${s}`)}else r[a]=o}return r}function wn(e){const t={FIRST_DIM_SIZE:bn.FIRST_DIM_SIZE,VALUE_ROWIDS:bn.VALUE_ROWIDS,ROW_LENGTHS:bn.ROW_LENGTHS,ROW_SPLITS:bn.ROW_SPLITS,ROW_LIMITS:bn.ROW_LIMITS,ROW_STARTS:bn.ROW_STARTS},n=[];for(const r of e){if(!(r in t))break;n.push(t[r])}return n}function kn(e){return 0===e.length?0:e[0]===bn.FIRST_DIM_SIZE?e.length-1:e.length}function Sn(e,t){if(null==e||null==t)return;const n=e.length,r=t.length;if(n>=r)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(n,r-1);++i){const n=e[i],r=t[i+1];if(n>=0&&r>=0&&1!==n&&n!==r)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${i-e.length}] = ${n} but ragged tensor input.flatValues.shape[${i-e.length}] = ${r}`)}}!function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(bn||(bn={}));const Cn=30;function Mn(e){return e<=Cn?e:(0,w.jP)(e,Math.floor(Math.sqrt(e)))}function Tn(e,t,n){return[n*("number"==typeof e?e:e[0]),t*("number"==typeof e?e:e[1])]}function En(e,t,n,r=!0){let i=[];if(r)i=i.concat(t.slice(0)),i.push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);const n=t.length;for(let r=0;r<n;++r)i=i.concat([e[r+1]/t[r],t[r]]);i=i.concat(e.slice(n+1))}return i}function An(e,t,n=!0){const r=[];if(n){r.push(t);for(let n=t+1;n<e;++n)n<=2*t?(r.push(n),r.push(n-(t+1))):r.push(n)}else{const n=[],i=[];for(let r=1;r<e;++r)r>=2*t+1||r%2==1?i.push(r):n.push(r);r.push(...n),r.push(0),r.push(...i)}return r}function Fn(e,t,n,r=!0){const i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(let n=1;n<e.length;++n)n<=t.length?r?i.push(t[n-1]*e[n]):i.push(e[n]/t[n-1]):i.push(e[n]);return i}function On(e,t){const n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function Rn(e,t,n){const r=e.slice(0,1);for(let i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}var Nn=n(3179);const Dn=.3275911,In=.254829592,Bn=-.284496736,Ln=1.421413741,Pn=-1.453152027,$n=1.061405429;var zn=n(4706);function jn(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);const n=new Float32Array(2*e.length);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function Gn(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function Un(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let t=0;t<e.length;t+=4)n[Math.floor(t/4)]=e[t],r[Math.floor(t/4)]=e[t+1];return{real:n,imag:r}}function Wn(e){const t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let t=2;t<e.length;t+=4)n[Math.floor(t/4)]=e[t],r[Math.floor(t/4)]=e[t+1];return{real:n,imag:r}}function Vn(e,t){return{real:e[2*t],imag:e[2*t+1]}}function Hn(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function qn(e,t){const n=new Float32Array(e/2),r=new Float32Array(e/2);for(let i=0;i<Math.ceil(e/2);i++){const o=(t?2:-2)*Math.PI*(i/e);n[i]=Math.cos(o),r[i]=Math.sin(o)}return{real:n,imag:r}}function Xn(e,t,n){const r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}const Yn="->",Kn=/->/g,Jn=",",Zn="...";function Qn(e,t){const n=((e=e.replace(/\s/g,"")).length-e.replace(Kn,"").length)/Yn.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${Yn}").`);const[r,i]=e.split(Yn);(0,w.hu)(-1===r.indexOf(Zn),(()=>`The ellipsis notation ("${Zn}") is not supported yet.`));const o=r.split(Jn),a=o.length;if(t!==a)throw new Error(`Expected ${a} input tensors, received ${t}`);if(a>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const s=[];for(let e=0;e<i.length;++e){const t=i[e];if(!o.some((e=>-1!==e.indexOf(t))))throw new Error(`Output subscripts contain the label ${t} not present in the input subscripts.`);-1===s.indexOf(t)&&s.push(t)}for(let e=0;e<r.length;++e){const t=r[e];-1===s.indexOf(t)&&t!==Jn&&s.push(t)}const u=new Array(o.length);for(let e=0;e<a;++e){if(new Set(o[e].split("")).size!==o[e].length)throw new Error(`Found duplicate axes in input component ${o[e]}. Support for duplicate axes in input is not implemented yet.`);u[e]=[];for(let t=0;t<o[e].length;++t)u[e].push(s.indexOf(o[e][t]))}const l=s.length,c=[];for(let e=i.length;e<l;++e)c.push(e);return{allDims:s,summedDims:c,idDims:u}}function er(e,t){let n=new Array(e);n.fill(-1);for(let e=0;e<t.length;++e)n[t[e]]=e;const r=[];for(let t=0;t<e;++t)-1===n[t]&&r.push(t);return n=n.filter((e=>-1!==e)),{permutationIndices:n,expandDims:r}}function tr(e,t,n){const r=new Array(e);for(let e=0;e<n.length;++e){const i=n[e].shape;for(let n=0;n<t[e].length;++n)void 0===r[t[e][n]]?r[t[e][n]]=i[n]:(0,w.hu)(r[t[e][n]]===i[n],(()=>`Expected dimension ${r[t[e][n]]} at axis ${n} of input shaped ${JSON.stringify(i)}, but got dimension ${i[n]}`))}}function nr(e,t){const n=e,r=[];let i=0;0===e.length&&n.push(-1),i=e.length+1;for(let e=0;e<i;++e)r.push([]);const o=[];for(let e=0;e<n.length;++e){const i=ir(t,n[e]);for(const t of i)-1===o.indexOf(t)&&(r[e].push(t),o.push(t))}return{path:n,steps:r}}function rr(e){return e.every(((e,t)=>e===t))}function ir(e,t){const n=[];for(let r=0;r<e.length;++r)0!==e[r].length&&-1===e[r].indexOf(t)&&-1!==t||n.push(r);return n}function or(e,t,n=0){let r=[];if("number"==typeof t)(0,w.hu)(e.shape[n]%t==0,(()=>"Number of splits must evenly divide the axis.")),r=new Array(t).fill(e.shape[n]/t);else{const i=t.reduce(((e,t)=>(-1===t&&(e+=1),e)),0);(0,w.hu)(i<=1,(()=>"There should be only one negative value in split array."));const o=t.indexOf(-1);if(-1!==o){const r=t.reduce(((e,t)=>t>0?e+t:e));t[o]=e.shape[n]-r}(0,w.hu)(e.shape[n]===t.reduce(((e,t)=>e+t)),(()=>"The sum of sizes must match the size of the axis dimension.")),r=t}return r}function ar(e){return`Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ${e}`}function sr(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function ur(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}function lr(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function cr(e,t){return`size ${e} must be non-negative, not ${t}`}function pr(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function dr(e,t){return`Input to reshape is a SparseTensor with ${(0,w.NA)(e)}\n  dense values, but the requested shape requires a multiple of ${(0,w.NA)(t)}. inputShape=${e} outputShape= ${t}`}function hr(e,t){return`Input to reshape is a tensor with ${(0,w.NA)(e)} dense values, but the requested shape has ${(0,w.NA)(t)}. inputShape=${e} outputShape=${t}`}function fr(){return"segment ids must be >= 0"}function gr(){return"segment ids are not increasing"}function mr(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function yr(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}function br(e,t){let n,r=!1;for(e<=Cn?(n=e,r=!0):n=(0,w.jP)(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=(0,w.jP)(e,n+1);return n}function vr(e,t,n){const r=[],i=e.length;for(let o=0;o<i;o++)o!==t?r.push(e[o]):r.push(n);return r}function xr(e,t,n,r){const i=t.shape.length,o=e.shape.length;if(0!==r&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>o)throw new Error(`batchDims (${r}) must be less than rank(x) (\n    ${o}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let n=0;n<r;++n)if(e.shape[n]!==t.shape[n])throw new Error(`x.shape[${n}]: ${e.shape[n]} should be equal to indices.shape[${n}]: ${t.shape[n]}.`);const a=e.shape[n],s=[];let u=1,l=1,c=1;for(let t=0;t<r;++t)s.push(e.shape[t]),u*=e.shape[t];for(let t=r;t<n;t++)s.push(e.shape[t]),l*=e.shape[t];for(let e=r;e<i;e++)s.push(t.shape[e]);for(let t=n+1;t<o;t++)s.push(e.shape[t]),c*=e.shape[t];return{batchSize:u,sliceSize:c,outerSize:l,dimSize:a,outputShape:s}}function _r(e){try{return e.map((e=>(0,S.decodeString)(e)))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function wr(e){return e.map((e=>(0,S.encodeString)(e)))}var kr=n(3337),Sr=n(8333),Cr=n(8713);!function(){for(const e of rt)Ge(e)}()},9121:(e,t,n)=>{"use strict";n.d(t,{$HU:()=>bt,$g6:()=>te,$w:()=>Y,Acj:()=>be,BMI:()=>je,BiW:()=>gt,Byc:()=>j,CAk:()=>Te,CQl:()=>ft,D2d:()=>Yt,DlI:()=>dt,Eh3:()=>R,FKq:()=>zt,G3Y:()=>cn,GBy:()=>jt,Gcp:()=>Wt,HEU:()=>re,HZH:()=>xt,Hhh:()=>Pe,Hmb:()=>wt,IKK:()=>l,IMb:()=>x,J$2:()=>Ce,J7O:()=>$e,J_u:()=>_e,JhU:()=>y,Kgp:()=>lt,L8s:()=>Ut,Ly9:()=>C,M2y:()=>d,MIZ:()=>an,MRv:()=>$t,MZg:()=>Ne,NEP:()=>ae,NZg:()=>Ze,O3z:()=>Vt,OAf:()=>We,OR:()=>de,OU7:()=>Ve,OV7:()=>Ue,Omj:()=>ie,Oyi:()=>g,PYm:()=>Oe,PhF:()=>Rt,QCc:()=>m,QRR:()=>W,Qg5:()=>xe,QiL:()=>st,Qvg:()=>hn,RFZ:()=>T,ROF:()=>b,RQH:()=>It,RuY:()=>gn,SIB:()=>Ft,SX0:()=>ne,SYM:()=>r,SbG:()=>Ct,SpW:()=>o,T0n:()=>V,TQc:()=>Gt,TR1:()=>z,ToN:()=>dn,Tr8:()=>rn,Uyb:()=>pe,VGw:()=>i,Vbg:()=>Je,VcC:()=>U,VfG:()=>Re,Vn9:()=>Z,W0H:()=>it,XDQ:()=>fn,XLW:()=>_,XkS:()=>nn,Xze:()=>s,Y0y:()=>ue,YFo:()=>se,YoZ:()=>ze,ZbH:()=>Ae,ZjV:()=>Xt,Zz9:()=>F,_JP:()=>en,_V0:()=>xn,_Yw:()=>kt,_k9:()=>v,_tC:()=>Kt,a5O:()=>Pt,aJk:()=>p,avt:()=>we,b9H:()=>bn,bK0:()=>Jt,bV0:()=>Et,c17:()=>Xe,cWu:()=>un,cie:()=>H,cye:()=>rt,dDz:()=>ht,deh:()=>ce,dpD:()=>_t,e07:()=>Tt,e0R:()=>Zt,e6w:()=>mt,e7N:()=>Ee,eBW:()=>yn,eEB:()=>M,eZ0:()=>Le,ekb:()=>J,gJX:()=>E,h8e:()=>mn,hCO:()=>S,hGc:()=>Q,hdR:()=>oe,i5y:()=>Lt,iHb:()=>G,iJz:()=>ve,iWB:()=>ke,iZT:()=>ye,ik2:()=>P,jMg:()=>f,jQk:()=>Qt,jQs:()=>Ke,jeX:()=>he,kU:()=>Fe,kpP:()=>pn,kuV:()=>et,luS:()=>_n,lyA:()=>ut,mKl:()=>Mt,mTV:()=>Ge,mc4:()=>$,mhS:()=>N,mm_:()=>a,n9L:()=>sn,nhH:()=>Ht,nr8:()=>Ot,o0g:()=>pt,o2y:()=>L,oFR:()=>Nt,oHH:()=>ee,oT6:()=>u,p2w:()=>Dt,p4S:()=>K,pe_:()=>ct,q1x:()=>me,q2K:()=>qe,q8u:()=>Ye,qCd:()=>Ie,qIC:()=>Be,qWM:()=>ot,qi_:()=>ge,qkr:()=>vt,qw7:()=>h,r7n:()=>Se,s1s:()=>tn,sEM:()=>on,sHE:()=>fe,sJF:()=>c,sL$:()=>q,usg:()=>vn,uv1:()=>nt,vFR:()=>He,vtC:()=>Me,vwp:()=>le,w3H:()=>qt,w6g:()=>De,wUP:()=>D,wYB:()=>Bt,wYn:()=>Qe,we_:()=>at,wm:()=>I,wx7:()=>ln,x12:()=>B,xJR:()=>yt,xQA:()=>At,xnO:()=>A,y7R:()=>X,yQU:()=>tt,yj2:()=>O,zbQ:()=>St,zvY:()=>k,zws:()=>w});const r="Abs",i="Acos",o="Acosh",a="Add",s="AddN",u="All",l="Any",c="ArgMax",p="ArgMin",d="Asin",h="Asinh",f="Atan",g="Atanh",m="Atan2",y="AvgPool",b="AvgPoolGrad",v="AvgPool3D",x="AvgPool3DGrad",_="BatchMatMul",w="BatchToSpaceND",k="Bincount",S="BitwiseAnd",C="BroadcastTo",M="BroadcastArgs",T="Cast",E="Ceil",A="ClipByValue",F="Complex",O="ComplexAbs",R="Concat",N="Conv2D",D="Conv2DBackpropFilter",I="Conv2DBackpropInput",B="Conv3D",L="Conv3DBackpropFilterV2",P="Conv3DBackpropInputV2",$="Cos",z="Cosh",j="Cumprod",G="Cumsum",U="CropAndResize",W="DenseBincount",V="DepthToSpace",H="DepthwiseConv2dNative",q="DepthwiseConv2dNativeBackpropFilter",X="DepthwiseConv2dNativeBackpropInput",Y="Diag",K="Dilation2D",J="Dilation2DBackpropInput",Z="Dilation2DBackpropFilter",Q="Draw",ee="RealDiv",te="Einsum",ne="Elu",re="EluGrad",ie="Erf",oe="Equal",ae="Exp",se="ExpandDims",ue="Expm1",le="FFT",ce="Fill",pe="FlipLeftRight",de="Floor",he="FloorDiv",fe="FusedBatchNorm",ge="GatherV2",me="GatherNd",ye="Greater",be="GreaterEqual",ve="Identity",xe="IFFT",_e="Imag",we="IsFinite",ke="IsInf",Se="IsNan",Ce="LeakyRelu",Me="Less",Te="LessEqual",Ee="LinSpace",Ae="Log",Fe="Log1p",Oe="LogicalAnd",Re="LogicalNot",Ne="LogicalOr",De="LogicalXor",Ie="LogSoftmax",Be="LowerBound",Le="LRN",Pe="LRNGrad",$e="MatrixBandPart",ze="Max",je="Maximum",Ge="MaxPool",Ue="MaxPoolGrad",We="MaxPool3D",Ve="MaxPool3DGrad",He="MaxPoolWithArgmax",qe="Mean",Xe="Min",Ye="Minimum",Ke="MirrorPad",Je="Mod",Ze="Multinomial",Qe="Multiply",et="Neg",tt="NotEqual",nt="NonMaxSuppressionV3",rt="NonMaxSuppressionV4",it="NonMaxSuppressionV5",ot="OnesLike",at="OneHot",st="Pack",ut="PadV2",lt="Pool",ct="Pow",pt="Prelu",dt="Prod",ht="RaggedGather",ft="RaggedRange",gt="RaggedTensorToTensor",mt="Range",yt="Real",bt="Reciprocal",vt="Relu",xt="Reshape",_t="ResizeNearestNeighbor",wt="ResizeNearestNeighborGrad",kt="ResizeBilinear",St="ResizeBilinearGrad",Ct="Relu6",Mt="Reverse",Tt="Round",Et="Rsqrt",At="ScatterNd",Ft="TensorScatterUpdate",Ot="SearchSorted",Rt="Select",Nt="Selu",Dt="Slice",It="Sin",Bt="Sinh",Lt="Sign",Pt="Sigmoid",$t="Softplus",zt="Sqrt",jt="Sum",Gt="SpaceToBatchND",Ut="SplitV",Wt="Softmax",Vt="SparseFillEmptyRows",Ht="SparseReshape",qt="SparseSegmentMean",Xt="SparseSegmentSum",Yt="SparseToDense",Kt="SquaredDifference",Jt="Square",Zt="StaticRegexReplace",Qt="StridedSlice",en="StringNGrams",tn="StringSplit",nn="StringToHashBucketFast",rn="Sub",on="Tan",an="Tanh",sn="Tile",un="TopK",ln="Transform",cn="Transpose",pn="Unique",dn="Unpack",hn="UnsortedSegmentSum",fn="UpperBound",gn="ZerosLike",mn="Step",yn="FromPixels",bn="RotateWithOffset",vn="_FusedMatMul",xn="FusedConv2D",_n="FusedDepthwiseConv2D"},6151:(e,t,n)=>{"use strict";n.d(t,{Li:()=>d,T3:()=>g,bt:()=>f,nE:()=>h,pI:()=>u,tr:()=>c,uk:()=>l,wC:()=>p});var r=n(2885),i=n(5938),o=n(4706);const a=(0,i.R)("kernelRegistry",(()=>new Map)),s=(0,i.R)("gradRegistry",(()=>new Map));function u(e,t){const n=m(e,t);return a.get(n)}function l(e){return s.get(e)}function c(e){const t=a.entries(),n=[];for(;;){const{done:r,value:i}=t.next();if(r)break;const[o,a]=i,[s]=o.split("_");s===e&&n.push(a)}return n}function p(e){const{kernelName:t,backendName:n}=e,r=m(t,n);a.has(r)&&o.Z(`The kernel '${t}' for backend '${n}' is already registered`),a.set(r,e)}function d(e){const{kernelName:t}=e;s.has(t)&&(0,r.OB)().getBool("DEBUG")&&o.Z(`Overriding the gradient for '${t}'`),s.set(t,e)}function h(e,t){const n=m(e,t);if(!a.has(n))throw new Error(`The kernel '${e}' for backend '${t}' is not registered`);a.delete(n)}function f(e){if(!s.has(e))throw new Error(`The gradient '${e}' for backend is not registered`);s.delete(e)}function g(e,t){c(e).forEach((e=>{p(Object.assign({},e,{backendName:t}))}))}function m(e,t){return`${t}_${e}`}},4706:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i,c:()=>o});var r=n(2885);function i(...e){(0,r.OB)().getBool("IS_TEST")||(0,r.OB)().getBool("PROD")||console.warn(...e)}function o(...e){(0,r.OB)().getBool("IS_TEST")||(0,r.OB)().getBool("PROD")||console.log(...e)}},6235:(e,t,n)=>{"use strict";n.d(t,{W:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({abs_:function(e){const t=(0,o._1)(e,"x","abs");if("complex64"===t.dtype){const e={x:t};return r.BV.runKernel(i.yj2,e)}{const e={x:t};return r.BV.runKernel(i.SYM,e)}}})},7839:(e,t,n)=>{"use strict";n.d(t,{K:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({acos_:function(e){const t={x:(0,o._1)(e,"x","acos")};return r.BV.runKernel(i.VGw,t)}})},1470:(e,t,n)=>{"use strict";n.d(t,{_:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({acosh_:function(e){const t={x:(0,o._1)(e,"x","acosh")};return r.BV.runKernel(i.SpW,t)}})},6407:(e,t,n)=>{"use strict";n.d(t,{I:()=>s});var r=n(7097),i=n(9121),o=n(747),a=n(3740);const s=(0,n(2668).op)({add_:function(e,t){let n=(0,a._1)(e,"a","add"),s=(0,a._1)(t,"b","add");[n,s]=(0,o.makeTypesMatch)(n,s);const u={a:n,b:s};return r.BV.runKernel(i.mm_,u)}})},781:(e,t,n)=>{"use strict";n.d(t,{$:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({all_:function(e,t=null,n=!1){const a={x:(0,o._1)(e,"x","all","bool")},s={axis:t,keepDims:n};return r.BV.runKernel(i.oT6,a,s)}})},2998:(e,t,n)=>{"use strict";n.d(t,{Y:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({any_:function(e,t=null,n=!1){const a={x:(0,o._1)(e,"x","any","bool")},s={axis:t,keepDims:n};return r.BV.runKernel(i.IKK,a,s)}})},47:(e,t,n)=>{"use strict";n.d(t,{N:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({argMax_:function(e,t=0){const n={x:(0,o._1)(e,"x","argMax")},a={axis:t};return r.BV.runKernel(i.sJF,n,a)}})},7394:(e,t,n)=>{"use strict";n.d(t,{v:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({argMin_:function(e,t=0){const n={x:(0,o._1)(e,"x","argMin")},a={axis:t};return r.BV.runKernel(i.aJk,n,a)}})},2421:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({asin_:function(e){const t={x:(0,o._1)(e,"x","asin")};return r.BV.runKernel(i.M2y,t)}})},1891:(e,t,n)=>{"use strict";n.d(t,{V:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({asinh_:function(e){const t={x:(0,o._1)(e,"x","asinh")};return r.BV.runKernel(i.qw7,t)}})},7037:(e,t,n)=>{"use strict";n.d(t,{z:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({atan_:function(e){const t={x:(0,o._1)(e,"x","atan")};return r.BV.runKernel(i.jMg,t)}})},9812:(e,t,n)=>{"use strict";n.d(t,{f:()=>s});var r=n(7097),i=n(9121),o=n(747),a=n(3740);const s=(0,n(2668).op)({atan2_:function(e,t){let n=(0,a._1)(e,"a","atan2"),s=(0,a._1)(t,"b","atan2");[n,s]=(0,o.makeTypesMatch)(n,s);const u={a:n,b:s};return r.BV.runKernel(i.QCc,u)}})},369:(e,t,n)=>{"use strict";n.d(t,{C:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({atanh_:function(e){const t={x:(0,o._1)(e,"x","atanh")};return r.BV.runKernel(i.Oyi,t)}})},5176:(e,t,n)=>{"use strict";n.d(t,{w:()=>p});var r=n(7097),i=n(9121),o=n(3740),a=n(569),s=n(2271),u=n(2582),l=n(2668),c=n(4968);const p=(0,l.op)({avgPool_:function(e,t,n,l,p){const d=(0,o._1)(e,"x","avgPool","float32");a.hu(u.jT(n,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`));let h=d,f=!1;3===d.rank&&(f=!0,h=(0,c.X)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),a.hu(4===h.rank,(()=>`Error in avgPool: x must be rank 4 but got rank ${h.rank}.`)),u.m("avgPool",l,p);const g={x:h},m={filterSize:t,strides:n,pad:l,dimRoundingMode:p};let y=r.BV.runKernel(i.JhU,g,m);return y=(0,s.p)(y,d.dtype),f?(0,c.X)(y,[y.shape[1],y.shape[2],y.shape[3]]):y}})},3591:(e,t,n)=>{"use strict";n.d(t,{LJ:()=>c,Q3:()=>l,Vh:()=>o,YB:()=>i,kz:()=>a,lB:()=>u,rv:()=>s,sY:()=>p});var r=n(569);function i(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function o(e,t,n){const r=e.length+t.length,i=[];let o=0,a=0;for(let s=0;s<r;s++)-1===n.indexOf(s)?i.push(e[o++]):i.push(t[a++]);return i}function a(e,t){const n=[],r=e.length;for(let i=0;i<r;i++)-1===t.indexOf(i)&&n.push(e[i]);return[n,t.map((t=>e[t]))]}function s(e,t){return o(e,t.map((e=>1)),t)}function u(e,t,n){r.hu(i(t,n),(()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`))}function l(e,t){if(i(e,t))return null;const n=[];for(let r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((e=>n.push(e))),n}function c(e){return e.map(((e,t)=>[t,e])).sort(((e,t)=>e[1]-t[1])).map((e=>e[0]))}function p(e,t){const n=[];for(let r=t-e;r<t;++r)n.push(r);return n}},8441:(e,t,n)=>{"use strict";n.d(t,{E:()=>s});var r=n(7097),i=n(9121),o=n(3740),a=n(569);const s=(0,n(2668).op)({batchToSpaceND_:function(e,t,n){const s=(0,o._1)(e,"x","batchToSpaceND"),u=t.reduce(((e,t)=>e*t));a.hu(s.rank>=1+t.length,(()=>`input rank is ${s.rank} but should be > than blockShape.length ${t.length}`)),a.hu(n.length===t.length,(()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`)),a.hu(s.shape[0]%u==0,(()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${u}`));const l={x:s},c={blockShape:t,crops:n};return r.BV.runKernel(i.zws,l,c)}})},7505:(e,t,n)=>{"use strict";n.d(t,{t:()=>u});var r=n(7097),i=n(9121),o=n(3740),a=n(569),s=n(4968);const u=(0,n(2668).op)({batchNorm_:function(e,t,n,u,l,c){null==c&&(c=.001);const p=(0,o._1)(e,"x","batchNorm"),d=(0,o._1)(t,"mean","batchNorm"),h=(0,o._1)(n,"variance","batchNorm");let f,g;null!=l&&(f=(0,o._1)(l,"scale","batchNorm")),null!=u&&(g=(0,o._1)(u,"offset","batchNorm")),a.hu(d.rank===h.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),a.hu(null==g||d.rank===g.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),a.hu(null==f||d.rank===f.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const m={x:function(e){let t;return t=0===e.rank||1===e.rank?(0,s.X)(e,[1,1,1,e.size]):2===e.rank?(0,s.X)(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?(0,s.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e,t}(p),scale:f,offset:g,mean:d,variance:h},y={varianceEpsilon:c},b=r.BV.runKernel(i.sHE,m,y);return(0,s.X)(b,p.shape)}})},8247:(e,t,n)=>{"use strict";n.d(t,{U:()=>c});var r=n(7097),i=n(9121),o=n(3740),a=n(569),s=n(8723),u=n(2668),l=n(4968);const c=(0,u.op)({broadcastTo_:function(e,t){let n=(0,o._1)(e,"broadcastTo","x");const u=n.shape;if((0,a.Mu)(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const e=n.shape.slice();for(;e.length<t.length;)e.unshift(1);n=(0,l.X)(n,e)}const c=n.shape,p=Array.from(t);for(let e=t.length-1;e>=0;e--)if(c[e]===t[e])p[e]=1;else if(1!==n.shape[e])throw new Error(`broadcastTo(): [${u}] cannot be broadcast to [${t}].`);if(0===p.map(((e,t)=>e>1?t:-1)).filter((e=>e>=0)).length)return(0,s.d)(n);const d={x:n},h={reps:p};return r.BV.runKernel(i.n9L,d,h)}})},2200:(e,t,n)=>{"use strict";function r(e,t){const n=e.length,r=[];for(let i=0;i<n;i++){const o=n-1-i,a=e[o]||1;(t[t.length-1-i]||1)>1&&1===a&&r.unshift(o)}return r}function i(e,t){const n=[];for(let r=0;r<t.length;r++){const i=e[e.length-r-1],o=t.length-r-1,a=t[o];(null==i||1===i&&a>1)&&n.unshift(o)}return n}function o(e,t){const n=Math.max(e.length,t.length),r=new Array(n);for(let i=0;i<n;i++){let o=e[e.length-i-1];null==o&&(o=1);let a=t[t.length-i-1];if(null==a&&(a=1),1===o)r[n-i-1]=a;else if(1===a)r[n-i-1]=o;else{if(o!==a)throw Error(`Operands could not be broadcast together with shapes ${e} and ${t}.`);r[n-i-1]=o}}return r}n.r(t),n.d(t,{assertAndGetBroadcastShape:()=>o,getBroadcastDims:()=>r,getReductionAxes:()=>i})},2657:(e,t,n)=>{"use strict";n.d(t,{f:()=>o});var r=n(4077),i=n(569);function o(e,t="float32",n){return t=t||"float32",i.Mu(e),new r.YD(e,t,n)}},2271:(e,t,n)=>{"use strict";n.d(t,{p:()=>s});var r=n(7097),i=n(9121),o=n(3740),a=n(569);const s=(0,n(2668).op)({cast_:function(e,t){const n=(0,o._1)(e,"x","cast");if(!a.LP(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const s={x:n},u={dtype:t};return r.BV.runKernel(i.RFZ,s,u)}})},6825:(e,t,n)=>{"use strict";n.d(t,{m:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({ceil_:function(e){const t={x:(0,o._1)(e,"x","ceil","float32")};return r.BV.runKernel(i.gJX,t)}})},2279:(e,t,n)=>{"use strict";n.d(t,{i:()=>u});var r=n(7097),i=n(9121),o=n(3740),a=n(569),s=n(4006);const u=(0,n(2668).op)({clipByValue_:function(e,t,n){const u=(0,o._1)(e,"x","clipByValue");if(a.hu(t<=n,(()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`)),t===n)return(0,s.h)(u.shape,t,u.dtype);const l={x:u},c={clipValueMin:t,clipValueMax:n};return r.BV.runKernel(i.xnO,l,c)}})},8723:(e,t,n)=>{"use strict";n.d(t,{d:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({clone_:function(e){const t={x:(0,o._1)(e,"x","clone","string_or_numeric")};return r.BV.runKernel(i.iJz,t)}})},1661:(e,t,n)=>{"use strict";n.d(t,{P:()=>s});var r=n(7097),i=n(9121),o=n(3740),a=n(569);const s=(0,n(2668).op)({complex_:function(e,t){const n=(0,o._1)(e,"real","complex"),s=(0,o._1)(t,"imag","complex");a.k5(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const u={real:n,imag:s};return r.BV.runKernel(i.Zz9,u)}})},6884:(e,t,n)=>{"use strict";n.d(t,{z:()=>u});var r=n(7097),i=n(9121),o=n(3740),a=n(569),s=n(8723);const u=(0,n(2668).op)({concat_:function(e,t=0){(0,a.hu)(e.length>=1,(()=>"Pass at least one tensor to concat"));const n=(0,o.sI)(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((e=>{if("complex64"!==e.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${e.dtype}. `)})),1===n.length)return(0,s.d)(n[0]);const u=n,l={axis:t};return r.BV.runKernel(i.Eh3,u,l)}})},1355:(e,t,n)=>{"use strict";n.d(t,{P:()=>l});var r=n(3740),i=n(569),o=n(4794),a=n(2582),s=n(2668),u=n(4968);const l=(0,s.op)({conv1d_:function(e,t,n,s,l="NWC",c=1,p){const d=(0,r._1)(e,"x","conv1d"),h=(0,r._1)(t,"filter","conv1d");let f=d,g=!1;2===d.rank&&(g=!0,f=(0,u.X)(d,[1,d.shape[0],d.shape[1]])),i.hu(3===f.rank,(()=>`Error in conv1d: input must be rank 3, but got rank ${f.rank}.`)),i.hu(3===h.rank,(()=>`Error in conv1d: filter must be rank 3, but got rank ${h.rank}.`)),a.m("conv1d",s,p),i.hu(f.shape[2]===h.shape[1],(()=>`Error in conv1d: depth of input (${f.shape[2]}) must match input depth for filter ${h.shape[1]}.`)),i.hu(a.jT(n,c),(()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${c}'`)),i.hu(a.U3(c),(()=>"Error in conv1D: Dilated rates should be larger than 0.")),i.hu(a.U3(n),(()=>"Error in conv1D: Stride should be larger than 0.")),i.hu("NWC"===l,(()=>`Error in conv1d: got dataFormat of ${l} but only NWC is currently supported.`));const m=(0,u.X)(h,[1,h.shape[0],h.shape[1],h.shape[2]]),y=(0,u.X)(f,[f.shape[0],1,f.shape[1],f.shape[2]]),b=[1,n],v=[1,c],x=(0,o.T)(y,m,b,s,"NHWC",v,p);return g?(0,u.X)(x,[x.shape[2],x.shape[3]]):(0,u.X)(x,[x.shape[0],x.shape[2],x.shape[3]])}})},4794:(e,t,n)=>{"use strict";n.d(t,{T:()=>c});var r=n(7097),i=n(9121),o=n(3740),a=n(569),s=n(2582),u=n(2668),l=n(4968);const c=(0,u.op)({conv2d_:function(e,t,n,u,c="NHWC",p=[1,1],d){const h=(0,o._1)(e,"x","conv2d","float32"),f=(0,o._1)(t,"filter","conv2d","float32");let g=h,m=!1;3===h.rank&&(m=!0,g=(0,l.X)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),a.hu(4===g.rank,(()=>`Error in conv2d: input must be rank 4, but got rank ${g.rank}.`)),a.hu(4===f.rank,(()=>`Error in conv2d: filter must be rank 4, but got rank ${f.rank}.`)),s.m("conv2d",u,d);const y="NHWC"===c?g.shape[3]:g.shape[1];a.hu(y===f.shape[2],(()=>`Error in conv2d: depth of input (${y}) must match input depth for filter ${f.shape[2]}.`)),a.hu(s.jT(n,p),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${p}'`)),a.hu(s.U3(p),(()=>"Error in conv2D: Dilated rates should be larger than 0.")),a.hu(s.U3(n),(()=>"Error in conv2D: Strides should be larger than 0."));const b={x:g,filter:f},v={strides:n,pad:u,dataFormat:c,dilations:p,dimRoundingMode:d},x=r.BV.runKernel(i.mhS,b,v);return m?(0,l.X)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},6013:(e,t,n)=>{"use strict";n.d(t,{p:()=>l});var r=n(7097),i=n(9121),o=n(569),a=n(2582),s=n(2668),u=n(4968);const l=(0,s.op)({conv2DBackpropFilter_:function(e,t,n,s,l,c="NHWC",p){let d=e;3===e.rank&&(d=(0,u.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let h=t;3===h.rank&&(h=(0,u.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]])),o.hu(4===d.rank,(()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${d.shape}.`)),o.hu(4===h.rank,(()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${h.shape}.`)),o.hu(4===n.length,(()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`));const f="NHWC"===c?d.shape[3]:d.shape[1],g="NHWC"===c?h.shape[3]:h.shape[1];o.hu(f===n[2],(()=>`Error in conv2dDerFilter: depth of input ${f}) must match input depth in filter (${n[2]}.`)),o.hu(g===n[3],(()=>`Error in conv2dDerFilter: depth of dy (${g}) must match output depth for filter (${n[3]}).`)),a.m("conv2dDerFilter",l,p);const m={x:d,dy:h},y={strides:s,pad:l,dataFormat:c,dimRoundingMode:p,filterShape:n};return r.BV.runKernel(i.wUP,m,y)}})},9832:(e,t,n)=>{"use strict";n.d(t,{_:()=>l});var r=n(7097),i=n(9121),o=n(569),a=n(2582),s=n(2668),u=n(4968);const l=(0,s.op)({conv2DBackpropInput_:function(e,t,n,s,l,c="NHWC",p){o.hu(e.length===t.rank,(()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`));let d=e,h=t,f=!1;3===t.rank&&(f=!0,h=(0,u.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]),d=[1,e[0],e[1],e[2]]),o.hu(4===d.length,(()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${d.length}.`)),o.hu(4===h.rank,(()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${h.rank}`)),o.hu(4===n.rank,(()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`));const g="NHWC"===c?d[3]:d[1],m="NHWC"===c?h.shape[3]:h.shape[1];o.hu(g===n.shape[2],(()=>`Error in conv2dDerInput: depth of input (${g}) must match input depth for filter ${n.shape[2]}.`)),o.hu(m===n.shape[3],(()=>`Error in conv2dDerInput: depth of output (${m}) must match output depth for filter ${n.shape[3]}.`)),a.m("conv2dDerInput",l,p);const y={dy:h,filter:n},b={strides:s,pad:l,dataFormat:c,dimRoundingMode:p,inputShape:d},v=r.BV.runKernel(i.wm,y,b);return f?(0,u.X)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},1405:(e,t,n)=>{"use strict";n.d(t,{b:()=>o});var r=n(3740),i=n(9832);const o=(0,n(2668).op)({conv2dTranspose_:function(e,t,n,o,a,s){const u=(0,r._1)(e,"x","conv2dTranspose"),l=(0,r._1)(t,"filter","conv2dTranspose");return(0,i._)(n,u,l,o,a,"NHWC",s)}})},7594:(e,t,n)=>{"use strict";n.d(t,{_:()=>u});var r=n(7097),i=n(9121),o=n(569),a=n(2668),s=n(4968);const u=(0,a.op)({conv3DBackpropInput_:function(e,t,n,a,u){o.hu(e.length===t.rank,(()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`));let l=e,c=t,p=!1;4===t.rank&&(p=!0,c=(0,s.X)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),l=[1,e[0],e[1],e[2],e[3]]);const d=l[4],h=c.shape[4];o.hu(5===l.length,(()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${l.length}.`)),o.hu(5===c.rank,(()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${c.rank}`)),o.hu(5===n.rank,(()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`)),o.hu(d===n.shape[3],(()=>`Error in conv3dDerInput: depth of input (${d}) must match input depth for filter ${n.shape[3]}.`)),o.hu(h===n.shape[4],(()=>`Error in conv3dDerInput: depth of output (${h}) must match output depth for filter ${n.shape[4]}.`));const f={dy:c,filter:n},g={pad:u,strides:a,inputShape:l},m=r.BV.runKernel(i.ik2,f,g);return p?(0,s.X)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}})},2582:(e,t,n)=>{"use strict";n.d(t,{I0:()=>f,Ix:()=>s,Rf:()=>i,U3:()=>m,Xw:()=>o,aO:()=>l,jT:()=>g,jw:()=>u,m:()=>b,pl:()=>a,sl:()=>y});var r=n(569);function i(e,t,n,r,i="NHWC",o){return s(e,[...t,e[3]],n,o,r,null,null,y(i))}function o(e,t,n,r,i,o,a="channelsLast"){const[u,l]=c(t);let p;if("channelsLast"===a)p=[u,l,e[3],e[3]];else{if("channelsFirst"!==a)throw new Error(`Unknown dataFormat ${a}`);p=[u,l,e[1],e[1]]}return s(e,p,n,r,i,o,!1,a)}function a(e,t,n,r,i,o,a="NDHWC"){const[s,l,c]=p(t);let d,h;if("NDHWC"===a)h="channelsLast",d=[s,l,c,e[4],e[4]];else{if("NCDHW"!==a)throw new Error(`Unknown dataFormat ${a}`);h="channelsFirst",d=[s,l,c,e[1],e[1]]}return u(e,d,n,r,i,!1,h,o)}function s(e,t,n,r,i,o,a=!1,s="channelsLast"){let[u,p,f,g]=[-1,-1,-1,-1];if("channelsLast"===s)[u,p,f,g]=e;else{if("channelsFirst"!==s)throw new Error(`Unknown dataFormat ${s}`);[u,g,p,f]=e}const[m,y,,b]=t,[v,x]=c(n),[_,w]=c(r),k=d(m,_),S=d(y,w),{padInfo:C,outHeight:M,outWidth:T}=function(e,t,n,r,i,o,a,s,u){let c,p,d;if("number"==typeof e){c={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};const i=function(e,t,n,r,i){null==r&&(r=l(e,t,n));const o=e[1];return[h((e[0]-t+2*r)/n+1,i),h((o-t+2*r)/n+1,i)]}([t,n],o,r,e,s);p=i[0],d=i[1]}else if("same"===e){p=Math.ceil(t/r),d=Math.ceil(n/i);const e=Math.max(0,(p-1)*r+o-t),s=Math.max(0,(d-1)*i+a-n),u=Math.floor(e/2),l=e-u,h=Math.floor(s/2);c={top:u,bottom:l,left:h,right:s-h,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},p=Math.ceil((t-o+1)/r),d=Math.ceil((n-a+1)/i);else{if("object"!=typeof e)throw Error(`Unknown padding parameter: ${e}`);{const l="channelsLast"===u?e[1][0]:e[2][0],f="channelsLast"===u?e[1][1]:e[2][1],g="channelsLast"===u?e[2][0]:e[3][0],m="channelsLast"===u?e[2][1]:e[3][1];c={top:l,bottom:f,left:g,right:m,type:0===l&&0===f&&0===g&&0===m?"VALID":"EXPLICIT"},p=h((t-o+l+f)/r+1,s),d=h((n-a+g+m)/i+1,s)}}return{padInfo:c,outHeight:p,outWidth:d}}(i,p,f,v,x,k,S,o,s),E=a?b*g:b;let A;return"channelsFirst"===s?A=[u,E,M,T]:"channelsLast"===s&&(A=[u,M,T,E]),{batchSize:u,dataFormat:s,inHeight:p,inWidth:f,inChannels:g,outHeight:M,outWidth:T,outChannels:E,padInfo:C,strideHeight:v,strideWidth:x,filterHeight:m,filterWidth:y,effectiveFilterHeight:k,effectiveFilterWidth:S,dilationHeight:_,dilationWidth:w,inShape:e,outShape:A,filterShape:t}}function u(e,t,n,r,i,o=!1,a="channelsLast",s){let[u,c,f,g,m]=[-1,-1,-1,-1,-1];if("channelsLast"===a)[u,c,f,g,m]=e;else{if("channelsFirst"!==a)throw new Error(`Unknown dataFormat ${a}`);[u,m,c,f,g]=e}const[y,b,v,,x]=t,[_,w,k]=p(n),[S,C,M]=p(r),T=d(y,S),E=d(b,C),A=d(v,M),{padInfo:F,outDepth:O,outHeight:R,outWidth:N}=function(e,t,n,r,i,o,a,s,u,c,p){let d,f,g,m;if("valid"===e&&(e=0),"number"==typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};const y=function(e,t,n,r,i,o){null==i&&(i=l(e,t[0],r[0]));const a=[0,0,0,1];for(let n=0;n<3;n++)e[n]+2*i>=t[n]&&(a[n]=h((e[n]-t[n]+2*i)/r[n]+1,o));return a}([t,n,r,1],[s,u,c],0,[i,o,a],e,p);f=y[0],g=y[1],m=y[2]}else{if("same"!==e)throw Error(`Unknown padding parameter: ${e}`);{f=Math.ceil(t/i),g=Math.ceil(n/o),m=Math.ceil(r/a);const e=(f-1)*i+s-t,l=(g-1)*o+u-n,p=(m-1)*a+c-r,h=Math.floor(e/2),y=e-h,b=Math.floor(l/2),v=l-b,x=Math.floor(p/2);d={top:b,bottom:v,left:x,right:p-x,front:h,back:y,type:"SAME"}}}return{padInfo:d,outDepth:f,outHeight:g,outWidth:m}}(i,c,f,g,_,w,k,T,E,A,s),D=o?x*m:x;let I;return"channelsFirst"===a?I=[u,D,O,R,N]:"channelsLast"===a&&(I=[u,O,R,N,D]),{batchSize:u,dataFormat:a,inDepth:c,inHeight:f,inWidth:g,inChannels:m,outDepth:O,outHeight:R,outWidth:N,outChannels:D,padInfo:F,strideDepth:_,strideHeight:w,strideWidth:k,filterDepth:y,filterHeight:b,filterWidth:v,effectiveFilterDepth:T,effectiveFilterHeight:E,effectiveFilterWidth:A,dilationDepth:S,dilationHeight:C,dilationWidth:M,inShape:e,outShape:I,filterShape:t}}function l(e,t,n,r=1){const i=d(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function c(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function p(e){return"number"==typeof e?[e,e,e]:e}function d(e,t){return t<=1?e:e+(e-1)*(t-1)}function h(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function f(e){const[t,n,r]=c(e);return 1===t&&1===n&&1===r}function g(e,t){return f(e)||f(t)}function m(e){return c(e).every((e=>e>0))}function y(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function b(e,t,n){if(null!=n){if("string"==typeof t)throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if("number"==typeof t)r.hu(r.GN(t),(()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`));else{if("object"!=typeof t)throw Error(`Error in ${e}: Unknown padding parameter: ${t}`);t.forEach((t=>{t.forEach((t=>{r.hu(r.GN(t),(()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`))}))}))}}}},173:(e,t,n)=>{"use strict";n.d(t,{m:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({cos_:function(e){const t={x:(0,o._1)(e,"x","cos","float32")};return r.BV.runKernel(i.mc4,t)}})},2699:(e,t,n)=>{"use strict";n.d(t,{f:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({cosh_:function(e){const t={x:(0,o._1)(e,"x","cosh","float32")};return r.BV.runKernel(i.TR1,t)}})},9640:(e,t,n)=>{"use strict";n.d(t,{$:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({cumprod_:function(e,t=0,n=!1,a=!1){const s={x:(0,o._1)(e,"x","cumprod")},u={axis:t,exclusive:n,reverse:a};return r.BV.runKernel(i.Byc,s,u)}})},7405:(e,t,n)=>{"use strict";n.d(t,{z:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({cumsum_:function(e,t=0,n=!1,a=!1){const s={x:(0,o._1)(e,"x","cumsum")},u={axis:t,exclusive:n,reverse:a};return r.BV.runKernel(i.iHb,s,u)}})},9112:(e,t,n)=>{"use strict";n.d(t,{n:()=>s});var r=n(7097),i=n(9121),o=n(3740),a=n(569);const s=(0,n(2668).op)({depthToSpace_:function(e,t,n="NHWC"){const s=(0,o._1)(e,"x","depthToSpace","float32"),u="NHWC"===n?s.shape[1]:s.shape[2],l="NHWC"===n?s.shape[2]:s.shape[3],c="NHWC"===n?s.shape[3]:s.shape[1];a.hu(t>1,(()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`)),a.hu(u*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${u} and ${t}  for depthToSpace with input shape\n    ${s.shape}`)),a.hu(l*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${l} and ${t} for depthToSpace with input shape\n        ${s.shape}`)),a.hu(c%(t*t)==0,(()=>`Dimension size must be evenly divisible by ${t*t} but is ${c} for depthToSpace with input shape ${s.shape}`));const p={x:s},d={blockSize:t,dataFormat:n};return r.BV.runKernel(i.T0n,p,d)}})},4718:(e,t,n)=>{"use strict";n.d(t,{B:()=>c});var r=n(7097),i=n(9121),o=n(3740),a=n(569),s=n(2582),u=n(2668),l=n(4968);const c=(0,u.op)({depthwiseConv2d_:function(e,t,n,u,c="NHWC",p=[1,1],d){const h=(0,o._1)(e,"x","depthwiseConv2d","float32"),f=(0,o._1)(t,"filter","depthwiseConv2d","float32");let g=h,m=!1;3===h.rank&&(m=!0,g=(0,l.X)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),a.hu(4===g.rank,(()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${g.rank}.`)),a.hu(4===f.rank,(()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${f.rank}.`));const y="NHWC"===c?g.shape[3]:g.shape[1];a.hu(y===f.shape[2],(()=>`Error in depthwiseConv2d: number of input channels (${y}) must match the inChannels dimension in filter ${f.shape[2]}.`)),s.m("depthwiseConv2d",u,d);const b={x:g,filter:f},v={strides:n,pad:u,dataFormat:c,dilations:p,dimRoundingMode:d},x=r.BV.runKernel(i.cie,b,v);return m?(0,l.X)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},8098:(e,t,n)=>{"use strict";n.d(t,{z:()=>s});var r=n(7097),i=n(9121),o=n(2668),a=n(4968);const s=(0,o.op)({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,o,s,u=[1,1],l){let c=e;3===e.rank&&(c=(0,a.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let p=t;3===p.rank&&(p=(0,a.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const d={x:c,dy:p},h={strides:o,pad:s,dimRoundingMode:l,dilations:u,filterShape:n};return r.BV.runKernel(i.sL$,d,h)}})},4375:(e,t,n)=>{"use strict";n.d(t,{v:()=>s});var r=n(7097),i=n(9121),o=n(2668),a=n(4968);const s=(0,o.op)({depthwiseConv2dNativeBackpropInput_:function(e,t,n,o,s,u=[1,1],l){let c=t,p=!1;3===t.rank&&(p=!0,c=(0,a.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const d={dy:c,filter:n},h={strides:o,pad:s,dimRoundingMode:l,dilations:u,inputShape:e},f=r.BV.runKernel(i.y7R,d,h);return p?(0,a.X)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}})},557:(e,t,n)=>{"use strict";n.d(t,{W:()=>l});var r=n(7097),i=n(9121),o=n(3740),a=n(569),s=n(2668),u=n(4968);const l=(0,s.op)({dilation2d_:function(e,t,n,s,l=[1,1],c="NHWC"){const p=(0,o._1)(e,"x","dilation2d"),d=(0,o._1)(t,"filter","dilation2d");a.hu(3===p.rank||4===p.rank,(()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${p.rank}.`)),a.hu(3===d.rank,(()=>`Error in dilation2d: filter must be rank 3, but got rank ${d.rank}.`)),a.hu("NHWC"===c,(()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${c}`));let h=p,f=!1;3===p.rank&&(h=(0,u.X)(p,[1,p.shape[0],p.shape[1],p.shape[2]]),f=!0),a.hu(h.shape[3]===d.shape[2],(()=>`Error in dilation2d:  input and filter must have the same depth: ${h.shape[3]} vs ${d.shape[2]}`));const g={x:h,filter:d},m={strides:n,pad:s,dilations:l},y=r.BV.runKernel(i.p4S,g,m);return f?(0,u.X)(y,[y.shape[1],y.shape[2],y.shape[3]]):y}})},1274:(e,t,n)=>{"use strict";n.d(t,{h:()=>u});var r=n(7097),i=n(9121),o=n(747),a=n(3740),s=n(9165);const u=(0,n(2668).op)({div_:function(e,t){let n=(0,a._1)(e,"a","div"),u=(0,a._1)(t,"b","div");if([n,u]=(0,o.makeTypesMatch)(n,u),"int32"===n.dtype&&"int32"===u.dtype)return(0,s.q)(n,u);const l={a:n,b:u};return r.BV.runKernel(i.oHH,l,{})}})},9322:(e,t,n)=>{"use strict";n.d(t,{N:()=>c});var r=n(747),i=n(3740),o=n(1274),a=n(6477),s=n(2668),u=n(5912),l=n(6577);const c=(0,s.op)({divNoNan_:function(e,t){let n=(0,i._1)(e,"a","div"),s=(0,i._1)(t,"b","div");[n,s]=(0,r.makeTypesMatch)(n,s);const c=(0,o.h)(n,s),p=(0,l.P)(c),d=(0,a.D)(s,p);return(0,u.a)(d,p,c)}})},548:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var r=n(3740),i=n(569),o=n(8687),a=n(2668),s=n(4968);const u=(0,a.op)({dot_:function(e,t){const n=(0,r._1)(e,"t1","dot"),a=(0,r._1)(t,"t2","dot");i.hu(!(1!==n.rank&&2!==n.rank||1!==a.rank&&2!==a.rank),(()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${a.rank}.`));const u=1===n.rank?n.size:n.shape[1],l=1===a.rank?a.size:a.shape[0];if(i.hu(u===l,(()=>`Error in dot: inner dimensions of inputs must match, but got ${u} and ${l}.`)),1===n.rank&&1===a.rank){const e=(0,s.X)(n,[1,-1]),t=(0,s.X)(a,[-1,1]),r=(0,o.O)(e,t);return(0,s.X)(r,[])}if(1===n.rank&&2===a.rank){const e=(0,s.X)(n,[1,-1]),t=(0,s.X)(a,[a.shape[0],a.shape[1]]),r=(0,o.O)(e,t);return(0,s.X)(r,[r.size])}if(2===n.rank&&1===a.rank){const e=(0,s.X)(a,[-1,1]),t=(0,o.O)(n,e);return(0,s.X)(t,[t.size])}{const e=(0,s.X)(a,[a.shape[0],a.shape[1]]);return(0,o.O)(n,e)}}})},3233:(e,t,n)=>{"use strict";n.d(t,{p:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({elu_:function(e){const t={x:(0,o._1)(e,"x","elu","float32")};return r.BV.runKernel(i.SX0,t)}})},6477:(e,t,n)=>{"use strict";n.d(t,{D:()=>u});var r=n(7097),i=n(9121),o=n(747),a=n(3740),s=n(2200);const u=(0,n(2668).op)({equal_:function(e,t){let n=(0,a._1)(e,"a","equal","string_or_numeric"),u=(0,a._1)(t,"b","equal","string_or_numeric");[n,u]=(0,o.makeTypesMatch)(n,u),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);const l={a:n,b:u};return r.BV.runKernel(i.hdR,l)}})},4650:(e,t,n)=>{"use strict";n.d(t,{q:()=>u});var r=n(7097),i=n(9121),o=n(3740),a=n(569),s=n(2271);const u=(0,n(2668).op)({erf_:function(e){let t=(0,o._1)(e,"x","erf");a.hu("int32"===t.dtype||"float32"===t.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===t.dtype&&(t=(0,s.p)(t,"float32"));const n={x:t};return r.BV.runKernel(i.Omj,n)}})},1954:(e,t,n)=>{"use strict";n.d(t,{d:()=>i});var r=n(3561);const i=(0,n(2668).op)({euclideanNorm_:function(e,t=null,n=!1){return(0,r.K)(e,"euclidean",t,n)}})},4842:(e,t,n)=>{"use strict";n.d(t,{Q:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({exp_:function(e){const t={x:(0,o._1)(e,"x","exp")};return r.BV.runKernel(i.NEP,t)}})},1300:(e,t,n)=>{"use strict";n.d(t,{d:()=>s});var r=n(7097),i=n(9121),o=n(3740),a=n(569);const s=(0,n(2668).op)({expandDims_:function(e,t=0){const n=(0,o._1)(e,"x","expandDims","string_or_numeric");a.hu(t<=n.rank,(()=>"Axis must be <= rank of the tensor"));const s={input:n},u={dim:t};return r.BV.runKernel(i.YFo,s,u)}})},3426:(e,t,n)=>{"use strict";n.d(t,{t:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({expm1_:function(e){const t={x:(0,o._1)(e,"x","expm1")};return r.BV.runKernel(i.Y0y,t)}})},4006:(e,t,n)=>{"use strict";n.d(t,{h:()=>a});var r=n(7097),i=n(9121),o=n(569);function a(e,t,n){(0,o.Mu)(e);const a={shape:e,value:t,dtype:n=n||(0,o.D2)(t)};return r.BV.runKernel(i.deh,{},a)}},6943:(e,t,n)=>{"use strict";n.d(t,{G:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({floor_:function(e){const t={x:(0,o._1)(e,"x","floor","float32")};return r.BV.runKernel(i.OR,t)}})},9165:(e,t,n)=>{"use strict";n.d(t,{q:()=>s});var r=n(7097),i=n(9121),o=n(747),a=n(3740);const s=(0,n(2668).op)({floorDiv_:function(e,t){let n=(0,a._1)(e,"a","floorDiv"),s=(0,a._1)(t,"b","floorDiv");[n,s]=(0,o.makeTypesMatch)(n,s);const u={a:n,b:s};return r.BV.runKernel(i.jeX,u)}})},9323:(e,t,n)=>{"use strict";n.d(t,{Fr:()=>f,QH:()=>m,pf:()=>g,uy:()=>y});var r=n(2200),i=n(3233),o=n(9133),a=n(4841),s=n(8151),u=n(7409),l=n(3582),c=n(4968),p=n(625),d=n(1901),h=n(5475);function f(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return(0,a.d)(e,(0,d.N)(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function g(e,t){let n=t;const i=r.getReductionAxes(e.shape,t.shape);return i.length>0&&(n=(0,h.S)(n,i)),(0,c.X)(n,e.shape)}function m(e,t,n,r){if("linear"===t)return e;if("relu"===t)return(0,u.U)(e);if("elu"===t)return(0,i.p)(e);if("relu6"===t)return(0,l.b)(e);if("prelu"===t)return(0,s.A)(e,n);if("leakyrelu"===t)return(0,o.h)(e,r);if("sigmoid"===t)return(0,p.X)(e);throw new Error(`Unknown fused activation ${t}.`)}const y=(e,t)=>!(e>0)||"linear"===t},4926:(e,t,n)=>{"use strict";n.d(t,{I:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({gather_:function(e,t,n=0,a=0){const s={x:(0,o._1)(e,"x","gather"),indices:(0,o._1)(t,"indices","gather","int32")},u={axis:n,batchDims:a};return r.BV.runKernel(i.qi_,s,u)}})},636:(e,t,n)=>{"use strict";n.d(t,{p:()=>u});var r=n(7097),i=n(9121),o=n(747),a=n(3740),s=n(2200);const u=(0,n(2668).op)({greater_:function(e,t){let n=(0,a._1)(e,"a","greater","string_or_numeric"),u=(0,a._1)(t,"b","greater","string_or_numeric");[n,u]=(0,o.makeTypesMatch)(n,u),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);const l={a:n,b:u};return r.BV.runKernel(i.iZT,l)}})},7630:(e,t,n)=>{"use strict";n.d(t,{b:()=>u});var r=n(7097),i=n(9121),o=n(747),a=n(3740),s=n(2200);const u=(0,n(2668).op)({greaterEqual_:function(e,t){let n=(0,a._1)(e,"a","greaterEqual","string_or_numeric"),u=(0,a._1)(t,"b","greaterEqual","string_or_numeric");[n,u]=(0,o.makeTypesMatch)(n,u),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);const l={a:n,b:u};return r.BV.runKernel(i.Acj,l)}})},4386:(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({imag_:function(e){const t={input:(0,o._1)(e,"input","imag")};return r.BV.runKernel(i.J_u,t)}})},3305:(e,t,n)=>{"use strict";n.d(t,{I:()=>l});var r=n(7097),i=n(9121),o=n(3740),a=n(569),s=n(2668),u=n(4968);const l=(0,s.op)({resizeBilinear_:function(e,t,n=!1,s=!1){const l=(0,o._1)(e,"images","resizeBilinear");a.hu(3===l.rank||4===l.rank,(()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${l.rank}.`)),a.hu(2===t.length,(()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`)),a.hu(!1===s||!1===n,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let c=l,p=!1;3===l.rank&&(p=!0,c=(0,u.X)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));const[]=t,d={images:c},h={alignCorners:n,halfPixelCenters:s,size:t},f=r.BV.runKernel(i._Yw,d,h);return p?(0,u.X)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}})},5098:(e,t,n)=>{"use strict";n.d(t,{j:()=>l});var r=n(7097),i=n(9121),o=n(3740),a=n(569),s=n(2668),u=n(4968);const l=(0,s.op)({resizeNearestNeighbor_:function(e,t,n=!1,s=!1){const l=(0,o._1)(e,"images","resizeNearestNeighbor");a.hu(3===l.rank||4===l.rank,(()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${l.rank}.`)),a.hu(2===t.length,(()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`)),a.hu("float32"===l.dtype||"int32"===l.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),a.hu(!1===s||!1===n,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let c=l,p=!1;3===l.rank&&(p=!0,c=(0,u.X)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));const[]=t,d={images:c},h={alignCorners:n,halfPixelCenters:s,size:t},f=r.BV.runKernel(i.dpD,d,h);return p?(0,u.X)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}})},3963:(e,t,n)=>{"use strict";n.d(t,{x:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({isFinite_:function(e){const t={x:(0,o._1)(e,"x","isFinite")};return r.BV.runKernel(i.avt,t)}})},4365:(e,t,n)=>{"use strict";n.d(t,{U:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({isInf_:function(e){const t={x:(0,o._1)(e,"x","isInf")};return r.BV.runKernel(i.iWB,t)}})},6230:(e,t,n)=>{"use strict";n.d(t,{i:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({isNaN_:function(e){const t={x:(0,o._1)(e,"x","isNaN")};return r.BV.runKernel(i.r7n,t)}})},9133:(e,t,n)=>{"use strict";n.d(t,{h:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({leakyRelu_:function(e,t=.2){const n={x:(0,o._1)(e,"x","leakyRelu")},a={alpha:t};return r.BV.runKernel(i.J$2,n,a)}})},6573:(e,t,n)=>{"use strict";n.d(t,{d:()=>u});var r=n(7097),i=n(9121),o=n(747),a=n(3740),s=n(2200);const u=(0,n(2668).op)({less_:function(e,t){let n=(0,a._1)(e,"a","less","string_or_numeric"),u=(0,a._1)(t,"b","less","string_or_numeric");[n,u]=(0,o.makeTypesMatch)(n,u),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);const l={a:n,b:u};return r.BV.runKernel(i.vtC,l)}})},624:(e,t,n)=>{"use strict";n.d(t,{z:()=>u});var r=n(7097),i=n(9121),o=n(747),a=n(3740),s=n(2200);const u=(0,n(2668).op)({lessEqual_:function(e,t){let n=(0,a._1)(e,"a","lessEqual","string_or_numeric"),u=(0,a._1)(t,"b","lessEqual","string_or_numeric");[n,u]=(0,o.makeTypesMatch)(n,u),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);const l={a:n,b:u};return r.BV.runKernel(i.CAk,l)}})},9648:(e,t,n)=>{"use strict";n.d(t,{G:()=>l});var r=n(7097),i=n(9121),o=n(3740),a=n(569),s=n(2668),u=n(4968);const l=(0,s.op)({localResponseNormalization_:function(e,t=5,n=1,s=1,l=.5){const c=(0,o._1)(e,"x","localResponseNormalization");a.hu(4===c.rank||3===c.rank,(()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${c.rank}.`)),a.hu(a.GN(t),(()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`));let p=c,d=!1;3===c.rank&&(d=!0,p=(0,u.X)(c,[1,c.shape[0],c.shape[1],c.shape[2]]));const h={x:p},f={depthRadius:t,bias:n,alpha:s,beta:l},g=r.BV.runKernel(i.eZ0,h,f);return d?(0,u.X)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},2597:(e,t,n)=>{"use strict";n.d(t,{c:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({log_:function(e){const t={x:(0,o._1)(e,"x","log","float32")};return r.BV.runKernel(i.ZbH,t)}})},7474:(e,t,n)=>{"use strict";n.d(t,{K:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({log1p_:function(e){const t={x:(0,o._1)(e,"x","log1p")};return r.BV.runKernel(i.kU,t)}})},3888:(e,t,n)=>{"use strict";n.d(t,{e:()=>c});var r=n(633),i=n(3740),o=n(4841),a=n(7370),s=n(2668),u=n(625),l=n(3694);const c=(0,s.op)({logSigmoid_:function(e){const t=(0,i._1)(e,"x","logSigmoid");return(0,r.cb)((e=>({value:(0,a.W)((0,l.W)((0,a.W)(e))),gradFunc:t=>(0,o.d)(t,(0,u.X)((0,a.W)(e)))})))(t)}})},1510:(e,t,n)=>{"use strict";n.d(t,{C:()=>h});var r=n(633),i=n(3740),o=n(2271),a=n(4842),s=n(2597),u=n(3307),l=n(4841),c=n(2668),p=n(827),d=n(5475);const h=(0,c.op)({logSoftmax_:function(e,t=-1){const n=(0,i._1)(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return(0,r.cb)(((e,n)=>{const r=(0,u.F)(e,t,!0),i=(0,p.l)(e,r),c=(0,p.l)((0,o.p)(i,"float32"),(0,s.c)((0,d.S)((0,a.Q)(i),t,!0)));return n([c]),{value:c,gradFunc:(e,n)=>{const[r]=n,i=(0,a.Q)(r);return(0,p.l)(e,(0,l.d)((0,d.S)(e,t,!0),i))}}}))(n)}})},1391:(e,t,n)=>{"use strict";n.d(t,{l:()=>f});var r=n(3740),i=n(569),o=n(6407),a=n(3591),s=n(4842),u=n(2597),l=n(3307),c=n(2668),p=n(4968),d=n(827),h=n(5475);const f=(0,c.op)({logSumExp_:function(e,t=null,n=!1){const c=(0,r._1)(e,"x","logSumExp"),f=(0,i.EC)(t,c.shape),g=(0,l.F)(c,f,!0),m=(0,d.l)(c,g),y=(0,s.Q)(m),b=(0,h.S)(y,f),v=(0,u.c)(b),x=(0,o.I)((0,p.X)(g,v.shape),v);if(n){const e=(0,a.rv)(x.shape,f);return(0,p.X)(x,e)}return x}})},2856:(e,t,n)=>{"use strict";n.d(t,{H:()=>s});var r=n(7097),i=n(9121),o=n(3740),a=n(2200);const s=(0,n(2668).op)({logicalAnd_:function(e,t){const n=(0,o._1)(e,"a","logicalAnd","bool"),s=(0,o._1)(t,"b","logicalAnd","bool");(0,a.assertAndGetBroadcastShape)(n.shape,s.shape);const u={a:n,b:s};return r.BV.runKernel(i.PYm,u)}})},8651:(e,t,n)=>{"use strict";n.d(t,{h:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({logicalNot_:function(e){const t={x:(0,o._1)(e,"x","logicalNot","bool")};return r.BV.runKernel(i.VfG,t)}})},5750:(e,t,n)=>{"use strict";n.d(t,{K:()=>s});var r=n(7097),i=n(9121),o=n(3740),a=n(2200);const s=(0,n(2668).op)({logicalOr_:function(e,t){const n=(0,o._1)(e,"a","logicalOr","bool"),s=(0,o._1)(t,"b","logicalOr","bool");(0,a.assertAndGetBroadcastShape)(n.shape,s.shape);const u={a:n,b:s};return r.BV.runKernel(i.MZg,u)}})},596:(e,t,n)=>{"use strict";n.d(t,{e:()=>u});var r=n(3740),i=n(2200),o=n(2856),a=n(8651),s=n(5750);const u=(0,n(2668).op)({logicalXor_:function(e,t){const n=(0,r._1)(e,"a","logicalXor","bool"),u=(0,r._1)(t,"b","logicalXor","bool");return(0,i.assertAndGetBroadcastShape)(n.shape,u.shape),(0,o.H)((0,s.K)(e,t),(0,a.h)((0,o.H)(e,t)))}})},9876:(e,t,n)=>{"use strict";var r;n.d(t,{I:()=>r}),function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(r||(r={}))},8687:(e,t,n)=>{"use strict";n.d(t,{O:()=>s});var r=n(7097),i=n(9121),o=n(747),a=n(3740);const s=(0,n(2668).op)({matMul_:function(e,t,n=!1,s=!1){let u=(0,a._1)(e,"a","matMul"),l=(0,a._1)(t,"b","matMul");[u,l]=(0,o.makeTypesMatch)(u,l);const c={a:u,b:l},p={transposeA:n,transposeB:s};return r.BV.runKernel(i.XLW,c,p)}})},3307:(e,t,n)=>{"use strict";n.d(t,{F:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({max_:function(e,t=null,n=!1){const a={x:(0,o._1)(e,"x","max")},s={reductionIndices:t,keepDims:n};return r.BV.runKernel(i.YoZ,a,s)}})},1174:(e,t,n)=>{"use strict";n.d(t,{_:()=>c});var r=n(7097),i=n(9121),o=n(3740),a=n(569),s=n(2582),u=n(2668),l=n(4968);const c=(0,u.op)({maxPool_:function(e,t,n,u,c){const p=(0,o._1)(e,"x","maxPool");let d=p,h=!1;3===p.rank&&(h=!0,d=(0,l.X)(p,[1,p.shape[0],p.shape[1],p.shape[2]])),a.hu(4===d.rank,(()=>`Error in maxPool: input must be rank 4 but got rank ${d.rank}.`)),a.hu(s.jT(n,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`)),s.m("maxPool",u,c);const f={x:d},g={filterSize:t,strides:n,pad:u,dimRoundingMode:c},m=r.BV.runKernel(i.mTV,f,g);return h?(0,l.X)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},632:(e,t,n)=>{"use strict";n.d(t,{g:()=>l});var r=n(7097),i=n(9121),o=n(747),a=n(3740),s=n(2200),u=n(2271);const l=(0,n(2668).op)({maximum_:function(e,t){let n=(0,a._1)(e,"a","maximum"),l=(0,a._1)(t,"b","maximum");[n,l]=(0,o.makeTypesMatch)(n,l),"bool"===n.dtype&&(n=(0,u.p)(n,"int32"),l=(0,u.p)(l,"int32")),(0,s.assertAndGetBroadcastShape)(n.shape,l.shape);const c={a:n,b:l};return r.BV.runKernel(i.BMI,c)}})},5130:(e,t,n)=>{"use strict";n.d(t,{J:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({mean_:function(e,t=null,n=!1){const a={x:(0,o._1)(e,"x","mean")},s={axis:t,keepDims:n};return r.BV.runKernel(i.q2K,a,s)}})},5735:(e,t,n)=>{"use strict";n.d(t,{V:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({min_:function(e,t=null,n=!1){const a={x:(0,o._1)(e,"x","min")},s={axis:t,keepDims:n};return r.BV.runKernel(i.c17,a,s)}})},4513:(e,t,n)=>{"use strict";n.d(t,{L:()=>l});var r=n(7097),i=n(9121),o=n(747),a=n(3740),s=n(2200),u=n(2271);const l=(0,n(2668).op)({minimum_:function(e,t){let n=(0,a._1)(e,"a","minimum"),l=(0,a._1)(t,"b","minimum");[n,l]=(0,o.makeTypesMatch)(n,l),"bool"===n.dtype&&(n=(0,u.p)(n,"int32"),l=(0,u.p)(l,"int32")),(0,s.assertAndGetBroadcastShape)(n.shape,l.shape);const c={a:n,b:l};return r.BV.runKernel(i.q8u,c)}})},1483:(e,t,n)=>{"use strict";n.d(t,{V:()=>s});var r=n(7097),i=n(9121),o=n(3740),a=n(569);const s=(0,n(2668).op)({mirrorPad_:function(e,t,n){a.hu("reflect"===n||"symmetric"===n,(()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`));const s=(0,o._1)(e,"x","mirrorPad");if(0===s.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");a.hu(t.length===s.rank,(()=>`Padding doesn't match input. Must be ${s.rank}. Got ${t.length}.`));const u="reflect"===n?1:0;for(let e=0;e<s.rank;e++)a.hu(2===t[e].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),a.hu(t[e][0]>=0&&t[e][0]<=s.shape[e]-u&&t[e][1]>=0&&t[e][1]<=s.shape[e]-u,(()=>`Padding in dimension ${e} cannot be greater than or equal to ${s.shape[e]-u} or less than 0 for input of shape ${s.shape}`));const l={paddings:t,mode:n},c={x:s};return r.BV.runKernel(i.jQs,c,l)}})},5228:(e,t,n)=>{"use strict";n.d(t,{w:()=>s});var r=n(7097),i=n(9121),o=n(747),a=n(3740);const s=(0,n(2668).op)({mod_:function(e,t){let n=(0,a._1)(e,"a","mod"),s=(0,a._1)(t,"b","mod");[n,s]=(0,o.makeTypesMatch)(n,s);const u={a:n,b:s};return r.BV.runKernel(i.Vbg,u)}})},4841:(e,t,n)=>{"use strict";n.d(t,{d:()=>s});var r=n(7097),i=n(9121),o=n(747),a=n(3740);const s=(0,n(2668).op)({mul_:function(e,t){let n=(0,a._1)(e,"a","mul"),s=(0,a._1)(t,"b","mul");[n,s]=(0,o.makeTypesMatch)(n,s);const u={a:n,b:s};return r.BV.runKernel(i.wYn,u)}})},7370:(e,t,n)=>{"use strict";n.d(t,{W:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({neg_:function(e){const t={x:(0,o._1)(e,"x","neg")};return r.BV.runKernel(i.kuV,t)}})},3561:(e,t,n)=>{"use strict";n.d(t,{K:()=>y});var r=n(3740),i=n(569),o=n(6235),a=n(3591),s=n(3307),u=n(5735),l=n(2668),c=n(3453),p=n(4968),d=n(9494),h=n(3261),f=n(248),g=n(5475);function m(e,t,n=null){if(0===e.rank)return(0,o.W)(e);if(1!==e.rank&&null===n)return m((0,p.X)(e,[-1]),t,n);if(1===e.rank||"number"==typeof n||Array.isArray(n)&&1===n.length){if(1===t)return(0,g.S)((0,o.W)(e),n);if(t===1/0)return(0,s.F)((0,o.W)(e),n);if(t===-1/0)return(0,u.V)((0,o.W)(e),n);if("euclidean"===t||2===t)return(0,h._)((0,g.S)((0,c.s)((0,o.W)(e),(0,d.i)(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&2===n.length){if(1===t)return(0,s.F)((0,g.S)((0,o.W)(e),n[0]),n[1]-1);if(t===1/0)return(0,s.F)((0,g.S)((0,o.W)(e),n[1]),n[0]);if(t===-1/0)return(0,u.V)((0,g.S)((0,o.W)(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return(0,h._)((0,g.S)((0,f.h)(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const y=(0,l.op)({norm_:function(e,t="euclidean",n=null,o=!1){const s=m(e=(0,r._1)(e,"x","norm"),t,n);let u=s.shape;if(o){const t=(0,i.EC)(n,e.shape);u=a.rv(s.shape,t)}return(0,p.X)(s,u)}})},6500:(e,t,n)=>{"use strict";n.d(t,{Q:()=>u});var r=n(7097),i=n(9121),o=n(747),a=n(3740),s=n(2200);const u=(0,n(2668).op)({notEqual_:function(e,t){let n=(0,a._1)(e,"a","notEqual","string_or_numeric"),u=(0,a._1)(t,"b","notEqual","string_or_numeric");[n,u]=(0,o.makeTypesMatch)(n,u),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);const l={a:n,b:u};return r.BV.runKernel(i.yQU,l)}})},6708:(e,t,n)=>{"use strict";n.d(t,{l:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({oneHot_:function(e,t,n=1,a=0,s="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const u={indices:(0,o._1)(e,"indices","oneHot","int32")},l={dtype:s,depth:t,onValue:n,offValue:a};return r.BV.runKernel(i.we_,u,l)}})},4917:(e,t,n)=>{"use strict";n.d(t,{i:()=>s});var r=n(7097),i=n(569),o=n(1661),a=n(723);function s(e,t="float32"){if((0,i.Mu)(e),"complex64"===t){const t=s(e,"float32"),n=(0,a.l)(e,"float32");return(0,o.P)(t,n)}const n=(0,i.p8)((0,i.NA)(e),t);return r.BV.makeTensor(n,e,t)}},7846:(e,t,n)=>{"use strict";n.d(t,{J:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({onesLike_:function(e){const t={x:(0,o._1)(e,"x","onesLike")};return r.BV.runKernel(i.qWM,t)}})},2668:(e,t,n)=>{"use strict";n.d(t,{op:()=>a,z:()=>o});var r=n(7097),i=n(569);const o="__op";function a(e){const t=Object.keys(e);if(1!==t.length)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const a=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=o;const s=(...e)=>{r.BV.startScope(n);try{const t=a(...e);return(0,i.tI)(t)&&console.error("Cannot return a Promise inside of tidy."),r.BV.endScope(t),t}catch(e){throw r.BV.endScope(null),e}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}},2778:(e,t,n)=>{"use strict";n.d(t,{zvA:()=>d.z,WnP:()=>i.W,Khb:()=>o.K,__u:()=>a._,IHx:()=>s.I,QBD:()=>h,$6P:()=>f.$,YjB:()=>g.Y,NqF:()=>m.N,vHJ:()=>y.v,ZRM:()=>b.Z,VfV:()=>v.V,z4N:()=>x.z,fvJ:()=>_.f,C80:()=>w.C,wS1:()=>k.w,uR5:()=>T,zEQ:()=>D,tgs:()=>B.t,Dxk:()=>L,JY5:()=>P,p3b:()=>$,E4h:()=>I.E,yE8:()=>z,ycw:()=>j,anm:()=>nr,XsQ:()=>G,UFq:()=>U.U,f3b:()=>W.f,pju:()=>S.p,mDi:()=>V.m,iUl:()=>H.i,d9v:()=>q.d,PYB:()=>X.P,zoF:()=>E.z,gME:()=>Y,Izb:()=>K,MNy:()=>J,ZaL:()=>Z,PAt:()=>Q.P,Tek:()=>ee.T,bc:()=>te.b,pdZ:()=>ne,$QV:()=>ie,mCk:()=>oe.m,f9Y:()=>ae.f,mew:()=>dr,$Gn:()=>se.$,zbp:()=>ue.z,ppE:()=>le,nTT:()=>ce.n,B10:()=>pe.B,Ka3:()=>de,WmZ:()=>he.W,hiC:()=>fe.h,NTj:()=>ge.N,AKD:()=>me.A,rvX:()=>cr,WYO:()=>ye,pyx:()=>be.p,GRh:()=>pr,EDe:()=>ve,DgJ:()=>xe.D,qNN:()=>_e.q,d2q:()=>we.d,Qqt:()=>ke.Q,dt4:()=>Se.d,t$B:()=>Ce.t,iyy:()=>Te,kp_:()=>_n.k,hlL:()=>Ee.h,GWj:()=>Ae.G,qPi:()=>Fe.q,imm:()=>r,Iqj:()=>Oe.I,dbB:()=>lr,pjt:()=>Re.p,brS:()=>Ne.b,Sxn:()=>wn.S,asL:()=>De.a,BHj:()=>di,V3u:()=>hr,wx0:()=>kn.w,xVT:()=>Ie.x,UWc:()=>Be.U,i2d:()=>Le.i,hi7:()=>Pe.h,d9m:()=>$e.d,zN1:()=>ze.z,$r2:()=>hi,SX3:()=>je,G9k:()=>Ge.G,cM7:()=>Ue.c,Krr:()=>We.K,e_t:()=>Ve.e,CmS:()=>He.C,l_t:()=>qe.l,HvI:()=>Xe.H,hJK:()=>Ye.h,K5V:()=>Ke.K,egP:()=>Je.e,MB5:()=>fi,eab:()=>et,OI3:()=>A.O,Fp7:()=>tt.F,_sB:()=>nt._,YQQ:()=>rt,Ip$:()=>it,gWQ:()=>ot.g,J69:()=>at.J,ry_:()=>lt,VV$:()=>ct.V,LTh:()=>pt.L,VdP:()=>dt.V,wQq:()=>ht.w,Gi7:()=>yt,p_:()=>ar,dC7:()=>F.d,rq4:()=>bt,SJ_:()=>vt,W76:()=>xt.W,KOy:()=>ir.K,Quu:()=>_t.Q,lfX:()=>wt.l,iUs:()=>st.i,JpU:()=>kt.J,op:()=>d.op,N2O:()=>St,vku:()=>Ct.v,pNR:()=>Mt,koy:()=>Tt,t1L:()=>Et,lGY:()=>At,d_R:()=>Ft.d,sQ3:()=>Ot.s,AL3:()=>Rt.A,S0v:()=>Nt.S,WVs:()=>Dt.W,$gW:()=>It,VT$:()=>Bt,N89:()=>Lt,TN_:()=>Pt,wzB:()=>Ut,nGf:()=>Wt,ruB:()=>Vt,LGj:()=>Ht,pe5:()=>qt,w6H:()=>Xt,kwC:()=>Yt.k,M25:()=>Kt.M,UYe:()=>Jt.U,btT:()=>Zt.b,XLQ:()=>M.X,GYS:()=>Qt.G,SDf:()=>en,diP:()=>tn,sx7:()=>nn,mG2:()=>rn,QEs:()=>Sn.Q,NMM:()=>on.N,bp0:()=>an.b,iD$:()=>sn.i,snQ:()=>sr,zcT:()=>Qe,U8D:()=>un.U,U_I:()=>ln.U,ODp:()=>cn,XD2:()=>O.X,Xxe:()=>pn.X,tdS:()=>pi,O$l:()=>dn.O,R_K:()=>hn.R,tPi:()=>R.t,jZU:()=>fn,SmN:()=>gn,CnO:()=>mn,p0P:()=>yn,XAC:()=>bn.X,Wvh:()=>vn.W,fBT:()=>xn.f,rVs:()=>gi,ers:()=>ur,uN7:()=>ci,Vl2:()=>Cn.V,_b3:()=>Mn._,h62:()=>gt.h,$i:()=>Tn.$,L9e:()=>En.L,knu:()=>An.k,Nbs:()=>Fn.N,NXj:()=>On.N,Z_8:()=>mi,luU:()=>mt.l,Smz:()=>Rn.S,ORZ:()=>Nn.O,AEp:()=>N.A,XeE:()=>Dn.X,RRF:()=>Bn,odF:()=>Ln,wOQ:()=>Pn.w,yXz:()=>$n,Bfx:()=>zn,xZs:()=>jn,Pg0:()=>Un,Gg6:()=>Me.G,hg7:()=>Wn.h,p4s:()=>rr.p,Xu6:()=>Vn,Two:()=>Hn.T,pUJ:()=>qn.p,HHK:()=>Xn.H,GaM:()=>Yn,VD$:()=>Kn,arb:()=>Jn.a,itS:()=>Qn,lls:()=>er.l,P84:()=>tr.P});var r={};n.r(r),n.d(r,{conv2d:()=>vr,depthwiseConv2d:()=>wr,matMul:()=>kr});var i=n(6235),o=n(7839),a=n(1470),s=n(6407),u=n(7097),l=n(9121),c=n(3740),p=n(569),d=n(2668);const h=(0,d.op)({addN_:function(e){p.hu(Array.isArray(e),(()=>"The argument passed to tf.addN() must be a list of tensors")),p.hu(e.length>=1,(()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`));const t=e.map(((e,t)=>(0,c._1)(e,`tensors${t}`,"addN"))),n=t[0];t.forEach((e=>{if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((e=>{if(!p.cO(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));const r=t;return u.BV.runKernel(l.Xze,r)}});var f=n(781),g=n(2998),m=n(47),y=n(7394),b=n(2421),v=n(1891),x=n(7037),_=n(9812),w=n(369),k=n(5176),S=n(2271),C=n(2582),M=n(4968);const T=(0,d.op)({avgPool3d_:function(e,t,n,r,i,o="NDHWC"){const a=(0,c._1)(e,"x","avgPool3d","float32");let s=a,d=!1;4===a.rank&&(d=!0,s=(0,M.X)(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),p.hu(5===s.rank,(()=>`Error in avgPool3d: x must be rank 5 but got rank ${s.rank}.`)),p.hu("NDHWC"===o,(()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`)),p.hu("number"==typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`)),(0,C.m)("avgPool3d",r,i);const h={x:s},f={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:o};let g=u.BV.runKernel(l._k9,h,f);return g=(0,S.p)(g,s.dtype),d?(0,M.X)(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}});var E=n(6884),A=n(8687),F=n(4841),O=n(625),R=n(2676),N=n(1869);const D=(0,d.op)({basicLSTMCell_:function(e,t,n,r,i,o){const a=(0,c._1)(e,"forgetBias","basicLSTMCell"),u=(0,c._1)(t,"lstmKernel","basicLSTMCell"),l=(0,c._1)(n,"lstmBias","basicLSTMCell"),p=(0,c._1)(r,"data","basicLSTMCell"),d=(0,c._1)(i,"c","basicLSTMCell"),h=(0,c._1)(o,"h","basicLSTMCell"),f=(0,E.z)([p,h],1),g=(0,A.O)(f,u),m=(0,s.I)(g,l),y=m.shape[0],b=m.shape[1]/4,v=[y,b],x=(0,R.t)(m,[0,0],v),_=(0,R.t)(m,[0,b],v),w=(0,R.t)(m,[0,2*b],v),k=(0,R.t)(m,[0,3*b],v),S=(0,s.I)((0,F.d)((0,O.X)(x),(0,N.A)(_)),(0,F.d)(d,(0,O.X)((0,s.I)(a,w))));return[S,(0,F.d)((0,N.A)(S),(0,O.X)(k))]}});var I=n(8441),B=n(7505);const L=(0,d.op)({batchNorm2d_:function(e,t,n,r,i,o){const a=(0,c._1)(e,"x","batchNorm"),s=(0,c._1)(t,"mean","batchNorm"),u=(0,c._1)(n,"variance","batchNorm");let l,d;return null!=i&&(l=(0,c._1)(i,"scale","batchNorm")),null!=r&&(d=(0,c._1)(r,"offset","batchNorm")),p.hu(2===a.rank,(()=>`Error in batchNorm2D: x must be rank 2 but got rank ${a.rank}.`)),p.hu(2===s.rank||1===s.rank,(()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${s.rank}.`)),p.hu(2===u.rank||1===u.rank,(()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${u.rank}.`)),null!=l&&p.hu(2===l.rank||1===l.rank,(()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${l.rank}.`)),null!=d&&p.hu(2===d.rank||1===d.rank,(()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${d.rank}.`)),(0,B.t)(a,s,u,d,l,o)}}),P=(0,d.op)({batchNorm3d_:function(e,t,n,r,i,o){const a=(0,c._1)(e,"x","batchNorm"),s=(0,c._1)(t,"mean","batchNorm"),u=(0,c._1)(n,"variance","batchNorm");let l,d;return null!=i&&(l=(0,c._1)(i,"scale","batchNorm")),null!=r&&(d=(0,c._1)(r,"offset","batchNorm")),p.hu(3===a.rank,(()=>`Error in batchNorm3D: x must be rank 3 but got rank ${a.rank}.`)),p.hu(3===s.rank||1===s.rank,(()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${s.rank}.`)),p.hu(3===u.rank||1===u.rank,(()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${u.rank}.`)),null!=l&&p.hu(3===l.rank||1===l.rank,(()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${l.rank}.`)),null!=d&&p.hu(3===d.rank||1===d.rank,(()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${d.rank}.`)),(0,B.t)(a,s,u,d,l,o)}}),$=(0,d.op)({batchNorm4d_:function(e,t,n,r,i,o){const a=(0,c._1)(e,"x","batchNorm"),s=(0,c._1)(t,"mean","batchNorm"),u=(0,c._1)(n,"variance","batchNorm");let l,d;return null!=i&&(l=(0,c._1)(i,"scale","batchNorm")),null!=r&&(d=(0,c._1)(r,"offset","batchNorm")),p.hu(4===a.rank,(()=>`Error in batchNorm4D: x must be rank 4 but got rank ${a.rank}.`)),p.hu(4===s.rank||1===s.rank,(()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${s.rank}.`)),p.hu(4===u.rank||1===u.rank,(()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${u.rank}.`)),null!=l&&p.hu(4===l.rank||1===l.rank,(()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${l.rank}.`)),null!=d&&p.hu(4===d.rank||1===d.rank,(()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${d.rank}.`)),(0,B.t)(a,s,u,d,l,o)}}),z=(0,d.op)({bincount_:function(e,t,n){const r=(0,c._1)(e,"x","bincount"),i=(0,c._1)(t,"weights","bincount");p.hu("int32"===r.dtype,(()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`)),p.hu(n>=0,(()=>`size must be non-negative, but got ${n}.`)),p.hu(i.size===r.size||0===i.size,(()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`));const o={x:r,weights:i},a={size:n};return u.BV.runKernel(l.zvY,o,a)}}),j=(0,d.op)({bitwiseAnd_:function(e,t){const n=(0,c._1)(e,"x","bitwiseAnd"),r=(0,c._1)(t,"y","bitwiseAnd");if(!(0,p.cO)(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if("int32"!==n.dtype||"int32"!==r.dtype)throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);const i={a:n,b:r};return u.BV.runKernel(l.hCO,i)}}),G=(0,d.op)({broadcastArgs_:function(e,t){const n=(0,c._1)(e,"s0","broadcastArgs","int32"),r=(0,c._1)(t,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(1!==r.rank)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const i={s0:n,s1:r};return u.BV.runKernel(l.eEB,i)}});var U=n(8247),W=n(2657),V=n(6825),H=n(2279),q=n(8723),X=n(1661);const Y=(0,d.op)({concat1d_:function(e){return(0,E.z)(e,0)}}),K=(0,d.op)({concat2d_:function(e,t){return(0,E.z)(e,t)}}),J=(0,d.op)({concat3d_:function(e,t){return(0,E.z)(e,t)}}),Z=(0,d.op)({concat4d_:function(e,t){return(0,E.z)(e,t)}});var Q=n(1355),ee=n(4794),te=n(1405);const ne=(0,d.op)({conv3d_:function(e,t,n,r,i="NDHWC",o=[1,1,1]){const a=(0,c._1)(e,"x","conv3d"),s=(0,c._1)(t,"filter","conv3d");let d=a,h=!1;4===a.rank&&(h=!0,d=(0,M.X)(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),p.hu(5===d.rank,(()=>`Error in conv3d: input must be rank 5, but got rank ${d.rank}.`)),p.hu(5===s.rank,(()=>`Error in conv3d: filter must be rank 5, but got rank ${s.rank}.`)),p.hu(d.shape[4]===s.shape[3],(()=>`Error in conv3d: depth of input (${d.shape[4]}) must match input depth for filter ${s.shape[3]}.`)),p.hu((0,C.jT)(n,o),(()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`)),p.hu("NDHWC"===i,(()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`)),p.hu((0,C.U3)(o),(()=>"Error in conv3D: Dilated rates should be larger than 0.")),p.hu((0,C.U3)(n),(()=>"Error in conv3D: Strides should be larger than 0."));const f={x:d,filter:s},g={strides:n,pad:r,dataFormat:i,dilations:o},m=u.BV.runKernel(l.x12,f,g);return h?(0,M.X)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}});var re=n(7594);const ie=(0,d.op)({conv3dTranspose_:function(e,t,n,r,i){const o=(0,c._1)(e,"x","conv3dTranspose"),a=(0,c._1)(t,"filter","conv3dTranspose");return(0,re._)(n,o,a,r,i)}});var oe=n(173),ae=n(2699),se=n(9640),ue=n(7405);const le=(0,d.op)({denseBincount_:function(e,t,n,r=!1){const i=(0,c._1)(e,"x","denseBincount"),o=(0,c._1)(t,"weights","denseBincount");p.hu("int32"===i.dtype,(()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`)),p.hu(i.rank<=2,(()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`)),p.hu(n>=0,(()=>`size must be non-negative, but got ${n}.`)),p.hu(o.size===i.size||0===o.size,(()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${o.shape}.`));const a={x:i,weights:o},s={size:n,binaryOutput:r};return u.BV.runKernel(l.QRR,a,s)}});var ce=n(9112),pe=n(4718);const de=(0,d.op)({diag_:function(e){const t={x:(0,c._1)(e,"x","diag")};return u.BV.runKernel(l.$w,t)}});var he=n(557),fe=n(1274),ge=n(9322),me=n(548);const ye=(0,d.op)({einsum_:function(e,...t){const n=t.map(((e,t)=>(0,c._1)(e,`tensors${t}`,"einsum"))),r={equation:e};return u.BV.runKernel(l.$g6,n,r)}});var be=n(3233);const ve=(0,d.op)({ensureShape_:function(e,t){const n=(0,c._1)(e,"x","ensureShape","string_or_numeric");if(!(0,p.DK)(n.shape,t))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${t}`);return e}});var xe=n(6477),_e=n(4650),we=n(1954),ke=n(4842),Se=n(1300),Ce=n(3426),Me=n(7501);const Te=(0,d.op)({eye_:function(e,t,n,r="float32"){null==t&&(t=e);const i=(0,W.f)([e,t],r),o=e<=t?e:t;for(let e=0;e<o;++e)i.set(1,e,e);const a=(0,M.X)(i.toTensor(),[e,t]);if(null==n)return a;if(1===n.length)return(0,Me.G)((0,Se.d)(a,0),[n[0],1,1]);if(2===n.length)return(0,Me.G)((0,Se.d)((0,Se.d)(a,0),0),[n[0],n[1],1,1]);if(3===n.length)return(0,Me.G)((0,Se.d)((0,Se.d)((0,Se.d)(a,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}});var Ee=n(4006),Ae=n(6943),Fe=n(9165),Oe=n(4926),Re=n(636),Ne=n(7630),De=n(4386),Ie=n(3963),Be=n(4365),Le=n(6230),Pe=n(9133),$e=n(6573),ze=n(624);function je(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:e,stop:t,num:n};return u.BV.runKernel(l.e7N,{},r)}var Ge=n(9648),Ue=n(2597),We=n(7474),Ve=n(3888),He=n(1510),qe=n(1391),Xe=n(2856),Ye=n(8651),Ke=n(5750),Je=n(596);const Ze=2147483648,Qe=(0,d.op)({searchSorted_:function(e,t,n="left"){const r=(0,c._1)(e,"sortedSequence","searchSorted"),i=(0,c._1)(t,"values","searchSorted"),o=r.shape[r.shape.length-1],a=i.shape[i.shape.length-1],s=(0,M.X)(r,[-1,o]),d=(0,M.X)(i,[-1,a]);if(s.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(s.shape[0]!==d.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if((0,p.NA)(d.shape)>=Ze)throw new Error("values tensor size must less than 2147483648");if(s.shape[1]>=Ze)throw new Error(`trailing dim_size must less than 2147483648 for int32 output type, was ${s.shape[1]}`);const h={sortedSequence:s,values:d},f={side:n};return u.BV.runKernel(l.nr8,h,f)}});function et(e,t){return Qe(e,t,"left")}var tt=n(3307),nt=n(1174);const rt=(0,d.op)({maxPool3d_:function(e,t=[1,1,1],n,r,i,o="NDHWC"){const a=(0,c._1)(e,"x","maxPool3d");let s=a,d=!1;4===a.rank&&(d=!0,s=(0,M.X)(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),p.hu(5===s.rank,(()=>`Error in maxPool3d: x must be rank 5 but got rank ${s.rank}.`)),p.hu("NDHWC"===o,(()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`)),(0,C.m)("maxPool3d",r,i);const h={x:s},f={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:o},g=u.BV.runKernel(l.OAf,h,f);return d?(0,M.X)(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),it=(0,d.op)({maxPoolWithArgmax_:function(e,t,n,r,i=!1){const o={x:(0,c._1)(e,"x","maxPoolWithArgmax")},a={filterSize:t,strides:n,pad:r,includeBatchInIndex:i},s=u.BV.runKernel(l.vFR,o,a);return{result:s[0],indexes:s[1]}}});var ot=n(632),at=n(5130),st=n(4917),ut=n(4077);function lt(e,t,{indexing:n="xy"}={}){if("xy"!==n&&"ij"!==n)throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(void 0===e)return[];let r=(0,c._1)(e,"x","meshgrid",e instanceof ut.es?e.dtype:"float32");if(void 0===t)return[r];let i=(0,c._1)(t,"y","meshgrid",t instanceof ut.es?t.dtype:"float32");const o=(0,p.NA)(r.shape),a=(0,p.NA)(i.shape);return"xy"===n?(r=(0,M.X)(r,[1,-1]),i=(0,M.X)(i,[-1,1]),[(0,A.O)((0,st.i)([a,1],r.dtype),r),(0,A.O)(i,(0,st.i)([1,o],i.dtype))]):(r=(0,M.X)(r,[-1,1]),i=(0,M.X)(i,[1,-1]),[(0,A.O)(r,(0,st.i)([1,a],r.dtype)),(0,A.O)((0,st.i)([o,1],i.dtype),i)])}var ct=n(5735),pt=n(4513),dt=n(1483),ht=n(5228),ft=n(3591),gt=n(248),mt=n(827);const yt=(0,d.op)({moments_:function(e,t=null,n=!1){e=(0,c._1)(e,"x","moments");const r=(0,p.EC)(t,e.shape),i=(0,at.J)(e,r,n);let o=i.shape;n||(o=(0,ft.rv)(i.shape,r));const a=(0,gt.h)((0,mt.l)((0,S.p)(e,"float32"),(0,M.X)(i,o)));return{mean:i,variance:(0,at.J)(a,r,n)}}}),bt=(0,d.op)({multiRNNCell_:function(e,t,n,r){const i=(0,c._1)(t,"data","multiRNNCell"),o=(0,c.sI)(n,"c","multiRNNCell"),a=(0,c.sI)(r,"h","multiRNNCell");let s=i;const u=[];for(let t=0;t<e.length;t++){const n=e[t](s,o[t],a[t]);u.push(n[0]),u.push(n[1]),s=n[1]}const l=[],p=[];for(let e=0;e<u.length;e+=2)l.push(u[e]),p.push(u[e+1]);return[l,p]}}),vt=(0,d.op)({multinomial_:function(e,t,n,r=!1){const i=(0,c._1)(e,"logits","multinomial"),o=i.size,a=i.rank;if(o<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${o}.`);if(a>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${a}`);n=n||Math.random();const s={logits:1===a?(0,M.X)(i,[1,-1]):i},p={numSamples:t,seed:n,normalized:r},d=u.BV.runKernel(l.NZg,s,p);return 1===a?(0,M.X)(d,[d.size]):d}});var xt=n(7370),_t=n(6500),wt=n(6708),kt=n(7846);const St=(0,d.op)({outerProduct_:function(e,t){const n=(0,c._1)(e,"v1","outerProduct"),r=(0,c._1)(t,"v2","outerProduct");p.hu(1===n.rank&&1===r.rank,(()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`));const i=(0,M.X)(n,[-1,1]),o=(0,M.X)(r,[1,-1]);return(0,A.O)(i,o)}});var Ct=n(9682);const Mt=(0,d.op)({pad1d_:function(e,t,n=0){return(0,p.hu)(2===t.length,(()=>"Invalid number of paddings. Must be length of 2.")),(0,Ct.v)(e,[t],n)}}),Tt=(0,d.op)({pad2d_:function(e,t,n=0){return(0,p.hu)(2===t.length&&2===t[0].length&&2===t[1].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),(0,Ct.v)(e,t,n)}}),Et=(0,d.op)({pad3d_:function(e,t,n=0){return(0,p.hu)(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),(0,Ct.v)(e,t,n)}}),At=(0,d.op)({pad4d_:function(e,t,n=0){return(0,p.hu)(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),(0,Ct.v)(e,t,n)}});var Ft=n(5860),Ot=n(3453),Rt=n(8151),Nt=n(9798),Dt=n(9451);const It=(0,d.op)({raggedGather_:function(e,t,n,r){const i={paramsNestedSplits:e.map(((e,t)=>(0,c._1)(e,`tensors${t}`,"raggedGather","int32"))),paramsDenseValues:(0,c._1)(t,"paramsDenseValues","raggedGather"),indices:(0,c._1)(n,"indices","raggedGather","int32")},o={outputRaggedRank:r},a=u.BV.runKernel(l.dDz,i,o);return{outputNestedSplits:a.slice(0,a.length-1),outputDenseValues:a[a.length-1]}}}),Bt=(0,d.op)({raggedRange_:function(e,t,n){const r=(0,c._1)(e,"starts","raggedRange"),i={starts:r,limits:(0,c._1)(t,"limits","raggedRange",r.dtype),deltas:(0,c._1)(n,"deltas","raggedRange",r.dtype)},o=u.BV.runKernel(l.CQl,i);return{rtNestedSplits:o[0],rtDenseValues:o[1]}}}),Lt=(0,d.op)({raggedTensorToTensor_:function(e,t,n,r,i){const o=(0,c._1)(e,"shape","raggedTensorToTensor","int32"),a=(0,c._1)(t,"values","raggedTensorToTensor"),s={shape:o,values:a,defaultValue:(0,c._1)(n,"defaultValue","raggedTensorToTensor",a.dtype),rowPartitionTensors:r.map(((e,t)=>(0,c._1)(e,`tensors${t}`,"raggedTensorToTensor","int32")))},p={rowPartitionTypes:i};return u.BV.runKernel(l.BiW,s,p)}}),Pt=(0,d.op)({rand_:function(e,t,n){(0,p.Mu)(e);const r=(0,p.NA)(e);let i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error(`Unknown data type ${n}`);i=new Uint8Array(r)}for(let e=0;e<r;e++)i[e]=t();return u.BV.makeTensor(i,e,n)}});var $t=n(6377);class zt{constructor(e,t,n,r,i){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const o=i||Math.random();this.random=$t.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const e=this.nextVal;return this.nextVal=NaN,e}let e,t,n=!1;for(;!n;){let r,i,o;do{r=2*this.random()-1,i=2*this.random()-1,o=r*r+i*i}while(o>=1||0===o);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*r*a,t=this.mean+this.stdDev*i*a,this.truncated&&!this.isValidTruncated(e)||(n=!0)}return this.truncated&&!this.isValidTruncated(t)||(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class jt{constructor(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;const i=r||Math.random();this.randu=$t.alea(i.toString()),this.randn=new zt(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,n,r,i,o;for(;;){do{r=this.randn.nextValue(),o=1+this.c*r}while(o<=0);if(o*=o*o,e=r*r,t=1-.331*e*e,n=.5*e+this.d*(1-o+Math.log(o)),i=this.randu(),i<t||Math.log(i)<n)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return"float32"===this.dtype?e:Math.round(e)}}class Gt{constructor(e=0,t=1,n,r){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=$t.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const Ut=(0,d.op)({randomGamma_:function(e,t,n=1,r="float32",i){if((0,p.Mu)(e),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error(`Unsupported data type ${r}`);const o=new jt(t,n,r,i),a=(0,W.f)(e,r);for(let e=0;e<a.values.length;e++)a.values[e]=o.nextValue();return a.toTensor()}}),Wt=(0,d.op)({randomNormal_:function(e,t=0,n=1,r,i){if((0,p.Mu)(e),null!=r&&"bool"===r)throw new Error(`Unsupported data type ${r}`);const o=new zt(t,n,r,!1,i),a=(0,W.f)(e,r);for(let e=0;e<a.values.length;e++)a.values[e]=o.nextValue();return a.toTensor()}}),Vt=(0,d.op)({randomStandardNormal_:function(e,t,n){if(null!=t&&"bool"===t)throw new Error(`Unsupported data type ${t}`);return Wt(e,0,1,t,n)}}),Ht=(0,d.op)({randomUniform_:function(e,t=0,n=1,r="float32",i){(0,p.Mu)(e);const o=(0,W.f)(e,r),a=new Gt(t,n,null,i);for(let e=0;e<o.values.length;e++)o.values[e]=a.nextValue();return o.toTensor()}}),qt=(0,d.op)({randomUniformInt_:function(e,t,n,r){return Ht(e,t,n,"int32",r)}});function Xt(e,t,n=1,r="float32"){if(0===n)throw new Error("Cannot have a step of zero");const i={start:e,stop:t,step:n,dtype:r};return u.BV.runKernel(l.e6w,{},i)}var Yt=n(766),Kt=n(9036),Jt=n(7409),Zt=n(3582),Qt=n(7486);const en=(0,d.op)({reverse1d_:function(e){const t=(0,c._1)(e,"x","reverse");return p.hu(1===t.rank,(()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`)),(0,Qt.G)(t,0)}}),tn=(0,d.op)({reverse2d_:function(e,t){const n=(0,c._1)(e,"x","reverse");return p.hu(2===n.rank,(()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`)),(0,Qt.G)(n,t)}}),nn=(0,d.op)({reverse3d_:function(e,t){const n=(0,c._1)(e,"x","reverse");return p.hu(3===n.rank,(()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`)),(0,Qt.G)(n,t)}}),rn=(0,d.op)({reverse4d_:function(e,t){const n=(0,c._1)(e,"x","reverse");return p.hu(4===n.rank,(()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`)),(0,Qt.G)(n,t)}});var on=n(7809),an=n(2634),sn=n(9494),un=n(5503),ln=n(8678);const cn=async function(e,t){const n=(0,c._1)(e,"x","setdiff1d"),r=(0,c._1)(t,"y","setdiff1d");p.hu(n.dtype===r.dtype,(()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`)),p.hu(1===n.rank,(()=>`x should be 1D tensor, but got x (${n.shape}).`)),p.hu(1===r.rank,(()=>`y should be 1D tensor, but got y (${r.shape}).`));const i=await n.data(),o=await r.data(),a=new Set(o);let s=0;for(let e=0;e<i.length;e++)a.has(i[e])||s++;const u=new ut.YD([s],n.dtype),l=new ut.YD([s],"int32");for(let e=0,t=0;e<i.length;e++)a.has(i[e])||(u.values[t]=i[e],l.values[t]=e,t++);return[u.toTensor(),l.toTensor()]};var pn=n(4434),dn=n(9331),hn=n(3254);const fn=(0,d.op)({slice1d_:function(e,t,n){const r=(0,c._1)(e,"x","slice1d");return p.hu(1===r.rank,(()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`)),(0,R.t)(r,[t],[n])}}),gn=(0,d.op)({slice2d_:function(e,t,n){const r=(0,c._1)(e,"x","slice2d");return p.hu(2===r.rank,(()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`)),(0,R.t)(r,t,n)}}),mn=(0,d.op)({slice3d_:function(e,t,n){const r=(0,c._1)(e,"x","slice3d");return p.hu(3===r.rank,(()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`)),(0,R.t)(r,t,n)}}),yn=(0,d.op)({slice4d_:function(e,t,n){const r=(0,c._1)(e,"x","slice4d");return p.hu(4===r.rank,(()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`)),(0,R.t)(r,t,n)}});var bn=n(682),vn=n(3694),xn=n(7918),_n=n(7020),wn=n(8447),kn=n(4415),Sn=n(3710),Cn=n(8644),Mn=n(3261),Tn=n(5265),En=n(9590),An=n(2991),Fn=n(1901),On=n(5158),Rn=n(5475),Nn=n(1173),Dn=n(701),In=n(7852);function Bn(e,t){(0,p.Cq)(e);const n=(0,c.C)(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return(0,In.H)(e,null,n,t)}function Ln(e,t,n){if((0,p.Cq)(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");const r=(0,c.C)(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return(0,In.H)(e,t,r,n)}var Pn=n(9906);function $n(e,t,n){if((0,p.Cq)(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");const r=(0,c.C)(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return(0,In.H)(e,t,r,n)}function zn(e,t,n){if((0,p.Cq)(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");const r=(0,c.C)(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return(0,In.H)(e,t,r,n)}function jn(e,t,n){if((0,p.Cq)(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");const r=(0,c.C)(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,(0,In.H)(e,t,r,n)}var Gn=n(3028);const Un=(0,d.op)({tensorScatterUpdate_:function(e,t,n){const r=(0,c._1)(e,"tensor","tensorScatterupdate"),i=(0,c._1)(t,"indices","tensorScatterupdate","int32"),o=(0,c._1)(n,"updates","tensorScatterupdate");if(Gn.validateInput(o,i,r.shape),r.dtype!==o.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${o.dtype}.`);const a={tensor:r,indices:i,updates:o};return u.BV.runKernel(l.SIB,a,{})}});var Wn=n(3243);const Vn=(0,d.op)({truncatedNormal_:function(e,t=0,n=1,r,i){if((0,p.Mu)(e),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const o=new zt(t,n,r,!0,i),a=(0,W.f)(e,r);for(let e=0;e<a.values.length;e++)a.values[e]=o.nextValue();return a.toTensor()}});var Hn=n(9608),qn=n(8749),Xn=n(4136);function Yn(e,t){return Qe(e,t,"right")}function Kn(e,t=!0,n,r){return u.BV.makeVariable(e,t,n,r)}var Jn=n(5912),Zn=n(8333);const Qn=async function(e){const t=(0,c._1)(e,"condition","whereAsync","bool"),n=await t.data(),r=(0,Zn.Z)(t.shape,n);return e!==t&&t.dispose(),r};var er=n(723),tr=n(6577);const nr=async function(e,t,n){const r=(0,c._1)(e,"tensor","boolMask"),i=(0,c._1)(t,"mask","boolMask","bool"),o=null==n?0:n,a=i.rank,s=r.shape;p.hu(a>0,(()=>"mask cannot be scalar")),p.k5(s.slice(o,o+a),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let e=o;e<o+a;e++)u*=s[e];const l=s.slice(0,o).concat([u],s.slice(o+a)),d=(0,M.X)(r,l),h=(0,M.X)(i,[-1]),f=await Qn(h),g=(0,En.L)(f,[1]),m=(0,Oe.I)(d,g,o);return e!==r&&r.dispose(),t!==i&&i.dispose(),g.dispose(),d.dispose(),h.dispose(),f.dispose(),m};var rr=n(9065),ir=n(3561),or=n(747);const ar=(0,d.op)({movingAverage_:function(e,t,n,r,i=!0){const o=(0,c._1)(e,"v","movingAverage"),a=(0,c._1)(t,"x","movingAverage"),u=(0,c._1)(n,"decay","movingAverage");(0,or.assertTypesMatch)(o,a),p.hu(p.cO(o.shape,a.shape),(()=>"Shape mismatch in v and x"));const l=(0,sn.i)(1),d=(0,mt.l)(l,u);let h=(0,F.d)((0,mt.l)(a,o),d);if(i){p.hu(null!=r,(()=>"When using zeroDebias: true, step is required."));const e=(0,c._1)(r,"step","movingAverage");h=(0,fe.h)(h,(0,mt.l)(l,(0,Ot.s)(u,e)))}return(0,s.I)(o,h)}}),sr=(0,d.op)({scatterND_:function(e,t,n){(0,p.Mu)(n);const r=(0,c._1)(e,"indices","scatterND","int32"),i=(0,c._1)(t,"updates","scatterND");Gn.validateInput(i,r,n);const o={indices:r,updates:i},a={shape:n};return u.BV.runKernel(l.xQA,o,a)}}),ur=(0,d.op)({sparseToDense_:function(e,t,n,r=0){(0,p.Mu)(n);const i=(0,c._1)(e,"sparseIndices","sparseToDense","int32"),o=(0,c._1)(t,"sparseValues","sparseToDense","string_or_numeric"),a=(0,c._1)(r,"defaultValue","sparseToDense",o.dtype);!function(e,t,n,r){if("int32"!==e.dtype)throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);const i=e.rank>0?e.shape[0]:1,o=e.rank>1?e.shape[1]:1;if(n.length!==o)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${o}.`);const a=t.size;if(0!==t.rank&&(1!==t.rank||a!==i))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${i}]`);if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,o,n,a);const s={sparseIndices:i,sparseValues:o,defaultValue:a},d={outputShape:n};return u.BV.runKernel(l.D2d,s,d)}}),lr=(0,d.op)({gatherND_:function(e,t){const n=(0,c._1)(t,"indices","gatherND","int32"),r={params:(0,c._1)(e,"x","gatherND","string_or_numeric"),indices:n};return u.BV.runKernel(l.q1x,r)}}),cr=(0,d.op)({dropout_:function(e,t,n,r){const i=(0,c._1)(e,"x","dropout");if(p.hu("float32"===i.dtype,(()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`)),p.hu(t>=0&&t<1,(()=>`rate must be a float in the range [0, 1), but got ${t}.`)),0===t)return e instanceof ut.es?i.clone():i;const o=function(e,t){if(null==t)return e.shape.slice();if(p.cO(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(i,n),a=1-t,u=(0,fe.h)((0,Ae.G)((0,s.I)(Ht(o,0,1,"float32",r),a)),a);return(0,F.d)(i,u)}});function pr(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function dr(e,t,n){const r=1-e%2,i=new Float32Array(e);for(let o=0;o<e;++o){const a=2*Math.PI*o/(e+r-1);i[o]=t-n*Math.cos(a)}return Bn(i,"float32")}const hr=async function(e,t,n=1){const r=(0,c._1)(e,"predictions","inTopK"),i=(0,c._1)(t,"targets","inTopK");(0,p.hu)(r.rank>1,(()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`)),(0,p.hu)(r.rank-1===i.rank,(()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${i.rank}`)),(0,p.k5)(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const o=r.shape[r.shape.length-1];(0,p.hu)(n>0&&n<=o,(()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${o}), but got ${n}`));const a=await r.data(),s=await i.data(),[u,l]=[a.length/o,o],d=(0,p.WP)("bool",u);for(let e=0;e<u;e++){const t=e*l,r=a.subarray(t,t+l),i=[];for(let e=0;e<r.length;e++)i.push({value:r[e],index:e});i.sort(((e,t)=>t.value-e.value)),d[e]=0;for(let t=0;t<n;t++)if(i[t].index===s[e]){d[e]=1;break}}return e!==r&&r.dispose(),t!==i&&i.dispose(),(0,Dn.X)(d,i.shape,"bool")};var fr=n(633),gr=n(2200),mr=n(6013),yr=n(9832),br=n(9323);const vr=(0,d.op)({fusedConv2d_:function({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:o=[1,1],dimRoundingMode:a,bias:d,activation:h="linear",preluActivationWeights:f,leakyreluAlpha:g}){if(h=h||"linear",!1===(0,br.uy)(u.BV.state.gradientDepth,h)){p.hu("NHWC"===i,(()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`));let u=(0,ee.T)(e,t,n,r,i,o,a);return null!=d&&(u=(0,s.I)(u,d)),(0,br.QH)(u,h,f,g)}const m=(0,c._1)(e,"x","conv2d","float32"),y=(0,c._1)(t,"filter","conv2d","float32");let b=m,v=!1;3===m.rank&&(v=!0,b=(0,M.X)(m,[1,m.shape[0],m.shape[1],m.shape[2]])),p.hu(4===b.rank,(()=>`Error in fused conv2d: input must be rank 4, but got rank ${b.rank}.`)),p.hu(4===y.rank,(()=>`Error in fused conv2d: filter must be rank 4, but got rank ${y.rank}.`)),C.m("fused conv2d",r,a);const x="NHWC"===i?b.shape[3]:b.shape[1];p.hu(y.shape[2]===x,(()=>`Error in conv2d: depth of input (${x}) must match input depth for filter ${y.shape[2]}.`)),p.hu(C.jT(n,o),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`));const _=C.Ix(b.shape,y.shape,n,o,r,a);let w,k;if(null!=d&&(w=(0,c._1)(d,"bias","fused conv2d"),[w]=(0,or.makeTypesMatch)(w,m),"NHWC"===i?gr.assertAndGetBroadcastShape(_.outShape,w.shape):(p.hu(w.shape.length<=1,(()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${w.shape.length}.`)),p.hu(0===w.shape.length||w.shape[0]===_.outChannels||1===w.shape[0],(()=>`Error in fused conv2d: bias shape (${w.shape}) is not compatible with the number of output channels (${_.outChannels})`)))),null!=f){const e=f.shape;if(p.hu(e.length<=1||3===e.length,(()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${e.length}.`)),1===e.length)p.hu(1===e[0]||e[0]===_.outChannels,(()=>`Error in fused conv2d: PReLU activation weights (${e}) is not compatible with the number of output channels (${_.outChannels}).`));else if(3===e.length)try{gr.assertAndGetBroadcastShape(e,_.outShape)}catch(t){const n=`Error in fused conv2d: PReLU activation weights (${e}) is not compatible with the output shape of the conv2d (${_.outShape}).`;throw Error(n)}k=(0,c._1)(f,"prelu weights","fused conv2d")}const S=(e,t)=>{p.hu("NHWC"===i,(()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`));const[a,s,u,l]=t,c=(0,br.Fr)(e,u,h);p.hu(C.I0(o),(()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`));const d=[(0,yr._)(s.shape,c,a,n,r),(0,mr.p)(s,c,a.shape,n,r)];if(null!=l){const e=(0,br.pf)(l,c);d.push(e)}return d},T={x:b,filter:y,bias:w,preluActivationWeights:k},E={strides:n,pad:r,dataFormat:i,dilations:o,dimRoundingMode:a,activation:h,leakyreluAlpha:g};if(null==d){const e=(0,fr.cb)(((e,t,n)=>{let r=u.BV.runKernel(l._V0,T,E);return n([t,e,r]),v&&(r=(0,M.X)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:S}}));return e(b,y)}{const e=(0,fr.cb)(((e,t,n,r)=>{let i=u.BV.runKernel(l._V0,T,E);return r([t,e,i,n]),v&&(i=(0,M.X)(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:S}}));return e(b,y,w)}}});var xr=n(8098),_r=n(4375);const wr=(0,d.op)({fusedDepthwiseConv2d_:function({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:o=[1,1],dimRoundingMode:a,bias:d,activation:h="linear",preluActivationWeights:f,leakyreluAlpha:g}){if(!1===(0,br.uy)(u.BV.state.gradientDepth,h)){let u=(0,pe.B)(e,t,n,r,i,o,a);return null!=d&&(u=(0,s.I)(u,d)),(0,br.QH)(u,h,f,g)}const m=(0,c._1)(e,"x","depthwiseConv2d","float32"),y=(0,c._1)(t,"filter","depthwiseConv2d","float32");let b=m,v=!1;3===m.rank&&(v=!0,b=(0,M.X)(m,[1,m.shape[0],m.shape[1],m.shape[2]])),p.hu(4===b.rank,(()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${b.rank}.`)),p.hu(4===y.rank,(()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${y.rank}.`)),p.hu(b.shape[3]===y.shape[2],(()=>`Error in fused depthwiseConv2d: number of input channels (${b.shape[3]}) must match the inChannels dimension in filter ${y.shape[2]}.`)),null==o&&(o=[1,1]),p.hu(C.jT(n,o),(()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`)),C.m("fused depthwiseConv2d",r,a);const x=C.Ix(b.shape,y.shape,n,o,r,a,!0);let _,w;null!=d&&(_=(0,c._1)(d,"bias","fused conv2d"),[_]=(0,or.makeTypesMatch)(_,m),gr.assertAndGetBroadcastShape(x.outShape,_.shape)),null!=f&&(w=(0,c._1)(f,"prelu weights","fused depthwiseConv2d"));const k=(e,t)=>{p.hu(C.I0(o),(()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`));const[i,s,u,l]=t,c=(0,br.Fr)(e,u,h),d=(0,_r.v)(s.shape,c,i,n,r,o,a),f=(0,xr.z)(s,c,i.shape,n,r,o,a);return null!=l?[d,f,(0,br.pf)(_,c)]:[d,f]},S={x:b,filter:y,bias:_,preluActivationWeights:w},T={strides:n,pad:r,dataFormat:i,dilations:o,dimRoundingMode:a,activation:h,leakyreluAlpha:g};if(null==d){const e=(0,fr.cb)(((e,t,n)=>{let r=u.BV.runKernel(l.luS,S,T);return n([t,e,r]),v&&(r=(0,M.X)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:k}}));return e(b,y)}{const e=(0,fr.cb)(((e,t,n,r)=>{let i=u.BV.runKernel(l.luS,S,T);return r([t,e,i,n]),v&&(i=(0,M.X)(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:k}}));return e(b,y,_)}}}),kr=(0,d.op)({fusedMatMul_:function({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:i,activation:o="linear",preluActivationWeights:a,leakyreluAlpha:d=.2}){if(!1===(0,br.uy)(u.BV.state.gradientDepth,o)){let u=(0,A.O)(e,t,n,r);return null!=i&&(u=(0,s.I)(u,i)),(0,br.QH)(u,o,a,d)}let h=(0,c._1)(e,"a","fused matMul"),f=(0,c._1)(t,"b","fused matMul");[h,f]=(0,or.makeTypesMatch)(h,f);const g=n?h.shape[h.rank-2]:h.shape[h.rank-1],m=r?f.shape[f.rank-1]:f.shape[f.rank-2],y=n?h.shape[h.rank-1]:h.shape[h.rank-2],b=r?f.shape[f.rank-2]:f.shape[f.rank-1],v=h.shape.slice(0,-2),x=f.shape.slice(0,-2),_=p.NA(v),w=p.NA(x);p.hu(g===m,(()=>`Error in fused matMul: inner shapes (${g}) and (${m}) of Tensors with shapes ${h.shape} and ${f.shape} and transposeA=${n} and transposeB=${r} must match.`));const k=gr.assertAndGetBroadcastShape(h.shape.slice(0,-2),f.shape.slice(0,-2)).concat([y,b]),S=n?(0,M.X)(h,[_,g,y]):(0,M.X)(h,[_,y,g]),C=r?(0,M.X)(f,[w,b,m]):(0,M.X)(f,[w,m,b]);let T,E;null!=i&&(T=(0,c._1)(i,"bias","fused matMul"),[T]=(0,or.makeTypesMatch)(T,h),gr.assertAndGetBroadcastShape(k,T.shape)),null!=a&&(E=(0,c._1)(a,"prelu weights","fused matMul"));const F=(e,t)=>{const[a,s,u,l]=t,c=(0,br.Fr)((0,M.X)(e,u.shape),u,o);let p,d;return n||r?!n&&r?(p=(0,A.O)(c,s,!1,!1),d=(0,A.O)(c,a,!0,!1)):n&&!r?(p=(0,A.O)(s,c,!1,!0),d=(0,A.O)(a,c,!1,!1)):(p=(0,A.O)(s,c,!0,!0),d=(0,A.O)(c,a,!0,!0)):(p=(0,A.O)(c,s,!1,!0),d=(0,A.O)(a,c,!0,!1)),null!=i?[p,d,(0,br.pf)(l,c)]:[p,d]},O={a:S,b:C,bias:T,preluActivationWeights:E},R={transposeA:n,transposeB:r,activation:o,leakyreluAlpha:d};if(null==i){const e=(0,fr.cb)(((e,t,n)=>{const r=u.BV.runKernel(l.usg,O,R);return n([e,t,r]),{value:(0,M.X)(r,k),gradFunc:F}}));return e(S,C)}{const e=(0,fr.cb)(((e,t,n,r)=>{const i=u.BV.runKernel(l.usg,O,R);return r([e,t,i,n]),{value:(0,M.X)(i,k),gradFunc:F}}));return e(S,C,T)}}}),Sr=(0,d.op)({hammingWindow_:function(e){return dr(e,.54,.46)}}),Cr=(0,d.op)({hannWindow_:function(e){return dr(e,.5,.5)}}),Mr=(0,d.op)({frame_:function(e,t,n,r=!1,i=0){let o=0;const a=[];for(;o+t<=e.size;)a.push((0,R.t)(e,o,t)),o+=n;if(r)for(;o<e.size;){const r=o+t-e.size,s=(0,E.z)([(0,R.t)(e,o,t-r),(0,Ee.h)([r],i)]);a.push(s),o+=n}return 0===a.length?Ln([],[0,t]):(0,M.X)((0,E.z)(a),[a.length,t])}}),Tr=(0,d.op)({stft_:function(e,t,n,r,i=Cr){null==r&&(r=pr(t));const o=Mr(e,t,n),a=(0,F.d)(o,i(t));return(0,Sn.Q)(a,r)}}),Er=(0,d.op)({cropAndResize_:function(e,t,n,r,i="bilinear",o=0){const a=(0,c._1)(e,"image","cropAndResize"),s=(0,c._1)(t,"boxes","cropAndResize","float32"),d=(0,c._1)(n,"boxInd","cropAndResize","int32"),h=s.shape[0];p.hu(4===a.rank,(()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`)),p.hu(2===s.rank&&4===s.shape[1],(()=>`Error in cropAndResize: boxes must be have size [${h},4] but had shape ${s.shape}.`)),p.hu(1===d.rank&&d.shape[0]===h,(()=>`Error in cropAndResize: boxInd must be have size [${h}] but had shape ${s.shape}.`)),p.hu(2===r.length,(()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`)),p.hu(r[0]>=1&&r[1]>=1,(()=>`cropSize must be atleast [1,1], but was ${r}`)),p.hu("bilinear"===i||"nearest"===i,(()=>`method must be bilinear or nearest, but was ${i}`));const f={image:a,boxes:s,boxInd:d},g={method:i,extrapolationValue:o,cropSize:r};return u.BV.runKernel(l.VcC,f,g)}}),Ar=(0,d.op)({flipLeftRight_:function(e){const t=(0,c._1)(e,"image","flipLeftRight","float32");p.hu(4===t.rank,(()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`));const n={image:t};return u.BV.runKernel(l.Uyb,n,{})}}),Fr=(0,d.op)({grayscaleToRGB_:function(e){const t=(0,c._1)(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];p.hu(t.rank>=2,(()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`)),p.hu(1===r,(()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`));const i=new Array(t.rank);return i.fill(1,0,n),i[n]=3,(0,Me.G)(t,i)}}),Or=(0,d.op)({rotateWithOffset_:function(e,t,n=0,r=.5){const i=(0,c._1)(e,"image","rotateWithOffset","float32");p.hu(4===i.rank,(()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`));const o={image:i},a={radians:t,fillValue:n,center:r};return u.BV.runKernel(l.b9H,o,a)}});function Rr(e,t,n,r,i,o){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==o&&(o=0);const a=e.shape[0];return n=Math.min(n,a),p.hu(0<=r&&r<=1,(()=>`iouThreshold must be in [0, 1], but was '${r}'`)),p.hu(2===e.rank,(()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`)),p.hu(4===e.shape[1],(()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`)),p.hu(1===t.rank,(()=>"scores must be a 1D tensor")),p.hu(t.shape[0]===a,(()=>`scores has incompatible shape with boxes. Expected ${a}, but was ${t.shape[0]}`)),p.hu(0<=o&&o<=1,(()=>`softNmsSigma must be in [0, 1], but was '${o}'`)),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:o}}const Nr=(0,d.op)({nonMaxSuppression_:function(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){const o=(0,c._1)(e,"boxes","nonMaxSuppression","float32"),a=(0,c._1)(t,"scores","nonMaxSuppression","float32"),s=Rr(o,a,n,r,i),p={maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:i=s.scoreThreshold};return u.BV.runKernel(l.uv1,{boxes:o,scores:a},p)}});var Dr=n(3337);const Ir=(0,d.op)({nonMaxSuppressionWithScore_:function(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,o=0){const a=(0,c._1)(e,"boxes","nonMaxSuppression"),s=(0,c._1)(t,"scores","nonMaxSuppression"),p=Rr(a,s,n,r,i,o),d={boxes:a,scores:s},h={maxOutputSize:n=p.maxOutputSize,iouThreshold:r=p.iouThreshold,scoreThreshold:i=p.scoreThreshold,softNmsSigma:o=p.softNmsSigma},f=u.BV.runKernel(l.W0H,d,h);return{selectedIndices:f[0],selectedScores:f[1]}}}),Br=(0,d.op)({nonMaxSuppressionPadded_:function(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,o=!1){const a=(0,c._1)(e,"boxes","nonMaxSuppression"),s=(0,c._1)(t,"scores","nonMaxSuppression"),p=Rr(a,s,n,r,i,null),d={boxes:a,scores:s},h={maxOutputSize:p.maxOutputSize,iouThreshold:p.iouThreshold,scoreThreshold:p.scoreThreshold,padToMaxOutputSize:o},f=u.BV.runKernel(l.cye,d,h);return{selectedIndices:f[0],validOutputs:f[1]}}});var Lr=n(3305),Pr=n(5098);const $r=(0,d.op)({threshold_:function(e,t="binary",n=!1,r=.5){const i=(0,c._1)(e,"image","threshold"),o=i.shape[0]*i.shape[1];let a,u,l,d,h=(0,F.d)(Bn([r]),255);if(p.hu(3===i.rank,(()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`)),p.hu(3===i.shape[2]||1===i.shape[2],(()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`)),p.hu("int32"===i.dtype||"float32"===i.dtype,(()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`)),p.hu("otsu"===t||"binary"===t,(()=>`Method must be binary or otsu, but was ${t}`)),3===i.shape[2]){[a,u,l]=(0,Cn.V)(i,[1,1,1],-1);const e=(0,F.d)(a,.2989),t=(0,F.d)(u,.587),n=(0,F.d)(l,.114);d=(0,s.I)((0,s.I)(e,t),n)}else d=e;"otsu"===t&&(h=function(e,t){let n,r,i,o,a,u,l=Bn([-1]),c=Bn([0]),p=Bn([0]);for(let d=0;d<e.size-1;d++){n=(0,R.t)(e,0,d+1),r=(0,R.t)(e,d+1),a=(0,fe.h)((0,Rn.S)(n),t),u=(0,fe.h)((0,Rn.S)(r),t);const h=(0,Rn.S)((0,F.d)(n,Xt(0,n.size)));i=(0,fe.h)(h,(0,Rn.S)(n));const f=(0,Ee.h)(r.shape,n.size),g=(0,s.I)(Xt(0,r.size),f),m=(0,F.d)(r,g);o=(0,fe.h)((0,Rn.S)(m),(0,Rn.S)(r));const y=(0,mt.l)(i,o),b=(0,mt.l)(i,o),v=(0,F.d)(a,u);p=(0,F.d)((0,F.d)(v,y),b);const x=(0,Re.p)(p,c);c=(0,Jn.a)(x,p,c),l=(0,Jn.a)(x,Bn([d]),l)}return l}(z((0,S.p)((0,on.N)(d),"int32"),(0,Dn.X)([]),256),o));const f=n?(0,ze.z)(d,h):(0,Re.p)(d,h);return(0,S.p)((0,F.d)(f,255),"int32")}}),zr=(0,d.op)({transform_:function(e,t,n="nearest",r="constant",i=0,o){const a=(0,c._1)(e,"image","transform","float32"),s=(0,c._1)(t,"transforms","transform","float32");p.hu(4===a.rank,(()=>`Error in transform: image must be rank 4,but got rank ${a.rank}.`)),p.hu(2===s.rank&&(s.shape[0]===a.shape[0]||1===s.shape[0])&&8===s.shape[1],(()=>"Error in transform: Input transform should be batch x 8 or 1 x 8")),p.hu(null==o||2===o.length,(()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`));const d={image:a,transforms:s},h={interpolation:n,fillMode:r,fillValue:i,outputShape:o};return u.BV.runKernel(l.wx7,d,h)}}),jr=(0,d.op)({bandPart_:function(e,t,n){const r=(0,c._1)(e,"a","bandPart");(0,p.hu)(r.rank>=2,(()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`));const i=r.shape,[o,a]=r.shape.slice(-2);let s,u;"number"==typeof t?((0,p.hu)(t%1==0,(()=>`bandPart(): numLower must be an integer, got ${t}.`)),(0,p.hu)(t<=o,(()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${o}).`)),s=(0,c._1)(t<0?o:t,"numLower","bandPart")):((0,p.hu)("int32"===t.dtype,(()=>"bandPart(): numLower's dtype must be an int32.")),s=(0,Jn.a)((0,$e.d)(t,0),o,(0,pt.L)(t,o))),"number"==typeof n?((0,p.hu)(n%1==0,(()=>`bandPart(): numUpper must be an integer, got ${n}.`)),(0,p.hu)(n<=a,(()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${a}).`)),u=(0,c._1)(n<0?a:n,"numUpper","bandPart")):((0,p.hu)("int32"===n.dtype,(()=>"bandPart(): numUpper's dtype must be an int32.")),u=(0,Jn.a)((0,$e.d)(n,0),a,(0,pt.L)(n,a)));const l=(0,M.X)(Xt(0,o,1,"int32"),[-1,1]),d=Xt(0,a,1,"int32"),h=(0,mt.l)(l,d),f=(0,Xe.H)((0,ze.z)(h,s),(0,Ne.b)(h,(0,xt.W)(u))),g=(0,er.l)([o,a],r.dtype);return(0,M.X)((0,An.k)((0,Xn.H)((0,M.X)(r,[-1,o,a])).map((e=>(0,Jn.a)(f,e,g)))),i)}}),Gr=(0,d.op)({gramSchmidt_:function(e){let t;if(Array.isArray(e)){t=!1,(0,p.hu)(null!=e&&e.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const n=e[0].shape[0];for(let t=1;t<e.length;++t)(0,p.hu)(e[t].shape[0]===n,(()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[t].shape[0]} vs. ${n})`))}else t=!0,e=(0,Cn.V)(e,e.shape[0],0).map((e=>(0,En.L)(e,[0])));(0,p.hu)(e.length<=e[0].shape[0],(()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`));const n=[],r=e;for(let t=0;t<e.length;++t)n.push(u.BV.tidy((()=>{let e=r[t];if(t>0)for(let r=0;r<t;++r){const t=(0,F.d)((0,Rn.S)((0,F.d)(n[r],e)),n[r]);e=(0,mt.l)(e,t)}return(0,fe.h)(e,(0,ir.K)(e,"euclidean"))})));return t?(0,An.k)(n,0):n}});var Ur=n(4368);function Wr(e,t=!1){return u.BV.tidy((()=>{(0,p.hu)(2===e.shape.length,(()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`));const n=e.shape[0],r=e.shape[1];let i=Te(n),o=(0,q.d)(e);const a=Ln([[1]],[1,1]);let s=(0,q.d)(a);const l=n>=r?r:n;for(let e=0;e<l;++e){const t=o,l=s,c=i;[s,o,i]=u.BV.tidy((()=>{const t=(0,R.t)(o,[e,e],[n-e,1]),u=(0,ir.K)(t),l=(0,R.t)(o,[e,e],[1,1]),c=(0,Jn.a)((0,Re.p)(l,0),Ln([[-1]]),Ln([[1]])),p=(0,mt.l)(l,(0,F.d)(c,u)),d=(0,fe.h)(t,p);s=1===d.shape[0]?(0,q.d)(a):(0,E.z)([a,(0,R.t)(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);const h=(0,xt.W)((0,fe.h)((0,A.O)(c,p),u)),f=(0,R.t)(o,[e,0],[n-e,r]),g=(0,F.d)(h,s),m=(0,rr.p)(s);if(0===e)o=(0,mt.l)(f,(0,A.O)(g,(0,A.O)(m,f)));else{const t=(0,mt.l)(f,(0,A.O)(g,(0,A.O)(m,f)));o=(0,E.z)([(0,R.t)(o,[0,0],[e,r]),t],0)}const y=(0,rr.p)(g),b=(0,R.t)(i,[0,e],[n,i.shape[1]-e]);if(0===e)i=(0,mt.l)(b,(0,A.O)((0,A.O)(b,s),y));else{const t=(0,mt.l)(b,(0,A.O)((0,A.O)(b,s),y));i=(0,E.z)([(0,R.t)(i,[0,0],[n,e]),t],1)}return[s,o,i]})),(0,Ur.B9)([t,l,c])}return!t&&n>r&&(i=(0,R.t)(i,[0,0],[n,r]),o=(0,R.t)(o,[0,0],[r,r])),[i,o]}))}const Vr=(0,d.op)({qr_:function(e,t=!1){if((0,p.hu)(e.rank>=2,(()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`)),2===e.rank)return Wr(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce(((e,t)=>e*t)),r=(0,Xn.H)((0,M.X)(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],o=[];return r.forEach((e=>{const[n,r]=Wr(e,t);i.push(n),o.push(r)})),[(0,M.X)((0,An.k)(i,0),e.shape),(0,M.X)((0,An.k)(o,0),e.shape)]}}});var Hr=n(9876);const qr=(0,d.op)({computeWeightedLoss_:function(e,t,n=Hr.I.SUM_BY_NONZERO_WEIGHTS){const r=(0,c._1)(e,"losses","computeWeightedLoss");let i=null;null!=t&&(i=(0,c._1)(t,"weights","computeWeightedLoss"));const o=null==i?r:(0,F.d)(r,i);if(n===Hr.I.NONE)return o;if(n===Hr.I.SUM)return(0,Rn.S)(o);if(n===Hr.I.MEAN){if(null==i)return(0,at.J)(o);{const e=r.size/i.size,t=(0,fe.h)((0,Rn.S)(o),(0,Rn.S)(i));return e>1?(0,fe.h)(t,(0,sn.i)(e)):t}}if(n===Hr.I.SUM_BY_NONZERO_WEIGHTS){if(null==i)return(0,fe.h)((0,Rn.S)(o),(0,sn.i)(r.size));{const e=(0,F.d)(i,(0,st.i)(r.shape)),t=(0,S.p)((0,Rn.S)((0,_t.Q)(e,(0,sn.i)(0))),"float32");return(0,fe.h)((0,Rn.S)(o),t)}}throw Error(`Unknown reduction: ${n}`)}}),Xr=(0,d.op)({absoluteDifference_:function(e,t,n,r=Hr.I.SUM_BY_NONZERO_WEIGHTS){const o=(0,c._1)(e,"labels","absoluteDifference"),a=(0,c._1)(t,"predictions","absoluteDifference");let s=null;null!=n&&(s=(0,c._1)(n,"weights","absoluteDifference")),(0,p.k5)(o.shape,a.shape,"Error in absoluteDifference: ");const u=(0,i.W)((0,mt.l)(o,a));return qr(u,s,r)}}),Yr=(0,d.op)({cosineDistance_:function(e,t,n,r,i=Hr.I.SUM_BY_NONZERO_WEIGHTS){const o=(0,c._1)(e,"labels","cosineDistance"),a=(0,c._1)(t,"predictions","cosineDistance");let s=null;null!=r&&(s=(0,c._1)(r,"weights","cosineDistance")),(0,p.k5)(o.shape,a.shape,"Error in cosineDistance: ");const u=(0,sn.i)(1),l=(0,mt.l)(u,(0,Rn.S)((0,F.d)(o,a),n,!0));return qr(l,s,i)}}),Kr=(0,d.op)({hingeLoss_:function(e,t,n,r=Hr.I.SUM_BY_NONZERO_WEIGHTS){let i=(0,c._1)(e,"labels","hingeLoss");const o=(0,c._1)(t,"predictions","hingeLoss");let a=null;null!=n&&(a=(0,c._1)(n,"weights","hingeLoss")),(0,p.k5)(i.shape,o.shape,"Error in hingeLoss: ");const s=(0,sn.i)(1);i=(0,mt.l)((0,F.d)((0,sn.i)(2),i),s);const u=(0,Jt.U)((0,mt.l)(s,(0,F.d)(i,o)));return qr(u,a,r)}}),Jr=(0,d.op)({huberLoss_:function(e,t,n,r=1,o=Hr.I.SUM_BY_NONZERO_WEIGHTS){const a=(0,c._1)(e,"labels","huberLoss"),u=(0,c._1)(t,"predictions","huberLoss");let l=null;null!=n&&(l=(0,c._1)(n,"weights","huberLoss")),(0,p.k5)(a.shape,u.shape,"Error in huberLoss: ");const d=(0,sn.i)(r),h=(0,i.W)((0,mt.l)(u,a)),f=(0,pt.L)(h,d),g=(0,mt.l)(h,f),m=(0,s.I)((0,F.d)((0,sn.i)(.5),(0,gt.h)(f)),(0,F.d)(d,g));return qr(m,l,o)}}),Zr=(0,d.op)({logLoss_:function(e,t,n,r=1e-7,i=Hr.I.SUM_BY_NONZERO_WEIGHTS){const o=(0,c._1)(e,"labels","logLoss"),a=(0,c._1)(t,"predictions","logLoss");let u=null;null!=n&&(u=(0,c._1)(n,"weights","logLoss")),(0,p.k5)(o.shape,a.shape,"Error in logLoss: ");const l=(0,sn.i)(1),d=(0,sn.i)(r),h=(0,xt.W)((0,F.d)(o,(0,Ue.c)((0,s.I)(a,d)))),f=(0,F.d)((0,mt.l)(l,o),(0,Ue.c)((0,s.I)((0,mt.l)(l,a),d))),g=(0,mt.l)(h,f);return qr(g,u,i)}}),Qr=(0,d.op)({meanSquaredError_:function(e,t,n,r=Hr.I.SUM_BY_NONZERO_WEIGHTS){const i=(0,c._1)(e,"labels","meanSquaredError"),o=(0,c._1)(t,"predictions","meanSquaredError");let a=null;null!=n&&(a=(0,c._1)(n,"weights","meanSquaredError")),(0,p.k5)(i.shape,o.shape,"Error in meanSquaredError: ");const s=(0,Tn.$)(i,o);return qr(s,a,r)}}),ei=(0,d.op)({sigmoidCrossEntropy_:function(e,t,n,r=0,o=Hr.I.SUM_BY_NONZERO_WEIGHTS){let a=(0,c._1)(e,"multiClassLabels","sigmoidCrossEntropy");const u=(0,c._1)(t,"logits","sigmoidCrossEntropy");let l=null;if(null!=n&&(l=(0,c._1)(n,"weights","sigmoidCrossEntropy")),(0,p.k5)(a.shape,u.shape,"Error in sigmoidCrossEntropy: "),r>0){const e=(0,sn.i)(r),t=(0,sn.i)(1),n=(0,sn.i)(.5);a=(0,s.I)((0,F.d)(a,(0,mt.l)(t,e)),(0,F.d)(n,e))}const d=function(e,t){const n=(0,c._1)(e,"labels","sigmoidCrossEntropyWithLogits"),r=(0,c._1)(t,"logits","sigmoidCrossEntropyWithLogits");(0,p.k5)(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const o=(0,Jt.U)(r),a=(0,F.d)(r,n),u=(0,We.K)((0,ke.Q)((0,xt.W)((0,i.W)(r))));return(0,s.I)((0,mt.l)(o,a),u)}(a,u);return qr(d,l,o)}}),ti=(0,d.op)({softmaxCrossEntropy_:function(e,t,n,r=0,i=Hr.I.SUM_BY_NONZERO_WEIGHTS){let o=(0,c._1)(e,"onehotLabels","softmaxCrossEntropy");const a=(0,c._1)(t,"logits","softmaxCrossEntropy");let u=null;if(null!=n&&(u=(0,c._1)(n,"weights","softmaxCrossEntropy")),(0,p.k5)(o.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){const e=(0,sn.i)(r),t=(0,sn.i)(1),n=(0,sn.i)(o.shape[1]);o=(0,s.I)((0,F.d)(o,(0,mt.l)(t,e)),(0,fe.h)(e,n))}const l=function(e,t,n=-1){if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);const r=(0,fr.cb)(((e,t,r)=>{const i=(0,qe.l)(t,[n],!0),o=(0,mt.l)((0,S.p)(t,"float32"),i);r([e,o]);const a=(0,xt.W)((0,F.d)(o,e));return{value:(0,Rn.S)(a,[n]),gradFunc:(e,t)=>{const[r,i]=t,o=(0,ft.rv)(e.shape,[n]);return[(0,F.d)((0,M.X)(e,o),(0,mt.l)((0,S.p)(r,"float32"),(0,ke.Q)(i))),(0,F.d)((0,M.X)(e,o),(0,mt.l)((0,ke.Q)(i),(0,S.p)(r,"float32")))]}}}));return r(e,t)}(o,a);return qr(l,u,i)}}),ni=(0,d.op)({sparseFillEmptyRows_:function(e,t,n,r){const i=(0,c._1)(e,"indices","sparseFillEmptyRows","int32"),o=(0,c._1)(t,"values","sparseFillEmptyRows"),a=(0,c._1)(n,"denseShape","sparseFillEmptyRows","int32"),s=(0,c._1)(r,"defaultValue","sparseFillEmptyRows",o.dtype);if(2!==i.rank)throw new Error(`Indices should be Tensor2D but received shape\n        ${i.shape}`);if(1!==o.rank)throw new Error(`Values should be Tensor1D but received shape ${o.shape}`);if(1!==a.rank)throw new Error(`Dense shape should be Tensor1D but received shape ${a.shape}`);if(0!==s.rank)throw new Error(`Default value should be a scalar but received shape ${s.shape}`);const p={indices:i,values:o,denseShape:a,defaultValue:s},d=u.BV.runKernel(l.O3z,p);return{outputIndices:d[0],outputValues:d[1],emptyRowIndicator:d[2],reverseIndexMap:d[3]}}}),ri=(0,d.op)({sparseReshape_:function(e,t,n){const r=(0,c._1)(e,"inputIndices","sparseReshape","int32"),i=(0,c._1)(t,"inputShape","sparseReshape","int32"),o=(0,c._1)(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error(`Input indices should be Tensor2D but received shape\n        ${r.shape}`);if(1!==i.rank)throw new Error(`Input shape should be Tensor1D but received shape ${i.shape}`);if(1!==o.rank)throw new Error(`New shape should be Tensor1D but received shape ${o.shape}`);const a={inputIndices:r,inputShape:i,newShape:o},s=u.BV.runKernel(l.nhH,a);return{outputIndices:s[0],outputShape:s[1]}}}),ii=(0,d.op)({sparseSegmentMean_:function(e,t,n){const r=(0,c._1)(e,"data","sparseSegmentMean"),i=(0,c._1)(t,"indices","sparseSegmentMean","int32"),o=(0,c._1)(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error(`Indices should be Tensor1D but received shape\n          ${i.shape}`);if(1!==o.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n          ${o.shape}`);const a={data:r,indices:i,segmentIds:o};return u.BV.runKernel(l.w3H,a)}}),oi=(0,d.op)({sparseSegmentSum_:function(e,t,n){const r=(0,c._1)(e,"data","sparseSegmentSum"),i=(0,c._1)(t,"indices","sparseSegmentSum","int32"),o=(0,c._1)(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error(`Indices should be Tensor1D but received shape\n         ${i.shape}`);if(1!==o.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n         ${o.shape}`);const a={data:r,indices:i,segmentIds:o};return u.BV.runKernel(l.ZjV,a)}}),ai=(0,d.op)({stringNGrams_:function(e,t,n,r,i,o,a,s){const p=(0,c._1)(e,"data","stringNGrams","string");if("string"!==p.dtype)throw new Error("Data must be of datatype string");if(1!==p.shape.length)throw new Error(`Data must be a vector, saw: ${p.shape}`);const d=(0,c._1)(t,"dataSplits","stringNGrams");if("int32"!==d.dtype)throw new Error("Data splits must be of datatype int32");const h={separator:n,nGramWidths:r,leftPad:i,rightPad:o,padWidth:a,preserveShortSequences:s},f={data:p,dataSplits:d},g=u.BV.runKernel(l._JP,f,h);return{nGrams:g[0],nGramsSplits:g[1]}}}),si=(0,d.op)({stringSplit_:function(e,t,n=!0){const r=(0,c._1)(e,"input","stringSplit","string"),i=(0,c._1)(t,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(0!==i.rank)throw new Error(`Delimiter should be a scalar but received shape ${i.shape}`);const o={skipEmpty:n},a={input:r,delimiter:i},s=u.BV.runKernel(l.s1s,a,o);return{indices:s[0],values:s[1],shape:s[2]}}}),ui=(0,d.op)({stringToHashBucketFast_:function(e,t){const n=(0,c._1)(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const i={input:n};return u.BV.runKernel(l.XkS,i,r)}}),li=(0,d.op)({staticRegexReplace_:function(e,t,n,r=!0){const i=(0,c._1)(e,"input","staticRegexReplace","string"),o={pattern:t,rewrite:n,replaceGlobal:r};return u.BV.runKernel(l.e0R,{x:i},o)}}),ci={fft:_n.k,ifft:wn.S,rfft:Sn.Q,irfft:kn.w},pi={hammingWindow:Sr,hannWindow:Cr,frame:Mr,stft:Tr},di={flipLeftRight:Ar,grayscaleToRGB:Fr,resizeNearestNeighbor:Pr.j,resizeBilinear:Lr.I,rotateWithOffset:Or,cropAndResize:Er,nonMaxSuppression:Nr,nonMaxSuppressionAsync:async function(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){const o=(0,c._1)(e,"boxes","nonMaxSuppressionAsync"),a=(0,c._1)(t,"scores","nonMaxSuppressionAsync"),s=Rr(o,a,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;const u=await Promise.all([o.data(),a.data()]),l=u[0],p=u[1],{selectedIndices:d}=(0,Dr.GP)(l,p,n,r,i);return o!==e&&o.dispose(),a!==t&&a.dispose(),Bn(d,"int32")},nonMaxSuppressionWithScore:Ir,nonMaxSuppressionWithScoreAsync:async function(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,o=0){const a=(0,c._1)(e,"boxes","nonMaxSuppressionAsync"),s=(0,c._1)(t,"scores","nonMaxSuppressionAsync"),u=Rr(a,s,n,r,i,o);n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,o=u.softNmsSigma;const l=await Promise.all([a.data(),s.data()]),p=l[0],d=l[1],{selectedIndices:h,selectedScores:f}=(0,Dr.pA)(p,d,n,r,i,o);return a!==e&&a.dispose(),s!==t&&s.dispose(),{selectedIndices:Bn(h,"int32"),selectedScores:Bn(f)}},nonMaxSuppressionPadded:Br,nonMaxSuppressionPaddedAsync:async function(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,o=!1){const a=(0,c._1)(e,"boxes","nonMaxSuppressionAsync"),s=(0,c._1)(t,"scores","nonMaxSuppressionAsync"),u=Rr(a,s,n,r,i,null),l=u.maxOutputSize,p=u.iouThreshold,d=u.scoreThreshold,[h,f]=await Promise.all([a.data(),s.data()]),{selectedIndices:g,validOutputs:m}=(0,Dr.qP)(h,f,l,p,d,o);return a!==e&&a.dispose(),s!==t&&s.dispose(),{selectedIndices:Bn(g,"int32"),validOutputs:(0,sn.i)(m,"int32")}},threshold:$r,transform:zr},hi={bandPart:jr,gramSchmidt:Gr,qr:Vr},fi={absoluteDifference:Xr,computeWeightedLoss:qr,cosineDistance:Yr,hingeLoss:Kr,huberLoss:Jr,logLoss:Zr,meanSquaredError:Qr,sigmoidCrossEntropy:ei,softmaxCrossEntropy:ti},gi={sparseFillEmptyRows:ni,sparseReshape:ri,sparseSegmentMean:ii,sparseSegmentSum:oi},mi={stringNGrams:ai,stringSplit:si,stringToHashBucketFast:ui,staticRegexReplace:li}},9682:(e,t,n)=>{"use strict";n.d(t,{v:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({pad_:function(e,t,n=0){const a=(0,o._1)(e,"x","pad");if(0===a.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:t,constantValue:n},u={x:a};return r.BV.runKernel(i.lyA,u,s)}})},5860:(e,t,n)=>{"use strict";n.d(t,{d:()=>d});var r=n(3740),i=n(569),o=n(5176),a=n(8441),s=n(2582),u=n(1174),l=n(2668),c=n(4968),p=n(7918);const d=(0,l.op)({pool_:function(e,t,n,l,d,h,f){null==d&&(d=[1,1]),null==h&&(h=1),0===l&&(l="valid");const g=(0,r._1)(e,"x","maxPool");let m=g,y=!1;3===g.rank&&(y=!0,m=(0,c.X)(g,[1,g.shape[0],g.shape[1],g.shape[2]])),i.hu(s.jT(h,d),(()=>`Error in pool: Either strides or dilations must be 1. Got strides ${h} and dilations '${d}'`));const b=s.Xw(m.shape,t,h,d,l),v=[b.dilationHeight,b.dilationWidth];let x;x="same"===l?function(e,t){const n=e.map(((e,n)=>e+(e-1)*(t[n]-1))).map((e=>e-1)),r=n.map((e=>Math.floor(e/2))),i=n.map(((e,t)=>e-r[t]));return n.map(((e,t)=>[r[t],i[t]]))}([b.filterHeight,b.filterWidth],v):[[0,0],[0,0]];const _=1===v[0]&&1===v[1],[w,k]=function(e,t,n){const r=n.map((e=>e[0])),i=n.map((e=>e[1])),o=e.concat(r,i),a=t.map(((e,t)=>(e-o[t]%e)%e)),s=i.map(((e,t)=>e+a[t]));return[t.map(((e,t)=>[r[t],s[t]])),t.map(((e,t)=>[0,a[t]]))]}([b.inHeight,b.inWidth],v,x),S=_?l:"valid",C=_?m:(0,p.f)(m,v,w),M=("avg"===n?()=>(0,o.w)(C,t,h,S,f):()=>(0,u._)(C,t,h,S,f))(),T=_?M:(0,a.E)(M,v,k);return y?(0,c.X)(T,[T.shape[1],T.shape[2],T.shape[3]]):T}})},3453:(e,t,n)=>{"use strict";n.d(t,{s:()=>s});var r=n(7097),i=n(9121),o=n(747),a=n(3740);const s=(0,n(2668).op)({pow_:function(e,t){let n=(0,a._1)(e,"base","pow"),s=(0,a._1)(t,"exp","pow");[n,s]=(0,o.makeTypesMatch)(n,s);const u={a:n,b:s};return r.BV.runKernel(i.pe_,u)}})},8151:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({prelu_:function(e,t){const n={x:(0,o._1)(e,"x","prelu"),alpha:(0,o._1)(t,"alpha","prelu")};return r.BV.runKernel(i.o0g,n)}})},9798:(e,t,n)=>{"use strict";function r(e,t=!1){console.log(e.toString(t))}n.d(t,{S:()=>r})},9451:(e,t,n)=>{"use strict";n.d(t,{W:()=>s});var r=n(7097),i=n(9121),o=n(3740),a=n(2271);const s=(0,n(2668).op)({prod_:function(e,t=null,n=!1){let s=(0,o._1)(e,"x","prod");"bool"===s.dtype&&(s=(0,a.p)(s,"int32"));const u={x:s},l={axis:t,keepDims:n};return r.BV.runKernel(i.DlI,u,l)}})},766:(e,t,n)=>{"use strict";n.d(t,{k:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({real_:function(e){const t={input:(0,o._1)(e,"input","real")};return r.BV.runKernel(i.xJR,t)}})},9036:(e,t,n)=>{"use strict";n.d(t,{M:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({reciprocal_:function(e){const t={x:(0,o._1)(e,"x","reciprocal")};return r.BV.runKernel(i.$HU,t)}})},7409:(e,t,n)=>{"use strict";n.d(t,{U:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({relu_:function(e){const t={x:(0,o._1)(e,"x","relu")};return r.BV.runKernel(i.qkr,t)}})},3582:(e,t,n)=>{"use strict";n.d(t,{b:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({relu6_:function(e){const t={x:(0,o._1)(e,"x","relu6")};return r.BV.runKernel(i.SbG,t)}})},4968:(e,t,n)=>{"use strict";n.d(t,{X:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({reshape_:function(e,t){const n={x:(0,o._1)(e,"x","reshape","string_or_numeric")},a={shape:t};return r.BV.runKernel(i.HZH,n,a)}})},7486:(e,t,n)=>{"use strict";n.d(t,{G:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({reverse_:function(e,t){const n={x:(0,o._1)(e,"x","reverse")},a={dims:t};return r.BV.runKernel(i.mKl,n,a)}})},7809:(e,t,n)=>{"use strict";n.d(t,{N:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({round_:function(e){const t={x:(0,o._1)(e,"x","round")};return r.BV.runKernel(i.e07,t)}})},2634:(e,t,n)=>{"use strict";n.d(t,{b:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({rsqrt_:function(e){const t={x:(0,o._1)(e,"x","rsqrt","float32")};return r.BV.runKernel(i.bV0,t)}})},9494:(e,t,n)=>{"use strict";n.d(t,{i:()=>o});var r=n(9122),i=n(7852);function o(e,t){if(((0,r.isTypedArray)(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&(0,r.isTypedArray)(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return(0,i.H)(e,[],[],t)}},3028:(e,t,n)=>{"use strict";n.r(t),n.d(t,{calculateShapes:()=>a,validateInput:()=>o,validateUpdateShape:()=>i});var r=n(569);function i(e,t,n){const r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(o+` update.rank < ${i}. `);if(e.length<r+(n.rank-i))throw new Error(o+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+e.length-r)throw new Error(o+" update.rank != "+(i+e.length-r));for(let e=0;e<i;++e)if(n.shape[e]!==t.shape[e])throw new Error(o+` updates.shape[${e}] (${n.shape[e]}) != indices.shape[${e}] (${t.shape[e]}).`);for(let t=0;t<n.rank-i;++t)if(n.shape[t+i]!==e[t+r])throw new Error(o+` updates.shape[${t+i}] (${n.shape[t+i]}) != shape[${t+i}] (${e[t+i]})`)}function o(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if("int32"!==t.dtype)throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(0===n.length){if(0===t.size)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(0===e.size)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}i(n,t,e)}function a(e,t,n){const i=t.shape.length,o=i>1?t.shape[i-1]:1,a=n.length;let s=1;for(let e=o;e<a;++e)s*=n[e];const u=o<1?1:o;return{sliceRank:o,numUpdates:(0,r.NA)(t.shape)/u,sliceSize:s,strides:[...(0,r.e3)(n.slice(0,o)),1],outputSize:(0,r.NA)(n)}}},5503:(e,t,n)=>{"use strict";n.d(t,{U:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({selu_:function(e){const t={x:(0,o._1)(e,"x","selu")};return r.BV.runKernel(i.oFR,t)}})},3179:(e,t,n)=>{"use strict";n.d(t,{$:()=>i,y:()=>r});const r=1.7580993408473768,i=1.0507009873554805},8678:(e,t,n)=>{"use strict";n.d(t,{U:()=>l});var r=n(3740),i=n(569),o=n(4794),a=n(4718),s=n(2668),u=n(4968);const l=(0,s.op)({separableConv2d_:function(e,t,n,s,l,c=[1,1],p="NHWC"){const d=(0,r._1)(e,"x","separableConv2d"),h=(0,r._1)(t,"depthwiseFilter","separableConv2d"),f=(0,r._1)(n,"pointwiseFilter","separableConv2d");let g=d,m=!1;if(3===d.rank&&(m=!0,g=(0,u.X)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),"NCHW"===p)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");i.hu(4===g.rank,(()=>`Error in separableConv2d: input must be rank 4, but got rank ${g.rank}.`)),i.hu(4===h.rank,(()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${h.rank}.`)),i.hu(4===f.rank,(()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${h.rank}.`)),i.hu(1===f.shape[0],(()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${f.shape[0]}.`)),i.hu(1===f.shape[1],(()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${f.shape[1]}.`));const y=h.shape[2],b=h.shape[3];i.hu(f.shape[2]===y*b,(()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${y*b}, but got ${f.shape[2]}.`));const v=(0,a.B)(g,h,s,l,p,c),x=(0,o.T)(v,f,1,"valid",p);return m?(0,u.X)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},625:(e,t,n)=>{"use strict";n.d(t,{X:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({sigmoid_:function(e){const t={x:(0,o._1)(e,"x","sigmoid","float32")};return r.BV.runKernel(i.a5O,t)}})},4434:(e,t,n)=>{"use strict";n.d(t,{X:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({sign_:function(e){const t={x:(0,o._1)(e,"x","sign")};return r.BV.runKernel(i.i5y,t)}})},9331:(e,t,n)=>{"use strict";n.d(t,{O:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({sin_:function(e){const t={x:(0,o._1)(e,"x","sin","float32")};return r.BV.runKernel(i.RQH,t)}})},3254:(e,t,n)=>{"use strict";n.d(t,{R:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({sinh_:function(e){const t={x:(0,o._1)(e,"x","sinh")};return r.BV.runKernel(i.wYB,t)}})},2676:(e,t,n)=>{"use strict";n.d(t,{t:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({slice_:function(e,t,n){const a=(0,o._1)(e,"x","slice","string_or_numeric");if(0===a.rank)throw new Error("Slicing scalar is not possible");const s={x:a},u={begin:t,size:n};return r.BV.runKernel(i.p2w,s,u)}})},7650:(e,t,n)=>{"use strict";n.r(t),n.d(t,{assertParamsValid:()=>a,computeFlatOffset:()=>v,computeOutShape:()=>u,getNormalizedAxes:()=>d,isSliceContinous:()=>b,maskToAxes:()=>s,parseSliceParams:()=>x,sliceInfo:()=>_,startForAxis:()=>m,startIndicesWithElidedDims:()=>h,stopForAxis:()=>y,stopIndicesWithElidedDims:()=>f,stridesForAxis:()=>g,stridesWithElidedDims:()=>l});var r=n(569);const i=-2,o=-1;function a(e,t,n){const i=e.shape.length;r.hu(i===t.length,(()=>`Error in slice${i}D: Length of begin ${t} must match the rank of the array (${i}).`)),r.hu(i===n.length,(()=>`Error in slice${i}D: Length of size ${n} must match the rank of the array (${i}).`));for(let o=0;o<i;++o)r.hu(t[o]+n[o]<=e.shape[o],(()=>`Error in slice${i}D: begin[${o}] + size[${o}] (${t[o]+n[o]}) would overflow input.shape[${o}] (${e.shape[o]})`))}function s(e){const t=[];let n=0;for(;e>0;)1&e&&t.push(n),e/=2,n++;return t}function u(e,t,n){const r=[];for(let i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function l(e,t,n,r){const i=[...e];for(let e=i.length;e<r.length;e++)i.push(1);for(let e=0;e<n;e++)0===e?i[t]=1:(i.splice(t,0,1),i.pop());return i}function c(e,t,n){return n<=e?n:n-(t-1)}function p(e,t){const n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function d(e,t,n,r,i,o,a,s,u){const c=e.length;let p=new Array(c),d=new Array(c),b=new Array(c);if(t.length&&n>0){const u=t[0],c=n+1;p=h(a,u,c,r,e),d=f(s,u,c,i,e),b=l(o,u,c,e)}else for(let t=0;t<c;t++)p[t]=m(a,r,o,e,t,u),d[t]=y(s,i,o,e,t,u),b[t]=g(o,t,u);return{begin:p,end:d,strides:b}}function h(e,t,n,r,i){const o=[...i],a=p(n,t);for(let i=0;i<o.length;i++)if(a.indexOf(i)>-1)o[i]=0;else{const a=c(t,n,i);let s=r[a];e&1<<a&&(s=0),o[i]=s}return o}function f(e,t,n,i,o){const a=[...o],s=p(n,t);for(let r=0;r<a.length;r++)if(s.indexOf(r)>-1)a[r]=Number.MAX_SAFE_INTEGER;else{const o=c(t,n,r);let s=i[o];e&1<<o&&(s=Number.MAX_SAFE_INTEGER),a[r]=s}for(let e=0;e<a.length;e++){const t=o[e];a[e]<0&&(a[e]+=t),a[e]=r.uZ(0,a[e],o[e])}return a}function g(e,t,n){let r=e[t];return(n&1<<t||null==r)&&(r=1),r}function m(e,t,n,i,o,a){let s=t[o];const u=n[o]||1;(e&1<<o||a&1<<o||null==s)&&(s=u>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const l=i[o];return s<0&&(s+=l),s=r.uZ(0,s,l-1),s}function y(e,t,n,i,o,a){let s=t[o];const u=n[o]||1;(e&1<<o||a&1<<o||null==s)&&(s=u>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const l=i[o];return s<0&&(s+=l),s=u>0?r.uZ(0,s,l):r.uZ(-1,s,l-1),s}function b(e,t,n){let r=n.length;for(let e=0;e<n.length;e++)if(n[e]>1){r=e;break}for(let i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function v(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function x(e,t,n){let i;const o=e.shape.length;let a;return i="number"==typeof t?[t,...new Array(o-1).fill(0)]:t.length<o?t.concat(new Array(o-t.length).fill(0)):t.slice(),i.forEach((e=>{r.hu(-1!==e,(()=>"slice() does not support negative begin indexing."))})),a=null==n?new Array(o).fill(-1):"number"==typeof n?[n,...new Array(o-1).fill(-1)]:n.length<o?n.concat(new Array(o-n.length).fill(-1)):n,a=a.map(((t,n)=>t>=0?t:(r.hu(-1===t,(()=>`Negative size values should be exactly -1 but got ${t} for the slice() size at index ${n}.`)),e.shape[n]-i[n]))),[i,a]}function _(e,t,n,r,a,s,u,l,c){let p;if(null==r?(p=new Array(t.length),p.fill(1)):p=r,null!=u&&0!=(u&u-1))throw new Error("Multiple ellipses in slice is not allowed.");let d=!1;const h={dims:p.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:p.slice(),beginMask:a,endMask:s,ellipsisMask:u,newAxisMask:l,shrinkAxisMask:c};for(let e=0;e<h.dims;e++)d&&0!=(1<<e&l)&&h.numAddAxisAfterEllipsis++,1<<e&u&&(d=!0);d||(h.ellipsisMask|=1<<h.dims,h.dims++);const f={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){const i=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<i;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(i),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(o),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(h,f);let g=!0,m=!0,y=!0;const b=[],v=[];for(let t=0;t<e.length;++t){if(0===f.strides[t])throw Error(`strides[${t}] must be non-zero`);const n=!!(f.shrinkAxisMask&1<<t),r=e[t];if(-1===r){b.push(n?1:-1);continue}const i=[f.beginMask&1<<t,f.endMask&1<<t],o=[f.strides[t]>0?0:-1,f.strides[t]>0?r:r-1];if(n&&f.strides[t]<=0)throw Error("only stride 1 allowed on non-range indexing.");y=y&&1===f.strides[t];const a=!!(f.beginMask&1<<t&&f.endMask&1<<t);if(f.beginValid&&f.endValid){if(n){const e=f.begin[t]<0?r+f.begin[t]:f.begin[t];if(f.begin[t]=e,f.end[t]=f.begin[t]+1,e<0||e>=r)throw Error(`slice index ${f.begin[t]} of dimension ${t} out of bounds.`)}else f.begin[t]=w(f.begin[t],0,f.strides[t],r,i,o),f.end[t]=w(f.end[t],1,f.strides[t],r,i,o);const e=1===f.strides[t]&&0===f.begin[t]&&f.end[t]===r;g=g&&e,m=m&&(0===t&&1===f.strides[t]||e)}else g=g&&1===f.strides[t]&&a,m=m&&(0===t&&1===f.strides[t]||a);let s,u=!1;if(f.beginValid&&f.endValid?(s=f.end[t]-f.begin[t],u=!0):n?(s=1,u=!0):a&&r>=0&&(s=f.strides[t]<0?-r:r,u=!0),u){let e;e=0===s||s<0!=f.strides[t]<0?0:Math.trunc(s/f.strides[t])+(s%f.strides[t]!=0?1:0),b.push(e)}else b.push(-1)}for(let e=0;e<f.finalShapeGatherIndices.length;++e){const t=f.finalShapeGatherIndices[e];t>=0?v.push(b[t]):t===i&&v.push(1)}return{finalShapeSparse:v.filter(((e,t)=>f.finalShapeGatherIndices[t]!==i)),finalShape:v,isIdentity:g,sliceDim0:m,isSimpleSlice:y,begin:f.begin,end:f.end,strides:f.strides}}function w(e,t,n,r,i,o){if(i[t])return n>0?o[t]:o[t+1&1];{const t=e<0?r+e:e;return t<o[0]?o[0]:t>o[1]?o[1]:t}}},682:(e,t,n)=>{"use strict";n.d(t,{X:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({softmax_:function(e,t=-1){const n=(0,o._1)(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const a={logits:n},s={dim:t};return r.BV.runKernel(i.Gcp,a,s)}})},3694:(e,t,n)=>{"use strict";n.d(t,{W:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({softplus_:function(e){const t={x:(0,o._1)(e,"x","softplus")};return r.BV.runKernel(i.MRv,t)}})},7918:(e,t,n)=>{"use strict";n.d(t,{f:()=>s});var r=n(7097),i=n(9121),o=n(3740),a=n(569);const s=(0,n(2668).op)({spaceToBatchND_:function(e,t,n){const s=(0,o._1)(e,"x","spaceToBatchND");a.hu(s.rank>=1+t.length,(()=>`input rank ${s.rank} should be > than [blockShape] ${t.length}`)),a.hu(n.length===t.length,(()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`)),a.hu(s.shape.reduce(((e,r,i)=>i>0&&i<=t.length?e&&(r+n[i-1][0]+n[i-1][1])%t[i-1]==0:e),!0),(()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`));const u={x:s},l={blockShape:t,paddings:n};return r.BV.runKernel(i.TQc,u,l)}})},7020:(e,t,n)=>{"use strict";n.d(t,{k:()=>a});var r=n(7097),i=n(9121),o=n(569);const a=(0,n(2668).op)({fft_:function(e){(0,o.hu)("complex64"===e.dtype,(()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`));const t={input:e};return r.BV.runKernel(i.vwp,t)}})},8447:(e,t,n)=>{"use strict";n.d(t,{S:()=>a});var r=n(7097),i=n(9121),o=n(569);const a=(0,n(2668).op)({ifft_:function(e){(0,o.hu)("complex64"===e.dtype,(()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`));const t={input:e};return r.BV.runKernel(i.Qg5,t)}})},4415:(e,t,n)=>{"use strict";n.d(t,{w:()=>f});var r=n(1661),i=n(6884),o=n(4386),a=n(4841),s=n(2668),u=n(766),l=n(4968),c=n(7486),p=n(9494),d=n(2676),h=n(8447);const f=(0,s.op)({irfft_:function(e){const t=e.shape[e.shape.length-1],n=e.size/t;let s;if(t<=2){const r=(0,l.X)(e,[n,t]);s=(0,h.S)(r)}else{const f=[n,2*(t-1)],g=(0,l.X)((0,u.k)(e),[n,t]),m=(0,l.X)((0,o.a)(e),[n,t]),y=(0,c.G)((0,d.t)(g,[0,1],[n,t-2]),1),b=(0,a.d)((0,c.G)((0,d.t)(m,[0,1],[n,t-2]),1),(0,p.i)(-1)),v=(0,i.z)([g,y],1),x=(0,i.z)([m,b],1),_=(0,l.X)((0,r.P)(v,x),[f[0],f[1]]);s=(0,h.S)(_)}if(s=(0,u.k)(s),3===e.rank&&0!==e.shape[0]){const t=s,n=e.shape[0];s=(0,l.X)(s,[n,s.shape[0]/n,s.shape[1]]),t.dispose()}return s}})},3710:(e,t,n)=>{"use strict";n.d(t,{Q:()=>g});var r=n(569),i=n(1661),o=n(6884),a=n(4386),s=n(2668),u=n(766),l=n(4968),c=n(2676),p=n(8644),d=n(723),h=n(6577),f=n(7020);const g=(0,s.op)({rfft_:function(e,t){(0,r.hu)("float32"===e.dtype,(()=>`The dtype for rfft() must be real value but got ${e.dtype}`));let n=e.shape[e.shape.length-1];const s=e.size/n;let g;if(null!=t&&t<n){const r=e.shape.map((e=>0)),i=e.shape.map((e=>e));i[e.shape.length-1]=t,g=(0,c.t)(e,r,i),n=t}else if(null!=t&&t>n){const r=e.shape.map((e=>e));r[e.shape.length-1]=t-n,g=(0,o.z)([e,(0,d.l)(r)],e.shape.length-1),n=t}else g=e;const m=(0,h.P)(g),y=(0,l.X)((0,i.P)(g,m),[s,n]),b=(0,f.k)(y),v=Math.floor(n/2)+1,x=(0,u.k)(b),_=(0,a.a)(b),w=(0,p.V)(x,[v,n-v],x.shape.length-1),k=(0,p.V)(_,[v,n-v],_.shape.length-1),S=g.shape.slice();return S[g.shape.length-1]=v,(0,l.X)((0,i.P)(w[0],k[0]),S)}})},8644:(e,t,n)=>{"use strict";n.d(t,{V:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({split_:function(e,t,n=0){const a={x:(0,o._1)(e,"x","split")},s={numOrSizeSplits:t,axis:n};return r.BV.runKernel(i.L8s,a,s)}})},3261:(e,t,n)=>{"use strict";n.d(t,{_:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({sqrt_:function(e){const t={x:(0,o._1)(e,"x","sqrt","float32")};return r.BV.runKernel(i.FKq,t)}})},248:(e,t,n)=>{"use strict";n.d(t,{h:()=>o});var r=n(7097),i=n(3740);const o=(0,n(2668).op)({square_:function(e){const t=(0,i._1)(e,"x","square");return r.BV.runKernel("Square",{x:t},{})}})},5265:(e,t,n)=>{"use strict";n.d(t,{$:()=>u});var r=n(7097),i=n(9121),o=n(747),a=n(3740),s=n(2200);const u=(0,n(2668).op)({squaredDifference_:function(e,t){let n=(0,a._1)(e,"a","squaredDifference"),u=(0,a._1)(t,"b","squaredDifference");[n,u]=(0,o.makeTypesMatch)(n,u),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);const l={a:n,b:u};return r.BV.runKernel(i._tC,l,{})}})},9590:(e,t,n)=>{"use strict";n.d(t,{L:()=>s});var r=n(3740),i=n(569),o=n(2668),a=n(4968);const s=(0,o.op)({squeeze_:function(e,t){const n=(0,r._1)(e,"x","squeeze","string_or_numeric");return(0,a.X)(n,(0,i.bp)(n.shape,t).newShape)}})},2991:(e,t,n)=>{"use strict";n.d(t,{k:()=>s});var r=n(7097),i=n(9121),o=n(3740),a=n(569);const s=(0,n(2668).op)({stack_:function(e,t=0){const n=(0,o.sI)(e,"tensors","stack","string_or_numeric");a.hu(n.length>=1,(()=>"Pass at least one tensor to tf.stack")),n.length>0&&a.hu(t<=n[0].rank,(()=>"Axis must be <= rank of the tensor"));const s=n,u={axis:t};return r.BV.runKernel(i.QiL,s,u)}})},1901:(e,t,n)=>{"use strict";n.d(t,{N:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({step_:function(e,t=0){const n={x:(0,o._1)(e,"x","step")},a={alpha:t};return r.BV.runKernel(i.h8e,n,a)}})},5158:(e,t,n)=>{"use strict";n.d(t,{N:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({stridedSlice_:function(e,t,n,a,s=0,u=0,l=0,c=0,p=0){const d={x:(0,o._1)(e,"x","stridedSlice","string_or_numeric")},h={begin:t,end:n,strides:a,beginMask:s,endMask:u,ellipsisMask:l,newAxisMask:c,shrinkAxisMask:p};return r.BV.runKernel(i.jQk,d,h)}})},827:(e,t,n)=>{"use strict";n.d(t,{l:()=>s});var r=n(7097),i=n(9121),o=n(747),a=n(3740);const s=(0,n(2668).op)({sub_:function(e,t){let n=(0,a._1)(e,"a","sub"),s=(0,a._1)(t,"b","sub");[n,s]=(0,o.makeTypesMatch)(n,s);const u={a:n,b:s};return r.BV.runKernel(i.Tr8,u)}})},5475:(e,t,n)=>{"use strict";n.d(t,{S:()=>s});var r=n(7097),i=n(9121),o=n(3740),a=n(2271);const s=(0,n(2668).op)({sum_:function(e,t=null,n=!1){let s=(0,o._1)(e,"x","sum");"bool"===s.dtype&&(s=(0,a.p)(s,"int32"));const u={x:s},l={axis:t,keepDims:n};return r.BV.runKernel(i.GBy,u,l)}})},1173:(e,t,n)=>{"use strict";n.d(t,{O:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({tan_:function(e){const t={x:(0,o._1)(e,"x","tan","float32")};return r.BV.runKernel(i.sEM,t)}})},1869:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({tanh_:function(e){const t={x:(0,o._1)(e,"x","tanh","float32")};return r.BV.runKernel(i.MIZ,t)}})},701:(e,t,n)=>{"use strict";n.d(t,{X:()=>o});var r=n(3740),i=n(7852);function o(e,t,n){const o=(0,r.C)(e,n);return(0,i.H)(e,t,o,n)}},9906:(e,t,n)=>{"use strict";n.d(t,{w:()=>a});var r=n(3740),i=n(569),o=n(7852);function a(e,t,n){if((0,i.Cq)(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");const a=(0,r.C)(e,n);if(3!==a.length&&1!==a.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return(0,o.H)(e,t,a,n)}},7852:(e,t,n)=>{"use strict";n.d(t,{H:()=>s});var r=n(7097),i=n(1221),o=n(569),a=n(9122);function s(e,t,n,s){if(null==s)s=(0,o.D2)(e);else if("complex64"===s)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if((0,i.$F)(e)||(0,i.Oq)(e)){if("float32"!==s&&"int32"!==s)throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return r.BV.backend.createTensorFromGPUData(e,t||n,s)}if(!(0,a.isTypedArray)(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){(0,o.Mu)(t);const e=(0,o.NA)(t),r=(0,o.NA)(n);(0,o.hu)(e===r,(()=>`Based on the provided shape, [${t}], the tensor should have ${e} values but has ${r}`));for(let e=0;e<n.length;++e){const r=n[e],i=e!==n.length-1||r!==(0,o.NA)(t.slice(e));(0,o.hu)(n[e]===t[e]||!i,(()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `))}}return(0,a.isTypedArray)(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==s?(0,a.toTypedArray)(e,s):(0,a.flatten)(e,[],!0),r.BV.makeTensor(e,t,s)}},7501:(e,t,n)=>{"use strict";n.d(t,{G:()=>s});var r=n(7097),i=n(9121),o=n(3740),a=n(569);const s=(0,n(2668).op)({tile_:function(e,t){const n=(0,o._1)(e,"x","tile","string_or_numeric");a.hu(n.rank===t.length,(()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`));const s={x:n},u={reps:t};return r.BV.runKernel(i.n9L,s,u)}})},3243:(e,t,n)=>{"use strict";n.d(t,{h:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({topk_:function(e,t=1,n=!0){const a=(0,o._1)(e,"x","topk");if(0===a.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const s=a.shape[a.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${t}`);const u={x:a},l={k:t,sorted:n},[c,p]=r.BV.runKernel(i.cWu,u,l);return{values:c,indices:p}}})},9065:(e,t,n)=>{"use strict";n.d(t,{p:()=>h});var r=n(7097),i=n(4368),o=n(9121),a=n(3740),s=n(569),u=n(1661),l=n(4386),c=n(7370),p=n(2668),d=n(766);const h=(0,p.op)({transpose_:function(e,t,n){const p=(0,a._1)(e,"x","transpose");if(null==t&&(t=p.shape.map(((e,t)=>t)).reverse()),s.hu(p.rank===t.length,(()=>`Error in transpose: rank of input ${p.rank} must match length of perm ${t}.`)),t.forEach((e=>{s.hu(e>=0&&e<p.rank,(()=>"All entries in 'perm' must be between 0 and "+(p.rank-1)+` but got ${t}`))})),p.rank<=1)return p.clone();const h={x:p},f={perm:t};return"complex64"===p.dtype?(0,i.lu)((()=>{let e=(0,d.k)(p),t=(0,l.a)(p);return e=r.BV.runKernel(o.G3Y,{x:e},f),t=r.BV.runKernel(o.G3Y,{x:t},f),n&&(t=(0,c.W)(t)),(0,u.P)(e,t)})):r.BV.runKernel(o.G3Y,h,f)}})},9608:(e,t,n)=>{"use strict";n.d(t,{T:()=>s});var r=n(7097),i=n(9121),o=n(3740),a=n(569);const s=(0,n(2668).op)({unique_:function(e,t=0){const n=(0,o._1)(e,"x","unique","string_or_numeric");(0,a.hu)(n.rank>0,(()=>"The input tensor must be at least 1D"));const s={x:n},u={axis:t},[l,c]=r.BV.runKernel(i.kpP,s,u);return{values:l,indices:c}}})},8749:(e,t,n)=>{"use strict";n.d(t,{p:()=>s});var r=n(7097),i=n(9121),o=n(3740),a=n(569);const s=(0,n(2668).op)({unsortedSegmentSum_:function(e,t,n){const s=(0,o._1)(e,"x","unsortedSegmentSum"),u=(0,o._1)(t,"segmentIds","unsortedSegmentSum","int32");(0,a.hu)((0,a.GN)(n),(()=>"numSegments must be of dtype int"));const l={x:s,segmentIds:u},c={numSegments:n};return r.BV.runKernel(i.Qvg,l,c)}})},4136:(e,t,n)=>{"use strict";n.d(t,{H:()=>s});var r=n(7097),i=n(9121),o=n(3740),a=n(569);const s=(0,n(2668).op)({unstack_:function(e,t=0){const n=(0,o._1)(e,"x","unstack","string_or_numeric");a.hu(t>=-n.shape.length&&t<n.shape.length,(()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`));const s={value:n},u={axis:t};return r.BV.runKernel(i.ToN,s,u)}})},5912:(e,t,n)=>{"use strict";n.d(t,{a:()=>u});var r=n(7097),i=n(9121),o=n(3740),a=n(8247),s=n(2200);const u=(0,n(2668).op)({where_:function(e,t,n){const u=(0,o._1)(t,"a","where"),l=(0,o._1)(n,"b","where"),c=(0,o._1)(e,"condition","where","bool"),p=(0,s.assertAndGetBroadcastShape)((0,s.assertAndGetBroadcastShape)(c.shape,u.shape),l.shape),d={condition:(0,a.U)(c,p),t:(0,a.U)(u,p),e:(0,a.U)(l,p)};return r.BV.runKernel(i.PhF,d)}})},723:(e,t,n)=>{"use strict";n.d(t,{l:()=>a});var r=n(7097),i=n(569),o=n(1661);function a(e,t="float32"){if((0,i.Mu)(e),"complex64"===t){const t=a(e,"float32"),n=a(e,"float32");return(0,o.P)(t,n)}const n=(0,i.wT)((0,i.NA)(e),t);return r.BV.makeTensor(n,e,t)}},6577:(e,t,n)=>{"use strict";n.d(t,{P:()=>a});var r=n(7097),i=n(9121),o=n(3740);const a=(0,n(2668).op)({zerosLike_:function(e){const t={x:(0,o._1)(e,"x","zerosLike")};return r.BV.runKernel(i.RuY,t)}})},9742:(e,t,n)=>{"use strict";function r(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}n.d(t,{j:()=>r})},330:(e,t,n)=>{"use strict";n.r(t);var r=n(6235),i=n(4077);(0,i.t3)().prototype.abs=function(){return this.throwIfDisposed(),(0,r.W)(this)};var o=n(7839);(0,i.t3)().prototype.acos=function(){return this.throwIfDisposed(),(0,o.K)(this)};var a=n(1470);(0,i.t3)().prototype.acosh=function(){return this.throwIfDisposed(),(0,a._)(this)};var s=n(6407);(0,i.t3)().prototype.add=function(e){return this.throwIfDisposed(),(0,s.I)(this,e)};var u=n(781);(0,i.t3)().prototype.all=function(e,t){return this.throwIfDisposed(),(0,u.$)(this,e,t)};var l=n(2998);(0,i.t3)().prototype.any=function(e,t){return this.throwIfDisposed(),(0,l.Y)(this,e,t)};var c=n(47);(0,i.t3)().prototype.argMax=function(e){return this.throwIfDisposed(),(0,c.N)(this,e)};var p=n(7394);(0,i.t3)().prototype.argMin=function(e){return this.throwIfDisposed(),(0,p.v)(this,e)};var d=n(4968),h=n(569);(0,i.t3)().prototype.asScalar=function(){return this.throwIfDisposed(),(0,h.hu)(1===this.size,(()=>"The array must have only 1 element.")),(0,d.X)(this,[])};var f=n(2271);(0,i.t3)().prototype.asType=function(e){return this.throwIfDisposed(),(0,f.p)(this,e)},(0,i.t3)().prototype.as1D=function(){return this.throwIfDisposed(),(0,d.X)(this,[this.size])},(0,i.t3)().prototype.as2D=function(e,t){return this.throwIfDisposed(),(0,d.X)(this,[e,t])},(0,i.t3)().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),(0,d.X)(this,[e,t,n])},(0,i.t3)().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),(0,d.X)(this,[e,t,n,r])},(0,i.t3)().prototype.as5D=function(e,t,n,r,i){return this.throwIfDisposed(),(0,d.X)(this,[e,t,n,r,i])};var g=n(2421);(0,i.t3)().prototype.asin=function(){return this.throwIfDisposed(),(0,g.Z)(this)};var m=n(1891);(0,i.t3)().prototype.asinh=function(){return this.throwIfDisposed(),(0,m.V)(this)};var y=n(7037);(0,i.t3)().prototype.atan=function(){return this.throwIfDisposed(),(0,y.z)(this)};var b=n(9812);(0,i.t3)().prototype.atan2=function(e){return this.throwIfDisposed(),(0,b.f)(this,e)};var v=n(369);(0,i.t3)().prototype.atanh=function(){return this.throwIfDisposed(),(0,v.C)(this)};var x=n(5176);(0,i.t3)().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),(0,x.w)(this,e,t,n,r)};var _=n(8441);(0,i.t3)().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),(0,_.E)(this,e,t)};var w=n(7505);(0,i.t3)().prototype.batchNorm=function(e,t,n,r,i){return this.throwIfDisposed(),(0,w.t)(this,e,t,n,r,i)};var k=n(8247);(0,i.t3)().prototype.broadcastTo=function(e){return this.throwIfDisposed(),(0,k.U)(this,e)},(0,i.t3)().prototype.cast=function(e){return this.throwIfDisposed(),(0,f.p)(this,e)};var S=n(6825);(0,i.t3)().prototype.ceil=function(){return this.throwIfDisposed(),(0,S.m)(this)};var C=n(2279);(0,i.t3)().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),(0,C.i)(this,e,t)};var M=n(6884);(0,i.t3)().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof i.es&&(e=[e]),(0,M.z)([this,...e],t)};var T=n(1355);(0,i.t3)().prototype.conv1d=function(e,t,n,r,i,o){return this.throwIfDisposed(),(0,T.P)(this,e,t,n,r,i,o)};var E=n(1405);(0,i.t3)().prototype.conv2dTranspose=function(e,t,n,r,i){return this.throwIfDisposed(),(0,E.b)(this,e,t,n,r,i)};var A=n(4794);(0,i.t3)().prototype.conv2d=function(e,t,n,r,i,o){return this.throwIfDisposed(),(0,A.T)(this,e,t,n,r,i,o)};var F=n(173);(0,i.t3)().prototype.cos=function(){return this.throwIfDisposed(),(0,F.m)(this)};var O=n(2699);(0,i.t3)().prototype.cosh=function(){return this.throwIfDisposed(),(0,O.f)(this)};var R=n(9640);(0,i.t3)().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),(0,R.$)(this,e,t,n)};var N=n(7405);(0,i.t3)().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),(0,N.z)(this,e,t,n)};var D=n(9112);(0,i.t3)().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),(0,D.n)(this,e,t)};var I=n(4718);(0,i.t3)().prototype.depthwiseConv2d=function(e,t,n,r,i,o){return this.throwIfDisposed(),(0,I.B)(this,e,t,n,r,i,o)};var B=n(557);(0,i.t3)().prototype.dilation2d=function(e,t,n,r,i){return this.throwIfDisposed(),(0,B.W)(this,e,t,n,r,i)};var L=n(9322);(0,i.t3)().prototype.divNoNan=function(e){return this.throwIfDisposed(),(0,L.N)(this,e)};var P=n(1274);(0,i.t3)().prototype.div=function(e){return this.throwIfDisposed(),(0,P.h)(this,e)};var $=n(548);(0,i.t3)().prototype.dot=function(e){return this.throwIfDisposed(),(0,$.A)(this,e)};var z=n(3233);(0,i.t3)().prototype.elu=function(){return this.throwIfDisposed(),(0,z.p)(this)};var j=n(6477);(0,i.t3)().prototype.equal=function(e){return this.throwIfDisposed(),(0,j.D)(this,e)};var G=n(4650);(0,i.t3)().prototype.erf=function(){return this.throwIfDisposed(),(0,G.q)(this)};var U=n(1954);(0,i.t3)().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),(0,U.d)(this,e,t)};var W=n(4842);(0,i.t3)().prototype.exp=function(){return this.throwIfDisposed(),(0,W.Q)(this)};var V=n(1300);(0,i.t3)().prototype.expandDims=function(e){return this.throwIfDisposed(),(0,V.d)(this,e)};var H=n(3426);(0,i.t3)().prototype.expm1=function(){return this.throwIfDisposed(),(0,H.t)(this)};var q=n(7020);(0,i.t3)().prototype.fft=function(){return this.throwIfDisposed(),(0,q.k)(this)},(0,i.t3)().prototype.flatten=function(){return this.throwIfDisposed(),(0,d.X)(this,[this.size])};var X=n(6943);(0,i.t3)().prototype.floor=function(){return this.throwIfDisposed(),(0,X.G)(this)};var Y=n(9165);(0,i.t3)().prototype.floorDiv=function(e){return this.throwIfDisposed(),(0,Y.q)(this,e)};var K=n(4926);(0,i.t3)().prototype.gather=function(e,t,n){return this.throwIfDisposed(),(0,K.I)(this,e,t,n)};var J=n(7630);(0,i.t3)().prototype.greaterEqual=function(e){return this.throwIfDisposed(),(0,J.b)(this,e)};var Z=n(636);(0,i.t3)().prototype.greater=function(e){return this.throwIfDisposed(),(0,Z.p)(this,e)};var Q=n(8447);(0,i.t3)().prototype.ifft=function(){return this.throwIfDisposed(),(0,Q.S)(this)};var ee=n(4415);(0,i.t3)().prototype.irfft=function(){return this.throwIfDisposed(),(0,ee.w)(this)};var te=n(3963);(0,i.t3)().prototype.isFinite=function(){return this.throwIfDisposed(),(0,te.x)(this)};var ne=n(4365);(0,i.t3)().prototype.isInf=function(){return this.throwIfDisposed(),(0,ne.U)(this)};var re=n(6230);(0,i.t3)().prototype.isNaN=function(){return this.throwIfDisposed(),(0,re.i)(this)};var ie=n(9133);(0,i.t3)().prototype.leakyRelu=function(e){return this.throwIfDisposed(),(0,ie.h)(this,e)};var oe=n(624);(0,i.t3)().prototype.lessEqual=function(e){return this.throwIfDisposed(),(0,oe.z)(this,e)};var ae=n(6573);(0,i.t3)().prototype.less=function(e){return this.throwIfDisposed(),(0,ae.d)(this,e)};var se=n(9648);(0,i.t3)().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),(0,se.G)(this,e,t,n,r)};var ue=n(3888);(0,i.t3)().prototype.logSigmoid=function(){return this.throwIfDisposed(),(0,ue.e)(this)};var le=n(1510);(0,i.t3)().prototype.logSoftmax=function(e){return this.throwIfDisposed(),(0,le.C)(this,e)};var ce=n(1391);(0,i.t3)().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),(0,ce.l)(this,e,t)};var pe=n(2597);(0,i.t3)().prototype.log=function(){return this.throwIfDisposed(),(0,pe.c)(this)};var de=n(7474);(0,i.t3)().prototype.log1p=function(){return this.throwIfDisposed(),(0,de.K)(this)};var he=n(2856);(0,i.t3)().prototype.logicalAnd=function(e){return this.throwIfDisposed(),(0,he.H)(this,e)};var fe=n(8651);(0,i.t3)().prototype.logicalNot=function(){return this.throwIfDisposed(),(0,fe.h)(this)};var ge=n(5750);(0,i.t3)().prototype.logicalOr=function(e){return this.throwIfDisposed(),(0,ge.K)(this,e)};var me=n(596);(0,i.t3)().prototype.logicalXor=function(e){return this.throwIfDisposed(),(0,me.e)(this,e)};var ye=n(8687);(0,i.t3)().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),(0,ye.O)(this,e,t,n)};var be=n(1174);(0,i.t3)().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),(0,be._)(this,e,t,n,r)};var ve=n(3307);(0,i.t3)().prototype.max=function(e,t){return this.throwIfDisposed(),(0,ve.F)(this,e,t)};var xe=n(632);(0,i.t3)().prototype.maximum=function(e){return this.throwIfDisposed(),(0,xe.g)(this,e)};var _e=n(5130);(0,i.t3)().prototype.mean=function(e,t){return this.throwIfDisposed(),(0,_e.J)(this,e,t)};var we=n(5735);(0,i.t3)().prototype.min=function(e,t){return this.throwIfDisposed(),(0,we.V)(this,e,t)};var ke=n(4513);(0,i.t3)().prototype.minimum=function(e){return this.throwIfDisposed(),(0,ke.L)(this,e)};var Se=n(1483);(0,i.t3)().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),(0,Se.V)(this,e,t)};var Ce=n(5228);(0,i.t3)().prototype.mod=function(e){return this.throwIfDisposed(),(0,Ce.w)(this,e)};var Me=n(4841);(0,i.t3)().prototype.mul=function(e){return this.throwIfDisposed(),(0,Me.d)(this,e)};var Te=n(7370);(0,i.t3)().prototype.neg=function(){return this.throwIfDisposed(),(0,Te.W)(this)};var Ee=n(3561);(0,i.t3)().prototype.norm=function(e,t,n){return this.throwIfDisposed(),(0,Ee.K)(this,e,t,n)};var Ae=n(6500);(0,i.t3)().prototype.notEqual=function(e){return this.throwIfDisposed(),(0,Ae.Q)(this,e)};var Fe=n(6708);(0,i.t3)().prototype.oneHot=function(e,t=1,n=0){return this.throwIfDisposed(),(0,Fe.l)(this,e,t,n)};var Oe=n(7846);(0,i.t3)().prototype.onesLike=function(){return this.throwIfDisposed(),(0,Oe.J)(this)};var Re=n(9682);(0,i.t3)().prototype.pad=function(e,t){return this.throwIfDisposed(),(0,Re.v)(this,e,t)};var Ne=n(5860);(0,i.t3)().prototype.pool=function(e,t,n,r,i,o){return this.throwIfDisposed(),(0,Ne.d)(this,e,t,n,r,i,o)};var De=n(3453);(0,i.t3)().prototype.pow=function(e){return this.throwIfDisposed(),(0,De.s)(this,e)};var Ie=n(8151);(0,i.t3)().prototype.prelu=function(e){return this.throwIfDisposed(),(0,Ie.A)(this,e)};var Be=n(9451);(0,i.t3)().prototype.prod=function(e,t){return this.throwIfDisposed(),(0,Be.W)(this,e,t)};var Le=n(9036);(0,i.t3)().prototype.reciprocal=function(){return this.throwIfDisposed(),(0,Le.M)(this)};var Pe=n(7409);(0,i.t3)().prototype.relu=function(){return this.throwIfDisposed(),(0,Pe.U)(this)};var $e=n(3582);(0,i.t3)().prototype.relu6=function(){return this.throwIfDisposed(),(0,$e.b)(this)},(0,i.t3)().prototype.reshapeAs=function(e){return this.throwIfDisposed(),(0,d.X)(this,e.shape)},(0,i.t3)().prototype.reshape=function(e){return this.throwIfDisposed(),(0,d.X)(this,e)};var ze=n(3305);(0,i.t3)().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),(0,ze.I)(this,e,t,n)};var je=n(5098);(0,i.t3)().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),(0,je.j)(this,e,t,n)};var Ge=n(7486);(0,i.t3)().prototype.reverse=function(e){return this.throwIfDisposed(),(0,Ge.G)(this,e)};var Ue=n(3710);(0,i.t3)().prototype.rfft=function(){return this.throwIfDisposed(),(0,Ue.Q)(this)};var We=n(7809);(0,i.t3)().prototype.round=function(){return this.throwIfDisposed(),(0,We.N)(this)};var Ve=n(2634);(0,i.t3)().prototype.rsqrt=function(){return this.throwIfDisposed(),(0,Ve.b)(this)};var He=n(5503);(0,i.t3)().prototype.selu=function(){return this.throwIfDisposed(),(0,He.U)(this)};var qe=n(8678);(0,i.t3)().prototype.separableConv2d=function(e,t,n,r,i,o){return this.throwIfDisposed(),(0,qe.U)(this,e,t,n,r,i,o)};var Xe=n(625);(0,i.t3)().prototype.sigmoid=function(){return this.throwIfDisposed(),(0,Xe.X)(this)};var Ye=n(4434);(0,i.t3)().prototype.sign=function(){return this.throwIfDisposed(),(0,Ye.X)(this)};var Ke=n(9331);(0,i.t3)().prototype.sin=function(){return this.throwIfDisposed(),(0,Ke.O)(this)};var Je=n(3254);(0,i.t3)().prototype.sinh=function(){return this.throwIfDisposed(),(0,Je.R)(this)};var Ze=n(2676);(0,i.t3)().prototype.slice=function(e,t){return this.throwIfDisposed(),(0,Ze.t)(this,e,t)};var Qe=n(682);(0,i.t3)().prototype.softmax=function(e){return this.throwIfDisposed(),(0,Qe.X)(this,e)};var et=n(3694);(0,i.t3)().prototype.softplus=function(){return this.throwIfDisposed(),(0,et.W)(this)};var tt=n(7918);(0,i.t3)().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),(0,tt.f)(this,e,t)};var nt=n(8644);(0,i.t3)().prototype.split=function(e,t){return this.throwIfDisposed(),(0,nt.V)(this,e,t)};var rt=n(3261);(0,i.t3)().prototype.sqrt=function(){return this.throwIfDisposed(),(0,rt._)(this)};var it=n(248);(0,i.t3)().prototype.square=function(){return this.throwIfDisposed(),(0,it.h)(this)};var ot=n(5265);(0,i.t3)().prototype.squaredDifference=function(e){return this.throwIfDisposed(),(0,ot.$)(this,e)};var at=n(9590);(0,i.t3)().prototype.squeeze=function(e){return this.throwIfDisposed(),(0,at.L)(this,e)};var st=n(2991);(0,i.t3)().prototype.stack=function(e,t){this.throwIfDisposed();const n=e instanceof i.es?[this,e]:[this,...e];return(0,st.k)(n,t)};var ut=n(1901);(0,i.t3)().prototype.step=function(e){return this.throwIfDisposed(),(0,ut.N)(this,e)};var lt=n(5158);(0,i.t3)().prototype.stridedSlice=function(e,t,n,r,i,o,a,s){return this.throwIfDisposed(),(0,lt.N)(this,e,t,n,r,i,o,a,s)};var ct=n(827);(0,i.t3)().prototype.sub=function(e){return this.throwIfDisposed(),(0,ct.l)(this,e)};var pt=n(5475);(0,i.t3)().prototype.sum=function(e,t){return this.throwIfDisposed(),(0,pt.S)(this,e,t)};var dt=n(1173);(0,i.t3)().prototype.tan=function(){return this.throwIfDisposed(),(0,dt.O)(this)};var ht=n(1869);(0,i.t3)().prototype.tanh=function(){return this.throwIfDisposed(),(0,ht.A)(this)};var ft=n(7501);(0,i.t3)().prototype.tile=function(e){return this.throwIfDisposed(),(0,ft.G)(this,e)},(0,i.t3)().prototype.toBool=function(){return this.throwIfDisposed(),(0,f.p)(this,"bool")},(0,i.t3)().prototype.toFloat=function(){return this.throwIfDisposed(),(0,f.p)(this,"float32")},(0,i.t3)().prototype.toInt=function(){return this.throwIfDisposed(),(0,f.p)(this,"int32")};var gt=n(3243);(0,i.t3)().prototype.topk=function(e,t){return this.throwIfDisposed(),(0,gt.h)(this,e,t)};var mt=n(9065);(0,i.t3)().prototype.transpose=function(e){return this.throwIfDisposed(),(0,mt.p)(this,e)};var yt=n(9608);(0,i.t3)().prototype.unique=function(e){return this.throwIfDisposed(),(0,yt.T)(this,e)};var bt=n(8749);(0,i.t3)().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),(0,bt.p)(this,e,t)};var vt=n(4136);(0,i.t3)().prototype.unstack=function(e){return this.throwIfDisposed(),(0,vt.H)(this,e)};var xt=n(5912);(0,i.t3)().prototype.where=function(e,t){return this.throwIfDisposed(),(0,xt.a)(e,this,t)};var _t=n(6577);(0,i.t3)().prototype.zerosLike=function(){return this.throwIfDisposed(),(0,_t.P)(this)}},4077:(e,t,n)=>{"use strict";n.d(t,{es:()=>_,YD:()=>f,_w:()=>k,t3:()=>w,FZ:()=>x,Vp:()=>v,Vi:()=>b});var r=n(5938),i=n(569);const o=20,a=3,s=7;function u(e,t,n,r){const o=(0,i.e3)(t),a=function(e,t,n,r){const o=(0,i.NA)(t),a=r[r.length-1],s=new Array(a).fill(0),u=t.length,c="complex64"===n?d(e):e;if(u>1)for(let e=0;e<o/a;e++){const t=e*a;for(let e=0;e<a;e++)s[e]=Math.max(s[e],l(c[t+e],0,n).length)}return s}(e,t,n,o),s=t.length,u=p(e,t,n,o,a),c=["Tensor"];return r&&(c.push(`  dtype: ${n}`),c.push(`  rank: ${s}`),c.push(`  shape: [${t}]`),c.push("  values:")),c.push(u.map((e=>"    "+e)).join("\n")),c.join("\n")}function l(e,t,n){let r;return r=Array.isArray(e)?`${parseFloat(e[0].toFixed(s))} + ${parseFloat(e[1].toFixed(s))}j`:(0,i.HD)(e)?`'${e}'`:"bool"===n?c(e):parseFloat(e.toFixed(s)).toString(),(0,i.oj)(r,t)}function c(e){return 0===e?"false":"true"}function p(e,t,n,r,i,s=!0){const u="complex64"===n?2:1,h=t[0],f=t.length;if(0===f)return"complex64"===n?[l(d(e)[0],0,n)]:"bool"===n?[c(e[0])]:[e[0].toString()];if(1===f){if(h>o){const t=a*u;let r=Array.from(e.slice(0,t)),o=Array.from(e.slice((h-a)*u,h*u));return"complex64"===n&&(r=d(r),o=d(o)),["["+r.map(((e,t)=>l(e,i[t],n))).join(", ")+", ..., "+o.map(((e,t)=>l(e,i[h-a+t],n))).join(", ")+"]"]}return["["+("complex64"===n?d(e):Array.from(e)).map(((e,t)=>l(e,i[t],n))).join(", ")+"]"]}const g=t.slice(1),m=r.slice(1),y=r[0]*u,b=[];if(h>o){for(let t=0;t<a;t++){const r=t*y,o=r+y;b.push(...p(e.slice(r,o),g,n,m,i,!1))}b.push("...");for(let t=h-a;t<h;t++){const r=t*y,o=r+y;b.push(...p(e.slice(r,o),g,n,m,i,t===h-1))}}else for(let t=0;t<h;t++){const r=t*y,o=r+y;b.push(...p(e.slice(r,o),g,n,m,i,t===h-1))}const v=2===f?",":"";b[0]="["+(h>0?b[0]+v:"");for(let e=1;e<b.length-1;e++)b[e]=" "+b[e]+v;let x=",\n";for(let e=2;e<f;e++)x+="\n";return b[b.length-1]=" "+b[b.length-1]+"]"+(s?"":x),b}function d(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var h=n(9122);class f{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=i.NA(e),null!=n){const e=n.length;i.hu(e===this.size,(()=>`Length of values '${e}' does not match the size inferred by the shape '${this.size}'.`))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||i.rQ(t,this.size),this.strides=(0,i.e3)(e)}set(e,...t){0===t.length&&(t=[0]),i.hu(t.length===this.rank,(()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`));const n=this.locToIndex(t);this.values[n]=e}get(...e){0===e.length&&(e=[0]);let t=0;for(const n of e){if(n<0||n>=this.shape[t]){const t=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(t)}t++}let n=e[e.length-1];for(let t=0;t<e.length-1;++t)n+=this.strides[t]*e[t];return this.values[n]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];const t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return g().makeTensor(this.values,this.shape,this.dtype)}}let g=null,m=null,y=null;function b(e){g=e}function v(e){m=e}function x(e){y=e}class _{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=i.NA(e),this.strides=(0,i.e3)(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return m.buffer(this.shape,this.dtype,e)}bufferSync(){return m.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return(0,i.GX)(this.shape,e,"complex64"===this.dtype)}arraySync(){return(0,i.GX)(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const e=g().read(this.dataId);if("string"===this.dtype){const t=await e;try{return t.map((e=>h.decodeString(e)))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),g().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=g().readSync(this.dataId);if("string"===this.dtype)try{return e.map((e=>h.decodeString(e)))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await g().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(g().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return m.print(this,e)}clone(){return this.throwIfDisposed(),m.clone(this)}toString(e=!1){return u(this.dataSync(),this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),m.cast(this,e)}variable(e=!0,t,n){return this.throwIfDisposed(),g().makeVariable(this,e,t,n)}}function w(){return(0,r.R)("Tensor",(()=>_))}Object.defineProperty(_,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),w();class k extends _{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!i.cO(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);g().disposeTensor(this),this.dataId=e.dataId,g().incRef(this,null)}dispose(){g().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(k,Symbol.hasInstance,{value:e=>e instanceof _&&null!=e.assign&&e.assign instanceof Function})},747:(e,t,n)=>{"use strict";n.r(t),n.d(t,{assertTypesMatch:()=>s,getTensorsInContainer:()=>l,isTensorInList:()=>u,makeTypesMatch:()=>a});var r=n(4077),i=n(1221),o=n(569);function a(e,t){if(e.dtype===t.dtype)return[e,t];const n=(0,i.x8)(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function s(e,t){(0,o.hu)(e.dtype===t.dtype,(()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`))}function u(e,t){return t.some((t=>t.id===e.id))}function l(e){const t=[];return c(e,t,new Set),t}function c(e,t,n){if(null==e)return;if(e instanceof r.es)return void t.push(e);if(i=e,!Array.isArray(i)&&"object"!=typeof i)return;var i;const o=e;for(const e in o){const r=o[e];n.has(r)||(n.add(r),c(r,t,n))}}},3740:(e,t,n)=>{"use strict";n.d(t,{C:()=>l,_1:()=>d,sI:()=>h});var r=n(7097),i=n(2885),o=n(4077),a=n(1221),s=n(9122),u=n(569);function l(e,t){let n=e;if((0,s.isTypedArray)(e))return"string"===t?[]:[e.length];if((0,a.Oq)(e)){const t=e.channels||"RGBA";return[e.height,e.width*t.length]}if((0,a.$F)(e))return[e.buffer.size/(null==t?4:(0,u.bT)(t))];if(!Array.isArray(e))return[];const r=[];for(;Array.isArray(n)||(0,s.isTypedArray)(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&(0,i.OB)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&c(e,r,[]),r}function c(e,t,n){if(n=n||[],!Array.isArray(e)&&!(0,s.isTypedArray)(e))return void(0,u.hu)(0===t.length,(()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`));(0,u.hu)(t.length>0,(()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`)),(0,u.hu)(e.length===t[0],(()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`));const r=t.slice(1);for(let t=0;t<e.length;++t)c(e[t],r,n.concat(t))}function p(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function d(e,t,n,i="numeric"){if(e instanceof o.es)return p(i,e.dtype,t,n),e;let a=(0,u.D2)(e);if("string"!==a&&["bool","int32","float32"].indexOf(i)>=0&&(a=i),p(i,a,t,n),null==e||!(0,s.isTypedArray)(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){const r=null==e?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${r}'`)}const c=l(e,a);(0,s.isTypedArray)(e)||Array.isArray(e)||(e=[e]);const d="string"!==a?(0,s.toTypedArray)(e,a):(0,s.flatten)(e,[],!0);return r.BV.makeTensor(d,c,a)}function h(e,t,n,r="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map(((e,i)=>d(e,`${t}[${i}]`,n,r)))}},1221:(e,t,n)=>{"use strict";var r,i,o,a,s;n.d(t,{$F:()=>d,Oq:()=>p,x8:()=>l,yw:()=>r,z4:()=>c}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(r||(r={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(i||(i={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(o||(o={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(a||(a={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(s||(s={}));const u={float32:a,int32:i,bool:o,complex64:s};function l(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return u[e][t]}function c(e){return l(e,"int32")}function p(e){return null!=e&&"object"==typeof e&&"texture"in e&&e.texture instanceof WebGLTexture}function d(e){return"undefined"!=typeof GPUBuffer&&null!=e&&"object"==typeof e&&"buffer"in e&&e.buffer instanceof GPUBuffer}},9122:(e,t,n)=>{"use strict";n.r(t),n.d(t,{arraysEqual:()=>o.cO,arraysEqualWithNull:()=>o.DK,assert:()=>o.hu,assertNonNegativeIntegerDimensions:()=>o.Mu,assertNonNull:()=>o.Cq,assertShapesMatch:()=>o.k5,bytesFromStringArray:()=>o.Ub,bytesPerElement:()=>o.bT,checkConversionForErrors:()=>o.D5,clamp:()=>o.uZ,computeStrides:()=>o.e3,convertBackendValuesAndArrayBuffer:()=>o.KS,createScalarValue:()=>x,createShuffledIndices:()=>o.U$,decodeString:()=>C,distSquared:()=>o.E7,encodeString:()=>S,fetch:()=>k,fingerPrint64:()=>v,flatten:()=>T,getArrayFromDType:()=>o.rQ,getTypedArrayFromDType:()=>o.WP,hasEncodingLoss:()=>o.QB,hexToLong:()=>u,indexToLoc:()=>o.NE,inferDtype:()=>o.D2,inferFromImplicitShape:()=>o.JZ,isBoolean:()=>o.jn,isFunction:()=>o.mf,isInt:()=>o.GN,isNumber:()=>o.hj,isPromise:()=>o.tI,isScalarShape:()=>o.xH,isString:()=>o.HD,isTypedArray:()=>M,isValidDtype:()=>o.LP,locToIndex:()=>o.qy,makeOnesTypedArray:()=>o.p8,makeZerosNestedTypedArray:()=>o.l6,makeZerosTypedArray:()=>o.wT,nearestDivisor:()=>o.jP,nearestLargerEven:()=>o.nY,now:()=>w,parseAxisParam:()=>o.EC,randUniform:()=>o.bj,repeatedTry:()=>o.WD,rightPad:()=>o.oj,shuffle:()=>o.TV,shuffleCombo:()=>o.d7,sizeFromShape:()=>o.NA,sizeToSquarishShape:()=>o.YP,squeezeShape:()=>o.bp,sum:()=>o.Sm,swap:()=>o.LF,tanh:()=>o.AE,toNestedArray:()=>o.GX,toTypedArray:()=>_});var r=n(2885),i=n(9742),o=n(569),a=n(3720);const s=n.n(a)()||a;function u(e){return s.fromString(e,!0,16)}const l=u("c3a5c85c97cb3127"),c=u("b492b66fbe98f273"),p=u("9ae16a3b2f90404f");function d(e){return e.xor(e.shru(47))}function h(e,t,n){const r=e.slice(t,t+n);return s.fromBytes(Array.from(r),!0,!0)}function f(e,t){return h(e,t,8)}function g(e,t){return h(e,t,4)}function m(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function y(e,t,n=u("9ddfea08eb382d69")){let r=e.xor(t).mul(n);r=r.xor(r.shru(47));let i=t.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function b(e,t,n,r){return function(e,t,n,r,i,o){i=i.add(e),o=m(o.add(i).add(r),21);const a=i;return i=(i=i.add(t)).add(n),o=o.add(m(i,44)),[i.add(r),o.add(a)]}(f(e,t),f(e,t+8),f(e,t+16),f(e,t+24),n,r)}function v(e,t=e.length){const n=s.fromNumber(81,!0);if(t<=32)return t<=16?function(e,t=e.length){if(t>=8){const n=p.add(2*t),r=f(e,0).add(p),i=f(e,t-8);return y(m(i,37).mul(n).add(r),m(r,25).add(i).mul(n),n)}if(t>=4){const n=p.add(2*t);return y(g(e,0).shl(3).add(t),g(e,t-4),n)}if(t>0){const n=e[0]+(e[t>>1]<<8),r=t+(e[t-1]<<2);return d(p.mul(n).xor(l.mul(r))).mul(p)}return p}(e,t):function(e,t=e.length){const n=p.add(2*t),r=f(e,0).mul(c),i=f(e,8),o=f(e,t-8).mul(n),a=f(e,t-16).mul(p);return y(m(r.add(i),43).add(m(o,30)).add(a),r.add(m(i.add(p),18)).add(o),n)}(e,t);if(t<=64)return function(e,t=e.length){const n=p.add(2*t),r=f(e,0).mul(p),i=f(e,8),o=f(e,t-8).mul(n),a=f(e,t-16).mul(p),s=m(r.add(i),43).add(m(o,30)).add(a),u=y(s,r.add(m(i.add(p),18)).add(o),n),l=f(e,16).mul(n),c=f(e,24),d=s.add(f(e,t-32)).mul(n),h=u.add(f(e,t-24)).mul(n);return y(m(l.add(c),43).add(m(d,30)).add(h),l.add(m(c.add(r),18)).add(d),n)}(e,t);let r=n,i=n.mul(c).add(113),o=d(i.mul(p).add(113)).mul(p),a=[s.UZERO,s.UZERO],u=[s.UZERO,s.UZERO];r=r.mul(p).add(f(e,0));let h=0;const v=64*(t-1>>6),x=v+(t-1&63)-63;do{r=m(r.add(i).add(a[0]).add(f(e,h+8)),37).mul(c),i=m(i.add(a[1]).add(f(e,h+48)),42).mul(c),r=r.xor(u[1]),i=i.add(a[0]).add(f(e,h+40)),o=m(o.add(u[0]),33).mul(c),a=b(e,h,a[1].mul(c),r.add(u[0])),u=b(e,h+32,o.add(u[1]),i.add(f(e,h+16))),[o,r]=[r,o],h+=64}while(h!==v);const _=c.add(o.and(255).shl(1));return h=x,u[0]=u[0].add(t-1&63),a[0]=a[0].add(u[0]),u[0]=u[0].add(a[0]),r=m(r.add(i).add(a[0]).add(f(e,h+8)),37).mul(_),i=m(i.add(a[1]).add(f(e,h+48)),42).mul(_),r=r.xor(u[1].mul(9)),i=i.add(a[0].mul(9).add(f(e,h+40))),o=m(o.add(u[0]),33).mul(_),a=b(e,h,a[1].mul(_),r.add(u[0])),u=b(e,h+32,o.add(u[1]),i.add(f(e,h+16))),[o,r]=[r,o],y(y(a[0],u[0],_).add(d(i).mul(l)).add(o),y(a[1],u[1],_).add(r),_)}function x(e,t){return"string"===t?S(e):_([e],t)}function _(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=T(e)),(0,r.OB)().getBool("DEBUG")&&o.D5(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){const t=new Uint8Array(e.length);for(let n=0;n<t.length;++n)0!==Math.round(e[n])&&(t[n]=1);return t}throw new Error(`Unknown data type ${t}`)}function w(){return(0,r.OB)().platform.now()}function k(e,t){return(0,r.OB)().platform.fetch(e,t)}function S(e,t="utf-8"){return t=t||"utf-8",(0,r.OB)().platform.encode(e,t)}function C(e,t="utf-8"){return t=t||"utf-8",(0,r.OB)().platform.decode(e,t)}function M(e){return null!=(0,r.OB)().platform.isTypedArray?(0,r.OB)().platform.isTypedArray(e):(0,i.j)(e)}function T(e,t=[],n=!1){if(null==t&&(t=[]),"boolean"==typeof e||"number"==typeof e||"string"==typeof e||o.tI(e)||null==e||M(e)&&n)t.push(e);else if(Array.isArray(e)||M(e))for(let r=0;r<e.length;++r)T(e[r],t,n);else{let r=-1;for(const t of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(t)&&(r=Math.max(r,Number(t)));for(let i=0;i<=r;i++)T(e[i],t,n)}return t}},569:(e,t,n)=>{"use strict";function r(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,s(e,t,n)}function i(e,t){if(e.length!==t.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${e.length}Second array length was ${t.length}`);let n=e.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,s(e,n,r),s(t,n,r)}function o(e,t,n){return Math.max(e,Math.min(t,n))}function a(e){return e%2==0?e:e+1}function s(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function u(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function l(e,t){const n=Math.random();return t*n+(1-n)*e}function c(e,t){let n=0;for(let r=0;r<e.length;r++){const i=Number(e[r])-Number(t[r]);n+=i*i}return n}function p(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function d(e,t,n=""){p(y(e,t),(()=>n+` Shapes ${e} and ${t} must match`))}function h(e){p(null!=e,(()=>"The input to the tensor constructor must be a non-null value."))}function f(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function g(e){return 0===e.length}function m(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(null!==e[n]&&null!==t[n]&&e[n]!==t[n])return!1;return!0}function y(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function b(e){return e%1==0}function v(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;{const t=Math.exp(2*e);return(t-1)/(t+1)}}function x(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function _(e){const t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return r(t),t}function w(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function k(e,t=(e=>0),n,r){return new Promise(((i,o)=>{let a=0;const s=()=>{if(e())return void i();a++;const u=t(a);null!=n&&a>=n?o():null!=r?r(s,u):setTimeout(s,u)};s()}))}function S(e,t){let n=1,r=-1;for(let t=0;t<e.length;++t)if(e[t]>=0)n*=e[t];else if(-1===e[t]){if(-1!==r)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${t}`);r=t}else if(e[t]<0)throw Error(`Shapes can not be < 0. Found ${e[t]} at dim ${t}`);if(-1===r){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(0===n)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!=0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const i=e.slice();return i[r]=t/n,i}function C(e,t){const n=t.length;return p((e=null==e?t.map(((e,t)=>t)):[].concat(e)).every((e=>e>=-n&&e<n)),(()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`)),p(e.every((e=>b(e))),(()=>`All values in axis param must be integers but got axis ${e}`)),e.map((e=>e<0?n+e:e))}function M(e,t){const n=[],r=[],i=null!=t&&Array.isArray(t)&&0===t.length,o=null==t||i?null:C(t,e).sort();let a=0;for(let t=0;t<e.length;++t){if(null!=o){if(o[a]===t&&1!==e[t])throw new Error(`Can't squeeze axis ${t} since its dim '${e[t]}' is not 1`);(null==o[a]||o[a]>t)&&1===e[t]&&(n.push(e[t]),r.push(t)),o[a]<=t&&a++}1!==e[t]&&(n.push(e[t]),r.push(t))}return{newShape:n,keptDims:r}}function T(e,t){return E(e,t)}function E(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error(`Unknown data type ${e}`);n=new Array(t)}return n}function A(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}function F(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function O(e,t){return!("complex64"===t||"float32"===t&&"complex64"!==e||"int32"===t&&"float32"!==e&&"complex64"!==e||"bool"===t&&"bool"===e)}function R(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error(`Unknown dtype ${e}`)}function N(e){if(null==e)return 0;let t=0;return e.forEach((e=>t+=e.length)),t}function D(e){return"string"==typeof e||e instanceof String}function I(e){return"boolean"==typeof e}function B(e){return"number"==typeof e}function L(e){return Array.isArray(e)?L(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":B(e)?"float32":D(e)?"string":I(e)?"bool":"float32"}function P(e){return!!(e&&e.constructor&&e.call&&e.apply)}function $(e,t){for(let n=t;n<e;++n)if(e%n==0)return n;return e}function z(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function j(e,t,n,r=!1){const i=new Array;if(1===t.length){const o=t[0]*(r?2:1);for(let t=0;t<o;t++)i[t]=n[e+t]}else{const o=t[0],a=t.slice(1),s=a.reduce(((e,t)=>e*t))*(r?2:1);for(let t=0;t<o;t++)i[t]=j(e+t*s,a,n,r)}return i}function G(e,t,n=!1){if(0===e.length)return t[0];const r=e.reduce(((e,t)=>e*t))*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return j(0,e,t,n)}function U(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}function W(e,t){const n=V(e,t);for(let e=0;e<n.length;e++)n[e]=1;return n}function V(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function H(e,t){const n=e.reduce(((e,t)=>e*t),1);if(null==t||"float32"===t)return G(e,new Float32Array(n));if("int32"===t)return G(e,new Int32Array(n));if("bool"===t)return G(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function q(e){e.forEach((t=>{p(Number.isInteger(t)&&t>=0,(()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`))}))}function X(e,t,n){if(0===t)return 0;if(1===t)return e[0];let r=e[e.length-1];for(let t=0;t<e.length-1;++t)r+=n[t]*e[t];return r}function Y(e,t,n){if(0===t)return[];if(1===t)return[e];const r=new Array(t);for(let t=0;t<r.length-1;++t)r[t]=Math.floor(e/n[t]),e-=r[t]*n[t];return r[r.length-1]=e,r}function K(e){return e&&e.then&&"function"==typeof e.then}n.d(t,{AE:()=>v,Cq:()=>h,D2:()=>L,D5:()=>A,DK:()=>m,E7:()=>c,EC:()=>C,GN:()=>b,GX:()=>G,HD:()=>D,JZ:()=>S,KS:()=>U,LF:()=>s,LP:()=>F,Mu:()=>q,NA:()=>f,NE:()=>Y,QB:()=>O,Sm:()=>u,TV:()=>r,U$:()=>_,Ub:()=>N,WD:()=>k,WP:()=>T,YP:()=>x,bT:()=>R,bj:()=>l,bp:()=>M,cO:()=>y,d7:()=>i,e3:()=>z,hj:()=>B,hu:()=>p,jP:()=>$,jn:()=>I,k5:()=>d,l6:()=>H,mf:()=>P,nY:()=>a,oj:()=>w,p8:()=>W,qy:()=>X,rQ:()=>E,tI:()=>K,uZ:()=>o,wT:()=>V,xH:()=>g})},2342:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(9674),i=n(6113);class o extends r.Component{componentDidMount(){const{name:e,tab:t}=this.props;this.props.registerSurface(e,t,this)}componentDidUpdate(){return!1}render(){const{name:e,visible:t,styles:n}=this.props,a=Object.assign({},o.defaultStyles,n),{width:s,height:u}=a;let{maxHeight:l,maxWidth:c}=a;l=u===o.defaultStyles.height?l:u,c=s===o.defaultStyles.width?c:s;const p=i.css({display:t?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:u,width:s,maxHeight:l,maxWidth:c,overflow:"auto"}),d=i.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),h=i.css({boxSizing:"border-box"});return r.h("div",{className:`${p} tf-surface`,ref:e=>this.container=e,"data-visible":t},r.h("div",{className:`${d} tf-label`,ref:e=>this.label=e},e),r.h("div",{className:`${h} tf-draw-area`,ref:e=>this.drawArea=e}))}}o.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},t.SurfaceComponent=o},2587:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(9674),i=n(6113);class o extends r.Component{render(){const{tabNames:e,activeTab:t,handleClick:n}=this.props,o=e.length>0?e.map((e=>r.h(a,{key:e,id:e,handleClick:n,isActive:e===t},e))):null,s=i.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return r.h("div",{className:`${s} visor-tabs`},o)}}t.Tabs=o;class a extends r.Component{render(){const{children:e,isActive:t,handleClick:n,id:o}=this.props,a=i.css({borderBottomColor:t?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return r.h("a",{className:`${a} tf-tab`,"data-isactive":t,onClick:()=>n(o)},e)}}},8087:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(9674),i=n(6113),o=n(2342),a=n(2587);class s extends r.Component{static render(e,t,n){return r.render(r.h(s,Object.assign({},n)),e,t)}constructor(e){super(e),this.surfaces=new Map;const t=null==e.startOpen||e.startOpen;this.state={isOpen:t,isFullscreen:!1,activeTab:null,tabs:new Set},this.keyHandler=this.keyHandler.bind(this)}close(){this.setState({isOpen:!1})}open(){this.setState({isOpen:!0})}toggle(){this.setState({isOpen:!this.state.isOpen})}toggleFullScreen(){this.setState({isFullscreen:!this.state.isFullscreen})}isOpen(){return this.state.isOpen}isFullscreen(){return this.state.isFullscreen}getSurface(e,t){const n=this.surfaceId(e,t);let r;if(!this.surfaces.has(n))throw Error(`Surface not found with id: ${n}`);return r=this.surfaces.get(n),{container:r.container,label:r.label,drawArea:r.drawArea}}bindKeys(){document.addEventListener("keydown",this.keyHandler,!1)}unbindKeys(){document.removeEventListener("keydown",this.keyHandler)}surfaceId(e,t){return e+t}setTabs(e){const t=e.map((e=>e.tab)),n=this.state.tabs;let r;for(const e of t)n.has(e)||(n.add(e),r=e);null!=r&&this.setState({tabs:n,activeTab:r})}getTabs(){return this.state.tabs}registerSurface(e,t,n){const r=this.surfaceId(e,t);this.surfaces.set(r,n)}keyHandler(e){192===e.keyCode&&(e.shiftKey?this.toggleFullScreen():this.toggle())}setActiveTab(e){this.setState({activeTab:e})}componentDidMount(){this.bindKeys()}componentWillMount(){this.setTabs(this.props.surfaceList)}componentWillReceiveProps(e){this.setTabs(e.surfaceList)}render(){const{isOpen:e,isFullscreen:t,activeTab:n}=this.state,{surfaceList:s}=this.props,l=Array.from(this.getTabs().values()),c=t?"90vw":"550px",p=i.css({width:c,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),d=i.css({right:"0"}),h=i.css({right:`calc(-${c} - 10px)`}),f=e?d:h,g=i.css({});return r.h("div",{className:`${p} ${f} visor`,"data-isopen":e,"data-isfullscreen":t},r.h(u,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:t}),r.h(a.Tabs,{tabNames:l,activeTab:n,handleClick:this.setActiveTab.bind(this)}),r.h("div",{className:`${g} visor-surfaces`},s.map((e=>r.h(o.SurfaceComponent,{key:e.name+e.tab,name:e.name,tab:e.tab,styles:e.styles,registerSurface:this.registerSurface.bind(this),visible:n===e.tab})))))}}function u(e){const{isFullScreen:t,fullScreenHandler:n,closeHandler:o}=e,a=i.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),s=i.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),u=i.css({marginLeft:"auto"});return r.h("div",{className:`${a} visor-controls`},r.h("button",{className:`${s}`,onClick:n},t?"Minimize":"Maximize"),r.h("button",{className:`${s} ${u}`,onClick:o},"Hide"))}t.VisorComponent=s},8810:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(9882),n(330);const r=n(4337),i=n(7412),o=n(8208),a=n(1825),s=n(485),u=n(3683),l=n(707),c=n(9962),p=n(1267),d=n(8685),h=n(3674),f=n(7450),g=n(8422);t.version_vis=g.version;const m={barchart:r.barchart,table:l.table,histogram:a.histogram,linechart:s.linechart,scatterplot:u.scatterplot,confusionMatrix:i.confusionMatrix,heatmap:o.heatmap};t.render=m;const y={accuracy:f.accuracy,perClassAccuracy:f.perClassAccuracy,confusionMatrix:f.confusionMatrix};t.metrics=y;const b={history:c.history,fitCallbacks:c.fitCallbacks,perClassAccuracy:d.perClassAccuracy,valuesDistribution:h.valuesDistribution,layer:p.layer,modelSummary:p.modelSummary};t.show=b;var v=n(4326);t.visor=v.visor,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(7511))},4337:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(7887)),a=n(3152),s=n(334);t.barchart=function(e,t,n={}){return r(this,void 0,void 0,(function*(){const r=s.getDrawArea(e),i=t,c=Object.assign({},u,n);if(l.has(r)){const e=l.get(r);if(s.shallowEquals(c,e.lastOptions)){yield s.nextFrame();const t=e.view,n=t.changeset().remove((()=>!0)).insert(i);return void(yield t.change("values",n).runAsync())}}const{xLabel:p,yLabel:d,xType:h,yType:f}=c;let g=null;null!=p&&(g={title:p});let m,y=null;null!=d&&(y={title:d}),m=null!=c.color?Array.isArray(c.color)?{field:"index",type:"nominal",scale:{range:c.color}}:{value:c.color}:{value:"#4C78A0"};const b={width:c.width||a.getDefaultWidth(r),height:c.height||a.getDefaultHeight(r),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:c.fontSize,titleFontSize:c.fontSize},text:{fontSize:c.fontSize},legend:{labelFontSize:c.fontSize,titleFontSize:c.fontSize}},data:{values:i,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:h,axis:g},y:{field:"value",type:f,axis:y},color:m}};yield s.nextFrame();const v=yield o.default(r,b,{actions:!1,mode:"vega-lite",defaultStyle:!1});l.set(r,{view:v.view,lastOptions:c})}))};const u={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},l=new Map},7412:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(7887)),a=n(3152),s=n(334);t.confusionMatrix=function(e,t,n={}){return r(this,void 0,void 0,(function*(){const r=Object.assign({},u,n),i=s.getDrawArea(e),l=[],c=t.values,p=t.tickLabels||[],d=0===p.length;let h=!0;for(let e=0;e<c.length;e++){const t=d?`Class ${e}`:p[e];d&&p.push(t);for(let n=0;n<c[e].length;n++){const i=d?`Class ${n}`:p[n],o=c[e][n];e!==n||r.shadeDiagonal?(l.push({label:t,prediction:i,count:o,scaleCount:o}),0!==o&&(h=!1)):l.push({label:t,prediction:i,count:o,noFill:!0})}}if(!r.shadeDiagonal&&h)for(const e of l)!0===e.noFill&&(e.noFill=!1,e.scaleCount=e.count);const f={width:r.width||a.getDefaultWidth(i),height:r.height||a.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize}},data:{values:l},encoding:{x:{field:"prediction",type:"ordinal",title:r.xLabel||"prediction",scale:{domain:p}},y:{field:"label",type:"ordinal",title:r.yLabel||"label",scale:{domain:p}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:r.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]};!1===r.shadeDiagonal&&f.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),r.showTextOverlay&&f.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}});const g="string"==typeof r.colorMap?{scheme:r.colorMap}:r.colorMap;f.layer[0].encoding.color.scale.range=g,yield o.default(i,f,{actions:!1,mode:"vega-lite",defaultStyle:!1})}))};const u={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]}},8208:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(n(9882)),s=o(n(7887)),u=n(3152),l=n(3538),c=n(334);function p(e,t,n){const r=e instanceof a.Tensor?e.shape:[e.length,e[0].length];0===n?l.assert(r[0]===t.length,`Length of xTickLabels (${t.length}) must match number of rows (${r[0]})`):1===n&&l.assert(r[1]===t.length,`Length of yTickLabels (${t.length}) must match number of columns (${r[1]})`)}t.heatmap=function(e,t,n={}){return r(this,void 0,void 0,(function*(){const i=Object.assign({},d,n),o=c.getDrawArea(e);let h=t.values;i.rowMajor&&(h=yield function(e){return r(this,void 0,void 0,(function*(){let t,n;e instanceof a.Tensor?(t=e.shape,n=e.transpose()):(t=[e.length,e[0].length],n=a.tidy((()=>a.tensor2d(e).transpose()))),l.assert(2===n.rank,"Input to renderHeatmap must be a 2d array or Tensor2d");const r=yield n.array();n.dispose();const i=[r.length,r[0].length];return l.assert(t[0]===i[1]&&t[1]===i[0],`Unexpected transposed shape. Original ${t} : Transposed ${i}`),r}))}(t.values));const{xTickLabels:f,yTickLabels:g}=t;null!=f&&p(h,f,0),null!=g&&p(h,g,1);const m="@tfidx@",y=[];if(h instanceof a.Tensor){l.assert(2===h.rank,"Input to renderHeatmap must be a 2d array or Tensor2d");const e=yield h.data(),[t,n]=h.shape;for(let r=0;r<t;r++){const t=f?`${f[r]}${m}${r}`:r;for(let i=0;i<n;i++){const o=g?`${g[i]}${m}${i}`:i,a=e[r*n+i];y.push({x:t,y:o,value:a})}}}else{const e=h;for(let t=0;t<e.length;t++){const n=f?`${f[t]}${m}${t}`:t;for(let r=0;r<e[t].length;r++){const i=g?`${g[r]}${m}${r}`:r,o=e[t][r];y.push({x:n,y:i,value:o})}}}const b={actions:!1,mode:"vega-lite",defaultStyle:!1},v={width:i.width||u.getDefaultWidth(o),height:i.height||u.getDefaultHeight(o),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:y},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:i.xType,title:i.xLabel,sort:!1},y:{field:"y",type:i.yType,title:i.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},x=`${m}\\d+$`,_=new RegExp(x);let w;switch(f&&(v.encoding.x.axis={labelExpr:`replace(datum.value, regexp(/${x}/), '')`}),g&&(v.encoding.y.axis={labelExpr:`replace(datum.value, regexp(/${x}/), '')`}),(f||g)&&(b.tooltip={sanitize:e=>String(e).replace(_,"")}),i.colorMap){case"blues":w=["#f7fbff","#4292c6"];break;case"greyscale":w=["#000000","#ffffff"];break;default:w="viridis"}if("viridis"!==w&&(v.encoding.fill.scale={range:w}),i.domain){const e=v.encoding.fill;null!=e.scale?e.scale=Object.assign({},e.scale,{domain:i.domain}):e.scale={domain:i.domain}}yield s.default(o,v,b)}))};const d={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1}},1825:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(3369),a=i(n(7887)),s=n(3152),u=n(7450),l=n(707),c={maxBins:12,fontSize:11};t.histogram=function(e,t,n={}){return r(this,void 0,void 0,(function*(){const r=function(e){if(null==e.length)throw new Error("input data must be an array");if(0===e.length)return[];if("object"==typeof e[0]){if(null==e[0].value)throw new Error("input data must have a value field");return e}{const t=Array(e.length);for(let n=0;n<e.length;n++)t[n]={value:e[n]};return t}}(t),i=Object.assign({},c,n),p=s.subSurface(e,"histogram");if(!1!==n.stats){const t=s.subSurface(e,"stats",{prepend:!0});let a;a=n.stats?n.stats:u.arrayStats(r.map((e=>e.value))),function(e,t,n){const r=o.format(",.4~f"),i=o.format(".4~p"),a=[],s=[];if(null!=e.numVals&&(a.push("Num Vals"),s.push(r(e.numVals))),null!=e.min&&(a.push("Min"),s.push(r(e.min))),null!=e.max&&(a.push("Max"),s.push(r(e.max))),null!=e.numZeros){a.push("# Zeros");let t="";e.numVals&&(t=e.numZeros>0?`(${i(e.numZeros/e.numVals)})`:""),s.push(`${r(e.numZeros)} ${t}`)}if(null!=e.numNans){a.push("# NaNs");let t="";e.numVals&&(t=e.numNans>0?`(${i(e.numNans/e.numVals)})`:""),s.push(`${r(e.numNans)} ${t}`)}if(null!=e.numInfs){a.push("# Infinity");let t="";e.numVals&&(t=e.numInfs>0?`(${i(e.numInfs/e.numVals)})`:""),s.push(`${r(e.numInfs)} ${t}`)}l.table(t,{headers:a,values:[s]},n)}(a,t,{fontSize:i.fontSize})}if(0===r.length)return;const d=[];for(let e=0;e<r.length;e++){const t=r[e].value;null!=t&&isFinite(t)&&d.push(r[e])}const h={width:i.width||s.getDefaultWidth(p),height:i.height||s.getDefaultHeight(p),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:d},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize}},encoding:{x:{bin:{maxbins:i.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:i.color||"#001B44"}}};return a.default(p,h,{actions:!1,mode:"vega-lite",defaultStyle:!1})}))}},485:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(7887)),a=n(3152),s=n(3538),u=n(334);t.linechart=function(e,t,n={}){return r(this,void 0,void 0,(function*(){const r=Array.isArray(t.values[0])?t.values:[t.values],i=r[0].length,c=t.series?t.series:r.map(((e,t)=>`Series ${t+1}`));s.assert(c.length===r.length,"Must have an equal number of series labels as there are data series"),null!=n.seriesColors&&s.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const p=[];for(let e=0;e<i;e++){const t={x:e};c.forEach(((n,i)=>{const o=r[i][e].y;t[n]=o,t[`${n}-name`]=n})),p.push(t)}const d=Object.assign({},l,n),h={x:{field:"x",type:d.xType,title:d.xLabel},tooltip:[{field:"x",type:"quantitative"},...c.map((e=>({field:e,type:"quantitative"})))]},f=c.map((e=>({data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:e,type:d.yType,title:d.yLabel,scale:d.zoomToFit?{zero:!1}:null!=d.yAxisDomain?{domain:d.yAxisDomain}:void 0},color:{field:`${e}-name`,type:"nominal",legend:{values:c,title:null},scale:{range:d.seriesColors}}}}))),g=u.getDrawArea(e),m={width:d.width||a.getDefaultWidth(g),height:d.height||a.getDefaultHeight(g),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:d.fontSize,titleFontSize:d.fontSize},text:{fontSize:d.fontSize},legend:{labelFontSize:d.fontSize,titleFontSize:d.fontSize}},data:{values:p},encoding:h,layer:[...f,{mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}}]};return yield o.default(g,m,{actions:!1,mode:"vega-lite",defaultStyle:!1}),Promise.resolve()}))};const l={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},334:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(7511),o=n(4326);t.getDrawArea=function(e){if(e instanceof HTMLElement)return e;if(i.isSurface(e))return e.drawArea;if(i.isSurfaceInfo(e))return o.visor().surface({name:e.name,tab:e.tab,styles:e.styles}).drawArea;throw new Error("Not a drawable")},t.shallowEquals=function(e,t){const n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(let r=0;r<n.length;r++){const i=n[r];if(e[i]!==t[i])return!1}return!0},t.nextFrame=function(){return r(this,void 0,void 0,(function*(){yield new Promise((e=>requestAnimationFrame(e)))}))}},3683:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(7887)),a=n(3152),s=n(3538),u=n(334);t.scatterplot=function(e,t,n={}){return r(this,void 0,void 0,(function*(){let r=t.values;const i=null==t.series?[]:t.series;r=Array.isArray(r[0])?r:[r];const c=[];r.forEach(((e,t)=>{const n=null!=i[t]?i[t]:`Series ${t+1}`,r=e.map((e=>Object.assign({},e,{series:n})));c.push(...r)})),null!=n.seriesColors&&s.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const p=u.getDrawArea(e),d=Object.assign({},l,n),h={width:d.width||a.getDefaultWidth(p),height:d.height||a.getDefaultHeight(p),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:d.fontSize,titleFontSize:d.fontSize},text:{fontSize:d.fontSize},legend:{labelFontSize:d.fontSize,titleFontSize:d.fontSize}},data:{values:c},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:d.xType,title:d.xLabel,scale:d.zoomToFit?{zero:!1}:null!=d.xAxisDomain?{domain:d.xAxisDomain}:void 0},y:{field:"y",type:d.yType,title:d.yLabel,scale:d.zoomToFit?{zero:!1}:null!=d.yAxisDomain?{domain:d.yAxisDomain}:void 0},color:{field:"series",type:"nominal",scale:{range:d.seriesColors}},shape:{field:"series",type:"nominal"}}};return yield o.default(p,h,{actions:!1,mode:"vega-lite",defaultStyle:!1}),Promise.resolve()}))};const l={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},707:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(3369),i=n(4677),o=n(6113),a=n(334);t.table=function(e,t,n={}){if(t&&null==t.headers)throw new Error('Data to render must have a "headers" property');if(t&&null==t.values)throw new Error('Data to render must have a "values" property');const u=a.getDrawArea(e),l=Object.assign({},s,n);let c=i.select(u).select("table.tf-table");const p=o.css({fontSize:l.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(0===c.size()&&(c=i.select(u).append("table"),c.attr("class",` ${p} tf-table`),c.append("thead").append("tr"),c.append("tbody")),1!==c.size())throw new Error("Error inserting table");const d=o.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),h=c.select("thead").select("tr").selectAll("th").data(t.headers),f=h.enter().append("th").attr("class",`${d}`);h.merge(f).html((e=>e)),h.exit().remove();const g=r.format(",.4~f"),m=c.select("tbody").selectAll("tr").data(t.values),y=m.enter().append("tr"),b=o.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),v=m.merge(y).selectAll("td").data((e=>e)),x=v.enter().append("td").attr("class",`${b}`);v.merge(x).html((e=>"number"==typeof e?g(e):e)),v.exit().remove(),m.exit().remove()};const s={fontSize:14}},9962:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(485),o=n(334),a=n(3152);function s(e,t,n,s={}){return r(this,void 0,void 0,(function*(){const r=o.getDrawArea(e),c={};for(const e of n)if(/val_/.test(e)){const r=e.replace("val_","");u(c,r);const i=l(t,e,n.indexOf(e));c[r].series.push(e),c[r].values.push(i)}else{const r=l(t,e,n.indexOf(e));u(c,e),c[e].series.push(e),c[e].values.push(r)}const p=Object.keys(c),d=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},s),h=[];for(const e of p){const t=a.subSurface(r,e),n=c[e].series,o=c[e].values;n.every((e=>Boolean(e.match("acc"))))&&(d.zoomToFitAccuracy?d.zoomToFit=!0:(d.yAxisDomain=[0,1],delete d.zoomToFit));const s=i.linechart(t,{values:o,series:n},d);h.push(s)}yield Promise.all(h)}))}function u(e,t){null==e[t]&&(e[t]={series:[],values:[]})}function l(e,t,n){if(Array.isArray(e)){const r=Array.isArray(e[0])?e[n]:e,i=[];for(let e=0;e<r.length;e++){const n=r[e];i.push({x:e,y:n[t]})}return i}return e.history[t].map(((e,t)=>({x:t,y:e})))}function c(e,t,n){return null==e[t]&&(e[t]={}),null==e[t][n]&&(e[t][n]=[]),e[t][n]}t.history=s,t.fitCallbacks=function(e,t,n={}){const i={},u=n.callbacks||["onEpochEnd","onBatchEnd"],l=o.getDrawArea(e),p=Object.assign({},n);delete p.callbacks;const d={};return u.forEach((e=>{d[e]=function(e){return(n,u)=>r(this,void 0,void 0,(function*(){/batch/i.test(e)?p.xLabel="Batch":/epoch/i.test(e)&&(p.xLabel="Epoch");const n=[],r=[];for(const o of t)if(null!=u[o]){r.push(o);const t=c(i,e,o);t.push({[o]:u[o]}),n.push(t)}s(a.subSurface(l,e,{title:e}),n,r,p),yield o.nextFrame()}))}(e)})),d}},1267:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(1825),o=n(334),a=n(707),s=n(3152),u=n(7450);function l(e){let t;return t=Array.isArray(e.outputShape[0])?`[${e.outputShape.map((e=>c(e))).join(", ")}]`:c(e.outputShape),{name:e.name,trainable:e.trainable,parameters:e.countParams(),outputShape:t}}function c(e){const t=e.slice();return 0===t.length?"Scalar":(null===t[0]&&(t[0]="batch"),`[${t.join(",")}]`)}t.modelSummary=function(e,t){return r(this,void 0,void 0,(function*(){const n=o.getDrawArea(e),r=function(e){return{layers:e.layers.map(l)}}(t),i=r.layers.map((e=>[e.name,e.outputShape,e.parameters,e.trainable]));a.table(n,{headers:["Layer Name","Output Shape","# Of Params","Trainable"],values:i})}))},t.layer=function(e,t){return r(this,void 0,void 0,(function*(){const n=o.getDrawArea(e),l=yield function(e){return r(this,void 0,void 0,(function*(){const t=e.getWeights(),n=e.weights,r=t.map(u.tensorStats),i=yield Promise.all(r),o=t.map((e=>e.shape));return t.map(((e,t)=>({name:n[t].name,stats:i[t],shape:c(o[t]),weight:e})))}))}(t),p=s.subSurface(n,"layer-weights-info"),d=l.map((e=>[e.name,e.shape,e.stats.min,e.stats.max,e.weight.size,e.stats.numZeros,e.stats.numNans,e.stats.numInfs]));a.table(p,{headers:["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],values:d});const h=s.subSurface(n,"select-layer"),f=s.subSurface(n,"param-distribution");!function(e,t,n){const r=`<div><button>Show Values Distribution for:</button>${`\n    <select>\n      ${e.map((e=>`<option value=${e}>${e}</option>`))}\n    </select>\n  `}</div>`;t.innerHTML=r;const i=t.querySelector("button"),o=t.querySelector("select");i.addEventListener("click",(()=>{n(o.selectedOptions[0].label)}))}(l.map((e=>e.name)),h,(e=>r(this,void 0,void 0,(function*(){const t=l.filter((t=>t.name===e))[0],n=yield t.weight.data();i.histogram(f,n,{height:150,width:460,stats:!1})}))))}))}},8685:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(334),o=n(707);t.perClassAccuracy=function(e,t,n){return r(this,void 0,void 0,(function*(){const r=i.getDrawArea(e),a=[];for(let e=0;e<t.length;e++){const r=n?n[e]:e.toString(),i=t[e];a.push([r,i.accuracy,i.count])}return o.table(r,{headers:["Class","Accuracy","# Samples"],values:a})}))}},3674:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(1825),o=n(334),a=n(7450);t.valuesDistribution=function(e,t){return r(this,void 0,void 0,(function*(){const n=o.getDrawArea(e),r=yield a.tensorStats(t),s=yield t.data();i.histogram(n,s,{height:150,stats:r})}))}},7511:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSurfaceInfo=function(e){return null!=e.name},t.isSurface=function(e){return e.drawArea instanceof HTMLElement}},3152:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6113),i=n(334),o={prepend:!1};t.subSurface=function(e,t,n={}){const a=i.getDrawArea(e),s=r.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),u=r.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),l=Object.assign({},o,n);let c=a.querySelector(`div[data-name=${t}]`);if(!c){if(c=document.createElement("div"),c.setAttribute("class",`${s}`),c.dataset.name=t,l.title){const e=document.createElement("div");e.setAttribute("class",`subsurface-title ${u}`),e.innerText=l.title,c.appendChild(e)}l.prepend?a.insertBefore(c,a.firstChild):a.appendChild(c)}return c},t.getDefaultWidth=function(e){let t=0,n=e;for(;n&&0===n.clientWidth;)n=n.parentElement,t=50;return n.clientWidth-t},t.getDefaultHeight=function(e){return 0===e.clientHeight?200:e.clientHeight}},7450:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(9882),o=n(3538);t.arrayStats=function(e){if(!Array.isArray(e))throw new Error("input must be an array");if(0===e.length)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};const t=e.length;let n=-1/0,r=1/0,i=0,o=0,a=0;for(let s=0;s<t;s++){const t=e[s];t>n&&(n=t),t<r&&(r=t),0===t&&(i+=1),isNaN(t)?o+=1:isFinite(t)||(a+=1)}const s={numVals:t,numZeros:i,numNans:o,max:n,min:r,numInfs:a};return s.max===-1/0&&(s.max=NaN),s.min===1/0&&(s.min=NaN),s},t.tensorStats=function(e){return r(this,void 0,void 0,(function*(){const[t,n,r]=i.tidy((()=>{const t=i.scalar(0,e.dtype);return[e.min(),e.max(),e.equal(t).sum()]}));return Promise.all([e.data(),t.data(),n.data(),r.data()]).then((([e,t,n,r])=>{const i=e.length;let o=0,a=0;for(let t=0;t<i;t++){const n=e[t];isNaN(n)?o+=1:isFinite(n)||(a+=1)}let s=t[0],u=n[0];return o===i&&(s=NaN,u=NaN),{numVals:i,numZeros:r[0],numNans:o,min:s,max:u,numInfs:a}}))}))},t.confusionMatrix=function(e,t,n,a){return r(this,void 0,void 0,(function*(){o.assert(1===e.rank,"labels must be a 1D tensor"),o.assert(1===t.rank,"predictions must be a 1D tensor"),o.assert(e.size===t.size,"labels and predictions must be the same length"),null!=a&&o.assert(a.size===t.size,"labels and predictions must be the same length");const r=e.cast("int32"),s=t.cast("int32");null==n&&(n=i.tidy((()=>i.maximum(r.max(),s.max()).cast("int32").dataSync()[0]+1)));let u=Promise.resolve(null);return null!=a&&(u=a.data()),Promise.all([r.data(),s.data(),u]).then((([e,t,r])=>{const i=Array(n).fill(0);for(let e=0;e<n;e++)i[e]=Array(n).fill(0);for(let n=0;n<e.length;n++){const o=e[n],a=t[n];i[o][a]+=null!=r?r[n]:1}return i}))}))},t.accuracy=function(e,t){return r(this,void 0,void 0,(function*(){o.assertShapesMatch(e.shape,t.shape,"Error computing accuracy.");const n=e.equal(t),r=n.mean(),a=(yield r.data())[0];return i.dispose([n,r]),a}))},t.perClassAccuracy=function(e,t,n){return r(this,void 0,void 0,(function*(){return o.assert(1===e.rank,"labels must be a 1D tensor"),o.assert(1===t.rank,"predictions must be a 1D tensor"),o.assert(e.size===t.size,"labels and predictions must be the same length"),null==n&&(n=i.tidy((()=>i.maximum(e.max(),t.max()).dataSync()[0]+1))),Promise.all([e.data(),t.data()]).then((([e,t])=>{const r=Array(n).fill(0),i=Array(n).fill(0);for(let n=0;n<e.length;n++){const o=e[n],a=t[n];r[o]+=1,o===a&&(i[o]+=1)}const o=[];for(let e=0;e<r.length;e++)o.push({count:r[e],accuracy:0===r[e]?0:i[e]/r[e]});return o}))}))}},3538:(e,t)=>{"use strict";function n(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function r(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.assert=n,t.assertShapesMatch=function(e,t,i=""){n(r(e,t),i+` Shapes ${e} and ${t} must match`)},t.arraysEqual=r,t.DECIMAL_PLACES_TO_CHECK=4},8422:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version="1.5.1"},4326:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8087);let i;const o="tfjs-visor-container";t.visor=function(){if("undefined"==typeof document)throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(o)&&null!=i)return i;let e,t=document.getElementById(o);function n(t,n){let i=null;return e=r.VisorComponent.render(t,e,{ref:e=>i=e,surfaceList:Array.from(n.values())}),i}null==t&&(t=document.createElement("div"),t.id=o,document.body.appendChild(t));const s=new Map,u=n(t,s);return i=new a(u,t,s,n),i};class a{constructor(e,t,n,r){this.visorComponent=e,this.el=t,this.surfaceList=n,this.renderVisor=r}surface(e){const{name:t}=e,n=null==e.tab?"Visor":e.tab;if(null==t||!("string"==typeof t||t instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");const r=Object.assign({},e,{tab:n}),i=`${t}-${n}`;return this.surfaceList.has(i)||this.surfaceList.set(i,r),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(t,n)}isFullscreen(){return this.visorComponent.isFullscreen()}isOpen(){return this.visorComponent.isOpen()}close(){return this.visorComponent.close()}open(){return this.visorComponent.open()}toggle(){return this.visorComponent.toggle()}toggleFullScreen(){return this.visorComponent.toggleFullScreen()}bindKeys(){return this.visorComponent.bindKeys()}unbindKeys(){return this.visorComponent.unbindKeys()}setActiveTab(e){if(!this.visorComponent.state.tabs.has(e))throw new Error(`Tab '${e}' does not exist`);this.visorComponent.setState({activeTab:e})}}t.Visor=a},3369:(e,t,n)=>{"use strict";function r(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function i(e){return(e=r(Math.abs(e)))?e[1]:NaN}n.r(t),n.d(t,{format:()=>h,formatDefaultLocale:()=>y,formatLocale:()=>m,formatPrefix:()=>f,formatSpecifier:()=>s,precisionFixed:()=>b,precisionPrefix:()=>v,precisionRound:()=>x});var o,a=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function s(e){return new u(e)}function u(e){if(!(t=a.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}function l(e,t){var n=r(e,t);if(!n)return e+"";var i=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+i:i.length>o+1?i.slice(0,o+1)+"."+i.slice(o+1):i+new Array(o-i.length+2).join("0")}s.prototype=u.prototype,u.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const c={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return l(100*e,t)},r:l,s:function(e,t){var n=r(e,t);if(!n)return e+"";var i=n[0],a=n[1],s=a-(o=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,u=i.length;return s===u?i:s>u?i+new Array(s-u+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+r(e,Math.max(0,t+s-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function p(e){return e}var d,h,f,g=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function m(e){var t,n,r=e.grouping&&e.thousands?(t=e.grouping,n=e.thousands,function(e,r){for(var i=e.length,o=[],a=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(e.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}):p,a=e.currency,u=e.decimal,l=e.numerals?function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(e.numerals):p,d=e.percent||"%";function h(e){var t=(e=s(e)).fill,n=e.align,i=e.sign,p=e.symbol,h=e.zero,f=e.width,m=e.comma,y=e.precision,b=e.trim,v=e.type;"n"===v?(m=!0,v="g"):c[v]||(null==y&&(y=12),b=!0,v="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var x="$"===p?a[0]:"#"===p&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",_="$"===p?a[1]:/[%p]/.test(v)?d:"",w=c[v],k=/[defgprs%]/.test(v);function S(e){var a,s,c,p=x,d=_;if("c"===v)d=w(e)+d,e="";else{var S=(e=+e)<0;if(e=w(Math.abs(e),y),b&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(i>0){if(!+e[r])break e;i=0}}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),S&&0==+e&&(S=!1),p=(S?"("===i?i:"-":"-"===i||"("===i?"":i)+p,d=("s"===v?g[8+o/3]:"")+d+(S&&"("===i?")":""),k)for(a=-1,s=e.length;++a<s;)if(48>(c=e.charCodeAt(a))||c>57){d=(46===c?u+e.slice(a+1):e.slice(a))+d,e=e.slice(0,a);break}}m&&!h&&(e=r(e,1/0));var C=p.length+e.length+d.length,M=C<f?new Array(f-C+1).join(t):"";switch(m&&h&&(e=r(M+e,M.length?f-d.length:1/0),M=""),n){case"<":e=p+e+d+M;break;case"=":e=p+M+e+d;break;case"^":e=M.slice(0,C=M.length>>1)+p+e+d+M.slice(C);break;default:e=M+p+e+d}return l(e)}return y=null==y?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y)),S.toString=function(){return e+""},S}return{format:h,formatPrefix:function(e,t){var n=h(((e=s(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(i(t)/3))),o=Math.pow(10,-r),a=g[8+r/3];return function(e){return n(o*e)+a}}}}function y(e){return d=m(e),h=d.format,f=d.formatPrefix,d}function b(e){return Math.max(0,-i(Math.abs(e)))}function v(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(i(t)/3)))-i(Math.abs(e)))}function x(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,i(t)-i(e))+1}y({decimal:".",thousands:",",grouping:[3],currency:["$",""]})},6313:e=>{var t=function(){"use strict";function e(e,t){return null!=t&&e instanceof t}var t,n,r;try{t=Map}catch(e){t=function(){}}try{n=Set}catch(e){n=function(){}}try{r=Promise}catch(e){r=function(){}}function i(o,s,u,l,c){"object"==typeof s&&(u=s.depth,l=s.prototype,c=s.includeNonEnumerable,s=s.circular);var p=[],d=[],h="undefined"!=typeof Buffer;return void 0===s&&(s=!0),void 0===u&&(u=1/0),function o(u,f){if(null===u)return null;if(0===f)return u;var g,m;if("object"!=typeof u)return u;if(e(u,t))g=new t;else if(e(u,n))g=new n;else if(e(u,r))g=new r((function(e,t){u.then((function(t){e(o(t,f-1))}),(function(e){t(o(e,f-1))}))}));else if(i.__isArray(u))g=[];else if(i.__isRegExp(u))g=new RegExp(u.source,a(u)),u.lastIndex&&(g.lastIndex=u.lastIndex);else if(i.__isDate(u))g=new Date(u.getTime());else{if(h&&Buffer.isBuffer(u))return g=Buffer.allocUnsafe?Buffer.allocUnsafe(u.length):new Buffer(u.length),u.copy(g),g;e(u,Error)?g=Object.create(u):void 0===l?(m=Object.getPrototypeOf(u),g=Object.create(m)):(g=Object.create(l),m=l)}if(s){var y=p.indexOf(u);if(-1!=y)return d[y];p.push(u),d.push(g)}for(var b in e(u,t)&&u.forEach((function(e,t){var n=o(t,f-1),r=o(e,f-1);g.set(n,r)})),e(u,n)&&u.forEach((function(e){var t=o(e,f-1);g.add(t)})),u){var v;m&&(v=Object.getOwnPropertyDescriptor(m,b)),v&&null==v.set||(g[b]=o(u[b],f-1))}if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(u);for(b=0;b<x.length;b++){var _=x[b];(!(k=Object.getOwnPropertyDescriptor(u,_))||k.enumerable||c)&&(g[_]=o(u[_],f-1),k.enumerable||Object.defineProperty(g,_,{enumerable:!1}))}}if(c){var w=Object.getOwnPropertyNames(u);for(b=0;b<w.length;b++){var k,S=w[b];(k=Object.getOwnPropertyDescriptor(u,S))&&k.enumerable||(g[S]=o(u[S],f-1),Object.defineProperty(g,S,{enumerable:!1}))}}return g}(o,u)}function o(e){return Object.prototype.toString.call(e)}function a(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return i.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},i.__objToStr=o,i.__isDate=function(e){return"object"==typeof e&&"[object Date]"===o(e)},i.__isArray=function(e){return"object"==typeof e&&"[object Array]"===o(e)},i.__isRegExp=function(e){return"object"==typeof e&&"[object RegExp]"===o(e)},i.__getRegExpFlags=a,i}();e.exports&&(e.exports=t)},6238:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.default)(e)};var r,i=(r=n(5477))&&r.__esModule?r:{default:r};e.exports=t.default},638:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"string"==typeof e&&n.test(e)};var n=/-webkit-|-moz-|-ms-/;e.exports=t.default},4677:(e,t,n)=>{"use strict";n.r(t),n.d(t,{clientPoint:()=>we,create:()=>ye,creator:()=>u,customEvent:()=>ue,event:()=>re,local:()=>ve,matcher:()=>m,mouse:()=>ke,namespace:()=>o,namespaces:()=>i,select:()=>me,selectAll:()=>Se,selection:()=>ge,selector:()=>c,selectorAll:()=>d,style:()=>R,touch:()=>Ce,touches:()=>Me,window:()=>E});var r="http://www.w3.org/1999/xhtml";const i={svg:"http://www.w3.org/2000/svg",xhtml:r,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function o(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),i.hasOwnProperty(t)?{space:i[t],local:e}:e}function a(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===r&&t.documentElement.namespaceURI===r?t.createElement(e):t.createElementNS(n,e)}}function s(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function u(e){var t=o(e);return(t.local?s:a)(t)}function l(){}function c(e){return null==e?l:function(){return this.querySelector(e)}}function p(){return[]}function d(e){return null==e?p:function(){return this.querySelectorAll(e)}}var h=function(e){return function(){return this.matches(e)}};if("undefined"!=typeof document){var f=document.documentElement;if(!f.matches){var g=f.webkitMatchesSelector||f.msMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector;h=function(e){return function(){return g.call(this,e)}}}}const m=h;function y(e){return new Array(e.length)}function b(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}b.prototype={constructor:b,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function v(e,t,n,r,i,o){for(var a,s=0,u=t.length,l=o.length;s<l;++s)(a=t[s])?(a.__data__=o[s],r[s]=a):n[s]=new b(e,o[s]);for(;s<u;++s)(a=t[s])&&(i[s]=a)}function x(e,t,n,r,i,o,a){var s,u,l,c={},p=t.length,d=o.length,h=new Array(p);for(s=0;s<p;++s)(u=t[s])&&(h[s]=l="$"+a.call(u,u.__data__,s,t),l in c?i[s]=u:c[l]=u);for(s=0;s<d;++s)(u=c[l="$"+a.call(e,o[s],s,o)])?(r[s]=u,u.__data__=o[s],c[l]=null):n[s]=new b(e,o[s]);for(s=0;s<p;++s)(u=t[s])&&c[h[s]]===u&&(i[s]=u)}function _(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function w(e){return function(){this.removeAttribute(e)}}function k(e){return function(){this.removeAttributeNS(e.space,e.local)}}function S(e,t){return function(){this.setAttribute(e,t)}}function C(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function M(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function T(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function E(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function A(e){return function(){this.style.removeProperty(e)}}function F(e,t,n){return function(){this.style.setProperty(e,t,n)}}function O(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function R(e,t){return e.style.getPropertyValue(t)||E(e).getComputedStyle(e,null).getPropertyValue(t)}function N(e){return function(){delete this[e]}}function D(e,t){return function(){this[e]=t}}function I(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function B(e){return e.trim().split(/^|\s+/)}function L(e){return e.classList||new P(e)}function P(e){this._node=e,this._names=B(e.getAttribute("class")||"")}function $(e,t){for(var n=L(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function z(e,t){for(var n=L(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function j(e){return function(){$(this,e)}}function G(e){return function(){z(this,e)}}function U(e,t){return function(){(t.apply(this,arguments)?$:z)(this,e)}}function W(){this.textContent=""}function V(e){return function(){this.textContent=e}}function H(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function q(){this.innerHTML=""}function X(e){return function(){this.innerHTML=e}}function Y(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function K(){this.nextSibling&&this.parentNode.appendChild(this)}function J(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Z(){return null}function Q(){var e=this.parentNode;e&&e.removeChild(this)}function ee(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function te(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}P.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var ne={},re=null;function ie(e,t,n){return e=oe(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function oe(e,t,n){return function(r){var i=re;re=r;try{e.call(this,this.__data__,t,n)}finally{re=i}}}function ae(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,o=t.length;r<o;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?t.length=i:delete this.__on}}}function se(e,t,n){var r=ne.hasOwnProperty(e.type)?ie:oe;return function(i,o,a){var s,u=this.__on,l=r(t,o,a);if(u)for(var c=0,p=u.length;c<p;++c)if((s=u[c]).type===e.type&&s.name===e.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=l,s.capture=n),void(s.value=t);this.addEventListener(e.type,l,n),s={type:e.type,name:e.name,value:t,listener:l,capture:n},u?u.push(s):this.__on=[s]}}function ue(e,t,n,r){var i=re;e.sourceEvent=re,re=e;try{return t.apply(n,r)}finally{re=i}}function le(e,t,n){var r=E(e),i=r.CustomEvent;"function"==typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function ce(e,t){return function(){return le(this,e,t)}}function pe(e,t){return function(){return le(this,e,t.apply(this,arguments))}}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(ne={mouseenter:"mouseover",mouseleave:"mouseout"}));var de=[null];function he(e,t){this._groups=e,this._parents=t}function fe(){return new he([[document.documentElement]],de)}he.prototype=fe.prototype={constructor:he,select:function(e){"function"!=typeof e&&(e=c(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=t[i],u=s.length,l=r[i]=new Array(u),p=0;p<u;++p)(o=s[p])&&(a=e.call(o,o.__data__,p,s))&&("__data__"in o&&(a.__data__=o.__data__),l[p]=a);return new he(r,this._parents)},selectAll:function(e){"function"!=typeof e&&(e=d(e));for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a,s=t[o],u=s.length,l=0;l<u;++l)(a=s[l])&&(r.push(e.call(a,a.__data__,l,s)),i.push(a));return new he(r,i)},filter:function(e){"function"!=typeof e&&(e=m(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a=t[i],s=a.length,u=r[i]=[],l=0;l<s;++l)(o=a[l])&&e.call(o,o.__data__,l,a)&&u.push(o);return new he(r,this._parents)},data:function(e,t){if(!e)return f=new Array(this.size()),c=-1,this.each((function(e){f[++c]=e})),f;var n,r=t?x:v,i=this._parents,o=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var a=o.length,s=new Array(a),u=new Array(a),l=new Array(a),c=0;c<a;++c){var p=i[c],d=o[c],h=d.length,f=e.call(p,p&&p.__data__,c,i),g=f.length,m=u[c]=new Array(g),y=s[c]=new Array(g);r(p,d,m,y,l[c]=new Array(h),f,t);for(var b,_,w=0,k=0;w<g;++w)if(b=m[w]){for(w>=k&&(k=w+1);!(_=y[k])&&++k<g;);b._next=_||null}}return(s=new he(s,i))._enter=u,s._exit=l,s},enter:function(){return new he(this._enter||this._groups.map(y),this._parents)},exit:function(){return new he(this._exit||this._groups.map(y),this._parents)},merge:function(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var u,l=t[s],c=n[s],p=l.length,d=a[s]=new Array(p),h=0;h<p;++h)(u=l[h]||c[h])&&(d[h]=u);for(;s<r;++s)a[s]=t[s];return new he(a,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&a!==r.nextSibling&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=_);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],u=s.length,l=i[o]=new Array(u),c=0;c<u;++c)(a=s[c])&&(l[c]=a);l.sort(t)}return new he(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each((function(){e[++t]=this})),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var e=0;return this.each((function(){++e})),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,o=t[n],a=0,s=o.length;a<s;++a)(i=o[a])&&e.call(i,i.__data__,a,o);return this},attr:function(e,t){var n=o(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?k:w:"function"==typeof t?n.local?T:M:n.local?C:S)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?A:"function"==typeof t?O:F)(e,t,null==n?"":n)):R(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?N:"function"==typeof t?I:D)(e,t)):this.node()[e]},classed:function(e,t){var n=B(e+"");if(arguments.length<2){for(var r=L(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?U:t?j:G)(n,t))},text:function(e){return arguments.length?this.each(null==e?W:("function"==typeof e?H:V)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?q:("function"==typeof e?Y:X)(e)):this.node().innerHTML},raise:function(){return this.each(K)},lower:function(){return this.each(J)},append:function(e){var t="function"==typeof e?e:u(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:u(e),r=null==t?Z:"function"==typeof t?t:c(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Q)},clone:function(e){return this.select(e?te:ee)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,o=function(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}(e+""),a=o.length;if(!(arguments.length<2)){for(s=t?se:ae,null==n&&(n=!1),r=0;r<a;++r)this.each(s(o[r],t,n));return this}var s=this.node().__on;if(s)for(var u,l=0,c=s.length;l<c;++l)for(r=0,u=s[l];r<a;++r)if((i=o[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(e,t){return this.each(("function"==typeof t?pe:ce)(e,t))}};const ge=fe;function me(e){return"string"==typeof e?new he([[document.querySelector(e)]],[document.documentElement]):new he([[e]],de)}function ye(e){return me(u(e).call(document.documentElement))}var be=0;function ve(){return new xe}function xe(){this._="@"+(++be).toString(36)}function _e(){for(var e,t=re;e=t.sourceEvent;)t=e;return t}function we(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}function ke(e){var t=_e();return t.changedTouches&&(t=t.changedTouches[0]),we(e,t)}function Se(e){return"string"==typeof e?new he([document.querySelectorAll(e)],[document.documentElement]):new he([null==e?[]:e],de)}function Ce(e,t,n){arguments.length<3&&(n=t,t=_e().changedTouches);for(var r,i=0,o=t?t.length:0;i<o;++i)if((r=t[i]).identifier===n)return we(e,r);return null}function Me(e,t){null==t&&(t=_e().touches);for(var n=0,r=t?t.length:0,i=new Array(r);n<r;++n)i[n]=we(e,t[n]);return i}xe.prototype=ve.prototype={constructor:xe,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}}},7187:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}g(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,i)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function l(e,t,n,r){var i,o,a,l;if(s(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=u(e))>0&&a.length>i&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,l=c,console&&console.warn&&console.warn(l)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=c.bind(r);return i.listener=n,r.wrapFn=i,i}function d(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):f(i,i.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function g(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var u=o[e];if(void 0===u)return!1;if("function"==typeof u)r(u,this,t);else{var l=u.length,c=f(u,l);for(n=0;n<l;++n)r(c[n],this,t)}return!0},o.prototype.addListener=function(e,t){return l(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return l(this,e,t,!0)},o.prototype.once=function(e,t){return s(t),this.on(e,p(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,p(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,a;if(s(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return d(this,e,!0)},o.prototype.rawListeners=function(e){return d(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},o.prototype.listenerCount=h,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},4063:e=>{"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(i=r;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(o=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;0!=i--;){var a=o[i];if(!e(t[a],n[a]))return!1}return!0}return t!=t&&n!=n}},5035:e=>{"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var n,r="boolean"==typeof t.cycles&&t.cycles,i=t.cmp&&(n=t.cmp,function(e){return function(t,r){var i={key:t,value:e[t]},o={key:r,value:e[r]};return n(i,o)}}),o=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var n,a;if(Array.isArray(t)){for(a="[",n=0;n<t.length;n++)n&&(a+=","),a+=e(t[n])||"null";return a+"]"}if(null===t)return"null";if(-1!==o.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=o.push(t)-1,u=Object.keys(t).sort(i&&i(t));for(a="",n=0;n<u.length;n++){var l=u[n],c=e(t[l]);c&&(a&&(a+=","),a+=JSON.stringify(l)+":"+c)}return o.splice(s,1),"{"+a+"}"}}(e)}},2297:e=>{"use strict";var t=/-(.)/g;e.exports=function(e){return e.replace(t,(function(e,t){return t.toUpperCase()}))}},250:(e,t,n)=>{"use strict";var r=n(2297),i=/^-ms-/;e.exports=function(e){return r(e.replace(i,"ms-"))}},139:e=>{"use strict";function t(e){return function(){return e}}var n=function(){};n.thatReturns=t,n.thatReturnsFalse=t(!1),n.thatReturnsTrue=t(!0),n.thatReturnsNull=t(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(e){return e},e.exports=n},9349:e=>{"use strict";var t=/([A-Z])/g;e.exports=function(e){return e.replace(t,"-$1").toLowerCase()}},7100:(e,t,n)=>{"use strict";var r=n(9349),i=/^ms-/;e.exports=function(e){return r(e).replace(i,"-ms-")}},1767:e=>{"use strict";e.exports=function(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}},3620:(e,t,n)=>{"use strict";var r=n(139);e.exports=r},6482:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},r=["Webkit","ms","Moz","O"];Object.keys(n).forEach((function(e){r.forEach((function(t){n[function(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}(t,e)]=n[e]}))}));var i={isUnitlessNumber:n,shorthandPropertyExpansions:{background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}}};t.default=i},8511:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(6482));function i(e){return e&&e.__esModule?e:{default:e}}i(n(3620));var o=r.default.isUnitlessNumber;t.default=function(e,t,n){return null==t||"boolean"==typeof t||""===t?"":isNaN(t)||0===t||o.hasOwnProperty(e)&&o[e]?""+t:("string"==typeof t&&(t=t.trim()),t+"px")}},6563:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processStyleName=void 0,t.createMarkupForStyles=function(e,t){var n="";for(var i in e){var o=0===i.indexOf("--");if(e.hasOwnProperty(i)&&"label"!==i){var a=e[i];null!=a&&(o?n+=i+":"+a+";":(n+=s(i)+":",n+=(0,r.default)(i,a,t)+";"))}}return n||null},a(n(250));var r=a(n(8511)),i=a(n(7100)),o=a(n(1767));function a(e){return e&&e.__esModule?e:{default:e}}a(n(3620));var s=t.processStyleName=(0,o.default)(i.default)},5913:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(e){return Array.isArray(e)?(i=!1,o=[],(t=e).forEach((function(e){var t=r(e);null!==t&&t===e||(i=!0),null!==t&&o.push(t)})),0==o.length?null:i?o:t):function(e){if(function(e){return null==e||!1===e||"object"===(void 0===e?"undefined":n(e))&&0===Object.keys(e).length}(e))return null;if("object"!==(void 0===e?"undefined":n(e)))return e;for(var t={},i=Object.keys(e),o=!1,a=0;a<i.length;a++){var s=e[i[a]],u=r(s);null!==u&&u===s||(o=!0),null!==u&&(t[i[a]]=u)}return 0===Object.keys(t).length?null:o?t:e}(e);var t,i,o}t.default=r},8108:(e,t)=>{"use strict";function n(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)+(e.charCodeAt(t++)<<16)+(e.charCodeAt(t)<<24)}function r(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)}function i(e,t){return(65535&(e|=0))*(t|=0)+(((e>>>16)*t&65535)<<16)|0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var o=1540483477,a=t^e.length,s=e.length,u=0;s>=4;){var l=n(e,u);l=i(l,o),l=i(l^=l>>>24,o),a=i(a,o),a^=l,u+=4,s-=4}switch(s){case 3:a^=r(e,u),a=i(a^=e.charCodeAt(u+2)<<16,o);break;case 2:a=i(a^=r(e,u),o);break;case 1:a=i(a^=e.charCodeAt(u),o)}return a=i(a^=a>>>13,o),(a^=a>>>15)>>>0}},6113:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compose=t.merge=t.$=t.style=t.presets=t.keyframes=t.fontFace=t.insertGlobal=t.insertRule=t.plugins=t.styleSheet=void 0,t.speedy=function(e){return p.speedy(e)},t.simulations=function(){m=!!(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])},t.simulate=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(t=(0,a.default)(t))?m?t.reduce((function(e,t){return e["data-simulate-"+x(t)]="",e}),{}):(y||(console.warn("can't simulate without once calling simulations(true)"),y=!0),h||f||b||(console.warn("don't use simulation outside dev"),b=!0),{}):{}},t.cssLabels=function(e){v=!!e},t.isLikeRule=w,t.idFor=k,t.css=V,t.rehydrate=function(e){(0,r.default)(F,e.reduce((function(e,t){return e[t]=!0,e}),{}))},t.flush=function(){F=p.inserted={},O=p.registered={},N={},p.flush(),p.inject()},t.select=q,t.parent=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return V(c({},e+" &",n))},t.media=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return V(c({},"@media "+e,n))},t.pseudo=X,t.active=function(e){return X(":active",e)},t.any=function(e){return X(":any",e)},t.checked=function(e){return X(":checked",e)},t.disabled=function(e){return X(":disabled",e)},t.empty=function(e){return X(":empty",e)},t.enabled=function(e){return X(":enabled",e)},t._default=function(e){return X(":default",e)},t.first=function(e){return X(":first",e)},t.firstChild=function(e){return X(":first-child",e)},t.firstOfType=function(e){return X(":first-of-type",e)},t.fullscreen=function(e){return X(":fullscreen",e)},t.focus=function(e){return X(":focus",e)},t.hover=function(e){return X(":hover",e)},t.indeterminate=function(e){return X(":indeterminate",e)},t.inRange=function(e){return X(":in-range",e)},t.invalid=function(e){return X(":invalid",e)},t.lastChild=function(e){return X(":last-child",e)},t.lastOfType=function(e){return X(":last-of-type",e)},t.left=function(e){return X(":left",e)},t.link=function(e){return X(":link",e)},t.onlyChild=function(e){return X(":only-child",e)},t.onlyOfType=function(e){return X(":only-of-type",e)},t.optional=function(e){return X(":optional",e)},t.outOfRange=function(e){return X(":out-of-range",e)},t.readOnly=function(e){return X(":read-only",e)},t.readWrite=function(e){return X(":read-write",e)},t.required=function(e){return X(":required",e)},t.right=function(e){return X(":right",e)},t.root=function(e){return X(":root",e)},t.scope=function(e){return X(":scope",e)},t.target=function(e){return X(":target",e)},t.valid=function(e){return X(":valid",e)},t.visited=function(e){return X(":visited",e)},t.dir=function(e,t){return X(":dir("+e+")",t)},t.lang=function(e,t){return X(":lang("+e+")",t)},t.not=function(e,t){var n=e.split(",").map((function(e){return e.trim()})).map((function(e){return":not("+e+")"}));return 1===n.length?X(":not("+e+")",t):q(n.join(""),t)},t.nthChild=function(e,t){return X(":nth-child("+e+")",t)},t.nthLastChild=function(e,t){return X(":nth-last-child("+e+")",t)},t.nthLastOfType=function(e,t){return X(":nth-last-of-type("+e+")",t)},t.nthOfType=function(e,t){return X(":nth-of-type("+e+")",t)},t.after=function(e){return X("::after",e)},t.before=function(e){return X("::before",e)},t.firstLetter=function(e){return X("::first-letter",e)},t.firstLine=function(e){return X("::first-line",e)},t.selection=function(e){return X("::selection",e)},t.backdrop=function(e){return X("::backdrop",e)},t.placeholder=function(e){return V({"::placeholder":e})},t.cssFor=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(t=(0,a.default)(t))?t.map((function(e){var t={label:[]};return P(t,{src:e}),A(_(t),E(t)).join("")})).join(""):""},t.attribsFor=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(t=(0,a.default)(t))?t.map((function(e){k(e);var t=Object.keys(e)[0];return t+'="'+(e[t]||"")+'"'})).join(" "):""};var r=l(n(7418)),i=n(6837),o=n(6563),a=l(n(5913)),s=n(2389),u=l(n(8108));function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=t.styleSheet=new i.StyleSheet;p.inject();var d=t.plugins=p.plugins=new s.PluginSet([s.prefixes,s.contentWrap,s.fallbacks]);d.media=new s.PluginSet,d.fontFace=new s.PluginSet,d.keyframes=new s.PluginSet([s.prefixes,s.fallbacks]);var h=!1,f=!1,g="undefined"!=typeof window,m=h,y=!1,b=!1,v=h;function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.toLowerCase().replace(/[^a-z0-9]/g,t)}function _(e){var t=JSON.stringify(e),n=(0,u.default)(t).toString(36);return e.label&&e.label.length>0&&h?x(e.label.join("."),"-")+"-"+n:n}function w(e){var t=Object.keys(e).filter((function(e){return"toString"!==e}));return 1===t.length&&!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0])}function k(e){var t=Object.keys(e).filter((function(e){return"toString"!==e}));if(1!==t.length)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0]);if(!n)throw new Error("not a rule");return n[1]}var S=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function C(e){if(-1===e.indexOf(","))return[e];for(var t,n=[],r=[],i=0;t=S.exec(e);)switch(t[0]){case"(":i++;break;case")":i--;break;case",":if(i)break;n.push(t.index)}for(t=n.length;t--;)r.unshift(e.slice(n[t]+1)),e=e.slice(0,n[t]);return r.unshift(e),r}function M(e,t){if(!e)return t.replace(/\&/g,"");if(!t)return".css-"+e+",[data-css-"+e+"]";var n=C(t).map((function(t){return t.indexOf("&")>=0?[t.replace(/\&/gm,".css-"+e),t.replace(/\&/gm,"[data-css-"+e+"]")].join(","):".css-"+e+t+",[data-css-"+e+"]"+t})).join(",");return m&&/^\&\:/.exec(t)&&!/\s/.exec(t)&&(n+=",.css-"+e+"[data-simulate-"+x(t)+"],[data-css-"+e+"][data-simulate-"+x(t)+"]"),n}function T(e){var t=e.selector,n=e.style,r=d.transform({selector:t,style:n});return r.selector+"{"+(0,o.createMarkupForStyles)(r.style)+"}"}function E(e){var t=void 0,n=void 0,r=void 0,i=void 0;return Object.keys(e).forEach((function(o){o.indexOf("&")>=0?(n=n||{})[o]=e[o]:0===o.indexOf("@media")?(r=r||{})[o]=E(e[o]):0===o.indexOf("@supports")?(i=i||{})[o]=E(e[o]):"label"===o?e.label.length>0&&((t=t||{}).label=v?e.label.join("."):""):(t=t||{})[o]=e[o]})),{plain:t,selects:n,medias:r,supports:i}}function A(e,t){var n=[],r=t.plain,i=t.selects,o=t.medias,a=t.supports;return r&&n.push(T({style:r,selector:M(e)})),i&&Object.keys(i).forEach((function(t){return n.push(T({style:i[t],selector:M(e,t)}))})),o&&Object.keys(o).forEach((function(t){return n.push(t+"{"+A(e,o[t]).join("")+"}")})),a&&Object.keys(a).forEach((function(t){return n.push(t+"{"+A(e,a[t]).join("")+"}")})),n}var F=p.inserted={},O=p.registered={};function R(e){O[e.id]||(O[e.id]=e)}var N={};function D(e,t){var n=C(e).map((function(e){return e.indexOf("&")>=0?e:"&"+e})),r=C(t).map((function(e){return e.indexOf("&")>=0?e:"&"+e}));return r.reduce((function(e,t){return e.concat(n.map((function(e){return t.replace(/\&/g,e)})))}),[]).join(",")}function I(e,t){return e?"@supports "+e.substring(9)+" and "+t.substring(9):t}function B(e){for(var t=[],n=0;n<e.length;n++)t=Array.isArray(e[n])?t.concat(B(e[n])):t.concat(e[n]);return t}var L={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function P(e,t){var n=t.selector,r=void 0===n?"":n,i=t.mq,o=void 0===i?"":i,s=t.supp,u=void 0===s?"":s,l=t.src,c=void 0===l?{}:l;Array.isArray(c)||(c=[c]),(c=B(c)).forEach((function(t){if(w(t)){var n=function(e){if(w(e)){var t=O[k(e)];if(null==t)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return t}return e}(t);if("css"!==n.type)throw new Error("cannot merge this rule");t=n.style}(t=(0,a.default)(t))&&t.composes&&P(e,{selector:r,mq:o,supp:u,src:t.composes}),Object.keys(t||{}).forEach((function(n){if(function(e){for(var t=[":",".","[",">"," "],n=!1,r=e.charAt(0),i=0;i<t.length;i++)if(r===t[i]){n=!0;break}return n||e.indexOf("&")>=0}(n))L[n]&&L[n].forEach((function(i){return P(e,{selector:D(r,i),mq:o,supp:u,src:t[n]})})),P(e,{selector:D(r,n),mq:o,supp:u,src:t[n]});else if(function(e){return 0===e.indexOf("@media")}(n))P(e,{selector:r,mq:(a=o,s=n,a?"@media "+a.substring(6)+" and "+s.substring(6):s),supp:u,src:t[n]});else if(function(e){return 0===e.indexOf("@supports")}(n))P(e,{selector:r,mq:o,supp:I(u,n),src:t[n]});else if("composes"===n);else{var i=e;u&&(i[u]=i[u]||{},i=i[u]),o&&(i[o]=i[o]||{},i=i[o]),r&&(i[r]=i[r]||{},i=i[r]),"label"===n?v&&(e.label=e.label.concat(t.label)):i[n]=t[n]}var a,s}))}))}function $(e){var t={label:[]};return P(t,{src:e}),function(e){if(R(e),function(e){if(!F[e.id]){F[e.id]=!0;var t=E(e.style),n=A(e.id,t);F[e.id]=!!g||n,n.forEach((function(e){return p.insert(e)}))}}(e),N[e.id])return N[e.id];var t=c({},"data-css-"+e.id,v&&e.label||"");return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-"+e.id}}),N[e.id]=t,t}({id:_(t),style:t,label:v?t.label.join("."):"",type:"css"})}var z={};Object.defineProperty(z,"toString",{enumerable:!1,value:function(){return"css-nil"}});var j,G="undefined"!=typeof WeakMap?[z,new WeakMap,new WeakMap,new WeakMap]:[z],U=!1,W="undefined"!=typeof WeakMap?(j=$,function(e){if(G[e.length]){for(var t=G[e.length],n=0;n<e.length-1;)t.has(e[n])||t.set(e[n],new WeakMap),t=t.get(e[n]),n++;if(t.has(e[e.length-1])){var r=t.get(e[n]);if(O[r.toString().substring(4)])return r}}var i=j(e);if(G[e.length]){for(var o=0,a=G[e.length];o<e.length-1;)a=a.get(e[o]),o++;try{a.set(e[o],i)}catch(t){var s;h&&!U&&(U=!0,(s=console).warn.apply(s,["failed setting the WeakMap cache for args:"].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e))),console.warn("this should NOT happen, please file a bug on the github repo."))}}return i}):$;function V(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0]&&t[0].length&&t[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return(t=(0,a.default)(t))?W(t):z}V.insert=function(e){var t={id:_(e),css:e,type:"raw"};R(t),F[t.id]||(p.insert(t.css),F[t.id]=!!g||[t.css])},t.insertRule=V.insert,V.global=function(e,t){if(t=(0,a.default)(t))return V.insert(T({selector:e,style:t}))},t.insertGlobal=V.global,V.keyframes=function(e,t){t||(t=e,e="animation");var n={id:_({name:e,kfs:t=(0,a.default)(t)||{}}),type:"keyframes",name:e,keyframes:t};return R(n),function(e){if(!F[e.id]){var t=Object.keys(e.keyframes).map((function(t){var n=d.keyframes.transform({id:e.id,name:t,style:e.keyframes[t]});return n.name+"{"+(0,o.createMarkupForStyles)(n.style)+"}"})).join(""),n=["-webkit-","-moz-","-o-",""].map((function(n){return"@"+n+"keyframes "+e.name+"_"+e.id+"{"+t+"}"}));n.forEach((function(e){return p.insert(e)})),F[e.id]=!!g||n}}(n),e+"_"+n.id},V.fontFace=function(e){var t={id:_(e=(0,a.default)(e)),type:"font-face",font:e};return R(t),function(e){if(!F[e.id]){var t="@font-face{"+(0,o.createMarkupForStyles)(e.font)+"}";p.insert(t),F[e.id]=!!g||[t]}}(t),e.fontFamily},t.fontFace=V.fontFace,t.keyframes=V.keyframes,t.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var H=t.style=V;function q(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e?V(c({},e,n)):H(n)}function X(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return V(c({},e,n))}t.$=q,t.merge=V,t.compose=V},2389:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.PluginSet=u,t.fallbacks=function(e){if(Object.keys(e.style).map((function(t){return Array.isArray(e.style[t])})).indexOf(!0)>=0){var t=e.style,n=Object.keys(t).reduce((function(e,n){return e[n]=Array.isArray(t[n])?t[n].join("; "+(0,o.processStyleName)(n)+": "):t[n],e}),{});return(0,i.default)({},e,{style:n})}return e},t.contentWrap=function(e){if(e.style.content){var t=e.style.content;return l.indexOf(t)>=0||/^(attr|calc|counters?|url)\(/.test(t)?e:t.charAt(0)!==t.charAt(t.length-1)||'"'!==t.charAt(0)&&"'"!==t.charAt(0)?r({},e,{style:r({},e.style,{content:'"'+t+'"'})}):e}return e},t.prefixes=function(e){return(0,i.default)({},e,{style:(0,a.default)(r({},e.style))})};var i=s(n(7418)),o=n(6563),a=s(n(4975));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){this.fns=e||[]}(0,i.default)(u.prototype,{add:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){e.fns.indexOf(t)>=0||(e.fns=[t].concat(e.fns))}))},remove:function(e){this.fns=this.fns.filter((function(t){return t!==e}))},clear:function(){this.fns=[]},transform:function(e){return this.fns.reduce((function(e,t){return t(e)}),e)}});var l=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"]},4975:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t in e){var n=e[t],r=(0,o.default)(y,t,n,e,b);r&&(e[t]=r),(0,i.default)(b,t,e)}return e};var r=m(n(2633)),i=m(n(7901)),o=m(n(1745)),a=m(n(5848)),s=m(n(3207)),u=m(n(7879)),l=m(n(5716)),c=m(n(8544)),p=m(n(7551)),d=m(n(1242)),h=m(n(9686)),f=m(n(1113)),g=m(n(5152));function m(e){return e&&e.__esModule?e:{default:e}}var y=[s.default,a.default,u.default,c.default,p.default,d.default,h.default,f.default,g.default,l.default],b=r.default.prefixMap},6837:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StyleSheet=d;var r,i=(r=n(7418))&&r.__esModule?r:{default:r};function o(e){return e[e.length-1]}function a(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}var s="undefined"!=typeof window,u=!1,l=!1,c=function(){if(s){var e=document.createElement("div");return e.innerHTML="\x3c!--[if lt IE 10]><i></i><![endif]--\x3e",1===e.getElementsByTagName("i").length}}();function p(){var e=document.createElement("style");return e.type="text/css",e.setAttribute("data-glamor",""),e.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.speedy,n=void 0===t?!u&&!l:t,r=e.maxLength,i=void 0===r?s&&c?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=i,this.ctr=0}(0,i.default)(d.prototype,{getSheet:function(){return a(o(this.tags))},inject:function(){var e=this;if(this.injected)throw new Error("already injected stylesheet!");s?this.tags[0]=p():this.sheet={cssRules:[],insertRule:function(t){e.sheet.cssRules.push({cssText:t})}},this.injected=!0},speedy:function(e){if(0!==this.ctr)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+e+") earlier in your app, or call flush() before speedy("+e+")");this.isSpeedy=!!e},_insert:function(e){try{var t=this.getSheet();t.insertRule(e,-1!==e.indexOf("@import")?0:t.cssRules.length)}catch(t){u&&console.warn("whoops, illegal rule inserted",e)}},insert:function(e){if(s)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(e);else if(-1!==e.indexOf("@import")){var t=o(this.tags);t.insertBefore(document.createTextNode(e),t.firstChild)}else o(this.tags).appendChild(document.createTextNode(e));else this.sheet.insertRule(e,-1!==e.indexOf("@import")?0:this.sheet.cssRules.length);return this.ctr++,s&&this.ctr%this.maxLength==0&&this.tags.push(p()),this.ctr-1},delete:function(e){return this.replace(e,"")},flush:function(){s?(this.tags.forEach((function(e){return e.parentNode.removeChild(e)})),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!s)return this.sheet.cssRules;var e=[];return this.tags.forEach((function(t){return e.splice.apply(e,[e.length,0].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(Array.from(a(t).cssRules))))})),e}})},5477:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});var r=/[A-Z]/g,i=/^ms-/,o={};function a(e){return"-"+e.toLowerCase()}const s=function(e){if(o.hasOwnProperty(e))return o[e];var t=e.replace(r,a);return o[e]=i.test(t)?"-"+t:t}},3207:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"==typeof t&&!(0,i.default)(t)&&t.indexOf("cross-fade(")>-1)return o.map((function(e){return t.replace(/cross-fade\(/g,e+"cross-fade(")}))};var r,i=(r=n(638))&&r.__esModule?r:{default:r},o=["-webkit-",""];e.exports=t.default},5848:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("cursor"===e&&r.hasOwnProperty(t))return n.map((function(e){return e+t}))};var n=["-webkit-","-moz-",""],r={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};e.exports=t.default},7879:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"==typeof t&&!(0,i.default)(t)&&t.indexOf("filter(")>-1)return o.map((function(e){return t.replace(/filter\(/g,e+"filter(")}))};var r,i=(r=n(638))&&r.__esModule?r:{default:r},o=["-webkit-",""];e.exports=t.default},5716:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("display"===e&&n.hasOwnProperty(t))return n[t]};var n={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};e.exports=t.default},8544:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,i){"flexDirection"===e&&"string"==typeof t&&(t.indexOf("column")>-1?i.WebkitBoxOrient="vertical":i.WebkitBoxOrient="horizontal",t.indexOf("reverse")>-1?i.WebkitBoxDirection="reverse":i.WebkitBoxDirection="normal"),r.hasOwnProperty(e)&&(i[r[e]]=n[t]||t)};var n={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},r={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};e.exports=t.default},7551:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"==typeof t&&!(0,i.default)(t)&&a.test(t))return o.map((function(e){return e+t}))};var r,i=(r=n(638))&&r.__esModule?r:{default:r},o=["-webkit-","-moz-",""],a=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;e.exports=t.default},1242:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"==typeof t&&!(0,i.default)(t)&&t.indexOf("image-set(")>-1)return o.map((function(e){return t.replace(/image-set\(/g,e+"image-set(")}))};var r,i=(r=n(638))&&r.__esModule?r:{default:r},o=["-webkit-",""];e.exports=t.default},9686:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("position"===e&&"sticky"===t)return["-webkit-sticky","sticky"]},e.exports=t.default},1113:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(r.hasOwnProperty(e)&&i.hasOwnProperty(t))return n.map((function(e){return e+t}))};var n=["-webkit-","-moz-",""],r={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},i={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};e.exports=t.default},5152:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,a){if("string"==typeof t&&s.hasOwnProperty(e)){var l=function(e,t){if((0,i.default)(e))return e;for(var n=e.split(/,(?![^()]*(?:\([^()]*\))?\))/g),o=0,a=n.length;o<a;++o){var s=n[o],l=[s];for(var c in t){var p=(0,r.default)(c);if(s.indexOf(p)>-1&&"order"!==p)for(var d=t[c],h=0,f=d.length;h<f;++h)l.unshift(s.replace(p,u[d[h]]+p))}n[o]=l.join(",")}return n.join(",")}(t,a),c=l.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(e){return!/-moz-|-ms-/.test(e)})).join(",");if(e.indexOf("Webkit")>-1)return c;var p=l.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(e){return!/-webkit-|-ms-/.test(e)})).join(",");return e.indexOf("Moz")>-1?p:(n["Webkit"+(0,o.default)(e)]=c,n["Moz"+(0,o.default)(e)]=p,l)}};var r=a(n(6238)),i=a(n(638)),o=a(n(2160));function a(e){return e&&e.__esModule?e:{default:e}}var s={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},u={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};e.exports=t.default},2633:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["Webkit"],r=["Moz"],i=["ms"],o=["Webkit","Moz"],a=["Webkit","ms"],s=["Webkit","Moz","ms"];t.default={plugins:[],prefixMap:{appearance:o,userSelect:s,textEmphasisPosition:n,textEmphasis:n,textEmphasisStyle:n,textEmphasisColor:n,boxDecorationBreak:n,clipPath:n,maskImage:n,maskMode:n,maskRepeat:n,maskPosition:n,maskClip:n,maskOrigin:n,maskSize:n,maskComposite:n,mask:n,maskBorderSource:n,maskBorderMode:n,maskBorderSlice:n,maskBorderWidth:n,maskBorderOutset:n,maskBorderRepeat:n,maskBorder:n,maskType:n,textDecorationStyle:n,textDecorationSkip:n,textDecorationLine:n,textDecorationColor:n,filter:n,fontFeatureSettings:n,breakAfter:s,breakBefore:s,breakInside:s,columnCount:o,columnFill:o,columnGap:o,columnRule:o,columnRuleColor:o,columnRuleStyle:o,columnRuleWidth:o,columns:o,columnSpan:o,columnWidth:o,writingMode:a,flex:n,flexBasis:n,flexDirection:n,flexGrow:n,flexFlow:n,flexShrink:n,flexWrap:n,alignContent:n,alignItems:n,alignSelf:n,justifyContent:n,order:n,transform:n,transformOrigin:n,transformOriginX:n,transformOriginY:n,backfaceVisibility:n,perspective:n,perspectiveOrigin:n,transformStyle:n,transformOriginZ:n,animation:n,animationDelay:n,animationDirection:n,animationFillMode:n,animationDuration:n,animationIterationCount:n,animationName:n,animationPlayState:n,animationTimingFunction:n,backdropFilter:n,fontKerning:n,scrollSnapType:a,scrollSnapPointsX:a,scrollSnapPointsY:a,scrollSnapDestination:a,scrollSnapCoordinate:a,shapeImageThreshold:n,shapeImageMargin:n,shapeImageOutside:n,hyphens:s,flowInto:a,flowFrom:a,regionFragment:a,textAlignLast:r,tabSize:r,wrapFlow:i,wrapThrough:i,wrapMargin:i,gridTemplateColumns:i,gridTemplateRows:i,gridTemplateAreas:i,gridTemplate:i,gridAutoColumns:i,gridAutoRows:i,gridAutoFlow:i,grid:i,gridRowStart:i,gridColumnStart:i,gridRowEnd:i,gridRow:i,gridColumn:i,gridColumnEnd:i,gridColumnGap:i,gridRowGap:i,gridArea:i,gridGap:i,textSizeAdjust:a,borderImage:n,borderImageOutset:n,borderImageRepeat:n,borderImageSlice:n,borderImageSource:n,borderImageWidth:n,transitionDelay:n,transitionDuration:n,transitionProperty:n,transitionTimingFunction:n}},e.exports=t.default},2160:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e.exports=t.default},7901:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(e.hasOwnProperty(t))for(var r=e[t],o=0,a=r.length;o<a;++o)n[r[o]+(0,i.default)(t)]=n[t]};var r,i=(r=n(2160))&&r.__esModule?r:{default:r};e.exports=t.default},1745:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,i){for(var o=0,a=e.length;o<a;++o){var s=e[o](t,n,r,i);if(s)return s}},e.exports=t.default},3720:e=>{e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var i={},o={};function a(e,t){var n,r,a;return t?(a=0<=(e>>>=0)&&e<256)&&(r=o[e])?r:(n=u(e,(0|e)<0?-1:0,!0),a&&(o[e]=n),n):(a=-128<=(e|=0)&&e<128)&&(r=i[e])?r:(n=u(e,e<0?-1:0,!1),a&&(i[e]=n),n)}function s(e,t){if(isNaN(e))return t?y:m;if(t){if(e<0)return y;if(e>=h)return w}else{if(e<=-f)return k;if(e+1>=f)return _}return e<0?s(-e,t).neg():u(e%d|0,e/d|0,t)}function u(e,t,r){return new n(e,t,r)}n.fromInt=a,n.fromNumber=s,n.fromBits=u;var l=Math.pow;function c(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return m;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return c(e.substring(1),t,n).neg();for(var i=s(l(n,8)),o=m,a=0;a<e.length;a+=8){var u=Math.min(8,e.length-a),p=parseInt(e.substring(a,a+u),n);if(u<8){var d=s(l(n,u));o=o.mul(d).add(s(p))}else o=(o=o.mul(i)).add(s(p))}return o.unsigned=t,o}function p(e,t){return"number"==typeof e?s(e,t):"string"==typeof e?c(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}n.fromString=c,n.fromValue=p;var d=4294967296,h=d*d,f=h/2,g=a(1<<24),m=a(0);n.ZERO=m;var y=a(0,!0);n.UZERO=y;var b=a(1);n.ONE=b;var v=a(1,!0);n.UONE=v;var x=a(-1);n.NEG_ONE=x;var _=u(-1,2147483647,!1);n.MAX_VALUE=_;var w=u(-1,-1,!0);n.MAX_UNSIGNED_VALUE=w;var k=u(0,-2147483648,!1);n.MIN_VALUE=k;var S=n.prototype;S.toInt=function(){return this.unsigned?this.low>>>0:this.low},S.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},S.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(k)){var t=s(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=s(l(e,6),this.unsigned),o=this,a="";;){var u=o.div(i),c=(o.sub(u.mul(i)).toInt()>>>0).toString(e);if((o=u).isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},S.getHighBits=function(){return this.high},S.getHighBitsUnsigned=function(){return this.high>>>0},S.getLowBits=function(){return this.low},S.getLowBitsUnsigned=function(){return this.low>>>0},S.getNumBitsAbs=function(){if(this.isNegative())return this.eq(k)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},S.isZero=function(){return 0===this.high&&0===this.low},S.eqz=S.isZero,S.isNegative=function(){return!this.unsigned&&this.high<0},S.isPositive=function(){return this.unsigned||this.high>=0},S.isOdd=function(){return 1==(1&this.low)},S.isEven=function(){return 0==(1&this.low)},S.equals=function(e){return r(e)||(e=p(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},S.eq=S.equals,S.notEquals=function(e){return!this.eq(e)},S.neq=S.notEquals,S.ne=S.notEquals,S.lessThan=function(e){return this.comp(e)<0},S.lt=S.lessThan,S.lessThanOrEqual=function(e){return this.comp(e)<=0},S.lte=S.lessThanOrEqual,S.le=S.lessThanOrEqual,S.greaterThan=function(e){return this.comp(e)>0},S.gt=S.greaterThan,S.greaterThanOrEqual=function(e){return this.comp(e)>=0},S.gte=S.greaterThanOrEqual,S.ge=S.greaterThanOrEqual,S.compare=function(e){if(r(e)||(e=p(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},S.comp=S.compare,S.negate=function(){return!this.unsigned&&this.eq(k)?k:this.not().add(b)},S.neg=S.negate,S.add=function(e){r(e)||(e=p(e));var t=this.high>>>16,n=65535&this.high,i=this.low>>>16,o=65535&this.low,a=e.high>>>16,s=65535&e.high,l=e.low>>>16,c=0,d=0,h=0,f=0;return h+=(f+=o+(65535&e.low))>>>16,d+=(h+=i+l)>>>16,c+=(d+=n+s)>>>16,c+=t+a,u((h&=65535)<<16|(f&=65535),(c&=65535)<<16|(d&=65535),this.unsigned)},S.subtract=function(e){return r(e)||(e=p(e)),this.add(e.neg())},S.sub=S.subtract,S.multiply=function(e){if(this.isZero())return m;if(r(e)||(e=p(e)),t)return u(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return m;if(this.eq(k))return e.isOdd()?k:m;if(e.eq(k))return this.isOdd()?k:m;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return s(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,i=65535&this.high,o=this.low>>>16,a=65535&this.low,l=e.high>>>16,c=65535&e.high,d=e.low>>>16,h=65535&e.low,f=0,y=0,b=0,v=0;return b+=(v+=a*h)>>>16,y+=(b+=o*h)>>>16,b&=65535,y+=(b+=a*d)>>>16,f+=(y+=i*h)>>>16,y&=65535,f+=(y+=o*d)>>>16,y&=65535,f+=(y+=a*c)>>>16,f+=n*h+i*d+o*c+a*l,u((b&=65535)<<16|(v&=65535),(f&=65535)<<16|(y&=65535),this.unsigned)},S.mul=S.multiply,S.divide=function(e){if(r(e)||(e=p(e)),e.isZero())throw Error("division by zero");var n,i,o;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:m;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return y;if(e.gt(this.shru(1)))return v;o=y}else{if(this.eq(k))return e.eq(b)||e.eq(x)?k:e.eq(k)?b:(n=this.shr(1).div(e).shl(1)).eq(m)?e.isNegative()?b:x:(i=this.sub(e.mul(n)),o=n.add(i.div(e)));if(e.eq(k))return this.unsigned?y:m;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=m}for(i=this;i.gte(e);){n=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(n)/Math.LN2),c=a<=48?1:l(2,a-48),d=s(n),h=d.mul(e);h.isNegative()||h.gt(i);)h=(d=s(n-=c,this.unsigned)).mul(e);d.isZero()&&(d=b),o=o.add(d),i=i.sub(h)}return o},S.div=S.divide,S.modulo=function(e){return r(e)||(e=p(e)),t?u((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},S.mod=S.modulo,S.rem=S.modulo,S.not=function(){return u(~this.low,~this.high,this.unsigned)},S.and=function(e){return r(e)||(e=p(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},S.or=function(e){return r(e)||(e=p(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},S.xor=function(e){return r(e)||(e=p(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},S.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},S.shl=S.shiftLeft,S.shiftRight=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},S.shr=S.shiftRight,S.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):u(32===e?t:t>>>e-32,0,this.unsigned)},S.shru=S.shiftRightUnsigned,S.shr_u=S.shiftRightUnsigned,S.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},S.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},S.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},S.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},S.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},9593:(e,t,n)=>{"use strict";const r=n(4411),i=Symbol("max"),o=Symbol("length"),a=Symbol("lengthCalculator"),s=Symbol("allowStale"),u=Symbol("maxAge"),l=Symbol("dispose"),c=Symbol("noDisposeOnSet"),p=Symbol("lruList"),d=Symbol("cache"),h=Symbol("updateAgeOnGet"),f=()=>1,g=(e,t,n)=>{const r=e[d].get(t);if(r){const t=r.value;if(m(e,t)){if(b(e,r),!e[s])return}else n&&(e[h]&&(r.value.now=Date.now()),e[p].unshiftNode(r));return t.value}},m=(e,t)=>{if(!t||!t.maxAge&&!e[u])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[u]&&n>e[u]},y=e=>{if(e[o]>e[i])for(let t=e[p].tail;e[o]>e[i]&&null!==t;){const n=t.prev;b(e,t),t=n}},b=(e,t)=>{if(t){const n=t.value;e[l]&&e[l](n.key,n.value),e[o]-=n.length,e[d].delete(n.key),e[p].removeNode(t)}};class v{constructor(e,t,n,r,i){this.key=e,this.value=t,this.length=n,this.now=r,this.maxAge=i||0}}const x=(e,t,n,r)=>{let i=n.value;m(e,i)&&(b(e,n),e[s]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};e.exports=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[i]=e.max||1/0;const t=e.length||f;if(this[a]="function"!=typeof t?f:t,this[s]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[u]=e.maxAge||0,this[l]=e.dispose,this[c]=e.noDisposeOnSet||!1,this[h]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[i]=e||1/0,y(this)}get max(){return this[i]}set allowStale(e){this[s]=!!e}get allowStale(){return this[s]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[u]=e,y(this)}get maxAge(){return this[u]}set lengthCalculator(e){"function"!=typeof e&&(e=f),e!==this[a]&&(this[a]=e,this[o]=0,this[p].forEach((e=>{e.length=this[a](e.value,e.key),this[o]+=e.length}))),y(this)}get lengthCalculator(){return this[a]}get length(){return this[o]}get itemCount(){return this[p].length}rforEach(e,t){t=t||this;for(let n=this[p].tail;null!==n;){const r=n.prev;x(this,e,n,t),n=r}}forEach(e,t){t=t||this;for(let n=this[p].head;null!==n;){const r=n.next;x(this,e,n,t),n=r}}keys(){return this[p].toArray().map((e=>e.key))}values(){return this[p].toArray().map((e=>e.value))}reset(){this[l]&&this[p]&&this[p].length&&this[p].forEach((e=>this[l](e.key,e.value))),this[d]=new Map,this[p]=new r,this[o]=0}dump(){return this[p].map((e=>!m(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[p]}set(e,t,n){if((n=n||this[u])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,s=this[a](t,e);if(this[d].has(e)){if(s>this[i])return b(this,this[d].get(e)),!1;const a=this[d].get(e).value;return this[l]&&(this[c]||this[l](e,a.value)),a.now=r,a.maxAge=n,a.value=t,this[o]+=s-a.length,a.length=s,this.get(e),y(this),!0}const h=new v(e,t,s,r,n);return h.length>this[i]?(this[l]&&this[l](e,t),!1):(this[o]+=h.length,this[p].unshift(h),this[d].set(e,this[p].head),y(this),!0)}has(e){if(!this[d].has(e))return!1;const t=this[d].get(e).value;return!m(this,t)}get(e){return g(this,e,!0)}peek(e){return g(this,e,!1)}pop(){const e=this[p].tail;return e?(b(this,e),e.value):null}del(e){b(this,this[d].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const r=e[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const e=i-t;e>0&&this.set(r.k,r.v,e)}}}prune(){this[d].forEach(((e,t)=>g(this,t,!1)))}}},7418:e=>{"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,i){for(var o,a,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),u=1;u<arguments.length;u++){for(var l in o=Object(arguments[u]))n.call(o,l)&&(s[l]=o[l]);if(t){a=t(o);for(var c=0;c<a.length;c++)r.call(o,a[c])&&(s[a[c]]=o[a[c]])}}return s}},9674:(e,t,n)=>{"use strict";function r(){}n.r(t),n.d(t,{Component:()=>B,cloneElement:()=>c,createElement:()=>s,default:()=>P,h:()=>s,options:()=>i,render:()=>L,rerender:()=>f});var i={},o=[],a=[];function s(e,t){var n,s,u,l,c=a;for(l=arguments.length;l-- >2;)o.push(arguments[l]);for(t&&null!=t.children&&(o.length||o.push(t.children),delete t.children);o.length;)if((s=o.pop())&&void 0!==s.pop)for(l=s.length;l--;)o.push(s[l]);else"boolean"==typeof s&&(s=null),(u="function"!=typeof e)&&(null==s?s="":"number"==typeof s?s=String(s):"string"!=typeof s&&(u=!1)),u&&n?c[c.length-1]+=s:c===a?c=[s]:c.push(s),n=u;var p=new r;return p.nodeName=e,p.children=c,p.attributes=null==t?void 0:t,p.key=null==t?void 0:t.key,void 0!==i.vnode&&i.vnode(p),p}function u(e,t){for(var n in t)e[n]=t[n];return e}var l="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function c(e,t){return s(e.nodeName,u(u({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var p=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,d=[];function h(e){!e._dirty&&(e._dirty=!0)&&1==d.push(e)&&(i.debounceRendering||l)(f)}function f(){var e,t=d;for(d=[];e=t.pop();)e._dirty&&D(e)}function g(e,t,n){return"string"==typeof t||"number"==typeof t?void 0!==e.splitText:"string"==typeof t.nodeName?!e._componentConstructor&&m(e,t.nodeName):n||e._componentConstructor===t.nodeName}function m(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function y(e){var t=u({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===t[r]&&(t[r]=n[r]);return t}function b(e){var t=e.parentNode;t&&t.removeChild(e)}function v(e,t,n,r,i){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)n&&n(null),r&&r(e);else if("class"!==t||i)if("style"===t){if(r&&"string"!=typeof r&&"string"!=typeof n||(e.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var o in n)o in r||(e.style[o]="");for(var o in r)e.style[o]="number"==typeof r[o]&&!1===p.test(o)?r[o]+"px":r[o]}}else if("dangerouslySetInnerHTML"===t)r&&(e.innerHTML=r.__html||"");else if("o"==t[0]&&"n"==t[1]){var a=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,x,a):e.removeEventListener(t,x,a),(e._listeners||(e._listeners={}))[t]=r}else if("list"!==t&&"type"!==t&&!i&&t in e)!function(e,t,n){try{e[t]=n}catch(e){}}(e,t,null==r?"":r),null!=r&&!1!==r||e.removeAttribute(t);else{var s=i&&t!==(t=t.replace(/^xlink:?/,""));null==r||!1===r?s?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof r&&(s?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}else e.className=r||""}function x(e){return this._listeners[e.type](i.event&&i.event(e)||e)}var _=[],w=0,k=!1,S=!1;function C(){for(var e;e=_.pop();)i.afterMount&&i.afterMount(e),e.componentDidMount&&e.componentDidMount()}function M(e,t,n,r,i,o){w++||(k=null!=i&&void 0!==i.ownerSVGElement,S=null!=e&&!("__preactattr_"in e));var a=T(e,t,n,r,o);return i&&a.parentNode!==i&&i.appendChild(a),--w||(S=!1,o||C()),a}function T(e,t,n,r,i){var o=e,a=k;if(null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||i)?e.nodeValue!=t&&(e.nodeValue=t):(o=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(o,e),E(e,!0))),o.__preactattr_=!0,o;var s,u,l=t.nodeName;if("function"==typeof l)return function(e,t,n,r){for(var i=e&&e._component,o=i,a=e,s=i&&e._componentConstructor===t.nodeName,u=s,l=y(t);i&&!u&&(i=i._parentComponent);)u=i.constructor===t.nodeName;return i&&u&&(!r||i._component)?(N(i,l,3,n,r),e=i.base):(o&&!s&&(I(o),e=a=null),i=O(t.nodeName,l,n),e&&!i.nextBase&&(i.nextBase=e,a=null),N(i,l,1,n,r),e=i.base,a&&e!==a&&(a._component=null,E(a,!1))),e}(e,t,n,r);if(k="svg"===l||"foreignObject"!==l&&k,l=String(l),(!e||!m(e,l))&&(s=l,(u=k?document.createElementNS("http://www.w3.org/2000/svg",s):document.createElement(s)).normalizedNodeName=s,o=u,e)){for(;e.firstChild;)o.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(o,e),E(e,!0)}var c=o.firstChild,p=o.__preactattr_,d=t.children;if(null==p){p=o.__preactattr_={};for(var h=o.attributes,f=h.length;f--;)p[h[f].name]=h[f].value}return!S&&d&&1===d.length&&"string"==typeof d[0]&&null!=c&&void 0!==c.splitText&&null==c.nextSibling?c.nodeValue!=d[0]&&(c.nodeValue=d[0]):(d&&d.length||null!=c)&&function(e,t,n,r,i){var o,a,s,u,l,c=e.childNodes,p=[],d={},h=0,f=0,m=c.length,y=0,v=t?t.length:0;if(0!==m)for(var x=0;x<m;x++){var _=c[x],w=_.__preactattr_;null!=(k=v&&w?_._component?_._component.__key:w.key:null)?(h++,d[k]=_):(w||(void 0!==_.splitText?!i||_.nodeValue.trim():i))&&(p[y++]=_)}if(0!==v)for(x=0;x<v;x++){var k;if(l=null,null!=(k=(u=t[x]).key))h&&void 0!==d[k]&&(l=d[k],d[k]=void 0,h--);else if(!l&&f<y)for(o=f;o<y;o++)if(void 0!==p[o]&&g(a=p[o],u,i)){l=a,p[o]=void 0,o===y-1&&y--,o===f&&f++;break}l=T(l,u,n,r),s=c[x],l&&l!==e&&l!==s&&(null==s?e.appendChild(l):l===s.nextSibling?b(s):e.insertBefore(l,s))}if(h)for(var x in d)void 0!==d[x]&&E(d[x],!1);for(;f<=y;)void 0!==(l=p[y--])&&E(l,!1)}(o,d,n,r,S||null!=p.dangerouslySetInnerHTML),function(e,t,n){var r;for(r in n)t&&null!=t[r]||null==n[r]||v(e,r,n[r],n[r]=void 0,k);for(r in t)"children"===r||"innerHTML"===r||r in n&&t[r]===("value"===r||"checked"===r?e[r]:n[r])||v(e,r,n[r],n[r]=t[r],k)}(o,t.attributes,p),k=a,o}function E(e,t){var n=e._component;n?I(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||b(e),A(e))}function A(e){for(e=e.lastChild;e;){var t=e.previousSibling;E(e,!0),e=t}}var F={};function O(e,t,n){var r,i=F[e.name];if(e.prototype&&e.prototype.render?(r=new e(t,n),B.call(r,t,n)):((r=new B(t,n)).constructor=e,r.render=R),i)for(var o=i.length;o--;)if(i[o].constructor===e){r.nextBase=i[o].nextBase,i.splice(o,1);break}return r}function R(e,t,n){return this.constructor(e,n)}function N(e,t,n,r,o){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||o?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==n&&(1!==n&&!1===i.syncComponentUpdates&&e.base?h(e):D(e,1,o)),e.__ref&&e.__ref(e))}function D(e,t,n,r){if(!e._disable){var o,a,s,l=e.props,c=e.state,p=e.context,d=e.prevProps||l,h=e.prevState||c,f=e.prevContext||p,g=e.base,m=e.nextBase,b=g||m,v=e._component,x=!1;if(g&&(e.props=d,e.state=h,e.context=f,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(l,c,p)?x=!0:e.componentWillUpdate&&e.componentWillUpdate(l,c,p),e.props=l,e.state=c,e.context=p),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!x){o=e.render(l,c,p),e.getChildContext&&(p=u(u({},p),e.getChildContext()));var k,S,T=o&&o.nodeName;if("function"==typeof T){var A=y(o);(a=v)&&a.constructor===T&&A.key==a.__key?N(a,A,1,p,!1):(k=a,e._component=a=O(T,A,p),a.nextBase=a.nextBase||m,a._parentComponent=e,N(a,A,0,p,!1),D(a,1,n,!0)),S=a.base}else s=b,(k=v)&&(s=e._component=null),(b||1===t)&&(s&&(s._component=null),S=M(s,o,p,n||!g,b&&b.parentNode,!0));if(b&&S!==b&&a!==v){var F=b.parentNode;F&&S!==F&&(F.replaceChild(S,b),k||(b._component=null,E(b,!1)))}if(k&&I(k),e.base=S,S&&!r){for(var R=e,B=e;B=B._parentComponent;)(R=B).base=S;S._component=R,S._componentConstructor=R.constructor}}if(!g||n?_.unshift(e):x||(e.componentDidUpdate&&e.componentDidUpdate(d,h,f),i.afterUpdate&&i.afterUpdate(e)),null!=e._renderCallbacks)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);w||r||C()}}function I(e){i.beforeUnmount&&i.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?I(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,b(t),function(e){var t=e.constructor.name;(F[t]||(F[t]=[])).push(e)}(e),A(t)),e.__ref&&e.__ref(null)}function B(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}function L(e,t,n){return M(n,e,{},!1,t,!1)}u(B.prototype,{setState:function(e,t){var n=this.state;this.prevState||(this.prevState=u({},n)),u(n,"function"==typeof e?e(n,this.props):e),t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),h(this)},forceUpdate:function(e){e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),D(this,2)},render:function(){}});const P={h:s,createElement:s,cloneElement:c,Component:B,render:L,rerender:f,options:i}},6377:(e,t,n)=>{var r=n(4832),i=n(8652),o=n(801),a=n(2030),s=n(3618),u=n(9049),l=n(1971);l.alea=r,l.xor128=i,l.xorwow=o,l.xorshift7=a,l.xor4096=s,l.tychei=u,e.exports=l},4832:function(e,t,n){var r;!function(e,i,o){function a(e){var t,n=this,r=(t=4022871197,function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function u(e,t){var n=new a(e),r=t&&t.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,i))||(i.exports=r):this.alea=u}(0,e=n.nmd(e),n.amdD)},9049:function(e,t,n){var r;!function(e,i,o){function a(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,i=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function u(e,t){var n=new a(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,i))||(i.exports=r):this.tychei=u}(0,e=n.nmd(e),n.amdD)},8652:function(e,t,n){var r;!function(e,i,o){function a(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function u(e,t){var n=new a(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,i))||(i.exports=r):this.xor128=u}(0,e=n.nmd(e),n.amdD)},3618:function(e,t,n){var r;!function(e,i,o){function a(e){var t=this;t.next=function(){var e,n,r=t.w,i=t.X,o=t.i;return t.w=r=r+1640531527|0,n=i[o+34&127],e=i[o=o+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=i[o]=n^e,t.i=o,n+(r^r>>>16)|0},function(e,t){var n,r,i,o,a,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),i=0,o=-32;o<u;++o)t&&(r^=t.charCodeAt((o+32)%t.length)),0===o&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(a=a+1640531527|0,i=0==(n=s[127&o]^=r+a)?i+1:0);for(i>=128&&(s[127&(t&&t.length||0)]=-1),i=127,o=512;o>0;--o)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;e.w=a,e.X=s,e.i=i}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function u(e,t){null==e&&(e=+new Date);var n=new a(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&(r.X&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,i))||(i.exports=r):this.xor4096=u}(0,e=n.nmd(e),n.amdD)},2030:function(e,t,n){var r;!function(e,i,o){function a(e){var t=this;t.next=function(){var e,n,r=t.x,i=t.i;return e=r[i],n=(e^=e>>>7)^e<<24,n^=(e=r[i+1&7])^e>>>10,n^=(e=r[i+3&7])^e>>>3,n^=(e=r[i+4&7])^e<<7,e=r[i+7&7],n^=(e^=e<<13)^e<<9,r[i]=n,t.i=i+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function u(e,t){null==e&&(e=+new Date);var n=new a(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&(r.x&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,i))||(i.exports=r):this.xorshift7=u}(0,e=n.nmd(e),n.amdD)},801:function(e,t,n){var r;!function(e,i,o){function a(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function u(e,t){var n=new a(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,i))||(i.exports=r):this.xorwow=u}(0,e=n.nmd(e),n.amdD)},1971:function(e,t,n){var r;!function(i,o,a){var s,u=256,l=a.pow(u,6),c=a.pow(2,52),p=2*c,d=u-1;function h(e,t,n){var r=[],d=y(m((t=1==t?{entropy:!0}:t||{}).entropy?[e,b(o)]:null==e?function(){try{var e;return s&&(e=s.randomBytes)?e=e(u):(e=new Uint8Array(u),(i.crypto||i.msCrypto).getRandomValues(e)),b(e)}catch(e){var t=i.navigator,n=t&&t.plugins;return[+new Date,i,n,i.screen,b(o)]}}():e,3),r),h=new f(r),v=function(){for(var e=h.g(6),t=l,n=0;e<c;)e=(e+n)*u,t*=u,n=h.g(1);for(;e>=p;)e/=2,t/=2,n>>>=1;return(e+n)/t};return v.int32=function(){return 0|h.g(4)},v.quick=function(){return h.g(4)/4294967296},v.double=v,y(b(h.S),o),(t.pass||n||function(e,t,n,r){return r&&(r.S&&g(r,h),e.state=function(){return g(h,{})}),n?(a.random=e,t):e})(v,d,"global"in t?t.global:this==a,t.state)}function f(e){var t,n=e.length,r=this,i=0,o=r.i=r.j=0,a=r.S=[];for(n||(e=[n++]);i<u;)a[i]=i++;for(i=0;i<u;i++)a[i]=a[o=d&o+e[i%n]+(t=a[i])],a[o]=t;(r.g=function(e){for(var t,n=0,i=r.i,o=r.j,a=r.S;e--;)t=a[i=d&i+1],n=n*u+a[d&(a[i]=a[o=d&o+t])+(a[o]=t)];return r.i=i,r.j=o,n})(u)}function g(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){var n,r=[],i=typeof e;if(t&&"object"==i)for(n in e)try{r.push(m(e[n],t-1))}catch(e){}return r.length?r:"string"==i?e:e+"\0"}function y(e,t){for(var n,r=e+"",i=0;i<r.length;)t[d&i]=d&(n^=19*t[d&i])+r.charCodeAt(i++);return b(t)}function b(e){return String.fromCharCode.apply(0,e)}if(y(a.random(),o),e.exports){e.exports=h;try{s=n(5042)}catch(e){}}else void 0===(r=function(){return h}.call(t,n,t,e))||(e.exports=r)}("undefined"!=typeof self?self:this,[],Math)},2257:(e,t,n)=>{const r=Symbol("SemVer ANY");class i{static get ANY(){return r}constructor(e,t){if(t=o(t),e instanceof i){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),l("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===r?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){const t=this.options.loose?a[s.COMPARATORLOOSE]:a[s.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new c(n[2],this.options.loose):this.semver=r}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===r||e===r)return!0;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}return u(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof i))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new p(e.value,t).test(this.value):""===e.operator?""===e.value||new p(this.value,t).test(e.semver):!((t=o(t)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(u(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(u(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}e.exports=i;const o=n(2893),{safeRe:a,t:s}=n(5765),u=n(7539),l=n(4225),c=n(6376),p=n(6902)},6902:(e,t,n)=>{class r{constructor(e,t){if(t=o(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof a)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!m(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&y(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&f)|(this.options.loose&&g))+":"+e,n=i.get(t);if(n)return n;const r=this.options.loose,o=r?l[c.HYPHENRANGELOOSE]:l[c.HYPHENRANGE];e=e.replace(o,A(this.options.includePrerelease)),s("hyphen replace",e),e=e.replace(l[c.COMPARATORTRIM],p),s("comparator trim",e),e=e.replace(l[c.TILDETRIM],d),s("tilde trim",e),e=e.replace(l[c.CARETTRIM],h),s("caret trim",e);let u=e.split(" ").map((e=>v(e,this.options))).join(" ").split(/\s+/).map((e=>E(e,this.options)));r&&(u=u.filter((e=>(s("loose invalid filter",e,this.options),!!e.match(l[c.COMPARATORLOOSE]))))),s("range list",u);const y=new Map,b=u.map((e=>new a(e,this.options)));for(const e of b){if(m(e))return[e];y.set(e.value,e)}y.size>1&&y.has("")&&y.delete("");const x=[...y.values()];return i.set(t,x),x}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Range is required");return this.set.some((n=>b(n,t)&&e.set.some((e=>b(e,t)&&n.every((n=>e.every((e=>n.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(F(this.set[t],e,this.options))return!0;return!1}}e.exports=r;const i=new(n(9593))({max:1e3}),o=n(2893),a=n(2257),s=n(4225),u=n(6376),{safeRe:l,t:c,comparatorTrimReplace:p,tildeTrimReplace:d,caretTrimReplace:h}=n(5765),{FLAG_INCLUDE_PRERELEASE:f,FLAG_LOOSE:g}=n(3295),m=e=>"<0.0.0-0"===e.value,y=e=>""===e.value,b=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every((e=>i.intersects(e,t))),i=r.pop();return n},v=(e,t)=>(s("comp",e,t),e=k(e,t),s("caret",e),e=_(e,t),s("tildes",e),e=C(e,t),s("xrange",e),e=T(e,t),s("stars",e),e),x=e=>!e||"x"===e.toLowerCase()||"*"===e,_=(e,t)=>e.trim().split(/\s+/).map((e=>w(e,t))).join(" "),w=(e,t)=>{const n=t.loose?l[c.TILDELOOSE]:l[c.TILDE];return e.replace(n,((t,n,r,i,o)=>{let a;return s("tilde",e,t,n,r,i,o),x(n)?a="":x(r)?a=`>=${n}.0.0 <${+n+1}.0.0-0`:x(i)?a=`>=${n}.${r}.0 <${n}.${+r+1}.0-0`:o?(s("replaceTilde pr",o),a=`>=${n}.${r}.${i}-${o} <${n}.${+r+1}.0-0`):a=`>=${n}.${r}.${i} <${n}.${+r+1}.0-0`,s("tilde return",a),a}))},k=(e,t)=>e.trim().split(/\s+/).map((e=>S(e,t))).join(" "),S=(e,t)=>{s("caret",e,t);const n=t.loose?l[c.CARETLOOSE]:l[c.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,((t,n,i,o,a)=>{let u;return s("caret",e,t,n,i,o,a),x(n)?u="":x(i)?u=`>=${n}.0.0${r} <${+n+1}.0.0-0`:x(o)?u="0"===n?`>=${n}.${i}.0${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.0${r} <${+n+1}.0.0-0`:a?(s("replaceCaret pr",a),u="0"===n?"0"===i?`>=${n}.${i}.${o}-${a} <${n}.${i}.${+o+1}-0`:`>=${n}.${i}.${o}-${a} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${o}-${a} <${+n+1}.0.0-0`):(s("no pr"),u="0"===n?"0"===i?`>=${n}.${i}.${o}${r} <${n}.${i}.${+o+1}-0`:`>=${n}.${i}.${o}${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${o} <${+n+1}.0.0-0`),s("caret return",u),u}))},C=(e,t)=>(s("replaceXRanges",e,t),e.split(/\s+/).map((e=>M(e,t))).join(" ")),M=(e,t)=>{e=e.trim();const n=t.loose?l[c.XRANGELOOSE]:l[c.XRANGE];return e.replace(n,((n,r,i,o,a,u)=>{s("xRange",e,n,r,i,o,a,u);const l=x(i),c=l||x(o),p=c||x(a),d=p;return"="===r&&d&&(r=""),u=t.includePrerelease?"-0":"",l?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&d?(c&&(o=0),a=0,">"===r?(r=">=",c?(i=+i+1,o=0,a=0):(o=+o+1,a=0)):"<="===r&&(r="<",c?i=+i+1:o=+o+1),"<"===r&&(u="-0"),n=`${r+i}.${o}.${a}${u}`):c?n=`>=${i}.0.0${u} <${+i+1}.0.0-0`:p&&(n=`>=${i}.${o}.0${u} <${i}.${+o+1}.0-0`),s("xRange return",n),n}))},T=(e,t)=>(s("replaceStars",e,t),e.trim().replace(l[c.STAR],"")),E=(e,t)=>(s("replaceGTE0",e,t),e.trim().replace(l[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),A=e=>(t,n,r,i,o,a,s,u,l,c,p,d,h)=>`${n=x(r)?"":x(i)?`>=${r}.0.0${e?"-0":""}`:x(o)?`>=${r}.${i}.0${e?"-0":""}`:a?`>=${n}`:`>=${n}${e?"-0":""}`} ${u=x(l)?"":x(c)?`<${+l+1}.0.0-0`:x(p)?`<${l}.${+c+1}.0-0`:d?`<=${l}.${c}.${p}-${d}`:e?`<${l}.${c}.${+p+1}-0`:`<=${u}`}`.trim(),F=(e,t,n)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(s(e[n].semver),e[n].semver!==a.ANY&&e[n].semver.prerelease.length>0){const r=e[n].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0}},6376:(e,t,n)=>{const r=n(4225),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=n(3295),{safeRe:a,t:s}=n(5765),u=n(2893),{compareIdentifiers:l}=n(6742);class c{constructor(e,t){if(t=u(t),e instanceof c){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?a[s.LOOSE]:a[s.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof c)){if("string"==typeof e&&e===this.version)return 0;e=new c(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof c||(e=new c(e,this.options)),l(this.major,e.major)||l(this.minor,e.minor)||l(this.patch,e.patch)}comparePre(e){if(e instanceof c||(e=new c(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return l(n,i)}while(++t)}compareBuild(e){e instanceof c||(e=new c(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return l(n,i)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let r=this.prerelease.length;for(;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let r=[t,e];!1===n&&(r=[t]),0===l(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=c},3507:(e,t,n)=>{const r=n(3959);e.exports=(e,t)=>{const n=r(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},7539:(e,t,n)=>{const r=n(8718),i=n(1194),o=n(1312),a=n(5903),s=n(1544),u=n(2056);e.exports=(e,t,n,l)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return r(e,n,l);case"!=":return i(e,n,l);case">":return o(e,n,l);case">=":return a(e,n,l);case"<":return s(e,n,l);case"<=":return u(e,n,l);default:throw new TypeError(`Invalid operator: ${t}`)}}},9038:(e,t,n)=>{const r=n(6376),i=n(3959),{safeRe:o,t:a}=n(5765);e.exports=(e,t)=>{if(e instanceof r)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let n=null;if((t=t||{}).rtl){let t;for(;(t=o[a.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&t.index+t[0].length===n.index+n[0].length||(n=t),o[a.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;o[a.COERCERTL].lastIndex=-1}else n=e.match(o[a.COERCE]);return null===n?null:i(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)}},8880:(e,t,n)=>{const r=n(6376);e.exports=(e,t,n)=>{const i=new r(e,n),o=new r(t,n);return i.compare(o)||i.compareBuild(o)}},7880:(e,t,n)=>{const r=n(6269);e.exports=(e,t)=>r(e,t,!0)},6269:(e,t,n)=>{const r=n(6376);e.exports=(e,t,n)=>new r(e,n).compare(new r(t,n))},2378:(e,t,n)=>{const r=n(3959);e.exports=(e,t)=>{const n=r(e,null,!0),i=r(t,null,!0),o=n.compare(i);if(0===o)return null;const a=o>0,s=a?n:i,u=a?i:n,l=!!s.prerelease.length;if(u.prerelease.length&&!l)return u.patch||u.minor?s.patch?"patch":s.minor?"minor":"major":"major";const c=l?"pre":"";return n.major!==i.major?c+"major":n.minor!==i.minor?c+"minor":n.patch!==i.patch?c+"patch":"prerelease"}},8718:(e,t,n)=>{const r=n(6269);e.exports=(e,t,n)=>0===r(e,t,n)},1312:(e,t,n)=>{const r=n(6269);e.exports=(e,t,n)=>r(e,t,n)>0},5903:(e,t,n)=>{const r=n(6269);e.exports=(e,t,n)=>r(e,t,n)>=0},253:(e,t,n)=>{const r=n(6376);e.exports=(e,t,n,i,o)=>{"string"==typeof n&&(o=i,i=n,n=void 0);try{return new r(e instanceof r?e.version:e,n).inc(t,i,o).version}catch(e){return null}}},1544:(e,t,n)=>{const r=n(6269);e.exports=(e,t,n)=>r(e,t,n)<0},2056:(e,t,n)=>{const r=n(6269);e.exports=(e,t,n)=>r(e,t,n)<=0},8679:(e,t,n)=>{const r=n(6376);e.exports=(e,t)=>new r(e,t).major},7789:(e,t,n)=>{const r=n(6376);e.exports=(e,t)=>new r(e,t).minor},1194:(e,t,n)=>{const r=n(6269);e.exports=(e,t,n)=>0!==r(e,t,n)},3959:(e,t,n)=>{const r=n(6376);e.exports=(e,t,n=!1)=>{if(e instanceof r)return e;try{return new r(e,t)}catch(e){if(!n)return null;throw e}}},2358:(e,t,n)=>{const r=n(6376);e.exports=(e,t)=>new r(e,t).patch},7559:(e,t,n)=>{const r=n(3959);e.exports=(e,t)=>{const n=r(e,t);return n&&n.prerelease.length?n.prerelease:null}},9795:(e,t,n)=>{const r=n(6269);e.exports=(e,t,n)=>r(t,e,n)},3657:(e,t,n)=>{const r=n(8880);e.exports=(e,t)=>e.sort(((e,n)=>r(n,e,t)))},5712:(e,t,n)=>{const r=n(6902);e.exports=(e,t,n)=>{try{t=new r(t,n)}catch(e){return!1}return t.test(e)}},1100:(e,t,n)=>{const r=n(8880);e.exports=(e,t)=>e.sort(((e,n)=>r(e,n,t)))},6397:(e,t,n)=>{const r=n(3959);e.exports=(e,t)=>{const n=r(e,t);return n?n.version:null}},1249:(e,t,n)=>{const r=n(5765),i=n(3295),o=n(6376),a=n(6742),s=n(3959),u=n(6397),l=n(3507),c=n(253),p=n(2378),d=n(8679),h=n(7789),f=n(2358),g=n(7559),m=n(6269),y=n(9795),b=n(7880),v=n(8880),x=n(1100),_=n(3657),w=n(1312),k=n(1544),S=n(8718),C=n(1194),M=n(5903),T=n(2056),E=n(7539),A=n(9038),F=n(2257),O=n(6902),R=n(5712),N=n(1042),D=n(5775),I=n(1657),B=n(5316),L=n(9042),P=n(6826),$=n(7606),z=n(32),j=n(2937),G=n(7908),U=n(799);e.exports={parse:s,valid:u,clean:l,inc:c,diff:p,major:d,minor:h,patch:f,prerelease:g,compare:m,rcompare:y,compareLoose:b,compareBuild:v,sort:x,rsort:_,gt:w,lt:k,eq:S,neq:C,gte:M,lte:T,cmp:E,coerce:A,Comparator:F,Range:O,satisfies:R,toComparators:N,maxSatisfying:D,minSatisfying:I,minVersion:B,validRange:L,outside:P,gtr:$,ltr:z,intersects:j,simplifyRange:G,subset:U,SemVer:o,re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:i.SEMVER_SPEC_VERSION,RELEASE_TYPES:i.RELEASE_TYPES,compareIdentifiers:a.compareIdentifiers,rcompareIdentifiers:a.rcompareIdentifiers}},3295:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},4225:e=>{const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},6742:e=>{const t=/^[0-9]+$/,n=(e,n)=>{const r=t.test(e),i=t.test(n);return r&&i&&(e=+e,n=+n),e===n?0:r&&!i?-1:i&&!r?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},2893:e=>{const t=Object.freeze({loose:!0}),n=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:n},5765:(e,t,n)=>{const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:o}=n(3295),a=n(4225),s=(t=e.exports={}).re=[],u=t.safeRe=[],l=t.src=[],c=t.t={};let p=0;const d="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",o],[d,i]],f=(e,t,n)=>{const r=(e=>{for(const[t,n]of h)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=p++;a(e,i,t),c[e]=i,l[i]=t,s[i]=new RegExp(t,n?"g":void 0),u[i]=new RegExp(r,n?"g":void 0)};f("NUMERICIDENTIFIER","0|[1-9]\\d*"),f("NUMERICIDENTIFIERLOOSE","\\d+"),f("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`),f("MAINVERSION",`(${l[c.NUMERICIDENTIFIER]})\\.(${l[c.NUMERICIDENTIFIER]})\\.(${l[c.NUMERICIDENTIFIER]})`),f("MAINVERSIONLOOSE",`(${l[c.NUMERICIDENTIFIERLOOSE]})\\.(${l[c.NUMERICIDENTIFIERLOOSE]})\\.(${l[c.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASEIDENTIFIER",`(?:${l[c.NUMERICIDENTIFIER]}|${l[c.NONNUMERICIDENTIFIER]})`),f("PRERELEASEIDENTIFIERLOOSE",`(?:${l[c.NUMERICIDENTIFIERLOOSE]}|${l[c.NONNUMERICIDENTIFIER]})`),f("PRERELEASE",`(?:-(${l[c.PRERELEASEIDENTIFIER]}(?:\\.${l[c.PRERELEASEIDENTIFIER]})*))`),f("PRERELEASELOOSE",`(?:-?(${l[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[c.PRERELEASEIDENTIFIERLOOSE]})*))`),f("BUILDIDENTIFIER",`${d}+`),f("BUILD",`(?:\\+(${l[c.BUILDIDENTIFIER]}(?:\\.${l[c.BUILDIDENTIFIER]})*))`),f("FULLPLAIN",`v?${l[c.MAINVERSION]}${l[c.PRERELEASE]}?${l[c.BUILD]}?`),f("FULL",`^${l[c.FULLPLAIN]}$`),f("LOOSEPLAIN",`[v=\\s]*${l[c.MAINVERSIONLOOSE]}${l[c.PRERELEASELOOSE]}?${l[c.BUILD]}?`),f("LOOSE",`^${l[c.LOOSEPLAIN]}$`),f("GTLT","((?:<|>)?=?)"),f("XRANGEIDENTIFIERLOOSE",`${l[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),f("XRANGEIDENTIFIER",`${l[c.NUMERICIDENTIFIER]}|x|X|\\*`),f("XRANGEPLAIN",`[v=\\s]*(${l[c.XRANGEIDENTIFIER]})(?:\\.(${l[c.XRANGEIDENTIFIER]})(?:\\.(${l[c.XRANGEIDENTIFIER]})(?:${l[c.PRERELEASE]})?${l[c.BUILD]}?)?)?`),f("XRANGEPLAINLOOSE",`[v=\\s]*(${l[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[c.XRANGEIDENTIFIERLOOSE]})(?:${l[c.PRERELEASELOOSE]})?${l[c.BUILD]}?)?)?`),f("XRANGE",`^${l[c.GTLT]}\\s*${l[c.XRANGEPLAIN]}$`),f("XRANGELOOSE",`^${l[c.GTLT]}\\s*${l[c.XRANGEPLAINLOOSE]}$`),f("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),f("COERCERTL",l[c.COERCE],!0),f("LONETILDE","(?:~>?)"),f("TILDETRIM",`(\\s*)${l[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",f("TILDE",`^${l[c.LONETILDE]}${l[c.XRANGEPLAIN]}$`),f("TILDELOOSE",`^${l[c.LONETILDE]}${l[c.XRANGEPLAINLOOSE]}$`),f("LONECARET","(?:\\^)"),f("CARETTRIM",`(\\s*)${l[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",f("CARET",`^${l[c.LONECARET]}${l[c.XRANGEPLAIN]}$`),f("CARETLOOSE",`^${l[c.LONECARET]}${l[c.XRANGEPLAINLOOSE]}$`),f("COMPARATORLOOSE",`^${l[c.GTLT]}\\s*(${l[c.LOOSEPLAIN]})$|^$`),f("COMPARATOR",`^${l[c.GTLT]}\\s*(${l[c.FULLPLAIN]})$|^$`),f("COMPARATORTRIM",`(\\s*)${l[c.GTLT]}\\s*(${l[c.LOOSEPLAIN]}|${l[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",f("HYPHENRANGE",`^\\s*(${l[c.XRANGEPLAIN]})\\s+-\\s+(${l[c.XRANGEPLAIN]})\\s*$`),f("HYPHENRANGELOOSE",`^\\s*(${l[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[c.XRANGEPLAINLOOSE]})\\s*$`),f("STAR","(<|>)?=?\\s*\\*"),f("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),f("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},7606:(e,t,n)=>{const r=n(6826);e.exports=(e,t,n)=>r(e,t,">",n)},2937:(e,t,n)=>{const r=n(6902);e.exports=(e,t,n)=>(e=new r(e,n),t=new r(t,n),e.intersects(t,n))},32:(e,t,n)=>{const r=n(6826);e.exports=(e,t,n)=>r(e,t,"<",n)},5775:(e,t,n)=>{const r=n(6376),i=n(6902);e.exports=(e,t,n)=>{let o=null,a=null,s=null;try{s=new i(t,n)}catch(e){return null}return e.forEach((e=>{s.test(e)&&(o&&-1!==a.compare(e)||(o=e,a=new r(o,n)))})),o}},1657:(e,t,n)=>{const r=n(6376),i=n(6902);e.exports=(e,t,n)=>{let o=null,a=null,s=null;try{s=new i(t,n)}catch(e){return null}return e.forEach((e=>{s.test(e)&&(o&&1!==a.compare(e)||(o=e,a=new r(o,n)))})),o}},5316:(e,t,n)=>{const r=n(6376),i=n(6902),o=n(1312);e.exports=(e,t)=>{e=new i(e,t);let n=new r("0.0.0");if(e.test(n))return n;if(n=new r("0.0.0-0"),e.test(n))return n;n=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let a=null;i.forEach((e=>{const t=new r(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":a&&!o(t,a)||(a=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!a||n&&!o(n,a)||(n=a)}return n&&e.test(n)?n:null}},6826:(e,t,n)=>{const r=n(6376),i=n(2257),{ANY:o}=i,a=n(6902),s=n(5712),u=n(1312),l=n(1544),c=n(2056),p=n(5903);e.exports=(e,t,n,d)=>{let h,f,g,m,y;switch(e=new r(e,d),t=new a(t,d),n){case">":h=u,f=c,g=l,m=">",y=">=";break;case"<":h=l,f=p,g=u,m="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(e,t,d))return!1;for(let n=0;n<t.set.length;++n){const r=t.set[n];let a=null,s=null;if(r.forEach((e=>{e.semver===o&&(e=new i(">=0.0.0")),a=a||e,s=s||e,h(e.semver,a.semver,d)?a=e:g(e.semver,s.semver,d)&&(s=e)})),a.operator===m||a.operator===y)return!1;if((!s.operator||s.operator===m)&&f(e,s.semver))return!1;if(s.operator===y&&g(e,s.semver))return!1}return!0}},7908:(e,t,n)=>{const r=n(5712),i=n(6269);e.exports=(e,t,n)=>{const o=[];let a=null,s=null;const u=e.sort(((e,t)=>i(e,t,n)));for(const e of u)r(e,t,n)?(s=e,a||(a=e)):(s&&o.push([a,s]),s=null,a=null);a&&o.push([a,null]);const l=[];for(const[e,t]of o)e===t?l.push(e):t||e!==u[0]?t?e===u[0]?l.push(`<=${t}`):l.push(`${e} - ${t}`):l.push(`>=${e}`):l.push("*");const c=l.join(" || "),p="string"==typeof t.raw?t.raw:String(t);return c.length<p.length?c:t}},799:(e,t,n)=>{const r=n(6902),i=n(2257),{ANY:o}=i,a=n(5712),s=n(6269),u=[new i(">=0.0.0-0")],l=[new i(">=0.0.0")],c=(e,t,n)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===o){if(1===t.length&&t[0].semver===o)return!0;e=n.includePrerelease?u:l}if(1===t.length&&t[0].semver===o){if(n.includePrerelease)return!0;t=l}const r=new Set;let i,c,h,f,g,m,y;for(const t of e)">"===t.operator||">="===t.operator?i=p(i,t,n):"<"===t.operator||"<="===t.operator?c=d(c,t,n):r.add(t.semver);if(r.size>1)return null;if(i&&c){if(h=s(i.semver,c.semver,n),h>0)return null;if(0===h&&(">="!==i.operator||"<="!==c.operator))return null}for(const e of r){if(i&&!a(e,String(i),n))return null;if(c&&!a(e,String(c),n))return null;for(const r of t)if(!a(e,String(r),n))return!1;return!0}let b=!(!c||n.includePrerelease||!c.semver.prerelease.length)&&c.semver,v=!(!i||n.includePrerelease||!i.semver.prerelease.length)&&i.semver;b&&1===b.prerelease.length&&"<"===c.operator&&0===b.prerelease[0]&&(b=!1);for(const e of t){if(y=y||">"===e.operator||">="===e.operator,m=m||"<"===e.operator||"<="===e.operator,i)if(v&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===v.major&&e.semver.minor===v.minor&&e.semver.patch===v.patch&&(v=!1),">"===e.operator||">="===e.operator){if(f=p(i,e,n),f===e&&f!==i)return!1}else if(">="===i.operator&&!a(i.semver,String(e),n))return!1;if(c)if(b&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===b.major&&e.semver.minor===b.minor&&e.semver.patch===b.patch&&(b=!1),"<"===e.operator||"<="===e.operator){if(g=d(c,e,n),g===e&&g!==c)return!1}else if("<="===c.operator&&!a(c.semver,String(e),n))return!1;if(!e.operator&&(c||i)&&0!==h)return!1}return!(i&&m&&!c&&0!==h||c&&y&&!i&&0!==h||v||b)},p=(e,t,n)=>{if(!e)return t;const r=s(e.semver,t.semver,n);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},d=(e,t,n)=>{if(!e)return t;const r=s(e.semver,t.semver,n);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,n={})=>{if(e===t)return!0;e=new r(e,n),t=new r(t,n);let i=!1;e:for(const r of e.set){for(const e of t.set){const t=c(r,e,n);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},1042:(e,t,n)=>{const r=n(6902);e.exports=(e,t)=>new r(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},9042:(e,t,n)=>{const r=n(6902);e.exports=(e,t)=>{try{return new r(e,t).range||"*"}catch(e){return null}}},7887:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DEFAULT_ACTIONS:()=>LXe,default:()=>qXe,guessMode:()=>UXe,vega:()=>DXe,vegaLite:()=>IXe});var r={};n.r(r),n.d(r,{JsonPatchError:()=>I,_areEquals:()=>V,applyOperation:()=>z,applyPatch:()=>j,applyReducer:()=>G,deepClone:()=>B,getValueByPointer:()=>$,validate:()=>W,validator:()=>U});var i={};n.r(i),n.d(i,{compare:()=>Q,generate:()=>J,observe:()=>K,unobserve:()=>Y});var o={};n.r(o),n.d(o,{aggregate:()=>uc,bin:()=>lc,collect:()=>pc,compare:()=>dc,countpattern:()=>fc,cross:()=>gc,density:()=>vc,dotbin:()=>Sc,expression:()=>Cc,extent:()=>Tc,facet:()=>Ac,field:()=>Fc,filter:()=>Rc,flatten:()=>Nc,fold:()=>Dc,formula:()=>Ic,generate:()=>Bc,impute:()=>$c,joinaggregate:()=>zc,kde:()=>jc,key:()=>Gc,load:()=>Wc,lookup:()=>Hc,multiextent:()=>qc,multivalues:()=>Yc,params:()=>Jc,pivot:()=>Zc,prefacet:()=>Qc,project:()=>ep,proxy:()=>tp,quantile:()=>np,relay:()=>rp,sample:()=>ip,sequence:()=>op,sieve:()=>ap,subflow:()=>Ec,timeunit:()=>sp,tupleindex:()=>lp,values:()=>cp,window:()=>gp});var a={};n.r(a),n.d(a,{interpolate:()=>Mb,interpolateArray:()=>bb,interpolateBasis:()=>ab,interpolateBasisClosed:()=>sb,interpolateCubehelix:()=>kv,interpolateCubehelixLong:()=>Sv,interpolateDate:()=>xb,interpolateDiscrete:()=>Eb,interpolateHcl:()=>cv,interpolateHclLong:()=>pv,interpolateHsl:()=>jb,interpolateHslLong:()=>Gb,interpolateHue:()=>Ab,interpolateLab:()=>uv,interpolateNumber:()=>_b,interpolateNumberArray:()=>mb,interpolateObject:()=>wb,interpolateRgb:()=>db,interpolateRgbBasis:()=>fb,interpolateRgbBasisClosed:()=>gb,interpolateRound:()=>Fb,interpolateString:()=>Cb,interpolateTransformCss:()=>Bb,interpolateTransformSvg:()=>Lb,interpolateZoom:()=>$b,piecewise:()=>Tb,quantize:()=>Cv});var s={};n.r(s),n.d(s,{bound:()=>LC,identifier:()=>zC,mark:()=>jC,overlap:()=>GC,render:()=>YC,viewlayout:()=>mM});var u={};n.r(u),n.d(u,{axisticks:()=>vT,datajoin:()=>xT,encode:()=>wT,legendentries:()=>kT,linkpath:()=>ET,pie:()=>NT,scale:()=>BT,sortitems:()=>zT,stack:()=>VT});var l={};n.r(l),n.d(l,{contour:()=>dN,geojson:()=>gN,geopath:()=>mN,geopoint:()=>yN,geoshape:()=>bN,graticule:()=>vN,heatmap:()=>xN,isocontour:()=>nN,kde2d:()=>lN,projection:()=>wN});var c={};n.r(c),n.d(c,{force:()=>yD});var p={};n.r(p),n.d(p,{nest:()=>mI,pack:()=>wI,partition:()=>SI,stratify:()=>CI,tree:()=>EI,treelinks:()=>AI,treemap:()=>RI});var d={};n.r(d),n.d(d,{label:()=>nB});var h={};n.r(h),n.d(h,{loess:()=>iB,regression:()=>aB});var f={};n.r(f),n.d(f,{voronoi:()=>AB});var g={};n.r(g),n.d(g,{wordcloud:()=>WB});var m={};n.r(m),n.d(m,{crossfilter:()=>tL,resolvefilter:()=>nL});var y={};n.r(y),n.d(y,{interpolate:()=>fK,interpolateArray:()=>aK,interpolateBasis:()=>XY,interpolateBasisClosed:()=>YY,interpolateCubehelix:()=>nZ,interpolateCubehelixLong:()=>rZ,interpolateDate:()=>uK,interpolateDiscrete:()=>lJ,interpolateHcl:()=>UJ,interpolateHclLong:()=>WJ,interpolateHsl:()=>_J,interpolateHslLong:()=>wJ,interpolateHue:()=>cJ,interpolateLab:()=>jJ,interpolateNumber:()=>lK,interpolateNumberArray:()=>iK,interpolateObject:()=>cK,interpolateRgb:()=>eK,interpolateRgbBasis:()=>nK,interpolateRgbBasisClosed:()=>rK,interpolateRound:()=>gK,interpolateString:()=>hK,interpolateTransformCss:()=>mJ,interpolateTransformSvg:()=>yJ,interpolateZoom:()=>vJ,piecewise:()=>rJ,quantize:()=>iZ});var b={};n.r(b),n.d(b,{interpolate:()=>bT,interpolateArray:()=>cT,interpolateBasis:()=>ZM,interpolateBasisClosed:()=>QM,interpolateCubehelix:()=>b7,interpolateCubehelixLong:()=>v7,interpolateDate:()=>dT,interpolateDiscrete:()=>C5,interpolateHcl:()=>o7,interpolateHclLong:()=>a7,interpolateHsl:()=>L5,interpolateHslLong:()=>P5,interpolateHue:()=>M5,interpolateLab:()=>r7,interpolateNumber:()=>hT,interpolateNumberArray:()=>uT,interpolateObject:()=>fT,interpolateRgb:()=>iT,interpolateRgbBasis:()=>aT,interpolateRgbBasisClosed:()=>sT,interpolateRound:()=>bM,interpolateString:()=>yT,interpolateTransformCss:()=>R5,interpolateTransformSvg:()=>N5,interpolateZoom:()=>I5,piecewise:()=>w5,quantize:()=>x7});var v={};n.r(v),n.d(v,{interpolate:()=>_de,interpolateArray:()=>hde,interpolateBasis:()=>tde,interpolateBasisClosed:()=>nde,interpolateCubehelix:()=>Wme,interpolateCubehelixLong:()=>Vme,interpolateDate:()=>gde,interpolateDiscrete:()=>Jge,interpolateHcl:()=>Ome,interpolateHclLong:()=>Rme,interpolateHsl:()=>lme,interpolateHslLong:()=>cme,interpolateHue:()=>Zge,interpolateLab:()=>Ame,interpolateNumber:()=>mde,interpolateNumberArray:()=>pde,interpolateObject:()=>yde,interpolateRgb:()=>sde,interpolateRgbBasis:()=>lde,interpolateRgbBasisClosed:()=>cde,interpolateRound:()=>wde,interpolateString:()=>xde,interpolateTransformCss:()=>ime,interpolateTransformSvg:()=>ome,interpolateZoom:()=>sme,piecewise:()=>Vge,quantize:()=>Hme});var x={};n.r(x),n.d(x,{Bounds:()=>KQ,CanvasHandler:()=>M2,CanvasRenderer:()=>O2,DATE:()=>u$,DAY:()=>l$,DAYOFYEAR:()=>c$,Dataflow:()=>zu,Debug:()=>ke,Error:()=>xe,EventStream:()=>Mu,Gradient:()=>rQ,GroupItem:()=>ZQ,HOURS:()=>p$,Handler:()=>u2,Info:()=>we,Item:()=>JQ,MILLISECONDS:()=>f$,MINUTES:()=>d$,MONTH:()=>a$,Marks:()=>H1,MultiPulse:()=>Bu,None:()=>ve,Operator:()=>ku,Parameters:()=>xu,Pulse:()=>Ru,QUARTER:()=>o$,RenderType:()=>_3,Renderer:()=>c2,ResourceLoader:()=>QQ,SECONDS:()=>h$,SVGHandler:()=>N2,SVGRenderer:()=>i3,SVGStringRenderer:()=>b3,Scenegraph:()=>e2,TIME_UNITS:()=>g$,Transform:()=>Gu,View:()=>Lse,WEEK:()=>s$,Warn:()=>_e,YEAR:()=>i$,accessor:()=>re,accessorFields:()=>oe,accessorName:()=>ie,array:()=>Ke,ascending:()=>tt,bandwidthNRD:()=>aL,bin:()=>sL,bootstrapCI:()=>cL,boundClip:()=>A3,boundContext:()=>x0,boundItem:()=>q1,boundMark:()=>Y1,boundStroke:()=>n0,changeset:()=>bu,clampRange:()=>Je,codegenExpression:()=>lOe,compare:()=>et,constant:()=>ot,cumulativeLogNormal:()=>CL,cumulativeNormal:()=>vL,cumulativeUniform:()=>OL,dayofyear:()=>w$,debounce:()=>at,defaultLocale:()=>ale,definition:()=>Wu,densityLogNormal:()=>SL,densityNormal:()=>bL,densityUniform:()=>FL,domChild:()=>i2,domClear:()=>o2,domCreate:()=>n2,domFind:()=>r2,dotbin:()=>pL,error:()=>le,expressionFunction:()=>eCe,extend:()=>st,extent:()=>ut,extentIndex:()=>lt,falsy:()=>ye,fastmap:()=>ht,field:()=>pe,flush:()=>ft,font:()=>P1,fontFamily:()=>L1,fontSize:()=>R1,format:()=>JU,formatLocale:()=>Zue,formats:()=>ZU,hasOwnProperty:()=>pt,id:()=>de,identity:()=>he,inferType:()=>WU,inferTypes:()=>VU,ingest:()=>du,inherits:()=>gt,inrange:()=>mt,interpolate:()=>N8,interpolateColors:()=>O8,interpolateRange:()=>F8,intersect:()=>S3,intersectBoxLine:()=>O0,intersectPath:()=>T0,intersectPoint:()=>E0,intersectRule:()=>F0,isArray:()=>Ce,isBoolean:()=>yt,isDate:()=>bt,isFunction:()=>Ze,isIterable:()=>vt,isNumber:()=>xt,isObject:()=>Me,isRegExp:()=>_t,isString:()=>wt,isTuple:()=>lu,key:()=>kt,lerp:()=>St,lineHeight:()=>N1,loader:()=>tW,locale:()=>ole,logger:()=>Se,lruCache:()=>Mt,markup:()=>J2,merge:()=>Tt,mergeConfig:()=>Ee,multiLineOffset:()=>I1,one:()=>ge,pad:()=>At,panLinear:()=>$e,panLog:()=>ze,panPow:()=>je,panSymlog:()=>Ge,parse:()=>SAe,parseExpression:()=>aOe,parseSelector:()=>kOe,pathCurves:()=>oQ,pathEqual:()=>R3,pathParse:()=>uQ,pathRectangle:()=>RQ,pathRender:()=>vQ,pathSymbols:()=>kQ,pathTrail:()=>NQ,peek:()=>Oe,point:()=>s2,projection:()=>xte,quantileLogNormal:()=>ML,quantileNormal:()=>xL,quantileUniform:()=>RL,quantiles:()=>iL,quantizeInterpolator:()=>R8,quarter:()=>Xe,quartiles:()=>oL,random:()=>uL,randomInteger:()=>hL,randomKDE:()=>wL,randomLCG:()=>dL,randomLogNormal:()=>TL,randomMixture:()=>EL,randomNormal:()=>_L,randomUniform:()=>NL,read:()=>eW,regressionExp:()=>zL,regressionLinear:()=>PL,regressionLoess:()=>qL,regressionLog:()=>$L,regressionPoly:()=>UL,regressionPow:()=>jL,regressionQuad:()=>GL,renderModule:()=>k3,repeat:()=>Et,resetDefaultLocale:()=>sle,resetSVGClipId:()=>XQ,resetSVGDefIds:()=>N3,responseType:()=>QU,runtimeContext:()=>Hae,sampleCurve:()=>JL,sampleLogNormal:()=>kL,sampleNormal:()=>yL,sampleUniform:()=>AL,scale:()=>A8,sceneEqual:()=>O3,sceneFromJSON:()=>Z1,scenePickVisit:()=>G0,sceneToJSON:()=>J1,sceneVisit:()=>j0,sceneZOrder:()=>z0,scheme:()=>L8,serializeXML:()=>Z2,setRandom:()=>lL,span:()=>Ft,splitAccessPath:()=>ce,stringValue:()=>Ot,textMetrics:()=>M1,timeBin:()=>sz,timeFloor:()=>P$,timeFormatLocale:()=>rle,timeInterval:()=>W$,timeOffset:()=>q$,timeSequence:()=>K$,timeUnitSpecifier:()=>v$,timeUnits:()=>y$,toBoolean:()=>Rt,toDate:()=>Dt,toNumber:()=>Re,toSet:()=>Bt,toString:()=>It,transform:()=>Vu,transforms:()=>Uu,truncate:()=>Lt,truthy:()=>me,tupleid:()=>cu,typeParsers:()=>jU,utcFloor:()=>j$,utcInterval:()=>V$,utcOffset:()=>X$,utcSequence:()=>J$,utcdayofyear:()=>E$,utcquarter:()=>Ye,utcweek:()=>A$,version:()=>TOe,visitArray:()=>Pt,week:()=>k$,writeConfig:()=>Ae,zero:()=>fe,zoomLinear:()=>We,zoomLog:()=>Ve,zoomPow:()=>He,zoomSymlog:()=>qe});var _={};n.r(_),n.d(_,{compile:()=>xqe,extractTransforms:()=>wqe,normalize:()=>gze,version:()=>kqe});var w={};n.r(w),n.d(w,{carbong10:()=>wXe,carbong100:()=>SXe,carbong90:()=>kXe,carbonwhite:()=>_Xe,dark:()=>Tqe,excel:()=>Aqe,fivethirtyeight:()=>Dqe,ggplot2:()=>Bqe,googlecharts:()=>rXe,latimes:()=>Gqe,powerbi:()=>mXe,quartz:()=>Vqe,urbaninstitute:()=>Qqe,version:()=>CXe,vox:()=>qqe});var k,S=(k=function(e,t){return k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},k(e,t)},function(e,t){function n(){this.constructor=e}k(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),C=Object.prototype.hasOwnProperty;function M(e,t){return C.call(e,t)}function T(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)M(e,i)&&r.push(i);return r}function E(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function A(e){for(var t,n=0,r=e.length;n<r;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0}function F(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function O(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function R(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(R(e[t]))return!0}else if("object"==typeof e)for(var r=T(e),i=r.length,o=0;o<i;o++)if(R(e[r[o]]))return!0;return!1}function N(e,t){var n=[e];for(var r in t){var i="object"==typeof t[r]?JSON.stringify(t[r],null,2):t[r];void 0!==i&&n.push(r+": "+i)}return n.join("\n")}var D=function(e){function t(t,n,r,i,o){var a=this.constructor,s=e.call(this,N(t,{name:n,index:r,operation:i,tree:o}))||this;return s.name=n,s.index=r,s.operation=i,s.tree=o,Object.setPrototypeOf(s,a.prototype),s.message=N(t,{name:n,index:r,operation:i,tree:o}),s}return S(t,e),t}(Error),I=D,B=E,L={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=$(n,this.path);r&&(r=E(r));var i=z(n,{op:"remove",path:this.from}).removed;return z(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=$(n,this.from);return z(n,{op:"add",path:this.path,value:E(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:V(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},P={add:function(e,t,n){return A(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:L.move,copy:L.copy,test:L.test,_get:L._get};function $(e,t){if(""==t)return e;var n={op:"_get",path:t};return z(e,n),n.value}function z(e,t,n,r,i,o){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===o&&(o=0),n&&("function"==typeof n?n(t,0,e,t.path):U(t,0)),""===t.path){var a={newDocument:e};if("add"===t.op)return a.newDocument=t.value,a;if("replace"===t.op)return a.newDocument=t.value,a.removed=e,a;if("move"===t.op||"copy"===t.op)return a.newDocument=$(e,t.from),"move"===t.op&&(a.removed=e),a;if("test"===t.op){if(a.test=V(e,t.value),!1===a.test)throw new I("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a.newDocument=e,a}if("remove"===t.op)return a.removed=e,a.newDocument=null,a;if("_get"===t.op)return t.value=e,a;if(n)throw new I("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return a}r||(e=E(e));var s=(t.path||"").split("/"),u=e,l=1,c=s.length,p=void 0,d=void 0,h=void 0;for(h="function"==typeof n?n:U;;){if((d=s[l])&&-1!=d.indexOf("~")&&(d=O(d)),i&&("__proto__"==d||"prototype"==d&&l>0&&"constructor"==s[l-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===p&&(void 0===u[d]?p=s.slice(0,l).join("/"):l==c-1&&(p=t.path),void 0!==p&&h(t,0,e,p)),l++,Array.isArray(u)){if("-"===d)d=u.length;else{if(n&&!A(d))throw new I("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);A(d)&&(d=~~d)}if(l>=c){if(n&&"add"===t.op&&d>u.length)throw new I("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);if(!1===(a=P[t.op].call(t,u,d,e)).test)throw new I("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}}else if(l>=c){if(!1===(a=L[t.op].call(t,u,d,e)).test)throw new I("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}if(u=u[d],n&&l<c&&(!u||"object"!=typeof u))throw new I("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}function j(e,t,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=!0),n&&!Array.isArray(t))throw new I("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=E(e));for(var o=new Array(t.length),a=0,s=t.length;a<s;a++)o[a]=z(e,t[a],n,!0,i,a),e=o[a].newDocument;return o.newDocument=e,o}function G(e,t,n){var r=z(e,t);if(!1===r.test)throw new I("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function U(e,t,n,r){if("object"!=typeof e||null===e||Array.isArray(e))throw new I("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!L[e.op])throw new I("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new I("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new I('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new I("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new I("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&R(e.value))throw new I("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var i=e.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new I("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==r)throw new I("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var a=W([{op:"_get",path:e.from,value:void 0}],n);if(a&&"OPERATION_PATH_UNRESOLVABLE"===a.name)throw new I("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function W(e,t,n){try{if(!Array.isArray(e))throw new I("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)j(E(t),E(e),n||!0);else{n=n||U;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(e){if(e instanceof I)return e;throw e}}function V(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,r,i,o=Array.isArray(e),a=Array.isArray(t);if(o&&a){if((r=e.length)!=t.length)return!1;for(n=r;0!=n--;)if(!V(e[n],t[n]))return!1;return!0}if(o!=a)return!1;var s=Object.keys(e);if((r=s.length)!==Object.keys(t).length)return!1;for(n=r;0!=n--;)if(!t.hasOwnProperty(s[n]))return!1;for(n=r;0!=n--;)if(!V(e[i=s[n]],t[i]))return!1;return!0}return e!=e&&t!=t}var H=new WeakMap,q=function(e){this.observers=new Map,this.obj=e},X=function(e,t){this.callback=e,this.observer=t};function Y(e,t){t.unobserve()}function K(e,t){var n,r=function(e){return H.get(e)}(e);if(r){var i=function(e,t){return e.observers.get(t)}(r,t);n=i&&i.observer}else r=new q(e),H.set(e,r);if(n)return n;if(n={},r.value=E(e),t){n.callback=t,n.next=null;var o=function(){J(n)},a=function(){clearTimeout(n.next),n.next=setTimeout(o)};"undefined"!=typeof window&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return n.patches=[],n.object=e,n.unobserve=function(){J(n),clearTimeout(n.next),function(e,t){e.observers.delete(t.callback)}(r,n),"undefined"!=typeof window&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(t,new X(t,n)),n}function J(e,t){void 0===t&&(t=!1);var n=H.get(e.object);Z(n.value,e.object,e.patches,"",t),e.patches.length&&j(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function Z(e,t,n,r,i){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var o=T(t),a=T(e),s=!1,u=a.length-1;u>=0;u--){var l=e[p=a[u]];if(!M(t,p)||void 0===t[p]&&void 0!==l&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+F(p),value:E(l)}),n.push({op:"remove",path:r+"/"+F(p)}),s=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}));else{var c=t[p];"object"==typeof l&&null!=l&&"object"==typeof c&&null!=c&&Array.isArray(l)===Array.isArray(c)?Z(l,c,n,r+"/"+F(p),i):l!==c&&(i&&n.push({op:"test",path:r+"/"+F(p),value:E(l)}),n.push({op:"replace",path:r+"/"+F(p),value:E(c)}))}}if(s||o.length!=a.length)for(u=0;u<o.length;u++){var p;M(e,p=o[u])||void 0===t[p]||n.push({op:"add",path:r+"/"+F(p),value:E(t[p])})}}}function Q(e,t,n){void 0===n&&(n=!1);var r=[];return Z(e,t,r,"",n),r}Object.assign({},r,i,{JsonPatchError:D,deepClone:E,escapePathComponent:F,unescapePathComponent:O});var ee=n(1801),te=n.n(ee),ne=n(1249);function re(e,t,n){return e.fields=t||[],e.fname=n,e}function ie(e){return null==e?null:e.fname}function oe(e){return null==e?null:e.fields}function ae(e){return 1===e.length?se(e[0]):ue(e)}const se=e=>function(t){return t[e]},ue=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function le(e){throw Error(e)}function ce(e){const t=[],n=e.length;let r,i,o,a=null,s=0,u="";function l(){t.push(u+e.substring(r,i)),u="",r=i+1}for(e+="",r=i=0;i<n;++i)if(o=e[i],"\\"===o)u+=e.substring(r,i),u+=e.substring(++i,++i),r=i;else if(o===a)l(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&l(),s=r=i+1):"]"===o&&(s||le("Access path missing open bracket: "+e),s>0&&l(),s=0,r=i+1):i>r?l():r=i+1}return s&&le("Access path missing closing bracket: "+e),a&&le("Access path missing closing quote: "+e),i>r&&(i++,l()),t}function pe(e,t,n){const r=ce(e);return e=1===r.length?r[0]:e,re((n&&n.get||ae)(r),[e],t||e)}const de=pe("id"),he=re((e=>e),[],"identity"),fe=re((()=>0),[],"zero"),ge=re((()=>1),[],"one"),me=re((()=>!0),[],"true"),ye=re((()=>!1),[],"false");function be(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const ve=0,xe=1,_e=2,we=3,ke=4;function Se(e,t){let n=e||ve;return{level(e){return arguments.length?(n=+e,this):n},error(){return n>=xe&&be(t||"error","ERROR",arguments),this},warn(){return n>=_e&&be(t||"warn","WARN",arguments),this},info(){return n>=we&&be(t||"log","INFO",arguments),this},debug(){return n>=ke&&be(t||"log","DEBUG",arguments),this}}}var Ce=Array.isArray;function Me(e){return e===Object(e)}const Te=e=>"__proto__"!==e;function Ee(...e){return e.reduce(((e,t)=>{for(const n in t)if("signals"===n)e.signals=Fe(e.signals,t.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;Ae(e,n,t[n],r)}return e}),{})}function Ae(e,t,n,r){if(!Te(t))return;let i,o;if(Me(n)&&!Ce(n))for(i in o=Me(e[t])?e[t]:e[t]={},n)r&&(!0===r||r[i])?Ae(o,i,n[i]):Te(i)&&(o[i]=n[i]);else e[t]=n}function Fe(e,t){if(null==e)return t;const n={},r=[];function i(e){n[e.name]||(n[e.name]=1,r.push(e))}return t.forEach(i),e.forEach(i),r}function Oe(e){return e[e.length-1]}function Re(e){return null==e||""===e?null:+e}const Ne=e=>t=>e*Math.exp(t),De=e=>t=>Math.log(e*t),Ie=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),Be=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,Le=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function Pe(e,t,n,r){const i=n(e[0]),o=n(Oe(e)),a=(o-i)*t;return[r(i-a),r(o-a)]}function $e(e,t){return Pe(e,t,Re,he)}function ze(e,t){var n=Math.sign(e[0]);return Pe(e,t,De(n),Ne(n))}function je(e,t,n){return Pe(e,t,Le(n),Le(1/n))}function Ge(e,t,n){return Pe(e,t,Ie(n),Be(n))}function Ue(e,t,n,r,i){const o=r(e[0]),a=r(Oe(e)),s=null!=t?r(t):(o+a)/2;return[i(s+(o-s)*n),i(s+(a-s)*n)]}function We(e,t,n){return Ue(e,t,n,Re,he)}function Ve(e,t,n){const r=Math.sign(e[0]);return Ue(e,t,n,De(r),Ne(r))}function He(e,t,n,r){return Ue(e,t,n,Le(r),Le(1/r))}function qe(e,t,n,r){return Ue(e,t,n,Ie(r),Be(r))}function Xe(e){return 1+~~(new Date(e).getMonth()/3)}function Ye(e){return 1+~~(new Date(e).getUTCMonth()/3)}function Ke(e){return null!=e?Ce(e)?e:[e]:[]}function Je(e,t,n){let r,i=e[0],o=e[1];return o<i&&(r=o,o=i,i=r),r=o-i,r>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-r),i+r]}function Ze(e){return"function"==typeof e}const Qe="descending";function et(e,t,n){n=n||{},t=Ke(t)||[];const r=[],i=[],o={},a=n.comparator||nt;return Ke(e).forEach(((e,a)=>{null!=e&&(r.push(t[a]===Qe?-1:1),i.push(e=Ze(e)?e:pe(e,null,n)),(oe(e)||[]).forEach((e=>o[e]=1)))})),0===i.length?null:re(a(i,r),Object.keys(o))}const tt=(e,t)=>(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t==t?-1:t!=t&&e==e?1:0),nt=(e,t)=>1===e.length?rt(e[0],t[0]):it(e,t,e.length),rt=(e,t)=>function(n,r){return tt(e(n),e(r))*t},it=(e,t,n)=>(t.push(0),function(r,i){let o,a=0,s=-1;for(;0===a&&++s<n;)o=e[s],a=tt(o(r),o(i));return a*t[s]});function ot(e){return Ze(e)?e:()=>e}function at(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout((()=>(t(r),n=null)),e)}}function st(e){for(let t,n,r=1,i=arguments.length;r<i;++r)for(n in t=arguments[r],t)e[n]=t[n];return e}function ut(e,t){let n,r,i,o,a=0;if(e&&(n=e.length))if(null==t){for(r=e[a];a<n&&(null==r||r!=r);r=e[++a]);for(i=o=r;a<n;++a)r=e[a],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=t(e[a]);a<n&&(null==r||r!=r);r=t(e[++a]));for(i=o=r;a<n;++a)r=t(e[a]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}function lt(e,t){const n=e.length;let r,i,o,a,s,u=-1;if(null==t){for(;++u<n;)if(i=e[u],null!=i&&i>=i){r=o=i;break}if(u===n)return[-1,-1];for(a=s=u;++u<n;)i=e[u],null!=i&&(r>i&&(r=i,a=u),o<i&&(o=i,s=u))}else{for(;++u<n;)if(i=t(e[u],u,e),null!=i&&i>=i){r=o=i;break}if(u===n)return[-1,-1];for(a=s=u;++u<n;)i=t(e[u],u,e),null!=i&&(r>i&&(r=i,a=u),o<i&&(o=i,s=u))}return[a,s]}const ct=Object.prototype.hasOwnProperty;function pt(e,t){return ct.call(e,t)}const dt={};function ht(e){let t,n={};function r(e){return pt(n,e)&&n[e]!==dt}const i={size:0,empty:0,object:n,has:r,get:e=>r(e)?n[e]:void 0,set(e,t){return r(e)||(++i.size,n[e]===dt&&--i.empty),n[e]=t,this},delete(e){return r(e)&&(--i.size,++i.empty,n[e]=dt),this},clear(){i.size=i.empty=0,i.object=n={}},test(e){return arguments.length?(t=e,i):t},clean(){const e={};let r=0;for(const i in n){const o=n[i];o===dt||t&&t(o)||(e[i]=o,++r)}i.size=r,i.empty=0,i.object=n=e}};return e&&Object.keys(e).forEach((t=>{i.set(t,e[t])})),i}function ft(e,t,n,r,i,o){if(!n&&0!==n)return o;const a=+n;let s,u=e[0],l=Oe(e);l<u&&(s=u,u=l,l=s),s=Math.abs(t-u);const c=Math.abs(l-t);return s<c&&s<=a?r:c<=a?i:o}function gt(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),st(r,n)}function mt(e,t,n,r){let i,o=t[0],a=t[t.length-1];return o>a&&(i=o,o=a,a=i),r=void 0===r||r,((n=void 0===n||n)?o<=e:o<e)&&(r?e<=a:e<a)}function yt(e){return"boolean"==typeof e}function bt(e){return"[object Date]"===Object.prototype.toString.call(e)}function vt(e){return e&&Ze(e[Symbol.iterator])}function xt(e){return"number"==typeof e}function _t(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function wt(e){return"string"==typeof e}function kt(e,t,n){e&&(e=t?Ke(e).map((e=>e.replace(/\\(.)/g,"$1"))):Ke(e));const r=e&&e.length,i=n&&n.get||ae,o=e=>i(t?[e]:ce(e));let a;if(r)if(1===r){const t=o(e[0]);a=function(e){return""+t(e)}}else{const t=e.map(o);a=function(e){let n=""+t[0](e),i=0;for(;++i<r;)n+="|"+t[i](e);return n}}else a=function(){return""};return re(a,e,"key")}function St(e,t){const n=e[0],r=Oe(e),i=+t;return i?1===i?r:n+i*(r-n):n}const Ct=1e4;function Mt(e){let t,n,r;e=+e||Ct;const i=()=>{t={},n={},r=0},o=(i,o)=>(++r>e&&(n=t,t={},r=1),t[i]=o);return i(),{clear:i,has:e=>pt(t,e)||pt(n,e),get:e=>pt(t,e)?t[e]:pt(n,e)?o(e,n[e]):void 0,set:(e,n)=>pt(t,e)?t[e]=n:o(e,n)}}function Tt(e,t,n,r){const i=t.length,o=n.length;if(!o)return t;if(!i)return n;const a=r||new t.constructor(i+o);let s=0,u=0,l=0;for(;s<i&&u<o;++l)a[l]=e(t[s],n[u])>0?n[u++]:t[s++];for(;s<i;++s,++l)a[l]=t[s];for(;u<o;++u,++l)a[l]=n[u];return a}function Et(e,t){let n="";for(;--t>=0;)n+=e;return n}function At(e,t,n,r){const i=n||" ",o=e+"",a=t-o.length;return a<=0?o:"left"===r?Et(i,a)+o:"center"===r?Et(i,~~(a/2))+o+Et(i,Math.ceil(a/2)):o+Et(i,a)}function Ft(e){return e&&Oe(e)-e[0]||0}function Ot(e){return Ce(e)?"["+e.map(Ot)+"]":Me(e)||wt(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Rt(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e||!e)}const Nt=e=>xt(e)||bt(e)?e:Date.parse(e);function Dt(e,t){return t=t||Nt,null==e||""===e?null:t(e)}function It(e){return null==e||""===e?null:e+""}function Bt(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function Lt(e,t,n,r){const i=null!=r?r:"",o=e+"",a=o.length,s=Math.max(0,t-i.length);return a<=t?o:"left"===n?i+o.slice(a-s):"center"===n?o.slice(0,Math.ceil(s/2))+i+o.slice(a-~~(s/2)):o.slice(0,s)+i}function Pt(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const r=t(e[i]);r&&n(r,i,e)}}else e.forEach(n)}function $t(e,t,n){return e.fields=t||[],e.fname=n,e}function zt(e){return null==e?null:e.fname}function jt(e){return null==e?null:e.fields}function Gt(e){return 1===e.length?Ut(e[0]):Wt(e)}const Ut=e=>function(t){return t[e]},Wt=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function Vt(e){throw Error(e)}function Ht(e){const t=[],n=e.length;let r,i,o,a=null,s=0,u="";function l(){t.push(u+e.substring(r,i)),u="",r=i+1}for(e+="",r=i=0;i<n;++i)if(o=e[i],"\\"===o)u+=e.substring(r,i++),r=i;else if(o===a)l(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&l(),s=r=i+1):"]"===o&&(s||Vt("Access path missing open bracket: "+e),s>0&&l(),s=0,r=i+1):i>r?l():r=i+1}return s&&Vt("Access path missing closing bracket: "+e),a&&Vt("Access path missing closing quote: "+e),i>r&&(i++,l()),t}function qt(e,t,n){const r=Ht(e);return e=1===r.length?r[0]:e,$t((n&&n.get||Gt)(r),[e],t||e)}const Xt=qt("id"),Yt=$t((e=>e),[],"identity"),Kt=$t((()=>0),[],"zero"),Jt=$t((()=>1),[],"one"),Zt=$t((()=>!0),[],"true"),Qt=$t((()=>!1),[],"false");function en(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const tn=0,nn=1,rn=2,on=3,an=4;var sn=Array.isArray;function un(e){return e===Object(e)}const ln=e=>"__proto__"!==e;function cn(e,t,n,r){if(!ln(t))return;let i,o;if(un(n)&&!sn(n))for(i in o=un(e[t])?e[t]:e[t]={},n)r&&(!0===r||r[i])?cn(o,i,n[i]):ln(i)&&(o[i]=n[i]);else e[t]=n}function pn(e,t){if(null==e)return t;const n={},r=[];function i(e){n[e.name]||(n[e.name]=1,r.push(e))}return t.forEach(i),e.forEach(i),r}function dn(e){return e[e.length-1]}function hn(e){return null==e||""===e?null:+e}const fn=e=>t=>e*Math.exp(t),gn=e=>t=>Math.log(e*t),mn=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),yn=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,bn=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function vn(e,t,n,r){const i=n(e[0]),o=n(dn(e)),a=(o-i)*t;return[r(i-a),r(o-a)]}function xn(e,t,n,r,i){const o=r(e[0]),a=r(dn(e)),s=null!=t?r(t):(o+a)/2;return[i(s+(o-s)*n),i(s+(a-s)*n)]}function _n(e,t,n){return xn(e,t,n,hn,Yt)}function wn(e,t,n){const r=Math.sign(e[0]);return xn(e,t,n,gn(r),fn(r))}function kn(e,t,n,r){return xn(e,t,n,bn(r),bn(1/r))}function Sn(e,t,n,r){return xn(e,t,n,mn(r),yn(r))}function Cn(e){return null!=e?sn(e)?e:[e]:[]}function Mn(e){return"function"==typeof e}const Tn="descending";function En(e,t,n){n=n||{},t=Cn(t)||[];const r=[],i=[],o={},a=n.comparator||Fn;return Cn(e).forEach(((e,a)=>{null!=e&&(r.push(t[a]===Tn?-1:1),i.push(e=Mn(e)?e:qt(e,null,n)),(jt(e)||[]).forEach((e=>o[e]=1)))})),0===i.length?null:$t(a(i,r),Object.keys(o))}const An=(e,t)=>(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t==t?-1:t!=t&&e==e?1:0),Fn=(e,t)=>1===e.length?On(e[0],t[0]):Rn(e,t,e.length),On=(e,t)=>function(n,r){return An(e(n),e(r))*t},Rn=(e,t,n)=>(t.push(0),function(r,i){let o,a=0,s=-1;for(;0===a&&++s<n;)o=e[s],a=An(o(r),o(i));return a*t[s]});function Nn(e){return Mn(e)?e:()=>e}function Dn(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout((()=>(t(r),n=null)),e)}}function In(e){for(let t,n,r=1,i=arguments.length;r<i;++r)for(n in t=arguments[r],t)e[n]=t[n];return e}function Bn(e,t){let n,r,i,o,a=0;if(e&&(n=e.length))if(null==t){for(r=e[a];a<n&&(null==r||r!=r);r=e[++a]);for(i=o=r;a<n;++a)r=e[a],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=t(e[a]);a<n&&(null==r||r!=r);r=t(e[++a]));for(i=o=r;a<n;++a)r=t(e[a]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}const Ln=Object.prototype.hasOwnProperty;function Pn(e,t){return Ln.call(e,t)}const $n={};function zn(e){let t,n={};function r(e){return Pn(n,e)&&n[e]!==$n}const i={size:0,empty:0,object:n,has:r,get:e=>r(e)?n[e]:void 0,set(e,t){return r(e)||(++i.size,n[e]===$n&&--i.empty),n[e]=t,this},delete(e){return r(e)&&(--i.size,++i.empty,n[e]=$n),this},clear(){i.size=i.empty=0,i.object=n={}},test(e){return arguments.length?(t=e,i):t},clean(){const e={};let r=0;for(const i in n){const o=n[i];o===$n||t&&t(o)||(e[i]=o,++r)}i.size=r,i.empty=0,i.object=n=e}};return e&&Object.keys(e).forEach((t=>{i.set(t,e[t])})),i}function jn(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),In(r,n)}function Gn(e,t,n,r){let i,o=t[0],a=t[t.length-1];return o>a&&(i=o,o=a,a=i),r=void 0===r||r,((n=void 0===n||n)?o<=e:o<e)&&(r?e<=a:e<a)}function Un(e){return"[object Date]"===Object.prototype.toString.call(e)}function Wn(e){return"number"==typeof e}function Vn(e){return"string"==typeof e}function Hn(e,t,n){e&&(e=t?Cn(e).map((e=>e.replace(/\\(.)/g,"$1"))):Cn(e));const r=e&&e.length,i=n&&n.get||Gt,o=e=>i(t?[e]:Ht(e));let a;if(r)if(1===r){const t=o(e[0]);a=function(e){return""+t(e)}}else{const t=e.map(o);a=function(e){let n=""+t[0](e),i=0;for(;++i<r;)n+="|"+t[i](e);return n}}else a=function(){return""};return $t(a,e,"key")}function qn(e,t){let n="";for(;--t>=0;)n+=e;return n}function Xn(e){return e&&dn(e)-e[0]||0}function Yn(e){return sn(e)?"["+e.map(Yn)+"]":un(e)||Vn(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Kn(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e||!e)}const Jn=e=>Wn(e)||Un(e)?e:Date.parse(e);function Zn(e,t){return t=t||Jn,null==e||""===e?null:t(e)}function Qn(e){return null==e||""===e?null:e+""}function er(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function tr(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const r=t(e[i]);r&&n(r,i,e)}}else e.forEach(n)}var nr={},rr={},ir=34,or=10,ar=13;function sr(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function ur(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function lr(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function cr(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,i=[],o=e.length,a=0,s=0,u=o<=0,l=!1;function c(){if(u)return rr;if(l)return l=!1,nr;var t,r,i=a;if(e.charCodeAt(i)===ir){for(;a++<o&&e.charCodeAt(a)!==ir||e.charCodeAt(++a)===ir;);return(t=a)>=o?u=!0:(r=e.charCodeAt(a++))===or?l=!0:r===ar&&(l=!0,e.charCodeAt(a)===or&&++a),e.slice(i+1,t-1).replace(/""/g,'"')}for(;a<o;){if((r=e.charCodeAt(t=a++))===or)l=!0;else if(r===ar)l=!0,e.charCodeAt(a)===or&&++a;else if(r!==n)continue;return e.slice(i,t)}return u=!0,e.slice(i,o)}for(e.charCodeAt(o-1)===or&&--o,e.charCodeAt(o-1)===ar&&--o;(r=c())!==rr;){for(var p=[];r!==nr&&r!==rr;)p.push(r),r=c();t&&null==(p=t(p,s++))||i.push(p)}return i}function i(t,n){return t.map((function(t){return n.map((function(e){return a(t[e])})).join(e)}))}function o(t){return t.map(a).join(e)}function a(e){return null==e?"":e instanceof Date?function(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":function(e){return e<0?"-"+lr(-e,6):e>9999?"+"+lr(e,6):lr(e,4)}(e.getUTCFullYear())+"-"+lr(e.getUTCMonth()+1,2)+"-"+lr(e.getUTCDate(),2)+(i?"T"+lr(t,2)+":"+lr(n,2)+":"+lr(r,2)+"."+lr(i,3)+"Z":r?"T"+lr(t,2)+":"+lr(n,2)+":"+lr(r,2)+"Z":n||t?"T"+lr(t,2)+":"+lr(n,2)+"Z":"")}(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,i,o=r(e,(function(e,r){if(n)return n(e,r-1);i=e,n=t?function(e,t){var n=sr(e);return function(r,i){return t(n(r),i,e)}}(e,t):sr(e)}));return o.columns=i||[],o},parseRows:r,format:function(t,n){return null==n&&(n=ur(t)),[n.map(a).join(e)].concat(i(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=ur(e)),i(e,t).join("\n")},formatRows:function(e){return e.map(o).join("\n")},formatRow:o,formatValue:a}}function pr(e){return e}function dr(e,t){return"string"==typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map((function(t){return hr(e,t)}))}:hr(e,t)}function hr(e,t){var n=t.id,r=t.bbox,i=null==t.properties?{}:t.properties,o=fr(e,t);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function fr(e,t){var n=function(e){if(null==e)return pr;var t,n,r=e.scale[0],i=e.scale[1],o=e.translate[0],a=e.translate[1];return function(e,s){s||(t=n=0);var u=2,l=e.length,c=new Array(l);for(c[0]=(t+=e[0])*r+o,c[1]=(n+=e[1])*i+a;u<l;)c[u]=e[u],++u;return c}}(e.transform),r=e.arcs;function i(e,t){t.length&&t.pop();for(var i=r[e<0?~e:e],o=0,a=i.length;o<a;++o)t.push(n(i[o],o));e<0&&function(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}(t,a)}function o(e){return n(e)}function a(e){for(var t=[],n=0,r=e.length;n<r;++n)i(e[n],t);return t.length<2&&t.push(t[0]),t}function s(e){for(var t=a(e);t.length<4;)t.push(t[0]);return t}function u(e){return e.map(s)}return function e(t){var n,r=t.type;switch(r){case"GeometryCollection":return{type:r,geometries:t.geometries.map(e)};case"Point":n=o(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(o);break;case"LineString":n=a(t.arcs);break;case"MultiLineString":n=t.arcs.map(a);break;case"Polygon":n=u(t.arcs);break;case"MultiPolygon":n=t.arcs.map(u);break;default:return null}return{type:r,coordinates:n}}(t)}function gr(e,t){var n={},r={},i={},o=[],a=-1;function s(e,t){for(var r in e){var i=e[r];delete t[i.start],delete i.start,delete i.end,i.forEach((function(e){n[e<0?~e:e]=1})),o.push(i)}}return t.forEach((function(n,r){var i,o=e.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=t[++a],t[a]=n,t[r]=i)})),t.forEach((function(t){var n,o,a=function(t){var n,r=e.arcs[t<0?~t:t],i=r[0];return e.transform?(n=[0,0],r.forEach((function(e){n[0]+=e[0],n[1]+=e[1]}))):n=r[r.length-1],t<0?[n,i]:[i,n]}(t),s=a[0],u=a[1];if(n=i[s])if(delete i[n.end],n.push(t),n.end=u,o=r[u]){delete r[o.start];var l=o===n?n:n.concat(o);r[l.start=n.start]=i[l.end=o.end]=l}else r[n.start]=i[n.end]=n;else if(n=r[u])if(delete r[n.start],n.unshift(t),n.start=s,o=i[s]){delete i[o.end];var c=o===n?n:o.concat(n);r[c.start=o.start]=i[c.end=n.end]=c}else r[n.start]=i[n.end]=n;else r[(n=[t]).start=s]=i[n.end=u]=n})),s(i,r),s(r,i),t.forEach((function(e){n[e<0?~e:e]||o.push([e])})),o}function mr(e){return fr(e,yr.apply(this,arguments))}function yr(e,t,n){var r,i,o;if(arguments.length>1)r=function(e,t,n){var r,i=[],o=[];function a(e){var t=e<0?~e:e;(o[t]||(o[t]=[])).push({i:e,g:r})}function s(e){e.forEach(a)}function u(e){e.forEach(s)}return function e(t){switch(r=t,t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"LineString":s(t.arcs);break;case"MultiLineString":case"Polygon":u(t.arcs);break;case"MultiPolygon":!function(e){e.forEach(u)}(t.arcs)}}(t),o.forEach(null==n?function(e){i.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&i.push(e[0].i)}),i}(0,t,n);else for(i=0,r=new Array(o=e.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:gr(e,r)}}const br=Math.sqrt(50),vr=Math.sqrt(10),xr=Math.sqrt(2);function _r(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=br?10:o>=vr?5:o>=xr?2:1;let s,u,l;return i<0?(l=Math.pow(10,-i)/a,s=Math.round(e*l),u=Math.round(t*l),s/l<e&&++s,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*a,s=Math.round(e/l),u=Math.round(t/l),s*l<e&&++s,u*l>t&&--u),u<s&&.5<=n&&n<2?_r(e,t,2*n):[s,u,l]}function wr(e,t,n){return _r(e=+e,t=+t,n=+n)[2]}var kr,Sr=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Cr(e){if(!(t=Sr.exec(e)))throw new Error("invalid format: "+e);var t;return new Mr({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Mr(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Tr(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Er(e){return(e=Tr(Math.abs(e)))?e[1]:NaN}function Ar(e,t){var n=Tr(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Cr.prototype=Mr.prototype,Mr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Fr={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Ar(100*e,t),r:Ar,s:function(e,t){var n=Tr(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(kr=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Tr(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Or(e){return e}var Rr,Nr,Dr,Ir=Array.prototype.map,Br=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Lr(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Or:(t=Ir.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],a=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(e.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?Or:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Ir.call(e.numerals,String)),u=void 0===e.percent?"%":e.percent+"",l=void 0===e.minus?"":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function p(e){var t=(e=Cr(e)).fill,n=e.align,p=e.sign,d=e.symbol,h=e.zero,f=e.width,g=e.comma,m=e.precision,y=e.trim,b=e.type;"n"===b?(g=!0,b="g"):Fr[b]||(void 0===m&&(m=12),y=!0,b="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var v="$"===d?i:"#"===d&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",x="$"===d?o:/[%p]/.test(b)?u:"",_=Fr[b],w=/[defgprs%]/.test(b);function k(e){var i,o,u,d=v,k=x;if("c"===b)k=_(e)+k,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:_(Math.abs(e),m),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),S&&0==+e&&"+"!==p&&(S=!1),d=(S?"("===p?p:l:"-"===p||"("===p?"":p)+d,k=("s"===b?Br[8+kr/3]:"")+k+(S&&"("===p?")":""),w)for(i=-1,o=e.length;++i<o;)if(48>(u=e.charCodeAt(i))||u>57){k=(46===u?a+e.slice(i+1):e.slice(i))+k,e=e.slice(0,i);break}}g&&!h&&(e=r(e,1/0));var C=d.length+e.length+k.length,M=C<f?new Array(f-C+1).join(t):"";switch(g&&h&&(e=r(M+e,M.length?f-k.length:1/0),M=""),n){case"<":e=d+e+k+M;break;case"=":e=d+M+e+k;break;case"^":e=M.slice(0,C=M.length>>1)+d+e+k+M.slice(C);break;default:e=M+d+e+k}return s(e)}return m=void 0===m?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),k.toString=function(){return e+""},k}return{format:p,formatPrefix:function(e,t){var n=p(((e=Cr(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Er(t)/3))),i=Math.pow(10,-r),o=Br[8+r/3];return function(e){return n(i*e)+o}}}}Rr=Lr({thousands:",",grouping:[3],currency:["$",""]}),Nr=Rr.format,Dr=Rr.formatPrefix;const Pr=new Date,$r=new Date;function zr(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{const t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,r,o)=>{const a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return a;let s;do{a.push(s=new Date(+n)),t(n,o),e(n)}while(s<n&&n<r);return a},i.filter=n=>zr((t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),((e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})),n&&(i.count=(t,r)=>(Pr.setTime(+t),$r.setTime(+r),e(Pr),e($r),Math.floor(n(Pr,$r))),i.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?t=>r(t)%e==0:t=>i.count(0,t)%e==0):i:null)),i}const jr=1e3,Gr=6e4,Ur=36e5,Wr=864e5,Vr=6048e5,Hr=zr((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Gr)/Wr),(e=>e.getDate()-1)),qr=(Hr.range,zr((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/Wr),(e=>e.getUTCDate()-1))),Xr=(qr.range,zr((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/Wr),(e=>Math.floor(e/Wr))));function Yr(e){return zr((t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),((e,t)=>{e.setDate(e.getDate()+7*t)}),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Gr)/Vr))}Xr.range;const Kr=Yr(0),Jr=Yr(1),Zr=Yr(2),Qr=Yr(3),ei=Yr(4),ti=Yr(5),ni=Yr(6);function ri(e){return zr((t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)}),((e,t)=>(t-e)/Vr))}Kr.range,Jr.range,Zr.range,Qr.range,ei.range,ti.range,ni.range;const ii=ri(0),oi=ri(1),ai=ri(2),si=ri(3),ui=ri(4),li=ri(5),ci=ri(6),pi=(ii.range,oi.range,ai.range,si.range,ui.range,li.range,ci.range,zr((e=>{e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,t)=>{e.setFullYear(e.getFullYear()+t)}),((e,t)=>t.getFullYear()-e.getFullYear()),(e=>e.getFullYear())));pi.every=e=>isFinite(e=Math.floor(e))&&e>0?zr((t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,n)=>{t.setFullYear(t.getFullYear()+n*e)})):null,pi.range;const di=zr((e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)}),((e,t)=>t.getUTCFullYear()-e.getUTCFullYear()),(e=>e.getUTCFullYear()));di.every=e=>isFinite(e=Math.floor(e))&&e>0?zr((t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null,di.range;const hi=zr((e=>{e.setDate(1),e.setHours(0,0,0,0)}),((e,t)=>{e.setMonth(e.getMonth()+t)}),((e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())),(e=>e.getMonth())),fi=(hi.range,zr((e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)}),((e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())),(e=>e.getUTCMonth()))),gi=(fi.range,zr((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*jr-e.getMinutes()*Gr)}),((e,t)=>{e.setTime(+e+t*Ur)}),((e,t)=>(t-e)/Ur),(e=>e.getHours()))),mi=(gi.range,zr((e=>{e.setUTCMinutes(0,0,0)}),((e,t)=>{e.setTime(+e+t*Ur)}),((e,t)=>(t-e)/Ur),(e=>e.getUTCHours()))),yi=(mi.range,zr((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*jr)}),((e,t)=>{e.setTime(+e+t*Gr)}),((e,t)=>(t-e)/Gr),(e=>e.getMinutes()))),bi=(yi.range,zr((e=>{e.setUTCSeconds(0,0)}),((e,t)=>{e.setTime(+e+t*Gr)}),((e,t)=>(t-e)/Gr),(e=>e.getUTCMinutes()))),vi=(bi.range,zr((e=>{e.setTime(e-e.getMilliseconds())}),((e,t)=>{e.setTime(+e+t*jr)}),((e,t)=>(t-e)/jr),(e=>e.getUTCSeconds()))),xi=(vi.range,zr((()=>{}),((e,t)=>{e.setTime(+e+t)}),((e,t)=>t-e)));function _i(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function wi(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ki(){return 0}xi.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?zr((t=>{t.setTime(Math.floor(t/e)*e)}),((t,n)=>{t.setTime(+t+n*e)}),((t,n)=>(n-t)/e)):xi:null),xi.range;const Si=Math.sqrt(50),Ci=Math.sqrt(10),Mi=Math.sqrt(2);function Ti(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=Si?10:o>=Ci?5:o>=Mi?2:1;let s,u,l;return i<0?(l=Math.pow(10,-i)/a,s=Math.round(e*l),u=Math.round(t*l),s/l<e&&++s,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*a,s=Math.round(e/l),u=Math.round(t/l),s*l<e&&++s,u*l>t&&--u),u<s&&.5<=n&&n<2?Ti(e,t,2*n):[s,u,l]}function Ei(e,t,n){return Ti(e=+e,t=+t,n=+n)[2]}function Ai(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?Ei(t,e,n):Ei(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}const Fi="year",Oi="quarter",Ri="month",Ni="week",Di="date",Ii="day",Bi="dayofyear",Li="hours",Pi="minutes",$i="seconds",zi="milliseconds",ji=[Fi,Oi,Ri,Ni,Di,Ii,Bi,Li,Pi,$i,zi],Gi=ji.reduce(((e,t,n)=>(e[t]=1+n,e)),{});function Ui(e){const t=Cn(e).slice(),n={};return t.length||Vt("Missing time unit."),t.forEach((e=>{Pn(Gi,e)?n[e]=1:Vt(`Invalid time unit: ${e}.`)})),(n[Ni]||n[Ii]?1:0)+(n[Oi]||n[Ri]||n[Di]?1:0)+(n[Bi]?1:0)>1&&Vt(`Incompatible time units: ${e}`),t.sort(((e,t)=>Gi[e]-Gi[t])),t}const Wi={[Fi]:"%Y ",[Oi]:"Q%q ",[Ri]:"%b ",[Di]:"%d ",[Ni]:"W%U ",[Ii]:"%a ",[Bi]:"%j ",[Li]:"%H:00",[Pi]:"00:%M",[$i]:":%S",[zi]:".%L",[`${Fi}-${Ri}`]:"%Y-%m ",[`${Fi}-${Ri}-${Di}`]:"%Y-%m-%d ",[`${Li}-${Pi}`]:"%H:%M"},Vi=new Date;function Hi(e){return Vi.setFullYear(e),Vi.setMonth(0),Vi.setDate(1),Vi.setHours(0,0,0,0),Vi}function qi(e){return Hr.count(Hi(e.getFullYear())-1,e)}function Xi(e){return Kr.count(Hi(e.getFullYear())-1,e)}function Yi(e){return Hi(e).getDay()}function Ki(e,t,n,r,i,o,a){if(0<=e&&e<100){const s=new Date(-1,t,n,r,i,o,a);return s.setFullYear(e),s}return new Date(e,t,n,r,i,o,a)}function Ji(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return qr.count(t-1,e)}function Zi(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return ii.count(t-1,e)}function Qi(e){return Vi.setTime(Date.UTC(e,0,1)),Vi.getUTCDay()}function eo(e,t,n,r,i,o,a){if(0<=e&&e<100){const e=new Date(Date.UTC(-1,t,n,r,i,o,a));return e.setUTCFullYear(n.y),e}return new Date(Date.UTC(e,t,n,r,i,o,a))}function to(e,t,n,r,i){const o=t||1,a=dn(e),s=(e,t,i)=>function(e,t,n,r){const i=n<=1?e:r?(t,i)=>r+n*Math.floor((e(t,i)-r)/n):(t,r)=>n*Math.floor(e(t,r)/n);return t?(e,n)=>t(i(e,n),n):i}(n[i=i||e],r[i],e===a&&o,t),u=new Date,l=er(e),c=l[Fi]?s(Fi):Nn(2012),p=l[Ri]?s(Ri):l[Oi]?s(Oi):Kt,d=l[Ni]&&l[Ii]?s(Ii,1,Ni+Ii):l[Ni]?s(Ni,1):l[Ii]?s(Ii,1):l[Di]?s(Di,1):l[Bi]?s(Bi,1):Jt,h=l[Li]?s(Li):Kt,f=l[Pi]?s(Pi):Kt,g=l[$i]?s($i):Kt,m=l[zi]?s(zi):Kt;return function(e){u.setTime(+e);const t=c(u);return i(t,p(u),d(u,t),h(u),f(u),g(u),m(u))}}function no(e,t,n){return t+7*e-(n+6)%7}const ro={[Fi]:e=>e.getFullYear(),[Oi]:e=>Math.floor(e.getMonth()/3),[Ri]:e=>e.getMonth(),[Di]:e=>e.getDate(),[Li]:e=>e.getHours(),[Pi]:e=>e.getMinutes(),[$i]:e=>e.getSeconds(),[zi]:e=>e.getMilliseconds(),[Bi]:e=>qi(e),[Ni]:e=>Xi(e),[Ni+Ii]:(e,t)=>no(Xi(e),e.getDay(),Yi(t)),[Ii]:(e,t)=>no(1,e.getDay(),Yi(t))},io={[Oi]:e=>3*e,[Ni]:(e,t)=>no(e,0,Yi(t))};function oo(e,t){return to(e,t||1,ro,io,Ki)}const ao={[Fi]:e=>e.getUTCFullYear(),[Oi]:e=>Math.floor(e.getUTCMonth()/3),[Ri]:e=>e.getUTCMonth(),[Di]:e=>e.getUTCDate(),[Li]:e=>e.getUTCHours(),[Pi]:e=>e.getUTCMinutes(),[$i]:e=>e.getUTCSeconds(),[zi]:e=>e.getUTCMilliseconds(),[Bi]:e=>Ji(e),[Ni]:e=>Zi(e),[Ii]:(e,t)=>no(1,e.getUTCDay(),Qi(t)),[Ni+Ii]:(e,t)=>no(Zi(e),e.getUTCDay(),Qi(t))},so={[Oi]:e=>3*e,[Ni]:(e,t)=>no(e,0,Qi(t))};function uo(e,t){return to(e,t||1,ao,so,eo)}const lo={[Fi]:pi,[Oi]:hi.every(3),[Ri]:hi,[Ni]:Kr,[Di]:Hr,[Ii]:Hr,[Bi]:Hr,[Li]:gi,[Pi]:yi,[$i]:vi,[zi]:xi},co={[Fi]:di,[Oi]:fi.every(3),[Ri]:fi,[Ni]:ii,[Di]:qr,[Ii]:qr,[Bi]:qr,[Li]:mi,[Pi]:bi,[$i]:vi,[zi]:xi};function po(e){return lo[e]}function ho(e){return co[e]}function fo(e,t,n){return e?e.offset(t,n):void 0}function go(e,t,n,r){return e?e.range(t,n,r):void 0}const mo=31536e6,yo=[Fi,Ri,Di,Li,Pi,$i,zi],bo=yo.slice(0,-1),vo=bo.slice(0,-1),xo=vo.slice(0,-1),_o=xo.slice(0,-1),wo=[Fi,Ri],ko=[Fi],So=[[bo,1,1e3],[bo,5,5e3],[bo,15,15e3],[bo,30,3e4],[vo,1,6e4],[vo,5,3e5],[vo,15,9e5],[vo,30,18e5],[xo,1,36e5],[xo,3,108e5],[xo,6,216e5],[xo,12,432e5],[_o,1,864e5],[[Fi,Ni],1,6048e5],[wo,1,2592e6],[wo,3,7776e6],[ko,1,mo]];const Co=new Date,Mo=new Date;function To(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{const t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,r,o)=>{const a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return a;let s;do{a.push(s=new Date(+n)),t(n,o),e(n)}while(s<n&&n<r);return a},i.filter=n=>To((t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),((e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})),n&&(i.count=(t,r)=>(Co.setTime(+t),Mo.setTime(+r),e(Co),e(Mo),Math.floor(n(Co,Mo))),i.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?t=>r(t)%e==0:t=>i.count(0,t)%e==0):i:null)),i}const Eo=864e5,Ao=6048e5;function Fo(e){return To((t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),((e,t)=>{e.setDate(e.getDate()+7*t)}),((e,t)=>(t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/Ao))}const Oo=Fo(0),Ro=Fo(1),No=Fo(2),Do=Fo(3),Io=Fo(4),Bo=Fo(5),Lo=Fo(6);function Po(e){return To((t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)}),((e,t)=>(t-e)/Ao))}Oo.range,Ro.range,No.range,Do.range,Io.range,Bo.range,Lo.range;const $o=Po(0),zo=Po(1),jo=Po(2),Go=Po(3),Uo=Po(4),Wo=Po(5),Vo=Po(6),Ho=($o.range,zo.range,jo.range,Go.range,Uo.range,Wo.range,Vo.range,To((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/Eo),(e=>e.getDate()-1))),qo=(Ho.range,To((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/Eo),(e=>e.getUTCDate()-1))),Xo=(qo.range,To((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/Eo),(e=>Math.floor(e/Eo)))),Yo=(Xo.range,To((e=>{e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,t)=>{e.setFullYear(e.getFullYear()+t)}),((e,t)=>t.getFullYear()-e.getFullYear()),(e=>e.getFullYear())));Yo.every=e=>isFinite(e=Math.floor(e))&&e>0?To((t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,n)=>{t.setFullYear(t.getFullYear()+n*e)})):null,Yo.range;const Ko=To((e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)}),((e,t)=>t.getUTCFullYear()-e.getUTCFullYear()),(e=>e.getUTCFullYear()));function Jo(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Zo(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Qo(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function ea(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=da(i),c=ha(i),p=da(o),d=ha(o),h=da(a),f=ha(a),g=da(s),m=ha(s),y=da(u),b=ha(u),v={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:Da,e:Da,f:$a,g:Ka,G:Za,H:Ia,I:Ba,j:La,L:Pa,m:za,M:ja,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:_s,s:ws,S:Ga,u:Ua,U:Wa,V:Ha,w:qa,W:Xa,x:null,X:null,y:Ya,Y:Ja,Z:Qa,"%":xs},x={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return u[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:es,e:es,f:os,g:ms,G:bs,H:ts,I:ns,j:rs,L:is,m:as,M:ss,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:_s,s:ws,S:us,u:ls,U:cs,V:ds,w:hs,W:fs,x:null,X:null,y:gs,Y:ys,Z:vs,"%":xs},_={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=f.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=p.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=y.exec(t.slice(n));return r?(e.m=b.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=g.exec(t.slice(n));return r?(e.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return S(e,t,n,r)},d:Sa,e:Sa,f:Fa,g:xa,G:va,H:Ma,I:Ma,j:Ca,L:Aa,m:ka,M:Ta,p:function(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=c.get(r[0].toLowerCase()),n+r[0].length):-1},q:wa,Q:Ra,s:Na,S:Ea,u:ga,U:ma,V:ya,w:fa,W:ba,x:function(e,t,r){return S(e,n,t,r)},X:function(e,t,n){return S(e,r,t,n)},y:xa,Y:va,Z:_a,"%":Oa};function w(e,t){return function(n){var r,i,o,a=[],s=-1,u=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===e.charCodeAt(s)&&(a.push(e.slice(u,s)),null!=(i=aa[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(e.slice(u,s)),a.join("")}}function k(e,t){return function(n){var r,i,o=Qo(1900,void 0,1);if(S(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=Zo(Qo(o.y,0,1))).getUTCDay(),r=i>4||0===i?zo.ceil(r):zo(r),r=qo.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=Jo(Qo(o.y,0,1))).getDay(),r=i>4||0===i?Ro.ceil(r):Ro(r),r=Ho.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Zo(Qo(o.y,0,1)).getUTCDay():Jo(Qo(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Zo(o)):Jo(o)}}function S(e,t,n,r){for(var i,o,a=0,s=t.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=_[i in aa?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return v.x=w(n,v),v.X=w(r,v),v.c=w(t,v),x.x=w(n,x),x.X=w(r,x),x.c=w(t,x),{format:function(e){var t=w(e+="",v);return t.toString=function(){return e},t},parse:function(e){var t=k(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=k(e+="",!0);return t.toString=function(){return e},t}}}Ko.every=e=>isFinite(e=Math.floor(e))&&e>0?To((t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null,Ko.range;var ta,na,ra,ia,oa,aa={"-":"",_:" ",0:"0"},sa=/^\s*\d+/,ua=/^%/,la=/[\\^$*+?|[\]().{}]/g;function ca(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function pa(e){return e.replace(la,"\\$&")}function da(e){return new RegExp("^(?:"+e.map(pa).join("|")+")","i")}function ha(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function fa(e,t,n){var r=sa.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function ga(e,t,n){var r=sa.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function ma(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function ya(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function ba(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function va(e,t,n){var r=sa.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function xa(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function _a(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function wa(e,t,n){var r=sa.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function ka(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Sa(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Ca(e,t,n){var r=sa.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Ma(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Ta(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Ea(e,t,n){var r=sa.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Aa(e,t,n){var r=sa.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Fa(e,t,n){var r=sa.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Oa(e,t,n){var r=ua.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Ra(e,t,n){var r=sa.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Na(e,t,n){var r=sa.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Da(e,t){return ca(e.getDate(),t,2)}function Ia(e,t){return ca(e.getHours(),t,2)}function Ba(e,t){return ca(e.getHours()%12||12,t,2)}function La(e,t){return ca(1+Ho.count(Yo(e),e),t,3)}function Pa(e,t){return ca(e.getMilliseconds(),t,3)}function $a(e,t){return Pa(e,t)+"000"}function za(e,t){return ca(e.getMonth()+1,t,2)}function ja(e,t){return ca(e.getMinutes(),t,2)}function Ga(e,t){return ca(e.getSeconds(),t,2)}function Ua(e){var t=e.getDay();return 0===t?7:t}function Wa(e,t){return ca(Oo.count(Yo(e)-1,e),t,2)}function Va(e){var t=e.getDay();return t>=4||0===t?Io(e):Io.ceil(e)}function Ha(e,t){return e=Va(e),ca(Io.count(Yo(e),e)+(4===Yo(e).getDay()),t,2)}function qa(e){return e.getDay()}function Xa(e,t){return ca(Ro.count(Yo(e)-1,e),t,2)}function Ya(e,t){return ca(e.getFullYear()%100,t,2)}function Ka(e,t){return ca((e=Va(e)).getFullYear()%100,t,2)}function Ja(e,t){return ca(e.getFullYear()%1e4,t,4)}function Za(e,t){var n=e.getDay();return ca((e=n>=4||0===n?Io(e):Io.ceil(e)).getFullYear()%1e4,t,4)}function Qa(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ca(t/60|0,"0",2)+ca(t%60,"0",2)}function es(e,t){return ca(e.getUTCDate(),t,2)}function ts(e,t){return ca(e.getUTCHours(),t,2)}function ns(e,t){return ca(e.getUTCHours()%12||12,t,2)}function rs(e,t){return ca(1+qo.count(Ko(e),e),t,3)}function is(e,t){return ca(e.getUTCMilliseconds(),t,3)}function os(e,t){return is(e,t)+"000"}function as(e,t){return ca(e.getUTCMonth()+1,t,2)}function ss(e,t){return ca(e.getUTCMinutes(),t,2)}function us(e,t){return ca(e.getUTCSeconds(),t,2)}function ls(e){var t=e.getUTCDay();return 0===t?7:t}function cs(e,t){return ca($o.count(Ko(e)-1,e),t,2)}function ps(e){var t=e.getUTCDay();return t>=4||0===t?Uo(e):Uo.ceil(e)}function ds(e,t){return e=ps(e),ca(Uo.count(Ko(e),e)+(4===Ko(e).getUTCDay()),t,2)}function hs(e){return e.getUTCDay()}function fs(e,t){return ca(zo.count(Ko(e)-1,e),t,2)}function gs(e,t){return ca(e.getUTCFullYear()%100,t,2)}function ms(e,t){return ca((e=ps(e)).getUTCFullYear()%100,t,2)}function ys(e,t){return ca(e.getUTCFullYear()%1e4,t,4)}function bs(e,t){var n=e.getUTCDay();return ca((e=n>=4||0===n?Uo(e):Uo.ceil(e)).getUTCFullYear()%1e4,t,4)}function vs(){return"+0000"}function xs(){return"%"}function _s(e){return+e}function ws(e){return Math.floor(+e/1e3)}function ks(e){const t={};return n=>t[n]||(t[n]=e(n))}function Ss(e){const t=ks(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(e){const n=Cr(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let o=function(e,t){let n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if(n=e.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const a=o<r.length?r.slice(o):"";for(;--o>i;)if("0"!==r[o]){++o;break}return r.slice(0,o)+a}}(t(n),t(".1f")(1)[1])}return t(n)},formatSpan(e,r,i,o){o=Cr(null==o?",f":o);const a=function(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?wr(t,e,n):wr(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}(e,r,i),s=Math.max(Math.abs(e),Math.abs(r));let u;if(null==o.precision)switch(o.type){case"s":return isNaN(u=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Er(t)/3)))-Er(Math.abs(e)))}(a,s))||(o.precision=u),n(o,s);case"":case"e":case"g":case"p":case"r":isNaN(u=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Er(t)-Er(e))+1}(a,s))||(o.precision=u-("e"===o.type));break;case"f":case"%":isNaN(u=function(e){return Math.max(0,-Er(Math.abs(e)))}(a))||(o.precision=u-2*("%"===o.type))}return t(o)}}}let Cs,Ms;function Ts(e){return Ss(Lr(e))}function Es(e){return arguments.length?Cs=Ts(e):Cs}function As(e,t,n){un(n=n||{})||Vt(`Invalid time multi-format specifier: ${n}`);const r=t($i),i=t(Pi),o=t(Li),a=t(Di),s=t(Ni),u=t(Ri),l=t(Oi),c=t(Fi),p=e(n[zi]||".%L"),d=e(n[$i]||":%S"),h=e(n[Pi]||"%I:%M"),f=e(n[Li]||"%I %p"),g=e(n[Di]||n[Ii]||"%a %d"),m=e(n[Ni]||"%b %d"),y=e(n[Ri]||"%B"),b=e(n[Oi]||"%B"),v=e(n[Fi]||"%Y");return e=>(r(e)<e?p:i(e)<e?d:o(e)<e?h:a(e)<e?f:u(e)<e?s(e)<e?g:m:c(e)<e?l(e)<e?y:b:v)(e)}function Fs(e){const t=ks(e.format),n=ks(e.utcFormat);return{timeFormat:e=>Vn(e)?t(e):As(t,po,e),utcFormat:e=>Vn(e)?n(e):As(n,ho,e),timeParse:ks(e.parse),utcParse:ks(e.utcParse)}}function Os(e){return Fs(ea(e))}function Rs(e){return arguments.length?Ms=Os(e):Ms}ta=ea({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),na=ta.format,ra=ta.parse,ia=ta.utcFormat,oa=ta.utcParse,Cs=Ss({format:Nr,formatPrefix:Dr}),Ms=Fs({format:na,parse:ra,utcFormat:ia,utcParse:oa});const Ns=(e,t)=>In({},e,t);const Ds=/^(data:|([A-Za-z]+:)?\/\/)/,Is=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Bs=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Ls="file://";async function Ps(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function $s(e,t){t=In({},this.options,t);const n=this.fileAccess,r={href:null};let i,o,a;const s=Is.test(e.replace(Bs,""));null!=e&&"string"==typeof e&&s||Vt("Sanitize failure, invalid URI: "+Yn(e));const u=Ds.test(e);return(a=t.baseURL)&&!u&&(e.startsWith("/")||a.endsWith("/")||(e="/"+e),e=a+e),o=(i=e.startsWith(Ls))||"file"===t.mode||"http"!==t.mode&&!u&&n,i?e=e.slice(7):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),"image"===t.context&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function zs(e){return e?t=>new Promise(((n,r)=>{e.readFile(t,((e,t)=>{e?r(e):n(t)}))})):js}async function js(){Vt("No file system access.")}function Gs(e){return e?async function(t,n){const r=In({},this.options.http,n),i=n&&n.response,o=await e(t,r);return o.ok?Mn(o[i])?o[i]():o.text():Vt(o.status+""+o.statusText)}:Us}async function Us(){Vt("No HTTP fetch method available.")}const Ws=e=>null!=e&&e==e,Vs=e=>!(Number.isNaN(+e)||e instanceof Date),Hs={boolean:Kn,integer:hn,number:hn,date:Zn,string:Qn,unknown:Yt},qs=[e=>"true"===e||"false"===e||!0===e||!1===e,e=>Vs(e)&&Number.isInteger(+e),Vs,e=>!Number.isNaN(Date.parse(e))],Xs=["boolean","integer","number","date"];function Ys(e){const t=function(t,n){const r={delimiter:e};return Ks(t,n?In(n,r):r)};return t.responseType="text",t}function Ks(e,t){return t.header&&(e=t.header.map(Yn).join(t.delimiter)+"\n"+e),cr(t.delimiter).parse(e+"")}function Js(e,t){const n=t&&t.property?qt(t.property):Yt;return!un(e)||(r=e,"function"==typeof Buffer&&Mn(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(e)):function(e,t){return!sn(e)&&function(e){return e&&Mn(e[Symbol.iterator])}(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}(n(e),t);var r}Ks.responseType="text",Js.responseType="json";const Zs={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function Qs(e,t){let n,r,i,o;return e=Js(e,t),t&&t.feature?(n=dr,i=t.feature):t&&t.mesh?(n=mr,i=t.mesh,o=Zs[t.filter]):Vt("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):Vt("Invalid TopoJSON object: "+i),r&&r.features||[r]}Qs.responseType="json";const eu={dsv:Ks,csv:Ys(","),tsv:Ys("\t"),json:Js,topojson:Qs};function tu(e,t){return arguments.length>1?(eu[e]=t,this):Pn(eu,e)?eu[e]:null}function nu(e){const t=tu(e);return t&&t.responseType||"text"}function ru(e,t,n,r){const i=tu((t=t||{}).type||"json");return i||Vt("Unknown data format type: "+t.type),e=i(e,t),t.parse&&function(e,t,n,r){if(!e.length)return;const i=Rs();n=n||i.timeParse,r=r||i.utcParse;let o,a,s,u,l,c,p=e.columns||Object.keys(e[0]);"auto"===t&&(t=function(e,t){return t.reduce(((t,n)=>(t[n]=function(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=qs.length,i=qs.map(((e,t)=>t+1));for(let o,a,s=0,u=0;s<n;++s)for(a=t?e[s][t]:e[s],o=0;o<r;++o)if(i[o]&&Ws(a)&&!qs[o](a)&&(i[o]=0,++u,u===qs.length))return"string";return Xs[i.reduce(((e,t)=>0===e?t:e),0)-1]}(e,n),t)),{})}(e,p)),p=Object.keys(t);const d=p.map((e=>{const i=t[e];let o,a;if(i&&(i.startsWith("date:")||i.startsWith("utc:")))return o=i.split(/:(.+)?/,2),a=o[1],("'"===a[0]&&"'"===a[a.length-1]||'"'===a[0]&&'"'===a[a.length-1])&&(a=a.slice(1,-1)),("utc"===o[0]?r:n)(a);if(!Hs[i])throw Error("Illegal format pattern: "+e+":"+i);return Hs[i]}));for(s=0,l=e.length,c=p.length;s<l;++s)for(o=e[s],u=0;u<c;++u)a=p[u],o[a]=d[u](o[a])}(e,t.parse,n,r),Pn(e,"columns")&&delete e.columns,e}const iu=function(e,t){return t=>({options:t||{},sanitize:$s,load:Ps,fileAccess:!1,file:zs(null),http:Gs(e)})}("undefined"!=typeof fetch&&fetch);function ou(e){const t=e||Yt,n=[],r={};return n.add=e=>{const i=t(e);return r[i]||(r[i]=1,n.push(e)),n},n.remove=e=>{const i=t(e);if(r[i]){r[i]=0;const t=n.indexOf(e);t>=0&&n.splice(t,1)}return n},n}async function au(e,t){try{await t(e)}catch(t){e.error(t)}}const su=Symbol("vega_id");let uu=1;function lu(e){return!(!e||!cu(e))}function cu(e){return e[su]}function pu(e,t){return e[su]=t,e}function du(e){const t=e===Object(e)?e:{data:e};return cu(t)?t:pu(t,uu++)}function hu(e){return fu(e,du({}))}function fu(e,t){for(const n in e)t[n]=e[n];return t}function gu(e,t){return pu(t,cu(e))}function mu(e,t){return e?t?(n,r)=>e(n,r)||cu(t(n))-cu(t(r)):(t,n)=>e(t,n)||cu(t)-cu(n):null}function yu(e){return e&&e.constructor===bu}function bu(){const e=[],t=[],n=[],r=[],i=[];let o=null,a=!1;return{constructor:bu,insert(t){const n=Cn(t),r=n.length;for(let t=0;t<r;++t)e.push(n[t]);return this},remove(e){const n=Mn(e)?r:t,i=Cn(e),o=i.length;for(let e=0;e<o;++e)n.push(i[e]);return this},modify(e,t,r){const o={field:t,value:Nn(r)};return Mn(e)?(o.filter=e,i.push(o)):(o.tuple=e,n.push(o)),this},encode(e,t){return Mn(e)?i.push({filter:e,field:t}):n.push({tuple:e,field:t}),this},clean(e){return o=e,this},reflow(){return a=!0,this},pulse(s,u){const l={},c={};let p,d,h,f,g,m;for(p=0,d=u.length;p<d;++p)l[cu(u[p])]=1;for(p=0,d=t.length;p<d;++p)g=t[p],l[cu(g)]=-1;for(p=0,d=r.length;p<d;++p)f=r[p],u.forEach((e=>{f(e)&&(l[cu(e)]=-1)}));for(p=0,d=e.length;p<d;++p)g=e[p],m=cu(g),l[m]?l[m]=1:s.add.push(du(e[p]));for(p=0,d=u.length;p<d;++p)g=u[p],l[cu(g)]<0&&s.rem.push(g);function y(e,t,n){n?e[t]=n(e):s.encode=t,a||(c[cu(e)]=e)}for(p=0,d=n.length;p<d;++p)h=n[p],g=h.tuple,f=h.field,m=l[cu(g)],m>0&&(y(g,f,h.value),s.modifies(f));for(p=0,d=i.length;p<d;++p)h=i[p],f=h.filter,u.forEach((e=>{f(e)&&l[cu(e)]>0&&y(e,h.field,h.value)})),s.modifies(h.field);if(a)s.mod=t.length||r.length?u.filter((e=>l[cu(e)]>0)):u.slice();else for(m in c)s.mod.push(c[m]);return(o||null==o&&(t.length||r.length))&&s.clean(!0),s}}}const vu="_:mod:_";function xu(){Object.defineProperty(this,vu,{writable:!0,value:{}})}xu.prototype={set(e,t,n,r){const i=this,o=i[e],a=i[vu];return null!=t&&t>=0?(o[t]!==n||r)&&(o[t]=n,a[t+":"+e]=-1,a[e]=-1):(o!==n||r)&&(i[e]=n,a[e]=sn(n)?1+n.length:-1),i},modified(e,t){const n=this[vu];if(!arguments.length){for(const e in n)if(n[e])return!0;return!1}if(sn(e)){for(let t=0;t<e.length;++t)if(n[e[t]])return!0;return!1}return null!=t&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[vu]={},this}};let _u=0;const wu=new xu;function ku(e,t,n,r){this.id=++_u,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function Su(e){return function(t){const n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}ku.prototype={targets(){return this._targets||(this._targets=ou(Xt))},set(e){return this.value!==e?(this.value=e,1):0},skip:Su(1),modified:Su(2),parameters(e,t,n){t=!1!==t;const r=this._argval=this._argval||new xu,i=this._argops=this._argops||[],o=[];let a,s,u,l;const c=(e,n,a)=>{a instanceof ku?(a!==this&&(t&&a.targets().add(this),o.push(a)),i.push({op:a,name:e,index:n})):r.set(e,n,a)};for(a in e)if(s=e[a],"pulse"===a)Cn(s).forEach((e=>{e instanceof ku?e!==this&&(e.targets().add(this),o.push(e)):Vt("Pulse parameters must be operator instances.")})),this.source=s;else if(sn(s))for(r.set(a,-1,Array(u=s.length)),l=0;l<u;++l)c(a,l,s[l]);else c(a,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(e){const t=this._argval||wu,n=this._argops;let r,i,o,a;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],o=r.op,a=o.modified()&&o.stamp===e,t.set(r.name,r.index,o.value,a);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};let Cu=0;function Mu(e,t,n){this.id=++Cu,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Tu(e,t,n){return new Mu(e,t,n)}Mu.prototype={_filter:Zt,_apply:Yt,targets(){return this._targets||(this._targets=ou(Xt))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let e=0;e<r;++e)n[e].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Tu(e);return this.targets().add(t),t},apply(e){const t=Tu(null,e);return this.targets().add(t),t},merge(){const e=Tu();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter((()=>{const n=Date.now();return n-t>e?(t=n,1):0}))},debounce(e){const t=Tu();return this.targets().add(Tu(null,null,Dn(e,(e=>{const n=e.dataflow;t.receive(e),n&&n.run&&n.run()})))),t},between(e,t){let n=!1;return e.targets().add(Tu(null,null,(()=>n=!0))),t.targets().add(Tu(null,null,(()=>n=!1))),this.filter((()=>n))},detach(){this._filter=Zt,this._targets=null}};const Eu={skip:!0};function Au(e,t,n,r,i,o){const a=In({},o,Eu);let s,u;Mn(n)||(n=Nn(n)),void 0===r?s=t=>e.touch(n(t)):Mn(r)?(u=new ku(null,r,i,!1),s=t=>{u.evaluate(t);const r=n(t),i=u.value;yu(i)?e.pulse(r,i,o):e.update(r,i,a)}):s=t=>e.update(n(t),r,a),t.apply(s)}function Fu(e,t,n,r,i,o){if(void 0===r)t.targets().add(n);else{const a=o||{},s=new ku(null,function(e,t){return t=Mn(t)?t:Nn(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}(n,r),i,!1);s.modified(a.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s]))}}const Ou={};function Ru(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Nu(e,t){const n=[];return tr(e,t,(e=>n.push(e))),n}function Du(e,t){const n={};return e.visit(t,(e=>{n[cu(e)]=1})),e=>n[cu(e)]?null:e}function Iu(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}function Bu(e,t,n,r){const i=this;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(const e of n)if(e.stamp===t){if(e.fields){const t=i.fields||(i.fields={});for(const n in e.fields)t[n]=1}e.changed(i.ADD)&&(o|=i.ADD),e.changed(i.REM)&&(o|=i.REM),e.changed(i.MOD)&&(o|=i.MOD)}this.changes=o}function Lu(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}Ru.prototype={StopPropagation:Ou,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(e){return new Ru(this.dataflow).init(this,e)},clone(){const e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new Ru(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,!e.fields||64&t||(n.fields=e.fields),1&t?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),2&t?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),4&t?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),32&t?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||7;return 1&t&&this.add.length||2&t&&this.rem.length||4&t&&this.mod.length},reflow(e){if(e)return this.fork(7).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(4,Du(this,1))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return sn(e)?e.forEach((e=>t[e]=!0)):t[e]=!0,this},modified(e,t){const n=this.fields;return!(!t&&!this.mod.length||!n)&&(arguments.length?sn(e)?e.some((e=>n[e])):n[e]:!!n)},filter(e,t){const n=this;return 1&e&&(n.addF=Iu(n.addF,t)),2&e&&(n.remF=Iu(n.remF,t)),4&e&&(n.modF=Iu(n.modF,t)),16&e&&(n.srcF=Iu(n.srcF,t)),n},materialize(e){const t=this;return 1&(e=e||7)&&t.addF&&(t.add=Nu(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=Nu(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=Nu(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(16&e)return tr(n.source,n.srcF,r),n;1&e&&tr(n.add,n.addF,r),2&e&&tr(n.rem,n.remF,r),4&e&&tr(n.mod,n.modF,r);const i=n.source;if(8&e&&i){const e=n.add.length+n.mod.length;e===i.length||tr(i,e?Du(n,5):n.srcF,r)}return n}},jn(Bu,Ru,{fork(e){const t=new Ru(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,(e=>t.add.push(e))),e&t.REM&&this.visit(t.REM,(e=>t.rem.push(e))),e&t.MOD&&this.visit(t.MOD,(e=>t.mod.push(e)))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?sn(e)?e.some((e=>n[e])):n[e]:0},filter(){Vt("MultiPulse does not support filtering.")},materialize(){Vt("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let o=0;if(e&n.SOURCE)for(;o<i;++o)r[o].visit(e,t);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(e,t);return n}});const Pu={skip:!1,force:!1};function $u(e,t,n,r){let i,o;const a=e[n];for(;n>t&&(o=n-1>>1,i=e[o],r(a,i)<0);)e[n]=i,n=o;return e[n]=a}function zu(){this.logger(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:en,r=e||tn;return{level(e){return arguments.length?(r=+e,this):r},error(){return r>=nn&&n(t||"error","ERROR",arguments),this},warn(){return r>=rn&&n(t||"warn","WARN",arguments),this},info(){return r>=on&&n(t||"log","INFO",arguments),this},debug(){return r>=an&&n(t||"log","DEBUG",arguments),this}}}()),this.logLevel(nn),this._clock=0,this._rank=0,this._locale=function(e,t){const n=arguments.length;return n&&2!==n&&Vt("defaultLocale expects either zero or two arguments."),n?Ns(Es(e),Rs(t)):Ns(Es(),Rs())}();try{this._loader=iu()}catch(e){}this._touched=ou(Xt),this._input={},this._pulse=null,this._heap=function(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),$u(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,function(e,t,n){const r=t,i=e.length,o=e[t];let a,s=1+(t<<1);for(;s<i;)a=s+1,a<i&&n(e[s],e[a])>=0&&(s=a),e[t]=e[s],s=1+((t=s)<<1);e[t]=o,$u(e,r,t,n)}(t,0,e)):r=n,r}}}(((e,t)=>e.qrank-t.qrank)),this._postrun=[]}function ju(e){return function(){return this._log[e].apply(this,arguments)}}function Gu(e,t){ku.call(this,e,null,t)}zu.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:ju("error"),warn:ju("warn"),info:ju("info"),debug:ju("debug"),logLevel:ju("level"),cleanThreshold:1e4,add:function(e,t,n,r){let i,o=1;return e instanceof ku?i=e:e&&e.prototype instanceof ku?i=new e:Mn(e)?i=new ku(null,e):(o=0,i=new ku(e,t)),this.rank(i),o&&(r=n,n=t),n&&this.connect(i,i.parameters(n,r)),this.touch(i),i},connect:function(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank)return void this.rerank(e)},rank:function(e){e.rank=++this._rank},rerank:function(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&Vt("Cycle detected in dataflow graph.")},pulse:function(e,t,n){this.touch(e,n||Pu);const r=new Ru(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this},touch:function(e,t){const n=t||Pu;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this},update:function(e,t,n){const r=n||Pu;return(e.set(t)||r.force)&&this.touch(e,r),this},changeset:bu,ingest:function(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))},parse:function(e,t){const n=this.locale();return ru(e,t,n.timeParse,n.utcParse)},preload:async function(e,t,n){const r=this,i=r._pending||function(e){let t;const n=new Promise((e=>t=e));return n.requests=0,n.done=()=>{0==--n.requests&&(e._pending=null,t(e))},e._pending=n}(r);i.requests+=1;const o=await r.request(t,n);return r.pulse(e,r.changeset().remove(Zt).insert(o.data||[])),i.done(),o},request:async function(e,t){const n=this;let r,i=0;try{r=await n.loader().load(e,{context:"dataflow",response:nu(t&&t.type)});try{r=n.parse(r,t)}catch(t){i=-2,n.warn("Data ingestion failed",e,t)}}catch(t){i=-1,n.warn("Loading failed",e,t)}return{data:r,status:i}},events:function(e,t,n,r){const i=this,o=Tu(n,r),a=function(e){e.dataflow=i;try{o.receive(e)}catch(e){i.error(e)}finally{i.run()}};let s;s="string"==typeof e&&"undefined"!=typeof document?document.querySelectorAll(e):Cn(e);const u=s.length;for(let e=0;e<u;++e)s[e].addEventListener(t,a);return o},on:function(e,t,n,r,i){return(e instanceof ku?Fu:Au)(this,e,t,n,r,i),this},evaluate:async function(e,t,n){const r=this,i=[];if(r._pulse)return Lu(r);if(r._pending&&await r._pending,t&&await au(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new Ru(r,o,e),r._touched.forEach((e=>r._enqueue(e,!0))),r._touched=ou(Xt);let a,s,u,l=0;try{for(;r._heap.size()>0;)a=r._heap.pop(),a.rank===a.qrank?(s=a.run(r._getPulse(a,e)),s.then?s=await s:s.async&&(i.push(s.async),s=Ou),s!==Ou&&a._targets&&a._targets.forEach((e=>r._enqueue(e))),++l):r._enqueue(a,!0)}catch(e){r._heap.clear(),u=e}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${l} operators`),u&&(r._postrun=[],r.error(u)),r._postrun.length){const e=r._postrun.sort(((e,t)=>t.priority-e.priority));r._postrun=[];for(let t=0;t<e.length;++t)await au(r,e[t].callback)}return n&&await au(r,n),i.length&&Promise.all(i).then((e=>r.runAsync(null,(()=>{e.forEach((e=>{try{e(r)}catch(e){r.error(e)}}))})))),r},run:function(e,t,n){return this._pulse?Lu(this):(this.evaluate(e,t,n),this)},runAsync:async function(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running},runAfter:function(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(e){this.error(e)}},_enqueue:function(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},_getPulse:function(e,t){const n=e.source,r=this._clock;return n&&sn(n)?new Bu(this,r,n.map((e=>e.pulse)),t):this._input[e.id]||function(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==Ou&&(e.source=t.source),e)}(this._pulse,n&&n.pulse)}},jn(Gu,ku,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then((e=>this.pulse=e)):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Uu={};function Wu(e){const t=Vu(e);return t&&t.Definition||null}function Vu(e){return e=e&&e.toLowerCase(),Pn(Uu,e)?Uu[e]:null}function Hu(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function qu(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function Xu(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function Yu(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}function Ku(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=void 0===i?Yu:function(e=Hu){if(e===Hu)return Yu;if("function"!=typeof e)throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||0===r?r:(0===e(n,n))-(0===e(t,t))}}(i);r>n;){if(r-n>600){const o=r-n+1,a=t-n+1,s=Math.log(o),u=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*u*(o-u)/o)*(a-o/2<0?-1:1);Ku(e,t,Math.max(n,Math.floor(t-a*u/o+l)),Math.min(r,Math.floor(t+(o-a)*u/o+l)),i)}const o=e[t];let a=n,s=r;for(Ju(e,n,t),i(e[r],o)>0&&Ju(e,n,r);a<s;){for(Ju(e,a,s),++a,--s;i(e[a],o)<0;)++a;for(;i(e[s],o)>0;)--s}0===i(e[n],o)?Ju(e,n,s):(++s,Ju(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function Ju(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Zu(e){return null===e?NaN:+e}function Qu(e,t,n){if(e=Float64Array.from(function*(e,t){if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n)),(r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return Xu(e);if(t>=1)return qu(e);var r,i=(r-1)*t,o=Math.floor(i),a=qu(Ku(e,o).subarray(0,o+1));return a+(Xu(e.subarray(o+1))-a)*(i-o)}}function el(e,t){return Qu(e,.5,t)}function*tl(e,t){if(null==t)for(let t of e)null!=t&&""!==t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let r of e)r=t(r,++n,e),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function nl(e,t,n){const r=Float64Array.from(tl(e,n));return r.sort(Hu),t.map((e=>function(e,t,n=Zu){if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e);return a+(+n(e[o+1],o+1,e)-a)*(i-o)}}(r,e)))}function rl(e,t){return nl(e,[.25,.5,.75],t)}function il(e,t){const n=e.length,r=function(e,t){const n=function(e,t){let n,r=0,i=0,o=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(n=t-i,i+=n/++r,o+=n*(t-i));else{let a=-1;for(let s of e)null!=(s=t(s,++a,e))&&(s=+s)>=s&&(n=s-i,i+=n/++r,o+=n*(s-i))}if(r>1)return o/(r-1)}(e,t);return n?Math.sqrt(n):n}(e,t),i=rl(e,t),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}var ol=Math.random;function al(e,t,n,r){r=r||(e=>e);const i=e.length,o=new Float64Array(i);let a,s=0,u=1,l=r(e[0]),c=l,p=l+t;for(;u<i;++u){if(a=r(e[u]),a>=p){for(c=(l+c)/2;s<u;++s)o[s]=c;p=a+t,l=a}c=a}for(c=(l+c)/2;s<u;++s)o[s]=c;return n?function(e,t){const n=e.length;let r,i,o=0,a=1;for(;e[o]===e[a];)++a;for(;a<n;){for(r=a+1;e[a]===e[r];)++r;if(e[a]-e[a-1]<t){for(i=a+(o+r-a-a>>1);i<a;)e[i++]=e[a];for(;i>a;)e[i--]=e[o]}o=a,a=r}return e}(o,t+t/4):o}const sl=Math.sqrt(2*Math.PI),ul=Math.SQRT2;let ll=NaN;function cl(e,t){e=e||0,t=null==t?1:t;let n,r,i=0,o=0;if(ll==ll)i=ll,ll=NaN;else{do{i=2*ol()-1,o=2*ol()-1,n=i*i+o*o}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,ll=o*r}return e+i*t}function pl(e,t,n){const r=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*sl)}function dl(e,t,n){const r=(e-(t=t||0))/(n=null==n?1:n),i=Math.abs(r);let o;if(i>37)o=0;else{const e=Math.exp(-i*i/2);let t;i<7.07106781186547?(t=.0352624965998911*i+.700383064443688,t=t*i+6.37396220353165,t=t*i+33.912866078383,t=t*i+112.079291497871,t=t*i+221.213596169931,t=t*i+220.206867912376,o=e*t,t=.0883883476483184*i+1.75566716318264,t=t*i+16.064177579207,t=t*i+86.7807322029461,t=t*i+296.564248779674,t=t*i+637.333633378831,t=t*i+793.826512519948,t=t*i+440.413735824752,o/=t):(t=i+.65,t=i+4/t,t=i+3/t,t=i+2/t,t=i+1/t,o=e/t/2.506628274631)}return r>0?1-o:o}function hl(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*ul*function(e){let t,n=-Math.log((1-e)*(1+e));return n<6.25?(n-=3.125,t=-364441206401782e-35,t=t*n-16850591381820166e-35,t=128584807152564e-32+t*n,t=11157877678025181e-33+t*n,t=t*n-1333171662854621e-31,t=20972767875968562e-33+t*n,t=6637638134358324e-30+t*n,t=t*n-4054566272975207e-29,t=t*n-8151934197605472e-29,t=26335093153082323e-28+t*n,t=t*n-12975133253453532e-27,t=t*n-5415412054294628e-26,t=1.0512122733215323e-9+t*n,t=t*n-4.112633980346984e-9,t=t*n-2.9070369957882005e-8,t=4.2347877827932404e-7+t*n,t=t*n-13654692000834679e-22,t=t*n-13882523362786469e-21,t=.00018673420803405714+t*n,t=t*n-.000740702534166267,t=t*n-.006033670871430149,t=.24015818242558962+t*n,t=1.6536545626831027+t*n):n<16?(n=Math.sqrt(n)-3.25,t=2.2137376921775787e-9,t=9.075656193888539e-8+t*n,t=t*n-2.7517406297064545e-7,t=1.8239629214389228e-8+t*n,t=15027403968909828e-22+t*n,t=t*n-4013867526981546e-21,t=29234449089955446e-22+t*n,t=12475304481671779e-21+t*n,t=t*n-47318229009055734e-21,t=6828485145957318e-20+t*n,t=24031110387097894e-21+t*n,t=t*n-.0003550375203628475,t=.0009532893797373805+t*n,t=t*n-.0016882755560235047,t=.002491442096107851+t*n,t=t*n-.003751208507569241,t=.005370914553590064+t*n,t=1.0052589676941592+t*n,t=3.0838856104922208+t*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,t=-27109920616438573e-27,t=t*n-2.555641816996525e-10,t=1.5076572693500548e-9+t*n,t=t*n-3.789465440126737e-9,t=7.61570120807834e-9+t*n,t=t*n-1.496002662714924e-8,t=2.914795345090108e-8+t*n,t=t*n-6.771199775845234e-8,t=2.2900482228026655e-7+t*n,t=t*n-9.9298272942317e-7,t=4526062597223154e-21+t*n,t=t*n-1968177810553167e-20,t=7599527703001776e-20+t*n,t=t*n-.00021503011930044477,t=t*n-.00013871931833623122,t=1.0103004648645344+t*n,t=4.849906401408584+t*n):t=1/0,t*e}(2*e-1)}function fl(e,t){let n,r;const i={mean(e){return arguments.length?(n=e||0,i):n},stdev(e){return arguments.length?(r=null==e?1:e,i):r},sample:()=>cl(n,r),pdf:e=>pl(e,n,r),cdf:e=>dl(e,n,r),icdf:e=>hl(e,n,r)};return i.mean(e).stdev(t)}function gl(e,t){const n=fl();let r=0;const i={data(n){return arguments.length?(e=n,r=n?n.length:0,i.bandwidth(t)):e},bandwidth(n){return arguments.length?(!(t=n)&&e&&(t=il(e)),i):t},sample:()=>e[~~(ol()*r)]+t*n.sample(),pdf(i){let o=0,a=0;for(;a<r;++a)o+=n.pdf((i-e[a])/t);return o/t/r},cdf(i){let o=0,a=0;for(;a<r;++a)o+=n.cdf((i-e[a])/t);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function ml(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+cl()*t)}function yl(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*sl*e)}function bl(e,t,n){return dl(Math.log(e),t,n)}function vl(e,t,n){return Math.exp(hl(e,t,n))}function xl(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*ol()}function _l(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function wl(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function kl(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function Sl(e,t,n,r){const i=r-e*e,o=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-o*e,o]}function Cl(e,t,n,r){e=e.filter((e=>{let r=t(e),i=n(e);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i})),r&&e.sort(((e,n)=>t(e)-t(n)));const i=e.length,o=new Float64Array(i),a=new Float64Array(i);let s,u,l,c=0,p=0,d=0;for(l of e)o[c]=s=+t(l),a[c]=u=+n(l),++c,p+=(s-p)/c,d+=(u-d)/c;for(c=0;c<i;++c)o[c]-=p,a[c]-=d;return[o,a,p,d]}function Ml(e,t,n,r){let i,o,a=-1;for(const s of e)i=t(s),o=n(s),null!=i&&(i=+i)>=i&&null!=o&&(o=+o)>=o&&r(i,o,++a)}function Tl(e,t,n,r,i){let o=0,a=0;return Ml(e,t,n,((e,t)=>{const n=t-i(e),s=t-r;o+=n*n,a+=s*s})),1-o/a}function El(e,t,n){let r=0,i=0,o=0,a=0,s=0;Ml(e,t,n,((e,t)=>{++s,r+=(e-r)/s,i+=(t-i)/s,o+=(e*t-o)/s,a+=(e*e-a)/s}));const u=Sl(r,i,o,a),l=e=>u[0]+u[1]*e;return{coef:u,predict:l,rSquared:Tl(e,t,n,i,l)}}function Al(e,t,n){const[r,i,o,a]=Cl(e,t,n),s=r.length;let u,l,c,p,d=0,h=0,f=0,g=0,m=0;for(u=0;u<s;)l=r[u],c=i[u++],p=l*l,d+=(p-d)/u,h+=(p*l-h)/u,f+=(p*p-f)/u,g+=(l*c-g)/u,m+=(p*c-m)/u;const y=f-d*d,b=d*y-h*h,v=(m*d-g*h)/b,x=(g*y-m*h)/b,_=-v*d,w=e=>v*(e-=o)*e+x*e+_+a;return{coef:[_-x*o+v*o*o+a,x-2*v*o,v],predict:w,rSquared:Tl(e,t,n,a,w)}}function Fl(e,t,n,r){const i=Array(e);let o,a,s,u;for(o=0;o<e;++o)i[o]=0;for(o=e-1;o>=0;--o)for(s=t[o],u=1,i[o]+=s,a=1;a<=o;++a)u*=(o+1-a)/a,i[o-a]+=s*Math.pow(n,a)*u;return i[0]+=r,i}function Ol(e){return(e=1-e*e*e)*e*e}function Rl(e,t,n){const r=e[t];let i=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>i&&e[o]-r<=r-e[i];)n[0]=++i,n[1]=o,++o}const Nl=.5*Math.PI/180;function Dl(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=t=>[t,e(t)],o=t[0],a=t[1],s=a-o,u=s/r,l=[i(o)],c=[];if(n===r){for(let e=1;e<r;++e)l.push(i(o+e/n*s));return l.push(i(a)),l}c.push(i(a));for(let e=n;--e>0;)c.push(i(o+e/n*s));let p=l[0],d=c[c.length-1];const h=1/s,f=function(e,t){let n=e,r=e;const i=t.length;for(let e=0;e<i;++e){const i=t[e][1];i<n&&(n=i),i>r&&(r=i)}return 1/(r-n)}(p[1],c);for(;d;){const e=i((p[0]+d[0])/2);e[0]-p[0]>=u&&Il(p,e,d,h,f)>Nl?c.push(e):(p=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function Il(e,t,n,r,i){const o=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),a=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(o-a)}function Bl(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function Ll(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function Pl(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function $l(e,t,n=0,r=e.length-1,i=Pl){for(;r>n;){if(r-n>600){const o=r-n+1,a=t-n+1,s=Math.log(o),u=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*u*(o-u)/o)*(a-o/2<0?-1:1);$l(e,t,Math.max(n,Math.floor(t-a*u/o+l)),Math.min(r,Math.floor(t+(o-a)*u/o+l)),i)}const o=e[t];let a=n,s=r;for(zl(e,n,t),i(e[r],o)>0&&zl(e,n,r);a<s;){for(zl(e,a,s),++a,--s;i(e[a],o)<0;)++a;for(;i(e[s],o)>0;)--s}0===i(e[n],o)?zl(e,n,s):(++s,zl(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function zl(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function jl(e){return null===e?NaN:+e}function Gl(e,t,n){if(e=Float64Array.from(function*(e,t){if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n)),r=e.length){if((t=+t)<=0||r<2)return Ll(e);if(t>=1)return Bl(e);var r,i=(r-1)*t,o=Math.floor(i),a=Bl($l(e,o).subarray(0,o+1));return a+(Ll(e.subarray(o+1))-a)*(i-o)}}function Ul(e,t,n=jl){if(r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e);return a+(+n(e[o+1],o+1,e)-a)*(i-o)}}function Wl(e,t){return Gl(e,.5,t)}function Vl(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(i);++r<i;)o[r]=e+r*n;return o}function Hl(e){let t=e,n=e;function r(e,t,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){const o=r+i>>>1;n(e[o],t)<0?r=o+1:i=o}return r}return 1===e.length&&(t=(t,n)=>e(t)-n,n=function(e){return(t,n)=>Pl(e(t),n)}(e)),{left:r,center:function(e,n,i,o){null==i&&(i=0),null==o&&(o=e.length);const a=r(e,n,i,o-1);return a>i&&t(e[a-1],n)>-t(e[a],n)?a-1:a},right:function(e,t,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){const o=r+i>>>1;n(e[o],t)>0?i=o:r=o+1}return r}}}function ql(e){return e&&e.length?1===e.length?e[0]:(t=e,e=>{const n=t.length;let r=1,i=String(t[0](e));for(;r<n;++r)i+="|"+t[r](e);return i}):function(){return""};var t}function Xl(e,t,n){return n||e+(t?"_"+t:"")}const Yl=()=>{},Kl={init:Yl,add:Yl,rem:Yl,idx:0},Jl={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||void 0===e.min)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||void 0===e.max)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},Zl=Object.keys(Jl);function Ql(e,t){return Jl[e](t)}function ec(e,t){return e.idx-t.idx}function tc(){this.valid=0,this.missing=0,this._ops.forEach((e=>e.init(this)))}function nc(e,t){null!=e&&""!==e?e==e&&(++this.valid,this._ops.forEach((n=>n.add(this,e,t)))):++this.missing}function rc(e,t){null!=e&&""!==e?e==e&&(--this.valid,this._ops.forEach((n=>n.rem(this,e,t)))):--this.missing}function ic(e){return this._out.forEach((t=>e[t.out]=t.value(this))),e}function oc(e,t){const n=t||Yt,r=function(e){const t={};e.forEach((e=>t[e.name]=e));const n=e=>{e.req&&e.req.forEach((e=>{t[e]||n(t[e]=Jl[e]())}))};return e.forEach(n),Object.values(t).sort(ec)}(e),i=e.slice().sort(ec);function o(e){this._ops=r,this._out=i,this.cell=e,this.init()}return o.prototype.init=tc,o.prototype.add=nc,o.prototype.rem=rc,o.prototype.set=ic,o.prototype.get=n,o.fields=e.map((e=>e.out)),o}function ac(e){this._key=e?qt(e):cu,this.reset()}Zl.forEach((e=>{Jl[e]=function(e,t){return n=>In({name:e,out:n||e},Kl,t)}(e,Jl[e])}));const sc=ac.prototype;function uc(e){Gu.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}function lc(e){Gu.call(this,null,e)}function cc(e,t,n){const r=e;let i=t||[],o=n||[],a={},s=0;return{add:e=>o.push(e),remove:e=>a[r(e)]=++s,size:()=>i.length,data:(e,t)=>(s&&(i=i.filter((e=>!a[r(e)])),a={},s=0),t&&e&&i.sort(e),o.length&&(i=e?function(e,t,n,r){const i=t.length,o=n.length;if(!o)return t;if(!i)return n;const a=new t.constructor(i+o);let s=0,u=0,l=0;for(;s<i&&u<o;++l)a[l]=e(t[s],n[u])>0?n[u++]:t[s++];for(;s<i;++s,++l)a[l]=t[s];for(;u<o;++u,++l)a[l]=n[u];return a}(e,i,o.sort(e)):i.concat(o),o=[]),i)}}function pc(e){Gu.call(this,[],e)}function dc(e){ku.call(this,null,hc,e)}function hc(e){return this.value&&!e.modified()?this.value:En(e.fields,e.orders)}function fc(e){Gu.call(this,null,e)}function gc(e){Gu.call(this,null,e)}sc.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},sc.add=function(e){this._add.push(e)},sc.rem=function(e){this._rem.push(e)},sc.values=function(){if(this._get=null,0===this._rem.length)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,o=Array(r-i),a={};let s,u,l;for(s=0;s<i;++s)a[n(t[s])]=1;for(s=0,u=0;s<r;++s)a[n(l=e[s])]?a[n(l)]=0:o[u++]=l;return this._rem=[],this._add=o},sc.distinct=function(e){const t=this.values(),n={};let r,i=t.length,o=0;for(;--i>=0;)r=e(t[i])+"",Pn(n,r)||(n[r]=1,++o);return o},sc.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=function(e,t){const n=e.length;let r,i,o,a,s,u=-1;if(null==t){for(;++u<n;)if(i=e[u],null!=i&&i>=i){r=o=i;break}if(u===n)return[-1,-1];for(a=s=u;++u<n;)i=e[u],null!=i&&(r>i&&(r=i,a=u),o<i&&(o=i,s=u))}else{for(;++u<n;)if(i=t(e[u],u,e),null!=i&&i>=i){r=o=i;break}if(u===n)return[-1,-1];for(a=s=u;++u<n;)i=t(e[u],u,e),null!=i&&(r>i&&(r=i,a=u),o<i&&(o=i,s=u))}return[a,s]}(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},sc.argmin=function(e){return this.extent(e)[0]||{}},sc.argmax=function(e){return this.extent(e)[1]||{}},sc.min=function(e){const t=this.extent(e)[0];return null!=t?e(t):void 0},sc.max=function(e){const t=this.extent(e)[1];return null!=t?e(t):void 0},sc.quartile=function(e){return this._get===e&&this._q||(this._q=rl(this.values(),e),this._get=e),this._q},sc.q1=function(e){return this.quartile(e)[0]},sc.q2=function(e){return this.quartile(e)[1]},sc.q3=function(e){return this.quartile(e)[2]},sc.ci=function(e){return this._get===e&&this._ci||(this._ci=function(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(tl(e,r)),o=i.length;let a,s,u,l;for(u=0,l=Array(1e3);u<1e3;++u){for(a=0,s=0;s<o;++s)a+=i[~~(ol()*o)];l[u]=a/o}return l.sort(Hu),[Qu(l,.025),Qu(l,.975)]}(this.values(),0,0,e),this._get=e),this._ci},sc.ci0=function(e){return this.ci(e)[0]},sc.ci1=function(e){return this.ci(e)[1]},uc.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Zl},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},jn(uc,Gu,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):{},t.visit(t.SOURCE,(e=>n.add(e)))):(n.value=n.value||n.init(e),t.visit(t.REM,(e=>n.rem(e))),t.visit(t.ADD,(e=>n.add(e)))),r.modifies(n._outputs),n._drop=!1!==e.drop,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter((()=>this.clean())),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map((()=>({}))),i=n.length;function o(e){let t,o,a,s;for(t in e)for(a=e[t].tuple,o=0;o<i;++o)r[o][s=a[n[o]]]=s}o(e._prev),o(t),function o(a,s,u){const l=n[u],c=r[u++];for(const n in c){const r=a?a+"|"+n:n;s[l]=c[n],u<i?o(r,s,u):t[r]||e.cell(r,s)}}("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(e){const n=Cn(jt(e)),i=n.length;let o,a=0;for(;a<i;++a)r[o=n[a]]||(r[o]=1,t.push(o))}this._dims=Cn(e.groupby),this._dnames=this._dims.map((e=>{const t=zt(e);return i(e),n.push(t),t})),this.cellkey=e.key?e.key:ql(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],a=e.ops||["count"],s=e.as||[],u=o.length,l={};let c,p,d,h,f,g;for(u!==a.length&&Vt("Unmatched number of fields and aggregate ops."),g=0;g<u;++g)c=o[g],p=a[g],null==c&&"count"!==p&&Vt("Null aggregate field specified."),h=zt(c),f=Xl(p,h,s[g]),n.push(f),"count"!==p?(d=l[h],d||(i(c),d=l[h]=[],d.field=c,this._measures.push(d)),"count"!==p&&(this._countOnly=!1),d.push(Ql(p,f))):this._counts.push(f);return this._measures=this._measures.map((e=>oc(e,e.field))),{}},cellkey:ql(),cell(e,t){let n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const e=this._measures,t=e.length;n.agg=Array(t);for(let r=0;r<t;++r)n.agg[r]=new e[r](n)}return n.store&&(n.data=new ac),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,o={};for(let t=0;t<i;++t)o[n[t]]=r[t](e);return t?gu(t.tuple,o):du(o)},clean(){const e=this.value;for(const t in e)0===e[t].num&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let t=0,n=r.length;t<n;++t)r[t].add(r[t].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let t=0,n=r.length;t<n;++t)r[t].rem(r[t].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const n=e.agg;for(let e=0,r=n.length;e<r;++e)n[e].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,o=e.add,a=e.rem,s=e.mod;let u,l,c,p;if(r)for(l in r)u=r[l],i&&!u.num||a.push(u.tuple);for(c=0,p=this._alen;c<p;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,p=this._mlen;c<p;++c)u=n[c],(0===u.num&&i?a:s).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}}),lc.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},jn(lc,Gu,{transform(e,t){const n=!1!==e.interval,r=this._bins(e),i=r.start,o=r.step,a=e.as||["bin0","bin1"],s=a[0],u=a[1];let l;return l=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(jt(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?e=>{const t=r(e);e[s]=t,e[u]=null==t?null:i+o*(1+(t-i)/o)}:e=>e[s]=r(e)),t.modifies(n?a:s)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=function(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let o,a,s,u,l,c,p=e.extent[0],d=e.extent[1];const h=e.span||d-p||Math.abs(p)||1;if(e.step)o=e.step;else if(e.steps){for(u=h/t,l=0,c=e.steps.length;l<c&&e.steps[l]<u;++l);o=e.steps[Math.max(0,l-1)]}else{for(a=Math.ceil(Math.log(t)/r),s=e.minstep||0,o=Math.max(s,Math.pow(n,Math.round(Math.log(h)/r)-a));Math.ceil(h/o)>t;)o*=n;for(l=0,c=i.length;l<c;++l)u=o/i[l],u>=s&&h/u<=t&&(o=u)}u=Math.log(o);const f=u>=0?0:1+~~(-u/r),g=Math.pow(n,-f-1);return(e.nice||void 0===e.nice)&&(u=Math.floor(p/o+g)*o,p=p<u?u-o:u,d=Math.ceil(d/o)*o),{start:p,stop:d===p?p+o:d,step:o}}(e),r=n.step;let i,o,a=n.start,s=a+Math.ceil((n.stop-a)/r)*r;null!=(i=e.anchor)&&(o=i-(a+r*Math.floor((i-a)/r)),a+=o,s+=o);const u=function(e){let n=hn(t(e));return null==n?null:n<a?-1/0:n>s?1/0:(n=Math.max(a,Math.min(n,s-r)),a+r*Math.floor(1e-14+(n-a)/r))};return u.start=a,u.stop=n.stop,u.step=r,this.value=$t(u,jt(t),e.name||"bin_"+zt(t))}}),pc.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},jn(pc,Gu,{transform(e,t){const n=t.fork(t.ALL),r=cc(cu,this.value,n.materialize(n.ADD).add),i=e.sort,o=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(mu(i),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}}),jn(dc,ku),fc.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},jn(fc,Gu,{transform(e,t){const n=t=>n=>{for(var r,i=function(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e.match(n)}(s(n),e.case,o)||[],u=0,l=i.length;u<l;++u)a.test(r=i[u])||t(r)},r=this._parameterCheck(e,t),i=this._counts,o=this._match,a=this._stop,s=e.field,u=e.as||["text","count"],l=n((e=>i[e]=1+(i[e]||0))),c=n((e=>i[e]-=1));return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return!e.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),!e.modified("pattern")&&this._match||(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],o=t[1],a=e.fork(e.NO_SOURCE|e.NO_FIELDS);let s,u,l;for(s in n)u=r[s],l=n[s]||0,!u&&l?(r[s]=u=du({}),u[i]=s,u[o]=l,a.add.push(u)):0===l?(u&&a.rem.push(u),n[s]=null,r[s]=null):u[o]!==l&&(u[o]=l,a.mod.push(u));return a.modifies(t)}}),gc.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},jn(gc,Gu,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],o=r[1],a=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let s=this.value;return a?(s&&(n.rem=s),s=t.materialize(t.SOURCE).source,n.add=this.value=function(e,t,n,r){for(var i,o,a=[],s={},u=e.length,l=0;l<u;++l)for(s[t]=o=e[l],i=0;i<u;++i)s[n]=e[i],r(s)&&(a.push(du(s)),(s={})[t]=o);return a}(s,i,o,e.filter||Zt)):n.mod=s,n.source=this.value,n.modifies(r)}});const mc={kde:gl,mixture:function(e,t){let n,r=0;const i={weights(e){return arguments.length?(n=function(e){const t=[];let n,i=0;for(n=0;n<r;++n)i+=t[n]=null==e[n]?1:+e[n];for(n=0;n<r;++n)t[n]/=i;return t}(t=e||[]),i):t},distributions(n){return arguments.length?(n?(r=n.length,e=n):(r=0,e=[]),i.weights(t)):e},sample(){const t=ol();let i=e[r-1],o=n[0],a=0;for(;a<r-1;o+=n[++a])if(t<o){i=e[a];break}return i.sample()},pdf(t){let i=0,o=0;for(;o<r;++o)i+=n[o]*e[o].pdf(t);return i},cdf(t){let i=0,o=0;for(;o<r;++o)i+=n[o]*e[o].cdf(t);return i},icdf(){throw Error("Mixture icdf not supported.")}};return i.distributions(e).weights(t)},normal:fl,lognormal:function(e,t){let n,r;const i={mean(e){return arguments.length?(n=e||0,i):n},stdev(e){return arguments.length?(r=null==e?1:e,i):r},sample:()=>ml(n,r),pdf:e=>yl(e,n,r),cdf:e=>bl(e,n,r),icdf:e=>vl(e,n,r)};return i.mean(e).stdev(t)},uniform:function(e,t){let n,r;const i={min(e){return arguments.length?(n=e||0,i):n},max(e){return arguments.length?(r=null==e?1:e,i):r},sample:()=>xl(n,r),pdf:e=>_l(e,n,r),cdf:e=>wl(e,n,r),icdf:e=>kl(e,n,r)};return null==t&&(t=null==e?1:e,e=0),i.min(e).max(t)}},yc="function";function bc(e,t){const n=e[yc];Pn(mc,n)||Vt("Unknown distribution function: "+n);const r=mc[n]();for(const n in e)"field"===n?r.data((e.from||t()).map(e[n])):"distributions"===n?r[n](e[n].map((e=>bc(e,t)))):typeof r[n]===yc&&r[n](e[n]);return r}function vc(e){Gu.call(this,null,e)}const xc=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],_c={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:xc},{name:"weights",type:"number",array:!0}]};function wc(e,t){return e?e.map(((e,n)=>t[n]||zt(e))):null}function kc(e,t,n){const r=[],i=e=>e(u);let o,a,s,u,l,c;if(null==t)r.push(e.map(n));else for(o={},a=0,s=e.length;a<s;++a)u=e[a],l=t.map(i),c=o[l],c||(o[l]=c=[],c.dims=l,r.push(c)),c.push(n(u));return r}function Sc(e){Gu.call(this,null,e)}function Cc(e){ku.call(this,null,Mc,e),this.modified(!0)}function Mc(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:$t((n=>t(n,e)),jt(t),zt(t))}function Tc(e){Gu.call(this,[void 0,void 0],e)}function Ec(e,t){ku.call(this,e),this.parent=t,this.count=0}function Ac(e){Gu.call(this,{},e),this._keys=zn();const t=this._targets=[];t.active=0,t.forEach=e=>{for(let n=0,r=t.active;n<r;++n)e(t[n],n,t)}}function Fc(e){ku.call(this,null,Oc,e)}function Oc(e){return this.value&&!e.modified()?this.value:sn(e.name)?Cn(e.name).map((e=>qt(e))):qt(e.name,e.as)}function Rc(e){Gu.call(this,zn(),e)}function Nc(e){Gu.call(this,[],e)}function Dc(e){Gu.call(this,[],e)}function Ic(e){Gu.call(this,null,e)}function Bc(e){Gu.call(this,[],e)}vc.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:xc.concat(_c)},{name:"as",type:"string",array:!0,default:["value","density"]}]},jn(vc,Gu,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=bc(e.distribution,function(e){return()=>e.materialize(e.SOURCE).source}(t)),i=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let a=e.method||"pdf";"pdf"!==a&&"cdf"!==a&&Vt("Invalid density method: "+a),e.extent||r.data||Vt("Missing density extent parameter."),a=r[a];const s=e.as||["value","density"],u=Dl(a,e.extent||Bn(r.data()),i,o).map((e=>{const t={};return t[s[0]]=e[0],t[s[1]]=e[1],du(t)}));this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}}),Sc.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]},jn(Sc,Gu,{transform(e,t){if(this.value&&!e.modified()&&!t.changed())return t;const n=t.materialize(t.SOURCE).source,r=kc(t.source,e.groupby,Yt),i=e.smooth||!1,o=e.field,a=e.step||((e,t)=>Xn(Bn(e,t))/30)(n,o),s=mu(((e,t)=>o(e)-o(t))),u=e.as||"bin",l=r.length;let c,p=1/0,d=-1/0,h=0;for(;h<l;++h){const e=r[h].sort(s);c=-1;for(const t of al(e,a,i,o))t<p&&(p=t),t>d&&(d=t),e[++c][u]=t}return this.value={start:p,stop:d,step:a},t.reflow(!0).modifies(u)}}),jn(Cc,ku),Tc.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},jn(Tc,Gu,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let o=n[0],a=n[1];if((i||null==o)&&(o=1/0,a=-1/0),t.visit(i?t.SOURCE:t.ADD,(e=>{const t=hn(r(e));null!=t&&(t<o&&(o=t),t>a&&(a=t))})),!Number.isFinite(o)||!Number.isFinite(a)){let e=zt(r);e&&(e=` for field "${e}"`),t.dataflow.warn(`Infinite extent${e}: [${o}, ${a}]`),o=a=void 0}this.value=[o,a]}}),jn(Ec,ku,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}}),jn(Ac,Gu,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let o,a,s=Pn(i,e)&&i[e];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=r||(a=this._group[e])&&a.tuple,o=n.dataflow,s=new Ec(n.fork(n.NO_SOURCE),this),o.add(s).connect(t(o,e,a)),i[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(0===e[n].count){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const e=this._targets.filter((e=>e&&e.count>0));this.initTargets(e)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&null!=t[i];++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,o=this._keys,a=e.modified("key"),s=e=>this.subflow(e,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,(e=>{const t=cu(e),n=o.get(t);void 0!==n&&(o.delete(t),s(n).rem(e))})),t.visit(t.ADD,(e=>{const t=r(e);o.set(cu(e),t),s(t).add(e)})),a||t.modified(r.fields)?t.visit(t.MOD,(e=>{const t=cu(e),n=o.get(t),i=r(e);n===i?s(i).mod(e):(o.set(t,i),s(n).rem(e),s(i).add(e))})):t.changed(t.MOD)&&t.visit(t.MOD,(e=>{s(o.get(cu(e))).mod(e)})),a&&t.visit(t.REFLOW,(e=>{const t=cu(e),n=o.get(t),i=r(e);n!==i&&(o.set(t,i),s(n).rem(e),s(i).add(e))})),t.clean()?n.runAfter((()=>{this.clean(),o.clean()})):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}}),jn(Fc,ku),Rc.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},jn(Rc,Gu,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),o=i.add,a=i.rem,s=i.mod,u=e.expr;let l=!0;function c(t){const n=cu(t),i=u(t,e),c=r.get(n);i&&c?(r.delete(n),o.push(t)):i||c?l&&i&&!c&&s.push(t):(r.set(n,1),a.push(t))}return t.visit(t.REM,(e=>{const t=cu(e);r.has(t)?r.delete(t):a.push(e)})),t.visit(t.ADD,(t=>{u(t,e)?o.push(t):r.set(cu(t),1)})),t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}}),Nc.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},jn(Nc,Gu,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=wc(r,e.as||[]),o=e.index||null,a=i.length;return n.rem=this.value,t.visit(t.SOURCE,(e=>{const t=r.map((t=>t(e))),s=t.reduce(((e,t)=>Math.max(e,t.length)),0);let u,l,c,p=0;for(;p<s;++p){for(l=hu(e),u=0;u<a;++u)l[i[u]]=null==(c=t[u][p])?null:c;o&&(l[o]=p),n.add.push(l)}})),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}}),Dc.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},jn(Dc,Gu,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(zt),o=e.as||["key","value"],a=o[0],s=o[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,(e=>{for(let t,o=0;o<u;++o)t=hu(e),t[a]=i[o],t[s]=r[o](e),n.add.push(t)})),this.value=n.source=n.add,n.modifies(o)}}),Ic.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},jn(Ic,Gu,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),o=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(o,(t=>t[r]=n(t,e)))}}),jn(Bc,Gu,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i,o,a,s=this.value,u=e.size-s.length;if(u>0){for(i=[];--u>=0;)i.push(a=du(r(e))),s.push(a);n.add=n.add.length?n.materialize(n.ADD).add.concat(i):i}else o=s.slice(0,-u),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(o):o,s=s.slice(-u);return n.source=this.value=s,n}});const Lc={value:"value",median:Wl,mean:function(e,t){let n=0,r=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(++n,r+=t);else{let i=-1;for(let o of e)null!=(o=t(o,++i,e))&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n},min:Ll,max:Bl},Pc=[];function $c(e){Gu.call(this,[],e)}function zc(e){uc.call(this,e)}function jc(e){Gu.call(this,null,e)}function Gc(e){ku.call(this,null,Uc,e)}function Uc(e){return this.value&&!e.modified()?this.value:Hn(e.fields,e.flat)}function Wc(e){Gu.call(this,[],e),this._pending=null}function Vc(e,t,n){n.forEach(du);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function Hc(e){Gu.call(this,{},e)}function qc(e){ku.call(this,null,Xc,e)}function Xc(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r,i,o=1/0,a=-1/0;for(r=0;r<n;++r)i=t[r],i[0]<o&&(o=i[0]),i[1]>a&&(a=i[1]);return[o,a]}function Yc(e){ku.call(this,null,Kc,e)}function Kc(e){return this.value&&!e.modified()?this.value:e.values.reduce(((e,t)=>e.concat(t)),[])}function Jc(e){Gu.call(this,null,e)}function Zc(e){uc.call(this,e)}function Qc(e){Ac.call(this,e)}function ep(e){Gu.call(this,null,e)}function tp(e){Gu.call(this,null,e)}function np(e){Gu.call(this,null,e)}function rp(e){Gu.call(this,null,e)}function ip(e){Gu.call(this,[],e),this.count=0}function op(e){Gu.call(this,null,e)}function ap(e){Gu.call(this,null,e),this.modified(!0)}function sp(e){Gu.call(this,null,e)}$c.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},jn($c,Gu,{transform(e,t){var n,r,i,o,a,s,u,l,c,p,d=t.fork(t.ALL),h=function(e){var t,n=e.method||Lc.value;if(null!=Lc[n])return n===Lc.value?(t=void 0!==e.value?e.value:0,()=>t):Lc[n];Vt("Unrecognized imputation method: "+n)}(e),f=function(e){const t=e.field;return e=>e?t(e):NaN}(e),g=zt(e.field),m=zt(e.key),y=(e.groupby||[]).map(zt),b=function(e,t,n,r){var i,o,a,s,u,l,c,p,d=e=>e(p),h=[],f=r?r.slice():[],g={},m={};for(f.forEach(((e,t)=>g[e]=t+1)),s=0,c=e.length;s<c;++s)l=n(p=e[s]),u=g[l]||(g[l]=f.push(l)),(a=m[o=(i=t?t.map(d):Pc)+""])||(a=m[o]=[],h.push(a),a.values=i),a[u-1]=p;return h.domain=f,h}(t.source,e.groupby,e.key,e.keyvals),v=[],x=this.value,_=b.domain.length;for(a=0,l=b.length;a<l;++a)for(i=(n=b[a]).values,r=NaN,u=0;u<_;++u)if(null==n[u]){for(o=b.domain[u],p={_impute:!0},s=0,c=i.length;s<c;++s)p[y[s]]=i[s];p[m]=o,p[g]=Number.isNaN(r)?r=h(n,f):r,v.push(du(p))}return v.length&&(d.add=d.materialize(d.ADD).add.concat(v)),x.length&&(d.rem=d.materialize(d.REM).rem.concat(x)),this.value=v,d}}),zc.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Zl},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},jn(zc,uc,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,(e=>n.add(e)))):(i=n.value=n.value||this.init(e),t.visit(t.REM,(e=>n.rem(e))),t.visit(t.ADD,(e=>n.add(e)))),n.changes(),t.visit(t.SOURCE,(e=>{In(e,i[n.cellkey(e)].tuple)})),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}}),jc.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},jn(jc,Gu,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=kc(r,e.groupby,e.field),o=(e.groupby||[]).map(zt),a=e.bandwidth,s=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,p=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;"pdf"!==s&&"cdf"!==s&&Vt("Invalid density method: "+s),"shared"===e.resolve&&(c||(c=Bn(r,e.field)),p=d=e.steps||d),i.forEach((t=>{const n=gl(t,a)[s],r=e.counts?t.length:1;Dl(n,c||Bn(t),p,d).forEach((e=>{const n={};for(let e=0;e<o.length;++e)n[o[e]]=t.dims[e];n[u[0]]=e[0],n[u[1]]=e[1]*r,l.push(du(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}}),jn(Gc,ku),jn(Wc,Gu,{transform(e,t){const n=t.dataflow;if(this._pending)return Vc(this,t,this._pending);if(function(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}(e))return t.StopPropagation;if(e.values)return Vc(this,t,n.parse(e.values,e.format));if(e.async){const t=n.request(e.url,e.format).then((e=>(this._pending=Cn(e.data),e=>e.touch(this))));return{async:t}}return n.request(e.url,e.format).then((e=>Vc(this,t,Cn(e.data))))}}),Hc.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},jn(Hc,Gu,{transform(e,t){const n=e.fields,r=e.index,i=e.values,o=null==e.default?null:e.default,a=e.modified(),s=n.length;let u,l,c,p=a?t.SOURCE:t.ADD,d=t,h=e.as;return i?(l=i.length,s>1&&!h&&Vt('Multi-field lookup requires explicit "as" parameter.'),h&&h.length!==s*l&&Vt('The "as" parameter has too few output field names.'),h=h||i.map(zt),u=function(e){for(var t,a,u=0,c=0;u<s;++u)if(null==(a=r.get(n[u](e))))for(t=0;t<l;++t,++c)e[h[c]]=o;else for(t=0;t<l;++t,++c)e[h[c]]=i[t](a)}):(h||Vt("Missing output field names."),u=function(e){for(var t,i=0;i<s;++i)t=r.get(n[i](e)),e[h[i]]=null==t?o:t}),a?d=t.reflow(!0):(c=n.some((e=>t.modified(e.fields))),p|=c?t.MOD:0),t.visit(p,u),d.modifies(h)}}),jn(qc,ku),jn(Yc,ku),jn(Jc,Gu,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),Zc.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Zl,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},jn(Zc,uc,{_transform:uc.prototype.transform,transform(e,t){return this._transform(function(e,t){const n=e.field,r=e.value,i=("count"===e.op?"__count__":e.op)||"sum",o=jt(n).concat(jt(r)),a=function(e,t,n){const r={},i=[];return n.visit(n.SOURCE,(t=>{const n=e(t);r[n]||(r[n]=1,i.push(n))})),i.sort(An),t?i.slice(0,t):i}(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:a.map((()=>i)),fields:a.map((e=>function(e,t,n,r){return $t((r=>t(r)===e?n(r):NaN),r,e+"")}(e,n,r,o))),as:a.map((e=>e+"")),modified:e.modified.bind(e)}}(e,t),t)}}),jn(Qc,Ac,{transform(e,t){const n=e.subflow,r=e.field,i=e=>this.subflow(cu(e),n,t,e);return(e.modified("field")||r&&t.modified(jt(r)))&&Vt("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,(e=>{const t=i(e);r(e).forEach((e=>t.mod(e)))})),t.visit(t.ADD,(e=>{const t=i(e);r(e).forEach((e=>t.add(du(e))))})),t.visit(t.REM,(e=>{const t=i(e);r(e).forEach((e=>t.rem(e)))}))):(t.visit(t.MOD,(e=>i(e).mod(e))),t.visit(t.ADD,(e=>i(e).add(e))),t.visit(t.REM,(e=>i(e).rem(e)))),t.clean()&&t.runAfter((()=>this.clean())),t}}),ep.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},jn(ep,Gu,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=wc(e.fields,e.as||[]),o=r?(e,t)=>function(e,t,n,r){for(let i=0,o=n.length;i<o;++i)t[r[i]]=n[i](e);return t}(e,t,r,i):fu;let a;return this.value?a=this.value:(t=t.addAll(),a=this.value={}),t.visit(t.REM,(e=>{const t=cu(e);n.rem.push(a[t]),a[t]=null})),t.visit(t.ADD,(e=>{const t=o(e,du({}));a[cu(e)]=t,n.add.push(t)})),t.visit(t.MOD,(e=>{n.mod.push(o(e,a[cu(e)]))})),n}}),jn(tp,Gu,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}}),np.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]},jn(np,Gu,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=kc(t.materialize(t.SOURCE).source,e.groupby,e.field),o=(e.groupby||[]).map(zt),a=[],s=e.step||.01,u=e.probs||Vl(s/2,1-1e-14,s),l=u.length;return i.forEach((e=>{const t=nl(e,u);for(let n=0;n<l;++n){const i={};for(let t=0;t<o.length;++t)i[o[t]]=e.dims[t];i[r[0]]=u[n],i[r[1]]=t[n],a.push(du(i))}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}}),jn(rp,Gu,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,(e=>{const t=cu(e);n.rem.push(r[t]),r[t]=null})),t.visit(t.ADD,(e=>{const t=hu(e);r[cu(e)]=t,n.add.push(t)})),t.visit(t.MOD,(e=>{const t=r[cu(e)];for(const r in e)t[r]=e[r],n.modifies(r);n.mod.push(t)}))),n}}),ip.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},jn(ip,Gu,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,o=this.value.reduce(((e,t)=>(e[cu(t)]=1,e)),{});let a=this.value,s=this.count,u=0;function l(e){let t,r;a.length<i?a.push(e):(r=~~((s+1)*ol()),r<a.length&&r>=u&&(t=a[r],o[cu(t)]&&n.rem.push(t),a[r]=e)),++s}if(t.rem.length&&(t.visit(t.REM,(e=>{const t=cu(e);o[t]&&(o[t]=-1,n.rem.push(e)),--s})),a=a.filter((e=>-1!==o[cu(e)]))),(t.rem.length||r)&&a.length<i&&t.source&&(u=s=a.length,t.visit(t.SOURCE,(e=>{o[cu(e)]||l(e)})),u=-1),r&&a.length>i){const e=a.length-i;for(let t=0;t<e;++t)o[cu(a[t])]=-1,n.rem.push(a[t]);a=a.slice(e)}return t.mod.length&&t.visit(t.MOD,(e=>{o[cu(e)]&&n.mod.push(e)})),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=a.filter((e=>!o[cu(e)]))),this.count=s,this.value=n.source=a,n}}),op.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},jn(op,Gu,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Vl(e.start,e.stop,e.step||1).map((e=>{const t={};return t[r]=e,du(t)})),n.add=t.add.concat(this.value),n}}),jn(ap,Gu,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});const up=["unit0","unit1"];function lp(e){Gu.call(this,zn(),e)}function cp(e){Gu.call(this,null,e)}sp.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:ji,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:up}]},jn(sp,Gu,{transform(e,t){const n=e.field,r=!1!==e.interval,i="utc"===e.timezone,o=this._floor(e,t),a=(i?ho:po)(o.unit).offset,s=e.as||up,u=s[0],l=s[1],c=o.step;let p=o.start||1/0,d=o.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(jt(n)))&&(h=(t=t.reflow(!0)).SOURCE,p=1/0,d=-1/0),t.visit(h,(e=>{const t=n(e);let i,s;null==t?(e[u]=null,r&&(e[l]=null)):(e[u]=i=s=o(t),r&&(e[l]=s=a(i,c)),i<p&&(p=i),s>d&&(d=s))})),o.start=p,o.stop=d,t.modifies(r?s:u)},_floor(e,t){const n="utc"===e.timezone,{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:function(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(Xn(t))/n;let i,o,a=function(e){let t,n,r;function i(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<0?i=t+1:o=t}while(i<o)}return i}return 2!==e.length?(t=_i,n=(t,n)=>_i(e(t),n),r=(t,n)=>e(t)-n):(t=e===_i||e===wi?e:ki,n=e,r=e),{left:i,center:function(e,t,n=0,o=e.length){const a=i(e,t,n,o-1);return a>n&&r(e[a-1],t)>-r(e[a],t)?a-1:a},right:function(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<=0?i=t+1:o=t}while(i<o)}return i}}}((e=>e[2])).right(So,r);return a===So.length?(i=ko,o=Ai(t[0]/mo,t[1]/mo,n)):a?(a=So[r/So[a-1][2]<So[a][2]/r?a-1:a],i=a[0],o=a[1]):(i=yo,o=Math.max(Ai(t[0],t[1],n),1)),{units:i,step:o}}({extent:e.extent||Bn(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=Ui(r),a=this.value||{},s=(n?uo:oo)(o,i);return s.unit=dn(o),s.units=o,s.step=i,s.start=a.start,s.stop=a.stop,this.value=s}}),jn(lp,Gu,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,o=e=>i.set(r(e),e);let a=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,(e=>i.delete(r(e)))),t.visit(t.ADD,o)):a=!1,this.modified(a),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}}),jn(cp,Gu,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(mu(e.sort)):t.source).map(e.field))}});const pp={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=pp.rank(),t=e.next;return{init:e.init,next:e=>(t(e)-1)/(e.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){(t=+t)>0||Vt("ntile num must be greater than zero.");const n=pp.cume_dist(),r=n.next;return{init:n.init,next:e=>Math.ceil(t*r(e))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return(t=+t)>0||Vt("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return null!=r?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=function(e,t,n){for(let r=t.length;n<r;++n)if(null!=e(t[n]))return n;return-1}(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}},dp=Object.keys(pp);function hp(e){const t=Cn(e.ops),n=Cn(e.fields),r=Cn(e.params),i=Cn(e.as),o=this.outputs=[],a=this.windows=[],s={},u={},l=[],c=[];let p=!0;function d(e){Cn(jt(e)).forEach((e=>s[e]=1))}d(e.sort),t.forEach(((e,t)=>{const s=n[t],h=zt(s),f=Xl(e,h,i[t]);if(d(s),o.push(f),Pn(pp,e))a.push(function(e,t,n,r){const i=pp[e](t,n);return{init:i.init||Kt,update:function(e,t){t[r]=i.next(e)}}}(e,n[t],r[t],f));else{if(null==s&&"count"!==e&&Vt("Null aggregate field specified."),"count"===e)return void l.push(f);p=!1;let t=u[h];t||(t=u[h]=[],t.field=s,c.push(t)),t.push(Ql(e,f))}})),(l.length||c.length)&&(this.cell=function(e,t,n){e=e.map((e=>oc(e,e.field)));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,o=r.agg=Array(i),a=0;a<i;++a)o[a]=new e[a](r);if(r.store)var s=r.data=new ac;return r.add=function(e){if(r.num+=1,!n){s&&s.add(e);for(let t=0;t<i;++t)o[t].add(o[t].get(e),e)}},r.rem=function(e){if(r.num-=1,!n){s&&s.rem(e);for(let t=0;t<i;++t)o[t].rem(o[t].get(e),e)}},r.set=function(e){let i,a;for(s&&s.values(),i=0,a=t.length;i<a;++i)e[t[i]]=r.num;if(!n)for(i=0,a=o.length;i<a;++i)o[i].set(e)},r.init=function(){r.num=0,s&&s.reset();for(let e=0;e<i;++e)o[e].init()},r}(c,l,p)),this.inputs=Object.keys(s)}const fp=hp.prototype;function gp(e){Gu.call(this,{},e),this._mlen=0,this._mods=[]}function mp(e,t,n,r){const i=r.sort,o=i&&!r.ignorePeers,a=r.frame||[null,0],s=e.data(n),u=s.length,l=o?Hl(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||Nn(-1)};t.init();for(let e=0;e<u;++e)yp(c,a,e,u),o&&bp(c,l),t.update(c,s[e])}function yp(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function bp(e,t){const n=e.i0,r=e.i1-1,i=e.compare,o=e.data,a=o.length-1;n>0&&!i(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),r<a&&!i(o[r],o[r+1])&&(e.i1=t.right(o,o[r]))}function vp(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function xp(e){this._context=e}function _p(){}function wp(e){this._context=e}function kp(e){this._context=e}function Sp(e,t){this._basis=new xp(e),this._beta=t}fp.init=function(){this.windows.forEach((e=>e.init())),this.cell&&this.cell.init()},fp.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,o=r&&r.length;let a;if(n){for(a=e.p0;a<e.i0;++a)n.rem(i[a]);for(a=e.p1;a<e.i1;++a)n.add(i[a]);n.set(t)}for(a=0;a<o;++a)r[a].update(e,t)},gp.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:dp.concat(Zl)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},jn(gp,Gu,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=mu(e.sort),i=ql(e.groupby),o=e=>this.group(i(e));let a=this.state;a&&!n||(a=this.state=new hp(e)),n||t.modified(a.inputs)?(this.value={},t.visit(t.SOURCE,(e=>o(e).add(e)))):(t.visit(t.REM,(e=>o(e).remove(e))),t.visit(t.ADD,(e=>o(e).add(e))));for(let t=0,n=this._mlen;t<n;++t)mp(this._mods[t],a,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(a.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=cc(cu),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}}),xp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:vp(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:vp(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},wp.prototype={areaStart:_p,areaEnd:_p,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:vp(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},kp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:vp(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Sp.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,i=e[0],o=t[0],a=e[n]-i,s=t[n]-o,u=-1;++u<=n;)r=u/n,this._basis.point(this._beta*e[u]+(1-this._beta)*(i+r*a),this._beta*t[u]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const Cp=function e(t){function n(e){return 1===t?new xp(e):new Sp(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function Mp(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Tp(e,t){this._context=e,this._k=(1-t)/6}Tp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Mp(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Mp(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Ep=function e(t){function n(e){return new Tp(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Ap(e,t){this._context=e,this._k=(1-t)/6}Ap.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Mp(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Fp=function e(t){function n(e){return new Ap(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Op(e,t){this._context=e,this._k=(1-t)/6}Op.prototype={areaStart:_p,areaEnd:_p,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Mp(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Rp=function e(t){function n(e){return new Op(e,t)}return n.tension=function(t){return e(+t)},n}(0),Np=Math.abs,Dp=Math.atan2,Ip=Math.cos,Bp=Math.max,Lp=Math.min,Pp=Math.sin,$p=Math.sqrt,zp=1e-12,jp=Math.PI,Gp=jp/2,Up=2*jp;function Wp(e){return e>=1?Gp:e<=-1?-Gp:Math.asin(e)}function Vp(e,t,n){var r=e._x1,i=e._y1,o=e._x2,a=e._y2;if(e._l01_a>zp){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>zp){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,a,e._x2,e._y2)}function Hp(e,t){this._context=e,this._alpha=t}Hp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Vp(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const qp=function e(t){function n(e){return t?new Hp(e,t):new Tp(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Xp(e,t){this._context=e,this._alpha=t}Xp.prototype={areaStart:_p,areaEnd:_p,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Vp(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Yp=function e(t){function n(e){return t?new Xp(e,t):new Op(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Kp(e,t){this._context=e,this._alpha=t}Kp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Vp(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Jp=function e(t){function n(e){return t?new Kp(e,t):new Ap(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Zp(e){this._context=e}function Qp(e){return new Zp(e)}function ed(e){this._context=e}function td(e){return e<0?-1:1}function nd(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(td(o)+td(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function rd(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function id(e,t,n){var r=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,i+s*t,o-s,a-s*n,o,a)}function od(e){this._context=e}function ad(e){this._context=new sd(e)}function sd(e){this._context=e}function ud(e){this._context=e}function ld(e){var t,n,r=e.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/o[t-1],o[t]-=n,a[t]-=n*a[t-1];for(i[r-1]=a[r-1]/o[r-1],t=r-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function cd(e,t){this._context=e,this._t=t}function pd(e){return function(){return e}}Zp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},ed.prototype={areaStart:_p,areaEnd:_p,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},od.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:id(this,this._t0,rd(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,id(this,rd(this,n=nd(this,e,t)),n);break;default:id(this,this._t0,n=nd(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(ad.prototype=Object.create(od.prototype)).point=function(e,t){od.prototype.point.call(this,t,e)},sd.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}},ud.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=ld(e),i=ld(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[a],t[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},cd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};const dd=Math.PI,hd=2*dd,fd=1e-6,gd=hd-fd;function md(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class yd{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?md:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return md;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,n,r){this._append`Q${+e},${+t},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(e,t,n,r,i,o){this._append`C${+e},${+t},${+n},${+r},${this._x1=+i},${this._y1=+o}`}arcTo(e,t,n,r,i){if(e=+e,t=+t,n=+n,r=+r,(i=+i)<0)throw new Error(`negative radius: ${i}`);let o=this._x1,a=this._y1,s=n-e,u=r-t,l=o-e,c=a-t,p=l*l+c*c;if(null===this._x1)this._append`M${this._x1=e},${this._y1=t}`;else if(p>fd)if(Math.abs(c*s-u*l)>fd&&i){let d=n-o,h=r-a,f=s*s+u*u,g=d*d+h*h,m=Math.sqrt(f),y=Math.sqrt(p),b=i*Math.tan((dd-Math.acos((f+p-g)/(2*m*y)))/2),v=b/y,x=b/m;Math.abs(v-1)>fd&&this._append`L${e+v*l},${t+v*c}`,this._append`A${i},${i},0,0,${+(c*d>l*h)},${this._x1=e+x*s},${this._y1=t+x*u}`}else this._append`L${this._x1=e},${this._y1=t}`}arc(e,t,n,r,i,o){if(e=+e,t=+t,o=!!o,(n=+n)<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(r),s=n*Math.sin(r),u=e+a,l=t+s,c=1^o,p=o?r-i:i-r;null===this._x1?this._append`M${u},${l}`:(Math.abs(this._x1-u)>fd||Math.abs(this._y1-l)>fd)&&this._append`L${u},${l}`,n&&(p<0&&(p=p%hd+hd),p>gd?this._append`A${n},${n},0,1,${c},${e-a},${t-s}A${n},${n},0,1,${c},${this._x1=u},${this._y1=l}`:p>fd&&this._append`A${n},${n},0,${+(p>=dd)},${c},${this._x1=e+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(e,t,n,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function bd(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError(`invalid digits: ${n}`);t=e}return e},()=>new yd(t)}function vd(e){return e.innerRadius}function xd(e){return e.outerRadius}function _d(e){return e.startAngle}function wd(e){return e.endAngle}function kd(e){return e&&e.padAngle}function Sd(e,t,n,r,i,o,a){var s=e-n,u=t-r,l=(a?o:-o)/$p(s*s+u*u),c=l*u,p=-l*s,d=e+c,h=t+p,f=n+c,g=r+p,m=(d+f)/2,y=(h+g)/2,b=f-d,v=g-h,x=b*b+v*v,_=i-o,w=d*g-f*h,k=(v<0?-1:1)*$p(Bp(0,_*_*x-w*w)),S=(w*v-b*k)/x,C=(-w*b-v*k)/x,M=(w*v+b*k)/x,T=(-w*b+v*k)/x,E=S-m,A=C-y,F=M-m,O=T-y;return E*E+A*A>F*F+O*O&&(S=M,C=T),{cx:S,cy:C,x01:-c,y01:-p,x11:S*(i/_-1),y11:C*(i/_-1)}}function Cd(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function Md(e){return e[0]}function Td(e){return e[1]}function Ed(e,t){var n=pd(!0),r=null,i=Qp,o=null,a=bd(s);function s(s){var u,l,c,p=(s=Cd(s)).length,d=!1;for(null==r&&(o=i(c=a())),u=0;u<=p;++u)!(u<p&&n(l=s[u],u,s))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+e(l,u,s),+t(l,u,s));if(c)return o=null,c+""||null}return e="function"==typeof e?e:void 0===e?Md:pd(e),t="function"==typeof t?t:void 0===t?Td:pd(t),s.x=function(t){return arguments.length?(e="function"==typeof t?t:pd(+t),s):e},s.y=function(e){return arguments.length?(t="function"==typeof e?e:pd(+e),s):t},s.defined=function(e){return arguments.length?(n="function"==typeof e?e:pd(!!e),s):n},s.curve=function(e){return arguments.length?(i=e,null!=r&&(o=i(r)),s):i},s.context=function(e){return arguments.length?(null==e?r=o=null:o=i(r=e),s):r},s}function Ad(e,t,n){var r=null,i=pd(!0),o=null,a=Qp,s=null,u=bd(l);function l(l){var c,p,d,h,f,g=(l=Cd(l)).length,m=!1,y=new Array(g),b=new Array(g);for(null==o&&(s=a(f=u())),c=0;c<=g;++c){if(!(c<g&&i(h=l[c],c,l))===m)if(m=!m)p=c,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=c-1;d>=p;--d)s.point(y[d],b[d]);s.lineEnd(),s.areaEnd()}m&&(y[c]=+e(h,c,l),b[c]=+t(h,c,l),s.point(r?+r(h,c,l):y[c],n?+n(h,c,l):b[c]))}if(f)return s=null,f+""||null}function c(){return Ed().defined(i).curve(a).context(o)}return e="function"==typeof e?e:void 0===e?Md:pd(+e),t="function"==typeof t?t:pd(void 0===t?0:+t),n="function"==typeof n?n:void 0===n?Td:pd(+n),l.x=function(t){return arguments.length?(e="function"==typeof t?t:pd(+t),r=null,l):e},l.x0=function(t){return arguments.length?(e="function"==typeof t?t:pd(+t),l):e},l.x1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:pd(+e),l):r},l.y=function(e){return arguments.length?(t="function"==typeof e?e:pd(+e),n=null,l):t},l.y0=function(e){return arguments.length?(t="function"==typeof e?e:pd(+e),l):t},l.y1=function(e){return arguments.length?(n=null==e?null:"function"==typeof e?e:pd(+e),l):n},l.lineX0=l.lineY0=function(){return c().x(e).y(t)},l.lineY1=function(){return c().x(e).y(n)},l.lineX1=function(){return c().x(r).y(t)},l.defined=function(e){return arguments.length?(i="function"==typeof e?e:pd(!!e),l):i},l.curve=function(e){return arguments.length?(a=e,null!=o&&(s=a(o)),l):a},l.context=function(e){return arguments.length?(null==e?o=s=null:s=a(o=e),l):o},l}yd.prototype,Array.prototype.slice,$p(3);const Fd={draw(e,t){const n=$p(t/jp);e.moveTo(n,0),e.arc(0,0,n,0,Up)}};$p(1/3),Pp(jp/10),Pp(7*jp/10);Pp(Up/10),Ip(Up/10),$p(3),$p(3),$p(3),$p(12);const Od=Math.PI,Rd=2*Od,Nd=1e-6,Dd=Rd-Nd;function Id(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class Bd{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?Id:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Id;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,n,r){this._append`Q${+e},${+t},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(e,t,n,r,i,o){this._append`C${+e},${+t},${+n},${+r},${this._x1=+i},${this._y1=+o}`}arcTo(e,t,n,r,i){if(e=+e,t=+t,n=+n,r=+r,(i=+i)<0)throw new Error(`negative radius: ${i}`);let o=this._x1,a=this._y1,s=n-e,u=r-t,l=o-e,c=a-t,p=l*l+c*c;if(null===this._x1)this._append`M${this._x1=e},${this._y1=t}`;else if(p>Nd)if(Math.abs(c*s-u*l)>Nd&&i){let d=n-o,h=r-a,f=s*s+u*u,g=d*d+h*h,m=Math.sqrt(f),y=Math.sqrt(p),b=i*Math.tan((Od-Math.acos((f+p-g)/(2*m*y)))/2),v=b/y,x=b/m;Math.abs(v-1)>Nd&&this._append`L${e+v*l},${t+v*c}`,this._append`A${i},${i},0,0,${+(c*d>l*h)},${this._x1=e+x*s},${this._y1=t+x*u}`}else this._append`L${this._x1=e},${this._y1=t}`}arc(e,t,n,r,i,o){if(e=+e,t=+t,o=!!o,(n=+n)<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(r),s=n*Math.sin(r),u=e+a,l=t+s,c=1^o,p=o?r-i:i-r;null===this._x1?this._append`M${u},${l}`:(Math.abs(this._x1-u)>Nd||Math.abs(this._y1-l)>Nd)&&this._append`L${u},${l}`,n&&(p<0&&(p=p%Rd+Rd),p>Dd?this._append`A${n},${n},0,1,${c},${e-a},${t-s}A${n},${n},0,1,${c},${this._x1=u},${this._y1=l}`:p>Nd&&this._append`A${n},${n},0,${+(p>=Od)},${c},${this._x1=e+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(e,t,n,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function Ld(){return new Bd}function Pd(e,t){if("undefined"!=typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}Ld.prototype=Bd.prototype;const $d=()=>"undefined"!=typeof Image?Image:null;function zd(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function jd(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Gd(e){let t,n,r;function i(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<0?i=t+1:o=t}while(i<o)}return i}return 2!==e.length?(t=zd,n=(t,n)=>zd(e(t),n),r=(t,n)=>e(t)-n):(t=e===zd||e===jd?e:Ud,n=e,r=e),{left:i,center:function(e,t,n=0,o=e.length){const a=i(e,t,n,o-1);return a>n&&r(e[a-1],t)>-r(e[a],t)?a-1:a},right:function(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<=0?i=t+1:o=t}while(i<o)}return i}}}function Ud(){return 0}const Wd=Gd(zd),Vd=Wd.right,Hd=(Wd.left,Gd((function(e){return null===e?NaN:+e})).center,Vd),qd=Math.sqrt(50),Xd=Math.sqrt(10),Yd=Math.sqrt(2);function Kd(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=qd?10:o>=Xd?5:o>=Yd?2:1;let s,u,l;return i<0?(l=Math.pow(10,-i)/a,s=Math.round(e*l),u=Math.round(t*l),s/l<e&&++s,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*a,s=Math.round(e/l),u=Math.round(t/l),s*l<e&&++s,u*l>t&&--u),u<s&&.5<=n&&n<2?Kd(e,t,2*n):[s,u,l]}function Jd(e,t,n){if(!((n=+n)>0))return[];if((e=+e)==(t=+t))return[e];const r=t<e,[i,o,a]=r?Kd(t,e,n):Kd(e,t,n);if(!(o>=i))return[];const s=o-i+1,u=new Array(s);if(r)if(a<0)for(let e=0;e<s;++e)u[e]=(o-e)/-a;else for(let e=0;e<s;++e)u[e]=(o-e)*a;else if(a<0)for(let e=0;e<s;++e)u[e]=(i+e)/-a;else for(let e=0;e<s;++e)u[e]=(i+e)*a;return u}function Zd(e,t,n){return Kd(e=+e,t=+t,n=+n)[2]}function Qd(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?Zd(t,e,n):Zd(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function eh(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function th(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function nh(e){let t,n,r;function i(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<0?i=t+1:o=t}while(i<o)}return i}return 2!==e.length?(t=eh,n=(t,n)=>eh(e(t),n),r=(t,n)=>e(t)-n):(t=e===eh||e===th?e:rh,n=e,r=e),{left:i,center:function(e,t,n=0,o=e.length){const a=i(e,t,n,o-1);return a>n&&r(e[a-1],t)>-r(e[a],t)?a-1:a},right:function(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<=0?i=t+1:o=t}while(i<o)}return i}}}function rh(){return 0}function ih(e){return null===e?NaN:+e}const oh=nh(eh),ah=oh.right,sh=(oh.left,nh(ih).center,ah);function uh(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function lh(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ch(){}var ph=.7,dh=1/ph,hh="\\s*([+-]?\\d+)\\s*",fh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",gh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",mh=/^#([0-9a-f]{3,8})$/,yh=new RegExp(`^rgb\\(${hh},${hh},${hh}\\)$`),bh=new RegExp(`^rgb\\(${gh},${gh},${gh}\\)$`),vh=new RegExp(`^rgba\\(${hh},${hh},${hh},${fh}\\)$`),xh=new RegExp(`^rgba\\(${gh},${gh},${gh},${fh}\\)$`),_h=new RegExp(`^hsl\\(${fh},${gh},${gh}\\)$`),wh=new RegExp(`^hsla\\(${fh},${gh},${gh},${fh}\\)$`),kh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Sh(){return this.rgb().formatHex()}function Ch(){return this.rgb().formatRgb()}function Mh(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=mh.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Th(t):3===n?new Fh(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Eh(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Eh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=yh.exec(e))?new Fh(t[1],t[2],t[3],1):(t=bh.exec(e))?new Fh(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=vh.exec(e))?Eh(t[1],t[2],t[3],t[4]):(t=xh.exec(e))?Eh(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=_h.exec(e))?Bh(t[1],t[2]/100,t[3]/100,1):(t=wh.exec(e))?Bh(t[1],t[2]/100,t[3]/100,t[4]):kh.hasOwnProperty(e)?Th(kh[e]):"transparent"===e?new Fh(NaN,NaN,NaN,0):null}function Th(e){return new Fh(e>>16&255,e>>8&255,255&e,1)}function Eh(e,t,n,r){return r<=0&&(e=t=n=NaN),new Fh(e,t,n,r)}function Ah(e,t,n,r){return 1===arguments.length?((i=e)instanceof ch||(i=Mh(i)),i?new Fh((i=i.rgb()).r,i.g,i.b,i.opacity):new Fh):new Fh(e,t,n,null==r?1:r);var i}function Fh(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Oh(){return`#${Ih(this.r)}${Ih(this.g)}${Ih(this.b)}`}function Rh(){const e=Nh(this.opacity);return`${1===e?"rgb(":"rgba("}${Dh(this.r)}, ${Dh(this.g)}, ${Dh(this.b)}${1===e?")":`, ${e})`}`}function Nh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Dh(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ih(e){return((e=Dh(e))<16?"0":"")+e.toString(16)}function Bh(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ph(e,t,n,r)}function Lh(e){if(e instanceof Ph)return new Ph(e.h,e.s,e.l,e.opacity);if(e instanceof ch||(e=Mh(e)),!e)return new Ph;if(e instanceof Ph)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Ph(a,s,u,e.opacity)}function Ph(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function $h(e){return(e=(e||0)%360)<0?e+360:e}function zh(e){return Math.max(0,Math.min(1,e||0))}function jh(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Gh(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}uh(ch,Mh,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Sh,formatHex:Sh,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Lh(this).formatHsl()},formatRgb:Ch,toString:Ch}),uh(Fh,Ah,lh(ch,{brighter(e){return e=null==e?dh:Math.pow(dh,e),new Fh(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?ph:Math.pow(ph,e),new Fh(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Fh(Dh(this.r),Dh(this.g),Dh(this.b),Nh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Oh,formatHex:Oh,formatHex8:function(){return`#${Ih(this.r)}${Ih(this.g)}${Ih(this.b)}${Ih(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Rh,toString:Rh})),uh(Ph,(function(e,t,n,r){return 1===arguments.length?Lh(e):new Ph(e,t,n,null==r?1:r)}),lh(ch,{brighter(e){return e=null==e?dh:Math.pow(dh,e),new Ph(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?ph:Math.pow(ph,e),new Ph(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Fh(jh(e>=240?e-240:e+120,i,r),jh(e,i,r),jh(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Ph($h(this.h),zh(this.s),zh(this.l),Nh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Nh(this.opacity);return`${1===e?"hsl(":"hsla("}${$h(this.h)}, ${100*zh(this.s)}%, ${100*zh(this.l)}%${1===e?")":`, ${e})`}`}}));const Uh=e=>()=>e;function Wh(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):Uh(isNaN(e)?t:e)}const Vh=function e(t){var n=function(e){return 1==(e=+e)?Wh:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Uh(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=Ah(e)).r,(t=Ah(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=Wh(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function Hh(e){return function(t){var n,r,i=t.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Ah(t[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=e(o),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=s(e),r+""}}}function qh(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=tf(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}}function Xh(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Yh(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Kh(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=tf(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}Hh((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return Gh((n-r/t)*t,a,i,o,s)}})),Hh((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return Gh((n-r/t)*t,i,o,a,s)}}));var Jh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Zh=new RegExp(Jh.source,"g");function Qh(e,t){var n,r,i,o=Jh.lastIndex=Zh.lastIndex=0,a=-1,s=[],u=[];for(e+="",t+="";(n=Jh.exec(e))&&(r=Zh.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:Yh(n,r)})),o=Zh.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})}function ef(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function tf(e,t){var n,r=typeof t;return null==t||"boolean"===r?Uh(t):("number"===r?Yh:"string"===r?(n=Mh(t))?(t=n,Vh):Qh:t instanceof Mh?Vh:t instanceof Date?Xh:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?ef:Array.isArray(t)?qh:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?Kh:Yh)(e,t)}function nf(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function rf(e){return+e}var of=[0,1];function af(e){return e}function sf(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function uf(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=sf(i,r),o=n(a,o)):(r=sf(r,i),o=n(o,a)),function(e){return o(r(e))}}function lf(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=sf(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=sh(e,t,1,r)-1;return o[n](i[n](t))}}function cf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function pf(){var e,t,n,r,i,o,a=of,s=of,u=tf,l=af;function c(){var e=Math.min(a.length,s.length);return l!==af&&(l=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(a[0],a[e-1])),r=e>2?lf:uf,i=o=null,p}function p(t){return null==t||isNaN(t=+t)?n:(i||(i=r(a.map(e),s,u)))(e(l(t)))}return p.invert=function(n){return l(t((o||(o=r(s,a.map(e),Yh)))(n)))},p.domain=function(e){return arguments.length?(a=Array.from(e,rf),c()):a.slice()},p.range=function(e){return arguments.length?(s=Array.from(e),c()):s.slice()},p.rangeRound=function(e){return s=Array.from(e),u=nf,c()},p.clamp=function(e){return arguments.length?(l=!!e||af,c()):l!==af},p.interpolate=function(e){return arguments.length?(u=e,c()):u},p.unknown=function(e){return arguments.length?(n=e,p):n},function(n,r){return e=n,t=r,c()}}function df(){return pf()(af,af)}function hf(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function ff(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}var gf,mf=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function yf(e){if(!(t=mf.exec(e)))throw new Error("invalid format: "+e);var t;return new bf({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function bf(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function vf(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function xf(e){return(e=vf(Math.abs(e)))?e[1]:NaN}function _f(e,t){var n=vf(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}yf.prototype=bf.prototype,bf.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const wf={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>_f(100*e,t),r:_f,s:function(e,t){var n=vf(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(gf=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+vf(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function kf(e){return e}var Sf,Cf,Mf,Tf=Array.prototype.map,Ef=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Af(e,t,n,r){var i,o=Qd(e,t,n);switch((r=yf(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(xf(t)/3)))-xf(Math.abs(e)))}(o,a))||(r.precision=i),Mf(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,xf(t)-xf(e))+1}(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(e){return Math.max(0,-xf(Math.abs(e)))}(o))||(r.precision=i-2*("%"===r.type))}return Cf(r)}function Ff(e){var t=e.domain;return e.ticks=function(e){var n=t();return Jd(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return Af(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,o=t(),a=0,s=o.length-1,u=o[a],l=o[s],c=10;for(l<u&&(i=u,u=l,l=i,i=a,a=s,s=i);c-- >0;){if((i=Zd(u,l,n))===r)return o[a]=u,o[s]=l,t(o);if(i>0)u=Math.floor(u/i)*i,l=Math.ceil(l/i)*i;else{if(!(i<0))break;u=Math.ceil(u*i)/i,l=Math.floor(l*i)/i}r=i}return e},e}function Of(e,t){var n,r=0,i=(e=e.slice()).length-1,o=e[r],a=e[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),e[r]=t.floor(o),e[i]=t.ceil(a),e}function Rf(e){return Math.log(e)}function Nf(e){return Math.exp(e)}function Df(e){return-Math.log(-e)}function If(e){return-Math.exp(-e)}function Bf(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Lf(e){return(t,n)=>-e(-t,n)}function Pf(e){const t=e(Rf,Nf),n=t.domain;let r,i,o=10;function a(){return r=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(o),i=function(e){return 10===e?Bf:e===Math.E?Math.exp:t=>Math.pow(e,t)}(o),n()[0]<0?(r=Lf(r),i=Lf(i),e(Df,If)):e(Rf,Nf),t}return t.base=function(e){return arguments.length?(o=+e,a()):o},t.domain=function(e){return arguments.length?(n(e),a()):n()},t.ticks=e=>{const t=n();let a=t[0],s=t[t.length-1];const u=s<a;u&&([a,s]=[s,a]);let l,c,p=r(a),d=r(s);const h=null==e?10:+e;let f=[];if(!(o%1)&&d-p<h){if(p=Math.floor(p),d=Math.ceil(d),a>0){for(;p<=d;++p)for(l=1;l<o;++l)if(c=p<0?l/i(-p):l*i(p),!(c<a)){if(c>s)break;f.push(c)}}else for(;p<=d;++p)for(l=o-1;l>=1;--l)if(c=p>0?l/i(-p):l*i(p),!(c<a)){if(c>s)break;f.push(c)}2*f.length<h&&(f=Jd(a,s,h))}else f=Jd(p,d,Math.min(d-p,h)).map(i);return u?f.reverse():f},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===o?"s":","),"function"!=typeof n&&(o%1||null!=(n=yf(n)).precision||(n.trim=!0),n=Cf(n)),e===1/0)return n;const a=Math.max(1,o*e/t.ticks().length);return e=>{let t=e/i(Math.round(r(e)));return t*o<o-.5&&(t*=o),t<=a?n(e):""}},t.nice=()=>n(Of(n(),{floor:e=>i(Math.floor(r(e))),ceil:e=>i(Math.ceil(r(e)))})),t}function $f(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function zf(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function jf(e){return e<0?-e*e:e*e}function Gf(e){var t=e(af,af),n=1;return t.exponent=function(t){return arguments.length?1==(n=+t)?e(af,af):.5===n?e(zf,jf):e($f(n),$f(1/n)):n},Ff(t)}function Uf(){var e=Gf(pf());return e.copy=function(){return cf(e,Uf()).exponent(e.exponent())},hf.apply(e,arguments),e}function Wf(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Vf(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Hf(e){var t=1,n=e(Wf(t),Vf(t));return n.constant=function(n){return arguments.length?e(Wf(t=+n),Vf(t)):t},Ff(n)}Sf=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?kf:(t=Tf.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],a=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(e.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?kf:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Tf.call(e.numerals,String)),u=void 0===e.percent?"%":e.percent+"",l=void 0===e.minus?"":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function p(e){var t=(e=yf(e)).fill,n=e.align,p=e.sign,d=e.symbol,h=e.zero,f=e.width,g=e.comma,m=e.precision,y=e.trim,b=e.type;"n"===b?(g=!0,b="g"):wf[b]||(void 0===m&&(m=12),y=!0,b="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var v="$"===d?i:"#"===d&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",x="$"===d?o:/[%p]/.test(b)?u:"",_=wf[b],w=/[defgprs%]/.test(b);function k(e){var i,o,u,d=v,k=x;if("c"===b)k=_(e)+k,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:_(Math.abs(e),m),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),S&&0==+e&&"+"!==p&&(S=!1),d=(S?"("===p?p:l:"-"===p||"("===p?"":p)+d,k=("s"===b?Ef[8+gf/3]:"")+k+(S&&"("===p?")":""),w)for(i=-1,o=e.length;++i<o;)if(48>(u=e.charCodeAt(i))||u>57){k=(46===u?a+e.slice(i+1):e.slice(i))+k,e=e.slice(0,i);break}}g&&!h&&(e=r(e,1/0));var C=d.length+e.length+k.length,M=C<f?new Array(f-C+1).join(t):"";switch(g&&h&&(e=r(M+e,M.length?f-k.length:1/0),M=""),n){case"<":e=d+e+k+M;break;case"=":e=d+M+e+k;break;case"^":e=M.slice(0,C=M.length>>1)+d+e+k+M.slice(C);break;default:e=M+d+e+k}return s(e)}return m=void 0===m?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),k.toString=function(){return e+""},k}return{format:p,formatPrefix:function(e,t){var n=p(((e=yf(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(xf(t)/3))),i=Math.pow(10,-r),o=Ef[8+r/3];return function(e){return n(i*e)+o}}}}({thousands:",",grouping:[3],currency:["$",""]}),Cf=Sf.format,Mf=Sf.formatPrefix;const qf=1e3,Xf=6e4,Yf=36e5,Kf=864e5,Jf=6048e5,Zf=31536e6,Qf=new Date,eg=new Date;function tg(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{const t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,r,o)=>{const a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return a;let s;do{a.push(s=new Date(+n)),t(n,o),e(n)}while(s<n&&n<r);return a},i.filter=n=>tg((t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),((e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})),n&&(i.count=(t,r)=>(Qf.setTime(+t),eg.setTime(+r),e(Qf),e(eg),Math.floor(n(Qf,eg))),i.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?t=>r(t)%e==0:t=>i.count(0,t)%e==0):i:null)),i}const ng=tg((()=>{}),((e,t)=>{e.setTime(+e+t)}),((e,t)=>t-e));ng.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?tg((t=>{t.setTime(Math.floor(t/e)*e)}),((t,n)=>{t.setTime(+t+n*e)}),((t,n)=>(n-t)/e)):ng:null),ng.range;const rg=tg((e=>{e.setTime(e-e.getMilliseconds())}),((e,t)=>{e.setTime(+e+t*qf)}),((e,t)=>(t-e)/qf),(e=>e.getUTCSeconds())),ig=(rg.range,tg((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*qf)}),((e,t)=>{e.setTime(+e+t*Xf)}),((e,t)=>(t-e)/Xf),(e=>e.getMinutes()))),og=(ig.range,tg((e=>{e.setUTCSeconds(0,0)}),((e,t)=>{e.setTime(+e+t*Xf)}),((e,t)=>(t-e)/Xf),(e=>e.getUTCMinutes()))),ag=(og.range,tg((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*qf-e.getMinutes()*Xf)}),((e,t)=>{e.setTime(+e+t*Yf)}),((e,t)=>(t-e)/Yf),(e=>e.getHours()))),sg=(ag.range,tg((e=>{e.setUTCMinutes(0,0,0)}),((e,t)=>{e.setTime(+e+t*Yf)}),((e,t)=>(t-e)/Yf),(e=>e.getUTCHours()))),ug=(sg.range,tg((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Xf)/Kf),(e=>e.getDate()-1))),lg=(ug.range,tg((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/Kf),(e=>e.getUTCDate()-1))),cg=(lg.range,tg((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/Kf),(e=>Math.floor(e/Kf))));function pg(e){return tg((t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),((e,t)=>{e.setDate(e.getDate()+7*t)}),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Xf)/Jf))}cg.range;const dg=pg(0),hg=pg(1),fg=pg(2),gg=pg(3),mg=pg(4),yg=pg(5),bg=pg(6);function vg(e){return tg((t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)}),((e,t)=>(t-e)/Jf))}dg.range,hg.range,fg.range,gg.range,mg.range,yg.range,bg.range;const xg=vg(0),_g=vg(1),wg=vg(2),kg=vg(3),Sg=vg(4),Cg=vg(5),Mg=vg(6),Tg=(xg.range,_g.range,wg.range,kg.range,Sg.range,Cg.range,Mg.range,tg((e=>{e.setDate(1),e.setHours(0,0,0,0)}),((e,t)=>{e.setMonth(e.getMonth()+t)}),((e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())),(e=>e.getMonth()))),Eg=(Tg.range,tg((e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)}),((e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())),(e=>e.getUTCMonth()))),Ag=(Eg.range,tg((e=>{e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,t)=>{e.setFullYear(e.getFullYear()+t)}),((e,t)=>t.getFullYear()-e.getFullYear()),(e=>e.getFullYear())));Ag.every=e=>isFinite(e=Math.floor(e))&&e>0?tg((t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,n)=>{t.setFullYear(t.getFullYear()+n*e)})):null,Ag.range;const Fg=tg((e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)}),((e,t)=>t.getUTCFullYear()-e.getUTCFullYear()),(e=>e.getUTCFullYear()));function Og(e,t,n,r,i,o){const a=[[rg,1,qf],[rg,5,5e3],[rg,15,15e3],[rg,30,3e4],[o,1,Xf],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,Yf],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,Kf],[r,2,1728e5],[n,1,Jf],[t,1,2592e6],[t,3,7776e6],[e,1,Zf]];function s(t,n,r){const i=Math.abs(n-t)/r,o=nh((([,,e])=>e)).right(a,i);if(o===a.length)return e.every(Qd(t/Zf,n/Zf,r));if(0===o)return ng.every(Math.max(Qd(t,n,r),1));const[s,u]=a[i/a[o-1][2]<a[o][2]/i?o-1:o];return s.every(u)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const i=n&&"function"==typeof n.range?n:s(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},s]}Fg.every=e=>isFinite(e=Math.floor(e))&&e>0?tg((t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null,Fg.range;const[Rg,Ng]=Og(Fg,Eg,xg,cg,sg,og),[Dg,Ig]=Og(Ag,Tg,dg,ug,ag,ig);function Bg(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Lg(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Pg(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var $g,zg,jg,Gg={"-":"",_:" ",0:"0"},Ug=/^\s*\d+/,Wg=/^%/,Vg=/[\\^$*+?|[\]().{}]/g;function Hg(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function qg(e){return e.replace(Vg,"\\$&")}function Xg(e){return new RegExp("^(?:"+e.map(qg).join("|")+")","i")}function Yg(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function Kg(e,t,n){var r=Ug.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Jg(e,t,n){var r=Ug.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Zg(e,t,n){var r=Ug.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Qg(e,t,n){var r=Ug.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function em(e,t,n){var r=Ug.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function tm(e,t,n){var r=Ug.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function nm(e,t,n){var r=Ug.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function rm(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function im(e,t,n){var r=Ug.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function om(e,t,n){var r=Ug.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function am(e,t,n){var r=Ug.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function sm(e,t,n){var r=Ug.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function um(e,t,n){var r=Ug.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function lm(e,t,n){var r=Ug.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function cm(e,t,n){var r=Ug.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function pm(e,t,n){var r=Ug.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function dm(e,t,n){var r=Ug.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function hm(e,t,n){var r=Wg.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function fm(e,t,n){var r=Ug.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function gm(e,t,n){var r=Ug.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function mm(e,t){return Hg(e.getDate(),t,2)}function ym(e,t){return Hg(e.getHours(),t,2)}function bm(e,t){return Hg(e.getHours()%12||12,t,2)}function vm(e,t){return Hg(1+ug.count(Ag(e),e),t,3)}function xm(e,t){return Hg(e.getMilliseconds(),t,3)}function _m(e,t){return xm(e,t)+"000"}function wm(e,t){return Hg(e.getMonth()+1,t,2)}function km(e,t){return Hg(e.getMinutes(),t,2)}function Sm(e,t){return Hg(e.getSeconds(),t,2)}function Cm(e){var t=e.getDay();return 0===t?7:t}function Mm(e,t){return Hg(dg.count(Ag(e)-1,e),t,2)}function Tm(e){var t=e.getDay();return t>=4||0===t?mg(e):mg.ceil(e)}function Em(e,t){return e=Tm(e),Hg(mg.count(Ag(e),e)+(4===Ag(e).getDay()),t,2)}function Am(e){return e.getDay()}function Fm(e,t){return Hg(hg.count(Ag(e)-1,e),t,2)}function Om(e,t){return Hg(e.getFullYear()%100,t,2)}function Rm(e,t){return Hg((e=Tm(e)).getFullYear()%100,t,2)}function Nm(e,t){return Hg(e.getFullYear()%1e4,t,4)}function Dm(e,t){var n=e.getDay();return Hg((e=n>=4||0===n?mg(e):mg.ceil(e)).getFullYear()%1e4,t,4)}function Im(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Hg(t/60|0,"0",2)+Hg(t%60,"0",2)}function Bm(e,t){return Hg(e.getUTCDate(),t,2)}function Lm(e,t){return Hg(e.getUTCHours(),t,2)}function Pm(e,t){return Hg(e.getUTCHours()%12||12,t,2)}function $m(e,t){return Hg(1+lg.count(Fg(e),e),t,3)}function zm(e,t){return Hg(e.getUTCMilliseconds(),t,3)}function jm(e,t){return zm(e,t)+"000"}function Gm(e,t){return Hg(e.getUTCMonth()+1,t,2)}function Um(e,t){return Hg(e.getUTCMinutes(),t,2)}function Wm(e,t){return Hg(e.getUTCSeconds(),t,2)}function Vm(e){var t=e.getUTCDay();return 0===t?7:t}function Hm(e,t){return Hg(xg.count(Fg(e)-1,e),t,2)}function qm(e){var t=e.getUTCDay();return t>=4||0===t?Sg(e):Sg.ceil(e)}function Xm(e,t){return e=qm(e),Hg(Sg.count(Fg(e),e)+(4===Fg(e).getUTCDay()),t,2)}function Ym(e){return e.getUTCDay()}function Km(e,t){return Hg(_g.count(Fg(e)-1,e),t,2)}function Jm(e,t){return Hg(e.getUTCFullYear()%100,t,2)}function Zm(e,t){return Hg((e=qm(e)).getUTCFullYear()%100,t,2)}function Qm(e,t){return Hg(e.getUTCFullYear()%1e4,t,4)}function ey(e,t){var n=e.getUTCDay();return Hg((e=n>=4||0===n?Sg(e):Sg.ceil(e)).getUTCFullYear()%1e4,t,4)}function ty(){return"+0000"}function ny(){return"%"}function ry(e){return+e}function iy(e){return Math.floor(+e/1e3)}function oy(e){return new Date(e)}function ay(e){return e instanceof Date?+e:+new Date(+e)}function sy(e,t,n,r,i,o,a,s,u,l){var c=df(),p=c.invert,d=c.domain,h=l(".%L"),f=l(":%S"),g=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),b=l("%b %d"),v=l("%B"),x=l("%Y");function _(e){return(u(e)<e?h:s(e)<e?f:a(e)<e?g:o(e)<e?m:r(e)<e?i(e)<e?y:b:n(e)<e?v:x)(e)}return c.invert=function(e){return new Date(p(e))},c.domain=function(e){return arguments.length?d(Array.from(e,ay)):d().map(oy)},c.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},c.tickFormat=function(e,t){return null==t?_:l(t)},c.nice=function(e){var n=d();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(Of(n,e)):c},c.copy=function(){return cf(c,sy(e,t,n,r,i,o,a,s,u,l))},c}function uy(){var e,t,n,r,i,o=0,a=1,s=af,u=!1;function l(t){return null==t||isNaN(t=+t)?i:s(0===n?.5:(t=(r(t)-e)*n,u?Math.max(0,Math.min(1,t)):t))}function c(e){return function(t){var n,r;return arguments.length?([n,r]=t,s=e(n,r),l):[s(0),s(1)]}}return l.domain=function(i){return arguments.length?([o,a]=i,e=r(o=+o),t=r(a=+a),n=e===t?0:1/(t-e),l):[o,a]},l.clamp=function(e){return arguments.length?(u=!!e,l):u},l.interpolator=function(e){return arguments.length?(s=e,l):s},l.range=c(tf),l.rangeRound=c(nf),l.unknown=function(e){return arguments.length?(i=e,l):i},function(i){return r=i,e=i(o),t=i(a),n=e===t?0:1/(t-e),l}}function ly(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function cy(){var e=Ff(uy()(af));return e.copy=function(){return ly(e,cy())},ff.apply(e,arguments)}function py(){var e=Gf(uy());return e.copy=function(){return ly(e,py()).exponent(e.exponent())},ff.apply(e,arguments)}function dy(){var e,t,n,r,i,o,a,s=0,u=.5,l=1,c=1,p=af,d=!1;function h(e){return isNaN(e=+e)?a:(e=.5+((e=+o(e))-t)*(c*e<c*t?r:i),p(d?Math.max(0,Math.min(1,e)):e))}function f(e){return function(t){var n,r,i;return arguments.length?([n,r,i]=t,p=function(e,t){void 0===t&&(t=e,e=tf);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return o[t](e-t)}}(e,[n,r,i]),h):[p(0),p(.5),p(1)]}}return h.domain=function(a){return arguments.length?([s,u,l]=a,e=o(s=+s),t=o(u=+u),n=o(l=+l),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),c=t<e?-1:1,h):[s,u,l]},h.clamp=function(e){return arguments.length?(d=!!e,h):d},h.interpolator=function(e){return arguments.length?(p=e,h):p},h.range=f(tf),h.rangeRound=f(nf),h.unknown=function(e){return arguments.length?(a=e,h):a},function(a){return o=a,e=a(s),t=a(u),n=a(l),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),c=t<e?-1:1,h}}function hy(){var e=Gf(dy());return e.copy=function(){return ly(e,hy()).exponent(e.exponent())},ff.apply(e,arguments)}function fy(e,t,n=ih){if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e);return a+(+n(e[o+1],o+1,e)-a)*(i-o)}}$g=function(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=Xg(i),c=Yg(i),p=Xg(o),d=Yg(o),h=Xg(a),f=Yg(a),g=Xg(s),m=Yg(s),y=Xg(u),b=Yg(u),v={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:mm,e:mm,f:_m,g:Rm,G:Dm,H:ym,I:bm,j:vm,L:xm,m:wm,M:km,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:ry,s:iy,S:Sm,u:Cm,U:Mm,V:Em,w:Am,W:Fm,x:null,X:null,y:Om,Y:Nm,Z:Im,"%":ny},x={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return u[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:Bm,e:Bm,f:jm,g:Zm,G:ey,H:Lm,I:Pm,j:$m,L:zm,m:Gm,M:Um,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:ry,s:iy,S:Wm,u:Vm,U:Hm,V:Xm,w:Ym,W:Km,x:null,X:null,y:Jm,Y:Qm,Z:ty,"%":ny},_={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=f.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=p.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=y.exec(t.slice(n));return r?(e.m=b.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=g.exec(t.slice(n));return r?(e.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return S(e,t,n,r)},d:am,e:am,f:dm,g:nm,G:tm,H:um,I:um,j:sm,L:pm,m:om,M:lm,p:function(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=c.get(r[0].toLowerCase()),n+r[0].length):-1},q:im,Q:fm,s:gm,S:cm,u:Jg,U:Zg,V:Qg,w:Kg,W:em,x:function(e,t,r){return S(e,n,t,r)},X:function(e,t,n){return S(e,r,t,n)},y:nm,Y:tm,Z:rm,"%":hm};function w(e,t){return function(n){var r,i,o,a=[],s=-1,u=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===e.charCodeAt(s)&&(a.push(e.slice(u,s)),null!=(i=Gg[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(e.slice(u,s)),a.join("")}}function k(e,t){return function(n){var r,i,o=Pg(1900,void 0,1);if(S(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=Lg(Pg(o.y,0,1))).getUTCDay(),r=i>4||0===i?_g.ceil(r):_g(r),r=lg.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=Bg(Pg(o.y,0,1))).getDay(),r=i>4||0===i?hg.ceil(r):hg(r),r=ug.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Lg(Pg(o.y,0,1)).getUTCDay():Bg(Pg(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Lg(o)):Bg(o)}}function S(e,t,n,r){for(var i,o,a=0,s=t.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=_[i in Gg?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return v.x=w(n,v),v.X=w(r,v),v.c=w(t,v),x.x=w(n,x),x.X=w(r,x),x.c=w(t,x),{format:function(e){var t=w(e+="",v);return t.toString=function(){return e},t},parse:function(e){var t=k(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=k(e+="",!0);return t.toString=function(){return e},t}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),zg=$g.format,$g.parse,jg=$g.utcFormat,$g.utcParse;class gy extends Map{constructor(e,t=xy){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,n]of e)this.set(t,n)}get(e){return super.get(yy(this,e))}has(e){return super.has(yy(this,e))}set(e,t){return super.set(by(this,e),t)}delete(e){return super.delete(vy(this,e))}}class my extends Set{constructor(e,t=xy){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const t of e)this.add(t)}has(e){return super.has(yy(this,e))}add(e){return super.add(by(this,e))}delete(e){return super.delete(vy(this,e))}}function yy({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function by({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function vy({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function xy(e){return null!==e&&"object"==typeof e?e.valueOf():e}const _y=Symbol("implicit");function wy(){var e=new gy,t=[],n=[],r=_y;function i(i){let o=e.get(i);if(void 0===o){if(r!==_y)return r;e.set(i,o=t.push(i)-1)}return n[o%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new gy;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return wy(t,n).unknown(r)},hf.apply(i,arguments),i}function ky(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Sy(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Cy(){}var My=.7,Ty=1/My,Ey="\\s*([+-]?\\d+)\\s*",Ay="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Fy="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Oy=/^#([0-9a-f]{3,8})$/,Ry=new RegExp(`^rgb\\(${Ey},${Ey},${Ey}\\)$`),Ny=new RegExp(`^rgb\\(${Fy},${Fy},${Fy}\\)$`),Dy=new RegExp(`^rgba\\(${Ey},${Ey},${Ey},${Ay}\\)$`),Iy=new RegExp(`^rgba\\(${Fy},${Fy},${Fy},${Ay}\\)$`),By=new RegExp(`^hsl\\(${Ay},${Fy},${Fy}\\)$`),Ly=new RegExp(`^hsla\\(${Ay},${Fy},${Fy},${Ay}\\)$`),Py={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function $y(){return this.rgb().formatHex()}function zy(){return this.rgb().formatRgb()}function jy(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Oy.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Gy(t):3===n?new Hy(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Uy(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Uy(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Ry.exec(e))?new Hy(t[1],t[2],t[3],1):(t=Ny.exec(e))?new Hy(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Dy.exec(e))?Uy(t[1],t[2],t[3],t[4]):(t=Iy.exec(e))?Uy(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=By.exec(e))?Zy(t[1],t[2]/100,t[3]/100,1):(t=Ly.exec(e))?Zy(t[1],t[2]/100,t[3]/100,t[4]):Py.hasOwnProperty(e)?Gy(Py[e]):"transparent"===e?new Hy(NaN,NaN,NaN,0):null}function Gy(e){return new Hy(e>>16&255,e>>8&255,255&e,1)}function Uy(e,t,n,r){return r<=0&&(e=t=n=NaN),new Hy(e,t,n,r)}function Wy(e){return e instanceof Cy||(e=jy(e)),e?new Hy((e=e.rgb()).r,e.g,e.b,e.opacity):new Hy}function Vy(e,t,n,r){return 1===arguments.length?Wy(e):new Hy(e,t,n,null==r?1:r)}function Hy(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function qy(){return`#${Jy(this.r)}${Jy(this.g)}${Jy(this.b)}`}function Xy(){const e=Yy(this.opacity);return`${1===e?"rgb(":"rgba("}${Ky(this.r)}, ${Ky(this.g)}, ${Ky(this.b)}${1===e?")":`, ${e})`}`}function Yy(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ky(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Jy(e){return((e=Ky(e))<16?"0":"")+e.toString(16)}function Zy(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new tb(e,t,n,r)}function Qy(e){if(e instanceof tb)return new tb(e.h,e.s,e.l,e.opacity);if(e instanceof Cy||(e=jy(e)),!e)return new tb;if(e instanceof tb)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new tb(a,s,u,e.opacity)}function eb(e,t,n,r){return 1===arguments.length?Qy(e):new tb(e,t,n,null==r?1:r)}function tb(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function nb(e){return(e=(e||0)%360)<0?e+360:e}function rb(e){return Math.max(0,Math.min(1,e||0))}function ib(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function ob(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}function ab(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return ob((n-r/t)*t,a,i,o,s)}}function sb(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return ob((n-r/t)*t,i,o,a,s)}}ky(Cy,jy,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:$y,formatHex:$y,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Qy(this).formatHsl()},formatRgb:zy,toString:zy}),ky(Hy,Vy,Sy(Cy,{brighter(e){return e=null==e?Ty:Math.pow(Ty,e),new Hy(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?My:Math.pow(My,e),new Hy(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Hy(Ky(this.r),Ky(this.g),Ky(this.b),Yy(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qy,formatHex:qy,formatHex8:function(){return`#${Jy(this.r)}${Jy(this.g)}${Jy(this.b)}${Jy(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Xy,toString:Xy})),ky(tb,eb,Sy(Cy,{brighter(e){return e=null==e?Ty:Math.pow(Ty,e),new tb(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?My:Math.pow(My,e),new tb(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Hy(ib(e>=240?e-240:e+120,i,r),ib(e,i,r),ib(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new tb(nb(this.h),rb(this.s),rb(this.l),Yy(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Yy(this.opacity);return`${1===e?"hsl(":"hsla("}${nb(this.h)}, ${100*rb(this.s)}%, ${100*rb(this.l)}%${1===e?")":`, ${e})`}`}}));const ub=e=>()=>e;function lb(e,t){return function(n){return e+n*t}}function cb(e,t){var n=t-e;return n?lb(e,n>180||n<-180?n-360*Math.round(n/360):n):ub(isNaN(e)?t:e)}function pb(e,t){var n=t-e;return n?lb(e,n):ub(isNaN(e)?t:e)}const db=function e(t){var n=function(e){return 1==(e=+e)?pb:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):ub(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=Vy(e)).r,(t=Vy(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=pb(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function hb(e){return function(t){var n,r,i=t.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Vy(t[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=e(o),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=s(e),r+""}}}var fb=hb(ab),gb=hb(sb);function mb(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function yb(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function bb(e,t){return(yb(t)?mb:vb)(e,t)}function vb(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Mb(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}}function xb(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function _b(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function wb(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=Mb(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}var kb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Sb=new RegExp(kb.source,"g");function Cb(e,t){var n,r,i,o=kb.lastIndex=Sb.lastIndex=0,a=-1,s=[],u=[];for(e+="",t+="";(n=kb.exec(e))&&(r=Sb.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:_b(n,r)})),o=Sb.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})}function Mb(e,t){var n,r=typeof t;return null==t||"boolean"===r?ub(t):("number"===r?_b:"string"===r?(n=jy(t))?(t=n,db):Cb:t instanceof jy?db:t instanceof Date?xb:yb(t)?mb:Array.isArray(t)?vb:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?wb:_b)(e,t)}function Tb(e,t){void 0===t&&(t=e,e=Mb);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return o[t](e-t)}}function Eb(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Ab(e,t){var n=cb(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}function Fb(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Ob,Rb=180/Math.PI,Nb={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Db(e,t,n,r,i,o){var a,s,u;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*Rb,skewX:Math.atan(u)*Rb,scaleX:a,scaleY:s}}function Ib(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,a){var s=[],u=[];return o=e(o),a=e(a),function(e,r,i,o,a,s){if(e!==i||r!==o){var u=a.push("translate(",null,t,null,n);s.push({i:u-4,x:_b(e,i)},{i:u-2,x:_b(r,o)})}else(i||o)&&a.push("translate("+i+t+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,u),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:_b(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,a.rotate,s,u),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:_b(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,a.skewX,s,u),function(e,t,n,r,o,a){if(e!==n||t!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:_b(e,n)},{i:s-2,x:_b(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,u),o=a=null,function(e){for(var t,n=-1,r=u.length;++n<r;)s[(t=u[n]).i]=t.x(e);return s.join("")}}}var Bb=Ib((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Nb:Db(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),Lb=Ib((function(e){return null==e?Nb:(Ob||(Ob=document.createElementNS("http://www.w3.org/2000/svg","g")),Ob.setAttribute("transform",e),(e=Ob.transform.baseVal.consolidate())?Db((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):Nb)}),", ",")",")");function Pb(e){return((e=Math.exp(e))+1/e)/2}const $b=function e(t,n,r){function i(e,i){var o,a,s=e[0],u=e[1],l=e[2],c=i[0],p=i[1],d=i[2],h=c-s,f=p-u,g=h*h+f*f;if(g<1e-12)a=Math.log(d/l)/t,o=function(e){return[s+e*h,u+e*f,l*Math.exp(t*e*a)]};else{var m=Math.sqrt(g),y=(d*d-l*l+r*g)/(2*l*n*m),b=(d*d-l*l-r*g)/(2*d*n*m),v=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(b*b+1)-b);a=(x-v)/t,o=function(e){var r=e*a,i=Pb(v),o=l/(n*m)*(i*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*r+v)-function(e){return((e=Math.exp(e))-1/e)/2}(v));return[s+o*h,u+o*f,l*i/Pb(t*r+v)]}}return o.duration=1e3*a*t/Math.SQRT2,o}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},i}(Math.SQRT2,2,4);function zb(e){return function(t,n){var r=e((t=eb(t)).h,(n=eb(n)).h),i=pb(t.s,n.s),o=pb(t.l,n.l),a=pb(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=i(e),t.l=o(e),t.opacity=a(e),t+""}}}const jb=zb(cb);var Gb=zb(pb);const Ub=Math.PI/180,Wb=180/Math.PI,Vb=.96422,Hb=1,qb=.82521,Xb=4/29,Yb=6/29,Kb=3*Yb*Yb,Jb=.008856451679035631;function Zb(e){if(e instanceof ev)return new ev(e.l,e.a,e.b,e.opacity);if(e instanceof av)return sv(e);e instanceof Hy||(e=Wy(e));var t,n,r=iv(e.r),i=iv(e.g),o=iv(e.b),a=tv((.2225045*r+.7168786*i+.0606169*o)/Hb);return r===i&&i===o?t=n=a:(t=tv((.4360747*r+.3850649*i+.1430804*o)/Vb),n=tv((.0139322*r+.0971045*i+.7141733*o)/qb)),new ev(116*a-16,500*(t-a),200*(a-n),e.opacity)}function Qb(e,t,n,r){return 1===arguments.length?Zb(e):new ev(e,t,n,null==r?1:r)}function ev(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function tv(e){return e>Jb?Math.pow(e,1/3):e/Kb+Xb}function nv(e){return e>Yb?e*e*e:Kb*(e-Xb)}function rv(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function iv(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ov(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof av)return new av(e.h,e.c,e.l,e.opacity);if(e instanceof ev||(e=Zb(e)),0===e.a&&0===e.b)return new av(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Wb;return new av(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}(e):new av(e,t,n,null==r?1:r)}function av(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function sv(e){if(isNaN(e.h))return new ev(e.l,0,0,e.opacity);var t=e.h*Ub;return new ev(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function uv(e,t){var n=pb((e=Qb(e)).l,(t=Qb(t)).l),r=pb(e.a,t.a),i=pb(e.b,t.b),o=pb(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=i(t),e.opacity=o(t),e+""}}function lv(e){return function(t,n){var r=e((t=ov(t)).h,(n=ov(n)).h),i=pb(t.c,n.c),o=pb(t.l,n.l),a=pb(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=i(e),t.l=o(e),t.opacity=a(e),t+""}}}ky(ev,Qb,Sy(Cy,{brighter(e){return new ev(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new ev(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new Hy(rv(3.1338561*(t=Vb*nv(t))-1.6168667*(e=Hb*nv(e))-.4906146*(n=qb*nv(n))),rv(-.9787684*t+1.9161415*e+.033454*n),rv(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),ky(av,ov,Sy(Cy,{brighter(e){return new av(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new av(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return sv(this).rgb()}}));const cv=lv(cb);var pv=lv(pb),dv=-.14861,hv=1.78277,fv=-.29227,gv=-.90649,mv=1.97294,yv=mv*gv,bv=mv*hv,vv=hv*fv-gv*dv;function xv(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof _v)return new _v(e.h,e.s,e.l,e.opacity);e instanceof Hy||(e=Wy(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(vv*r+yv*t-bv*n)/(vv+yv-bv),o=r-i,a=(mv*(n-i)-fv*o)/gv,s=Math.sqrt(a*a+o*o)/(mv*i*(1-i)),u=s?Math.atan2(a,o)*Wb-120:NaN;return new _v(u<0?u+360:u,s,i,e.opacity)}(e):new _v(e,t,n,null==r?1:r)}function _v(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function wv(e){return function t(n){function r(t,r){var i=e((t=xv(t)).h,(r=xv(r)).h),o=pb(t.s,r.s),a=pb(t.l,r.l),s=pb(t.opacity,r.opacity);return function(e){return t.h=i(e),t.s=o(e),t.l=a(Math.pow(e,n)),t.opacity=s(e),t+""}}return n=+n,r.gamma=t,r}(1)}ky(_v,xv,Sy(Cy,{brighter(e){return e=null==e?Ty:Math.pow(Ty,e),new _v(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?My:Math.pow(My,e),new _v(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*Ub,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Hy(255*(t+n*(dv*r+hv*i)),255*(t+n*(fv*r+gv*i)),255*(t+n*(mv*r)),this.opacity)}}));const kv=wv(cb);var Sv=wv(pb);function Cv(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}function Mv(e,t,n){const r=e-t+2*n;return e?r>0?r:1:0}const Tv="linear",Ev="log",Av="pow",Fv="sqrt",Ov="symlog",Rv="time",Nv="utc",Dv="sequential",Iv="diverging",Bv="quantile",Lv="quantize",Pv="threshold",$v="ordinal",zv="point",jv="band",Gv="bin-ordinal",Uv="continuous",Wv="discrete",Vv="discretizing",Hv="interpolating",qv="temporal";function Xv(){const e=wy().unknown(void 0),t=e.domain,n=e.range;let r,i,o=[0,1],a=!1,s=0,u=0,l=.5;function c(){const e=t().length,c=o[1]<o[0],p=o[1-c],d=Mv(e,s,u);let h=o[c-0];r=(p-h)/(d||1),a&&(r=Math.floor(r)),h+=(p-h-r*(e-s))*l,i=r*(1-s),a&&(h=Math.round(h),i=Math.round(i));const f=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(i);++r<i;)o[r]=e+r*n;return o}(e).map((e=>h+r*e));return n(c?f.reverse():f)}return delete e.unknown,e.domain=function(e){return arguments.length?(t(e),c()):t()},e.range=function(e){return arguments.length?(o=[+e[0],+e[1]],c()):o.slice()},e.rangeRound=function(e){return o=[+e[0],+e[1]],a=!0,c()},e.bandwidth=function(){return i},e.step=function(){return r},e.round=function(e){return arguments.length?(a=!!e,c()):a},e.padding=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),s=u,c()):s},e.paddingInner=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),c()):s},e.paddingOuter=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),c()):u},e.align=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),c()):l},e.invertRange=function(e){if(null==e[0]||null==e[1])return;const r=o[1]<o[0],a=r?n().reverse():n(),s=a.length-1;let u,l,c,p=+e[0],d=+e[1];return p!=p||d!=d||(d<p&&(c=p,p=d,d=c),d<a[0]||p>o[1-r])?void 0:(u=Math.max(0,Vd(a,p)-1),l=p===d?u:Vd(a,d)-1,p-a[u]>i+1e-10&&++u,r&&(c=u,u=s-l,l=s-c),u>l?void 0:t().slice(u,l+1))},e.invert=function(t){const n=e.invertRange([t,t]);return n?n[0]:n},e.copy=function(){return Xv().domain(t()).range(o).round(a).paddingInner(s).paddingOuter(u).align(l)},c()}function Yv(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return Yv(t())},e}var Kv=Array.prototype.map;const Jv=Array.prototype.slice,Zv=new Map,Qv=Symbol("vega_scale");function ex(e){return e[Qv]=!0,e}function tx(e,t,n){return arguments.length>1?(Zv.set(e,function(e,t,n){const r=function(){const n=t();return n.invertRange||(n.invertRange=n.invert?function(e){return function(t){let n,r=t[0],i=t[1];return i<r&&(n=r,r=i,i=n),[e.invert(r),e.invert(i)]}}(n):n.invertExtent?function(e){return function(t){const n=e.range();let r,i,o,a,s=t[0],u=t[1],l=-1;for(u<s&&(i=s,s=u,u=i),o=0,a=n.length;o<a;++o)n[o]>=s&&n[o]<=u&&(l<0&&(l=o),r=o);if(!(l<0))return s=e.invertExtent(n[l]),u=e.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}}(n):void 0),n.type=e,ex(n)};return r.metadata=er(Cn(n)),r}(e,t,n)),this):nx(e)?Zv.get(e):void 0}function nx(e){return Zv.has(e)}function rx(e,t){const n=Zv.get(e);return n&&n.metadata[t]}function ix(e){return rx(e,Uv)}function ox(e){return rx(e,Wv)}function ax(e){return rx(e,Vv)}function sx(e){return rx(e,Ev)}function ux(e){return rx(e,Hv)}function lx(e){return rx(e,Bv)}tx("identity",(function e(t){var n;function r(e){return null==e||isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=Array.from(e,rf),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,rf):[0,1],Ff(r)})),tx(Tv,(function e(){var t=df();return t.copy=function(){return cf(t,e())},hf.apply(t,arguments),Ff(t)}),Uv),tx(Ev,(function e(){const t=Pf(pf()).domain([1,10]);return t.copy=()=>cf(t,e()).base(t.base()),hf.apply(t,arguments),t}),[Uv,Ev]),tx(Av,Uf,Uv),tx(Fv,(function(){return Uf.apply(null,arguments).exponent(.5)}),Uv),tx(Ov,(function e(){var t=Hf(pf());return t.copy=function(){return cf(t,e()).constant(t.constant())},hf.apply(t,arguments)}),Uv),tx(Rv,(function(){return hf.apply(sy(Dg,Ig,Ag,Tg,dg,ug,ag,ig,rg,zg).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[Uv,qv]),tx(Nv,(function(){return hf.apply(sy(Rg,Ng,Fg,Eg,xg,lg,sg,og,rg,jg).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[Uv,qv]),tx(Dv,cy,[Uv,Hv]),tx(`${Dv}-${Tv}`,cy,[Uv,Hv]),tx(`${Dv}-${Ev}`,(function e(){var t=Pf(uy()).domain([1,10]);return t.copy=function(){return ly(t,e()).base(t.base())},ff.apply(t,arguments)}),[Uv,Hv,Ev]),tx(`${Dv}-${Av}`,py,[Uv,Hv]),tx(`${Dv}-${Fv}`,(function(){return py.apply(null,arguments).exponent(.5)}),[Uv,Hv]),tx(`${Dv}-${Ov}`,(function e(){var t=Hf(uy());return t.copy=function(){return ly(t,e()).constant(t.constant())},ff.apply(t,arguments)}),[Uv,Hv]),tx(`${Iv}-${Tv}`,(function e(){var t=Ff(dy()(af));return t.copy=function(){return ly(t,e())},ff.apply(t,arguments)}),[Uv,Hv]),tx(`${Iv}-${Ev}`,(function e(){var t=Pf(dy()).domain([.1,1,10]);return t.copy=function(){return ly(t,e()).base(t.base())},ff.apply(t,arguments)}),[Uv,Hv,Ev]),tx(`${Iv}-${Av}`,hy,[Uv,Hv]),tx(`${Iv}-${Fv}`,(function(){return hy.apply(null,arguments).exponent(.5)}),[Uv,Hv]),tx(`${Iv}-${Ov}`,(function e(){var t=Hf(dy());return t.copy=function(){return ly(t,e()).constant(t.constant())},ff.apply(t,arguments)}),[Uv,Hv]),tx(Bv,(function e(){var t,n=[],r=[],i=[];function o(){var e=0,t=Math.max(1,r.length);for(i=new Array(t-1);++e<t;)i[e-1]=fy(n,e/t);return a}function a(e){return null==e||isNaN(e=+e)?t:r[sh(i,e)]}return a.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?i[t-1]:n[0],t<i.length?i[t]:n[n.length-1]]},a.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(eh),o()},a.range=function(e){return arguments.length?(r=Array.from(e),o()):r.slice()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.quantiles=function(){return i.slice()},a.copy=function(){return e().domain(n).range(r).unknown(t)},hf.apply(a,arguments)}),[Vv,Bv]),tx(Lv,(function e(){var t,n=0,r=1,i=1,o=[.5],a=[0,1];function s(e){return null!=e&&e<=e?a[sh(o,e,0,i)]:t}function u(){var e=-1;for(o=new Array(i);++e<i;)o[e]=((e+1)*r-(e-i)*n)/(i+1);return s}return s.domain=function(e){return arguments.length?([n,r]=e,n=+n,r=+r,u()):[n,r]},s.range=function(e){return arguments.length?(i=(a=Array.from(e)).length-1,u()):a.slice()},s.invertExtent=function(e){var t=a.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,o[0]]:t>=i?[o[i-1],r]:[o[t-1],o[t]]},s.unknown=function(e){return arguments.length?(t=e,s):s},s.thresholds=function(){return o.slice()},s.copy=function(){return e().domain([n,r]).range(a).unknown(t)},hf.apply(Ff(s),arguments)}),Vv),tx(Pv,(function e(){var t,n=[.5],r=[0,1],i=1;function o(e){return null!=e&&e<=e?r[sh(n,e,0,i)]:t}return o.domain=function(e){return arguments.length?(n=Array.from(e),i=Math.min(n.length,r.length-1),o):n.slice()},o.range=function(e){return arguments.length?(r=Array.from(e),i=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},o.unknown=function(e){return arguments.length?(t=e,o):t},o.copy=function(){return e().domain(n).range(r).unknown(t)},hf.apply(o,arguments)}),Vv),tx(Gv,(function e(){let t=[],n=[];function r(e){return null==e||e!=e?void 0:n[(Hd(t,e)-1)%n.length]}return r.domain=function(e){return arguments.length?(t=function(e){return Kv.call(e,hn)}(e),r):t.slice()},r.range=function(e){return arguments.length?(n=Jv.call(e),r):n.slice()},r.tickFormat=function(e,n){return Af(t[0],dn(t),null==e?10:e,n)},r.copy=function(){return e().domain(r.domain()).range(r.range())},r}),[Wv,Vv]),tx($v,wy,Wv),tx(jv,Xv,Wv),tx(zv,(function(){return Yv(Xv().paddingInner(1))}),Wv);const cx=["clamp","base","constant","exponent"];function px(e,t,n){return Tb(hx(t||"rgb",n),e)}function dx(e,t,n){const r=n-t;let i,o,a;return r&&Number.isFinite(r)?(i=(o=e.type).indexOf("-"),o=i<0?o:o.slice(i+1),a=tx(o)().domain([t,n]).range([0,1]),cx.forEach((t=>e[t]?a[t](e[t]()):0)),a):Nn(.5)}function hx(e,t){const n=a[function(e){return"interpolate"+e.toLowerCase().split("-").map((e=>e[0].toUpperCase()+e.slice(1))).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function fx(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function gx(e,t){for(const n in e)yx(n,t(e[n]))}const mx={};function yx(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(mx[e]=t,this):mx[e]}gx({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},fx),gx({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(e=>px(fx(e))));const bx="symbol",vx="discrete",xx=e=>sn(e)?e.map((e=>String(e))):String(e),_x=(e,t)=>e[1]-t[1],wx=(e,t)=>t[1]-e[1];function kx(e,t,n){let r;return Wn(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),null!=n&&(t=Math.min(t,Math.floor(Xn(e.domain())/n||1)))),un(t)&&(r=t.step,t=t.interval),Vn(t)&&(t=e.type===Rv?po(t):e.type==Nv?ho(t):Vt("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function Sx(e,t,n){let r=e.range(),i=r[0],o=dn(r),a=_x;if(i>o&&(r=o,o=i,i=r,a=wx),i=Math.floor(i),o=Math.ceil(o),t=t.map((t=>[t,e(t)])).filter((e=>i<=e[1]&&e[1]<=o)).sort(a).map((e=>e[0])),n>0&&t.length>1){const e=[t[0],dn(t)];for(;t.length>n&&t.length>=3;)t=t.filter(((e,t)=>!(t%2)));t.length<3&&(t=e)}return t}function Cx(e,t){return e.bins?Sx(e,e.bins):e.ticks?e.ticks(t):e.domain()}function Mx(e,t,n,r,i,o){const a=t.type;let s=xx;if(a===Rv||i===Rv)s=e.timeFormat(r);else if(a===Nv||i===Nv)s=e.utcFormat(r);else if(sx(a)){const i=e.formatFloat(r);if(o||t.bins)s=i;else{const e=Tx(t,n,!1);s=t=>e(t)?i(t):""}}else if(t.tickFormat){const i=t.domain();s=e.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=e.format(r));return s}function Tx(e,t,n){const r=Cx(e,t),i=e.base(),o=Math.log(i),a=Math.max(1,i*t/r.length),s=e=>{let t=e/Math.pow(i,Math.round(Math.log(e)/o));return t*i<i-.5&&(t*=i),t<=a};return n?r.filter(s):s}const Ex={[Bv]:"quantiles",[Lv]:"thresholds",[Pv]:"domain"},Ax={[Bv]:"quantiles",[Lv]:"domain"};function Fx(e,t){return e.bins?function(e){const t=e.slice(0,-1);return t.max=dn(e),t}(e.bins):e.type===Ev?Tx(e,t,!0):Ex[e.type]?function(e){const t=[-1/0].concat(e);return t.max=1/0,t}(e[Ex[e.type]]()):Cx(e,t)}const Ox=e=>Ex[e.type]||e.bins;function Rx(e,t,n,r,i,o,a){const s=Ax[t.type]&&o!==Rv&&o!==Nv?function(e,t,n){const r=t[Ax[t.type]](),i=r.length;let o,a=i>1?r[1]-r[0]:r[0];for(o=1;o<i;++o)a=Math.min(a,r[o]-r[o-1]);return e.formatSpan(0,a,30,n)}(e,t,i):Mx(e,t,n,i,o,a);return r===bx&&Ox(t)?Nx(s):r===vx?Ix(s):Bx(s)}const Nx=e=>(t,n,r)=>{const i=Dx(r[n+1],Dx(r.max,1/0)),o=Lx(t,e),a=Lx(i,e);return o&&a?o+"  "+a:a?"< "+a:" "+o},Dx=(e,t)=>null!=e?e:t,Ix=e=>(t,n)=>n?e(t):null,Bx=e=>t=>e(t),Lx=(e,t)=>Number.isFinite(e)?t(e):null;function Px(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=function(e,t,n,r){const i=r||t.type;return Vn(n)&&function(e){return rx(e,qv)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==Rv?n||i!==Nv?Rx(e,t,5,null,n,r,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}(e,t,n.format,n.formatType);if(ax(t.type)){const e=Fx(t).slice(1).map(i),n=e.length;return`${n} boundar${1===n?"y":"ies"}: ${e.join(", ")}`}if(ox(t.type)){const e=t.domain(),n=e.length;return`${n} value${1===n?"":"s"}: ${n>r?e.slice(0,r-2).map(i).join(", ")+", ending with "+e.slice(-1).map(i):e.map(i).join(", ")}`}{const e=t.domain();return`values from ${i(e[0])} to ${i(dn(e))}`}}let $x=0;const zx="p_";function jx(e){return e&&e.gradient}function Gx(e,t,n){const r=e.gradient;let i=e.id,o="radial"===r?zx:"";return i||(i=e.id="gradient_"+$x++,"radial"===r?(e.x1=Ux(e.x1,.5),e.y1=Ux(e.y1,.5),e.r1=Ux(e.r1,0),e.x2=Ux(e.x2,.5),e.y2=Ux(e.y2,.5),e.r2=Ux(e.r2,.5),o=zx):(e.x1=Ux(e.x1,0),e.y1=Ux(e.y1,0),e.x2=Ux(e.x2,1),e.y2=Ux(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function Ux(e,t){return null!=e?e:t}const Wx={basis:{curve:function(e){return new xp(e)}},"basis-closed":{curve:function(e){return new wp(e)}},"basis-open":{curve:function(e){return new kp(e)}},bundle:{curve:Cp,tension:"beta",value:.85},cardinal:{curve:Ep,tension:"tension",value:0},"cardinal-open":{curve:Fp,tension:"tension",value:0},"cardinal-closed":{curve:Rp,tension:"tension",value:0},"catmull-rom":{curve:qp,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Yp,tension:"alpha",value:.5},"catmull-rom-open":{curve:Jp,tension:"alpha",value:.5},linear:{curve:Qp},"linear-closed":{curve:function(e){return new ed(e)}},monotone:{horizontal:function(e){return new ad(e)},vertical:function(e){return new od(e)}},natural:{curve:function(e){return new ud(e)}},step:{curve:function(e){return new cd(e,.5)}},"step-after":{curve:function(e){return new cd(e,1)}},"step-before":{curve:function(e){return new cd(e,0)}}};function Vx(e,t,n){var r=Pn(Wx,e)&&Wx[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const Hx={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},qx=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,Xx=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,Yx=/^((\s+,?\s*)|(,\s*))/,Kx=/^[01]/;function Jx(e){const t=[];return(e.match(qx)||[]).forEach((e=>{let n=e[0];const r=n.toLowerCase(),i=Hx[r],o=function(e,t,n){const r=[];for(let i=0;t&&i<n.length;)for(let o=0;o<t;++o){const t="a"!==e||3!==o&&4!==o?Xx:Kx,a=n.slice(i).match(t);if(null===a)throw Error("Invalid SVG path, incorrect parameter type");i+=a[0].length,r.push(+a[0]);const s=n.slice(i).match(Yx);null!==s&&(i+=s[0].length)}return r}(r,i,e.slice(1).trim()),a=o.length;if(a<i||a&&a%i!=0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([n,...o.slice(0,i)]),a!==i){"m"===r&&(n="M"===n?"L":"l");for(let e=i;e<a;e+=i)t.push([n,...o.slice(e,e+i)])}})),t}const Zx=Math.PI/180,Qx=Math.PI/2,e_=2*Math.PI,t_=Math.sqrt(3)/2;var n_={},r_={},i_=[].join;function o_(e){const t=i_.call(e);if(r_[t])return r_[t];var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7];const c=l*a,p=-u*s,d=u*a,h=l*s,f=Math.cos(i),g=Math.sin(i),m=Math.cos(o),y=Math.sin(o),b=.5*(o-i),v=Math.sin(.5*b),x=8/3*v*v/Math.sin(b),_=n+f-x*g,w=r+g+x*f,k=n+m,S=r+y,C=k+x*y,M=S-x*m;return r_[t]=[c*_+p*w,d*_+h*w,c*C+p*M,d*C+h*M,c*k+p*S,d*k+h*S]}const a_=["l",0,0,0,0,0,0,0];function s_(e,t,n){const r=a_[0]=e[0];if("a"===r||"A"===r)a_[1]=t*e[1],a_[2]=n*e[2],a_[3]=e[3],a_[4]=e[4],a_[5]=e[5],a_[6]=t*e[6],a_[7]=n*e[7];else if("h"===r||"H"===r)a_[1]=t*e[1];else if("v"===r||"V"===r)a_[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)a_[i]=(i%2==1?t:n)*e[i];return a_}function u_(e,t,n,r,i,o){var a,s,u,l,c,p=null,d=0,h=0,f=0,g=0,m=0,y=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==o&&(o=i),e.beginPath&&e.beginPath();for(var b=0,v=t.length;b<v;++b){switch(a=t[b],1===i&&1===o||(a=s_(a,i,o)),a[0]){case"l":d+=a[1],h+=a[2],e.lineTo(d+n,h+r);break;case"L":d=a[1],h=a[2],e.lineTo(d+n,h+r);break;case"h":d+=a[1],e.lineTo(d+n,h+r);break;case"H":d=a[1],e.lineTo(d+n,h+r);break;case"v":h+=a[1],e.lineTo(d+n,h+r);break;case"V":h=a[1],e.lineTo(d+n,h+r);break;case"m":m=d+=a[1],y=h+=a[2],e.moveTo(d+n,h+r);break;case"M":m=d=a[1],y=h=a[2],e.moveTo(d+n,h+r);break;case"c":s=d+a[5],u=h+a[6],f=d+a[3],g=h+a[4],e.bezierCurveTo(d+a[1]+n,h+a[2]+r,f+n,g+r,s+n,u+r),d=s,h=u;break;case"C":d=a[5],h=a[6],f=a[3],g=a[4],e.bezierCurveTo(a[1]+n,a[2]+r,f+n,g+r,d+n,h+r);break;case"s":s=d+a[3],u=h+a[4],f=2*d-f,g=2*h-g,e.bezierCurveTo(f+n,g+r,d+a[1]+n,h+a[2]+r,s+n,u+r),f=d+a[1],g=h+a[2],d=s,h=u;break;case"S":s=a[3],u=a[4],f=2*d-f,g=2*h-g,e.bezierCurveTo(f+n,g+r,a[1]+n,a[2]+r,s+n,u+r),d=s,h=u,f=a[1],g=a[2];break;case"q":s=d+a[3],u=h+a[4],f=d+a[1],g=h+a[2],e.quadraticCurveTo(f+n,g+r,s+n,u+r),d=s,h=u;break;case"Q":s=a[3],u=a[4],e.quadraticCurveTo(a[1]+n,a[2]+r,s+n,u+r),d=s,h=u,f=a[1],g=a[2];break;case"t":s=d+a[1],u=h+a[2],null===p[0].match(/[QqTt]/)?(f=d,g=h):"t"===p[0]?(f=2*d-l,g=2*h-c):"q"===p[0]&&(f=2*d-f,g=2*h-g),l=f,c=g,e.quadraticCurveTo(f+n,g+r,s+n,u+r),h=u,f=(d=s)+a[1],g=h+a[2];break;case"T":s=a[1],u=a[2],f=2*d-f,g=2*h-g,e.quadraticCurveTo(f+n,g+r,s+n,u+r),d=s,h=u;break;case"a":l_(e,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+d+n,a[7]+h+r]),d+=a[6],h+=a[7];break;case"A":l_(e,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),d=a[6],h=a[7];break;case"z":case"Z":d=m,h=y,e.closePath()}p=a}}function l_(e,t,n,r){const i=function(e,t,n,r,i,o,a,s,u){const l=i_.call(arguments);if(n_[l])return n_[l];const c=a*Zx,p=Math.sin(c),d=Math.cos(c),h=d*(s-e)*.5+p*(u-t)*.5,f=d*(u-t)*.5-p*(s-e)*.5;let g=h*h/((n=Math.abs(n))*n)+f*f/((r=Math.abs(r))*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,y=p/n,b=-p/r,v=d/r,x=m*s+y*u,_=b*s+v*u,w=m*e+y*t,k=b*e+v*t;let S=1/((w-x)*(w-x)+(k-_)*(k-_))-.25;S<0&&(S=0);let C=Math.sqrt(S);o==i&&(C=-C);const M=.5*(x+w)-C*(k-_),T=.5*(_+k)+C*(w-x),E=Math.atan2(_-T,x-M);let A=Math.atan2(k-T,w-M)-E;A<0&&1===o?A+=e_:A>0&&0===o&&(A-=e_);const F=Math.ceil(Math.abs(A/(Qx+.001))),O=[];for(let e=0;e<F;++e){const t=E+e*A/F,i=E+(e+1)*A/F;O[e]=[M,T,t,i,n,r,p,d]}return n_[l]=O}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let t=0;t<i.length;++t){const n=o_(i[t]);e.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5])}}const c_=.5773502691896257,p_={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,e_)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=t_*n,i=r-n*c_,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=t_*n,i=r-n*c_;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=t_*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=t_*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=t_*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=t_*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};var d_={};const h_=.448084975506;function f_(e){return e.x}function g_(e){return e.y}function m_(e){return e.width}function y_(e){return e.height}function b_(e){return"function"==typeof e?e:()=>+e}function v_(e,t,n){return Math.max(t,Math.min(e,n))}function x_(e,t){return null!=e?e:t}const __=e=>e.x||0,w_=e=>e.y||0,k_=e=>!(!1===e.defined),S_=function(){var e=vd,t=xd,n=pd(0),r=null,i=_d,o=wd,a=kd,s=null,u=bd(l);function l(){var l,c,p=+e.apply(this,arguments),d=+t.apply(this,arguments),h=i.apply(this,arguments)-Gp,f=o.apply(this,arguments)-Gp,g=Np(f-h),m=f>h;if(s||(s=l=u()),d<p&&(c=d,d=p,p=c),d>zp)if(g>Up-zp)s.moveTo(d*Ip(h),d*Pp(h)),s.arc(0,0,d,h,f,!m),p>zp&&(s.moveTo(p*Ip(f),p*Pp(f)),s.arc(0,0,p,f,h,m));else{var y,b,v=h,x=f,_=h,w=f,k=g,S=g,C=a.apply(this,arguments)/2,M=C>zp&&(r?+r.apply(this,arguments):$p(p*p+d*d)),T=Lp(Np(d-p)/2,+n.apply(this,arguments)),E=T,A=T;if(M>zp){var F=Wp(M/p*Pp(C)),O=Wp(M/d*Pp(C));(k-=2*F)>zp?(_+=F*=m?1:-1,w-=F):(k=0,_=w=(h+f)/2),(S-=2*O)>zp?(v+=O*=m?1:-1,x-=O):(S=0,v=x=(h+f)/2)}var R=d*Ip(v),N=d*Pp(v),D=p*Ip(w),I=p*Pp(w);if(T>zp){var B,L=d*Ip(x),P=d*Pp(x),$=p*Ip(_),z=p*Pp(_);if(g<jp)if(B=function(e,t,n,r,i,o,a,s){var u=n-e,l=r-t,c=a-i,p=s-o,d=p*u-c*l;if(!(d*d<zp))return[e+(d=(c*(t-o)-p*(e-i))/d)*u,t+d*l]}(R,N,$,z,L,P,D,I)){var j=R-B[0],G=N-B[1],U=L-B[0],W=P-B[1],V=1/Pp(function(e){return e>1?0:e<-1?jp:Math.acos(e)}((j*U+G*W)/($p(j*j+G*G)*$p(U*U+W*W)))/2),H=$p(B[0]*B[0]+B[1]*B[1]);E=Lp(T,(p-H)/(V-1)),A=Lp(T,(d-H)/(V+1))}else E=A=0}S>zp?A>zp?(y=Sd($,z,R,N,d,A,m),b=Sd(L,P,D,I,d,A,m),s.moveTo(y.cx+y.x01,y.cy+y.y01),A<T?s.arc(y.cx,y.cy,A,Dp(y.y01,y.x01),Dp(b.y01,b.x01),!m):(s.arc(y.cx,y.cy,A,Dp(y.y01,y.x01),Dp(y.y11,y.x11),!m),s.arc(0,0,d,Dp(y.cy+y.y11,y.cx+y.x11),Dp(b.cy+b.y11,b.cx+b.x11),!m),s.arc(b.cx,b.cy,A,Dp(b.y11,b.x11),Dp(b.y01,b.x01),!m))):(s.moveTo(R,N),s.arc(0,0,d,v,x,!m)):s.moveTo(R,N),p>zp&&k>zp?E>zp?(y=Sd(D,I,L,P,p,-E,m),b=Sd(R,N,$,z,p,-E,m),s.lineTo(y.cx+y.x01,y.cy+y.y01),E<T?s.arc(y.cx,y.cy,E,Dp(y.y01,y.x01),Dp(b.y01,b.x01),!m):(s.arc(y.cx,y.cy,E,Dp(y.y01,y.x01),Dp(y.y11,y.x11),!m),s.arc(0,0,p,Dp(y.cy+y.y11,y.cx+y.x11),Dp(b.cy+b.y11,b.cx+b.x11),m),s.arc(b.cx,b.cy,E,Dp(b.y11,b.x11),Dp(b.y01,b.x01),!m))):s.arc(0,0,p,w,_,m):s.lineTo(D,I)}else s.moveTo(0,0);if(s.closePath(),l)return s=null,l+""||null}return l.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-jp/2;return[Ip(r)*n,Pp(r)*n]},l.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:pd(+t),l):e},l.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:pd(+e),l):t},l.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:pd(+e),l):n},l.padRadius=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:pd(+e),l):r},l.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:pd(+e),l):i},l.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:pd(+e),l):o},l.padAngle=function(e){return arguments.length?(a="function"==typeof e?e:pd(+e),l):a},l.context=function(e){return arguments.length?(s=null==e?null:e,l):s},l}().startAngle((e=>e.startAngle||0)).endAngle((e=>e.endAngle||0)).padAngle((e=>e.padAngle||0)).innerRadius((e=>e.innerRadius||0)).outerRadius((e=>e.outerRadius||0)).cornerRadius((e=>e.cornerRadius||0)),C_=Ad().x(__).y1(w_).y0((e=>(e.y||0)+(e.height||0))).defined(k_),M_=Ad().y(w_).x1(__).x0((e=>(e.x||0)+(e.width||0))).defined(k_),T_=Ed().x(__).y(w_).defined(k_),E_=function(){var e=f_,t=g_,n=m_,r=y_,i=b_(0),o=i,a=i,s=i,u=null;function l(l,c,p){var d,h=null!=c?c:+e.call(this,l),f=null!=p?p:+t.call(this,l),g=+n.call(this,l),m=+r.call(this,l),y=Math.min(g,m)/2,b=v_(+i.call(this,l),0,y),v=v_(+o.call(this,l),0,y),x=v_(+a.call(this,l),0,y),_=v_(+s.call(this,l),0,y);if(u||(u=d=Ld()),b<=0&&v<=0&&x<=0&&_<=0)u.rect(h,f,g,m);else{var w=h+g,k=f+m;u.moveTo(h+b,f),u.lineTo(w-v,f),u.bezierCurveTo(w-h_*v,f,w,f+h_*v,w,f+v),u.lineTo(w,k-_),u.bezierCurveTo(w,k-h_*_,w-h_*_,k,w-_,k),u.lineTo(h+x,k),u.bezierCurveTo(h+h_*x,k,h,k-h_*x,h,k-x),u.lineTo(h,f+b),u.bezierCurveTo(h,f+h_*b,h+h_*b,f,h+b,f),u.closePath()}if(d)return u=null,d+""||null}return l.x=function(t){return arguments.length?(e=b_(t),l):e},l.y=function(e){return arguments.length?(t=b_(e),l):t},l.width=function(e){return arguments.length?(n=b_(e),l):n},l.height=function(e){return arguments.length?(r=b_(e),l):r},l.cornerRadius=function(e,t,n,r){return arguments.length?(i=b_(e),o=null!=t?b_(t):i,s=null!=n?b_(n):i,a=null!=r?b_(r):o,l):i},l.context=function(e){return arguments.length?(u=null==e?null:e,l):u},l}().x(__).y(w_).width((e=>e.width||0)).height((e=>e.height||0)).cornerRadius((e=>x_(e.cornerRadiusTopLeft,e.cornerRadius)||0),(e=>x_(e.cornerRadiusTopRight,e.cornerRadius)||0),(e=>x_(e.cornerRadiusBottomRight,e.cornerRadius)||0),(e=>x_(e.cornerRadiusBottomLeft,e.cornerRadius)||0)),A_=function(e,t){let n=null,r=bd(i);function i(){let i;if(n||(n=i=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return e="function"==typeof e?e:pd(e||Fd),t="function"==typeof t?t:pd(void 0===t?64:+t),i.type=function(t){return arguments.length?(e="function"==typeof t?t:pd(t),i):e},i.size=function(e){return arguments.length?(t="function"==typeof e?e:pd(+e),i):t},i.context=function(e){return arguments.length?(n=null==e?null:e,i):n},i}().type((e=>{return t=e.shape||"circle",Pn(p_,t)?p_[t]:function(e){if(!Pn(d_,e)){const t=Jx(e);d_[e]={draw:function(e,n){u_(e,t,0,0,Math.sqrt(n)/2)}}}return d_[e]}(t);var t})).size((e=>x_(e.size,64))),F_=function(){var e,t,n,r,i,o,a,s,u=null;function l(e,t,n){const r=n/2;if(i){var l=a-t,c=e-o;if(l||c){var p=Math.sqrt(l*l+c*c),d=(l/=p)*s,h=(c/=p)*s,f=Math.atan2(c,l);u.moveTo(o-d,a-h),u.lineTo(e-l*r,t-c*r),u.arc(e,t,r,f-Math.PI,f),u.lineTo(o+d,a+h),u.arc(o,a,s,f,f+Math.PI)}else u.arc(e,t,r,0,e_);u.closePath()}else i=1;o=e,a=t,s=r}function c(o){var a,s,c,p=o.length,d=!1;for(null==u&&(u=c=Ld()),a=0;a<=p;++a)!(a<p&&r(s=o[a],a,o))===d&&(d=!d)&&(i=0),d&&l(+e(s,a,o),+t(s,a,o),+n(s,a,o));if(c)return u=null,c+""||null}return c.x=function(t){return arguments.length?(e=t,c):e},c.y=function(e){return arguments.length?(t=e,c):t},c.size=function(e){return arguments.length?(n=e,c):n},c.defined=function(e){return arguments.length?(r=e,c):r},c.context=function(e){return arguments.length?(u=null==e?null:e,c):u},c}().x(__).y(w_).defined(k_).size((e=>e.size||1));function O_(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function R_(e,t,n,r){return E_.context(e)(t,n,r)}var N_=1;function D_(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+N_++),a=i.clipping[o]||(i.clipping[o]={id:o});return Mn(r)?a.path=r(null):O_(n)?a.path=R_(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"}function I_(e){this.clear(),e&&this.union(e)}function B_(e){this.mark=e,this.bounds=this.bounds||new I_}function L_(e){B_.call(this,e),this.items=this.items||[]}function P_(e){this._pending=0,this._loader=e||iu()}function $_(e){e._pending+=1}function z_(e){e._pending-=1}function j_(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){const r=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(r+(n?function(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,r):0))}return e}I_.prototype={clone(){return new I_(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:o,y2:a}=this,s=Math.cos(e),u=Math.sin(e),l=t-t*s+n*u,c=n-t*u-n*s;return[s*r-u*i+l,u*r+s*i+c,s*r-u*a+l,u*r+s*a+c,s*o-u*i+l,u*o+s*i+c,s*o-u*a+l,u*o+s*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},jn(L_,B_),P_.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return $_(t),t._loader.sanitize(e,{context:"href"}).then((e=>(z_(t),e))).catch((()=>(z_(t),null)))},loadImage(e){const t=this,n=$d();return $_(t),t._loader.sanitize(e,{context:"image"}).then((e=>{const r=e.href;if(!r||!n)throw{url:r};const i=new n,o=Pn(e,"crossOrigin")?e.crossOrigin:"anonymous";return null!=o&&(i.crossOrigin=o),i.onload=()=>z_(t),i.onerror=()=>z_(t),i.src=r,i})).catch((e=>(z_(t),{complete:!1,width:0,height:0,src:e&&e.url||""})))},ready(){const e=this;return new Promise((t=>{!function n(r){e.pending()?setTimeout((()=>{n(!0)}),10):t(r)}(!1)}))}};const G_=e_-1e-8;let U_,W_,V_,H_,q_,X_,Y_,K_;const J_=(e,t)=>U_.add(e,t),Z_=(e,t)=>J_(W_=e,V_=t),Q_=e=>J_(e,U_.y1),ew=e=>J_(U_.x1,e),tw=(e,t)=>q_*e+Y_*t,nw=(e,t)=>X_*e+K_*t,rw=(e,t)=>J_(tw(e,t),nw(e,t)),iw=(e,t)=>Z_(tw(e,t),nw(e,t));function ow(e,t){return U_=e,t?(H_=t*Zx,q_=K_=Math.cos(H_),X_=Math.sin(H_),Y_=-X_):(q_=K_=1,H_=X_=Y_=0),aw}const aw={beginPath(){},closePath(){},moveTo:iw,lineTo:iw,rect(e,t,n,r){H_?(rw(e+n,t),rw(e+n,t+r),rw(e,t+r),iw(e,t)):(J_(e+n,t+r),Z_(e,t))},quadraticCurveTo(e,t,n,r){const i=tw(e,t),o=nw(e,t),a=tw(n,r),s=nw(n,r);sw(W_,i,a,Q_),sw(V_,o,s,ew),Z_(a,s)},bezierCurveTo(e,t,n,r,i,o){const a=tw(e,t),s=nw(e,t),u=tw(n,r),l=nw(n,r),c=tw(i,o),p=nw(i,o);uw(W_,a,u,c,Q_),uw(V_,s,l,p,ew),Z_(c,p)},arc(e,t,n,r,i,o){if(r+=H_,i+=H_,W_=n*Math.cos(i)+e,V_=n*Math.sin(i)+t,Math.abs(i-r)>G_)J_(e-n,t-n),J_(e+n,t+n);else{const a=r=>J_(n*Math.cos(r)+e,n*Math.sin(r)+t);let s,u;if(a(r),a(i),i!==r)if((r%=e_)<0&&(r+=e_),(i%=e_)<0&&(i+=e_),i<r&&(o=!o,s=r,r=i,i=s),o)for(i-=e_,s=r-r%Qx,u=0;u<4&&s>i;++u,s-=Qx)a(s);else for(s=r-r%Qx+Qx,u=0;u<4&&s<i;++u,s+=Qx)a(s)}}};function sw(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function uw(e,t,n,r,i){const o=r-e+3*t-3*n,a=e+n-2*t,s=e-t;let u,l=0,c=0;Math.abs(o)>1e-14?(u=a*a+s*o,u>=0&&(u=Math.sqrt(u),l=(-a+u)/o,c=(-a-u)/o)):l=.5*s/a,0<l&&l<1&&i(lw(l,e,t,n,r)),0<c&&c<1&&i(lw(c,e,t,n,r))}function lw(e,t,n,r,i){const o=1-e,a=o*o,s=e*e;return a*o*t+3*a*e*n+3*o*s*r+s*e*i}var cw=(cw=Pd(1,1))?cw.getContext("2d"):null;const pw=new I_;function dw(e){return function(t,n){if(!cw)return!0;e(cw,t),pw.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:a}=pw;for(let e=i;e<=a;++e)for(let t=r;t<=o;++t)if(cw.isPointInPath(t,e))return!0;return!1}}function hw(e,t){return t.contains(e.x||0,e.y||0)}function fw(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,o=e.height||0;return t.intersects(pw.set(n,r,n+i,r+o))}function gw(e,t,n,r,i){const{x1:o,y1:a,x2:s,y2:u}=e,l=r-t,c=i-n;let p,d,h,f,g=0,m=1;for(f=0;f<4;++f){if(0===f&&(p=-l,d=-(o-t)),1===f&&(p=l,d=s-t),2===f&&(p=-c,d=-(a-n)),3===f&&(p=c,d=u-n),Math.abs(p)<1e-10&&d<0)return!1;if(h=d/p,p<0){if(h>m)return!1;h>g&&(g=h)}else if(p>0){if(h<g)return!1;h<m&&(m=h)}}return!0}function mw(e,t){e.globalCompositeOperation=t.blend||"source-over"}function yw(e,t){return null==e?t:e}function bw(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function vw(e,t,n){return jx(n)?function(e,t,n){const r=n.width(),i=n.height();let o;if("radial"===t.gradient)o=e.createRadialGradient(n.x1+yw(t.x1,.5)*r,n.y1+yw(t.y1,.5)*i,Math.max(r,i)*yw(t.r1,0),n.x1+yw(t.x2,.5)*r,n.y1+yw(t.y2,.5)*i,Math.max(r,i)*yw(t.r2,.5));else{const a=yw(t.x1,0),s=yw(t.y1,0),u=yw(t.x2,1),l=yw(t.y2,0);if(a!==u&&s!==l&&r!==i){const n=Pd(Math.ceil(r),Math.ceil(i)),o=n.getContext("2d");return o.scale(r,i),o.fillStyle=bw(o.createLinearGradient(a,s,u,l),t.stops),o.fillRect(0,0,r,i),e.createPattern(n,"no-repeat")}o=e.createLinearGradient(n.x1+a*r,n.y1+s*i,n.x1+u*r,n.y1+l*i)}return bw(o,t.stops)}(e,n,t.bounds):n}function xw(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=vw(e,t,t.fill),!0)}var _w=[];function ww(e,t,n){var r=null!=(r=t.strokeWidth)?r:1;return!(r<=0)&&(n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=vw(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||_w),e.lineDashOffset=t.strokeDashOffset||0),!0)}function kw(e,t){return e.zindex-t.zindex||e.index-t.index}function Sw(e){if(!e.zdirty)return e.zitems;var t,n,r,i=e.items,o=[];for(n=0,r=i.length;n<r;++n)(t=i[n]).index=n,t.zindex&&o.push(t);return e.zdirty=!1,e.zitems=o.sort(kw)}function Cw(e,t){var n,r,i=e.items;if(!i||!i.length)return;const o=Sw(e);if(o&&o.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||t(i[n]);i=o}for(n=0,r=i.length;n<r;++n)t(i[n])}function Mw(e,t){var n,r,i=e.items;if(!i||!i.length)return null;const o=Sw(e);for(o&&o.length&&(i=o),r=i.length;--r>=0;)if(n=t(i[r]))return n;if(i===o)for(r=(i=e.items).length;--r>=0;)if(!i[r].zindex&&(n=t(i[r])))return n;return null}function Tw(e){return function(t,n,r){Cw(n,(n=>{r&&!r.intersects(n.bounds)||Ew(e,t,n,n)}))}}function Ew(e,t,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(e(t,r)||(mw(t,n),n.fill&&xw(t,n,i)&&t.fill(),n.stroke&&ww(t,n,i)&&t.stroke()))}function Aw(e){return e=e||Zt,function(t,n,r,i,o,a){return r*=t.pixelRatio,i*=t.pixelRatio,Mw(n,(n=>{const s=n.bounds;if((!s||s.contains(o,a))&&s)return e(t,n,r,i,o,a)?n:void 0}))}}function Fw(e,t){return function(n,r,i,o){var a,s,u=Array.isArray(r)?r[0]:r,l=null==t?u.fill:t,c=u.stroke&&n.isPointInStroke;return c&&(a=u.strokeWidth,s=u.strokeCap,n.lineWidth=null!=a?a:1,n.lineCap=null!=s?s:"butt"),!e(n,r)&&(l&&n.isPointInPath(i,o)||c&&n.isPointInStroke(i,o))}}function Ow(e){return Aw(Fw(e))}function Rw(e,t){return"translate("+e+","+t+")"}function Nw(e){return"rotate("+e+")"}function Dw(e){return Rw(e.x||0,e.y||0)}function Iw(e,t,n){function r(e,n){var r=n.x||0,i=n.y||0,o=n.angle||0;e.translate(r,i),o&&e.rotate(o*=Zx),e.beginPath(),t(e,n),o&&e.rotate(-o),e.translate(-r,-i)}return{type:e,tag:"path",nested:!1,attr:function(e,n){e("transform",function(e){return Rw(e.x||0,e.y||0)+(e.angle?" "+Nw(e.angle):"")}(n)),e("d",t(null,n))},bound:function(e,n){return t(ow(e,n.angle),n),j_(e,n).translate(n.x||0,n.y||0)},draw:Tw(r),pick:Ow(r),isect:n||dw(r)}}var Bw=Iw("arc",(function(e,t){return S_.context(e)(t)}));function Lw(e,t,n){function r(e,n){e.beginPath(),t(e,n)}const i=Fw(r);return{type:e,tag:"path",nested:!0,attr:function(e,n){var r=n.mark.items;r.length&&e("d",t(null,r))},bound:function(e,n){var r=n.items;return 0===r.length?e:(t(ow(e),r),j_(e,r[0]))},draw:(o=r,function(e,t,n){!t.items.length||n&&!n.intersects(t.bounds)||Ew(o,e,t.items[0],t.items)}),pick:function(e,t,n,r,o,a){var s=t.items,u=t.bounds;return!s||!s.length||u&&!u.contains(o,a)?null:(n*=e.pixelRatio,r*=e.pixelRatio,i(e,s,n,r)?s[0]:null)},isect:hw,tip:n};var o}var Pw=Lw("area",(function(e,t){const n=t[0],r=n.interpolate||"linear";return("horizontal"===n.orient?M_:C_).curve(Vx(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,i="horizontal"===e[0].orient?t[1]:t[0],o="horizontal"===e[0].orient?"y":"x",a=e.length,s=1/0;--a>=0;)!1!==e[a].defined&&(r=Math.abs(e[a][o]-i))<s&&(s=r,n=e[a]);return n}));function $w(e,t){e.beginPath(),O_(t)?R_(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function zw(e){const t=yw(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function jw(e,t){const n=zw(t);e("d",R_(null,t,n,n))}function Gw(e,t,n,r){const i=zw(t);e.beginPath(),R_(e,t,(n||0)+i,(r||0)+i)}const Uw=Fw(Gw),Ww=Fw(Gw,!1),Vw=Fw(Gw,!0);var Hw={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",Dw(t))},bound:function(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let t=0;t<r;++t)e.union(n[t].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),j_(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){Cw(t,(t=>{const r=t.x||0,i=t.y||0,o=t.strokeForeground,a=null==t.opacity?1:t.opacity;(t.stroke||t.fill)&&a&&(Gw(e,t,r,i),mw(e,t),t.fill&&xw(e,t,a)&&e.fill(),t.stroke&&!o&&ww(e,t,a)&&e.stroke()),e.save(),e.translate(r,i),t.clip&&$w(e,t),n&&n.translate(-r,-i),Cw(t,(t=>{this.draw(e,t,n)})),n&&n.translate(r,i),e.restore(),o&&t.stroke&&a&&(Gw(e,t,r,i),mw(e,t),ww(e,t,a)&&e.stroke())}))},pick:function(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;const a=n*e.pixelRatio,s=r*e.pixelRatio;return Mw(t,(u=>{let l,c,p;const d=u.bounds;if(d&&!d.contains(i,o))return;c=u.x||0,p=u.y||0;const h=c+(u.width||0),f=p+(u.height||0),g=u.clip;if(g&&(i<c||i>h||o<p||o>f))return;if(e.save(),e.translate(c,p),c=i-c,p=o-p,g&&O_(u)&&!Vw(e,u,a,s))return e.restore(),null;const m=u.strokeForeground,y=!1!==t.interactive;return y&&m&&u.stroke&&Ww(e,u,a,s)?(e.restore(),u):(l=Mw(u,(e=>function(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(e,c,p)?this.pick(e,n,r,c,p):null)),!l&&y&&(u.fill||!m&&u.stroke)&&Uw(e,u,a,s)&&(l=u),e.restore(),l||null)}))},isect:fw,content:function(e,t,n){e("clip-path",t.clip?D_(n,t,t):null)},background:function(e,t){e("class","background"),e("aria-hidden",!0),jw(e,t)},foreground:function(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?jw(e,t):e("d","")}},qw={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Xw(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then((t=>{e.image=t,e.image.url=e.url}))),n}function Yw(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function Kw(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function Jw(e,t){return"center"===e?t/2:"right"===e?t:0}function Zw(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var Qw={type:"image",tag:"image",nested:!1,attr:function(e,t,n){const r=Xw(t,n),i=Yw(t,r),o=Kw(t,r),a=(t.x||0)-Jw(t.align,i),s=(t.y||0)-Zw(t.baseline,o);e("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",qw["xmlns:xlink"],"xlink:href"),e("transform",Rw(a,s)),e("width",i),e("height",o),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function(e,t){const n=t.image,r=Yw(t,n),i=Kw(t,n),o=(t.x||0)-Jw(t.align,r),a=(t.y||0)-Zw(t.baseline,i);return e.set(o,a,o+r,a+i)},draw:function(e,t,n){Cw(t,(t=>{if(n&&!n.intersects(t.bounds))return;const r=Xw(t,this);let i=Yw(t,r),o=Kw(t,r);if(0===i||0===o)return;let a,s,u,l,c=(t.x||0)-Jw(t.align,i),p=(t.y||0)-Zw(t.baseline,o);!1!==t.aspect&&(s=r.width/r.height,u=t.width/t.height,s==s&&u==u&&s!==u&&(u<s?(l=i/s,p+=(o-l)/2,o=l):(l=o*s,c+=(i-l)/2,i=l))),(r.complete||r.toDataURL)&&(mw(e,t),e.globalAlpha=null!=(a=t.opacity)?a:1,e.imageSmoothingEnabled=!1!==t.smooth,e.drawImage(r,c,p,i,o))}))},pick:Aw(),isect:Zt,get:Xw,xOffset:Jw,yOffset:Zw},ek=Lw("line",(function(e,t){const n=t[0],r=n.interpolate||"linear";return T_.curve(Vx(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,i=Math.pow(e[0].strokeWidth||1,2),o=e.length;--o>=0;)if(!1!==e[o].defined&&(n=e[o].x-t[0])*n+(r=e[o].y-t[1])*r<i)return e[o];return null}));function tk(e,t){var n=t.path;if(null==n)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,a=t.scaleY||1,s=(t.angle||0)*Zx,u=t.pathCache;u&&u.path===n||((t.pathCache=u=Jx(n)).path=n),s&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(s),u_(e,u,0,0,o,a),e.rotate(-s),e.translate(-r,-i)):u_(e,u,r,i,o,a)}var nk={type:"path",tag:"path",nested:!1,attr:function(e,t){var n=t.scaleX||1,r=t.scaleY||1;1===n&&1===r||e("vector-effect","non-scaling-stroke"),e("transform",function(e){return Rw(e.x||0,e.y||0)+(e.angle?" "+Nw(e.angle):"")+(e.scaleX||e.scaleY?" "+(t=e.scaleX||1,n=e.scaleY||1,"scale("+t+","+n+")"):"");var t,n}(t)),e("d",t.path)},bound:function(e,t){return tk(ow(e,t.angle),t)?e.set(0,0,0,0):j_(e,t,!0)},draw:Tw(tk),pick:Ow(tk),isect:dw(tk)};function rk(e,t){e.beginPath(),R_(e,t)}var ik={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",R_(null,t))},bound:function(e,t){var n,r;return j_(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)},draw:Tw(rk),pick:Ow(rk),isect:fw};function ok(e,t,n){var r,i,o,a;return!(!t.stroke||!ww(e,t,n)||(r=t.x||0,i=t.y||0,o=null!=t.x2?t.x2:r,a=null!=t.y2?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,a),0))}var ak={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",Dw(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,r;return j_(e.set(n=t.x||0,r=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r),t)},draw:function(e,t,n){Cw(t,(t=>{if(!n||n.intersects(t.bounds)){var r=null==t.opacity?1:t.opacity;r&&ok(e,t,r)&&(mw(e,t),e.stroke())}}))},pick:Aw((function(e,t,n,r){return!!e.isPointInStroke&&ok(e,t,1)&&e.isPointInStroke(n,r)})),isect:function(e,t){const n=e.x||0,r=e.y||0;return gw(t,n,r,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r)}},sk=Iw("shape",(function(e,t){return(t.mark.shape||t.shape).context(e)(t)})),uk=Iw("symbol",(function(e,t){return A_.context(e)(t)}),hw);const lk=function(e){let t,n,r;e=+e||1e4;const i=()=>{t={},n={},r=0},o=(i,o)=>(++r>e&&(n=t,t={},r=1),t[i]=o);return i(),{clear:i,has:e=>Pn(t,e)||Pn(n,e),get:e=>Pn(t,e)?t[e]:Pn(n,e)?o(e,n[e]):void 0,set:(e,n)=>Pn(t,e)?t[e]=n:o(e,n)}}();var ck={height:mk,measureWidth:fk,estimateWidth:dk,width:dk,canvas:pk};function pk(e){ck.width=e&&cw?fk:dk}function dk(e,t){return hk(xk(e,t),mk(e))}function hk(e,t){return~~(.8*e.length*t)}function fk(e,t){return mk(e)<=0||!(t=xk(e,t))?0:gk(t,wk(e))}function gk(e,t){const n=`(${t}) ${e}`;let r=lk.get(n);return void 0===r&&(cw.font=t,r=cw.measureText(e).width,lk.set(n,r)),r}function mk(e){return null!=e.fontSize?+e.fontSize||0:11}function yk(e){return null!=e.lineHeight?e.lineHeight:mk(e)+2}function bk(e){return t=e.lineBreak&&e.text&&!sn(e.text)?e.text.split(e.lineBreak):e.text,sn(t)?t.length>1?t:t[0]:t;var t}function vk(e){const t=bk(e);return(sn(t)?t.length-1:0)*yk(e)}function xk(e,t){const n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function(e,t){var n=+e.limit,r=function(e){if(ck.width===fk){const t=wk(e);return e=>gk(e,t)}{const t=mk(e);return e=>hk(e,t)}}(e);if(r(t)<n)return t;var i,o=e.ellipsis||"",a="rtl"===e.dir,s=0,u=t.length;if(n-=r(o),a){for(;s<u;)i=s+u>>>1,r(t.slice(i))>n?s=i+1:u=i;return o+t.slice(s)}for(;s<u;)i=1+(s+u>>>1),r(t.slice(0,i))<n?s=i:u=i-1;return t.slice(0,s)+o}(e,n):n}function _k(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function wk(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+mk(e)+"px "+_k(e,t)}function kk(e){var t=e.baseline,n=mk(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*yk(e):"line-bottom"===t?.29*n-.5*yk(e):0)}pk(!0);const Sk={left:"start",center:"middle",right:"end"},Ck=new I_;function Mk(e){var t,n=e.x||0,r=e.y||0,i=e.radius||0;return i&&(t=(e.theta||0)-Qx,n+=i*Math.cos(t),r+=i*Math.sin(t)),Ck.x1=n,Ck.y1=r,Ck}function Tk(e,t,n){var r,i=ck.height(t),o=t.align,a=Mk(t),s=a.x1,u=a.y1,l=t.dx||0,c=(t.dy||0)+kk(t)-Math.round(.8*i),p=bk(t);if(sn(p)?(i+=yk(t)*(p.length-1),r=p.reduce(((e,n)=>Math.max(e,ck.width(t,n))),0)):r=ck.width(t,p),"center"===o?l-=r/2:"right"===o&&(l-=r),e.set(l+=s,c+=u,l+r,c+i),t.angle&&!n)e.rotate(t.angle*Zx,s,u);else if(2===n)return e.rotatedPoints(t.angle*Zx,s,u);return e}var Ek={type:"text",tag:"text",nested:!1,attr:function(e,t){var n,r=t.dx||0,i=(t.dy||0)+kk(t),o=Mk(t),a=o.x1,s=o.y1,u=t.angle||0;e("text-anchor",Sk[t.align]||"start"),u?(n=Rw(a,s)+" "+Nw(u),(r||i)&&(n+=" "+Rw(r,i))):n=Rw(a+r,s+i),e("transform",n)},bound:Tk,draw:function(e,t,n){Cw(t,(t=>{var r,i,o,a,s,u,l,c=null==t.opacity?1:t.opacity;if(!(n&&!n.intersects(t.bounds)||0===c||t.fontSize<=0||null==t.text||0===t.text.length)){if(e.font=wk(t),e.textAlign=t.align||"left",i=(r=Mk(t)).x1,o=r.y1,t.angle&&(e.save(),e.translate(i,o),e.rotate(t.angle*Zx),i=o=0),i+=t.dx||0,o+=(t.dy||0)+kk(t),u=bk(t),mw(e,t),sn(u))for(s=yk(t),a=0;a<u.length;++a)l=xk(t,u[a]),t.fill&&xw(e,t,c)&&e.fillText(l,i,o),t.stroke&&ww(e,t,c)&&e.strokeText(l,i,o),o+=s;else l=xk(t,u),t.fill&&xw(e,t,c)&&e.fillText(l,i,o),t.stroke&&ww(e,t,c)&&e.strokeText(l,i,o);t.angle&&e.restore()}}))},pick:Aw((function(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=Mk(t),s=a.x1,u=a.y1,l=Tk(Ck,t,1),c=-t.angle*Zx,p=Math.cos(c),d=Math.sin(c),h=p*i-d*o+(s-p*s+d*u),f=d*i+p*o+(u-d*s-p*u);return l.contains(h,f)})),isect:function(e,t){const n=Tk(Ck,e,2);return gw(t,n[0],n[1],n[2],n[3])||gw(t,n[0],n[1],n[4],n[5])||gw(t,n[4],n[5],n[6],n[7])||gw(t,n[2],n[3],n[6],n[7])}},Ak=Lw("trail",(function(e,t){return F_.context(e)(t)}),(function(e,t){for(var n,r,i=e.length;--i>=0;)if(!1!==e[i].defined&&(n=e[i].x-t[0])*n+(r=e[i].y-t[1])*r<(n=e[i].size||1)*n)return e[i];return null})),Fk={arc:Bw,area:Pw,group:Hw,image:Qw,line:ek,path:nk,rect:ik,rule:ak,shape:sk,symbol:uk,text:Ek,trail:Ak};function Ok(e,t,n){var r=Fk[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new I_),e,n)}var Rk={mark:null};const Nk=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function Dk(e){return Ik("string"==typeof e?JSON.parse(e):e)}function Ik(e){var t,n,r,i=e.marktype,o=e.items;if(o)for(n=0,r=o.length;n<r;++n)t=i?"mark":"group",o[n][t]=e,o[n].zindex&&(o[n][t].zdirty=!0),"group"===(i||t)&&Ik(o[n]);return i&&function(e,t,n){var r,i,o,a,s=Fk[e.marktype],u=s.bound,l=e.items,c=l&&l.length;if(s.nested)return c?o=l[0]:(Rk.mark=e,o=Rk),a=Ok(o,u,n),t&&t.union(a)||a;if(t=t||e.bounds&&e.bounds.clear()||new I_,c)for(r=0,i=l.length;r<i;++r)t.union(Ok(l[r],u,n));e.bounds=t}(e),e}function Bk(e){arguments.length?this.root=Dk(e):(this.root=Lk({marktype:"group",name:"root",role:"frame"}),this.root.items=[new L_(this.root)])}function Lk(e,t){const n={bounds:new I_,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Pk(e,t,n){return!e&&"undefined"!=typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function $k(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function zk(e,t,n,r){var i,o=e.childNodes[t];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(i=o||null,o=Pk(e.ownerDocument,n,r),e.insertBefore(o,i)),o}function jk(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function Gk(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Uk(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function Wk(e,t){this._active=null,this._handlers={},this._loader=e||iu(),this._tooltip=t||Vk}function Vk(e,t,n,r){e.element().setAttribute("title",r||"")}function Hk(e){this._el=null,this._bgcolor=null,this._loader=new P_(e)}Bk.prototype={toJSON(e){return function(e,t){return JSON.stringify(e,Nk,t)}(this.root,e||0)},mark(e,t,n){const r=Lk(e,t=t||this.root.items[0]);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},Wk.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const e in t)n.push(...t[e]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then((t=>{const n=new MouseEvent(e.type,e),r=Pk(null,"a");for(const e in t)r.setAttribute(e,t[e]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(e,t,n){if(t&&null!=t.tooltip){t=function(e,t,n,r){var i,o,a=e&&e.mark;if(a&&(i=Fk[a.marktype]).tip){for((o=Uk(t,n))[0]-=r[0],o[1]-=r[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=i.tip(a.items,o)}return e}(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,o=i.width(),a=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)s+=e.x||0,u+=e.y||0;return{x:s,y:u,width:o,height:a,left:s,top:u,right:s+o,bottom:u+a}}},Hk.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then((()=>t)):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const e=n._call;n._ready=n._loader.ready().then((t=>{t&&e(),n._ready=null}))}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const qk="dragenter",Xk="dragleave",Yk="dragover",Kk="mousedown",Jk="mousemove",Zk="mouseout",Qk="mouseover",eS="click",tS="mousewheel",nS="touchstart",rS="touchmove",iS="touchend",oS=Jk,aS=Zk,sS=eS;function uS(e,t){Wk.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function lS(e,t){(e=>e===nS||e===rS||e===iS?[nS,rS,iS]:[e])(t).forEach((t=>function(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?n=>e[t](n):n=>e.fire(t,n)))}(e,t)))}function cS(e,t,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i||(i&&i.exit||this.fire(n,r),this._active=o,this.fire(t,r)),this.fire(e,r)}}function pS(e){return function(t){this.fire(e,t),this._active=null}}jn(uS,Wk,{initialize(e,t,n){return this._canvas=e&&$k(e,"canvas"),[eS,Kk,Jk,Zk,Xk].forEach((e=>lS(this,e))),Wk.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",qk,Xk,Yk,Kk,"mouseup",Jk,Zk,Qk,eS,"dblclick","wheel",tS,nS,rS,iS],DOMMouseScroll(e){this.fire(tS,e)},mousemove:cS(Jk,Qk,Zk),dragover:cS(Yk,qk,Xk),mouseout:pS(Zk),dragleave:pS(Xk),mousedown(e){this._down=this._active,this.fire(Kk,e)},click(e){this._down===this._active&&(this.fire(eS,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(nS,e,!0)},touchmove(e){this.fire(rS,e,!0)},touchend(e){this.fire(iS,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===sS&&r&&r.href?this.handleHref(t,r,r.href):e!==oS&&e!==aS||this.handleTooltip(t,r,e!==aS),i)for(let e=0,n=i.length;e<n;++e)i[e].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(lS(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=Uk(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const o=this.context();return Fk[e.marktype].pick.call(this,o,e,t,n,r,i)}});var dS="undefined"!=typeof window&&window.devicePixelRatio||1;function hS(e){Hk.call(this,e),this._options={},this._redraw=!1,this._dirty=new I_,this._tempb=new I_}const fS=Hk.prototype;function gS(e,t){Wk.call(this,e,t);const n=this;n._hrefHandler=mS(n,((e,t)=>{t&&t.href&&n.handleHref(e,t,t.href)})),n._tooltipHandler=mS(n,((e,t)=>{n.handleTooltip(e,t,e.type!==aS)}))}jn(hS,Hk,{initialize(e,t,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:Pd(1,1,this._options.type),e&&this._canvas&&(jk(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),fS.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(fS.resize.call(this,e,t,n,r),this._canvas)!function(e,t,n,r,i,o){const a="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,s=e.getContext("2d"),u=a?dS:i;e.width=t*u,e.height=n*u;for(const e in o)s[e]=o[e];a&&1!==u&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const e=this._options.externalContext;e||Vt("CanvasRenderer is missing a valid canvas or context"),e.scale(this._scale,this._scale),e.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,a=((e,t,n)=>(new I_).set(0,0,t,n).translate(-e[0],-e[1]))(n,r,i);t.save();const s=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):function(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,a.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,s),t.restore(),o.clear(),this},draw(e,t,n){const r=Fk[t.marktype];t.clip&&function(e,t){var n=t.clip;e.save(),Mn(n)?(e.beginPath(),n(e),e.clip()):$w(e,t.group)}(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,o=this.context();"pdf"===i.type||i.externalContext||o.clearRect(e,t,n,r),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,r))}});const mS=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};jn(gS,Wk,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(sS,this._hrefHandler),r.removeEventListener(oS,this._tooltipHandler),r.removeEventListener(aS,this._tooltipHandler)),this._svg=r=e&&$k(e,"svg"),r&&(r.addEventListener(sS,this._hrefHandler),r.addEventListener(oS,this._tooltipHandler),r.addEventListener(aS,this._tooltipHandler)),Wk.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const i={type:e,handler:t,listener:mS(this,t)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const yS="aria-hidden",bS="aria-label",vS="role",xS="aria-roledescription",_S="graphics-object",wS="graphics-symbol",kS=(e,t,n)=>({[vS]:e,[xS]:t,[bS]:n||void 0}),SS=er(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),CS={axis:{desc:"axis",caption:function(e){const t=e.datum,n=e.orient,r=t.title?FS(e):null,i=e.context,o=i.scales[t.scale].value,a=i.dataflow.locale(),s=o.type;return`${"left"===n||"right"===n?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${ox(s)?"discrete":s} scale`+` with ${Px(a,o,e)}`}},legend:{desc:"legend",caption:function(e){const t=e.datum,n=t.title?FS(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),a=e.context,s=a.scales[i[o[0]]].value,u=a.dataflow.locale();return((l=r).length?l[0].toUpperCase()+l.slice(1):l)+(n?` titled '${n}'`:"")+` for ${function(e){return(e=e.map((e=>e+("fill"===e||"stroke"===e?" color":"")))).length<2?e[0]:e.slice(0,-1).join(", ")+" and "+dn(e)}(o)}`+` with ${Px(u,s,e)}`;var l}},"title-text":{desc:"title",caption:e=>`Title text '${AS(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${AS(e)}'`}},MS={ariaRole:vS,ariaRoleDescription:xS,description:bS};function TS(e,t){const n=!1===t.aria;if(e(yS,n||void 0),n||null==t.description)for(const t in MS)e(MS[t],void 0);else{const n=t.mark.marktype;e(bS,t.description),e(vS,t.ariaRole||("group"===n?_S:wS)),e(xS,t.ariaRoleDescription||`${n} mark`)}}function ES(e){return!1===e.aria?{[yS]:!0}:SS[e.role]?null:CS[e.role]?function(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return kS(t.role||wS,t.desc,n.description||r(n))}catch(e){return null}}(e,CS[e.role]):function(e){const t=e.marktype,n="group"===t||"text"===t||e.items.some((e=>null!=e.description&&!1!==e.aria));return kS(n?_S:wS,`${t} mark container`,e.description)}(e)}function AS(e){return Cn(e.text).join(" ")}function FS(e){try{return Cn(dn(e.items).items[0].text).join(" ")}catch(e){return null}}const OS=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function RS(){let e="",t="",n="";const r=[],i=()=>t=n="",o=(e,n)=>{var r;return null!=n&&(t+=` ${e}="${r=n,OS(r).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")}"`),a},a={open(s){(o=>{t&&(e+=`${t}>${n}`,i()),r.push(o)})(s),t="<"+s;for(var u=arguments.length,l=new Array(u>1?u-1:0),c=1;c<u;c++)l[c-1]=arguments[c];for(const e of l)for(const t in e)o(t,e[t]);return a},close(){const o=r.pop();return e+=t?t+(n?`>${n}</${o}>`:"/>"):`</${o}>`,i(),a},attr:o,text:e=>(n+=OS(e),a),toString:()=>e};return a}const NS=e=>DS(RS(),e)+"";function DS(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let t=0;t<r;++t)e.attr(n[t].name,n[t].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const t of n)3===t.nodeType?e.text(t.nodeValue):DS(e,t)}return e.close()}const IS={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},BS={blend:"mix-blend-mode"},LS={fill:"none","stroke-miterlimit":10},PS="http://www.w3.org/2000/xmlns/",$S=qw.xmlns;function zS(e){Hk.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const jS=Hk.prototype;function GS(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function US(e,t,n){let r,i,o;if("radial"===t.gradient){let r=zk(e,n++,"pattern",$S);JS(r,{id:zx+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=zk(r,0,"rect",$S),JS(r,{width:1,height:1,fill:`url(${QS()}#${t.id})`}),JS(e=zk(e,n++,"radialGradient",$S),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else JS(e=zk(e,n++,"linearGradient",$S),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=zk(e,r,"stop",$S),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return jk(e,r),n}function WS(e,t,n){let r;return(e=zk(e,n,"clipPath",$S)).setAttribute("id",t.id),t.path?(r=zk(e,0,"path",$S),r.setAttribute("d",t.path)):(r=zk(e,0,"rect",$S),JS(r,{x:0,y:0,width:t.width,height:t.height})),jk(e,1),n+1}function VS(e,t,n,r,i){let o,a=e._svg;if(!a&&(o=t.ownerDocument,a=Pk(o,r,$S),e._svg=a,e.mark&&(a.__data__=e,a.__values__={fill:"default"},"g"===r))){const t=Pk(o,"path",$S);a.appendChild(t),t.__data__=e;const n=Pk(o,"g",$S);a.appendChild(n),n.__data__=e;const r=Pk(o,"path",$S);a.appendChild(r),r.__data__=e,r.__values__={fill:"default"}}return(a.ownerSVGElement!==i||function(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(a,n))&&t.insertBefore(a,n?n.nextSibling:t.firstChild),a}jn(zS,Hk,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=zk(e,0,"svg",$S),this._svg.setAttributeNS(PS,"xmlns",$S),this._svg.setAttributeNS(PS,"xmlns:xlink",qw["xmlns:xlink"]),this._svg.setAttribute("version",qw.version),this._svg.setAttribute("class","marks"),jk(e,1),this._root=zk(this._svg,0,"g",$S),JS(this._root,LS),jk(this._svg,1)),this.background(this._bgcolor),jS.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),jS.background.apply(this,arguments)},resize(e,t,n,r){return jS.resize.call(this,e,t,n,r),this._svg&&(JS(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=zk(e,0,"rect",$S),JS(n,{width:this._width,height:this._height,fill:t}));const r=NS(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),jk(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,o,a,s,u;for(a=0,s=e.length;a<s;++a)n=e[a],r=n.mark,r.marktype!==i&&(i=r.marktype,o=Fk[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,GS(n,t),r.items.forEach((e=>{e.dirty=t}))),r.zdirty||(n.exit?(o.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(o,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null):(n=o.nested?r.items[0]:n,n._update!==t&&(n._svg&&n._svg.ownerSVGElement?this._update(o,n._svg,n):(this._dirtyAll=!1,GS(n,t)),n._update=t)));return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=Fk[t.marktype],o=!1===t.interactive?"none":null,a="g"===i.tag,s=VS(t,e,n,"g",r);s.setAttribute("class",Gk(t));const u=ES(t);for(const e in u)ZS(s,e,u[e]);a||ZS(s,"pointer-events",o),ZS(s,"clip-path",t.clip?D_(this,t,t.group):null);let l=null,c=0;const p=e=>{const t=this.isDirty(e),n=VS(e,s,l,i.tag,r);t&&(this._update(i,n,e),a&&function(e,t,n){t=t.lastChild.previousSibling;let r,i=0;Cw(n,(n=>{r=e.mark(t,n,r),++i})),jk(t,1+i)}(this,n,e)),l=n,++c};return i.nested?t.items.length&&p(t.items[0]):Cw(t,p),jk(s,c),s},_update(e,t,n){HS=t,qS=t.__values__,TS(YS,n),e.attr(YS,n,this);const r=XS[e.type];r&&r.call(this,e,t,n),HS&&this.style(HS,n)},style(e,t){if(null!=t){for(const n in IS){let r="font"===n?_k(t):t[n];if(r===qS[n])continue;const i=IS[n];null==r?e.removeAttribute(i):(jx(r)&&(r=Gx(r,this._defs.gradient,QS())),e.setAttribute(i,r+"")),qS[n]=r}for(const n in BS)KS(e,BS[n],t[n])}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=zk(e,1,"defs",$S)),r=US(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=zk(e,1,"defs",$S)),r=WS(n,t.clipping[i],r);n&&(0===r?(e.removeChild(n),t.el=null):jk(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});let HS=null,qS=null;const XS={group(e,t,n){const r=HS=t.childNodes[2];qS=r.__values__,e.foreground(YS,n,this),qS=t.__values__,HS=t.childNodes[1],e.content(YS,n,this);const i=HS=t.childNodes[0];e.background(YS,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==qS.events&&(ZS(r,"pointer-events",o),ZS(i,"pointer-events",o),qS.events=o),n.strokeForeground&&n.stroke){const e=n.fill;ZS(r,"display",null),this.style(i,n),ZS(i,"stroke",null),e&&(n.fill=null),qS=r.__values__,this.style(r,n),e&&(n.fill=e),HS=null}else ZS(r,"display","none")},image(e,t,n){!1===n.smooth?(KS(t,"image-rendering","optimizeSpeed"),KS(t,"image-rendering","pixelated")):KS(t,"image-rendering",null)},text(e,t,n){const r=bk(n);let i,o,a,s;sn(r)?(o=r.map((e=>xk(n,e))),i=o.join("\n"),i!==qS.text&&(jk(t,0),a=t.ownerDocument,s=yk(n),o.forEach(((e,r)=>{const i=Pk(a,"tspan",$S);i.__data__=n,i.textContent=e,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),t.appendChild(i)})),qS.text=i)):(o=xk(n,r),o!==qS.text&&(t.textContent=o,qS.text=o)),ZS(t,"font-family",_k(n)),ZS(t,"font-size",mk(n)+"px"),ZS(t,"font-style",n.fontStyle),ZS(t,"font-variant",n.fontVariant),ZS(t,"font-weight",n.fontWeight)}};function YS(e,t,n){t!==qS[e]&&(n?function(e,t,n,r){null!=n?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}(HS,e,t,n):ZS(HS,e,t),qS[e]=t)}function KS(e,t,n){n!==qS[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),qS[t]=n)}function JS(e,t){for(const n in t)ZS(e,n,t[n])}function ZS(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function QS(){let e;return"undefined"==typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function eC(e){Hk.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}jn(eC,Hk,{svg(){return this._text},_render(e){const t=RS();t.open("svg",In({},qw,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",LS,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Fk[t.marktype],r=n.tag,i=[TS,n.attr];e.open("g",{class:Gk(t),"clip-path":t.clip?D_(this,t,t.group):null},ES(t),{"pointer-events":"g"!==r&&!1===t.interactive?"none":null});const o=o=>{const a=this.href(o);if(a&&e.open("a",a),e.open(r,this.attr(t,o,i,"g"!==r?r:null)),"text"===r){const t=bk(o);if(sn(t)){const n={x:0,dy:yk(o)};for(let r=0;r<t.length;++r)e.open("tspan",r?n:null).text(xk(o,t[r])).close()}else e.text(xk(o,t))}else if("g"===r){const r=o.strokeForeground,i=o.fill,a=o.stroke;r&&a&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),Cw(o,(t=>this.mark(e,t))),e.close(),r&&a?(i&&(o.fill=null),o.stroke=a,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),i&&(o.fill=i)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):Cw(t,o),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then((e=>{e["xlink:href"]=e.href,e.href=null,(this._hrefs||(this._hrefs={}))[t]=e}))}return null},attr(e,t,n,r){const i={},o=(e,t,n,r)=>{i[r||e]=t};return Array.isArray(n)?n.forEach((e=>e(o,t,this))):n(o,t,this),r&&function(e,t,n,r,i){let o;if(null==t)return e;if("bgrect"===r&&!1===n.interactive&&(e["pointer-events"]="none"),"bgfore"===r&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill))return e;"image"===r&&!1===t.smooth&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),"text"===r&&(e["font-family"]=_k(t),e["font-size"]=mk(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const n in IS){let r=t[n];const o=IS[n];("transparent"!==r||"fill"!==o&&"stroke"!==o)&&null!=r&&(jx(r)&&(r=Gx(r,i.gradient,"")),e[o]=r)}for(const e in BS){const n=t[e];null!=n&&(o=o||[],o.push(`${BS[e]}: ${n};`))}o&&(e.style=o.join(" "))}(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(t).length+Object.keys(n).length){e.open("defs");for(const n in t){const r=t[n],i=r.stops;"radial"===r.gradient?(e.open("pattern",{id:zx+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),e.close(),e.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):e.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let t=0;t<i.length;++t)e.open("stop",{offset:i[t].offset,"stop-color":i[t].color}).close();e.close()}for(const t in n){const r=n[t];e.open("clipPath",{id:t}),r.path?e.open("path",{d:r.path}).close():e.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),e.close()}e.close()}}});const tC="canvas",nC="none",rC={Canvas:tC,PNG:"png",SVG:"svg",None:nC},iC={};function oC(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(iC[e]=t,this):iC[e]}function aC(e,t,n,r){if(function(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){const i=e.items,o=e.marktype,a=i.length;let s=0;if("group"===o)for(;s<a;++s)sC(i[s],t,n,r);else for(const e=Fk[o].isect;s<a;++s){const n=i[s];uC(n,t,e)&&r.push(n)}}return r}function sC(e,t,n,r){n&&n(e.mark)&&uC(e,t,Fk.group.isect)&&r.push(e);const i=e.items,o=i&&i.length;if(o){const a=e.x||0,s=e.y||0;t.translate(-a,-s);for(let e=0;e<o;++e)aC(i[e],t,n,r);t.translate(a,s)}return r}function uC(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}iC[tC]=iC.png={renderer:hS,headless:hS,handler:uS},iC.svg={renderer:zS,headless:eC,handler:gS},iC[nC]={};const lC=new I_,cC="top",pC="left",dC="right",hC="bottom",fC="start",gC="middle",mC="end",yC="x",bC="y",vC="group",xC="axis",_C="title",wC="legend",kC="row-header",SC="row-footer",CC="row-title",MC="column-header",TC="column-footer",EC="column-title",AC="fit-x",FC="fit-y",OC="none",RC="all",NC="each",DC="flush",IC="column",BC="row";function LC(e){Gu.call(this,null,e)}function PC(e,t,n){return t(e.bounds.clear(),e,n)}jn(LC,Gu,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,o=Fk[i],a=o.bound;let s,u=r.bounds;if(o.nested)r.items.length&&n.dirty(r.items[0]),u=PC(r,a),r.items.forEach((e=>{e.bounds.clear().union(u)}));else if(i===vC||e.modified())switch(t.visit(t.MOD,(e=>n.dirty(e))),u.clear(),r.items.forEach((e=>u.union(PC(e,a)))),r.role){case xC:case wC:case _C:t.reflow()}else s=t.changed(t.REM),t.visit(t.ADD,(e=>{u.union(PC(e,a))})),t.visit(t.MOD,(e=>{s=s||u.alignsWith(e.bounds),n.dirty(e),u.union(PC(e,a))})),s&&(u.clear(),r.items.forEach((e=>u.union(e.bounds))));return function(e){const t=e.clip;if(Mn(t))t(ow(lC.clear()));else{if(!t)return;lC.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(lC)}(r),t.modifies("bounds")}});const $C=":vega_identifier:";function zC(e){Gu.call(this,0,e)}function jC(e){Gu.call(this,null,e)}function GC(e){Gu.call(this,null,e)}zC.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},jn(zC,Gu,{transform(e,t){const n=(i=t.dataflow)._signals[$C]||(i._signals[$C]=i.add(0)),r=e.as;var i;let o=n.value;return t.visit(t.ADD,(e=>e[r]=e[r]||++o)),n.set(this.value=o),t}}),jn(jC,Gu,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,function(e){const t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===vC?L_:B_;return t.visit(t.ADD,(e=>r.call(e,n))),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});const UC={parity:e=>e.filter(((e,t)=>t%2?e.opacity=0:1)),greedy:(e,t)=>{let n;return e.filter(((e,r)=>r&&WC(n.bounds,e.bounds,t)?e.opacity=0:(n=e,1)))}},WC=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),VC=(e,t)=>{for(var n,r=1,i=e.length,o=e[0].bounds;r<i;o=n,++r)if(WC(o,n=e[r].bounds,t))return!0},HC=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},qC=e=>(e.forEach((e=>e.opacity=1)),e),XC=(e,t)=>e.reflow(t.modified()).modifies("opacity");function YC(e){Gu.call(this,null,e)}jn(GC,Gu,{transform(e,t){const n=UC[e.method]||UC.parity,r=e.separation||0;let i,o,a=t.materialize(t.SOURCE).source;if(!a||!a.length)return;if(!e.method)return e.modified("method")&&(qC(a),t=XC(t,e)),t;if(a=a.filter(HC),!a.length)return;if(e.sort&&(a=a.slice().sort(e.sort)),i=qC(a),t=XC(t,e),i.length>=3&&VC(i,r)){do{i=n(i,r)}while(i.length>=3&&VC(i,r));i.length<3&&!dn(a).opacity&&(i.length>1&&(dn(i).opacity=0),dn(a).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=((e,t,n)=>{var r=e.range(),i=new I_;return t===cC||t===hC?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),e=>i.encloses(e.bounds)})(e.boundScale,e.boundOrient,+e.boundTolerance),a.forEach((e=>{o(e)||(e.opacity=0)})));const s=i[0].mark.bounds.clear();return a.forEach((e=>{e.opacity&&s.union(e.bounds)})),t}}),jn(YC,Gu,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,(e=>n.dirty(e))),t.fields&&t.fields.zindex){const e=t.source&&t.source[0];e&&(e.mark.zdirty=!0)}}});const KC=new I_;function JC(e,t,n){return e[t]===n?0:(e[t]=n,1)}function ZC(e){var t=e.items[0].orient;return t===pC||t===dC}function QC(e,t,n,r){var i,o,a=t.items[0],s=a.datum,u=null!=a.translate?a.translate:.5,l=a.orient,c=function(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}(s),p=a.range,d=a.offset,h=a.position,f=a.minExtent,g=a.maxExtent,m=s.title&&a.items[c[2]].items[0],y=a.titlePadding,b=a.bounds,v=m&&vk(m),x=0,_=0;switch(KC.clear().union(b),b.clear(),(i=c[0])>-1&&b.union(a.items[i].bounds),(i=c[1])>-1&&b.union(a.items[i].bounds),l){case cC:x=h||0,_=-d,o=Math.max(f,Math.min(g,-b.y1)),b.add(0,-o).add(p,0),m&&eM(e,m,o,y,v,0,-1,b);break;case pC:x=-d,_=h||0,o=Math.max(f,Math.min(g,-b.x1)),b.add(-o,0).add(0,p),m&&eM(e,m,o,y,v,1,-1,b);break;case dC:x=n+d,_=h||0,o=Math.max(f,Math.min(g,b.x2)),b.add(0,0).add(o,p),m&&eM(e,m,o,y,v,1,1,b);break;case hC:x=h||0,_=r+d,o=Math.max(f,Math.min(g,b.y2)),b.add(0,0).add(p,o),m&&eM(e,m,o,y,0,0,1,b);break;default:x=a.x,_=a.y}return j_(b.translate(x,_),a),JC(a,"x",x+u)|JC(a,"y",_+u)&&(a.bounds=KC,e.dirty(a),a.bounds=b,e.dirty(a)),a.mark.bounds.clear().union(b)}function eM(e,t,n,r,i,o,a,s){const u=t.bounds;if(t.auto){const s=a*(n+i+r);let l=0,c=0;e.dirty(t),o?l=(t.x||0)-(t.x=s):c=(t.y||0)-(t.y=s),t.mark.bounds.clear().union(u.translate(-l,-c)),e.dirty(t)}s.union(u)}const tM=(e,t)=>Math.floor(Math.min(e,t)),nM=(e,t)=>Math.ceil(Math.max(e,t));function rM(e){return(new I_).set(0,0,e.width||0,e.height||0)}function iM(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function oM(e,t,n){const r=un(e)?e[t]:e;return null!=r?r:void 0!==n?n:0}function aM(e){return e<0?Math.ceil(-e):0}function sM(e,t,n){var r,i,o,a,s,u,l,c,p,d,h,f=!n.nodirty,g=n.bounds===DC?rM:iM,m=KC.set(0,0,0,0),y=oM(n.align,IC),b=oM(n.align,BC),v=oM(n.padding,IC),x=oM(n.padding,BC),_=n.columns||t.length,w=_<=0?1:Math.ceil(t.length/_),k=t.length,S=Array(k),C=Array(_),M=0,T=Array(k),E=Array(w),A=0,F=Array(k),O=Array(k),R=Array(k);for(i=0;i<_;++i)C[i]=0;for(i=0;i<w;++i)E[i]=0;for(i=0;i<k;++i)u=t[i],s=R[i]=g(u),u.x=u.x||0,F[i]=0,u.y=u.y||0,O[i]=0,o=i%_,a=~~(i/_),M=Math.max(M,l=Math.ceil(s.x2)),A=Math.max(A,c=Math.ceil(s.y2)),C[o]=Math.max(C[o],l),E[a]=Math.max(E[a],c),S[i]=v+aM(s.x1),T[i]=x+aM(s.y1),f&&e.dirty(t[i]);for(i=0;i<k;++i)i%_==0&&(S[i]=0),i<_&&(T[i]=0);if(y===NC)for(o=1;o<_;++o){for(h=0,i=o;i<k;i+=_)h<S[i]&&(h=S[i]);for(i=o;i<k;i+=_)S[i]=h+C[o-1]}else if(y===RC){for(h=0,i=0;i<k;++i)i%_&&h<S[i]&&(h=S[i]);for(i=0;i<k;++i)i%_&&(S[i]=h+M)}else for(y=!1,o=1;o<_;++o)for(i=o;i<k;i+=_)S[i]+=C[o-1];if(b===NC)for(a=1;a<w;++a){for(h=0,r=(i=a*_)+_;i<r;++i)h<T[i]&&(h=T[i]);for(i=a*_;i<r;++i)T[i]=h+E[a-1]}else if(b===RC){for(h=0,i=_;i<k;++i)h<T[i]&&(h=T[i]);for(i=_;i<k;++i)T[i]=h+A}else for(b=!1,a=1;a<w;++a)for(r=(i=a*_)+_;i<r;++i)T[i]+=E[a-1];for(p=0,i=0;i<k;++i)p=S[i]+(i%_?p:0),F[i]+=p-t[i].x;for(o=0;o<_;++o)for(d=0,i=o;i<k;i+=_)d+=T[i],O[i]+=d-t[i].y;if(y&&oM(n.center,IC)&&w>1)for(i=0;i<k;++i)(p=(s=y===RC?M:C[i%_])-R[i].x2-t[i].x-F[i])>0&&(F[i]+=p/2);if(b&&oM(n.center,BC)&&1!==_)for(i=0;i<k;++i)(d=(s=b===RC?A:E[~~(i/_)])-R[i].y2-t[i].y-O[i])>0&&(O[i]+=d/2);for(i=0;i<k;++i)m.union(R[i].translate(F[i],O[i]));switch(p=oM(n.anchor,yC),d=oM(n.anchor,bC),oM(n.anchor,IC)){case mC:p-=m.width();break;case gC:p-=m.width()/2}switch(oM(n.anchor,BC)){case mC:d-=m.height();break;case gC:d-=m.height()/2}for(p=Math.round(p),d=Math.round(d),m.clear(),i=0;i<k;++i)t[i].mark.bounds.clear();for(i=0;i<k;++i)(u=t[i]).x+=F[i]+=p,u.y+=O[i]+=d,m.union(u.mark.bounds.union(u.bounds.translate(F[i],O[i]))),f&&e.dirty(u);return m}function uM(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function lM(e,t){return e.bounds[t]}function cM(e,t,n,r,i,o,a,s,u,l,c,p,d,h){var f,g,m,y,b,v,x,_,w,k=n.length,S=0,C=0;if(!k)return S;for(f=c;f<k;f+=p)n[f]&&(S=a(S,u(n[f],l)));if(!t.length)return S;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),S+=o,g=0,y=t.length;g<y;++g)e.dirty(t[g]),t[g].mark.bounds.clear();for(f=c,g=0,y=t.length;g<y;++g,f+=p){for(b=(v=t[g]).mark.bounds,m=f;m>=0&&null==(x=n[m]);m-=d);s?(_=null==h?x.x:Math.round(x.bounds.x1+h*x.bounds.width()),w=S):(_=S,w=null==h?x.y:Math.round(x.bounds.y1+h*x.bounds.height())),b.union(v.bounds.translate(_-(v.x||0),w-(v.y||0))),v.x=_,v.y=w,e.dirty(v),C=a(C,b[l])}return C}function pM(e,t,n,r,i,o){if(t){e.dirty(t);var a=n,s=n;r?a=Math.round(i.x1+o*i.width()):s=Math.round(i.y1+o*i.height()),t.bounds.translate(a-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=a,t.y=s,e.dirty(t)}}function dM(e,t,n,r,i,o,a){const s=function(e,t){const n=e[t]||{};return(t,r)=>null!=n[t]?n[t]:null!=e[t]?e[t]:r}(n,t),u=function(e,t){let n=-1/0;return e.forEach((e=>{null!=e.offset&&(n=Math.max(n,e.offset))})),n>-1/0?n:t}(e,s("offset",0)),l=s("anchor",fC),c=l===mC?1:l===gC?.5:0,p={align:NC,bounds:s("bounds",DC),columns:"vertical"===s("direction")?1:e.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(t){case pC:p.anchor={x:Math.floor(r.x1)-u,column:mC,y:c*(a||r.height()+2*r.y1),row:l};break;case dC:p.anchor={x:Math.ceil(r.x2)+u,y:c*(a||r.height()+2*r.y1),row:l};break;case cC:p.anchor={y:Math.floor(i.y1)-u,row:mC,x:c*(o||i.width()+2*i.x1),column:l};break;case hC:p.anchor={y:Math.ceil(i.y2)+u,x:c*(o||i.width()+2*i.x1),column:l};break;case"top-left":p.anchor={x:u,y:u};break;case"top-right":p.anchor={x:o-u,y:u,column:mC};break;case"bottom-left":p.anchor={x:u,y:a-u,row:mC};break;case"bottom-right":p.anchor={x:o-u,y:a-u,column:mC,row:mC}}return p}function hM(e,t){var n,r,i=t.items[0],o=i.datum,a=i.orient,s=i.bounds,u=i.x,l=i.y;return i._bounds?i._bounds.clear().union(s):i._bounds=s.clone(),s.clear(),function(e,t,n){var r=t.padding,i=r-n.x,o=r-n.y;if(t.datum.title){var a=t.items[1].items[0],s=a.anchor,u=t.titlePadding||0,l=r-a.x,c=r-a.y;switch(a.orient){case pC:i+=Math.ceil(a.bounds.width())+u;break;case dC:case hC:break;default:o+=a.bounds.height()+u}switch((i||o)&&gM(e,n,i,o),a.orient){case pC:c+=fM(t,n,a,s,1,1);break;case dC:l+=fM(t,n,a,mC,0,0)+u,c+=fM(t,n,a,s,1,1);break;case hC:l+=fM(t,n,a,s,0,0),c+=fM(t,n,a,mC,-1,0,1)+u;break;default:l+=fM(t,n,a,s,0,0)}(l||c)&&gM(e,a,l,c),(l=Math.round(a.bounds.x1-r))<0&&(gM(e,n,-l,0),gM(e,a,-l,0))}else(i||o)&&gM(e,n,i,o)}(e,i,i.items[0].items[0]),s=function(e,t){return e.items.forEach((e=>t.union(e.bounds))),t.x1=e.padding,t.y1=e.padding,t}(i,s),n=2*i.padding,r=2*i.padding,s.empty()||(n=Math.ceil(s.width()+n),r=Math.ceil(s.height()+r)),"symbol"===o.type&&function(e){const t=e.reduce(((e,t)=>(e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0),e)),{});e.forEach((e=>{e.width=t[e.column],e.height=e.bounds.y2-e.y}))}(i.items[0].items[0].items[0].items),a!==OC&&(i.x=u=0,i.y=l=0),i.width=n,i.height=r,j_(s.set(u,l,u+n,l+r),i),i.mark.bounds.clear().union(s),i}function fM(e,t,n,r,i,o,a){const s="symbol"!==e.datum.type,u=n.datum.vgrad,l=(!s||!o&&u||a?t:t.items[0]).bounds[i?"y2":"x2"]-e.padding,c=u&&o?l:0,p=u&&o?0:l,d=i<=0?0:vk(n);return Math.round(r===fC?c:r===mC?p-d:.5*(l-d))}function gM(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function mM(e){Gu.call(this,null,e)}function yM(e,t){let n=0;if(void 0===t)for(let t of e)(t=+t)&&(n+=t);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function bM(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function vM(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function xM(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function _M(){}jn(mM,Gu,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach((t=>{e.layout&&function(e,t,n){var r,i,o,a,s,u,l,c=function(e){var t,n,r=e.items,i=r.length,o=0;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;o<i;++o)if(n=(t=r[o]).items,t.marktype===vC)switch(t.role){case xC:case wC:case _C:break;case kC:a.rowheaders.push(...n);break;case SC:a.rowfooters.push(...n);break;case MC:a.colheaders.push(...n);break;case TC:a.colfooters.push(...n);break;case CC:a.rowtitle=n[0];break;case EC:a.coltitle=n[0];break;default:a.marks.push(...n)}return a}(t),p=c.marks,d=n.bounds===DC?uM:lM,h=n.offset,f=n.columns||p.length,g=f<=0?1:Math.ceil(p.length/f),m=g*f;const y=sM(e,p,n);y.empty()&&y.set(0,0,0,0),c.rowheaders&&(u=oM(n.headerBand,BC,null),r=cM(e,c.rowheaders,p,0,g,-oM(h,"rowHeader"),tM,0,d,"x1",0,f,1,u)),c.colheaders&&(u=oM(n.headerBand,IC,null),i=cM(e,c.colheaders,p,0,f,-oM(h,"columnHeader"),tM,1,d,"y1",0,1,f,u)),c.rowfooters&&(u=oM(n.footerBand,BC,null),o=cM(e,c.rowfooters,p,0,g,oM(h,"rowFooter"),nM,0,d,"x2",f-1,f,1,u)),c.colfooters&&(u=oM(n.footerBand,IC,null),a=cM(e,c.colfooters,p,0,f,oM(h,"columnFooter"),nM,1,d,"y2",m-f,1,f,u)),c.rowtitle&&(s=oM(n.titleAnchor,BC),l=oM(h,"rowTitle"),l=s===mC?o+l:r-l,u=oM(n.titleBand,BC,.5),pM(e,c.rowtitle,l,0,y,u)),c.coltitle&&(s=oM(n.titleAnchor,IC),l=oM(h,"columnTitle"),l=s===mC?a+l:i-l,u=oM(n.titleBand,IC,.5),pM(e,c.coltitle,l,1,y,u))}(n,t,e.layout),function(e,t,n){var r,i,o,a,s,u=t.items,l=Math.max(0,t.width||0),c=Math.max(0,t.height||0),p=(new I_).set(0,0,l,c),d=p.clone(),h=p.clone(),f=[];for(a=0,s=u.length;a<s;++a)switch((i=u[a]).role){case xC:(ZC(i)?d:h).union(QC(e,i,l,c));break;case _C:r=i;break;case wC:f.push(hM(e,i));break;case"frame":case"scope":case kC:case SC:case CC:case MC:case TC:case EC:d.union(i.bounds),h.union(i.bounds);break;default:p.union(i.bounds)}if(f.length){const t={};f.forEach((e=>{(o=e.orient||dC)!==OC&&(t[o]||(t[o]=[])).push(e)}));for(const r in t){const i=t[r];sM(e,i,dM(i,r,n.legends,d,h,l,c))}f.forEach((t=>{const r=t.bounds;if(r.equals(t._bounds)||(t.bounds=t._bounds,e.dirty(t),t.bounds=r,e.dirty(t)),!n.autosize||"fit"!==n.autosize.type&&n.autosize.type!==AC&&n.autosize.type!==FC)p.union(r);else switch(t.orient){case pC:case dC:p.add(r.x1,0).add(r.x2,0);break;case cC:case hC:p.add(0,r.y1).add(0,r.y2)}}))}p.union(d).union(h),r&&p.union(function(e,t,n,r,i){var o,a=t.items[0],s=a.frame,u=a.orient,l=a.anchor,c=a.offset,p=a.padding,d=a.items[0].items[0],h=a.items[1]&&a.items[1].items[0],f=u===pC||u===dC?r:n,g=0,m=0,y=0,b=0,v=0;if(s!==vC?u===pC?(g=i.y2,f=i.y1):u===dC?(g=i.y1,f=i.y2):(g=i.x1,f=i.x2):u===pC&&(g=r,f=0),o=l===fC?g:l===mC?f:(g+f)/2,h&&h.text){switch(u){case cC:case hC:v=d.bounds.height()+p;break;case pC:b=d.bounds.width()+p;break;case dC:b=-d.bounds.width()-p}KC.clear().union(h.bounds),KC.translate(b-(h.x||0),v-(h.y||0)),JC(h,"x",b)|JC(h,"y",v)&&(e.dirty(h),h.bounds.clear().union(KC),h.mark.bounds.clear().union(KC),e.dirty(h)),KC.clear().union(h.bounds)}else KC.clear();switch(KC.union(d.bounds),u){case cC:m=o,y=i.y1-KC.height()-c;break;case pC:m=i.x1-KC.width()-c,y=o;break;case dC:m=i.x2+KC.width()+c,y=o;break;case hC:m=o,y=i.y2+c;break;default:m=a.x,y=a.y}return JC(a,"x",m)|JC(a,"y",y)&&(KC.translate(m,y),e.dirty(a),a.bounds.clear().union(KC),t.bounds.clear().union(KC),e.dirty(a)),a.bounds}(e,r,l,c,p)),t.clip&&p.set(0,0,t.width||0,t.height||0),function(e,t,n,r){const i=r.autosize||{},o=i.type;if(e._autosize<1||!o)return;let a=e._width,s=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),p=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if("padding"===i.contains){const t=e.padding();a-=t.left+t.right,s-=t.top+t.bottom}o===OC?(l=0,p=0,u=a,c=s):"fit"===o?(u=Math.max(0,a-l-d),c=Math.max(0,s-p-h)):o===AC?(u=Math.max(0,a-l-d),s=c+p+h):o===FC?(a=u+l+d,c=Math.max(0,s-p-h)):"pad"===o&&(a=u+l+d,s=c+p+h),e._resizeView(a,s,u,c,[l,p],i.resize)}(e,t,p,n)}(n,t,e)})),function(e){return e&&"legend-entry"!==e.mark.role}(e.mark.group)?t.reflow():t}});var wM=.7,kM=1.4285714285714286,SM="\\s*([+-]?\\d+)\\s*",CM="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",MM="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",TM=/^#([0-9a-f]{3,8})$/,EM=new RegExp("^rgb\\("+[SM,SM,SM]+"\\)$"),AM=new RegExp("^rgb\\("+[MM,MM,MM]+"\\)$"),FM=new RegExp("^rgba\\("+[SM,SM,SM,CM]+"\\)$"),OM=new RegExp("^rgba\\("+[MM,MM,MM,CM]+"\\)$"),RM=new RegExp("^hsl\\("+[CM,MM,MM]+"\\)$"),NM=new RegExp("^hsla\\("+[CM,MM,MM,CM]+"\\)$"),DM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function IM(){return this.rgb().formatHex()}function BM(){return this.rgb().formatRgb()}function LM(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=TM.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?PM(t):3===n?new GM(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?$M(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?$M(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=EM.exec(e))?new GM(t[1],t[2],t[3],1):(t=AM.exec(e))?new GM(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=FM.exec(e))?$M(t[1],t[2],t[3],t[4]):(t=OM.exec(e))?$M(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=RM.exec(e))?HM(t[1],t[2]/100,t[3]/100,1):(t=NM.exec(e))?HM(t[1],t[2]/100,t[3]/100,t[4]):DM.hasOwnProperty(e)?PM(DM[e]):"transparent"===e?new GM(NaN,NaN,NaN,0):null}function PM(e){return new GM(e>>16&255,e>>8&255,255&e,1)}function $M(e,t,n,r){return r<=0&&(e=t=n=NaN),new GM(e,t,n,r)}function zM(e){return e instanceof _M||(e=LM(e)),e?new GM((e=e.rgb()).r,e.g,e.b,e.opacity):new GM}function jM(e,t,n,r){return 1===arguments.length?zM(e):new GM(e,t,n,null==r?1:r)}function GM(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function UM(){return"#"+VM(this.r)+VM(this.g)+VM(this.b)}function WM(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function VM(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function HM(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new YM(e,t,n,r)}function qM(e){if(e instanceof YM)return new YM(e.h,e.s,e.l,e.opacity);if(e instanceof _M||(e=LM(e)),!e)return new YM;if(e instanceof YM)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new YM(a,s,u,e.opacity)}function XM(e,t,n,r){return 1===arguments.length?qM(e):new YM(e,t,n,null==r?1:r)}function YM(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function KM(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function JM(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}function ZM(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return JM((n-r/t)*t,a,i,o,s)}}function QM(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return JM((n-r/t)*t,i,o,a,s)}}vM(_M,LM,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:IM,formatHex:IM,formatHsl:function(){return qM(this).formatHsl()},formatRgb:BM,toString:BM}),vM(GM,jM,xM(_M,{brighter:function(e){return e=null==e?kM:Math.pow(kM,e),new GM(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?wM:Math.pow(wM,e),new GM(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:UM,formatHex:UM,formatRgb:WM,toString:WM})),vM(YM,XM,xM(_M,{brighter:function(e){return e=null==e?kM:Math.pow(kM,e),new YM(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?wM:Math.pow(wM,e),new YM(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new GM(KM(e>=240?e-240:e+120,i,r),KM(e,i,r),KM(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const eT=e=>()=>e;function tT(e,t){return function(n){return e+n*t}}function nT(e,t){var n=t-e;return n?tT(e,n>180||n<-180?n-360*Math.round(n/360):n):eT(isNaN(e)?t:e)}function rT(e,t){var n=t-e;return n?tT(e,n):eT(isNaN(e)?t:e)}const iT=function e(t){var n=function(e){return 1==(e=+e)?rT:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):eT(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=jM(e)).r,(t=jM(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=rT(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function oT(e){return function(t){var n,r,i=t.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=jM(t[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=e(o),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=s(e),r+""}}}var aT=oT(ZM),sT=oT(QM);function uT(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function lT(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function cT(e,t){return(lT(t)?uT:pT)(e,t)}function pT(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=bT(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}}function dT(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function hT(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function fT(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=bT(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}var gT=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,mT=new RegExp(gT.source,"g");function yT(e,t){var n,r,i,o=gT.lastIndex=mT.lastIndex=0,a=-1,s=[],u=[];for(e+="",t+="";(n=gT.exec(e))&&(r=mT.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:hT(n,r)})),o=mT.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})}function bT(e,t){var n,r=typeof t;return null==t||"boolean"===r?eT(t):("number"===r?hT:"string"===r?(n=LM(t))?(t=n,iT):yT:t instanceof LM?iT:t instanceof Date?dT:lT(t)?uT:Array.isArray(t)?pT:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?fT:hT)(e,t)}function vT(e){Gu.call(this,null,e)}function xT(e){Gu.call(this,null,e)}function _T(){return du({})}function wT(e){Gu.call(this,null,e)}function kT(e){Gu.call(this,[],e)}jn(vT,Gu,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.scale,a=kx(o,null==e.count?e.values?e.values.length:10:e.count,e.minstep),s=e.format||Mx(n,o,a,e.formatSpecifier,e.formatType,!!e.values),u=e.values?Sx(o,e.values,a):Cx(o,a);return i&&(r.rem=i),i=u.map(((e,t)=>du({index:t/(u.length-1||1),value:e,label:s(e)}))),e.extra&&i.length&&i.push(du({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}}),jn(xT,Gu,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||_T,o=e.key||cu,a=this.value;return sn(r.encode)&&(r.encode=null),a&&(e.modified("key")||t.modified(o))&&Vt("DataJoin does not support modified key function or fields."),a||(t=t.addAll(),this.value=a=function(e){const t=zn().test((e=>e.exit));return t.lookup=n=>t.get(e(n)),t}(o)),t.visit(t.ADD,(e=>{const t=o(e);let n=a.get(t);n?n.exit?(a.empty--,r.add.push(n)):r.mod.push(n):(n=i(e),a.set(t,n),r.add.push(n)),n.datum=e,n.exit=!1})),t.visit(t.MOD,(e=>{const t=o(e),n=a.get(t);n&&(n.datum=e,r.mod.push(n))})),t.visit(t.REM,(e=>{const t=o(e),n=a.get(t);e!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++a.empty)})),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),r}}),jn(wT,Gu,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,o=t.encode;if(sn(o)){if(!n.changed()&&!o.every((e=>i[e])))return t.StopPropagation;o=o[0],n.encode=null}var a="enter"===o,s=i.update||Qt,u=i.enter||Qt,l=i.exit||Qt,c=(o&&!a?i[o]:s)||Qt;if(t.changed(t.ADD)&&(t.visit(t.ADD,(t=>{u(t,e),s(t,e)})),n.modifies(u.output),n.modifies(s.output),c!==Qt&&c!==s&&(t.visit(t.ADD,(t=>{c(t,e)})),n.modifies(c.output))),t.changed(t.REM)&&l!==Qt&&(t.visit(t.REM,(t=>{l(t,e)})),n.modifies(l.output)),a||c!==Qt){const i=t.MOD|(e.modified()?t.REFLOW:0);a?(t.visit(i,(t=>{const i=u(t,e)||r;(c(t,e)||i)&&n.mod.push(t)})),n.mod.length&&n.modifies(u.output)):t.visit(i,(t=>{(c(t,e)||r)&&n.mod.push(t)})),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}}),jn(kT,Gu,{transform(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var n,r,i,o,a,s=t.dataflow.locale(),u=t.fork(t.NO_SOURCE|t.NO_FIELDS),l=this.value,c=e.type||bx,p=e.scale,d=+e.limit,h=kx(p,null==e.count?5:e.count,e.minstep),f=!!e.values||c===bx,g=e.format||Rx(s,p,h,c,e.formatSpecifier,e.formatType,f),m=e.values||Fx(p,h);return l&&(u.rem=l),c===bx?(d&&m.length>d?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),l=m.slice(0,d-1),a=!0):l=m,Mn(i=e.size)?(e.values||0!==p(l[0])||(l=l.slice(1)),o=l.reduce(((t,n)=>Math.max(t,i(n,e))),0)):i=Nn(o=i||8),l=l.map(((t,n)=>du({index:n,label:g(t,n,l),value:t,offset:o,size:i(t,e)}))),a&&(a=m[l.length],l.push(du({index:l.length,label:"".concat(m.length-l.length," entries"),value:a,offset:o,size:i(a,e)})))):"gradient"===c?(n=p.domain(),r=dx(p,n[0],dn(n)),m.length<3&&!e.values&&n[0]!==dn(n)&&(m=[n[0],dn(n)]),l=m.map(((e,t)=>du({index:t,label:g(e,t,m),value:e,perc:r(e)})))):(i=m.length-1,r=function(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+dn(t),o=i-r;if(e.type===Pv){const e=n?o/n:.1;r-=e,i+=e,o=i-r}return e=>(e-r)/o}(p),l=m.map(((e,t)=>du({index:t,label:g(e,t,m),value:e,perc:t?r(e):0,perc2:t===i?1:r(m[t+1])})))),u.source=l,u.add=l,this.value=l,u}});const ST=e=>e.source.x,CT=e=>e.source.y,MT=e=>e.target.x,TT=e=>e.target.y;function ET(e){Gu.call(this,{},e)}ET.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},jn(ET,Gu,{transform(e,t){var n=e.sourceX||ST,r=e.sourceY||CT,i=e.targetX||MT,o=e.targetY||TT,a=e.as||"path",s=e.orient||"vertical",u=e.shape||"line",l=RT.get(u+"-"+s)||RT.get(u);return l||Vt("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,(e=>{e[a]=l(n(e),r(e),i(e),o(e))})),t.reflow(e.modified()).modifies(a)}});const AT=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,FT=(e,t,n,r)=>{var i=n-e,o=r-t,a=Math.sqrt(i*i+o*o)/2;return"M"+e+","+t+"A"+a+","+a+" "+180*Math.atan2(o,i)/Math.PI+" 0 1 "+n+","+r},OT=(e,t,n,r)=>{const i=n-e,o=r-t,a=.2*(i+o),s=.2*(o-i);return"M"+e+","+t+"C"+(e+a)+","+(t+s)+" "+(n+s)+","+(r-a)+" "+n+","+r},RT=zn({line:AT,"line-radial":(e,t,n,r)=>AT(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),arc:FT,"arc-radial":(e,t,n,r)=>FT(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),curve:OT,"curve-radial":(e,t,n,r)=>OT(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),"orthogonal-horizontal":(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,"orthogonal-vertical":(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,"orthogonal-radial":(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n);return"M"+t*i+","+t*o+"A"+t+","+t+" 0 0,"+((Math.abs(n-e)>Math.PI?n<=e:n>e)?1:0)+" "+t*a+","+t*s+"L"+r*a+","+r*s},"diagonal-horizontal":(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},"diagonal-vertical":(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*o+"C"+u*i+","+u*o+" "+u*a+","+u*s+" "+r*a+","+r*s}});function NT(e){Gu.call(this,null,e)}NT.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},jn(NT,Gu,{transform(e,t){var n,r,i,o=e.as||["startAngle","endAngle"],a=o[0],s=o[1],u=e.field||Jt,l=e.startAngle||0,c=null!=e.endAngle?e.endAngle:2*Math.PI,p=t.source,d=p.map(u),h=d.length,f=l,g=(c-l)/yM(d),m=Vl(h);for(e.sort&&m.sort(((e,t)=>d[e]-d[t])),n=0;n<h;++n)i=d[m[n]],(r=p[m[n]])[a]=f,r[s]=f+=i*g;return this.value=d,t.reflow(e.modified()).modifies(o)}});function DT(e){return ix(e)&&e!==Dv}const IT=er(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function BT(e){Gu.call(this,null,e),this.modified(!0)}function LT(e,t,n){return sx(e)&&Math.abs(t.reduce(((e,t)=>e+(t<0?-1:t>0?1:0)),0))!==t.length&&n.warn("Log scale domain includes zero: "+Yn(t)),t}function PT(e,t,n){return Mn(e)&&(t||n)?function(e,t){const n=t[0],r=dn(t)-n;return function(t){return e(n+t*r)}}(e,$T(t||[0,1],n)):e}function $T(e,t){return t?e.slice().reverse():e}function zT(e){Gu.call(this,null,e)}jn(BT,Gu,{transform(e,t){var n=t.dataflow,r=this.value,i=function(e){var t,n=e.type,r="";return n===Dv?Dv+"-"+Tv:(function(e){const t=e.type;return ix(t)&&t!==Rv&&t!==Nv&&(e.scheme||e.range&&e.range.length&&e.range.every(Vn))}(e)&&(r=2===(t=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0)?Dv+"-":3===t?Iv+"-":""),(r+n||Tv).toLowerCase())}(e);for(i in r&&i===r.type||(this.value=r=tx(i)()),e)if(!IT[i]){if("padding"===i&&DT(r.type))continue;Mn(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return function(e,t,n){var r=e.type,i=t.round||!1,o=t.range;if(null!=t.rangeStep)o=function(e,t,n){e!==jv&&e!==zv&&Vt("Only band and point scales support rangeStep.");var r=(null!=t.paddingOuter?t.paddingOuter:t.padding)||0,i=e===zv?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0;return[0,t.rangeStep*Mv(n,i,r)]}(r,t,n);else if(t.scheme&&(o=function(e,t,n){var r,i=t.schemeExtent;return sn(t.scheme)?r=px(t.scheme,t.interpolate,t.interpolateGamma):(r=yx(t.scheme.toLowerCase()))||Vt("Unrecognized scheme name: ".concat(t.scheme)),n=e===Pv?n+1:e===Gv?n-1:e===Bv||e===Lv?+t.schemeCount||5:n,ux(e)?PT(r,i,t.reverse):Mn(r)?function(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}(PT(r,i),n):e===$v?r:r.slice(0,n)}(r,t,n),Mn(o))){if(e.interpolator)return e.interpolator(o);Vt("Scale type ".concat(r," does not support interpolating color schemes."))}if(o&&ux(r))return e.interpolator(px($T(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(hx(t.interpolate,t.interpolateGamma)):Mn(e.round)?e.round(i):Mn(e.rangeRound)&&e.interpolate(i?bM:bT),o&&e.range($T(o,t.reverse))}(r,e,function(e,t,n){let r=t.bins;if(r&&!sn(r)){const t=e.domain(),n=t[0],i=dn(t),o=r.step;let a=null==r.start?n:r.start,s=null==r.stop?i:r.stop;o||Vt("Scale bins parameter missing step property."),a<n&&(a=o*Math.ceil(n/o)),s>i&&(s=o*Math.floor(i/o)),r=Vl(a,s+o/2,o)}return r?e.bins=r:e.bins&&delete e.bins,e.type===Gv&&(r?t.domain||t.domainRaw||(e.domain(r),n=r.length):e.bins=e.domain()),n}(r,e,function(e,t,n){const r=function(e,t,n){return t?(e.domain(LT(e.type,t,n)),t.length):-1}(e,t.domainRaw,n);if(r>-1)return r;var i,o,a=t.domain,s=e.type,u=t.zero||void 0===t.zero&&function(e){const t=e.type;return!e.bins&&(t===Tv||t===Av||t===Fv)}(e);if(!a)return 0;if(DT(s)&&t.padding&&a[0]!==dn(a)&&(a=function(e,t,n,r,i,o){var a=Math.abs(dn(n)-n[0]),s=a/(a-2*r),u=e===Ev?wn(t,null,s):e===Fv?kn(t,null,s,.5):e===Av?kn(t,null,s,i||1):e===Ov?Sn(t,null,s,o||1):_n(t,null,s);return(t=t.slice())[0]=u[0],t[t.length-1]=u[1],t}(s,a,t.range,t.padding,t.exponent,t.constant)),(u||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(i=(a=a.slice()).length-1||1,u&&(a[0]>0&&(a[0]=0),a[i]<0&&(a[i]=0)),null!=t.domainMin&&(a[0]=t.domainMin),null!=t.domainMax&&(a[i]=t.domainMax),null!=t.domainMid)){const e=(o=t.domainMid)>a[i]?i+1:o<a[0]?0:i;e!==i&&n.warn("Scale domainMid exceeds domain min or max.",o),a.splice(e,0,o)}return e.domain(LT(s,a,n)),s===$v&&e.unknown(t.domainImplicit?_y:void 0),t.nice&&e.nice&&e.nice(!0!==t.nice&&kx(e,t.nice)||null),a.length}(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),jn(zT,Gu,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(mu(e.sort)),this.modified(n),t}});const jT="zero",GT="center",UT="normalize",WT=["y0","y1"];function VT(e){Gu.call(this,null,e)}function HT(e,t,n,r,i){for(var o,a=(t-e.sum)/2,s=e.length,u=0;u<s;++u)(o=e[u])[r]=a,o[i]=a+=Math.abs(n(o))}function qT(e,t,n,r,i){for(var o,a=1/e.sum,s=0,u=e.length,l=0,c=0;l<u;++l)(o=e[l])[r]=s,o[i]=s=a*(c+=Math.abs(n(o)))}function XT(e,t,n,r,i){for(var o,a,s=0,u=0,l=e.length,c=0;c<l;++c)(o=+n(a=e[c]))<0?(a[r]=u,a[i]=u+=o):(a[r]=s,a[i]=s+=o)}VT.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:jT,values:[jT,GT,UT]},{name:"as",type:"string",array:!0,length:2,default:WT}]},jn(VT,Gu,{transform(e,t){var n,r,i,o,a=e.as||WT,s=a[0],u=a[1],l=mu(e.sort),c=e.field||Jt,p=e.offset===GT?HT:e.offset===UT?qT:XT;for(n=function(e,t,n,r){var i,o,a,s,u,l,c,p,d,h=[],f=e=>e(u);if(null==t)h.push(e.slice());else for(i={},o=0,a=e.length;o<a;++o)u=e[o],(c=i[l=t.map(f)])||(i[l]=c=[],h.push(c)),c.push(u);for(l=0,d=0,s=h.length;l<s;++l){for(o=0,p=0,a=(c=h[l]).length;o<a;++o)p+=Math.abs(r(c[o]));c.sum=p,p>d&&(d=p),n&&c.sort(n)}return h.max=d,h}(t.source,e.groupby,l,c),r=0,i=n.length,o=n.max;r<i;++r)p(n[r],o,c,s,u);return t.reflow(e.modified()).modifies(a)}});var YT=Math.sqrt(50),KT=Math.sqrt(10),JT=Math.sqrt(2);function ZT(e,t,n){var r,i,o,a,s=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),0===(a=QT(e,t,n))||!isFinite(a))return[];if(a>0){let n=Math.round(e/a),r=Math.round(t/a);for(n*a<e&&++n,r*a>t&&--r,o=new Array(i=r-n+1);++s<i;)o[s]=(n+s)*a}else{a=-a;let n=Math.round(e*a),r=Math.round(t*a);for(n/a<e&&++n,r/a>t&&--r,o=new Array(i=r-n+1);++s<i;)o[s]=(n+s)/a}return r&&o.reverse(),o}function QT(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=YT?10:o>=KT?5:o>=JT?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=YT?10:o>=KT?5:o>=JT?2:1)}function eE(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=YT?i*=10:o>=KT?i*=5:o>=JT&&(i*=2),t<e?-i:i}const tE=e=>e;function nE(e,t){e&&iE.hasOwnProperty(e.type)&&iE[e.type](e,t)}var rE={Feature:function(e,t){nE(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)nE(n[r].geometry,t)}},iE={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){oE(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)oE(n[r],t,0)},Polygon:function(e,t){aE(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)aE(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)nE(n[r],t)}};function oE(e,t,n){var r,i=-1,o=e.length-n;for(t.lineStart();++i<o;)r=e[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function aE(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)oE(e[n],t,1);t.polygonEnd()}function sE(e,t){e&&rE.hasOwnProperty(e.type)?rE[e.type](e,t):nE(e,t)}class uE{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=t[r],o=e+i,a=Math.abs(e)<Math.abs(i)?e-(o-i):i-(o-e);a&&(t[n++]=a),e=o}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,r,i=this._n,o=0;if(i>0){for(o=e[--i];i>0&&(t=o,n=e[--i],o=t+n,r=n-(o-t),!r););i>0&&(r<0&&e[i-1]<0||r>0&&e[i-1]>0)&&(n=2*r,t=o+n,n==t-o&&(o=t))}return o}}var lE=1e-6,cE=1e-12,pE=Math.PI,dE=pE/2,hE=pE/4,fE=2*pE,gE=180/pE,mE=pE/180,yE=Math.abs,bE=Math.atan,vE=Math.atan2,xE=Math.cos,_E=(Math.ceil,Math.exp),wE=(Math.floor,Math.hypot,Math.log),kE=Math.pow,SE=Math.sin,CE=Math.sign||function(e){return e>0?1:e<0?-1:0},ME=Math.sqrt,TE=Math.tan;function EE(e){return e>1?0:e<-1?pE:Math.acos(e)}function AE(e){return e>1?dE:e<-1?-dE:Math.asin(e)}function FE(){}var OE,RE,NE,DE,IE=new uE,BE=new uE,LE={point:FE,lineStart:FE,lineEnd:FE,polygonStart:function(){LE.lineStart=PE,LE.lineEnd=jE},polygonEnd:function(){LE.lineStart=LE.lineEnd=LE.point=FE,IE.add(yE(BE)),BE=new uE},result:function(){var e=IE/2;return IE=new uE,e}};function PE(){LE.point=$E}function $E(e,t){LE.point=zE,OE=NE=e,RE=DE=t}function zE(e,t){BE.add(DE*e-NE*t),NE=e,DE=t}function jE(){zE(OE,RE)}const GE=LE;var UE=1/0,WE=UE,VE=-UE,HE=VE,qE={point:function(e,t){e<UE&&(UE=e),e>VE&&(VE=e),t<WE&&(WE=t),t>HE&&(HE=t)},lineStart:FE,lineEnd:FE,polygonStart:FE,polygonEnd:FE,result:function(){var e=[[UE,WE],[VE,HE]];return VE=HE=-(WE=UE=1/0),e}};const XE=qE;var YE,KE,JE,ZE,QE=0,eA=0,tA=0,nA=0,rA=0,iA=0,oA=0,aA=0,sA=0,uA={point:lA,lineStart:cA,lineEnd:hA,polygonStart:function(){uA.lineStart=fA,uA.lineEnd=gA},polygonEnd:function(){uA.point=lA,uA.lineStart=cA,uA.lineEnd=hA},result:function(){var e=sA?[oA/sA,aA/sA]:iA?[nA/iA,rA/iA]:tA?[QE/tA,eA/tA]:[NaN,NaN];return QE=eA=tA=nA=rA=iA=oA=aA=sA=0,e}};function lA(e,t){QE+=e,eA+=t,++tA}function cA(){uA.point=pA}function pA(e,t){uA.point=dA,lA(JE=e,ZE=t)}function dA(e,t){var n=e-JE,r=t-ZE,i=ME(n*n+r*r);nA+=i*(JE+e)/2,rA+=i*(ZE+t)/2,iA+=i,lA(JE=e,ZE=t)}function hA(){uA.point=lA}function fA(){uA.point=mA}function gA(){yA(YE,KE)}function mA(e,t){uA.point=yA,lA(YE=JE=e,KE=ZE=t)}function yA(e,t){var n=e-JE,r=t-ZE,i=ME(n*n+r*r);nA+=i*(JE+e)/2,rA+=i*(ZE+t)/2,iA+=i,oA+=(i=ZE*e-JE*t)*(JE+e),aA+=i*(ZE+t),sA+=3*i,lA(JE=e,ZE=t)}const bA=uA;function vA(e){this._context=e}vA.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,fE)}},result:FE};var xA,_A,wA,kA,SA,CA=new uE,MA={point:FE,lineStart:function(){MA.point=TA},lineEnd:function(){xA&&EA(_A,wA),MA.point=FE},polygonStart:function(){xA=!0},polygonEnd:function(){xA=null},result:function(){var e=+CA;return CA=new uE,e}};function TA(e,t){MA.point=EA,_A=kA=e,wA=SA=t}function EA(e,t){kA-=e,SA-=t,CA.add(ME(kA*kA+SA*SA)),kA=e,SA=t}const AA=MA;let FA,OA,RA,NA;class DA{constructor(e){this._append=null==e?IA:function(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return IA;if(t!==FA){const e=10**t;FA=t,OA=function(t){let n=1;this._+=t[0];for(const r=t.length;n<r;++n)this._+=Math.round(arguments[n]*e)/e+t[n]}}return OA}(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(e,t){switch(this._point){case 0:this._append`M${e},${t}`,this._point=1;break;case 1:this._append`L${e},${t}`;break;default:if(this._append`M${e},${t}`,this._radius!==RA||this._append!==OA){const e=this._radius,t=this._;this._="",this._append`m0,${e}a${e},${e} 0 1,1 0,${-2*e}a${e},${e} 0 1,1 0,${2*e}z`,RA=e,OA=this._append,NA=this._,this._=t}this._+=NA}}result(){const e=this._;return this._="",e.length?e:null}}function IA(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function BA(e,t){let n,r,i=3,o=4.5;function a(e){return e&&("function"==typeof o&&r.pointRadius(+o.apply(this,arguments)),sE(e,n(r))),r.result()}return a.area=function(e){return sE(e,n(GE)),GE.result()},a.measure=function(e){return sE(e,n(AA)),AA.result()},a.bounds=function(e){return sE(e,n(XE)),XE.result()},a.centroid=function(e){return sE(e,n(bA)),bA.result()},a.projection=function(t){return arguments.length?(n=null==t?(e=null,tE):(e=t).stream,a):e},a.context=function(e){return arguments.length?(r=null==e?(t=null,new DA(i)):new vA(t=e),"function"!=typeof o&&r.pointRadius(o),a):t},a.pointRadius=function(e){return arguments.length?(o="function"==typeof e?e:(r.pointRadius(+e),+e),a):o},a.digits=function(e){if(!arguments.length)return i;if(null==e)i=null;else{const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);i=t}return null===t&&(r=new DA(i)),a},a.projection(e).digits(i).context(t)}function LA(){var e,t=[];return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){t.push(e=[])},lineEnd:FE,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function PA(e,t){return yE(e[0]-t[0])<lE&&yE(e[1]-t[1])<lE}function $A(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function zA(e,t,n,r,i){var o,a,s=[],u=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],a=e[t];if(PA(r,a)){if(!r[2]&&!a[2]){for(i.lineStart(),o=0;o<t;++o)i.point((r=e[o])[0],r[1]);return void i.lineEnd()}a[0]+=2*lE}s.push(n=new $A(r,e,null,!0)),u.push(n.o=new $A(r,null,n,!1)),s.push(n=new $A(a,e,null,!1)),u.push(n.o=new $A(a,null,n,!0))}})),s.length){for(u.sort(t),jA(s),jA(u),o=0,a=u.length;o<a;++o)u[o].e=n=!n;for(var l,c,p=s[0];;){for(var d=p,h=!0;d.v;)if((d=d.n)===p)return;l=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(o=0,a=l.length;o<a;++o)i.point((c=l[o])[0],c[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(l=d.p.z,o=l.length-1;o>=0;--o)i.point((c=l[o])[0],c[1]);else r(d.x,d.p.x,-1,i);d=d.p}l=(d=d.o).z,h=!h}while(!d.v);i.lineEnd()}}}function jA(e){if(t=e.length){for(var t,n,r=0,i=e[0];++r<t;)i.n=n=e[r],n.p=i,i=n;i.n=n=e[0],n.p=i}}function GA(e){return[vE(e[1],e[0]),AE(e[2])]}function UA(e){var t=e[0],n=e[1],r=xE(n);return[r*xE(t),r*SE(t),SE(n)]}function WA(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function VA(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function HA(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function qA(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function XA(e){var t=ME(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function YA(e){return yE(e[0])<=pE?e[0]:CE(e[0])*((yE(e[0])+pE)%fE-pE)}function KA(e){return Array.from(function*(e){for(const t of e)yield*t}(e))}function JA(e,t,n,r){return function(i){var o,a,s,u=t(i),l=LA(),c=t(l),p=!1,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=b,d.lineEnd=v,a=[],o=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,a=KA(a);var e=function(e,t){var n=YA(t),r=t[1],i=SE(r),o=[SE(n),-xE(n),0],a=0,s=0,u=new uE;1===i?r=dE+lE:-1===i&&(r=-dE-lE);for(var l=0,c=e.length;l<c;++l)if(d=(p=e[l]).length)for(var p,d,h=p[d-1],f=YA(h),g=h[1]/2+hE,m=SE(g),y=xE(g),b=0;b<d;++b,f=x,m=w,y=k,h=v){var v=p[b],x=YA(v),_=v[1]/2+hE,w=SE(_),k=xE(_),S=x-f,C=S>=0?1:-1,M=C*S,T=M>pE,E=m*w;if(u.add(vE(E*C*SE(M),y*k+E*xE(M))),a+=T?S+C*fE:S,T^f>=n^x>=n){var A=VA(UA(h),UA(v));XA(A);var F=VA(o,A);XA(F);var O=(T^S>=0?-1:1)*AE(F[2]);(r>O||r===O&&(A[0]||A[1]))&&(s+=T^S>=0?1:-1)}}return(a<-lE||a<lE&&u<-cE)^1&s}(o,r);a.length?(p||(i.polygonStart(),p=!0),zA(a,QA,e,n,i)):e&&(p||(i.polygonStart(),p=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),p&&(i.polygonEnd(),p=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(t,n){e(t,n)&&i.point(t,n)}function f(e,t){u.point(e,t)}function g(){d.point=f,u.lineStart()}function m(){d.point=h,u.lineEnd()}function y(e,t){s.push([e,t]),c.point(e,t)}function b(){c.lineStart(),s=[]}function v(){y(s[0][0],s[0][1]),c.lineEnd();var e,t,n,r,u=c.clean(),d=l.result(),h=d.length;if(s.pop(),o.push(s),s=null,h)if(1&u){if((t=(n=d[0]).length-1)>0){for(p||(i.polygonStart(),p=!0),i.lineStart(),e=0;e<t;++e)i.point((r=n[e])[0],r[1]);i.lineEnd()}}else h>1&&2&u&&d.push(d.pop().concat(d.shift())),a.push(d.filter(ZA))}return d}}function ZA(e){return e.length>1}function QA(e,t){return((e=e.x)[0]<0?e[1]-dE-lE:dE-e[1])-((t=t.x)[0]<0?t[1]-dE-lE:dE-t[1])}const eF=JA((function(){return!0}),(function(e){var t,n=NaN,r=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(o,a){var s=o>0?pE:-pE,u=yE(o-n);yE(u-pE)<lE?(e.point(n,r=(r+a)/2>0?dE:-dE),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),e.point(o,r),t=0):i!==s&&u>=pE&&(yE(n-i)<lE&&(n-=i*lE),yE(o-s)<lE&&(o-=s*lE),r=function(e,t,n,r){var i,o,a=SE(e-n);return yE(a)>lE?bE((SE(t)*(o=xE(r))*SE(n)-SE(r)*(i=xE(t))*SE(e))/(i*o*a)):(t+r)/2}(n,r,o,a),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),t=0),e.point(n=o,r=a),i=s},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}),(function(e,t,n,r){var i;if(null==e)i=n*dE,r.point(-pE,i),r.point(0,i),r.point(pE,i),r.point(pE,0),r.point(pE,-i),r.point(0,-i),r.point(-pE,-i),r.point(-pE,0),r.point(-pE,i);else if(yE(e[0]-t[0])>lE){var o=e[0]<t[0]?pE:-pE;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}),[-pE,-dE]);function tF(e,t){(t=UA(t))[0]-=e,XA(t);var n=EE(-t[1]);return((-t[2]<0?-n:n)+fE-lE)%fE}var nF=1e9,rF=-nF;function iF(e,t,n,r){function i(i,o){return e<=i&&i<=n&&t<=o&&o<=r}function o(i,o,s,l){var c=0,p=0;if(null==i||(c=a(i,s))!==(p=a(o,s))||u(i,o)<0^s>0)do{l.point(0===c||3===c?e:n,c>1?r:t)}while((c=(c+s+4)%4)!==p);else l.point(o[0],o[1])}function a(r,i){return yE(r[0]-e)<lE?i>0?0:3:yE(r[0]-n)<lE?i>0?2:1:yE(r[1]-t)<lE?i>0?1:0:i>0?3:2}function s(e,t){return u(e.x,t.x)}function u(e,t){var n=a(e,1),r=a(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(a){var u,l,c,p,d,h,f,g,m,y,b,v=a,x=LA(),_={point:w,lineStart:function(){_.point=k,l&&l.push(c=[]),y=!0,m=!1,f=g=NaN},lineEnd:function(){u&&(k(p,d),h&&m&&x.rejoin(),u.push(x.result())),_.point=w,m&&v.lineEnd()},polygonStart:function(){v=x,u=[],l=[],b=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,i=l.length;n<i;++n)for(var o,a,s=l[n],u=1,c=s.length,p=s[0],d=p[0],h=p[1];u<c;++u)o=d,a=h,d=(p=s[u])[0],h=p[1],a<=r?h>r&&(d-o)*(r-a)>(h-a)*(e-o)&&++t:h<=r&&(d-o)*(r-a)<(h-a)*(e-o)&&--t;return t}(),n=b&&t,i=(u=KA(u)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&zA(u,s,t,o,a),a.polygonEnd()),v=a,u=l=c=null}};function w(e,t){i(e,t)&&v.point(e,t)}function k(o,a){var s=i(o,a);if(l&&c.push([o,a]),y)p=o,d=a,h=s,y=!1,s&&(v.lineStart(),v.point(o,a));else if(s&&m)v.point(o,a);else{var u=[f=Math.max(rF,Math.min(nF,f)),g=Math.max(rF,Math.min(nF,g))],x=[o=Math.max(rF,Math.min(nF,o)),a=Math.max(rF,Math.min(nF,a))];!function(e,t,n,r,i,o){var a,s=e[0],u=e[1],l=0,c=1,p=t[0]-s,d=t[1]-u;if(a=n-s,p||!(a>0)){if(a/=p,p<0){if(a<l)return;a<c&&(c=a)}else if(p>0){if(a>c)return;a>l&&(l=a)}if(a=i-s,p||!(a<0)){if(a/=p,p<0){if(a>c)return;a>l&&(l=a)}else if(p>0){if(a<l)return;a<c&&(c=a)}if(a=r-u,d||!(a>0)){if(a/=d,d<0){if(a<l)return;a<c&&(c=a)}else if(d>0){if(a>c)return;a>l&&(l=a)}if(a=o-u,d||!(a<0)){if(a/=d,d<0){if(a>c)return;a>l&&(l=a)}else if(d>0){if(a<l)return;a<c&&(c=a)}return l>0&&(e[0]=s+l*p,e[1]=u+l*d),c<1&&(t[0]=s+c*p,t[1]=u+c*d),!0}}}}}(u,x,e,t,n,r)?s&&(v.lineStart(),v.point(o,a),b=!1):(m||(v.lineStart(),v.point(u[0],u[1])),v.point(x[0],x[1]),s||v.lineEnd(),b=!1)}f=o,g=a,m=s}return _}}function oF(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n}function aF(e,t){return yE(e)>pE&&(e-=Math.round(e/fE)*fE),[e,t]}function sF(e,t,n){return(e%=fE)?t||n?oF(lF(e),cF(t,n)):lF(e):t||n?cF(t,n):aF}function uF(e){return function(t,n){return yE(t+=e)>pE&&(t-=Math.round(t/fE)*fE),[t,n]}}function lF(e){var t=uF(e);return t.invert=uF(-e),t}function cF(e,t){var n=xE(e),r=SE(e),i=xE(t),o=SE(t);function a(e,t){var a=xE(t),s=xE(e)*a,u=SE(e)*a,l=SE(t),c=l*n+s*r;return[vE(u*i-c*o,s*n-l*r),AE(c*i+u*o)]}return a.invert=function(e,t){var a=xE(t),s=xE(e)*a,u=SE(e)*a,l=SE(t),c=l*i-u*o;return[vE(u*i+l*o,s*n+c*r),AE(c*n-s*r)]},a}function pF(e){return function(t){var n=new dF;for(var r in e)n[r]=e[r];return n.stream=t,n}}function dF(){}function hF(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),sE(n,e.stream(XE)),t(XE.result()),null!=r&&e.clipExtent(r),e}function fF(e,t,n){return hF(e,(function(n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+t[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+t[0][1]+(i-o*(n[1][1]+n[0][1]))/2;e.scale(150*o).translate([a,s])}),n)}function gF(e,t,n){return fF(e,[[0,0],t],n)}function mF(e,t,n){return hF(e,(function(n){var r=+t,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];e.scale(150*i).translate([o,a])}),n)}function yF(e,t,n){return hF(e,(function(n){var r=+t,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([o,a])}),n)}aF.invert=aF,dF.prototype={constructor:dF,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var bF=16,vF=xE(30*mE);function xF(e,t){return+t?function(e,t){function n(r,i,o,a,s,u,l,c,p,d,h,f,g,m){var y=l-r,b=c-i,v=y*y+b*b;if(v>4*t&&g--){var x=a+d,_=s+h,w=u+f,k=ME(x*x+_*_+w*w),S=AE(w/=k),C=yE(yE(w)-1)<lE||yE(o-p)<lE?(o+p)/2:vE(_,x),M=e(C,S),T=M[0],E=M[1],A=T-r,F=E-i,O=b*A-y*F;(O*O/v>t||yE((y*A+b*F)/v-.5)>.3||a*d+s*h+u*f<vF)&&(n(r,i,o,a,s,u,T,E,C,x/=k,_/=k,w,g,m),m.point(T,E),n(T,E,C,x,_,w,l,c,p,d,h,f,g,m))}}return function(t){var r,i,o,a,s,u,l,c,p,d,h,f,g={point:m,lineStart:y,lineEnd:v,polygonStart:function(){t.polygonStart(),g.lineStart=x},polygonEnd:function(){t.polygonEnd(),g.lineStart=y}};function m(n,r){n=e(n,r),t.point(n[0],n[1])}function y(){c=NaN,g.point=b,t.lineStart()}function b(r,i){var o=UA([r,i]),a=e(r,i);n(c,p,l,d,h,f,c=a[0],p=a[1],l=r,d=o[0],h=o[1],f=o[2],bF,t),t.point(c,p)}function v(){g.point=m,t.lineEnd()}function x(){y(),g.point=_,g.lineEnd=w}function _(e,t){b(r=e,t),i=c,o=p,a=d,s=h,u=f,g.point=b}function w(){n(c,p,l,d,h,f,i,o,r,a,s,u,bF,t),g.lineEnd=v,v()}return g}}(e,t):function(e){return pF({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}var _F=pF({point:function(e,t){this.stream.point(e*mE,t*mE)}});function wF(e,t,n,r,i,o){if(!o)return function(e,t,n,r,i){function o(o,a){return[t+e*(o*=r),n-e*(a*=i)]}return o.invert=function(o,a){return[(o-t)/e*r,(n-a)/e*i]},o}(e,t,n,r,i);var a=xE(o),s=SE(o),u=a*e,l=s*e,c=a/e,p=s/e,d=(s*n-a*t)/e,h=(s*t+a*n)/e;function f(e,o){return[u*(e*=r)-l*(o*=i)+t,n-l*e-u*o]}return f.invert=function(e,t){return[r*(c*e-p*t+d),i*(h-p*e-c*t)]},f}function kF(e){return SF((function(){return e}))()}function SF(e){var t,n,r,i,o,a,s,u,l,c,p=150,d=480,h=250,f=0,g=0,m=0,y=0,b=0,v=0,x=1,_=1,w=null,k=eF,S=null,C=tE,M=.5;function T(e){return u(e[0]*mE,e[1]*mE)}function E(e){return(e=u.invert(e[0],e[1]))&&[e[0]*gE,e[1]*gE]}function A(){var e=wF(p,0,0,x,_,v).apply(null,t(f,g)),r=wF(p,d-e[0],h-e[1],x,_,v);return n=sF(m,y,b),s=oF(t,r),u=oF(n,s),a=xF(s,M),F()}function F(){return l=c=null,T}return T.stream=function(e){return l&&c===e?l:l=_F(function(e){return pF({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(k(a(C(c=e)))))},T.preclip=function(e){return arguments.length?(k=e,w=void 0,F()):k},T.postclip=function(e){return arguments.length?(C=e,S=r=i=o=null,F()):C},T.clipAngle=function(e){return arguments.length?(k=+e?function(e){var t=xE(e),n=6*mE,r=t>0,i=yE(t)>lE;function o(e,n){return xE(e)*xE(n)>t}function a(e,n,r){var i=[1,0,0],o=VA(UA(e),UA(n)),a=WA(o,o),s=o[0],u=a-s*s;if(!u)return!r&&e;var l=t*a/u,c=-t*s/u,p=VA(i,o),d=qA(i,l);HA(d,qA(o,c));var h=p,f=WA(d,h),g=WA(h,h),m=f*f-g*(WA(d,d)-1);if(!(m<0)){var y=ME(m),b=qA(h,(-f-y)/g);if(HA(b,d),b=GA(b),!r)return b;var v,x=e[0],_=n[0],w=e[1],k=n[1];_<x&&(v=x,x=_,_=v);var S=_-x,C=yE(S-pE)<lE;if(!C&&k<w&&(v=w,w=k,k=v),C||S<lE?C?w+k>0^b[1]<(yE(b[0]-x)<lE?w:k):w<=b[1]&&b[1]<=k:S>pE^(x<=b[0]&&b[0]<=_)){var M=qA(h,(-f+y)/g);return HA(M,d),[b,GA(M)]}}}function s(t,n){var i=r?e:pE-e,o=0;return t<-i?o|=1:t>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return JA(o,(function(e){var t,n,u,l,c;return{lineStart:function(){l=u=!1,c=1},point:function(p,d){var h,f=[p,d],g=o(p,d),m=r?g?0:s(p,d):g?s(p+(p<0?pE:-pE),d):0;if(!t&&(l=u=g)&&e.lineStart(),g!==u&&(!(h=a(t,f))||PA(t,h)||PA(f,h))&&(f[2]=1),g!==u)c=0,g?(e.lineStart(),h=a(f,t),e.point(h[0],h[1])):(h=a(t,f),e.point(h[0],h[1],2),e.lineEnd()),t=h;else if(i&&t&&r^g){var y;m&n||!(y=a(f,t,!0))||(c=0,r?(e.lineStart(),e.point(y[0][0],y[0][1]),e.point(y[1][0],y[1][1]),e.lineEnd()):(e.point(y[1][0],y[1][1]),e.lineEnd(),e.lineStart(),e.point(y[0][0],y[0][1],3)))}!g||t&&PA(t,f)||e.point(f[0],f[1]),t=f,u=g,n=m},lineEnd:function(){u&&e.lineEnd(),t=null},clean:function(){return c|(l&&u)<<1}}}),(function(t,r,i,o){!function(e,t,n,r,i,o){if(n){var a=xE(t),s=SE(t),u=r*n;null==i?(i=t+r*fE,o=t-u/2):(i=tF(a,i),o=tF(a,o),(r>0?i<o:i>o)&&(i+=r*fE));for(var l,c=i;r>0?c>o:c<o;c-=u)l=GA([a,-s*xE(c),-s*SE(c)]),e.point(l[0],l[1])}}(o,e,n,i,t,r)}),r?[0,-e]:[-pE,e-pE])}(w=e*mE):(w=null,eF),F()):w*gE},T.clipExtent=function(e){return arguments.length?(C=null==e?(S=r=i=o=null,tE):iF(S=+e[0][0],r=+e[0][1],i=+e[1][0],o=+e[1][1]),F()):null==S?null:[[S,r],[i,o]]},T.scale=function(e){return arguments.length?(p=+e,A()):p},T.translate=function(e){return arguments.length?(d=+e[0],h=+e[1],A()):[d,h]},T.center=function(e){return arguments.length?(f=e[0]%360*mE,g=e[1]%360*mE,A()):[f*gE,g*gE]},T.rotate=function(e){return arguments.length?(m=e[0]%360*mE,y=e[1]%360*mE,b=e.length>2?e[2]%360*mE:0,A()):[m*gE,y*gE,b*gE]},T.angle=function(e){return arguments.length?(v=e%360*mE,A()):v*gE},T.reflectX=function(e){return arguments.length?(x=e?-1:1,A()):x<0},T.reflectY=function(e){return arguments.length?(_=e?-1:1,A()):_<0},T.precision=function(e){return arguments.length?(a=xF(s,M=e*e),F()):ME(M)},T.fitExtent=function(e,t){return fF(T,e,t)},T.fitSize=function(e,t){return gF(T,e,t)},T.fitWidth=function(e,t){return mF(T,e,t)},T.fitHeight=function(e,t){return yF(T,e,t)},function(){return t=e.apply(this,arguments),T.invert=t.invert&&E,A()}}function CF(e){var t=0,n=pE/3,r=SF(e),i=r(t,n);return i.parallels=function(e){return arguments.length?r(t=e[0]*mE,n=e[1]*mE):[t*gE,n*gE]},i}function MF(e,t){var n=SE(e),r=(n+SE(t))/2;if(yE(r)<lE)return function(e){var t=xE(e);function n(e,n){return[e*t,SE(n)/t]}return n.invert=function(e,n){return[e/t,AE(n*t)]},n}(e);var i=1+n*(2*r-n),o=ME(i)/r;function a(e,t){var n=ME(i-2*r*SE(t))/r;return[n*SE(e*=r),o-n*xE(e)]}return a.invert=function(e,t){var n=o-t,a=vE(e,yE(n))*CE(n);return n*r<0&&(a-=pE*CE(e)*CE(n)),[a/r,AE((i-(e*e+n*n)*r*r)/(2*r))]},a}function TF(){return CF(MF).scale(155.424).center([0,33.6442])}function EF(){return TF().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function AF(e){return function(t,n){var r=xE(t),i=xE(n),o=e(r*i);return o===1/0?[2,0]:[o*i*SE(t),o*SE(n)]}}function FF(e){return function(t,n){var r=ME(t*t+n*n),i=e(r),o=SE(i),a=xE(i);return[vE(t*o,r*a),AE(r&&n*o/r)]}}var OF=AF((function(e){return ME(2/(1+e))}));OF.invert=FF((function(e){return 2*AE(e/2)}));var RF=AF((function(e){return(e=EE(e))&&e/SE(e)}));function NF(e,t){return[e,wE(TE((dE+t)/2))]}function DF(e){var t,n,r,i=kF(e),o=i.center,a=i.scale,s=i.translate,u=i.clipExtent,l=null;function c(){var o=pE*a(),s=i(function(e){function t(t){return(t=e(t[0]*mE,t[1]*mE))[0]*=gE,t[1]*=gE,t}return e=sF(e[0]*mE,e[1]*mE,e.length>2?e[2]*mE:0),t.invert=function(t){return(t=e.invert(t[0]*mE,t[1]*mE))[0]*=gE,t[1]*=gE,t},t}(i.rotate()).invert([0,0]));return u(null==l?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:e===NF?[[Math.max(s[0]-o,l),t],[Math.min(s[0]+o,n),r]]:[[l,Math.max(s[1]-o,t)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(e){return arguments.length?(a(e),c()):a()},i.translate=function(e){return arguments.length?(s(e),c()):s()},i.center=function(e){return arguments.length?(o(e),c()):o()},i.clipExtent=function(e){return arguments.length?(null==e?l=t=n=r=null:(l=+e[0][0],t=+e[0][1],n=+e[1][0],r=+e[1][1]),c()):null==l?null:[[l,t],[n,r]]},c()}function IF(e){return TE((dE+e)/2)}function BF(e,t){var n=xE(e),r=e===t?SE(e):wE(n/xE(t))/wE(IF(t)/IF(e)),i=n*kE(IF(e),r)/r;if(!r)return NF;function o(e,t){i>0?t<-dE+lE&&(t=-dE+lE):t>dE-lE&&(t=dE-lE);var n=i/kE(IF(t),r);return[n*SE(r*e),i-n*xE(r*e)]}return o.invert=function(e,t){var n=i-t,o=CE(r)*ME(e*e+n*n),a=vE(e,yE(n))*CE(n);return n*r<0&&(a-=pE*CE(e)*CE(n)),[a/r,2*bE(kE(i/o,1/r))-dE]},o}function LF(e,t){return[e,t]}function PF(e,t){var n=xE(e),r=e===t?SE(e):(n-xE(t))/(t-e),i=n/r+e;if(yE(r)<lE)return LF;function o(e,t){var n=i-t,o=r*e;return[n*SE(o),i-n*xE(o)]}return o.invert=function(e,t){var n=i-t,o=vE(e,yE(n))*CE(n);return n*r<0&&(o-=pE*CE(e)*CE(n)),[o/r,i-CE(r)*ME(e*e+n*n)]},o}RF.invert=FF((function(e){return e})),NF.invert=function(e,t){return[e,2*bE(_E(t))-dE]},LF.invert=LF;var $F=1.340264,zF=-.081106,jF=893e-6,GF=.003796,UF=ME(3)/2;function WF(e,t){var n=AE(UF*SE(t)),r=n*n,i=r*r*r;return[e*xE(n)/(UF*($F+3*zF*r+i*(7*jF+9*GF*r))),n*($F+zF*r+i*(jF+GF*r))]}function VF(e,t){var n=xE(t),r=xE(e)*n;return[n*SE(e)/r,SE(t)/r]}function HF(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),t*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function qF(e,t){return[xE(t)*SE(e),SE(t)]}function XF(e,t){var n=xE(t),r=1+xE(e)*n;return[n*SE(e)/r,SE(t)/r]}function YF(e,t){return[wE(TE((dE+t)/2)),-e]}function KF(){}function JF(){var e,t=[];return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){t.push(e=[])},lineEnd:KF,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}WF.invert=function(e,t){for(var n,r=t,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=n=(r*($F+zF*i+o*(jF+GF*i))-t)/($F+3*zF*i+o*(7*jF+9*GF*i)))*r)*i*i,!(yE(n)<cE));++a);return[UF*e*($F+3*zF*i+o*(7*jF+9*GF*i))/xE(r),AE(SE(r)/UF)]},VF.invert=FF(bE),HF.invert=function(e,t){var n,r=t,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-t)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(yE(n)>lE&&--i>0);return[e/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},qF.invert=FF(AE),XF.invert=FF((function(e){return 2*bE(e)})),YF.invert=function(e,t){return[-t,2*bE(_E(e))-dE]};var ZF=1e-6,QF=1e-12,eO=Math.PI,tO=eO/2,nO=eO/4,rO=2*eO,iO=180/eO,oO=eO/180,aO=Math.abs,sO=Math.atan,uO=Math.atan2,lO=Math.cos,cO=(Math.ceil,Math.exp,Math.floor,Math.hypot,Math.log,Math.pow,Math.sin),pO=Math.sign||function(e){return e>0?1:e<0?-1:0},dO=Math.sqrt;function hO(e){return e>1?tO:e<-1?-tO:Math.asin(e)}function fO(e,t){return aO(e[0]-t[0])<ZF&&aO(e[1]-t[1])<ZF}function gO(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function mO(e,t,n,r,i){var o,a,s=[],u=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],a=e[t];if(fO(r,a)){if(!r[2]&&!a[2]){for(i.lineStart(),o=0;o<t;++o)i.point((r=e[o])[0],r[1]);return void i.lineEnd()}a[0]+=2*ZF}s.push(n=new gO(r,e,null,!0)),u.push(n.o=new gO(r,null,n,!1)),s.push(n=new gO(a,e,null,!1)),u.push(n.o=new gO(a,null,n,!0))}})),s.length){for(u.sort(t),yO(s),yO(u),o=0,a=u.length;o<a;++o)u[o].e=n=!n;for(var l,c,p=s[0];;){for(var d=p,h=!0;d.v;)if((d=d.n)===p)return;l=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(o=0,a=l.length;o<a;++o)i.point((c=l[o])[0],c[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(l=d.p.z,o=l.length-1;o>=0;--o)i.point((c=l[o])[0],c[1]);else r(d.x,d.p.x,-1,i);d=d.p}l=(d=d.o).z,h=!h}while(!d.v);i.lineEnd()}}}function yO(e){if(t=e.length){for(var t,n,r=0,i=e[0];++r<t;)i.n=n=e[r],n.p=i,i=n;i.n=n=e[0],n.p=i}}Math.tan;class bO{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=t[r],o=e+i,a=Math.abs(e)<Math.abs(i)?e-(o-i):i-(o-e);a&&(t[n++]=a),e=o}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,r,i=this._n,o=0;if(i>0){for(o=e[--i];i>0&&(t=o,n=e[--i],o=t+n,r=n-(o-t),!r););i>0&&(r<0&&e[i-1]<0||r>0&&e[i-1]>0)&&(n=2*r,t=o+n,n==t-o&&(o=t))}return o}}function vO(e){return[uO(e[1],e[0]),hO(e[2])]}function xO(e){var t=e[0],n=e[1],r=lO(n);return[r*lO(t),r*cO(t),cO(n)]}function _O(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function wO(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function kO(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function SO(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function CO(e){var t=dO(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function MO(e){return aO(e[0])<=eO?e[0]:pO(e[0])*((aO(e[0])+eO)%rO-eO)}function TO(e){return Array.from(function*(e){for(const t of e)yield*t}(e))}function EO(e,t,n,r){return function(i){var o,a,s,u=t(i),l=JF(),c=t(l),p=!1,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=b,d.lineEnd=v,a=[],o=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,a=TO(a);var e=function(e,t){var n=MO(t),r=t[1],i=cO(r),o=[cO(n),-lO(n),0],a=0,s=0,u=new bO;1===i?r=tO+ZF:-1===i&&(r=-tO-ZF);for(var l=0,c=e.length;l<c;++l)if(d=(p=e[l]).length)for(var p,d,h=p[d-1],f=MO(h),g=h[1]/2+nO,m=cO(g),y=lO(g),b=0;b<d;++b,f=x,m=w,y=k,h=v){var v=p[b],x=MO(v),_=v[1]/2+nO,w=cO(_),k=lO(_),S=x-f,C=S>=0?1:-1,M=C*S,T=M>eO,E=m*w;if(u.add(uO(E*C*cO(M),y*k+E*lO(M))),a+=T?S+C*rO:S,T^f>=n^x>=n){var A=wO(xO(h),xO(v));CO(A);var F=wO(o,A);CO(F);var O=(T^S>=0?-1:1)*hO(F[2]);(r>O||r===O&&(A[0]||A[1]))&&(s+=T^S>=0?1:-1)}}return(a<-ZF||a<ZF&&u<-QF)^1&s}(o,r);a.length?(p||(i.polygonStart(),p=!0),mO(a,FO,e,n,i)):e&&(p||(i.polygonStart(),p=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),p&&(i.polygonEnd(),p=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(t,n){e(t,n)&&i.point(t,n)}function f(e,t){u.point(e,t)}function g(){d.point=f,u.lineStart()}function m(){d.point=h,u.lineEnd()}function y(e,t){s.push([e,t]),c.point(e,t)}function b(){c.lineStart(),s=[]}function v(){y(s[0][0],s[0][1]),c.lineEnd();var e,t,n,r,u=c.clean(),d=l.result(),h=d.length;if(s.pop(),o.push(s),s=null,h)if(1&u){if((t=(n=d[0]).length-1)>0){for(p||(i.polygonStart(),p=!0),i.lineStart(),e=0;e<t;++e)i.point((r=n[e])[0],r[1]);i.lineEnd()}}else h>1&&2&u&&d.push(d.pop().concat(d.shift())),a.push(d.filter(AO))}return d}}function AO(e){return e.length>1}function FO(e,t){return((e=e.x)[0]<0?e[1]-tO-ZF:tO-e[1])-((t=t.x)[0]<0?t[1]-tO-ZF:tO-t[1])}const OO=EO((function(){return!0}),(function(e){var t,n=NaN,r=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(o,a){var s=o>0?eO:-eO,u=aO(o-n);aO(u-eO)<ZF?(e.point(n,r=(r+a)/2>0?tO:-tO),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),e.point(o,r),t=0):i!==s&&u>=eO&&(aO(n-i)<ZF&&(n-=i*ZF),aO(o-s)<ZF&&(o-=s*ZF),r=function(e,t,n,r){var i,o,a=cO(e-n);return aO(a)>ZF?sO((cO(t)*(o=lO(r))*cO(n)-cO(r)*(i=lO(t))*cO(e))/(i*o*a)):(t+r)/2}(n,r,o,a),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),t=0),e.point(n=o,r=a),i=s},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}),(function(e,t,n,r){var i;if(null==e)i=n*tO,r.point(-eO,i),r.point(0,i),r.point(eO,i),r.point(eO,0),r.point(eO,-i),r.point(0,-i),r.point(-eO,-i),r.point(-eO,0),r.point(-eO,i);else if(aO(e[0]-t[0])>ZF){var o=e[0]<t[0]?eO:-eO;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}),[-eO,-tO]);function RO(e,t){(t=xO(t))[0]-=e,CO(t);var n=function(e){return e>1?0:e<-1?eO:Math.acos(e)}(-t[1]);return((-t[2]<0?-n:n)+rO-ZF)%rO}var NO=1e9,DO=-NO;function IO(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n}const BO=e=>e;function LO(e,t){return aO(e)>eO&&(e-=Math.round(e/rO)*rO),[e,t]}function PO(e){return function(t,n){return aO(t+=e)>eO&&(t-=Math.round(t/rO)*rO),[t,n]}}function $O(e){var t=PO(e);return t.invert=PO(-e),t}function zO(e,t){var n=lO(e),r=cO(e),i=lO(t),o=cO(t);function a(e,t){var a=lO(t),s=lO(e)*a,u=cO(e)*a,l=cO(t),c=l*n+s*r;return[uO(u*i-c*o,s*n-l*r),hO(c*i+u*o)]}return a.invert=function(e,t){var a=lO(t),s=lO(e)*a,u=cO(e)*a,l=cO(t),c=l*i-u*o;return[uO(u*i+l*o,s*n+c*r),hO(c*n-s*r)]},a}function jO(e){return function(t){var n=new GO;for(var r in e)n[r]=e[r];return n.stream=t,n}}function GO(){}function UO(e,t){e&&VO.hasOwnProperty(e.type)&&VO[e.type](e,t)}LO.invert=LO,GO.prototype={constructor:GO,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var WO={Feature:function(e,t){UO(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)UO(n[r].geometry,t)}},VO={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){HO(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)HO(n[r],t,0)},Polygon:function(e,t){qO(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)qO(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)UO(n[r],t)}};function HO(e,t,n){var r,i=-1,o=e.length-n;for(t.lineStart();++i<o;)r=e[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function qO(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)HO(e[n],t,1);t.polygonEnd()}var XO=1/0,YO=XO,KO=-XO,JO=KO,ZO={point:function(e,t){e<XO&&(XO=e),e>KO&&(KO=e),t<YO&&(YO=t),t>JO&&(JO=t)},lineStart:KF,lineEnd:KF,polygonStart:KF,polygonEnd:KF,result:function(){var e=[[XO,YO],[KO,JO]];return KO=JO=-(YO=XO=1/0),e}};const QO=ZO;function eR(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),function(e,t){e&&WO.hasOwnProperty(e.type)?WO[e.type](e,t):UO(e,t)}(n,e.stream(QO)),t(QO.result()),null!=r&&e.clipExtent(r),e}function tR(e,t,n){return eR(e,(function(n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+t[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+t[0][1]+(i-o*(n[1][1]+n[0][1]))/2;e.scale(150*o).translate([a,s])}),n)}var nR=16,rR=lO(30*oO);function iR(e,t){return+t?function(e,t){function n(r,i,o,a,s,u,l,c,p,d,h,f,g,m){var y=l-r,b=c-i,v=y*y+b*b;if(v>4*t&&g--){var x=a+d,_=s+h,w=u+f,k=dO(x*x+_*_+w*w),S=hO(w/=k),C=aO(aO(w)-1)<ZF||aO(o-p)<ZF?(o+p)/2:uO(_,x),M=e(C,S),T=M[0],E=M[1],A=T-r,F=E-i,O=b*A-y*F;(O*O/v>t||aO((y*A+b*F)/v-.5)>.3||a*d+s*h+u*f<rR)&&(n(r,i,o,a,s,u,T,E,C,x/=k,_/=k,w,g,m),m.point(T,E),n(T,E,C,x,_,w,l,c,p,d,h,f,g,m))}}return function(t){var r,i,o,a,s,u,l,c,p,d,h,f,g={point:m,lineStart:y,lineEnd:v,polygonStart:function(){t.polygonStart(),g.lineStart=x},polygonEnd:function(){t.polygonEnd(),g.lineStart=y}};function m(n,r){n=e(n,r),t.point(n[0],n[1])}function y(){c=NaN,g.point=b,t.lineStart()}function b(r,i){var o=xO([r,i]),a=e(r,i);n(c,p,l,d,h,f,c=a[0],p=a[1],l=r,d=o[0],h=o[1],f=o[2],nR,t),t.point(c,p)}function v(){g.point=m,t.lineEnd()}function x(){y(),g.point=_,g.lineEnd=w}function _(e,t){b(r=e,t),i=c,o=p,a=d,s=h,u=f,g.point=b}function w(){n(c,p,l,d,h,f,i,o,r,a,s,u,nR,t),g.lineEnd=v,v()}return g}}(e,t):function(e){return jO({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}var oR=jO({point:function(e,t){this.stream.point(e*oO,t*oO)}});function aR(e,t,n,r,i,o){if(!o)return function(e,t,n,r,i){function o(o,a){return[t+e*(o*=r),n-e*(a*=i)]}return o.invert=function(o,a){return[(o-t)/e*r,(n-a)/e*i]},o}(e,t,n,r,i);var a=lO(o),s=cO(o),u=a*e,l=s*e,c=a/e,p=s/e,d=(s*n-a*t)/e,h=(s*t+a*n)/e;function f(e,o){return[u*(e*=r)-l*(o*=i)+t,n-l*e-u*o]}return f.invert=function(e,t){return[r*(c*e-p*t+d),i*(h-p*e-c*t)]},f}function sR(e){return function(e){var t,n,r,i,o,a,s,u,l,c,p=150,d=480,h=250,f=0,g=0,m=0,y=0,b=0,v=0,x=1,_=1,w=null,k=OO,S=null,C=BO,M=.5;function T(e){return u(e[0]*oO,e[1]*oO)}function E(e){return(e=u.invert(e[0],e[1]))&&[e[0]*iO,e[1]*iO]}function A(){var e=aR(p,0,0,x,_,v).apply(null,t(f,g)),r=aR(p,d-e[0],h-e[1],x,_,v);return n=function(e,t,n){return(e%=rO)?t||n?IO($O(e),zO(t,n)):$O(e):t||n?zO(t,n):LO}(m,y,b),s=IO(t,r),u=IO(n,s),a=iR(s,M),F()}function F(){return l=c=null,T}return T.stream=function(e){return l&&c===e?l:l=oR(function(e){return jO({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(k(a(C(c=e)))))},T.preclip=function(e){return arguments.length?(k=e,w=void 0,F()):k},T.postclip=function(e){return arguments.length?(C=e,S=r=i=o=null,F()):C},T.clipAngle=function(e){return arguments.length?(k=+e?function(e){var t=lO(e),n=6*oO,r=t>0,i=aO(t)>ZF;function o(e,n){return lO(e)*lO(n)>t}function a(e,n,r){var i=[1,0,0],o=wO(xO(e),xO(n)),a=_O(o,o),s=o[0],u=a-s*s;if(!u)return!r&&e;var l=t*a/u,c=-t*s/u,p=wO(i,o),d=SO(i,l);kO(d,SO(o,c));var h=p,f=_O(d,h),g=_O(h,h),m=f*f-g*(_O(d,d)-1);if(!(m<0)){var y=dO(m),b=SO(h,(-f-y)/g);if(kO(b,d),b=vO(b),!r)return b;var v,x=e[0],_=n[0],w=e[1],k=n[1];_<x&&(v=x,x=_,_=v);var S=_-x,C=aO(S-eO)<ZF;if(!C&&k<w&&(v=w,w=k,k=v),C||S<ZF?C?w+k>0^b[1]<(aO(b[0]-x)<ZF?w:k):w<=b[1]&&b[1]<=k:S>eO^(x<=b[0]&&b[0]<=_)){var M=SO(h,(-f+y)/g);return kO(M,d),[b,vO(M)]}}}function s(t,n){var i=r?e:eO-e,o=0;return t<-i?o|=1:t>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return EO(o,(function(e){var t,n,u,l,c;return{lineStart:function(){l=u=!1,c=1},point:function(p,d){var h,f=[p,d],g=o(p,d),m=r?g?0:s(p,d):g?s(p+(p<0?eO:-eO),d):0;if(!t&&(l=u=g)&&e.lineStart(),g!==u&&(!(h=a(t,f))||fO(t,h)||fO(f,h))&&(f[2]=1),g!==u)c=0,g?(e.lineStart(),h=a(f,t),e.point(h[0],h[1])):(h=a(t,f),e.point(h[0],h[1],2),e.lineEnd()),t=h;else if(i&&t&&r^g){var y;m&n||!(y=a(f,t,!0))||(c=0,r?(e.lineStart(),e.point(y[0][0],y[0][1]),e.point(y[1][0],y[1][1]),e.lineEnd()):(e.point(y[1][0],y[1][1]),e.lineEnd(),e.lineStart(),e.point(y[0][0],y[0][1],3)))}!g||t&&fO(t,f)||e.point(f[0],f[1]),t=f,u=g,n=m},lineEnd:function(){u&&e.lineEnd(),t=null},clean:function(){return c|(l&&u)<<1}}}),(function(t,r,i,o){!function(e,t,n,r,i,o){if(n){var a=lO(t),s=cO(t),u=r*n;null==i?(i=t+r*rO,o=t-u/2):(i=RO(a,i),o=RO(a,o),(r>0?i<o:i>o)&&(i+=r*rO));for(var l,c=i;r>0?c>o:c<o;c-=u)l=vO([a,-s*lO(c),-s*cO(c)]),e.point(l[0],l[1])}}(o,e,n,i,t,r)}),r?[0,-e]:[-eO,e-eO])}(w=e*oO):(w=null,OO),F()):w*iO},T.clipExtent=function(e){return arguments.length?(C=null==e?(S=r=i=o=null,BO):function(e,t,n,r){function i(i,o){return e<=i&&i<=n&&t<=o&&o<=r}function o(i,o,s,l){var c=0,p=0;if(null==i||(c=a(i,s))!==(p=a(o,s))||u(i,o)<0^s>0)do{l.point(0===c||3===c?e:n,c>1?r:t)}while((c=(c+s+4)%4)!==p);else l.point(o[0],o[1])}function a(r,i){return aO(r[0]-e)<ZF?i>0?0:3:aO(r[0]-n)<ZF?i>0?2:1:aO(r[1]-t)<ZF?i>0?1:0:i>0?3:2}function s(e,t){return u(e.x,t.x)}function u(e,t){var n=a(e,1),r=a(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(a){var u,l,c,p,d,h,f,g,m,y,b,v=a,x=JF(),_={point:w,lineStart:function(){_.point=k,l&&l.push(c=[]),y=!0,m=!1,f=g=NaN},lineEnd:function(){u&&(k(p,d),h&&m&&x.rejoin(),u.push(x.result())),_.point=w,m&&v.lineEnd()},polygonStart:function(){v=x,u=[],l=[],b=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,i=l.length;n<i;++n)for(var o,a,s=l[n],u=1,c=s.length,p=s[0],d=p[0],h=p[1];u<c;++u)o=d,a=h,d=(p=s[u])[0],h=p[1],a<=r?h>r&&(d-o)*(r-a)>(h-a)*(e-o)&&++t:h<=r&&(d-o)*(r-a)<(h-a)*(e-o)&&--t;return t}(),n=b&&t,i=(u=TO(u)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&mO(u,s,t,o,a),a.polygonEnd()),v=a,u=l=c=null}};function w(e,t){i(e,t)&&v.point(e,t)}function k(o,a){var s=i(o,a);if(l&&c.push([o,a]),y)p=o,d=a,h=s,y=!1,s&&(v.lineStart(),v.point(o,a));else if(s&&m)v.point(o,a);else{var u=[f=Math.max(DO,Math.min(NO,f)),g=Math.max(DO,Math.min(NO,g))],x=[o=Math.max(DO,Math.min(NO,o)),a=Math.max(DO,Math.min(NO,a))];!function(e,t,n,r,i,o){var a,s=e[0],u=e[1],l=0,c=1,p=t[0]-s,d=t[1]-u;if(a=n-s,p||!(a>0)){if(a/=p,p<0){if(a<l)return;a<c&&(c=a)}else if(p>0){if(a>c)return;a>l&&(l=a)}if(a=i-s,p||!(a<0)){if(a/=p,p<0){if(a>c)return;a>l&&(l=a)}else if(p>0){if(a<l)return;a<c&&(c=a)}if(a=r-u,d||!(a>0)){if(a/=d,d<0){if(a<l)return;a<c&&(c=a)}else if(d>0){if(a>c)return;a>l&&(l=a)}if(a=o-u,d||!(a<0)){if(a/=d,d<0){if(a>c)return;a>l&&(l=a)}else if(d>0){if(a<l)return;a<c&&(c=a)}return l>0&&(e[0]=s+l*p,e[1]=u+l*d),c<1&&(t[0]=s+c*p,t[1]=u+c*d),!0}}}}}(u,x,e,t,n,r)?s&&(v.lineStart(),v.point(o,a),b=!1):(m||(v.lineStart(),v.point(u[0],u[1])),v.point(x[0],x[1]),s||v.lineEnd(),b=!1)}f=o,g=a,m=s}return _}}(S=+e[0][0],r=+e[0][1],i=+e[1][0],o=+e[1][1]),F()):null==S?null:[[S,r],[i,o]]},T.scale=function(e){return arguments.length?(p=+e,A()):p},T.translate=function(e){return arguments.length?(d=+e[0],h=+e[1],A()):[d,h]},T.center=function(e){return arguments.length?(f=e[0]%360*oO,g=e[1]%360*oO,A()):[f*iO,g*iO]},T.rotate=function(e){return arguments.length?(m=e[0]%360*oO,y=e[1]%360*oO,b=e.length>2?e[2]%360*oO:0,A()):[m*iO,y*iO,b*iO]},T.angle=function(e){return arguments.length?(v=e%360*oO,A()):v*iO},T.reflectX=function(e){return arguments.length?(x=e?-1:1,A()):x<0},T.reflectY=function(e){return arguments.length?(_=e?-1:1,A()):_<0},T.precision=function(e){return arguments.length?(a=iR(s,M=e*e),F()):dO(M)},T.fitExtent=function(e,t){return tR(T,e,t)},T.fitSize=function(e,t){return function(e,t,n){return tR(e,[[0,0],t],n)}(T,e,t)},T.fitWidth=function(e,t){return function(e,t,n){return eR(e,(function(n){var r=+t,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];e.scale(150*i).translate([o,a])}),n)}(T,e,t)},T.fitHeight=function(e,t){return function(e,t,n){return eR(e,(function(n){var r=+t,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([o,a])}),n)}(T,e,t)},function(){return t=e.apply(this,arguments),T.invert=t.invert&&E,A()}}((function(){return e}))()}var uR=Math.abs,lR=(Math.atan,Math.atan2,Math.ceil,Math.cos),cR=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),pR=(Math.tan,1e-6),dR=Math.PI,hR=dR/2,fR=(Math.SQRT1_2,mR(2));function gR(e){return e>1?hR:e<-1?-hR:Math.asin(e)}function mR(e){return e>0?Math.sqrt(e):0}function yR(e,t){var n,r=e*cR(t),i=30;do{t-=n=(t+cR(t)-r)/(1+lR(t))}while(uR(n)>pR&&--i>0);return t/2}mR(dR);var bR=function(e,t,n){function r(r,i){return[e*r*lR(i=yR(n,i)),t*cR(i)]}return r.invert=function(r,i){return i=gR(i/t),[r/(e*lR(i)),gR((2*i+cR(2*i))/n)]},r}(fR/hR,fR,dR);const vR=BA(),xR=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function _R(e,t){if(!e||"string"!=typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(kR[e]=function(e,t){return function n(){const r=t();return r.type=e,r.path=BA().projection(r),r.copy=r.copy||function(){const e=n();return xR.forEach((t=>{r[t]&&e[t](r[t]())})),e.path.pointRadius(r.path.pointRadius()),e},ex(r)}}(e,t),this):kR[e]||null}function wR(e){return e&&e.path||vR}const kR={albers:EF,albersusa:function(){var e,t,n,r,i,o,a=EF(),s=TF().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=TF().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(e,t){o=[e,t]}};function c(e){var t=e[0],a=e[1];return o=null,n.point(t,a),o||(r.point(t,a),o)||(i.point(t,a),o)}function p(){return e=t=null,c}return c.invert=function(e){var t=a.scale(),n=a.translate(),r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?u:a).invert(e)},c.stream=function(n){return e&&t===n?e:(r=[a.stream(t=n),s.stream(n),u.stream(n)],i=r.length,e={point:function(e,t){for(var n=-1;++n<i;)r[n].point(e,t)},sphere:function(){for(var e=-1;++e<i;)r[e].sphere()},lineStart:function(){for(var e=-1;++e<i;)r[e].lineStart()},lineEnd:function(){for(var e=-1;++e<i;)r[e].lineEnd()},polygonStart:function(){for(var e=-1;++e<i;)r[e].polygonStart()},polygonEnd:function(){for(var e=-1;++e<i;)r[e].polygonEnd()}});var r,i},c.precision=function(e){return arguments.length?(a.precision(e),s.precision(e),u.precision(e),p()):a.precision()},c.scale=function(e){return arguments.length?(a.scale(e),s.scale(.35*e),u.scale(e),c.translate(a.translate())):a.scale()},c.translate=function(e){if(!arguments.length)return a.translate();var t=a.scale(),o=+e[0],c=+e[1];return n=a.translate(e).clipExtent([[o-.455*t,c-.238*t],[o+.455*t,c+.238*t]]).stream(l),r=s.translate([o-.307*t,c+.201*t]).clipExtent([[o-.425*t+lE,c+.12*t+lE],[o-.214*t-lE,c+.234*t-lE]]).stream(l),i=u.translate([o-.205*t,c+.212*t]).clipExtent([[o-.214*t+lE,c+.166*t+lE],[o-.115*t-lE,c+.234*t-lE]]).stream(l),p()},c.fitExtent=function(e,t){return fF(c,e,t)},c.fitSize=function(e,t){return gF(c,e,t)},c.fitWidth=function(e,t){return mF(c,e,t)},c.fitHeight=function(e,t){return yF(c,e,t)},c.scale(1070)},azimuthalequalarea:function(){return kF(OF).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return kF(RF).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return CF(BF).scale(109.5).parallels([30,30])},conicequalarea:TF,conicequidistant:function(){return CF(PF).scale(131.154).center([0,13.9389])},equalEarth:function(){return kF(WF).scale(177.158)},equirectangular:function(){return kF(LF).scale(152.63)},gnomonic:function(){return kF(VF).scale(144.049).clipAngle(60)},identity:function(){var e,t,n,r,i,o,a,s=1,u=0,l=0,c=1,p=1,d=0,h=null,f=1,g=1,m=pF({point:function(e,t){var n=v([e,t]);this.stream.point(n[0],n[1])}}),y=tE;function b(){return f=s*c,g=s*p,o=a=null,v}function v(n){var r=n[0]*f,i=n[1]*g;if(d){var o=i*e-r*t;r=r*e+i*t,i=o}return[r+u,i+l]}return v.invert=function(n){var r=n[0]-u,i=n[1]-l;if(d){var o=i*e+r*t;r=r*e-i*t,i=o}return[r/f,i/g]},v.stream=function(e){return o&&a===e?o:o=m(y(a=e))},v.postclip=function(e){return arguments.length?(y=e,h=n=r=i=null,b()):y},v.clipExtent=function(e){return arguments.length?(y=null==e?(h=n=r=i=null,tE):iF(h=+e[0][0],n=+e[0][1],r=+e[1][0],i=+e[1][1]),b()):null==h?null:[[h,n],[r,i]]},v.scale=function(e){return arguments.length?(s=+e,b()):s},v.translate=function(e){return arguments.length?(u=+e[0],l=+e[1],b()):[u,l]},v.angle=function(n){return arguments.length?(t=SE(d=n%360*mE),e=xE(d),b()):d*gE},v.reflectX=function(e){return arguments.length?(c=e?-1:1,b()):c<0},v.reflectY=function(e){return arguments.length?(p=e?-1:1,b()):p<0},v.fitExtent=function(e,t){return fF(v,e,t)},v.fitSize=function(e,t){return gF(v,e,t)},v.fitWidth=function(e,t){return mF(v,e,t)},v.fitHeight=function(e,t){return yF(v,e,t)},v},mercator:function(){return DF(NF).scale(961/fE)},mollweide:function(){return sR(bR).scale(169.529)},naturalEarth1:function(){return kF(HF).scale(175.295)},orthographic:function(){return kF(qF).scale(249.5).clipAngle(90+lE)},stereographic:function(){return kF(XF).scale(250).clipAngle(142)},transversemercator:function(){var e=DF(YF),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)}};for(const e in kR)_R(e,kR[e]);var SR=1e-6,CR=1e-12,MR=Math.PI,TR=MR/2,ER=MR/4,AR=2*MR,FR=180/MR,OR=MR/180,RR=Math.abs,NR=Math.atan,DR=Math.atan2,IR=Math.cos,BR=Math.ceil,LR=Math.exp,PR=(Math.floor,Math.hypot),$R=Math.log,zR=Math.pow,jR=Math.sin,GR=Math.sign||function(e){return e>0?1:e<0?-1:0},UR=Math.sqrt,WR=Math.tan;function VR(e){return e>1?0:e<-1?MR:Math.acos(e)}function HR(e){return e>1?TR:e<-1?-TR:Math.asin(e)}function qR(e,t,n){var r=Vl(e,t-SR,n).concat(t);return function(e){return r.map((function(t){return[e,t]}))}}function XR(e,t,n){var r=Vl(e,t-SR,n).concat(t);return function(e){return r.map((function(t){return[t,e]}))}}function YR(){}const KR=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function JR(){var e=1,t=1,n=a;function r(e,t){return t.map((t=>i(e,t)))}function i(r,i){var a=[],s=[];return function(n,r,i){var a,s,u,l,c,p,d=new Array,h=new Array;for(a=s=-1,l=n[0]>=r,KR[l<<1].forEach(f);++a<e-1;)u=l,l=n[a+1]>=r,KR[u|l<<1].forEach(f);for(KR[l<<0].forEach(f);++s<t-1;){for(a=-1,l=n[s*e+e]>=r,c=n[s*e]>=r,KR[l<<1|c<<2].forEach(f);++a<e-1;)u=l,l=n[s*e+e+a+1]>=r,p=c,c=n[s*e+a+1]>=r,KR[u|l<<1|c<<2|p<<3].forEach(f);KR[l|c<<3].forEach(f)}for(a=-1,c=n[s*e]>=r,KR[c<<2].forEach(f);++a<e-1;)p=c,c=n[s*e+a+1]>=r,KR[c<<2|p<<3].forEach(f);function f(e){var t,n,r=[e[0][0]+a,e[0][1]+s],u=[e[1][0]+a,e[1][1]+s],l=o(r),c=o(u);(t=h[l])?(n=d[c])?(delete h[t.end],delete d[n.start],t===n?(t.ring.push(u),i(t.ring)):d[t.start]=h[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete h[t.end],t.ring.push(u),h[t.end=c]=t):(t=d[c])?(n=h[l])?(delete d[t.start],delete h[n.end],t===n?(t.ring.push(u),i(t.ring)):d[n.start]=h[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete d[t.start],t.ring.unshift(r),d[t.start=l]=t):d[l]=h[c]={start:l,end:c,ring:[r,u]}}KR[c<<3].forEach(f)}(r,i,(e=>{n(e,r,i),function(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}(e)>0?a.push([e]):s.push(e)})),s.forEach((e=>{for(var t,n=0,r=a.length;n<r;++n)if(-1!==ZR((t=a[n])[0],e))return void t.push(e)})),{type:"MultiPolygon",value:i,coordinates:a}}function o(t){return 2*t[0]+t[1]*(e+1)*4}function a(n,r,i){n.forEach((n=>{var o,a=n[0],s=n[1],u=0|a,l=0|s,c=r[l*e+u];a>0&&a<e&&u===a&&(o=r[l*e+u-1],n[0]=a+(i-o)/(c-o)-.5),s>0&&s<t&&l===s&&(o=r[(l-1)*e+u],n[1]=s+(i-o)/(c-o)-.5)}))}return r.contour=i,r.size=function(n){if(!arguments.length)return[e,t];var i=Math.floor(n[0]),o=Math.floor(n[1]);return i>=0&&o>=0||Vt("invalid size"),e=i,t=o,r},r.smooth=function(e){return arguments.length?(n=e?a:YR,r):n===a},r}function ZR(e,t){for(var n,r=-1,i=t.length;++r<i;)if(n=QR(e,t[r]))return n;return 0}function QR(e,t){for(var n=t[0],r=t[1],i=-1,o=0,a=e.length,s=a-1;o<a;s=o++){var u=e[o],l=u[0],c=u[1],p=e[s],d=p[0],h=p[1];if(eN(u,p,t))return 0;c>r!=h>r&&n<(d-l)*(r-c)/(h-c)+l&&(i=-i)}return i}function eN(e,t,n){var r,i,o,a;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&(i=e[r=+(e[0]===t[0])],o=n[r],a=t[r],i<=o&&o<=a||a<=o&&o<=i)}function tN(e,t,n){return function(r){var i=Bn(r),o=n?Math.min(i[0],0):i[0],a=i[1],s=a-o,u=t?eE(o,a,e):s/(e+1);return Vl(o+u,a,u)}}function nN(e){Gu.call(this,null,e)}function rN(e,t,n,r,i){const o=e.x1||0,a=e.y1||0,s=t*n<0;function u(e){e.forEach(l)}function l(e){s&&e.reverse(),e.forEach(c)}function c(e){e[0]=(e[0]-o)*t+r,e[1]=(e[1]-a)*n+i}return function(e){return e.coordinates.forEach(u),e}}function iN(e,t,n){const r=e>=0?e:il(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function oN(e){return Mn(e)?e:Nn(+e)}function aN(){var e=e=>e[0],t=e=>e[1],n=Jt,r=[-1,-1],i=960,o=500,a=2;function s(s,u){const l=iN(r[0],s,e)>>a,c=iN(r[1],s,t)>>a,p=l?l+2:0,d=c?c+2:0,h=2*p+(i>>a),f=2*d+(o>>a),g=new Float32Array(h*f),m=new Float32Array(h*f);let y=g;s.forEach((r=>{const i=p+(+e(r)>>a),o=d+(+t(r)>>a);i>=0&&i<h&&o>=0&&o<f&&(g[i+o*h]+=+n(r))})),l>0&&c>0?(sN(h,f,g,m,l),uN(h,f,m,g,c),sN(h,f,g,m,l),uN(h,f,m,g,c),sN(h,f,g,m,l),uN(h,f,m,g,c)):l>0?(sN(h,f,g,m,l),sN(h,f,m,g,l),sN(h,f,g,m,l),y=m):c>0&&(uN(h,f,g,m,c),uN(h,f,m,g,c),uN(h,f,g,m,c),y=m);const b=u?Math.pow(2,-2*a):1/yM(y);for(let e=0,t=h*f;e<t;++e)y[e]*=b;return{values:y,scale:1<<a,width:h,height:f,x1:p,y1:d,x2:p+(i>>a),y2:d+(o>>a)}}return s.x=function(t){return arguments.length?(e=oN(t),s):e},s.y=function(e){return arguments.length?(t=oN(e),s):t},s.weight=function(e){return arguments.length?(n=oN(e),s):n},s.size=function(e){if(!arguments.length)return[i,o];var t=+e[0],n=+e[1];return t>=0&&n>=0||Vt("invalid size"),i=t,o=n,s},s.cellSize=function(e){return arguments.length?((e=+e)>=1||Vt("invalid cell size"),a=Math.floor(Math.log(e)/Math.LN2),s):1<<a},s.bandwidth=function(e){return arguments.length?(1===(e=Cn(e)).length&&(e=[+e[0],+e[0]]),2!==e.length&&Vt("invalid bandwidth"),r=e,s):r},s}function sN(e,t,n,r,i){const o=1+(i<<1);for(let a=0;a<t;++a)for(let t=0,s=0;t<e+i;++t)t<e&&(s+=n[t+a*e]),t>=i&&(t>=o&&(s-=n[t-o+a*e]),r[t-i+a*e]=s/Math.min(t+1,e-1+o-t,o))}function uN(e,t,n,r,i){const o=1+(i<<1);for(let a=0;a<e;++a)for(let s=0,u=0;s<t+i;++s)s<t&&(u+=n[a+s*e]),s>=i&&(s>=o&&(u-=n[a+(s-o)*e]),r[a+(s-i)*e]=u/Math.min(s+1,t-1+o-s,o))}function lN(e){Gu.call(this,null,e)}nN.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},jn(nN,Gu,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||Yt,o=JR().smooth(!1!==e.smooth),a=e.thresholds||function(e,t,n){const r=tN(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(e.map((e=>Bl(t(e).values))))}(r,i,e),s=null===e.as?null:e.as||"contour",u=[];return r.forEach((t=>{const n=i(t),r=o.size([n.width,n.height])(n.values,sn(a)?a:a(n.values));!function(e,t,n,r){let i=r.scale||t.scale,o=r.translate||t.translate;if(Mn(i)&&(i=i(n,r)),Mn(o)&&(o=o(n,r)),(1===i||null==i)&&!o)return;const a=(Wn(i)?i:i[0])||1,s=(Wn(i)?i:i[1])||1,u=o&&o[0]||0,l=o&&o[1]||0;e.forEach(rN(t,a,s,u,l))}(r,n,t,e),r.forEach((e=>{u.push(fu(t,du(null!=s?{[s]:e}:e)))}))})),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}}),lN.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const cN=["x","y","weight","size","cellSize","bandwidth"];function pN(e,t){return cN.forEach((n=>null!=t[n]?e[n](t[n]):0)),e}function dN(e){Gu.call(this,null,e)}jn(lN,Gu,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=function(e,t){var n,r,i,o,a,s,u=[],l=e=>e(o);if(null==t)u.push(e);else for(n={},r=0,i=e.length;r<i;++r)o=e[r],(s=n[a=t.map(l)])||(n[a]=s=[],s.dims=a,u.push(s)),s.push(o);return u}(t.materialize(t.SOURCE).source,e.groupby),o=(e.groupby||[]).map(zt),a=pN(aN(),e),s=e.as||"grid";return n=i.map((t=>du(function(e,t){for(let n=0;n<o.length;++n)e[o[n]]=t[n];return e}({[s]:a(t,e.counts)},t.dims)))),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),dN.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},jn(dN,Gu,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,r,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),o=JR().smooth(!1!==e.smooth),a=e.values,s=e.thresholds||tN(e.count||10,e.nice,!!a),u=e.size;return a||(a=t.materialize(t.SOURCE).source,r=rN(n=pN(aN(),e)(a,!0),n.scale||1,n.scale||1,0,0),u=[n.width,n.height],a=n.values),s=sn(s)?s:s(a),a=o.size(u)(a,s),r&&a.forEach(r),this.value&&(i.rem=this.value),this.value=i.source=i.add=(a||[]).map(du),i}});const hN="Feature",fN="FeatureCollection";function gN(e){Gu.call(this,null,e)}function mN(e){Gu.call(this,null,e)}function yN(e){Gu.call(this,null,e)}function bN(e){Gu.call(this,null,e)}function vN(e){Gu.call(this,[],e),this.generator=function(){var e,t,n,r,i,o,a,s,u,l,c,p,d=10,h=d,f=90,g=360,m=2.5;function y(){return{type:"MultiLineString",coordinates:b()}}function b(){return Vl(BR(r/f)*f,n,f).map(c).concat(Vl(BR(s/g)*g,a,g).map(p)).concat(Vl(BR(t/d)*d,e,d).filter((function(e){return RR(e%f)>SR})).map(u)).concat(Vl(BR(o/h)*h,i,h).filter((function(e){return RR(e%g)>SR})).map(l))}return y.lines=function(){return b().map((function(e){return{type:"LineString",coordinates:e}}))},y.outline=function(){return{type:"Polygon",coordinates:[c(r).concat(p(a).slice(1),c(n).reverse().slice(1),p(s).reverse().slice(1))]}},y.extent=function(e){return arguments.length?y.extentMajor(e).extentMinor(e):y.extentMinor()},y.extentMajor=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],s=+e[0][1],a=+e[1][1],r>n&&(e=r,r=n,n=e),s>a&&(e=s,s=a,a=e),y.precision(m)):[[r,s],[n,a]]},y.extentMinor=function(n){return arguments.length?(t=+n[0][0],e=+n[1][0],o=+n[0][1],i=+n[1][1],t>e&&(n=t,t=e,e=n),o>i&&(n=o,o=i,i=n),y.precision(m)):[[t,o],[e,i]]},y.step=function(e){return arguments.length?y.stepMajor(e).stepMinor(e):y.stepMinor()},y.stepMajor=function(e){return arguments.length?(f=+e[0],g=+e[1],y):[f,g]},y.stepMinor=function(e){return arguments.length?(d=+e[0],h=+e[1],y):[d,h]},y.precision=function(d){return arguments.length?(m=+d,u=qR(o,i,90),l=XR(t,e,m),c=qR(s,a,90),p=XR(r,n,m),y):m},y.extentMajor([[-180,-90+SR],[180,90-SR]]).extentMinor([[-180,-80-SR],[180,80+SR]])}()}function xN(e){Gu.call(this,null,e)}function _N(e){if(!Mn(e))return!1;const t=er(jt(e));return t.$x||t.$y||t.$value||t.$max}function wN(e){Gu.call(this,null,e),this.modified(!0)}function kN(e,t,n){Mn(e[t])&&e[t](n)}function SN(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o,a,s,u,l,c,p,d,h=e._root,f={data:r},g=e._x0,m=e._y0,y=e._x1,b=e._y1;if(!h)return e._root=f,e;for(;h.length;)if((l=t>=(o=(g+y)/2))?g=o:y=o,(c=n>=(a=(m+b)/2))?m=a:b=a,i=h,!(h=h[p=c<<1|l]))return i[p]=f,e;if(s=+e._x.call(null,h.data),u=+e._y.call(null,h.data),t===s&&n===u)return f.next=h,i?i[p]=f:e._root=f,e;do{i=i?i[p]=new Array(4):e._root=new Array(4),(l=t>=(o=(g+y)/2))?g=o:y=o,(c=n>=(a=(m+b)/2))?m=a:b=a}while((p=c<<1|l)==(d=(u>=a)<<1|s>=o));return i[d]=h,i[p]=f,e}function CN(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function MN(e){return e[0]}function TN(e){return e[1]}function EN(e,t,n){var r=new AN(null==t?MN:t,null==n?TN:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function AN(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function FN(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}gN.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},jn(gN,Gu,{transform(e,t){var n,r=this._features,i=this._points,o=e.fields,a=o&&o[0],s=o&&o[1],u=e.geojson||!o&&Yt,l=t.ADD;n=e.modified()||t.changed(t.REM)||t.modified(jt(u))||a&&t.modified(jt(a))||s&&t.modified(jt(s)),this.value&&!n||(l=t.SOURCE,this._features=r=[],this._points=i=[]),u&&t.visit(l,(e=>r.push(u(e)))),a&&s&&(t.visit(l,(e=>{var t=a(e),n=s(e);null!=t&&null!=n&&(t=+t)===t&&(n=+n)===n&&i.push([t,n])})),r=r.concat({type:hN,geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:fN,features:r}}}),mN.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},jn(mN,Gu,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||Yt,o=e.as||"path",a=n.SOURCE;!r||e.modified()?(this.value=r=wR(e.projection),n.materialize().reflow()):a=i===Yt||t.modified(i.fields)?n.ADD_MOD:n.ADD;const s=function(e,t){const n=e.pointRadius();return e.context(null),null!=t&&e.pointRadius(t),n}(r,e.pointRadius);return n.visit(a,(e=>e[o]=r(i(e)))),r.pointRadius(s),n.modifies(o)}}),yN.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},jn(yN,Gu,{transform(e,t){var n,r=e.projection,i=e.fields[0],o=e.fields[1],a=e.as||["x","y"],s=a[0],u=a[1];function l(e){const t=r([i(e),o(e)]);t?(e[s]=t[0],e[u]=t[1]):(e[s]=void 0,e[u]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(n=t.modified(i.fields)||t.modified(o.fields),t.visit(n?t.ADD_MOD:t.ADD,l)),t.modifies(a)}}),bN.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},jn(bN,Gu,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",o=n.ADD;return r&&!e.modified()||(this.value=r=function(e,t,n){const r=null==n?n=>e(t(n)):r=>{var i=e.pointRadius(),o=e.pointRadius(n)(t(r));return e.pointRadius(i),o};return r.context=t=>(e.context(t),r),r}(wR(e.projection),e.field||qt("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,(e=>e[i]=r)),n.modifies(i)}}),vN.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},jn(vN,Gu,{transform(e,t){var n,r=this.value,i=this.generator;if(!r.length||e.modified())for(const t in e)Mn(i[t])&&i[t](e[t]);return n=i(),r.length?t.mod.push(gu(r[0],n)):t.add.push(du(n)),r[0]=n,t}}),xN.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},jn(xN,Gu,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r="shared"===e.resolve,i=e.field||Yt,o=function(e,t){let n;return Mn(e)?(n=n=>e(n,t),n.dep=_N(e)):e?n=Nn(e):(n=e=>e.$value/e.$max||0,n.dep=!0),n}(e.opacity,e),a=function(e,t){let n;return Mn(e)?(n=n=>jM(e(n,t)),n.dep=_N(e)):n=Nn(jM(e||"#888")),n}(e.color,e),s=e.as||"image",u={$x:0,$y:0,$value:0,$max:r?Bl(n.map((e=>Bl(i(e).values)))):0};return n.forEach((e=>{const t=i(e),n=In({},e,u);r||(n.$max=Bl(t.values||[])),e[s]=function(e,t,n,r){const i=e.width,o=e.height,a=e.x1||0,s=e.y1||0,u=e.x2||i,l=e.y2||o,c=e.values,p=c?e=>c[e]:Kt,d=Pd(u-a,l-s),h=d.getContext("2d"),f=h.getImageData(0,0,u-a,l-s),g=f.data;for(let e=s,o=0;e<l;++e){t.$y=e-s;for(let s=a,l=e*i;s<u;++s,o+=4){t.$x=s-a,t.$value=p(s+l);const e=n(t);g[o+0]=e.r,g[o+1]=e.g,g[o+2]=e.b,g[o+3]=~~(255*r(t))}}return h.putImageData(f,0,0),d}(t,n,a.dep?a:Nn(a(n)),o.dep?o:Nn(o(n)))})),t.reflow(!0).modifies(s)}}),jn(wN,Gu,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=function(e){const t=_R((e||"mercator").toLowerCase());return t||Vt("Unrecognized projection type: "+e),t()}(e.type),xR.forEach((t=>{null!=e[t]&&kN(n,t,e[t])}))):xR.forEach((t=>{e.modified(t)&&kN(n,t,e[t])})),null!=e.pointRadius&&n.path.pointRadius(e.pointRadius),e.fit&&function(e,t){const n=function(e){return 1===(e=Cn(e)).length?e[0]:{type:fN,features:e.reduce(((e,t)=>e.concat(function(e){return e.type===fN?e.features:Cn(e).filter((e=>null!=e)).map((e=>e.type===hN?e:{type:hN,geometry:e}))}(t))),[])}}(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});var ON=EN.prototype=AN.prototype;function RN(e){return function(){return e}}function NN(e){return 1e-6*(e()-.5)}function DN(e){return e.x+e.vx}function IN(e){return e.y+e.vy}ON.copy=function(){var e,t,n=new AN(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=FN(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var i=0;i<4;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=new Array(4)}):r.target[i]=FN(t));return n},ON.add=function(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return SN(this.cover(t,n),t,n,e)},ON.addAll=function(e){var t,n,r,i,o=e.length,a=new Array(o),s=new Array(o),u=1/0,l=1/0,c=-1/0,p=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t))||(a[n]=r,s[n]=i,r<u&&(u=r),r>c&&(c=r),i<l&&(l=i),i>p&&(p=i));if(u>c||l>p)return this;for(this.cover(u,l).cover(c,p),n=0;n<o;++n)SN(this,a[n],s[n],e[n]);return this},ON.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var a,s,u=i-n||1,l=this._root;n>e||e>=i||r>t||t>=o;)switch(s=(t<r)<<1|e<n,(a=new Array(4))[s]=l,l=a,u*=2,s){case 0:i=n+u,o=r+u;break;case 1:n=i-u,o=r+u;break;case 2:i=n+u,r=o-u;break;case 3:n=i-u,r=o-u}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},ON.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},ON.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},ON.find=function(e,t,n){var r,i,o,a,s,u,l,c=this._x0,p=this._y0,d=this._x1,h=this._y1,f=[],g=this._root;for(g&&f.push(new CN(g,c,p,d,h)),null==n?n=1/0:(c=e-n,p=t-n,d=e+n,h=t+n,n*=n);u=f.pop();)if(!(!(g=u.node)||(i=u.x0)>d||(o=u.y0)>h||(a=u.x1)<c||(s=u.y1)<p))if(g.length){var m=(i+a)/2,y=(o+s)/2;f.push(new CN(g[3],m,y,a,s),new CN(g[2],i,y,m,s),new CN(g[1],m,o,a,y),new CN(g[0],i,o,m,y)),(l=(t>=y)<<1|e>=m)&&(u=f[f.length-1],f[f.length-1]=f[f.length-1-l],f[f.length-1-l]=u)}else{var b=e-+this._x.call(null,g.data),v=t-+this._y.call(null,g.data),x=b*b+v*v;if(x<n){var _=Math.sqrt(n=x);c=e-_,p=t-_,d=e+_,h=t+_,r=g.data}}return r},ON.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(a=+this._y.call(null,e)))return this;var t,n,r,i,o,a,s,u,l,c,p,d,h=this._root,f=this._x0,g=this._y0,m=this._x1,y=this._y1;if(!h)return this;if(h.length)for(;;){if((l=o>=(s=(f+m)/2))?f=s:m=s,(c=a>=(u=(g+y)/2))?g=u:y=u,t=h,!(h=h[p=c<<1|l]))return this;if(!h.length)break;(t[p+1&3]||t[p+2&3]||t[p+3&3])&&(n=t,d=p)}for(;h.data!==e;)if(r=h,!(h=h.next))return this;return(i=h.next)&&delete h.next,r?(i?r.next=i:delete r.next,this):t?(i?t[p]=i:delete t[p],(h=t[0]||t[1]||t[2]||t[3])&&h===(t[3]||t[2]||t[1]||t[0])&&!h.length&&(n?n[d]=h:this._root=h),this):(this._root=i,this)},ON.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},ON.root=function(){return this._root},ON.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},ON.visit=function(e){var t,n,r,i,o,a,s=[],u=this._root;for(u&&s.push(new CN(u,this._x0,this._y0,this._x1,this._y1));t=s.pop();)if(!e(u=t.node,r=t.x0,i=t.y0,o=t.x1,a=t.y1)&&u.length){var l=(r+o)/2,c=(i+a)/2;(n=u[3])&&s.push(new CN(n,l,c,o,a)),(n=u[2])&&s.push(new CN(n,r,c,l,a)),(n=u[1])&&s.push(new CN(n,l,i,o,c)),(n=u[0])&&s.push(new CN(n,r,i,l,c))}return this},ON.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new CN(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var i=t.node;if(i.length){var o,a=t.x0,s=t.y0,u=t.x1,l=t.y1,c=(a+u)/2,p=(s+l)/2;(o=i[0])&&n.push(new CN(o,a,s,c,p)),(o=i[1])&&n.push(new CN(o,c,s,u,p)),(o=i[2])&&n.push(new CN(o,a,p,c,l)),(o=i[3])&&n.push(new CN(o,c,p,u,l))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},ON.x=function(e){return arguments.length?(this._x=e,this):this._x},ON.y=function(e){return arguments.length?(this._y=e,this):this._y};var BN={value:()=>{}};function LN(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new PN(r)}function PN(e){this._=e}function $N(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function zN(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=BN,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}PN.prototype=LN.prototype={constructor:PN,on:function(e,t){var n,r,i=this._,o=(r=i,(e+"").trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!r.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}}))),a=-1,s=o.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++a<s;)if(n=(e=o[a]).type)i[n]=zN(i[n],e.name,t);else if(null==t)for(n in i)i[n]=zN(i[n],e.name,null);return this}for(;++a<s;)if((n=(e=o[a]).type)&&(n=$N(i[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new PN(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(r=this._[e]).length;o<n;++o)r[o].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};const jN=LN;var GN,UN,WN=0,VN=0,HN=0,qN=1e3,XN=0,YN=0,KN=0,JN="object"==typeof performance&&performance.now?performance:Date,ZN="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function QN(){return YN||(ZN(eD),YN=JN.now()+KN)}function eD(){YN=0}function tD(){this._call=this._time=this._next=null}function nD(e,t,n){var r=new tD;return r.restart(e,t,n),r}function rD(){YN=(XN=JN.now())+KN,WN=VN=0;try{!function(){QN(),++WN;for(var e,t=GN;t;)(e=YN-t._time)>=0&&t._call.call(null,e),t=t._next;--WN}()}finally{WN=0,function(){for(var e,t,n=GN,r=1/0;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:GN=t);UN=e,oD(r)}(),YN=0}}function iD(){var e=JN.now(),t=e-XN;t>qN&&(KN-=t,XN=e)}function oD(e){WN||(VN&&(VN=clearTimeout(VN)),e-YN>24?(e<1/0&&(VN=setTimeout(rD,e-JN.now()-KN)),HN&&(HN=clearInterval(HN))):(HN||(XN=JN.now(),HN=setInterval(iD,qN)),WN=1,ZN(rD)))}tD.prototype=nD.prototype={constructor:tD,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?QN():+n)+(null==t?0:+t),this._next||UN===this||(UN?UN._next=this:GN=this,UN=this),this._call=e,this._time=n,oD()},stop:function(){this._call&&(this._call=null,this._time=1/0,oD())}};const aD=4294967296;function sD(e){return e.x}function uD(e){return e.y}var lD=Math.PI*(3-Math.sqrt(5));function cD(e){return e.index}function pD(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}const dD={center:function(e,t){var n,r=1;function i(){var i,o,a=n.length,s=0,u=0;for(i=0;i<a;++i)s+=(o=n[i]).x,u+=o.y;for(s=(s/a-e)*r,u=(u/a-t)*r,i=0;i<a;++i)(o=n[i]).x-=s,o.y-=u}return null==e&&(e=0),null==t&&(t=0),i.initialize=function(e){n=e},i.x=function(t){return arguments.length?(e=+t,i):e},i.y=function(e){return arguments.length?(t=+e,i):t},i.strength=function(e){return arguments.length?(r=+e,i):r},i},collide:function(e){var t,n,r,i=1,o=1;function a(){for(var e,a,u,l,c,p,d,h=t.length,f=0;f<o;++f)for(a=EN(t,DN,IN).visitAfter(s),e=0;e<h;++e)u=t[e],p=n[u.index],d=p*p,l=u.x+u.vx,c=u.y+u.vy,a.visit(g);function g(e,t,n,o,a){var s=e.data,h=e.r,f=p+h;if(!s)return t>l+f||o<l-f||n>c+f||a<c-f;if(s.index>u.index){var g=l-s.x-s.vx,m=c-s.y-s.vy,y=g*g+m*m;y<f*f&&(0===g&&(y+=(g=NN(r))*g),0===m&&(y+=(m=NN(r))*m),y=(f-(y=Math.sqrt(y)))/y*i,u.vx+=(g*=y)*(f=(h*=h)/(d+h)),u.vy+=(m*=y)*f,s.vx-=g*(f=1-f),s.vy-=m*f)}}}function s(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function u(){if(t){var r,i,o=t.length;for(n=new Array(o),r=0;r<o;++r)i=t[r],n[i.index]=+e(i,r,t)}}return"function"!=typeof e&&(e=RN(null==e?1:+e)),a.initialize=function(e,n){t=e,r=n,u()},a.iterations=function(e){return arguments.length?(o=+e,a):o},a.strength=function(e){return arguments.length?(i=+e,a):i},a.radius=function(t){return arguments.length?(e="function"==typeof t?t:RN(+t),u(),a):e},a},nbody:function(){var e,t,n,r,i,o=RN(-30),a=1,s=1/0,u=.81;function l(n){var i,o=e.length,a=EN(e,sD,uD).visitAfter(p);for(r=n,i=0;i<o;++i)t=e[i],a.visit(d)}function c(){if(e){var t,n,r=e.length;for(i=new Array(r),t=0;t<r;++t)n=e[t],i[n.index]=+o(n,t,e)}}function p(e){var t,n,r,o,a,s=0,u=0;if(e.length){for(r=o=a=0;a<4;++a)(t=e[a])&&(n=Math.abs(t.value))&&(s+=t.value,u+=n,r+=n*t.x,o+=n*t.y);e.x=r/u,e.y=o/u}else{(t=e).x=t.data.x,t.y=t.data.y;do{s+=i[t.data.index]}while(t=t.next)}e.value=s}function d(e,o,l,c){if(!e.value)return!0;var p=e.x-t.x,d=e.y-t.y,h=c-o,f=p*p+d*d;if(h*h/u<f)return f<s&&(0===p&&(f+=(p=NN(n))*p),0===d&&(f+=(d=NN(n))*d),f<a&&(f=Math.sqrt(a*f)),t.vx+=p*e.value*r/f,t.vy+=d*e.value*r/f),!0;if(!(e.length||f>=s)){(e.data!==t||e.next)&&(0===p&&(f+=(p=NN(n))*p),0===d&&(f+=(d=NN(n))*d),f<a&&(f=Math.sqrt(a*f)));do{e.data!==t&&(h=i[e.data.index]*r/f,t.vx+=p*h,t.vy+=d*h)}while(e=e.next)}}return l.initialize=function(t,r){e=t,n=r,c()},l.strength=function(e){return arguments.length?(o="function"==typeof e?e:RN(+e),c(),l):o},l.distanceMin=function(e){return arguments.length?(a=e*e,l):Math.sqrt(a)},l.distanceMax=function(e){return arguments.length?(s=e*e,l):Math.sqrt(s)},l.theta=function(e){return arguments.length?(u=e*e,l):Math.sqrt(u)},l},link:function(e){var t,n,r,i,o,a,s=cD,u=function(e){return 1/Math.min(i[e.source.index],i[e.target.index])},l=RN(30),c=1;function p(r){for(var i=0,s=e.length;i<c;++i)for(var u,l,p,d,h,f,g,m=0;m<s;++m)l=(u=e[m]).source,d=(p=u.target).x+p.vx-l.x-l.vx||NN(a),h=p.y+p.vy-l.y-l.vy||NN(a),d*=f=((f=Math.sqrt(d*d+h*h))-n[m])/f*r*t[m],h*=f,p.vx-=d*(g=o[m]),p.vy-=h*g,l.vx+=d*(g=1-g),l.vy+=h*g}function d(){if(r){var a,u,l=r.length,c=e.length,p=new Map(r.map(((e,t)=>[s(e,t,r),e])));for(a=0,i=new Array(l);a<c;++a)(u=e[a]).index=a,"object"!=typeof u.source&&(u.source=pD(p,u.source)),"object"!=typeof u.target&&(u.target=pD(p,u.target)),i[u.source.index]=(i[u.source.index]||0)+1,i[u.target.index]=(i[u.target.index]||0)+1;for(a=0,o=new Array(c);a<c;++a)u=e[a],o[a]=i[u.source.index]/(i[u.source.index]+i[u.target.index]);t=new Array(c),h(),n=new Array(c),f()}}function h(){if(r)for(var n=0,i=e.length;n<i;++n)t[n]=+u(e[n],n,e)}function f(){if(r)for(var t=0,i=e.length;t<i;++t)n[t]=+l(e[t],t,e)}return null==e&&(e=[]),p.initialize=function(e,t){r=e,a=t,d()},p.links=function(t){return arguments.length?(e=t,d(),p):e},p.id=function(e){return arguments.length?(s=e,p):s},p.iterations=function(e){return arguments.length?(c=+e,p):c},p.strength=function(e){return arguments.length?(u="function"==typeof e?e:RN(+e),h(),p):u},p.distance=function(e){return arguments.length?(l="function"==typeof e?e:RN(+e),f(),p):l},p},x:function(e){var t,n,r,i=RN(.1);function o(e){for(var i,o=0,a=t.length;o<a;++o)(i=t[o]).vx+=(r[o]-i.x)*n[o]*e}function a(){if(t){var o,a=t.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+e(t[o],o,t))?0:+i(t[o],o,t)}}return"function"!=typeof e&&(e=RN(null==e?0:+e)),o.initialize=function(e){t=e,a()},o.strength=function(e){return arguments.length?(i="function"==typeof e?e:RN(+e),a(),o):i},o.x=function(t){return arguments.length?(e="function"==typeof t?t:RN(+t),a(),o):e},o},y:function(e){var t,n,r,i=RN(.1);function o(e){for(var i,o=0,a=t.length;o<a;++o)(i=t[o]).vy+=(r[o]-i.y)*n[o]*e}function a(){if(t){var o,a=t.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+e(t[o],o,t))?0:+i(t[o],o,t)}}return"function"!=typeof e&&(e=RN(null==e?0:+e)),o.initialize=function(e){t=e,a()},o.strength=function(e){return arguments.length?(i="function"==typeof e?e:RN(+e),a(),o):i},o.y=function(t){return arguments.length?(e="function"==typeof t?t:RN(+t),a(),o):e},o}},hD="forces",fD=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],gD=["static","iterations"],mD=["x","y","vx","vy"];function yD(e){Gu.call(this,null,e)}function bD(e,t,n,r){var i,o,a,s,u=Cn(t.forces);for(i=0,o=fD.length;i<o;++i)(a=fD[i])!==hD&&t.modified(a)&&e[a](t[a]);for(i=0,o=u.length;i<o;++i)s=hD+i,(a=n||t.modified(hD,i)?xD(u[i]):r&&vD(u[i],r)?e.force(s):null)&&e.force(s,a);for(o=e.numForces||0;i<o;++i)e.force(hD+i,null);return e.numForces=u.length,e}function vD(e,t){var n,r;for(n in e)if(Mn(r=e[n])&&t.modified(jt(r)))return 1;return 0}function xD(e){var t,n;for(n in Pn(dD,e.force)||Vt("Unrecognized force: "+e.force),t=dD[e.force](),e)Mn(t[n])&&_D(t[n],e[n],e);return t}function _D(e,t,n){e(Mn(t)?e=>t(e,n):t)}function wD(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}function kD(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=CD)):void 0===t&&(t=SD);for(var n,r,i,o,a,s=new ED(e),u=[s];n=u.pop();)if((i=t(n.data))&&(a=(i=Array.from(i)).length))for(n.children=i,o=a-1;o>=0;--o)u.push(r=i[o]=new ED(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(TD)}function SD(e){return e.children}function CD(e){return Array.isArray(e)?e[1]:null}function MD(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function TD(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function ED(e){this.data=e,this.depth=this.height=0,this.parent=null}function AD(e,t){var n,r;if(RD(t,e))return[t];for(n=0;n<e.length;++n)if(FD(t,e[n])&&RD(DD(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(FD(DD(e[n],e[r]),t)&&FD(DD(e[n],t),e[r])&&FD(DD(e[r],t),e[n])&&RD(ID(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function FD(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function OD(e,t){var n=e.r-t.r+1e-9*Math.max(e.r,t.r,1),r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function RD(e,t){for(var n=0;n<t.length;++n)if(!OD(e,t[n]))return!1;return!0}function ND(e){switch(e.length){case 1:return{x:(t=e[0]).x,y:t.y,r:t.r};case 2:return DD(e[0],e[1]);case 3:return ID(e[0],e[1],e[2])}var t}function DD(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,a=t.y,s=t.r,u=o-n,l=a-r,c=s-i,p=Math.sqrt(u*u+l*l);return{x:(n+o+u/p*c)/2,y:(r+a+l/p*c)/2,r:(p+i+s)/2}}function ID(e,t,n){var r=e.x,i=e.y,o=e.r,a=t.x,s=t.y,u=t.r,l=n.x,c=n.y,p=n.r,d=r-a,h=r-l,f=i-s,g=i-c,m=u-o,y=p-o,b=r*r+i*i-o*o,v=b-a*a-s*s+u*u,x=b-l*l-c*c+p*p,_=h*f-d*g,w=(f*x-g*v)/(2*_)-r,k=(g*m-f*y)/_,S=(h*v-d*x)/(2*_)-i,C=(d*y-h*m)/_,M=k*k+C*C-1,T=2*(o+w*k+S*C),E=w*w+S*S-o*o,A=-(M?(T+Math.sqrt(T*T-4*M*E))/(2*M):E/T);return{x:r+w+k*A,y:i+S+C*A,r:A}}function BD(e,t,n){var r,i,o,a,s=e.x-t.x,u=e.y-t.y,l=s*s+u*u;l?(i=t.r+n.r,i*=i,a=e.r+n.r,i>(a*=a)?(r=(l+a-i)/(2*l),o=Math.sqrt(Math.max(0,a/l-r*r)),n.x=e.x-r*s-o*u,n.y=e.y-r*u+o*s):(r=(l+i-a)/(2*l),o=Math.sqrt(Math.max(0,i/l-r*r)),n.x=t.x+r*s-o*u,n.y=t.y+r*u+o*s)):(n.x=t.x+n.r,n.y=t.y)}function LD(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function PD(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function $D(e){this._=e,this.next=null,this.previous=null}function zD(e){if(!(i=(e=function(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}(e)).length))return 0;var t,n,r,i,o,a,s,u,l,c,p;if((t=e[0]).x=0,t.y=0,!(i>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(i>2))return t.r+n.r;BD(n,t,r=e[2]),t=new $D(t),n=new $D(n),r=new $D(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(s=3;s<i;++s){BD(t._,n._,r=e[s]),r=new $D(r),u=n.next,l=t.previous,c=n._.r,p=t._.r;do{if(c<=p){if(LD(u._,r._)){n=u,t.next=n,n.previous=t,--s;continue e}c+=u._.r,u=u.next}else{if(LD(l._,r._)){(t=l).next=n,n.previous=t,--s;continue e}p+=l._.r,l=l.previous}}while(u!==l.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,o=PD(t);(r=r.next)!==n;)(a=PD(r))<o&&(t=r,o=a);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=function(e){for(var t,n,r=0,i=(e=function(e){for(var t,n,r=e.length;r;)n=Math.random()*r--|0,t=e[r],e[r]=e[n],e[n]=t;return e}(Array.from(e))).length,o=[];r<i;)t=e[r],n&&OD(n,t)?++r:(n=ND(o=AD(o,t)),r=0);return n}(t),s=0;s<i;++s)(t=e[s]).x-=r.x,t.y-=r.y;return r.r}function jD(e){if("function"!=typeof e)throw new Error;return e}function GD(){return 0}function UD(e){return function(){return e}}function WD(e){return Math.sqrt(e.value)}function VD(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function HD(e,t){return function(n){if(r=n.children){var r,i,o,a=r.length,s=e(n)*t||0;if(s)for(i=0;i<a;++i)r[i].r+=s;if(o=zD(r),s)for(i=0;i<a;++i)r[i].r-=s;n.r=o+s}}}function qD(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function XD(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function YD(e,t,n,r,i){for(var o,a=e.children,s=-1,u=a.length,l=e.value&&(r-t)/e.value;++s<u;)(o=a[s]).y0=n,o.y1=i,o.x0=t,o.x1=t+=o.value*l}yD.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:mD}]},jn(yD,Gu,{transform(e,t){var n,r,i=this.value,o=t.changed(t.ADD_REM),a=e.modified(fD),s=e.iterations||300;if(i?(o&&(t.modifies("index"),i.nodes(t.source)),(a||t.changed(t.MOD))&&bD(i,e,0,t)):(this.value=i=function(e,t){const n=function(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,u=nD(p),l=jN("tick","end"),c=function(){let e=1;return()=>(e=(1664525*e+1013904223)%aD)/aD}();function p(){d(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function d(r){var u,l,c=e.length;void 0===r&&(r=1);for(var p=0;p<r;++p)for(n+=(o-n)*i,s.forEach((function(e){e(n)})),u=0;u<c;++u)null==(l=e[u]).fx?l.x+=l.vx*=a:(l.x=l.fx,l.vx=0),null==l.fy?l.y+=l.vy*=a:(l.y=l.fy,l.vy=0);return t}function h(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var i=10*Math.sqrt(.5+n),o=n*lD;t.x=i*Math.cos(o),t.y=i*Math.sin(o)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function f(t){return t.initialize&&t.initialize(e,c),t}return null==e&&(e=[]),h(),t={tick:d,restart:function(){return u.restart(p),t},stop:function(){return u.stop(),t},nodes:function(n){return arguments.length?(e=n,h(),s.forEach(f),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(i=+e,t):+i},alphaTarget:function(e){return arguments.length?(o=+e,t):o},velocityDecay:function(e){return arguments.length?(a=1-e,t):1-a},randomSource:function(e){return arguments.length?(c=e,s.forEach(f),t):c},force:function(e,n){return arguments.length>1?(null==n?s.delete(e):s.set(e,f(n)),t):s.get(e)},find:function(t,n,r){var i,o,a,s,u,l=0,c=e.length;for(null==r?r=1/0:r*=r,l=0;l<c;++l)(a=(i=t-(s=e[l]).x)*i+(o=n-s.y)*o)<r&&(u=s,r=a);return u},on:function(e,n){return arguments.length>1?(l.on(e,n),t):l.on(e)}}}(e),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),bD(n,t,!0).on("end",(()=>o=!0))}(t.source,e),i.on("tick",(n=t.dataflow,r=this,()=>n.touch(r).run())),e.static||(o=!0,i.tick()),t.modifies("index")),a||o||e.modified(gD)||t.changed()&&e.restart)if(i.alpha(Math.max(i.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(i.alphaMin(),1/s)),e.static)for(i.stop();--s>=0;)i.tick();else if(i.stopped()&&i.restart(),!o)return t.StopPropagation;return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let e,t=this._argops,s=0,u=t.length;s<u;++s)if(e=t[s],e.name===hD&&"link"===e.op._argval.force)for(var r,i=e.op._argops,o=0,a=i.length;o<a;++o)if("links"===i[o].name&&(r=i[o].op.source)){n.pulse(r,n.changeset().reflow());break}return t.reflow(e.modified()).modifies(mD)}}),ED.prototype=kD.prototype={constructor:ED,count:function(){return this.eachAfter(wD)},each:function(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this},eachAfter:function(e,t){for(var n,r,i,o=this,a=[o],s=[],u=-1;o=a.pop();)if(s.push(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r]);for(;o=s.pop();)e.call(t,o,++u,this);return this},eachBefore:function(e,t){for(var n,r,i=this,o=[i],a=-1;i=o.pop();)if(e.call(t,i,++a,this),n=i.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r},sum:function(e){return this.eachAfter((function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n}))},sort:function(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e},links:function(){var e=this,t=[];return e.each((function(n){n!==e&&t.push({source:n.parent,target:n})})),t},copy:function(){return kD(this).eachBefore(MD)},[Symbol.iterator]:function*(){var e,t,n,r,i=this,o=[i];do{for(e=o.reverse(),o=[];i=e.pop();)if(yield i,t=i.children)for(n=0,r=t.length;n<r;++n)o.push(t[n])}while(o.length)}};var KD={depth:-1},JD={};function ZD(e){return e.id}function QD(e){return e.parentId}function eI(){var e=ZD,t=QD;function n(n){var r,i,o,a,s,u,l,c=Array.from(n),p=c.length,d=new Map;for(i=0;i<p;++i)r=c[i],s=c[i]=new ED(r),null!=(u=e(r,i,n))&&(u+="")&&(l=s.id=u,d.set(l,d.has(l)?JD:s)),null!=(u=t(r,i,n))&&(u+="")&&(s.parent=u);for(i=0;i<p;++i)if(u=(s=c[i]).parent){if(!(a=d.get(u)))throw new Error("missing: "+u);if(a===JD)throw new Error("ambiguous: "+u);a.children?a.children.push(s):a.children=[s],s.parent=a}else{if(o)throw new Error("multiple roots");o=s}if(!o)throw new Error("no root");if(o.parent=KD,o.eachBefore((function(e){e.depth=e.parent.depth+1,--p})).eachBefore(TD),o.parent=null,p>0)throw new Error("cycle");return o}return n.id=function(t){return arguments.length?(e=jD(t),n):e},n.parentId=function(e){return arguments.length?(t=jD(e),n):t},n}function tI(e,t){return e.parent===t.parent?1:2}function nI(e){var t=e.children;return t?t[0]:e.t}function rI(e){var t=e.children;return t?t[t.length-1]:e.t}function iI(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function oI(e,t,n){return e.a.parent===t.parent?e.a:n}function aI(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function sI(e,t){return e.parent===t.parent?1:2}function uI(e,t){return e+t.x}function lI(e,t){return Math.max(e,t.y)}function cI(e,t,n,r,i){for(var o,a=e.children,s=-1,u=a.length,l=e.value&&(i-n)/e.value;++s<u;)(o=a[s]).x0=t,o.x1=r,o.y0=n,o.y1=n+=o.value*l}aI.prototype=Object.create(ED.prototype);var pI=(1+Math.sqrt(5))/2;function dI(e,t,n,r,i,o){for(var a,s,u,l,c,p,d,h,f,g,m,y=[],b=t.children,v=0,x=0,_=b.length,w=t.value;v<_;){u=i-n,l=o-r;do{c=b[x++].value}while(!c&&x<_);for(p=d=c,m=c*c*(g=Math.max(l/u,u/l)/(w*e)),f=Math.max(d/m,m/p);x<_;++x){if(c+=s=b[x].value,s<p&&(p=s),s>d&&(d=s),m=c*c*g,(h=Math.max(d/m,m/p))>f){c-=s;break}f=h}y.push(a={value:c,dice:u<l,children:b.slice(v,x)}),a.dice?YD(a,n,r,i,w?r+=l*c/w:o):cI(a,n,r,w?n+=u*c/w:i,o),w-=c,v=x}return y}const hI=function e(t){function n(e,n,r,i,o){dI(t,e,n,r,i,o)}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(pI),fI=function e(t){function n(e,n,r,i,o){if((a=e._squarify)&&a.ratio===t)for(var a,s,u,l,c,p=-1,d=a.length,h=e.value;++p<d;){for(u=(s=a[p]).children,l=s.value=0,c=u.length;l<c;++l)s.value+=u[l].value;s.dice?YD(s,n,r,i,h?r+=(o-r)*s.value/h:o):cI(s,n,r,h?n+=(i-n)*s.value/h:i,o),h-=s.value}else e._squarify=a=dI(t,e,n,r,i,o),a.ratio=t}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(pI);function gI(e,t,n){const r={};return e.each((e=>{const i=e.data;n(i)&&(r[t(i)]=e)})),e.lookup=r,e}function mI(e){Gu.call(this,null,e)}mI.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const yI=e=>e.values;function bI(){const e=[],t={entries:e=>r(n(e,0),0),key:n=>(e.push(n),t)};function n(t,r){if(r>=e.length)return t;const i=t.length,o=e[r++],a={},s={};let u,l,c,p=-1;for(;++p<i;)u=o(l=t[p])+"",(c=a[u])?c.push(l):a[u]=[l];for(u in a)s[u]=n(a[u],r);return s}function r(t,n){if(++n>e.length)return t;const i=[];for(const e in t)i.push({key:e,values:r(t[e],n)});return i}return t}function vI(e){Gu.call(this,null,e)}jn(mI,Gu,{transform(e,t){t.source||Vt("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),o=this.value;return(!o||r||t.changed())&&(o&&o.each((e=>{e.children&&lu(e.data)&&i.rem.push(e.data)})),this.value=o=kD({values:Cn(e.keys).reduce(((e,t)=>(e.key(t),e)),bI()).entries(i.source)},yI),n&&o.each((e=>{e.children&&(e=du(e.data),i.add.push(e),i.source.push(e))})),gI(o,cu,cu)),i.source.root=o,i}});const xI=(e,t)=>e.parent===t.parent?1:2;jn(vI,Gu,{transform(e,t){t.source&&t.source.root||Vt(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,o=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(mu(e.sort,(e=>e.data))),function(e,t,n){for(let r,i=0,o=t.length;i<o;++i)r=t[i],r in n&&e[r](n[r])}(n,this.params,e),n.separation&&n.separation(!1!==e.separation?xI:Jt);try{this.value=n(i)}catch(e){Vt(e)}return i.each((e=>function(e,t,n){const r=e.data,i=t.length-1;for(let o=0;o<i;++o)r[n[o]]=e[t[o]];r[n[i]]=e.children?e.children.length:0}(e,r,o))),t.reflow(e.modified()).modifies(o).modifies("leaf")}});const _I=["x","y","r","depth","children"];function wI(e){vI.call(this,e)}wI.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:_I.length,default:_I}]},jn(wI,vI,{layout:function(){var e=null,t=1,n=1,r=GD;function i(i){return i.x=t/2,i.y=n/2,e?i.eachBefore(VD(e)).eachAfter(HD(r,.5)).eachBefore(qD(1)):i.eachBefore(VD(WD)).eachAfter(HD(GD,1)).eachAfter(HD(r,i.r/Math.min(t,n))).eachBefore(qD(Math.min(t,n)/(2*i.r))),i}return i.radius=function(t){return arguments.length?(e=null==(n=t)?null:jD(n),i):e;var n},i.size=function(e){return arguments.length?(t=+e[0],n=+e[1],i):[t,n]},i.padding=function(e){return arguments.length?(r="function"==typeof e?e:UD(+e),i):r},i},params:["radius","size","padding"],fields:_I});const kI=["x0","y0","x1","y1","depth","children"];function SI(e){vI.call(this,e)}function CI(e){Gu.call(this,null,e)}SI.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:kI.length,default:kI}]},jn(SI,vI,{layout:function(){var e=1,t=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=e,i.y1=t/o,i.eachBefore(function(e,t){return function(r){r.children&&YD(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t);var i=r.x0,o=r.y0,a=r.x1-n,s=r.y1-n;a<i&&(i=a=(i+a)/2),s<o&&(o=s=(o+s)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=s}}(t,o)),r&&i.eachBefore(XD),i}return i.round=function(e){return arguments.length?(r=!!e,i):r},i.size=function(n){return arguments.length?(e=+n[0],t=+n[1],i):[e,t]},i.padding=function(e){return arguments.length?(n=+e,i):n},i},params:["size","round","padding"],fields:kI}),CI.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},jn(CI,Gu,{transform(e,t){t.source||Vt("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),o=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?gI(eI().id(e.key).parentId(e.parentKey)(i.source),e.key,Zt):gI(eI()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const MI={tidy:function(){var e=tI,t=1,n=1,r=null;function i(i){var u=function(e){for(var t,n,r,i,o,a=new aI(e,0),s=[a];t=s.pop();)if(r=t._.children)for(t.children=new Array(o=r.length),i=o-1;i>=0;--i)s.push(n=t.children[i]=new aI(r[i],i)),n.parent=t;return(a.parent=new aI(null,0)).children=[a],a}(i);if(u.eachAfter(o),u.parent.m=-u.z,u.eachBefore(a),r)i.eachBefore(s);else{var l=i,c=i,p=i;i.eachBefore((function(e){e.x<l.x&&(l=e),e.x>c.x&&(c=e),e.depth>p.depth&&(p=e)}));var d=l===c?1:e(l,c)/2,h=d-l.x,f=t/(c.x+d+h),g=n/(p.depth||1);i.eachBefore((function(e){e.x=(e.x+h)*f,e.y=e.depth*g}))}return i}function o(t){var n=t.children,r=t.parent.children,i=t.i?r[t.i-1]:null;if(n){!function(e){for(var t,n=0,r=0,i=e.children,o=i.length;--o>=0;)(t=i[o]).z+=n,t.m+=n,n+=t.s+(r+=t.c)}(t);var o=(n[0].z+n[n.length-1].z)/2;i?(t.z=i.z+e(t._,i._),t.m=t.z-o):t.z=o}else i&&(t.z=i.z+e(t._,i._));t.parent.A=function(t,n,r){if(n){for(var i,o=t,a=t,s=n,u=o.parent.children[0],l=o.m,c=a.m,p=s.m,d=u.m;s=rI(s),o=nI(o),s&&o;)u=nI(u),(a=rI(a)).a=t,(i=s.z+p-o.z-l+e(s._,o._))>0&&(iI(oI(s,t,r),t,i),l+=i,c+=i),p+=s.m,l+=o.m,d+=u.m,c+=a.m;s&&!rI(a)&&(a.t=s,a.m+=p-c),o&&!nI(u)&&(u.t=o,u.m+=l-d,r=t)}return r}(t,i,t.parent.A||r[0])}function a(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function s(e){e.x*=t,e.y=e.depth*n}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],i):r?null:[t,n]},i.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],i):r?[t,n]:null},i},cluster:function(){var e=sI,t=1,n=1,r=!1;function i(i){var o,a=0;i.eachAfter((function(t){var n=t.children;n?(t.x=function(e){return e.reduce(uI,0)/e.length}(n),t.y=function(e){return 1+e.reduce(lI,0)}(n)):(t.x=o?a+=e(t,o):0,t.y=0,o=t)}));var s=function(e){for(var t;t=e.children;)e=t[0];return e}(i),u=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(i),l=s.x-e(s,u)/2,c=u.x+e(u,s)/2;return i.eachAfter(r?function(e){e.x=(e.x-i.x)*t,e.y=(i.y-e.y)*n}:function(e){e.x=(e.x-l)/(c-l)*t,e.y=(1-(i.y?e.y/i.y:1))*n})}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],i):r?null:[t,n]},i.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],i):r?[t,n]:null},i}},TI=["x","y","depth","children"];function EI(e){vI.call(this,e)}function AI(e){Gu.call(this,[],e)}EI.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:TI.length,default:TI}]},jn(EI,vI,{layout(e){const t=e||"tidy";if(Pn(MI,t))return MI[t]();Vt("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:TI}),AI.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},jn(AI,Gu,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),o={};return r||Vt("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,(e=>o[cu(e)]=1)),r.each((e=>{const t=e.data,n=e.parent&&e.parent.data;n&&o[cu(t)]&&o[cu(n)]&&i.add.push(du({source:n,target:t}))})),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,(e=>o[cu(e)]=1)),n.forEach((e=>{(o[cu(e.source)]||o[cu(e.target)])&&i.mod.push(e)}))),i}});const FI={binary:function(e,t,n,r,i){var o,a,s=e.children,u=s.length,l=new Array(u+1);for(l[0]=a=o=0;o<u;++o)l[o+1]=a+=s[o].value;!function e(t,n,r,i,o,a,u){if(t>=n-1){var c=s[t];return c.x0=i,c.y0=o,c.x1=a,void(c.y1=u)}for(var p=l[t],d=r/2+p,h=t+1,f=n-1;h<f;){var g=h+f>>>1;l[g]<d?h=g+1:f=g}d-l[h-1]<l[h]-d&&t+1<h&&--h;var m=l[h]-p,y=r-m;if(a-i>u-o){var b=r?(i*y+a*m)/r:a;e(t,h,m,i,o,b,u),e(h,n,y,b,o,a,u)}else{var v=r?(o*y+u*m)/r:u;e(t,h,m,i,o,a,v),e(h,n,y,i,v,a,u)}}(0,u,e.value,t,n,r,i)},dice:YD,slice:cI,slicedice:function(e,t,n,r,i){(1&e.depth?cI:YD)(e,t,n,r,i)},squarify:hI,resquarify:fI},OI=["x0","y0","x1","y1","depth","children"];function RI(e){vI.call(this,e)}RI.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:OI.length,default:OI}]},jn(RI,vI,{layout(){const e=function(){var e=hI,t=!1,n=1,r=1,i=[0],o=GD,a=GD,s=GD,u=GD,l=GD;function c(e){return e.x0=e.y0=0,e.x1=n,e.y1=r,e.eachBefore(p),i=[0],t&&e.eachBefore(XD),e}function p(t){var n=i[t.depth],r=t.x0+n,c=t.y0+n,p=t.x1-n,d=t.y1-n;p<r&&(r=p=(r+p)/2),d<c&&(c=d=(c+d)/2),t.x0=r,t.y0=c,t.x1=p,t.y1=d,t.children&&(n=i[t.depth+1]=o(t)/2,r+=l(t)-n,c+=a(t)-n,(p-=s(t)-n)<r&&(r=p=(r+p)/2),(d-=u(t)-n)<c&&(c=d=(c+d)/2),e(t,r,c,p,d))}return c.round=function(e){return arguments.length?(t=!!e,c):t},c.size=function(e){return arguments.length?(n=+e[0],r=+e[1],c):[n,r]},c.tile=function(t){return arguments.length?(e=jD(t),c):e},c.padding=function(e){return arguments.length?c.paddingInner(e).paddingOuter(e):c.paddingInner()},c.paddingInner=function(e){return arguments.length?(o="function"==typeof e?e:UD(+e),c):o},c.paddingOuter=function(e){return arguments.length?c.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):c.paddingTop()},c.paddingTop=function(e){return arguments.length?(a="function"==typeof e?e:UD(+e),c):a},c.paddingRight=function(e){return arguments.length?(s="function"==typeof e?e:UD(+e),c):s},c.paddingBottom=function(e){return arguments.length?(u="function"==typeof e?e:UD(+e),c):u},c.paddingLeft=function(e){return arguments.length?(l="function"==typeof e?e:UD(+e),c):l},c}();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{Pn(FI,t)?e.tile(FI[t]):Vt("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:OI});const NI=4278190080,DI=268435456,II=.0625;function BI(e,t,n,r){const i=e.width,o=e.height,a=n||r,s=Pd(i,o).getContext("2d");t.forEach((e=>LI(s,e,a)));const u=new Uint32Array(s.getImageData(0,0,i,o).data.buffer),l=e.bitmap(),c=a&&e.bitmap();let p,d,h,f,g;for(d=0;d<o;++d)for(p=0;p<i;++p)g=u[d*i+p]&NI,g&&(h=e(p),f=e(d),r||l.set(h,f),a&&g^DI&&c.set(h,f));return[l,c]}function LI(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;"group"===r?t.forEach((t=>{t.items.forEach((t=>LI(e,t.items,n)))})):Fk[r].draw(e,{items:n?t.map(PI):t})}function PI(e){const t=fu(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=II,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const $I=5,zI=31,jI=32,GI=new Uint32Array(jI+1),UI=new Uint32Array(jI+1);UI[0]=0,GI[0]=~UI[0];for(let e=1;e<=jI;++e)UI[e]=UI[e-1]<<1|1,GI[e]=~UI[e];function WI(e,t,n,r,i,o){let a=n/2;return e-a<0||e+a>i||t-(a=r/2)<0||t+a>o}function VI(e,t,n,r,i,o,a,s){const u=i*o/(2*r),l=e(t-u),c=e(t+u),p=e(n-(o/=2)),d=e(n+o);return a.outOfBounds(l,p,c,d)||a.getRange(l,p,c,d)||s&&s.getRange(l,p,c,d)}const HI=[-1,-1,1,1],qI=[-1,1,-1,1],XI=["right","center","left"],YI=["bottom","middle","top"];function KI(e,t,n,r,i,o,a,s,u,l,c,p){return!(i.outOfBounds(e,n,t,r)||(p&&o?o.getRange(e,n,t,r)||!function(e,t,n,r,i){return i[0]<=e&&n<=i[2]&&i[3]<=t&&r<=i[5]}(a,u,s,l,c):i.getRange(e,n,t,r)))}const JI={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},ZI={naive:function(e,t,n,r){const i=e.width,o=e.height;return function(e){const t=e.datum.datum.items[r].items,n=t.length,a=e.datum.fontSize,s=ck.width(e.datum,e.datum.text);let u,l,c,p,d,h,f,g=0;for(let r=0;r<n;++r)u=t[r].x,c=t[r].y,l=void 0===t[r].x2?u:t[r].x2,p=void 0===t[r].y2?c:t[r].y2,d=(u+l)/2,h=(c+p)/2,f=Math.abs(l-u+p-c),f>=g&&(g=f,e.x=d,e.y=h);return d=s/2,h=a/2,u=e.x-d,l=e.x+d,c=e.y-h,p=e.y+h,e.align="center",u<0&&l<=i?e.align="left":0<=u&&i<l&&(e.align="right"),e.baseline="middle",c<0&&p<=o?e.baseline="top":0<=c&&o<p&&(e.baseline="bottom"),!0}},"reduced-search":function(e,t,n,r){const i=e.width,o=e.height,a=t[0],s=t[1];function u(t,n,r,u,l){const c=e.invert(t),p=e.invert(n);let d,h=r,f=o;if(!WI(c,p,u,l,i,o)&&!VI(e,c,p,l,u,h,a,s)&&!VI(e,c,p,l,u,l,a,null)){for(;f-h>=1;)d=(h+f)/2,VI(e,c,p,l,u,d,a,s)?f=d:h=d;if(h>r)return[c,p,h,!0]}}return function(t){const s=t.datum.datum.items[r].items,l=s.length,c=t.datum.fontSize,p=ck.width(t.datum,t.datum.text);let d,h,f,g,m,y,b,v,x,_,w,k,S,C,M,T,E,A=n?c:0,F=!1,O=!1,R=0;for(let r=0;r<l;++r){for(d=s[r].x,f=s[r].y,h=void 0===s[r].x2?d:s[r].x2,g=void 0===s[r].y2?f:s[r].y2,d>h&&(E=d,d=h,h=E),f>g&&(E=f,f=g,g=E),x=e(d),w=e(h),_=~~((x+w)/2),k=e(f),C=e(g),S=~~((k+C)/2),b=_;b>=x;--b)for(v=S;v>=k;--v)T=u(b,v,A,p,c),T&&([t.x,t.y,A,F]=T);for(b=_;b<=w;++b)for(v=S;v<=C;++v)T=u(b,v,A,p,c),T&&([t.x,t.y,A,F]=T);F||n||(M=Math.abs(h-d+g-f),m=(d+h)/2,y=(f+g)/2,M>=R&&!WI(m,y,p,c,i,o)&&!VI(e,m,y,c,p,c,a,null)&&(R=M,t.x=m,t.y=y,O=!0))}return!(!F&&!O||(m=p/2,y=c/2,a.setRange(e(t.x-m),e(t.y-y),e(t.x+m),e(t.y+y)),t.align="center",t.baseline="middle",0))}},floodfill:function(e,t,n,r){const i=e.width,o=e.height,a=t[0],s=t[1],u=e.bitmap();return function(t){const l=t.datum.datum.items[r].items,c=l.length,p=t.datum.fontSize,d=ck.width(t.datum,t.datum.text),h=[];let f,g,m,y,b,v,x,_,w,k,S,C,M=n?p:0,T=!1,E=!1,A=0;for(let r=0;r<c;++r){for(f=l[r].x,m=l[r].y,g=void 0===l[r].x2?f:l[r].x2,y=void 0===l[r].y2?m:l[r].y2,h.push([e((f+g)/2),e((m+y)/2)]);h.length;)if([x,_]=h.pop(),!(a.get(x,_)||s.get(x,_)||u.get(x,_))){u.set(x,_);for(let e=0;e<4;++e)b=x+HI[e],v=_+qI[e],u.outOfBounds(b,v,b,v)||h.push([b,v]);if(b=e.invert(x),v=e.invert(_),w=M,k=o,!WI(b,v,d,p,i,o)&&!VI(e,b,v,p,d,w,a,s)&&!VI(e,b,v,p,d,p,a,null)){for(;k-w>=1;)S=(w+k)/2,VI(e,b,v,p,d,S,a,s)?k=S:w=S;w>M&&(t.x=b,t.y=v,M=w,T=!0)}}T||n||(C=Math.abs(g-f+y-m),b=(f+g)/2,v=(m+y)/2,C>=A&&!WI(b,v,d,p,i,o)&&!VI(e,b,v,p,d,p,a,null)&&(A=C,t.x=b,t.y=v,E=!0))}return!(!T&&!E||(b=d/2,v=p/2,a.setRange(e(t.x-b),e(t.y-v),e(t.x+b),e(t.y+v)),t.align="center",t.baseline="middle",0))}}};function QI(e,t,n,r,i,o,a,s,u,l,c){if(!e.length)return e;const p=Math.max(r.length,i.length),d=function(e,t){const n=new Float64Array(t),r=e.length;for(let t=0;t<r;++t)n[t]=e[t]||0;for(let e=r;e<t;++e)n[e]=n[r-1];return n}(r,p),h=function(e,t){const n=new Int8Array(t),r=e.length;for(let t=0;t<r;++t)n[t]|=JI[e[t]];for(let e=r;e<t;++e)n[e]=n[r-1];return n}(i,p),f=(x=e[0].datum)&&x.mark&&x.mark.marktype,g="group"===f&&e[0].datum.items[u].marktype,m="area"===g,y=function(e,t,n,r){const i=e=>[e.x,e.x,e.x,e.y,e.y,e.y];return e?"line"===e||"area"===e?e=>i(e.datum):"line"===t?e=>{const t=e.datum.items[r].items;return i(t.length?t["start"===n?0:t.length-1]:{x:NaN,y:NaN})}:e=>{const t=e.datum.bounds;return[t.x1,(t.x1+t.x2)/2,t.x2,t.y1,(t.y1+t.y2)/2,t.y2]}:i}(f,g,s,u),b=function(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),o=~~((t+2*n+r)/r),a=e=>~~((e+n)/r);return a.invert=e=>e*r-n,a.bitmap=()=>function(e,t){const n=new Uint32Array(~~((e*t+jI)/jI));function r(e,t){n[e]|=t}function i(e,t){n[e]&=t}return{array:n,get:(t,r)=>{const i=r*e+t;return n[i>>>$I]&1<<(i&zI)},set:(t,n)=>{const i=n*e+t;r(i>>>$I,1<<(i&zI))},clear:(t,n)=>{const r=n*e+t;i(r>>>$I,~(1<<(r&zI)))},getRange:(t,r,i,o)=>{let a,s,u,l,c=o;for(;c>=r;--c)if(a=c*e+t,s=c*e+i,u=a>>>$I,l=s>>>$I,u===l){if(n[u]&GI[a&zI]&UI[1+(s&zI)])return!0}else{if(n[u]&GI[a&zI])return!0;if(n[l]&UI[1+(s&zI)])return!0;for(let e=u+1;e<l;++e)if(n[e])return!0}return!1},setRange:(t,n,i,o)=>{let a,s,u,l,c;for(;n<=o;++n)if(a=n*e+t,s=n*e+i,u=a>>>$I,l=s>>>$I,u===l)r(u,GI[a&zI]&UI[1+(s&zI)]);else for(r(u,GI[a&zI]),r(l,UI[1+(s&zI)]),c=u+1;c<l;++c)r(c,4294967295)},clearRange:(t,n,r,o)=>{let a,s,u,l,c;for(;n<=o;++n)if(a=n*e+t,s=n*e+r,u=a>>>$I,l=s>>>$I,u===l)i(u,UI[a&zI]|GI[1+(s&zI)]);else for(i(u,UI[a&zI]),i(l,GI[1+(s&zI)]),c=u+1;c<l;++c)i(c,0)},outOfBounds:(n,r,i,o)=>n<0||r<0||o>=t||i>=e}}(i,o),a.ratio=r,a.padding=n,a.width=e,a.height=t,a}(t[0],t[1],l),v=m&&"naive"===c;var x;const _=e.map((e=>({datum:e,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(e)})));let w;if(!v){n&&_.sort(((e,t)=>n(e.datum,t.datum)));let t=!1;for(let e=0;e<h.length&&!t;++e)t=5===h[e]||d[e]<0;f&&(a||m)&&(o=[e.map((e=>e.datum))].concat(o)),w=o.length?BI(b,o,t,m):function(e,t){const n=e.bitmap();return(t||[]).forEach((t=>n.set(e(t.boundary[0]),e(t.boundary[3])))),[n,void 0]}(b,a&&_)}const k=m?ZI[c](b,w,a,u):function(e,t,n,r){const i=e.width,o=e.height,a=t[0],s=t[1],u=r.length;return function(t){const l=t.boundary,c=t.datum.fontSize;if(l[2]<0||l[5]<0||l[0]>i||l[3]>o)return!1;let p,d,h,f,g,m,y,b,v,x,_,w,k,S,C,M=0;for(let i=0;i<u;++i){if(p=(3&n[i])-1,d=(n[i]>>>2&3)-1,h=0===p&&0===d||r[i]<0,f=p&&d?Math.SQRT1_2:1,g=r[i]<0?-1:1,m=l[1+p]+r[i]*p*f,_=l[4+d]+g*c*d/2+r[i]*d*f,b=_-c/2,v=_+c/2,w=e(m),S=e(b),C=e(v),!M){if(!KI(w,w,S,C,a,s,m,m,b,v,l,h))continue;M=ck.width(t.datum,t.datum.text)}if(x=m+g*M*p/2,m=x-M/2,y=x+M/2,w=e(m),k=e(y),KI(w,k,S,C,a,s,m,y,b,v,l,h))return t.x=p?p*g<0?y:m:x,t.y=d?d*g<0?v:b:_,t.align=XI[p*g+1],t.baseline=YI[d*g+1],a.setRange(w,S,k,C),!0}return!1}}(b,w,h,d);return _.forEach((e=>e.opacity=+k(e))),_}const eB=["x","y","opacity","align","baseline"],tB=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function nB(e){Gu.call(this,null,e)}function rB(e,t){var n,r,i,o,a,s,u=[],l=function(e){return e(o)};if(null==t)u.push(e);else for(n={},r=0,i=e.length;r<i;++r)o=e[r],(s=n[a=t.map(l)])||(n[a]=s=[],s.dims=a,u.push(s)),s.push(o);return u}function iB(e){Gu.call(this,null,e)}nB.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:tB},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:eB.length,default:eB}]},jn(nB,Gu,{transform(e,t){const n=e.modified();if(!(n||t.changed(t.ADD_REM)||function(n){const r=e.sort;return Mn(r)&&t.modified(r.fields)}()))return;e.size&&2===e.size.length||Vt("Size parameter should be specified as a [width, height] array.");const r=e.as||eB;return QI(t.materialize(t.SOURCE).source,e.size,e.sort,Cn(e.offset||1),Cn(e.anchor||tB),e.avoidMarks||[],!1!==e.avoidBaseMark,e.lineAnchor||"end",e.markIndex||0,e.padding||0,e.method||"naive").forEach((e=>{const t=e.datum;t[r[0]]=e.x,t[r[1]]=e.y,t[r[2]]=e.opacity,t[r[3]]=e.align,t[r[4]]=e.baseline})),t.reflow(n).modifies(r)}}),iB.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},jn(iB,Gu,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=rB(t.materialize(t.SOURCE).source,e.groupby),i=(e.groupby||[]).map(zt),o=i.length,a=e.as||[zt(e.x),zt(e.y)],s=[];r.forEach((t=>{(function(e,t,n,r){const[i,o,a,s]=Cl(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),p=new Float64Array(u),d=new Float64Array(u).fill(1);for(let e=-1;++e<=2;){const t=[0,l-1];for(let e=0;e<u;++e){const n=i[e],r=t[0],a=t[1],s=n-i[r]>i[a]-n?r:a;let u=0,l=0,h=0,f=0,g=0;const m=1/Math.abs(i[s]-n||1);for(let e=r;e<=a;++e){const t=i[e],r=o[e],a=Ol(Math.abs(n-t)*m)*d[e],s=t*a;u+=a,l+=s,h+=r*a,f+=r*s,g+=t*s}const[y,b]=Sl(l/u,h/u,f/u,g/u);c[e]=y+b*n,p[e]=Math.abs(o[e]-c[e]),Rl(i,e+1,t)}if(2===e)break;const n=el(p);if(Math.abs(n)<1e-12)break;for(let e,t,r=0;r<u;++r)e=p[r]/(6*n),d[r]=e>=1?1e-12:(t=1-e*e)*t}return function(e,t,n,r){const i=e.length,o=[];let a,s=0,u=0,l=[];for(;s<i;++s)a=e[s]+n,l[0]===a?l[1]+=(t[s]-l[1])/++u:(u=0,l[1]+=r,l=[a,t[s]],o.push(l));return l[1]+=r,o}(i,c,a,s)})(t,e.x,e.y,e.bandwidth||.3).forEach((e=>{const n={};for(let e=0;e<o;++e)n[i[e]]=t.dims[e];n[a[0]]=e[0],n[a[1]]=e[1],s.push(du(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=s}return n}});const oB={linear:El,log:function(e,t,n){let r=0,i=0,o=0,a=0,s=0;Ml(e,t,n,((e,t)=>{++s,e=Math.log(e),r+=(e-r)/s,i+=(t-i)/s,o+=(e*t-o)/s,a+=(e*e-a)/s}));const u=Sl(r,i,o,a),l=e=>u[0]+u[1]*Math.log(e);return{coef:u,predict:l,rSquared:Tl(e,t,n,i,l)}},exp:function(e,t,n){const[r,i,o,a]=Cl(e,t,n);let s,u,l,c=0,p=0,d=0,h=0,f=0;Ml(e,t,n,((e,t)=>{s=r[f++],u=Math.log(t),l=s*t,c+=(t*u-c)/f,p+=(l-p)/f,d+=(l*u-d)/f,h+=(s*l-h)/f}));const[g,m]=Sl(p/a,c/a,d/a,h/a),y=e=>Math.exp(g+m*(e-o));return{coef:[Math.exp(g-m*o),m],predict:y,rSquared:Tl(e,t,n,a,y)}},pow:function(e,t,n){let r=0,i=0,o=0,a=0,s=0,u=0;Ml(e,t,n,((e,t)=>{const n=Math.log(e),l=Math.log(t);++u,r+=(n-r)/u,i+=(l-i)/u,o+=(n*l-o)/u,a+=(n*n-a)/u,s+=(t-s)/u}));const l=Sl(r,i,o,a),c=e=>l[0]*Math.pow(e,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:Tl(e,t,n,s,c)}},quad:Al,poly:function(e,t,n,r){if(0===r)return function(e,t,n){let r=0,i=0;for(const o of e){const e=n(o);null==t(o)||null==e||isNaN(e)||(r+=(e-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}(e,t,n);if(1===r)return El(e,t,n);if(2===r)return Al(e,t,n);const[i,o,a,s]=Cl(e,t,n),u=i.length,l=[],c=[],p=r+1;let d,h,f,g,m;for(d=0;d<p;++d){for(f=0,g=0;f<u;++f)g+=Math.pow(i[f],d)*o[f];for(l.push(g),m=new Float64Array(p),h=0;h<p;++h){for(f=0,g=0;f<u;++f)g+=Math.pow(i[f],d+h);m[h]=g}c.push(m)}c.push(l);const y=function(e){const t=e.length-1,n=[];let r,i,o,a,s;for(r=0;r<t;++r){for(a=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][a])&&(a=i);for(o=r;o<t+1;++o)s=e[o][r],e[o][r]=e[o][a],e[o][a]=s;for(i=r+1;i<t;++i)for(o=t;o>=r;o--)e[o][i]-=e[o][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(s=0,o=i+1;o<t;++o)s+=e[o][i]*n[o];n[i]=(e[t][i]-s)/e[i][i]}return n}(c),b=e=>{e-=a;let t=s+y[0]+y[1]*e+y[2]*e*e;for(d=3;d<p;++d)t+=y[d]*Math.pow(e,d);return t};return{coef:Fl(p,y,-a,s),predict:b,rSquared:Tl(e,t,n,s,b)}}};function aB(e){Gu.call(this,null,e)}aB.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(oB)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},jn(aB,Gu,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=rB(t.materialize(t.SOURCE).source,e.groupby),i=(e.groupby||[]).map(zt),o=e.method||"linear",a=e.order||3,s=((e,t)=>"poly"===e?t:"quad"===e?2:1)(o,a),u=e.as||[zt(e.x),zt(e.y)],l=oB[o],c=[];let p=e.extent;Pn(oB,o)||Vt("Invalid regression method: "+o),null!=p&&"log"===o&&p[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),p=null),r.forEach((n=>{if(n.length<=s)return void t.dataflow.warn("Skipping regression with more parameters than data points.");const r=l(n,e.x,e.y,a);if(e.params)return void c.push(du({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));const d=p||Bn(n,e.x),h=e=>{const t={};for(let e=0;e<i.length;++e)t[i[e]]=n.dims[e];t[u[0]]=e[0],t[u[1]]=e[1],c.push(du(t))};"linear"===o?d.forEach((e=>h([e,r.predict(e)]))):Dl(r.predict,d,25,200).forEach(h)})),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});const sB=Math.pow(2,-52),uB=new Uint32Array(512);class lB{static from(e,t=yB,n=bB){const r=e.length,i=new Float64Array(2*r);for(let o=0;o<r;o++){const r=e[o];i[2*o]=t(r),i[2*o+1]=n(r)}return new lB(i)}constructor(e){const t=e.length>>1;if(t>0&&"number"!=typeof e[0])throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*t-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:n,_hullTri:r,_hullHash:i}=this,o=e.length>>1;let a=1/0,s=1/0,u=-1/0,l=-1/0;for(let t=0;t<o;t++){const n=e[2*t],r=e[2*t+1];n<a&&(a=n),r<s&&(s=r),n>u&&(u=n),r>l&&(l=r),this._ids[t]=t}const c=(a+u)/2,p=(s+l)/2;let d,h,f,g=1/0;for(let t=0;t<o;t++){const n=cB(c,p,e[2*t],e[2*t+1]);n<g&&(d=t,g=n)}const m=e[2*d],y=e[2*d+1];g=1/0;for(let t=0;t<o;t++){if(t===d)continue;const n=cB(m,y,e[2*t],e[2*t+1]);n<g&&n>0&&(h=t,g=n)}let b=e[2*h],v=e[2*h+1],x=1/0;for(let t=0;t<o;t++){if(t===d||t===h)continue;const n=fB(m,y,b,v,e[2*t],e[2*t+1]);n<x&&(f=t,x=n)}let _=e[2*f],w=e[2*f+1];if(x===1/0){for(let t=0;t<o;t++)this._dists[t]=e[2*t]-e[0]||e[2*t+1]-e[1];gB(this._ids,this._dists,0,o-1);const t=new Uint32Array(o);let n=0;for(let e=0,r=-1/0;e<o;e++){const i=this._ids[e];this._dists[i]>r&&(t[n++]=i,r=this._dists[i])}return this.hull=t.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(dB(m,y,b,v,_,w)){const e=h,t=b,n=v;h=f,b=_,v=w,f=e,_=t,w=n}const k=function(e,t,n,r,i,o){const a=n-e,s=r-t,u=i-e,l=o-t,c=a*a+s*s,p=u*u+l*l,d=.5/(a*l-s*u);return{x:e+(l*c-s*p)*d,y:t+(a*p-u*c)*d}}(m,y,b,v,_,w);this._cx=k.x,this._cy=k.y;for(let t=0;t<o;t++)this._dists[t]=cB(e[2*t],e[2*t+1],k.x,k.y);gB(this._ids,this._dists,0,o-1),this._hullStart=d;let S=3;n[d]=t[f]=h,n[h]=t[d]=f,n[f]=t[h]=d,r[d]=0,r[h]=1,r[f]=2,i.fill(-1),i[this._hashKey(m,y)]=d,i[this._hashKey(b,v)]=h,i[this._hashKey(_,w)]=f,this.trianglesLen=0,this._addTriangle(d,h,f,-1,-1,-1);for(let o,a,s=0;s<this._ids.length;s++){const u=this._ids[s],l=e[2*u],c=e[2*u+1];if(s>0&&Math.abs(l-o)<=sB&&Math.abs(c-a)<=sB)continue;if(o=l,a=c,u===d||u===h||u===f)continue;let p=0;for(let e=0,t=this._hashKey(l,c);e<this._hashSize&&(p=i[(t+e)%this._hashSize],-1===p||p===n[p]);e++);p=t[p];let g,m=p;for(;g=n[m],!dB(l,c,e[2*m],e[2*m+1],e[2*g],e[2*g+1]);)if(m=g,m===p){m=-1;break}if(-1===m)continue;let y=this._addTriangle(m,u,n[m],-1,-1,r[m]);r[u]=this._legalize(y+2),r[m]=y,S++;let b=n[m];for(;g=n[b],dB(l,c,e[2*b],e[2*b+1],e[2*g],e[2*g+1]);)y=this._addTriangle(b,u,g,r[u],-1,r[b]),r[u]=this._legalize(y+2),n[b]=b,S--,b=g;if(m===p)for(;g=t[m],dB(l,c,e[2*g],e[2*g+1],e[2*m],e[2*m+1]);)y=this._addTriangle(g,u,m,-1,r[m],r[g]),this._legalize(y+2),r[g]=y,n[m]=m,S--,m=g;this._hullStart=t[u]=m,n[m]=t[b]=u,n[u]=b,i[this._hashKey(l,c)]=u,i[this._hashKey(e[2*m],e[2*m+1])]=m}this.hull=new Uint32Array(S);for(let e=0,t=this._hullStart;e<S;e++)this.hull[e]=t,t=n[t];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(function(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:n,coords:r}=this;let i=0,o=0;for(;;){const a=n[e],s=e-e%3;if(o=s+(e+2)%3,-1===a){if(0===i)break;e=uB[--i];continue}const u=a-a%3,l=s+(e+1)%3,c=u+(a+2)%3,p=t[o],d=t[e],h=t[l],f=t[c];if(hB(r[2*p],r[2*p+1],r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*f],r[2*f+1])){t[e]=f,t[a]=p;const r=n[c];if(-1===r){let t=this._hullStart;do{if(this._hullTri[t]===c){this._hullTri[t]=e;break}t=this._hullPrev[t]}while(t!==this._hullStart)}this._link(e,r),this._link(a,n[o]),this._link(o,c);const s=u+(a+1)%3;i<uB.length&&(uB[i++]=s)}else{if(0===i)break;e=uB[--i]}}return o}_link(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}_addTriangle(e,t,n,r,i,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=t,this._triangles[a+2]=n,this._link(a,r),this._link(a+1,i),this._link(a+2,o),this.trianglesLen+=3,a}}function cB(e,t,n,r){const i=e-n,o=t-r;return i*i+o*o}function pB(e,t,n,r,i,o){const a=(r-t)*(i-e),s=(n-e)*(o-t);return Math.abs(a-s)>=33306690738754716e-32*Math.abs(a+s)?a-s:0}function dB(e,t,n,r,i,o){return(pB(i,o,e,t,n,r)||pB(e,t,n,r,i,o)||pB(n,r,i,o,e,t))<0}function hB(e,t,n,r,i,o,a,s){const u=e-a,l=t-s,c=n-a,p=r-s,d=i-a,h=o-s,f=c*c+p*p,g=d*d+h*h;return u*(p*g-f*h)-l*(c*g-f*d)+(u*u+l*l)*(c*h-p*d)<0}function fB(e,t,n,r,i,o){const a=n-e,s=r-t,u=i-e,l=o-t,c=a*a+s*s,p=u*u+l*l,d=.5/(a*l-s*u),h=(l*c-s*p)*d,f=(a*p-u*c)*d;return h*h+f*f}function gB(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=e[i],o=t[r];let a=i-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=r}else{let i=n+1,o=r;mB(e,n+r>>1,i),t[e[n]]>t[e[r]]&&mB(e,n,r),t[e[i]]>t[e[r]]&&mB(e,i,r),t[e[n]]>t[e[i]]&&mB(e,n,i);const a=e[i],s=t[a];for(;;){do{i++}while(t[e[i]]<s);do{o--}while(t[e[o]]>s);if(o<i)break;mB(e,i,o)}e[n+1]=e[o],e[o]=a,r-i+1>=o-n?(gB(e,t,i,r),gB(e,t,n,o-1)):(gB(e,t,n,o-1),gB(e,t,i,r))}}function mB(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function yB(e){return e[0]}function bB(e){return e[1]}const vB=1e-6;class xB{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},${this._y1=+t}`}arc(e,t,n){const r=(e=+e)+(n=+n),i=t=+t;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${r},${i}`:(Math.abs(this._x1-r)>vB||Math.abs(this._y1-i)>vB)&&(this._+="L"+r+","+i),n&&(this._+=`A${n},${n},0,1,1,${e-n},${t}A${n},${n},0,1,1,${this._x1=r},${this._y1=i}`)}rect(e,t,n,r){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+n}v${+r}h${-n}Z`}value(){return this._||null}}class _B{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}class wB{constructor(e,[t,n,r,i]=[0,0,960,500]){if(!((r=+r)>=(t=+t)&&(i=+i)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(2*e.points.length),this.vectors=new Float64Array(2*e.points.length),this.xmax=r,this.xmin=t,this.ymax=i,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:n},vectors:r}=this,i=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let t,r,o=0,a=0,s=n.length;o<s;o+=3,a+=2){const s=2*n[o],u=2*n[o+1],l=2*n[o+2],c=e[s],p=e[s+1],d=e[u],h=e[u+1],f=e[l],g=e[l+1],m=d-c,y=h-p,b=f-c,v=g-p,x=m*m+y*y,_=b*b+v*v,w=2*(m*v-y*b);if(w)if(Math.abs(w)<1e-8)t=(c+f)/2,r=(p+g)/2;else{const e=1/w;t=c+(v*x-y*_)*e,r=p+(m*_-b*x)*e}else t=(c+f)/2-1e8*v,r=(p+g)/2+1e8*b;i[a]=t,i[a+1]=r}let o,a,s,u=t[t.length-1],l=4*u,c=e[2*u],p=e[2*u+1];r.fill(0);for(let n=0;n<t.length;++n)u=t[n],o=l,a=c,s=p,l=4*u,c=e[2*u],p=e[2*u+1],r[o+2]=r[l]=s-p,r[o+3]=r[l+1]=c-a}render(e){const t=null==e?e=new xB:void 0,{delaunay:{halfedges:n,inedges:r,hull:i},circumcenters:o,vectors:a}=this;if(i.length<=1)return null;for(let t=0,r=n.length;t<r;++t){const r=n[t];if(r<t)continue;const i=2*Math.floor(t/3),a=2*Math.floor(r/3),s=o[i],u=o[i+1],l=o[a],c=o[a+1];this._renderSegment(s,u,l,c,e)}let s,u=i[i.length-1];for(let t=0;t<i.length;++t){s=u,u=i[t];const n=2*Math.floor(r[u]/3),l=o[n],c=o[n+1],p=4*s,d=this._project(l,c,a[p+2],a[p+3]);d&&this._renderSegment(l,c,d[0],d[1],e)}return t&&t.value()}renderBounds(e){const t=null==e?e=new xB:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const n=null==t?t=new xB:void 0,r=this._clip(e);if(null===r||!r.length)return;t.moveTo(r[0],r[1]);let i=r.length;for(;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(let e=2;e<i;e+=2)r[e]===r[e-2]&&r[e+1]===r[e-1]||t.lineTo(r[e],r[e+1]);return t.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,n=e.length/2;t<n;++t){const e=this.cellPolygon(t);e&&(e.index=t,yield e)}}cellPolygon(e){const t=new _B;return this.renderCell(e,t),t.value()}_renderSegment(e,t,n,r,i){let o;const a=this._regioncode(e,t),s=this._regioncode(n,r);0===a&&0===s?(i.moveTo(e,t),i.lineTo(n,r)):(o=this._clipSegment(e,t,n,r,a,s))&&(i.moveTo(o[0],o[1]),i.lineTo(o[2],o[3]))}contains(e,t,n){return(t=+t)==t&&(n=+n)==n&&this.delaunay._step(e,t,n)===e}*neighbors(e){const t=this._clip(e);if(t)for(const n of this.delaunay.neighbors(e)){const e=this._clip(n);if(e)e:for(let r=0,i=t.length;r<i;r+=2)for(let o=0,a=e.length;o<a;o+=2)if(t[r]==e[o]&&t[r+1]==e[o+1]&&t[(r+2)%i]==e[(o+a-2)%a]&&t[(r+3)%i]==e[(o+a-1)%a]){yield n;break e}}}_cell(e){const{circumcenters:t,delaunay:{inedges:n,halfedges:r,triangles:i}}=this,o=n[e];if(-1===o)return null;const a=[];let s=o;do{const n=Math.floor(s/3);if(a.push(t[2*n],t[2*n+1]),s=s%3==2?s-2:s+1,i[s]!==e)break;s=r[s]}while(s!==o&&-1!==s);return a}_clip(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(null===t)return null;const{vectors:n}=this,r=4*e;return n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t)}_clipFinite(e,t){const n=t.length;let r,i,o,a,s,u=null,l=t[n-2],c=t[n-1],p=this._regioncode(l,c);for(let d=0;d<n;d+=2)if(r=l,i=c,l=t[d],c=t[d+1],o=p,p=this._regioncode(l,c),0===o&&0===p)a=s,s=0,u?u.push(l,c):u=[l,c];else{let t,n,d,h,f;if(0===o){if(null===(t=this._clipSegment(r,i,l,c,o,p)))continue;[n,d,h,f]=t}else{if(null===(t=this._clipSegment(l,c,r,i,p,o)))continue;[h,f,n,d]=t,a=s,s=this._edgecode(n,d),a&&s&&this._edge(e,a,s,u,u.length),u?u.push(n,d):u=[n,d]}a=s,s=this._edgecode(h,f),a&&s&&this._edge(e,a,s,u,u.length),u?u.push(h,f):u=[h,f]}if(u)a=s,s=this._edgecode(u[0],u[1]),a&&s&&this._edge(e,a,s,u,u.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return u}_clipSegment(e,t,n,r,i,o){for(;;){if(0===i&&0===o)return[e,t,n,r];if(i&o)return null;let a,s,u=i||o;8&u?(a=e+(n-e)*(this.ymax-t)/(r-t),s=this.ymax):4&u?(a=e+(n-e)*(this.ymin-t)/(r-t),s=this.ymin):2&u?(s=t+(r-t)*(this.xmax-e)/(n-e),a=this.xmax):(s=t+(r-t)*(this.xmin-e)/(n-e),a=this.xmin),i?(e=a,t=s,i=this._regioncode(e,t)):(n=a,r=s,o=this._regioncode(n,r))}}_clipInfinite(e,t,n,r,i,o){let a,s=Array.from(t);if((a=this._project(s[0],s[1],n,r))&&s.unshift(a[0],a[1]),(a=this._project(s[s.length-2],s[s.length-1],i,o))&&s.push(a[0],a[1]),s=this._clipFinite(e,s))for(let t,n=0,r=s.length,i=this._edgecode(s[r-2],s[r-1]);n<r;n+=2)t=i,i=this._edgecode(s[n],s[n+1]),t&&i&&(n=this._edge(e,t,i,s,n),r=s.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(e,t,n,r,i){for(;t!==n;){let n,o;switch(t){case 5:t=4;continue;case 4:t=6,n=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,n=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,n=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,n=this.xmin,o=this.ymin}r[i]===n&&r[i+1]===o||!this.contains(e,n,o)||(r.splice(i,0,n,o),i+=2)}if(r.length>4)for(let e=0;e<r.length;e+=2){const t=(e+2)%r.length,n=(e+4)%r.length;(r[e]===r[t]&&r[t]===r[n]||r[e+1]===r[t+1]&&r[t+1]===r[n+1])&&(r.splice(t,2),e-=2)}return i}_project(e,t,n,r){let i,o,a,s=1/0;if(r<0){if(t<=this.ymin)return null;(i=(this.ymin-t)/r)<s&&(a=this.ymin,o=e+(s=i)*n)}else if(r>0){if(t>=this.ymax)return null;(i=(this.ymax-t)/r)<s&&(a=this.ymax,o=e+(s=i)*n)}if(n>0){if(e>=this.xmax)return null;(i=(this.xmax-e)/n)<s&&(o=this.xmax,a=t+(s=i)*r)}else if(n<0){if(e<=this.xmin)return null;(i=(this.xmin-e)/n)<s&&(o=this.xmin,a=t+(s=i)*r)}return[o,a]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}}const kB=2*Math.PI,SB=Math.pow;function CB(e){return e[0]}function MB(e){return e[1]}function TB(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class EB{static from(e,t=CB,n=MB,r){return new EB("length"in e?function(e,t,n,r){const i=e.length,o=new Float64Array(2*i);for(let a=0;a<i;++a){const i=e[a];o[2*a]=t.call(r,i,a,e),o[2*a+1]=n.call(r,i,a,e)}return o}(e,t,n,r):Float64Array.from(function*(e,t,n,r){let i=0;for(const o of e)yield t.call(r,o,i,e),yield n.call(r,o,i,e),++i}(e,t,n,r)))}constructor(e){this._delaunator=new lB(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&function(e){const{triangles:t,coords:n}=e;for(let e=0;e<t.length;e+=3){const r=2*t[e],i=2*t[e+1],o=2*t[e+2];if((n[o]-n[r])*(n[i+1]-n[r+1])-(n[i]-n[r])*(n[o+1]-n[r+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:t.length/2},((e,t)=>t)).sort(((e,n)=>t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]));const e=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[t[2*e],t[2*e+1],t[2*n],t[2*n+1]],i=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let e=0,n=t.length/2;e<n;++e){const n=TB(t[2*e],t[2*e+1],i);t[2*e]=n[0],t[2*e+1]=n[1]}this._delaunator=new lB(t)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let e=0,t=n.length;e<t;++e){const t=i[e%3==2?e-2:e+1];-1!==n[e]&&-1!==o[t]||(o[t]=e)}for(let e=0,t=r.length;e<t;++e)a[r[e]]=e;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],o[r[0]]=1,2===r.length&&(o[r[1]]=0))}voronoi(e){return new wB(this,e)}*neighbors(e){const{inedges:t,hull:n,_hullIndex:r,halfedges:i,triangles:o,collinear:a}=this;if(a){const t=a.indexOf(e);return t>0&&(yield a[t-1]),void(t<a.length-1&&(yield a[t+1]))}const s=t[e];if(-1===s)return;let u=s,l=-1;do{if(yield l=o[u],u=u%3==2?u-2:u+1,o[u]!==e)return;if(u=i[u],-1===u){const t=n[(r[e]+1)%n.length];return void(t!==l&&(yield t))}}while(u!==s)}find(e,t,n=0){if((e=+e)!=e||(t=+t)!=t)return-1;const r=n;let i;for(;(i=this._step(n,e,t))>=0&&i!==n&&i!==r;)n=i;return i}_step(e,t,n){const{inedges:r,hull:i,_hullIndex:o,halfedges:a,triangles:s,points:u}=this;if(-1===r[e]||!u.length)return(e+1)%(u.length>>1);let l=e,c=SB(t-u[2*e],2)+SB(n-u[2*e+1],2);const p=r[e];let d=p;do{let r=s[d];const p=SB(t-u[2*r],2)+SB(n-u[2*r+1],2);if(p<c&&(c=p,l=r),d=d%3==2?d-2:d+1,s[d]!==e)break;if(d=a[d],-1===d){if(d=i[(o[e]+1)%i.length],d!==r&&SB(t-u[2*d],2)+SB(n-u[2*d+1],2)<c)return d;break}}while(d!==p);return l}render(e){const t=null==e?e=new xB:void 0,{points:n,halfedges:r,triangles:i}=this;for(let t=0,o=r.length;t<o;++t){const o=r[t];if(o<t)continue;const a=2*i[t],s=2*i[o];e.moveTo(n[a],n[a+1]),e.lineTo(n[s],n[s+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t=2){const n=null==e?e=new xB:void 0,{points:r}=this;for(let n=0,i=r.length;n<i;n+=2){const i=r[n],o=r[n+1];e.moveTo(i+t,o),e.arc(i,o,t,0,kB)}return n&&n.value()}renderHull(e){const t=null==e?e=new xB:void 0,{hull:n,points:r}=this,i=2*n[0],o=n.length;e.moveTo(r[i],r[i+1]);for(let t=1;t<o;++t){const i=2*n[t];e.lineTo(r[i],r[i+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new _B;return this.renderHull(e),e.value()}renderTriangle(e,t){const n=null==t?t=new xB:void 0,{points:r,triangles:i}=this,o=2*i[e*=3],a=2*i[e+1],s=2*i[e+2];return t.moveTo(r[o],r[o+1]),t.lineTo(r[a],r[a+1]),t.lineTo(r[s],r[s+1]),t.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,n=e.length/3;t<n;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new _B;return this.renderTriangle(e,t),t.value()}}function AB(e){Gu.call(this,null,e)}AB.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const FB=[-1e5,-1e5,1e5,1e5];function OB(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}jn(AB,Gu,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:FB;const o=this.value=EB.from(r,e.x,e.y).voronoi(i);for(let e=0,t=r.length;e<t;++e){const t=o.cellPolygon(e);r[e][n]=t?OB(t):null}return t.reflow(e.modified()).modifies(n)}});var RB=Math.PI/180,NB=64,DB=2048;function IB(e,t,n,r){if(!t.sprite){var i=e.context,o=e.ratio;i.clearRect(0,0,(NB<<5)/o,DB/o);var a,s,u,l,c,p=0,d=0,h=0,f=n.length;for(--r;++r<f;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,a=i.measureText(t.text+"m").width*o,u=t.size<<1,t.rotate){var g=Math.sin(t.rotate*RB),m=Math.cos(t.rotate*RB),y=a*m,b=a*g,v=u*m,x=u*g;a=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,u=~~Math.max(Math.abs(b+v),Math.abs(b-v))}else a=a+31>>5<<5;if(u>h&&(h=u),p+a>=NB<<5&&(p=0,d+=h,h=0),d+u>=DB)break;i.translate((p+(a>>1))/o,(d+(u>>1))/o),t.rotate&&i.rotate(t.rotate*RB),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=a,t.height=u,t.xoff=p,t.yoff=d,t.x1=a>>1,t.y1=u>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,p+=a}for(var _=i.getImageData(0,0,(NB<<5)/o,DB/o).data,w=[];--r>=0;)if((t=n[r]).hasText){for(s=(a=t.width)>>5,u=t.y1-t.y0,l=0;l<u*s;l++)w[l]=0;if(null==(p=t.xoff))return;d=t.yoff;var k=0,S=-1;for(c=0;c<u;c++){for(l=0;l<a;l++){var C=s*c+(l>>5),M=_[(d+c)*(NB<<5)+(p+l)<<2]?1<<31-l%32:0;w[C]|=M,k|=M}k?S=c:(t.y0++,u--,c--,d++)}t.y1=t.y0+S,t.sprite=w.slice(0,(t.y1-t.y0)*s)}}}function BB(e,t,n){n>>=5;for(var r,i=e.sprite,o=e.width>>5,a=e.x-(o<<4),s=127&a,u=32-s,l=e.y1-e.y0,c=(e.y+e.y0)*n+(a>>5),p=0;p<l;p++){r=0;for(var d=0;d<=o;d++)if((r<<u|(d<o?(r=i[p*o+d])>>>s:0))&t[c+d])return!0;c+=n}return!1}function LB(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function PB(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function $B(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function zB(e){return"function"==typeof e?e:function(){return e}}var jB={archimedean:$B,rectangular:function(e){var t=4*e[0]/e[1],n=0,r=0;return function(e){var i=e<0?-1:1;switch(Math.sqrt(1+4*i*e)-i&3){case 0:n+=t;break;case 1:r+=4;break;case 2:n-=t;break;default:r-=4}return[n,r]}}};const GB=["x","y","font","fontSize","fontStyle","fontWeight","angle"],UB=["text","font","rotate","fontSize","fontStyle","fontWeight"];function WB(e){Gu.call(this,function(){var e,t,n,r,i,o,a,s=[256,256],u=$B,l=[],c=Math.random,p={};function d(e,t,n){for(var r,i,o,a=t.x,l=t.y,p=Math.sqrt(s[0]*s[0]+s[1]*s[1]),d=u(s),h=c()<.5?1:-1,f=-h;(r=d(f+=h))&&(i=~~r[0],o=~~r[1],!(Math.min(Math.abs(i),Math.abs(o))>=p));)if(t.x=a+i,t.y=l+o,!(t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>s[0]||t.y+t.y1>s[1])&&(!n||!BB(t,e,s[0]))&&(!n||PB(t,n))){for(var g,m=t.sprite,y=t.width>>5,b=s[0]>>5,v=t.x-(y<<4),x=127&v,_=32-x,w=t.y1-t.y0,k=(t.y+t.y0)*b+(v>>5),S=0;S<w;S++){g=0;for(var C=0;C<=y;C++)e[k+C]|=g<<_|(C<y?(g=m[S*y+C])>>>x:0);k+=b}return t.sprite=null,!0}return!1}return p.layout=function(){for(var u=function(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=(NB<<5)/t,e.height=DB/t;var n=e.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:t}}(Pd()),p=function(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}((s[0]>>5)*s[1]),h=null,f=l.length,g=-1,m=[],y=l.map((s=>({text:e(s),font:t(s),style:r(s),weight:i(s),rotate:o(s),size:~~(n(s)+1e-14),padding:a(s),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:s}))).sort(((e,t)=>t.size-e.size));++g<f;){var b=y[g];b.x=s[0]*(c()+.5)>>1,b.y=s[1]*(c()+.5)>>1,IB(u,b,y,g),b.hasText&&d(p,b,h)&&(m.push(b),h?LB(h,b):h=[{x:b.x+b.x0,y:b.y+b.y0},{x:b.x+b.x1,y:b.y+b.y1}],b.x-=s[0]>>1,b.y-=s[1]>>1)}return m},p.words=function(e){return arguments.length?(l=e,p):l},p.size=function(e){return arguments.length?(s=[+e[0],+e[1]],p):s},p.font=function(e){return arguments.length?(t=zB(e),p):t},p.fontStyle=function(e){return arguments.length?(r=zB(e),p):r},p.fontWeight=function(e){return arguments.length?(i=zB(e),p):i},p.rotate=function(e){return arguments.length?(o=zB(e),p):o},p.text=function(t){return arguments.length?(e=zB(t),p):e},p.spiral=function(e){return arguments.length?(u=jB[e]||e,p):u},p.fontSize=function(e){return arguments.length?(n=zB(e),p):n},p.padding=function(e){return arguments.length?(a=zB(e),p):a},p.random=function(e){return arguments.length?(c=e,p):c},p}(),e)}WB.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:GB}]},jn(WB,Gu,{transform(e,t){!e.size||e.size[0]&&e.size[1]||Vt("Wordcloud size dimensions must be non-zero.");const n=e.modified();if(!(n||t.changed(t.ADD_REM)||UB.some((function(n){const r=e[n];return Mn(r)&&t.modified(r.fields)}))))return;const r=t.materialize(t.SOURCE).source,i=this.value,o=e.as||GB;let a,s=e.fontSize||14;if(Mn(s)?a=e.fontSizeRange:s=Nn(s),a){const e=s,t=tx("sqrt")().domain(Bn(r,e)).range(a);s=n=>t(e(n))}r.forEach((e=>{e[o[0]]=NaN,e[o[1]]=NaN,e[o[3]]=0}));const u=i.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(s).random(ol).layout(),l=i.size(),c=l[0]>>1,p=l[1]>>1,d=u.length;for(let e,t,n=0;n<d;++n)e=u[n],t=e.datum,t[o[0]]=e.x+c,t[o[1]]=e.y+p,t[o[2]]=e.font,t[o[3]]=e.size,t[o[4]]=e.style,t[o[5]]=e.weight,t[o[6]]=e.rotate;return t.reflow(n).modifies(o)}});const VB=Hl(Pl),HB=VB.right,qB=VB.left,XB=(Hl(jl).center,HB),YB=e=>new Uint8Array(e),KB=e=>new Uint16Array(e),JB=e=>new Uint32Array(e);function ZB(e,t,n){const r=(t<257?YB:t<65537?KB:JB)(e);return n&&r.set(n),r}function QB(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(e,t){const n=this,i=n.bisect(n.range,e.value),o=e.index,a=i[0],s=i[1],u=o.length;let l;for(l=0;l<a;++l)t[o[l]]|=r;for(l=s;l<u;++l)t[o[l]]|=r;return n}}}function eL(){let e=JB(0),t=[],n=0;return{insert:function(r,i,o){if(!i.length)return[];const a=n,s=i.length,u=JB(s);let l,c,p,d=Array(s);for(p=0;p<s;++p)d[p]=r(i[p]),u[p]=p;if(d=function(e,t){return e.sort.call(t,((t,n)=>{const r=e[t],i=e[n];return r<i?-1:r>i?1:0})),function(e,t){return Array.from(t,(t=>e[t]))}(e,t)}(d,u),a)l=t,c=e,t=Array(a+s),e=JB(a+s),function(e,t,n,r,i,o,a,s,u){let l,c=0,p=0;for(l=0;c<r&&p<a;++l)t[c]<i[p]?(s[l]=t[c],u[l]=n[c++]):(s[l]=i[p],u[l]=o[p++]+e);for(;c<r;++c,++l)s[l]=t[c],u[l]=n[c];for(;p<a;++p,++l)s[l]=i[p],u[l]=o[p]+e}(o,l,c,a,d,u,s,t,e);else{if(o>0)for(p=0;p<s;++p)u[p]+=o;t=d,e=u}return n=a+s,{index:u,value:d}},remove:function(r,i){const o=n;let a,s,u;for(s=0;!i[e[s]]&&s<o;++s);for(u=s;s<o;++s)i[a=e[s]]||(e[u]=a,t[u]=t[s],++u);n=o-r},bisect:function(e,r){let i;return r?i=r.length:(r=t,i=n),[qB(r,e[0],0,i),HB(r,e[1],0,i)]},reindex:function(t){for(let r=0,i=n;r<i;++r)e[r]=t[e[r]]},index:()=>e,size:()=>n}}function tL(e){Gu.call(this,function(){let e=8,t=[],n=JB(0),r=ZB(0,e),i=ZB(0,e);return{data:()=>t,seen:()=>n=function(e,t,n){return e.length>=t?e:((n=n||new e.constructor(t)).set(e),n)}(n,t.length),add(e){for(let n,r=0,i=t.length,o=e.length;r<o;++r)n=e[r],n._index=i++,t.push(n)},remove(e,n){const o=t.length,a=Array(o-e),s=t;let u,l,c;for(l=0;!n[l]&&l<o;++l)a[l]=t[l],s[l]=l;for(c=l;l<o;++l)u=t[l],n[l]?s[l]=-1:(s[l]=c,r[c]=r[l],i[c]=i[l],a[c]=u,u._index=c++),r[l]=0;return t=a,s},size:()=>t.length,curr:()=>r,prev:()=>i,reset:e=>i[e]=r[e],all:()=>e<257?255:e<65537?65535:4294967295,set(e,t){r[e]|=t},clear(e,t){r[e]&=~t},resize(t,n){(t>r.length||n>e)&&(e=Math.max(n,e),r=ZB(t,e,r),i=ZB(t,e))}}}(),e),this._indices=null,this._dims=null}function nL(e){Gu.call(this,null,e)}function*rL(e,t){if(null==t)for(let t of e)null!=t&&""!==t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let r of e)r=t(r,++n,e),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function iL(e,t,n){const r=Float64Array.from(rL(e,n));return r.sort(Pl),t.map((e=>Ul(r,e)))}function oL(e,t){return iL(e,[.25,.5,.75],t)}function aL(e,t){const n=e.length,r=function(e,t){const n=function(e,t){let n,r=0,i=0,o=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(n=t-i,i+=n/++r,o+=n*(t-i));else{let a=-1;for(let s of e)null!=(s=t(s,++a,e))&&(s=+s)>=s&&(n=s-i,i+=n/++r,o+=n*(s-i))}if(r>1)return o/(r-1)}(e,t);return n?Math.sqrt(n):n}(e,t),i=oL(e,t),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function sL(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let o,a,s,u,l,c,p=e.extent[0],d=e.extent[1];const h=e.span||d-p||Math.abs(p)||1;if(e.step)o=e.step;else if(e.steps){for(u=h/t,l=0,c=e.steps.length;l<c&&e.steps[l]<u;++l);o=e.steps[Math.max(0,l-1)]}else{for(a=Math.ceil(Math.log(t)/r),s=e.minstep||0,o=Math.max(s,Math.pow(n,Math.round(Math.log(h)/r)-a));Math.ceil(h/o)>t;)o*=n;for(l=0,c=i.length;l<c;++l)u=o/i[l],u>=s&&h/u<=t&&(o=u)}u=Math.log(o);const f=u>=0?0:1+~~(-u/r),g=Math.pow(n,-f-1);return(e.nice||void 0===e.nice)&&(u=Math.floor(p/o+g)*o,p=p<u?u-o:u,d=Math.ceil(d/o)*o),{start:p,stop:d===p?p+o:d,step:o}}tL.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},jn(tL,Gu,{transform(e,t){return this._dims?e.modified("fields")||e.fields.some((e=>t.modified(e.fields)))?this.reinit(e,t):this.eval(e,t):this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},o=this._dims=[],a=r.length;let s,u,l=0;for(;l<a;++l)s=n[l].fname,u=i[s]||(i[s]=eL()),o.push(QB(u,l,r[l]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,o=this._indices,a=this._dims,s=this.value,u=s.curr(),l=s.prev(),c=s.all(),p=n.rem=n.add,d=n.mod,h=i.length,f={};let g,m,y,b,v,x,_,w,k;if(l.set(u),t.rem.length&&(v=this.remove(e,t,n)),t.add.length&&s.add(t.add),t.mod.length)for(x={},b=t.mod,_=0,w=b.length;_<w;++_)x[b[_]._index]=1;for(_=0;_<h;++_)k=r[_],(!a[_]||e.modified("fields",_)||t.modified(k.fields))&&(y=k.fname,(g=f[y])||(o[y]=m=eL(),f[y]=g=m.insert(k,t.source,0)),a[_]=QB(m,_,i[_]).onAdd(g,u));for(_=0,w=s.data().length;_<w;++_)v[_]||(l[_]!==u[_]?p.push(_):x[_]&&u[_]!==c&&d.push(_));return s.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,o=this._dims,a=this._indices,s=e.fields,u={},l=n.add,c=i.size()+r.length,p=o.length;let d,h,f,g=i.size();i.resize(c,p),i.add(r);const m=i.curr(),y=i.prev(),b=i.all();for(d=0;d<p;++d)h=s[d].fname,f=u[h]||(u[h]=a[h].insert(s[d],r,g)),o[d].onAdd(f,m);for(;g<c;++g)y[g]=b,m[g]!==b&&l.push(g)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),o=r.all(),a=e.mod;let s,u,l;for(s=0,u=a.length;s<u;++s)l=a[s]._index,i[l]!==o&&n.push(l)},remove(e,t,n){const r=this._indices,i=this.value,o=i.curr(),a=i.prev(),s=i.all(),u={},l=n.rem,c=t.rem;let p,d,h,f;for(p=0,d=c.length;p<d;++p)h=c[p]._index,u[h]=1,a[h]=f=o[h],o[h]=s,f!==s&&l.push(h);for(h in r)r[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter((()=>{const e=i.remove(t,n);for(const t in r)r[t].reindex(e)}))},update(e,t,n){const r=this._dims,i=e.query,o=t.stamp,a=r.length;let s,u,l=0;for(n.filters=0,u=0;u<a;++u)e.modified("query",u)&&(s=u,++l);if(1===l)l=r[s].one,this.incrementOne(r[s],i[s],n.add,n.rem);else for(u=0,l=0;u<a;++u)e.modified("query",u)&&(l|=r[u].one,this.incrementAll(r[u],i[u],o,n.add),n.rem=n.add);return l},incrementAll(e,t,n,r){const i=this.value,o=i.seen(),a=i.curr(),s=i.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),p=c[0],d=c[1],h=l[0],f=l[1],g=e.one;let m,y,b;if(p<h)for(m=p,y=Math.min(h,d);m<y;++m)b=u[m],o[b]!==n&&(s[b]=a[b],o[b]=n,r.push(b)),a[b]^=g;else if(p>h)for(m=h,y=Math.min(p,f);m<y;++m)b=u[m],o[b]!==n&&(s[b]=a[b],o[b]=n,r.push(b)),a[b]^=g;if(d>f)for(m=Math.max(p,f),y=d;m<y;++m)b=u[m],o[b]!==n&&(s[b]=a[b],o[b]=n,r.push(b)),a[b]^=g;else if(d<f)for(m=Math.max(h,d),y=f;m<y;++m)b=u[m],o[b]!==n&&(s[b]=a[b],o[b]=n,r.push(b)),a[b]^=g;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value.curr(),o=e.index(),a=e.bisect(e.range),s=e.bisect(t),u=s[0],l=s[1],c=a[0],p=a[1],d=e.one;let h,f,g;if(u<c)for(h=u,f=Math.min(c,l);h<f;++h)g=o[h],i[g]^=d,n.push(g);else if(u>c)for(h=c,f=Math.min(u,p);h<f;++h)g=o[h],i[g]^=d,r.push(g);if(l>p)for(h=Math.max(u,p),f=l;h<f;++h)g=o[h],i[g]^=d,n.push(g);else if(l<p)for(h=Math.max(c,l),f=p;h<f;++h)g=o[h],i[g]^=d,r.push(g);e.range=t.slice()}}),nL.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},jn(nL,Gu,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if(0==(i&n))return t.StopPropagation;const o=t.fork(t.ALL),a=r.data(),s=r.curr(),u=r.prev(),l=e=>s[e]&n?null:a[e];return o.filter(o.MOD,l),i&i-1?(o.filter(o.ADD,(e=>{const t=s[e]&n;return!t&&t^u[e]&n?a[e]:null})),o.filter(o.REM,(e=>{const t=s[e]&n;return!t||t^t^u[e]&n?null:a[e]}))):(o.filter(o.ADD,l),o.filter(o.REM,(e=>(s[e]&n)===i?a[e]:null))),o.filter(o.SOURCE,(e=>l(e._index)))}});var uL=Math.random;function lL(e){uL=e}function cL(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(rL(e,r)),o=i.length,a=t;let s,u,l,c;for(l=0,c=Array(a);l<a;++l){for(s=0,u=0;u<o;++u)s+=i[~~(uL()*o)];c[l]=s/o}return c.sort(Pl),[Gl(c,n/2),Gl(c,1-n/2)]}function pL(e,t,n,r){r=r||(e=>e);const i=e.length,o=new Float64Array(i);let a,s=0,u=1,l=r(e[0]),c=l,p=l+t;for(;u<i;++u){if(a=r(e[u]),a>=p){for(c=(l+c)/2;s<u;++s)o[s]=c;p=a+t,l=a}c=a}for(c=(l+c)/2;s<u;++s)o[s]=c;return n?function(e,t){const n=e.length;let r,i,o=0,a=1;for(;e[o]===e[a];)++a;for(;a<n;){for(r=a+1;e[a]===e[r];)++r;if(e[a]-e[a-1]<t){for(i=a+(o+r-a-a>>1);i<a;)e[i++]=e[a];for(;i>a;)e[i--]=e[o]}o=a,a=r}return e}(o,t+t/4):o}function dL(e){return function(){return(e=(1103515245*e+12345)%2147483647)/2147483647}}function hL(e,t){let n,r,i;null==t&&(t=e,e=0);const o={min(e){return arguments.length?(n=e||0,i=r-n,o):n},max(e){return arguments.length?(r=e||0,i=r-n,o):r},sample:()=>n+Math.floor(i*uL()),pdf:e=>e===Math.floor(e)&&e>=n&&e<r?1/i:0,cdf(e){const t=Math.floor(e);return t<n?0:t>=r?1:(t-n+1)/i},icdf:e=>e>=0&&e<=1?n-1+Math.floor(e*i):NaN};return o.min(e).max(t)}const fL=Math.sqrt(2*Math.PI),gL=Math.SQRT2;let mL=NaN;function yL(e,t){e=e||0,t=null==t?1:t;let n,r,i=0,o=0;if(mL==mL)i=mL,mL=NaN;else{do{i=2*uL()-1,o=2*uL()-1,n=i*i+o*o}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,mL=o*r}return e+i*t}function bL(e,t,n){const r=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*fL)}function vL(e,t,n){const r=(e-(t=t||0))/(n=null==n?1:n),i=Math.abs(r);let o;if(i>37)o=0;else{const e=Math.exp(-i*i/2);let t;i<7.07106781186547?(t=.0352624965998911*i+.700383064443688,t=t*i+6.37396220353165,t=t*i+33.912866078383,t=t*i+112.079291497871,t=t*i+221.213596169931,t=t*i+220.206867912376,o=e*t,t=.0883883476483184*i+1.75566716318264,t=t*i+16.064177579207,t=t*i+86.7807322029461,t=t*i+296.564248779674,t=t*i+637.333633378831,t=t*i+793.826512519948,t=t*i+440.413735824752,o/=t):(t=i+.65,t=i+4/t,t=i+3/t,t=i+2/t,t=i+1/t,o=e/t/2.506628274631)}return r>0?1-o:o}function xL(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*gL*function(e){let t,n=-Math.log((1-e)*(1+e));return n<6.25?(n-=3.125,t=-364441206401782e-35,t=t*n-16850591381820166e-35,t=128584807152564e-32+t*n,t=11157877678025181e-33+t*n,t=t*n-1333171662854621e-31,t=20972767875968562e-33+t*n,t=6637638134358324e-30+t*n,t=t*n-4054566272975207e-29,t=t*n-8151934197605472e-29,t=26335093153082323e-28+t*n,t=t*n-12975133253453532e-27,t=t*n-5415412054294628e-26,t=1.0512122733215323e-9+t*n,t=t*n-4.112633980346984e-9,t=t*n-2.9070369957882005e-8,t=4.2347877827932404e-7+t*n,t=t*n-13654692000834679e-22,t=t*n-13882523362786469e-21,t=.00018673420803405714+t*n,t=t*n-.000740702534166267,t=t*n-.006033670871430149,t=.24015818242558962+t*n,t=1.6536545626831027+t*n):n<16?(n=Math.sqrt(n)-3.25,t=2.2137376921775787e-9,t=9.075656193888539e-8+t*n,t=t*n-2.7517406297064545e-7,t=1.8239629214389228e-8+t*n,t=15027403968909828e-22+t*n,t=t*n-4013867526981546e-21,t=29234449089955446e-22+t*n,t=12475304481671779e-21+t*n,t=t*n-47318229009055734e-21,t=6828485145957318e-20+t*n,t=24031110387097894e-21+t*n,t=t*n-.0003550375203628475,t=.0009532893797373805+t*n,t=t*n-.0016882755560235047,t=.002491442096107851+t*n,t=t*n-.003751208507569241,t=.005370914553590064+t*n,t=1.0052589676941592+t*n,t=3.0838856104922208+t*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,t=-27109920616438573e-27,t=t*n-2.555641816996525e-10,t=1.5076572693500548e-9+t*n,t=t*n-3.789465440126737e-9,t=7.61570120807834e-9+t*n,t=t*n-1.496002662714924e-8,t=2.914795345090108e-8+t*n,t=t*n-6.771199775845234e-8,t=2.2900482228026655e-7+t*n,t=t*n-9.9298272942317e-7,t=4526062597223154e-21+t*n,t=t*n-1968177810553167e-20,t=7599527703001776e-20+t*n,t=t*n-.00021503011930044477,t=t*n-.00013871931833623122,t=1.0103004648645344+t*n,t=4.849906401408584+t*n):t=1/0,t*e}(2*e-1)}function _L(e,t){let n,r;const i={mean(e){return arguments.length?(n=e||0,i):n},stdev(e){return arguments.length?(r=null==e?1:e,i):r},sample:()=>yL(n,r),pdf:e=>bL(e,n,r),cdf:e=>vL(e,n,r),icdf:e=>xL(e,n,r)};return i.mean(e).stdev(t)}function wL(e,t){const n=_L();let r=0;const i={data(n){return arguments.length?(e=n,r=n?n.length:0,i.bandwidth(t)):e},bandwidth(n){return arguments.length?(!(t=n)&&e&&(t=aL(e)),i):t},sample:()=>e[~~(uL()*r)]+t*n.sample(),pdf(i){let o=0,a=0;for(;a<r;++a)o+=n.pdf((i-e[a])/t);return o/t/r},cdf(i){let o=0,a=0;for(;a<r;++a)o+=n.cdf((i-e[a])/t);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function kL(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+yL()*t)}function SL(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*fL*e)}function CL(e,t,n){return vL(Math.log(e),t,n)}function ML(e,t,n){return Math.exp(xL(e,t,n))}function TL(e,t){let n,r;const i={mean(e){return arguments.length?(n=e||0,i):n},stdev(e){return arguments.length?(r=null==e?1:e,i):r},sample:()=>kL(n,r),pdf:e=>SL(e,n,r),cdf:e=>CL(e,n,r),icdf:e=>ML(e,n,r)};return i.mean(e).stdev(t)}function EL(e,t){let n,r=0;const i={weights(e){return arguments.length?(n=function(e){const t=[];let n,i=0;for(n=0;n<r;++n)i+=t[n]=null==e[n]?1:+e[n];for(n=0;n<r;++n)t[n]/=i;return t}(t=e||[]),i):t},distributions(n){return arguments.length?(n?(r=n.length,e=n):(r=0,e=[]),i.weights(t)):e},sample(){const t=uL();let i=e[r-1],o=n[0],a=0;for(;a<r-1;o+=n[++a])if(t<o){i=e[a];break}return i.sample()},pdf(t){let i=0,o=0;for(;o<r;++o)i+=n[o]*e[o].pdf(t);return i},cdf(t){let i=0,o=0;for(;o<r;++o)i+=n[o]*e[o].cdf(t);return i},icdf(){throw Error("Mixture icdf not supported.")}};return i.distributions(e).weights(t)}function AL(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*uL()}function FL(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function OL(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function RL(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function NL(e,t){let n,r;const i={min(e){return arguments.length?(n=e||0,i):n},max(e){return arguments.length?(r=null==e?1:e,i):r},sample:()=>AL(n,r),pdf:e=>FL(e,n,r),cdf:e=>OL(e,n,r),icdf:e=>RL(e,n,r)};return null==t&&(t=null==e?1:e,e=0),i.min(e).max(t)}function DL(e,t,n,r){const i=r-e*e,o=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-o*e,o]}function IL(e,t,n,r){e=e.filter((e=>{let r=t(e),i=n(e);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i})),r&&e.sort(((e,n)=>t(e)-t(n)));const i=e.length,o=new Float64Array(i),a=new Float64Array(i);let s,u,l,c=0,p=0,d=0;for(l of e)o[c]=s=+t(l),a[c]=u=+n(l),++c,p+=(s-p)/c,d+=(u-d)/c;for(c=0;c<i;++c)o[c]-=p,a[c]-=d;return[o,a,p,d]}function BL(e,t,n,r){let i,o,a=-1;for(const s of e)i=t(s),o=n(s),null!=i&&(i=+i)>=i&&null!=o&&(o=+o)>=o&&r(i,o,++a)}function LL(e,t,n,r,i){let o=0,a=0;return BL(e,t,n,((e,t)=>{const n=t-i(e),s=t-r;o+=n*n,a+=s*s})),1-o/a}function PL(e,t,n){let r=0,i=0,o=0,a=0,s=0;BL(e,t,n,((e,t)=>{++s,r+=(e-r)/s,i+=(t-i)/s,o+=(e*t-o)/s,a+=(e*e-a)/s}));const u=DL(r,i,o,a),l=e=>u[0]+u[1]*e;return{coef:u,predict:l,rSquared:LL(e,t,n,i,l)}}function $L(e,t,n){let r=0,i=0,o=0,a=0,s=0;BL(e,t,n,((e,t)=>{++s,e=Math.log(e),r+=(e-r)/s,i+=(t-i)/s,o+=(e*t-o)/s,a+=(e*e-a)/s}));const u=DL(r,i,o,a),l=e=>u[0]+u[1]*Math.log(e);return{coef:u,predict:l,rSquared:LL(e,t,n,i,l)}}function zL(e,t,n){const[r,i,o,a]=IL(e,t,n);let s,u,l,c=0,p=0,d=0,h=0,f=0;BL(e,t,n,((e,t)=>{s=r[f++],u=Math.log(t),l=s*t,c+=(t*u-c)/f,p+=(l-p)/f,d+=(l*u-d)/f,h+=(s*l-h)/f}));const[g,m]=DL(p/a,c/a,d/a,h/a),y=e=>Math.exp(g+m*(e-o));return{coef:[Math.exp(g-m*o),m],predict:y,rSquared:LL(e,t,n,a,y)}}function jL(e,t,n){let r=0,i=0,o=0,a=0,s=0,u=0;BL(e,t,n,((e,t)=>{const n=Math.log(e),l=Math.log(t);++u,r+=(n-r)/u,i+=(l-i)/u,o+=(n*l-o)/u,a+=(n*n-a)/u,s+=(t-s)/u}));const l=DL(r,i,o,a),c=e=>l[0]*Math.pow(e,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:LL(e,t,n,s,c)}}function GL(e,t,n){const[r,i,o,a]=IL(e,t,n),s=r.length;let u,l,c,p,d=0,h=0,f=0,g=0,m=0;for(u=0;u<s;)l=r[u],c=i[u++],p=l*l,d+=(p-d)/u,h+=(p*l-h)/u,f+=(p*p-f)/u,g+=(l*c-g)/u,m+=(p*c-m)/u;const y=f-d*d,b=d*y-h*h,v=(m*d-g*h)/b,x=(g*y-m*h)/b,_=-v*d,w=e=>v*(e-=o)*e+x*e+_+a;return{coef:[_-x*o+v*o*o+a,x-2*v*o,v],predict:w,rSquared:LL(e,t,n,a,w)}}function UL(e,t,n,r){if(1===r)return PL(e,t,n);if(2===r)return GL(e,t,n);const[i,o,a,s]=IL(e,t,n),u=i.length,l=[],c=[],p=r+1;let d,h,f,g,m;for(d=0;d<p;++d){for(f=0,g=0;f<u;++f)g+=Math.pow(i[f],d)*o[f];for(l.push(g),m=new Float64Array(p),h=0;h<p;++h){for(f=0,g=0;f<u;++f)g+=Math.pow(i[f],d+h);m[h]=g}c.push(m)}c.push(l);const y=function(e){const t=e.length-1,n=[];let r,i,o,a,s;for(r=0;r<t;++r){for(a=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][a])&&(a=i);for(o=r;o<t+1;++o)s=e[o][r],e[o][r]=e[o][a],e[o][a]=s;for(i=r+1;i<t;++i)for(o=t;o>=r;o--)e[o][i]-=e[o][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(s=0,o=i+1;o<t;++o)s+=e[o][i]*n[o];n[i]=(e[t][i]-s)/e[i][i]}return n}(c),b=e=>{e-=a;let t=s+y[0]+y[1]*e+y[2]*e*e;for(d=3;d<p;++d)t+=y[d]*Math.pow(e,d);return t};return{coef:WL(p,y,-a,s),predict:b,rSquared:LL(e,t,n,s,b)}}function WL(e,t,n,r){const i=Array(e);let o,a,s,u;for(o=0;o<e;++o)i[o]=0;for(o=e-1;o>=0;--o)for(s=t[o],u=1,i[o]+=s,a=1;a<=o;++a)u*=(o+1-a)/a,i[o-a]+=s*Math.pow(n,a)*u;return i[0]+=r,i}const VL=2,HL=1e-12;function qL(e,t,n,r){const[i,o,a,s]=IL(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),p=new Float64Array(u),d=new Float64Array(u).fill(1);for(let e=-1;++e<=VL;){const t=[0,l-1];for(let e=0;e<u;++e){const n=i[e],r=t[0],a=t[1],s=n-i[r]>i[a]-n?r:a;let u=0,l=0,h=0,f=0,g=0;const m=1/Math.abs(i[s]-n||1);for(let e=r;e<=a;++e){const t=i[e],r=o[e],a=XL(Math.abs(n-t)*m)*d[e],s=t*a;u+=a,l+=s,h+=r*a,f+=r*s,g+=t*s}const[y,b]=DL(l/u,h/u,f/u,g/u);c[e]=y+b*n,p[e]=Math.abs(o[e]-c[e]),YL(i,e+1,t)}if(e===VL)break;const n=Wl(p);if(Math.abs(n)<HL)break;for(let e,t,r=0;r<u;++r)e=p[r]/(6*n),d[r]=e>=1?HL:(t=1-e*e)*t}return function(e,t,n,r){const i=e.length,o=[];let a,s=0,u=0,l=[];for(;s<i;++s)a=e[s]+n,l[0]===a?l[1]+=(t[s]-l[1])/++u:(u=0,l[1]+=r,l=[a,t[s]],o.push(l));return l[1]+=r,o}(i,c,a,s)}function XL(e){return(e=1-e*e*e)*e*e}function YL(e,t,n){const r=e[t];let i=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>i&&e[o]-r<=r-e[i];)n[0]=++i,n[1]=o,++o}const KL=.5*Math.PI/180;function JL(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=t=>[t,e(t)],o=t[0],a=t[1],s=a-o,u=s/r,l=[i(o)],c=[];if(n===r){for(let e=1;e<r;++e)l.push(i(o+e/n*s));return l.push(i(a)),l}c.push(i(a));for(let e=n;--e>0;)c.push(i(o+e/n*s));let p=l[0],d=c[c.length-1];const h=1/s,f=function(e,t){let n=e,r=e;const i=t.length;for(let e=0;e<i;++e){const i=t[e][1];i<n&&(n=i),i>r&&(r=i)}return 1/(r-n)}(p[1],c);for(;d;){const e=i((p[0]+d[0])/2);e[0]-p[0]>=u&&ZL(p,e,d,h,f)>KL?c.push(e):(p=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function ZL(e,t,n,r,i){const o=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),a=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(o-a)}function QL(e,t,n){return e.fields=t||[],e.fname=n,e}function eP(e){return 1===e.length?tP(e[0]):nP(e)}const tP=e=>function(t){return t[e]},nP=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function rP(e){throw Error(e)}(function(e,t,n){const r=function(e){const t=[],n=e.length;let r,i,o,a=null,s=0,u="";function l(){t.push(u+e.substring(r,i)),u="",r=i+1}for(e+="",r=i=0;i<n;++i)if(o=e[i],"\\"===o)u+=e.substring(r,i++),r=i;else if(o===a)l(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&l(),s=r=i+1):"]"===o&&(s||rP("Access path missing open bracket: "+e),s>0&&l(),s=0,r=i+1):i>r?l():r=i+1}return s&&rP("Access path missing closing bracket: "+e),a&&rP("Access path missing closing quote: "+e),i>r&&(i++,l()),t}(e);e=1===r.length?r[0]:e,QL((n&&n.get||eP)(r),[e],t||e)})("id"),QL((e=>e),[],"identity");const iP=QL((()=>0),[],"zero"),oP=QL((()=>1),[],"one");QL((()=>!0),[],"true"),QL((()=>!1),[],"false");var aP=Array.isArray;function sP(e){return e[e.length-1]}const uP=Object.prototype.hasOwnProperty;var lP=new Date,cP=new Date;function pP(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=function(t){return e(t=new Date(+t)),t},i.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},i.round=function(e){var t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return s;do{s.push(a=new Date(+n)),t(n,o),e(n)}while(a<n&&n<r);return s},i.filter=function(n){return pP((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(i.count=function(t,r){return lP.setTime(+t),cP.setTime(+r),e(lP),e(cP),Math.floor(n(lP,cP))},i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?function(t){return r(t)%e==0}:function(t){return i.count(0,t)%e==0}):i:null}),i}const dP=1e3,hP=6e4,fP=36e5,gP=864e5,mP=6048e5,yP=31536e6;var bP=pP((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*hP)/gP),(e=>e.getDate()-1));const vP=bP;function xP(e){return pP((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*hP)/mP}))}bP.range;var _P=xP(0),wP=xP(1),kP=xP(2),SP=xP(3),CP=xP(4),MP=xP(5),TP=xP(6),EP=(_P.range,wP.range,kP.range,SP.range,CP.range,MP.range,TP.range,pP((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/gP}),(function(e){return e.getUTCDate()-1})));const AP=EP;function FP(e){return pP((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/mP}))}EP.range;var OP=FP(0),RP=FP(1),NP=FP(2),DP=FP(3),IP=FP(4),BP=FP(5),LP=FP(6),PP=(OP.range,RP.range,NP.range,DP.range,IP.range,BP.range,LP.range,pP((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()})));PP.every=function(e){return isFinite(e=Math.floor(e))&&e>0?pP((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};const $P=PP;PP.range;var zP=pP((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()}));const jP=zP;zP.range;var GP=pP((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*dP-e.getMinutes()*hP)}),(function(e,t){e.setTime(+e+t*fP)}),(function(e,t){return(t-e)/fP}),(function(e){return e.getHours()}));const UP=GP;GP.range;var WP=pP((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*dP)}),(function(e,t){e.setTime(+e+t*hP)}),(function(e,t){return(t-e)/hP}),(function(e){return e.getMinutes()}));const VP=WP;WP.range;var HP=pP((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*dP)}),(function(e,t){return(t-e)/dP}),(function(e){return e.getUTCSeconds()}));const qP=HP;HP.range;var XP=pP((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));XP.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?pP((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):XP:null};const YP=XP;XP.range;var KP=pP((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));KP.every=function(e){return isFinite(e=Math.floor(e))&&e>0?pP((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};const JP=KP;KP.range;var ZP=pP((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()}));const QP=ZP;ZP.range;var e$=pP((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*fP)}),(function(e,t){return(t-e)/fP}),(function(e){return e.getUTCHours()}));const t$=e$;e$.range;var n$=pP((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*hP)}),(function(e,t){return(t-e)/hP}),(function(e){return e.getUTCMinutes()}));const r$=n$;n$.range;const i$="year",o$="quarter",a$="month",s$="week",u$="date",l$="day",c$="dayofyear",p$="hours",d$="minutes",h$="seconds",f$="milliseconds",g$=[i$,o$,a$,s$,u$,l$,c$,p$,d$,h$,f$],m$=g$.reduce(((e,t,n)=>(e[t]=1+n,e)),{});function y$(e){const t=(r=e,null!=r?aP(r)?r:[r]:[]).slice(),n={};var r;return t.length||rP("Missing time unit."),t.forEach((e=>{!function(e,t){return uP.call(e,t)}(m$,e)?rP("Invalid time unit: ".concat(e,".")):n[e]=1})),(n[s$]||n[l$]?1:0)+(n[o$]||n[a$]||n[u$]?1:0)+(n[c$]?1:0)>1&&rP("Incompatible time units: ".concat(e)),t.sort(((e,t)=>m$[e]-m$[t])),t}const b$={[i$]:"%Y ",[o$]:"Q%q ",[a$]:"%b ",[u$]:"%d ",[s$]:"W%U ",[l$]:"%a ",[c$]:"%j ",[p$]:"%H:00",[d$]:"00:%M",[h$]:":%S",[f$]:".%L",["".concat(i$,"-").concat(a$)]:"%Y-%m ",["".concat(i$,"-").concat(a$,"-").concat(u$)]:"%Y-%m-%d ",["".concat(p$,"-").concat(d$)]:"%H:%M"};function v$(e,t){const n=function(e){for(let t,n,r=1,i=arguments.length;r<i;++r)for(n in t=arguments[r],t)e[n]=t[n];return e}({},b$,t),r=y$(e),i=r.length;let o,a,s="",u=0;for(u=0;u<i;)for(o=r.length;o>u;--o)if(a=r.slice(u,o).join("-"),null!=n[a]){s+=n[a],u=o;break}return s.trim()}const x$=new Date;function _$(e){return x$.setFullYear(e),x$.setMonth(0),x$.setDate(1),x$.setHours(0,0,0,0),x$}function w$(e){return S$(new Date(e))}function k$(e){return C$(new Date(e))}function S$(e){return vP.count(_$(e.getFullYear())-1,e)}function C$(e){return _P.count(_$(e.getFullYear())-1,e)}function M$(e){return _$(e).getDay()}function T$(e,t,n,r,i,o,a){if(0<=e&&e<100){const s=new Date(-1,t,n,r,i,o,a);return s.setFullYear(e),s}return new Date(e,t,n,r,i,o,a)}function E$(e){return F$(new Date(e))}function A$(e){return O$(new Date(e))}function F$(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return AP.count(t-1,e)}function O$(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return OP.count(t-1,e)}function R$(e){return x$.setTime(Date.UTC(e,0,1)),x$.getUTCDay()}function N$(e,t,n,r,i,o,a){if(0<=e&&e<100){const e=new Date(Date.UTC(-1,t,n,r,i,o,a));return e.setUTCFullYear(n.y),e}return new Date(Date.UTC(e,t,n,r,i,o,a))}function D$(e,t,n,r,i){const o=t||1,a=sP(e),s=(e,t,i)=>function(e,t,n,r){const i=n<=1?e:r?(t,i)=>r+n*Math.floor((e(t,i)-r)/n):(t,r)=>n*Math.floor(e(t,r)/n);return t?(e,n)=>t(i(e,n),n):i}(n[i=i||e],r[i],e===a&&o,t),u=new Date,l=function(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}(e),c=l[i$]?s(i$):function(e){return function(e){return"function"==typeof e}(e)?e:()=>e}(2012),p=l[a$]?s(a$):l[o$]?s(o$):iP,d=l[s$]&&l[l$]?s(l$,1,s$+l$):l[s$]?s(s$,1):l[l$]?s(l$,1):l[u$]?s(u$,1):l[c$]?s(c$,1):oP,h=l[p$]?s(p$):iP,f=l[d$]?s(d$):iP,g=l[h$]?s(h$):iP,m=l[f$]?s(f$):iP;return function(e){u.setTime(+e);const t=c(u);return i(t,p(u),d(u,t),h(u),f(u),g(u),m(u))}}function I$(e,t,n){return t+7*e-(n+6)%7}const B$={[i$]:e=>e.getFullYear(),[o$]:e=>Math.floor(e.getMonth()/3),[a$]:e=>e.getMonth(),[u$]:e=>e.getDate(),[p$]:e=>e.getHours(),[d$]:e=>e.getMinutes(),[h$]:e=>e.getSeconds(),[f$]:e=>e.getMilliseconds(),[c$]:e=>S$(e),[s$]:e=>C$(e),[s$+l$]:(e,t)=>I$(C$(e),e.getDay(),M$(t)),[l$]:(e,t)=>I$(1,e.getDay(),M$(t))},L$={[o$]:e=>3*e,[s$]:(e,t)=>I$(e,0,M$(t))};function P$(e,t){return D$(e,t||1,B$,L$,T$)}const $$={[i$]:e=>e.getUTCFullYear(),[o$]:e=>Math.floor(e.getUTCMonth()/3),[a$]:e=>e.getUTCMonth(),[u$]:e=>e.getUTCDate(),[p$]:e=>e.getUTCHours(),[d$]:e=>e.getUTCMinutes(),[h$]:e=>e.getUTCSeconds(),[f$]:e=>e.getUTCMilliseconds(),[c$]:e=>F$(e),[s$]:e=>O$(e),[l$]:(e,t)=>I$(1,e.getUTCDay(),R$(t)),[s$+l$]:(e,t)=>I$(O$(e),e.getUTCDay(),R$(t))},z$={[o$]:e=>3*e,[s$]:(e,t)=>I$(e,0,R$(t))};function j$(e,t){return D$(e,t||1,$$,z$,N$)}const G$={[i$]:$P,[o$]:jP.every(3),[a$]:jP,[s$]:_P,[u$]:vP,[l$]:vP,[c$]:vP,[p$]:UP,[d$]:VP,[h$]:qP,[f$]:YP},U$={[i$]:JP,[o$]:QP.every(3),[a$]:QP,[s$]:OP,[u$]:AP,[l$]:AP,[c$]:AP,[p$]:t$,[d$]:r$,[h$]:qP,[f$]:YP};function W$(e){return G$[e]}function V$(e){return U$[e]}function H$(e,t,n){return e?e.offset(t,n):void 0}function q$(e,t,n){return H$(W$(e),t,n)}function X$(e,t,n){return H$(V$(e),t,n)}function Y$(e,t,n,r){return e?e.range(t,n,r):void 0}function K$(e,t,n,r){return Y$(W$(e),t,n,r)}function J$(e,t,n,r){return Y$(V$(e),t,n,r)}const Z$=31536e6,Q$=[i$,a$,u$,p$,d$,h$,f$],ez=Q$.slice(0,-1),tz=ez.slice(0,-1),nz=tz.slice(0,-1),rz=nz.slice(0,-1),iz=[i$,a$],oz=[i$],az=[[ez,1,1e3],[ez,5,5e3],[ez,15,15e3],[ez,30,3e4],[tz,1,6e4],[tz,5,3e5],[tz,15,9e5],[tz,30,18e5],[nz,1,36e5],[nz,3,108e5],[nz,6,216e5],[nz,12,432e5],[rz,1,864e5],[[i$,s$],1,6048e5],[iz,1,2592e6],[iz,3,7776e6],[oz,1,Z$]];function sz(e){const t=e.extent,n=e.maxbins||40,r=Math.abs((i=t)&&sP(i)-i[0]||0)/n;var i;let o,a,s=Hl((e=>e[2])).right(az,r);return s===az.length?(o=oz,a=eE(t[0]/Z$,t[1]/Z$,n)):s?(s=az[r/az[s-1][2]<az[s][2]/r?s-1:s],o=s[0],a=s[1]):(o=Q$,a=Math.max(eE(t[0],t[1],n),1)),{units:o,step:a}}function uz(e,t,n){return e.fields=t||[],e.fname=n,e}function lz(e){return 1===e.length?cz(e[0]):pz(e)}const cz=e=>function(t){return t[e]},pz=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function dz(e){throw Error(e)}function hz(e,t,n){const r=function(e){const t=[],n=e.length;let r,i,o,a=null,s=0,u="";function l(){t.push(u+e.substring(r,i)),u="",r=i+1}for(e+="",r=i=0;i<n;++i)if(o=e[i],"\\"===o)u+=e.substring(r,i++),r=i;else if(o===a)l(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&l(),s=r=i+1):"]"===o&&(s||dz("Access path missing open bracket: "+e),s>0&&l(),s=0,r=i+1):i>r?l():r=i+1}return s&&dz("Access path missing closing bracket: "+e),a&&dz("Access path missing closing quote: "+e),i>r&&(i++,l()),t}(e);return e=1===r.length?r[0]:e,uz((n&&n.get||lz)(r),[e],t||e)}hz("id");const fz=uz((e=>e),[],"identity");uz((()=>0),[],"zero"),uz((()=>1),[],"one"),uz((()=>!0),[],"true"),uz((()=>!1),[],"false");var gz=Array.isArray;function mz(e){return e===Object(e)}function yz(e){return null==e||""===e?null:+e}function bz(e){return"function"==typeof e}function vz(e){for(let t,n,r=1,i=arguments.length;r<i;++r)for(n in t=arguments[r],t)e[n]=t[n];return e}const xz=Object.prototype.hasOwnProperty;function _z(e,t){return xz.call(e,t)}function wz(e){return"string"==typeof e}function kz(e){return gz(e)?"["+e.map(kz)+"]":mz(e)||wz(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}const Sz=e=>function(e){return"number"==typeof e}(e)||function(e){return"[object Date]"===Object.prototype.toString.call(e)}(e)?e:Date.parse(e);var Cz={},Mz={},Tz=34,Ez=10,Az=13;function Fz(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function Oz(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function Rz(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function Nz(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,i=[],o=e.length,a=0,s=0,u=o<=0,l=!1;function c(){if(u)return Mz;if(l)return l=!1,Cz;var t,r,i=a;if(e.charCodeAt(i)===Tz){for(;a++<o&&e.charCodeAt(a)!==Tz||e.charCodeAt(++a)===Tz;);return(t=a)>=o?u=!0:(r=e.charCodeAt(a++))===Ez?l=!0:r===Az&&(l=!0,e.charCodeAt(a)===Ez&&++a),e.slice(i+1,t-1).replace(/""/g,'"')}for(;a<o;){if((r=e.charCodeAt(t=a++))===Ez)l=!0;else if(r===Az)l=!0,e.charCodeAt(a)===Ez&&++a;else if(r!==n)continue;return e.slice(i,t)}return u=!0,e.slice(i,o)}for(e.charCodeAt(o-1)===Ez&&--o,e.charCodeAt(o-1)===Az&&--o;(r=c())!==Mz;){for(var p=[];r!==Cz&&r!==Mz;)p.push(r),r=c();t&&null==(p=t(p,s++))||i.push(p)}return i}function i(t,n){return t.map((function(t){return n.map((function(e){return a(t[e])})).join(e)}))}function o(t){return t.map(a).join(e)}function a(e){return null==e?"":e instanceof Date?function(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":function(e){return e<0?"-"+Rz(-e,6):e>9999?"+"+Rz(e,6):Rz(e,4)}(e.getUTCFullYear())+"-"+Rz(e.getUTCMonth()+1,2)+"-"+Rz(e.getUTCDate(),2)+(i?"T"+Rz(t,2)+":"+Rz(n,2)+":"+Rz(r,2)+"."+Rz(i,3)+"Z":r?"T"+Rz(t,2)+":"+Rz(n,2)+":"+Rz(r,2)+"Z":n||t?"T"+Rz(t,2)+":"+Rz(n,2)+"Z":"")}(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,i,o=r(e,(function(e,r){if(n)return n(e,r-1);i=e,n=t?function(e,t){var n=Fz(e);return function(r,i){return t(n(r),i,e)}}(e,t):Fz(e)}));return o.columns=i||[],o},parseRows:r,format:function(t,n){return null==n&&(n=Oz(t)),[n.map(a).join(e)].concat(i(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=Oz(e)),i(e,t).join("\n")},formatRows:function(e){return e.map(o).join("\n")},formatRow:o,formatValue:a}}const Dz=Math.sqrt(50),Iz=Math.sqrt(10),Bz=Math.sqrt(2);function Lz(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=Dz?10:o>=Iz?5:o>=Bz?2:1;let s,u,l;return i<0?(l=Math.pow(10,-i)/a,s=Math.round(e*l),u=Math.round(t*l),s/l<e&&++s,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*a,s=Math.round(e/l),u=Math.round(t/l),s*l<e&&++s,u*l>t&&--u),u<s&&.5<=n&&n<2?Lz(e,t,2*n):[s,u,l]}function Pz(e,t,n){return Lz(e=+e,t=+t,n=+n)[2]}var $z,zz=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function jz(e){if(!(t=zz.exec(e)))throw new Error("invalid format: "+e);var t;return new Gz({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Gz(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Uz(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Wz(e){return(e=Uz(Math.abs(e)))?e[1]:NaN}function Vz(e,t){var n=Uz(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}jz.prototype=Gz.prototype,Gz.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Hz={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Vz(100*e,t),r:Vz,s:function(e,t){var n=Uz(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-($z=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Uz(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function qz(e){return e}var Xz,Yz,Kz,Jz=Array.prototype.map,Zz=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];Xz=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?qz:(t=Jz.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],a=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(e.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?qz:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Jz.call(e.numerals,String)),u=void 0===e.percent?"%":e.percent+"",l=void 0===e.minus?"":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function p(e){var t=(e=jz(e)).fill,n=e.align,p=e.sign,d=e.symbol,h=e.zero,f=e.width,g=e.comma,m=e.precision,y=e.trim,b=e.type;"n"===b?(g=!0,b="g"):Hz[b]||(void 0===m&&(m=12),y=!0,b="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var v="$"===d?i:"#"===d&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",x="$"===d?o:/[%p]/.test(b)?u:"",_=Hz[b],w=/[defgprs%]/.test(b);function k(e){var i,o,u,d=v,k=x;if("c"===b)k=_(e)+k,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:_(Math.abs(e),m),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),S&&0==+e&&"+"!==p&&(S=!1),d=(S?"("===p?p:l:"-"===p||"("===p?"":p)+d,k=("s"===b?Zz[8+$z/3]:"")+k+(S&&"("===p?")":""),w)for(i=-1,o=e.length;++i<o;)if(48>(u=e.charCodeAt(i))||u>57){k=(46===u?a+e.slice(i+1):e.slice(i))+k,e=e.slice(0,i);break}}g&&!h&&(e=r(e,1/0));var C=d.length+e.length+k.length,M=C<f?new Array(f-C+1).join(t):"";switch(g&&h&&(e=r(M+e,M.length?f-k.length:1/0),M=""),n){case"<":e=d+e+k+M;break;case"=":e=d+M+e+k;break;case"^":e=M.slice(0,C=M.length>>1)+d+e+k+M.slice(C);break;default:e=M+d+e+k}return s(e)}return m=void 0===m?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),k.toString=function(){return e+""},k}return{format:p,formatPrefix:function(e,t){var n=p(((e=jz(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Wz(t)/3))),i=Math.pow(10,-r),o=Zz[8+r/3];return function(e){return n(i*e)+o}}}}({thousands:",",grouping:[3],currency:["$",""]}),Yz=Xz.format,Kz=Xz.formatPrefix;const Qz=new Date,ej=new Date;function tj(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{const t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,r,o)=>{const a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return a;let s;do{a.push(s=new Date(+n)),t(n,o),e(n)}while(s<n&&n<r);return a},i.filter=n=>tj((t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),((e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})),n&&(i.count=(t,r)=>(Qz.setTime(+t),ej.setTime(+r),e(Qz),e(ej),Math.floor(n(Qz,ej))),i.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?t=>r(t)%e==0:t=>i.count(0,t)%e==0):i:null)),i}const nj=1e3,rj=6e4,ij=36e5,oj=864e5,aj=6048e5,sj=tj((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*rj)/oj),(e=>e.getDate()-1)),uj=(sj.range,tj((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/oj),(e=>e.getUTCDate()-1))),lj=(uj.range,tj((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/oj),(e=>Math.floor(e/oj))));function cj(e){return tj((t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),((e,t)=>{e.setDate(e.getDate()+7*t)}),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*rj)/aj))}lj.range;const pj=cj(0),dj=cj(1),hj=cj(2),fj=cj(3),gj=cj(4),mj=cj(5),yj=cj(6);function bj(e){return tj((t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)}),((e,t)=>(t-e)/aj))}pj.range,dj.range,hj.range,fj.range,gj.range,mj.range,yj.range;const vj=bj(0),xj=bj(1),_j=bj(2),wj=bj(3),kj=bj(4),Sj=bj(5),Cj=bj(6),Mj=(vj.range,xj.range,_j.range,wj.range,kj.range,Sj.range,Cj.range,tj((e=>{e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,t)=>{e.setFullYear(e.getFullYear()+t)}),((e,t)=>t.getFullYear()-e.getFullYear()),(e=>e.getFullYear())));Mj.every=e=>isFinite(e=Math.floor(e))&&e>0?tj((t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,n)=>{t.setFullYear(t.getFullYear()+n*e)})):null,Mj.range;const Tj=tj((e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)}),((e,t)=>t.getUTCFullYear()-e.getUTCFullYear()),(e=>e.getUTCFullYear()));Tj.every=e=>isFinite(e=Math.floor(e))&&e>0?tj((t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null,Tj.range;const Ej=tj((e=>{e.setDate(1),e.setHours(0,0,0,0)}),((e,t)=>{e.setMonth(e.getMonth()+t)}),((e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())),(e=>e.getMonth())),Aj=(Ej.range,tj((e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)}),((e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())),(e=>e.getUTCMonth()))),Fj=(Aj.range,tj((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*nj-e.getMinutes()*rj)}),((e,t)=>{e.setTime(+e+t*ij)}),((e,t)=>(t-e)/ij),(e=>e.getHours()))),Oj=(Fj.range,tj((e=>{e.setUTCMinutes(0,0,0)}),((e,t)=>{e.setTime(+e+t*ij)}),((e,t)=>(t-e)/ij),(e=>e.getUTCHours()))),Rj=(Oj.range,tj((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*nj)}),((e,t)=>{e.setTime(+e+t*rj)}),((e,t)=>(t-e)/rj),(e=>e.getMinutes()))),Nj=(Rj.range,tj((e=>{e.setUTCSeconds(0,0)}),((e,t)=>{e.setTime(+e+t*rj)}),((e,t)=>(t-e)/rj),(e=>e.getUTCMinutes()))),Dj=(Nj.range,tj((e=>{e.setTime(e-e.getMilliseconds())}),((e,t)=>{e.setTime(+e+t*nj)}),((e,t)=>(t-e)/nj),(e=>e.getUTCSeconds()))),Ij=(Dj.range,tj((()=>{}),((e,t)=>{e.setTime(+e+t)}),((e,t)=>t-e)));Ij.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?tj((t=>{t.setTime(Math.floor(t/e)*e)}),((t,n)=>{t.setTime(+t+n*e)}),((t,n)=>(n-t)/e)):Ij:null),Ij.range;const Bj="year",Lj="quarter",Pj="month",$j="week",zj="date",jj="day",Gj="dayofyear",Uj="hours",Wj="minutes",Vj="seconds",Hj="milliseconds";[Bj,Lj,Pj,$j,zj,jj,Gj,Uj,Wj,Vj,Hj].reduce(((e,t,n)=>(e[t]=1+n,e)),{}),new Date;const qj={[Bj]:Mj,[Lj]:Ej.every(3),[Pj]:Ej,[$j]:pj,[zj]:sj,[jj]:sj,[Gj]:sj,[Uj]:Fj,[Wj]:Rj,[Vj]:Dj,[Hj]:Ij},Xj={[Bj]:Tj,[Lj]:Aj.every(3),[Pj]:Aj,[$j]:vj,[zj]:uj,[jj]:uj,[Gj]:uj,[Uj]:Oj,[Wj]:Nj,[Vj]:Dj,[Hj]:Ij};function Yj(e){return qj[e]}function Kj(e){return Xj[e]}function Jj(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Zj(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Qj(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function eG(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=dG(i),c=hG(i),p=dG(o),d=hG(o),h=dG(a),f=hG(a),g=dG(s),m=hG(s),y=dG(u),b=hG(u),v={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:DG,e:DG,f:$G,g:KG,G:ZG,H:IG,I:BG,j:LG,L:PG,m:zG,M:jG,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:_U,s:wU,S:GG,u:UG,U:WG,V:HG,w:qG,W:XG,x:null,X:null,y:YG,Y:JG,Z:QG,"%":xU},x={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return u[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:eU,e:eU,f:oU,g:mU,G:bU,H:tU,I:nU,j:rU,L:iU,m:aU,M:sU,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:_U,s:wU,S:uU,u:lU,U:cU,V:dU,w:hU,W:fU,x:null,X:null,y:gU,Y:yU,Z:vU,"%":xU},_={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=f.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=p.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=y.exec(t.slice(n));return r?(e.m=b.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=g.exec(t.slice(n));return r?(e.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return S(e,t,n,r)},d:SG,e:SG,f:FG,g:xG,G:vG,H:MG,I:MG,j:CG,L:AG,m:kG,M:TG,p:function(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=c.get(r[0].toLowerCase()),n+r[0].length):-1},q:wG,Q:RG,s:NG,S:EG,u:gG,U:mG,V:yG,w:fG,W:bG,x:function(e,t,r){return S(e,n,t,r)},X:function(e,t,n){return S(e,r,t,n)},y:xG,Y:vG,Z:_G,"%":OG};function w(e,t){return function(n){var r,i,o,a=[],s=-1,u=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===e.charCodeAt(s)&&(a.push(e.slice(u,s)),null!=(i=aG[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(e.slice(u,s)),a.join("")}}function k(e,t){return function(n){var r,i,o=Qj(1900,void 0,1);if(S(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=Zj(Qj(o.y,0,1))).getUTCDay(),r=i>4||0===i?xj.ceil(r):xj(r),r=uj.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=Jj(Qj(o.y,0,1))).getDay(),r=i>4||0===i?dj.ceil(r):dj(r),r=sj.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Zj(Qj(o.y,0,1)).getUTCDay():Jj(Qj(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Zj(o)):Jj(o)}}function S(e,t,n,r){for(var i,o,a=0,s=t.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=_[i in aG?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return v.x=w(n,v),v.X=w(r,v),v.c=w(t,v),x.x=w(n,x),x.X=w(r,x),x.c=w(t,x),{format:function(e){var t=w(e+="",v);return t.toString=function(){return e},t},parse:function(e){var t=k(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=k(e+="",!0);return t.toString=function(){return e},t}}}[Bj,Pj,zj,Uj,Wj,Vj,Hj].slice(0,-1).slice(0,-1).slice(0,-1).slice(0,-1);var tG,nG,rG,iG,oG,aG={"-":"",_:" ",0:"0"},sG=/^\s*\d+/,uG=/^%/,lG=/[\\^$*+?|[\]().{}]/g;function cG(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function pG(e){return e.replace(lG,"\\$&")}function dG(e){return new RegExp("^(?:"+e.map(pG).join("|")+")","i")}function hG(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function fG(e,t,n){var r=sG.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function gG(e,t,n){var r=sG.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function mG(e,t,n){var r=sG.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function yG(e,t,n){var r=sG.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function bG(e,t,n){var r=sG.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function vG(e,t,n){var r=sG.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function xG(e,t,n){var r=sG.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function _G(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function wG(e,t,n){var r=sG.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function kG(e,t,n){var r=sG.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function SG(e,t,n){var r=sG.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function CG(e,t,n){var r=sG.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function MG(e,t,n){var r=sG.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function TG(e,t,n){var r=sG.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function EG(e,t,n){var r=sG.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function AG(e,t,n){var r=sG.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function FG(e,t,n){var r=sG.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function OG(e,t,n){var r=uG.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function RG(e,t,n){var r=sG.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function NG(e,t,n){var r=sG.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function DG(e,t){return cG(e.getDate(),t,2)}function IG(e,t){return cG(e.getHours(),t,2)}function BG(e,t){return cG(e.getHours()%12||12,t,2)}function LG(e,t){return cG(1+sj.count(Mj(e),e),t,3)}function PG(e,t){return cG(e.getMilliseconds(),t,3)}function $G(e,t){return PG(e,t)+"000"}function zG(e,t){return cG(e.getMonth()+1,t,2)}function jG(e,t){return cG(e.getMinutes(),t,2)}function GG(e,t){return cG(e.getSeconds(),t,2)}function UG(e){var t=e.getDay();return 0===t?7:t}function WG(e,t){return cG(pj.count(Mj(e)-1,e),t,2)}function VG(e){var t=e.getDay();return t>=4||0===t?gj(e):gj.ceil(e)}function HG(e,t){return e=VG(e),cG(gj.count(Mj(e),e)+(4===Mj(e).getDay()),t,2)}function qG(e){return e.getDay()}function XG(e,t){return cG(dj.count(Mj(e)-1,e),t,2)}function YG(e,t){return cG(e.getFullYear()%100,t,2)}function KG(e,t){return cG((e=VG(e)).getFullYear()%100,t,2)}function JG(e,t){return cG(e.getFullYear()%1e4,t,4)}function ZG(e,t){var n=e.getDay();return cG((e=n>=4||0===n?gj(e):gj.ceil(e)).getFullYear()%1e4,t,4)}function QG(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+cG(t/60|0,"0",2)+cG(t%60,"0",2)}function eU(e,t){return cG(e.getUTCDate(),t,2)}function tU(e,t){return cG(e.getUTCHours(),t,2)}function nU(e,t){return cG(e.getUTCHours()%12||12,t,2)}function rU(e,t){return cG(1+uj.count(Tj(e),e),t,3)}function iU(e,t){return cG(e.getUTCMilliseconds(),t,3)}function oU(e,t){return iU(e,t)+"000"}function aU(e,t){return cG(e.getUTCMonth()+1,t,2)}function sU(e,t){return cG(e.getUTCMinutes(),t,2)}function uU(e,t){return cG(e.getUTCSeconds(),t,2)}function lU(e){var t=e.getUTCDay();return 0===t?7:t}function cU(e,t){return cG(vj.count(Tj(e)-1,e),t,2)}function pU(e){var t=e.getUTCDay();return t>=4||0===t?kj(e):kj.ceil(e)}function dU(e,t){return e=pU(e),cG(kj.count(Tj(e),e)+(4===Tj(e).getUTCDay()),t,2)}function hU(e){return e.getUTCDay()}function fU(e,t){return cG(xj.count(Tj(e)-1,e),t,2)}function gU(e,t){return cG(e.getUTCFullYear()%100,t,2)}function mU(e,t){return cG((e=pU(e)).getUTCFullYear()%100,t,2)}function yU(e,t){return cG(e.getUTCFullYear()%1e4,t,4)}function bU(e,t){var n=e.getUTCDay();return cG((e=n>=4||0===n?kj(e):kj.ceil(e)).getUTCFullYear()%1e4,t,4)}function vU(){return"+0000"}function xU(){return"%"}function _U(e){return+e}function wU(e){return Math.floor(+e/1e3)}function kU(e){const t={};return n=>t[n]||(t[n]=e(n))}let SU,CU;function MU(e,t,n){mz(n=n||{})||dz(`Invalid time multi-format specifier: ${n}`);const r=t(Vj),i=t(Wj),o=t(Uj),a=t(zj),s=t($j),u=t(Pj),l=t(Lj),c=t(Bj),p=e(n[Hj]||".%L"),d=e(n[Vj]||":%S"),h=e(n[Wj]||"%I:%M"),f=e(n[Uj]||"%I %p"),g=e(n[zj]||n[jj]||"%a %d"),m=e(n[$j]||"%b %d"),y=e(n[Pj]||"%B"),b=e(n[Lj]||"%B"),v=e(n[Bj]||"%Y");return e=>(r(e)<e?p:i(e)<e?d:o(e)<e?h:a(e)<e?f:u(e)<e?s(e)<e?g:m:c(e)<e?l(e)<e?y:b:v)(e)}function TU(e){const t=kU(e.format),n=kU(e.utcFormat);return{timeFormat:e=>wz(e)?t(e):MU(t,Yj,e),utcFormat:e=>wz(e)?n(e):MU(n,Kj,e),timeParse:kU(e.parse),utcParse:kU(e.utcParse)}}function EU(e){return arguments.length?CU=function(e){return TU(eG(e))}(e):CU}tG=eG({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),nG=tG.format,rG=tG.parse,iG=tG.utcFormat,oG=tG.utcParse,SU=function(e){const t=kU(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(e){const n=jz(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let o=function(e,t){let n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if(n=e.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const a=o<r.length?r.slice(o):"";for(;--o>i;)if("0"!==r[o]){++o;break}return r.slice(0,o)+a}}(t(n),t(".1f")(1)[1])}return t(n)},formatSpan(e,r,i,o){o=jz(null==o?",f":o);const a=function(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?Pz(t,e,n):Pz(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}(e,r,i),s=Math.max(Math.abs(e),Math.abs(r));let u;if(null==o.precision)switch(o.type){case"s":return isNaN(u=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Wz(t)/3)))-Wz(Math.abs(e)))}(a,s))||(o.precision=u),n(o,s);case"":case"e":case"g":case"p":case"r":isNaN(u=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Wz(t)-Wz(e))+1}(a,s))||(o.precision=u-("e"===o.type));break;case"f":case"%":isNaN(u=function(e){return Math.max(0,-Wz(Math.abs(e)))}(a))||(o.precision=u-2*("%"===o.type))}return t(o)}}}({format:Yz,formatPrefix:Kz}),CU=TU({format:nG,parse:rG,utcFormat:iG,utcParse:oG});const AU=/^(data:|([A-Za-z]+:)?\/\/)/,FU=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,OU=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,RU="file://";async function NU(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function DU(e,t){t=vz({},this.options,t);const n=this.fileAccess,r={href:null};let i,o,a;const s=FU.test(e.replace(OU,""));null!=e&&"string"==typeof e&&s||dz("Sanitize failure, invalid URI: "+kz(e));const u=AU.test(e);return(a=t.baseURL)&&!u&&(e.startsWith("/")||a.endsWith("/")||(e="/"+e),e=a+e),o=(i=e.startsWith(RU))||"file"===t.mode||"http"!==t.mode&&!u&&n,i?e=e.slice(7):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),"image"===t.context&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function IU(e){return e?t=>new Promise(((n,r)=>{e.readFile(t,((e,t)=>{e?r(e):n(t)}))})):BU}async function BU(){dz("No file system access.")}function LU(e){return e?async function(t,n){const r=vz({},this.options.http,n),i=n&&n.response,o=await e(t,r);return o.ok?bz(o[i])?o[i]():o.text():dz(o.status+""+o.statusText)}:PU}async function PU(){dz("No HTTP fetch method available.")}const $U=e=>null!=e&&e==e,zU=e=>!(Number.isNaN(+e)||e instanceof Date),jU={boolean:function(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e||!e)},integer:yz,number:yz,date:function(e,t){return t=t||Sz,null==e||""===e?null:t(e)},string:function(e){return null==e||""===e?null:e+""},unknown:fz},GU=[e=>"true"===e||"false"===e||!0===e||!1===e,e=>zU(e)&&Number.isInteger(+e),zU,e=>!Number.isNaN(Date.parse(e))],UU=["boolean","integer","number","date"];function WU(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=GU.length,i=GU.map(((e,t)=>t+1));for(let o,a,s=0,u=0;s<n;++s)for(a=t?e[s][t]:e[s],o=0;o<r;++o)if(i[o]&&$U(a)&&!GU[o](a)&&(i[o]=0,++u,u===GU.length))return"string";return UU[i.reduce(((e,t)=>0===e?t:e),0)-1]}function VU(e,t){return t.reduce(((t,n)=>(t[n]=WU(e,n),t)),{})}function HU(e){const t=function(t,n){const r={delimiter:e};return qU(t,n?vz(n,r):r)};return t.responseType="text",t}function qU(e,t){return t.header&&(e=t.header.map(kz).join(t.delimiter)+"\n"+e),Nz(t.delimiter).parse(e+"")}function XU(e,t){const n=t&&t.property?hz(t.property):fz;return!mz(e)||(r=e,"function"==typeof Buffer&&bz(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(e)):function(e,t){return!gz(e)&&function(e){return e&&bz(e[Symbol.iterator])}(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}(n(e),t);var r}qU.responseType="text",XU.responseType="json";const YU={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function KU(e,t){let n,r,i,o;return e=XU(e,t),t&&t.feature?(n=dr,i=t.feature):t&&t.mesh?(n=mr,i=t.mesh,o=YU[t.filter]):dz("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):dz("Invalid TopoJSON object: "+i),r&&r.features||[r]}KU.responseType="json";const JU={dsv:qU,csv:HU(","),tsv:HU("\t"),json:XU,topojson:KU};function ZU(e,t){return arguments.length>1?(JU[e]=t,this):_z(JU,e)?JU[e]:null}function QU(e){const t=ZU(e);return t&&t.responseType||"text"}function eW(e,t,n,r){const i=ZU((t=t||{}).type||"json");return i||dz("Unknown data format type: "+t.type),e=i(e,t),t.parse&&function(e,t,n,r){if(!e.length)return;const i=EU();n=n||i.timeParse,r=r||i.utcParse;let o,a,s,u,l,c,p=e.columns||Object.keys(e[0]);"auto"===t&&(t=VU(e,p)),p=Object.keys(t);const d=p.map((e=>{const i=t[e];let o,a;if(i&&(i.startsWith("date:")||i.startsWith("utc:")))return o=i.split(/:(.+)?/,2),a=o[1],("'"===a[0]&&"'"===a[a.length-1]||'"'===a[0]&&'"'===a[a.length-1])&&(a=a.slice(1,-1)),("utc"===o[0]?r:n)(a);if(!jU[i])throw Error("Illegal format pattern: "+e+":"+i);return jU[i]}));for(s=0,l=e.length,c=p.length;s<l;++s)for(o=e[s],u=0;u<c;++u)a=p[u],o[a]=d[u](o[a])}(e,t.parse,n,r),_z(e,"columns")&&delete e.columns,e}const tW=function(e,t){return t=>({options:t||{},sanitize:DU,load:NU,fileAccess:!1,file:IU(null),http:LU(e)})}("undefined"!=typeof fetch&&fetch);function nW(e,t,n){return e.fields=t||[],e.fname=n,e}function rW(e){return 1===e.length?iW(e[0]):oW(e)}const iW=e=>function(t){return t[e]},oW=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function aW(e){throw Error(e)}function sW(e,t,n){const r=function(e){const t=[],n=e.length;let r,i,o,a=null,s=0,u="";function l(){t.push(u+e.substring(r,i)),u="",r=i+1}for(e+="",r=i=0;i<n;++i)if(o=e[i],"\\"===o)u+=e.substring(r,i++),r=i;else if(o===a)l(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&l(),s=r=i+1):"]"===o&&(s||aW("Access path missing open bracket: "+e),s>0&&l(),s=0,r=i+1):i>r?l():r=i+1}return s&&aW("Access path missing closing bracket: "+e),a&&aW("Access path missing closing quote: "+e),i>r&&(i++,l()),t}(e);return e=1===r.length?r[0]:e,nW((n&&n.get||rW)(r),[e],t||e)}sW("id");const uW=nW((e=>e),[],"identity"),lW=(nW((()=>0),[],"zero"),nW((()=>1),[],"one"),nW((()=>!0),[],"true"));nW((()=>!1),[],"false");var cW=Array.isArray;function pW(e){return e===Object(e)}function dW(e){return e[e.length-1]}function hW(e){return null==e||""===e?null:+e}function fW(e){return null!=e?cW(e)?e:[e]:[]}function gW(e){return"function"==typeof e}function mW(e){for(let t,n,r=1,i=arguments.length;r<i;++r)for(n in t=arguments[r],t)e[n]=t[n];return e}const yW=Object.prototype.hasOwnProperty;function bW(e,t){return yW.call(e,t)}function vW(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),mW(r,n)}function xW(e){return"number"==typeof e}function _W(e){return"string"==typeof e}function wW(e){return cW(e)?"["+e.map(wW)+"]":pW(e)||_W(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function kW(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function SW(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function CW(e){this._context=e}function MW(){}function TW(e){this._context=e}function EW(e){this._context=e}function AW(e,t){this._basis=new CW(e),this._beta=t}CW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:SW(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:SW(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},TW.prototype={areaStart:MW,areaEnd:MW,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:SW(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},EW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:SW(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},AW.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,i=e[0],o=t[0],a=e[n]-i,s=t[n]-o,u=-1;++u<=n;)r=u/n,this._basis.point(this._beta*e[u]+(1-this._beta)*(i+r*a),this._beta*t[u]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const FW=function e(t){function n(e){return 1===t?new CW(e):new AW(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function OW(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function RW(e,t){this._context=e,this._k=(1-t)/6}RW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:OW(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:OW(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const NW=function e(t){function n(e){return new RW(e,t)}return n.tension=function(t){return e(+t)},n}(0);function DW(e,t){this._context=e,this._k=(1-t)/6}DW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:OW(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const IW=function e(t){function n(e){return new DW(e,t)}return n.tension=function(t){return e(+t)},n}(0);function BW(e,t){this._context=e,this._k=(1-t)/6}BW.prototype={areaStart:MW,areaEnd:MW,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:OW(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const LW=function e(t){function n(e){return new BW(e,t)}return n.tension=function(t){return e(+t)},n}(0);var PW=Math.abs,$W=Math.atan2,zW=Math.cos,jW=Math.max,GW=Math.min,UW=Math.sin,WW=Math.sqrt,VW=1e-12,HW=Math.PI,qW=HW/2,XW=2*HW;function YW(e){return e>=1?qW:e<=-1?-qW:Math.asin(e)}function KW(e,t,n){var r=e._x1,i=e._y1,o=e._x2,a=e._y2;if(e._l01_a>VW){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>VW){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,a,e._x2,e._y2)}function JW(e,t){this._context=e,this._alpha=t}JW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:KW(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const ZW=function e(t){function n(e){return t?new JW(e,t):new RW(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function QW(e,t){this._context=e,this._alpha=t}QW.prototype={areaStart:MW,areaEnd:MW,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:KW(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const eV=function e(t){function n(e){return t?new QW(e,t):new BW(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function tV(e,t){this._context=e,this._alpha=t}tV.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:KW(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const nV=function e(t){function n(e){return t?new tV(e,t):new DW(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function rV(e){this._context=e}function iV(e){return new rV(e)}function oV(e){this._context=e}function aV(e){return e<0?-1:1}function sV(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(aV(o)+aV(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function uV(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function lV(e,t,n){var r=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,i+s*t,o-s,a-s*n,o,a)}function cV(e){this._context=e}function pV(e){this._context=new dV(e)}function dV(e){this._context=e}function hV(e){this._context=e}function fV(e){var t,n,r=e.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/o[t-1],o[t]-=n,a[t]-=n*a[t-1];for(i[r-1]=a[r-1]/o[r-1],t=r-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function gV(e,t){this._context=e,this._t=t}rV.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},oV.prototype={areaStart:MW,areaEnd:MW,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},cV.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:lV(this,this._t0,uV(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,lV(this,uV(this,n=sV(this,e,t)),n);break;default:lV(this,this._t0,n=sV(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(pV.prototype=Object.create(cV.prototype)).point=function(e,t){cV.prototype.point.call(this,t,e)},dV.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}},hV.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=fV(e),i=fV(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[a],t[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},gV.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};const mV=Math.PI,yV=2*mV,bV=1e-6,vV=yV-bV;function xV(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function _V(){return new xV}xV.prototype=_V.prototype={constructor:xV,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var o=this._x1,a=this._y1,s=n-e,u=r-t,l=o-e,c=a-t,p=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(p>bV)if(Math.abs(c*s-u*l)>bV&&i){var d=n-o,h=r-a,f=s*s+u*u,g=d*d+h*h,m=Math.sqrt(f),y=Math.sqrt(p),b=i*Math.tan((mV-Math.acos((f+p-g)/(2*m*y)))/2),v=b/y,x=b/m;Math.abs(v-1)>bV&&(this._+="L"+(e+v*l)+","+(t+v*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+x*s)+","+(this._y1=t+x*u)}else this._+="L"+(this._x1=e)+","+(this._y1=t)},arc:function(e,t,n,r,i,o){e=+e,t=+t,o=!!o;var a=(n=+n)*Math.cos(r),s=n*Math.sin(r),u=e+a,l=t+s,c=1^o,p=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>bV||Math.abs(this._y1-l)>bV)&&(this._+="L"+u+","+l),n&&(p<0&&(p=p%yV+yV),p>vV?this._+="A"+n+","+n+",0,1,"+c+","+(e-a)+","+(t-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):p>bV&&(this._+="A"+n+","+n+",0,"+ +(p>=mV)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};const wV=_V;function kV(e){return function(){return e}}function SV(e){return e.innerRadius}function CV(e){return e.outerRadius}function MV(e){return e.startAngle}function TV(e){return e.endAngle}function EV(e){return e&&e.padAngle}function AV(e,t,n,r,i,o,a){var s=e-n,u=t-r,l=(a?o:-o)/WW(s*s+u*u),c=l*u,p=-l*s,d=e+c,h=t+p,f=n+c,g=r+p,m=(d+f)/2,y=(h+g)/2,b=f-d,v=g-h,x=b*b+v*v,_=i-o,w=d*g-f*h,k=(v<0?-1:1)*WW(jW(0,_*_*x-w*w)),S=(w*v-b*k)/x,C=(-w*b-v*k)/x,M=(w*v+b*k)/x,T=(-w*b+v*k)/x,E=S-m,A=C-y,F=M-m,O=T-y;return E*E+A*A>F*F+O*O&&(S=M,C=T),{cx:S,cy:C,x01:-c,y01:-p,x11:S*(i/_-1),y11:C*(i/_-1)}}function FV(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function OV(e){return e[0]}function RV(e){return e[1]}function NV(e,t){var n=kV(!0),r=null,i=iV,o=null;function a(a){var s,u,l,c=(a=FV(a)).length,p=!1;for(null==r&&(o=i(l=wV())),s=0;s<=c;++s)!(s<c&&n(u=a[s],s,a))===p&&((p=!p)?o.lineStart():o.lineEnd()),p&&o.point(+e(u,s,a),+t(u,s,a));if(l)return o=null,l+""||null}return e="function"==typeof e?e:void 0===e?OV:kV(e),t="function"==typeof t?t:void 0===t?RV:kV(t),a.x=function(t){return arguments.length?(e="function"==typeof t?t:kV(+t),a):e},a.y=function(e){return arguments.length?(t="function"==typeof e?e:kV(+e),a):t},a.defined=function(e){return arguments.length?(n="function"==typeof e?e:kV(!!e),a):n},a.curve=function(e){return arguments.length?(i=e,null!=r&&(o=i(r)),a):i},a.context=function(e){return arguments.length?(null==e?r=o=null:o=i(r=e),a):r},a}function DV(e,t,n){var r=null,i=kV(!0),o=null,a=iV,s=null;function u(u){var l,c,p,d,h,f=(u=FV(u)).length,g=!1,m=new Array(f),y=new Array(f);for(null==o&&(s=a(h=wV())),l=0;l<=f;++l){if(!(l<f&&i(d=u[l],l,u))===g)if(g=!g)c=l,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),p=l-1;p>=c;--p)s.point(m[p],y[p]);s.lineEnd(),s.areaEnd()}g&&(m[l]=+e(d,l,u),y[l]=+t(d,l,u),s.point(r?+r(d,l,u):m[l],n?+n(d,l,u):y[l]))}if(h)return s=null,h+""||null}function l(){return NV().defined(i).curve(a).context(o)}return e="function"==typeof e?e:void 0===e?OV:kV(+e),t="function"==typeof t?t:kV(void 0===t?0:+t),n="function"==typeof n?n:void 0===n?RV:kV(+n),u.x=function(t){return arguments.length?(e="function"==typeof t?t:kV(+t),r=null,u):e},u.x0=function(t){return arguments.length?(e="function"==typeof t?t:kV(+t),u):e},u.x1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:kV(+e),u):r},u.y=function(e){return arguments.length?(t="function"==typeof e?e:kV(+e),n=null,u):t},u.y0=function(e){return arguments.length?(t="function"==typeof e?e:kV(+e),u):t},u.y1=function(e){return arguments.length?(n=null==e?null:"function"==typeof e?e:kV(+e),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(r).y(t)},u.defined=function(e){return arguments.length?(i="function"==typeof e?e:kV(!!e),u):i},u.curve=function(e){return arguments.length?(a=e,null!=o&&(s=a(o)),u):a},u.context=function(e){return arguments.length?(null==e?o=s=null:s=a(o=e),u):o},u}Array.prototype.slice;const IV={draw:function(e,t){var n=Math.sqrt(t/HW);e.moveTo(n,0),e.arc(0,0,n,0,XW)}};Math.sqrt(1/3);Math.sin(HW/10),Math.sin(7*HW/10);Math.sin(XW/10),Math.cos(XW/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12);var BV={},LV={},PV=34,$V=10,zV=13;function jV(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function GV(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function UV(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function WV(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,i=[],o=e.length,a=0,s=0,u=o<=0,l=!1;function c(){if(u)return LV;if(l)return l=!1,BV;var t,r,i=a;if(e.charCodeAt(i)===PV){for(;a++<o&&e.charCodeAt(a)!==PV||e.charCodeAt(++a)===PV;);return(t=a)>=o?u=!0:(r=e.charCodeAt(a++))===$V?l=!0:r===zV&&(l=!0,e.charCodeAt(a)===$V&&++a),e.slice(i+1,t-1).replace(/""/g,'"')}for(;a<o;){if((r=e.charCodeAt(t=a++))===$V)l=!0;else if(r===zV)l=!0,e.charCodeAt(a)===$V&&++a;else if(r!==n)continue;return e.slice(i,t)}return u=!0,e.slice(i,o)}for(e.charCodeAt(o-1)===$V&&--o,e.charCodeAt(o-1)===zV&&--o;(r=c())!==LV;){for(var p=[];r!==BV&&r!==LV;)p.push(r),r=c();t&&null==(p=t(p,s++))||i.push(p)}return i}function i(t,n){return t.map((function(t){return n.map((function(e){return a(t[e])})).join(e)}))}function o(t){return t.map(a).join(e)}function a(e){return null==e?"":e instanceof Date?function(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":function(e){return e<0?"-"+UV(-e,6):e>9999?"+"+UV(e,6):UV(e,4)}(e.getUTCFullYear())+"-"+UV(e.getUTCMonth()+1,2)+"-"+UV(e.getUTCDate(),2)+(i?"T"+UV(t,2)+":"+UV(n,2)+":"+UV(r,2)+"."+UV(i,3)+"Z":r?"T"+UV(t,2)+":"+UV(n,2)+":"+UV(r,2)+"Z":n||t?"T"+UV(t,2)+":"+UV(n,2)+"Z":"")}(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,i,o=r(e,(function(e,r){if(n)return n(e,r-1);i=e,n=t?function(e,t){var n=jV(e);return function(r,i){return t(n(r),i,e)}}(e,t):jV(e)}));return o.columns=i||[],o},parseRows:r,format:function(t,n){return null==n&&(n=GV(t)),[n.map(a).join(e)].concat(i(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=GV(e)),i(e,t).join("\n")},formatRows:function(e){return e.map(o).join("\n")},formatRow:o,formatValue:a}}const VV=Math.sqrt(50),HV=Math.sqrt(10),qV=Math.sqrt(2);function XV(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=VV?10:o>=HV?5:o>=qV?2:1;let s,u,l;return i<0?(l=Math.pow(10,-i)/a,s=Math.round(e*l),u=Math.round(t*l),s/l<e&&++s,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*a,s=Math.round(e/l),u=Math.round(t/l),s*l<e&&++s,u*l>t&&--u),u<s&&.5<=n&&n<2?XV(e,t,2*n):[s,u,l]}function YV(e,t,n){if(!((n=+n)>0))return[];if((e=+e)==(t=+t))return[e];const r=t<e,[i,o,a]=r?XV(t,e,n):XV(e,t,n);if(!(o>=i))return[];const s=o-i+1,u=new Array(s);if(r)if(a<0)for(let e=0;e<s;++e)u[e]=(o-e)/-a;else for(let e=0;e<s;++e)u[e]=(o-e)*a;else if(a<0)for(let e=0;e<s;++e)u[e]=(i+e)/-a;else for(let e=0;e<s;++e)u[e]=(i+e)*a;return u}function KV(e,t,n){return XV(e=+e,t=+t,n=+n)[2]}function JV(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?KV(t,e,n):KV(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}var ZV,QV=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function eH(e){if(!(t=QV.exec(e)))throw new Error("invalid format: "+e);var t;return new tH({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function tH(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function nH(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function rH(e){return(e=nH(Math.abs(e)))?e[1]:NaN}function iH(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(rH(t)/3)))-rH(Math.abs(e)))}function oH(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,rH(t)-rH(e))+1}function aH(e){return Math.max(0,-rH(Math.abs(e)))}function sH(e,t){var n=nH(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}eH.prototype=tH.prototype,tH.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const uH={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>sH(100*e,t),r:sH,s:function(e,t){var n=nH(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(ZV=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+nH(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function lH(e){return e}var cH,pH,dH,hH=Array.prototype.map,fH=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];cH=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?lH:(t=hH.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],a=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(e.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?lH:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(hH.call(e.numerals,String)),u=void 0===e.percent?"%":e.percent+"",l=void 0===e.minus?"":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function p(e){var t=(e=eH(e)).fill,n=e.align,p=e.sign,d=e.symbol,h=e.zero,f=e.width,g=e.comma,m=e.precision,y=e.trim,b=e.type;"n"===b?(g=!0,b="g"):uH[b]||(void 0===m&&(m=12),y=!0,b="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var v="$"===d?i:"#"===d&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",x="$"===d?o:/[%p]/.test(b)?u:"",_=uH[b],w=/[defgprs%]/.test(b);function k(e){var i,o,u,d=v,k=x;if("c"===b)k=_(e)+k,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:_(Math.abs(e),m),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),S&&0==+e&&"+"!==p&&(S=!1),d=(S?"("===p?p:l:"-"===p||"("===p?"":p)+d,k=("s"===b?fH[8+ZV/3]:"")+k+(S&&"("===p?")":""),w)for(i=-1,o=e.length;++i<o;)if(48>(u=e.charCodeAt(i))||u>57){k=(46===u?a+e.slice(i+1):e.slice(i))+k,e=e.slice(0,i);break}}g&&!h&&(e=r(e,1/0));var C=d.length+e.length+k.length,M=C<f?new Array(f-C+1).join(t):"";switch(g&&h&&(e=r(M+e,M.length?f-k.length:1/0),M=""),n){case"<":e=d+e+k+M;break;case"=":e=d+M+e+k;break;case"^":e=M.slice(0,C=M.length>>1)+d+e+k+M.slice(C);break;default:e=M+d+e+k}return s(e)}return m=void 0===m?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),k.toString=function(){return e+""},k}return{format:p,formatPrefix:function(e,t){var n=p(((e=eH(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(rH(t)/3))),i=Math.pow(10,-r),o=fH[8+r/3];return function(e){return n(i*e)+o}}}}({thousands:",",grouping:[3],currency:["$",""]}),pH=cH.format,dH=cH.formatPrefix;const gH=new Date,mH=new Date;function yH(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{const t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,r,o)=>{const a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return a;let s;do{a.push(s=new Date(+n)),t(n,o),e(n)}while(s<n&&n<r);return a},i.filter=n=>yH((t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),((e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})),n&&(i.count=(t,r)=>(gH.setTime(+t),mH.setTime(+r),e(gH),e(mH),Math.floor(n(gH,mH))),i.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?t=>r(t)%e==0:t=>i.count(0,t)%e==0):i:null)),i}const bH=1e3,vH=6e4,xH=36e5,_H=864e5,wH=6048e5,kH=31536e6,SH=yH((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*vH)/_H),(e=>e.getDate()-1)),CH=(SH.range,yH((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/_H),(e=>e.getUTCDate()-1))),MH=(CH.range,yH((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/_H),(e=>Math.floor(e/_H))));function TH(e){return yH((t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),((e,t)=>{e.setDate(e.getDate()+7*t)}),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*vH)/wH))}MH.range;const EH=TH(0),AH=TH(1),FH=TH(2),OH=TH(3),RH=TH(4),NH=TH(5),DH=TH(6);function IH(e){return yH((t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)}),((e,t)=>(t-e)/wH))}EH.range,AH.range,FH.range,OH.range,RH.range,NH.range,DH.range;const BH=IH(0),LH=IH(1),PH=IH(2),$H=IH(3),zH=IH(4),jH=IH(5),GH=IH(6),UH=(BH.range,LH.range,PH.range,$H.range,zH.range,jH.range,GH.range,yH((e=>{e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,t)=>{e.setFullYear(e.getFullYear()+t)}),((e,t)=>t.getFullYear()-e.getFullYear()),(e=>e.getFullYear())));UH.every=e=>isFinite(e=Math.floor(e))&&e>0?yH((t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,n)=>{t.setFullYear(t.getFullYear()+n*e)})):null,UH.range;const WH=yH((e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)}),((e,t)=>t.getUTCFullYear()-e.getUTCFullYear()),(e=>e.getUTCFullYear()));WH.every=e=>isFinite(e=Math.floor(e))&&e>0?yH((t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null,WH.range;const VH=yH((e=>{e.setDate(1),e.setHours(0,0,0,0)}),((e,t)=>{e.setMonth(e.getMonth()+t)}),((e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())),(e=>e.getMonth())),HH=(VH.range,yH((e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)}),((e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())),(e=>e.getUTCMonth()))),qH=(HH.range,yH((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*bH-e.getMinutes()*vH)}),((e,t)=>{e.setTime(+e+t*xH)}),((e,t)=>(t-e)/xH),(e=>e.getHours()))),XH=(qH.range,yH((e=>{e.setUTCMinutes(0,0,0)}),((e,t)=>{e.setTime(+e+t*xH)}),((e,t)=>(t-e)/xH),(e=>e.getUTCHours()))),YH=(XH.range,yH((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*bH)}),((e,t)=>{e.setTime(+e+t*vH)}),((e,t)=>(t-e)/vH),(e=>e.getMinutes()))),KH=(YH.range,yH((e=>{e.setUTCSeconds(0,0)}),((e,t)=>{e.setTime(+e+t*vH)}),((e,t)=>(t-e)/vH),(e=>e.getUTCMinutes()))),JH=(KH.range,yH((e=>{e.setTime(e-e.getMilliseconds())}),((e,t)=>{e.setTime(+e+t*bH)}),((e,t)=>(t-e)/bH),(e=>e.getUTCSeconds()))),ZH=(JH.range,yH((()=>{}),((e,t)=>{e.setTime(+e+t)}),((e,t)=>t-e)));ZH.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?yH((t=>{t.setTime(Math.floor(t/e)*e)}),((t,n)=>{t.setTime(+t+n*e)}),((t,n)=>(n-t)/e)):ZH:null),ZH.range;const QH="year",eq="quarter",tq="month",nq="week",rq="date",iq="day",oq="dayofyear",aq="hours",sq="minutes",uq="seconds",lq="milliseconds";[QH,eq,tq,nq,rq,iq,oq,aq,sq,uq,lq].reduce(((e,t,n)=>(e[t]=1+n,e)),{}),new Date;const cq={[QH]:UH,[eq]:VH.every(3),[tq]:VH,[nq]:EH,[rq]:SH,[iq]:SH,[oq]:SH,[aq]:qH,[sq]:YH,[uq]:JH,[lq]:ZH},pq={[QH]:WH,[eq]:HH.every(3),[tq]:HH,[nq]:BH,[rq]:CH,[iq]:CH,[oq]:CH,[aq]:XH,[sq]:KH,[uq]:JH,[lq]:ZH};function dq(e){return cq[e]}function hq(e){return pq[e]}function fq(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function gq(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function mq(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}[QH,tq,rq,aq,sq,uq,lq].slice(0,-1).slice(0,-1).slice(0,-1).slice(0,-1);var yq,bq,vq,xq,_q,wq={"-":"",_:" ",0:"0"},kq=/^\s*\d+/,Sq=/^%/,Cq=/[\\^$*+?|[\]().{}]/g;function Mq(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function Tq(e){return e.replace(Cq,"\\$&")}function Eq(e){return new RegExp("^(?:"+e.map(Tq).join("|")+")","i")}function Aq(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function Fq(e,t,n){var r=kq.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Oq(e,t,n){var r=kq.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Rq(e,t,n){var r=kq.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Nq(e,t,n){var r=kq.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Dq(e,t,n){var r=kq.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Iq(e,t,n){var r=kq.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Bq(e,t,n){var r=kq.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Lq(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Pq(e,t,n){var r=kq.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function $q(e,t,n){var r=kq.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function zq(e,t,n){var r=kq.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function jq(e,t,n){var r=kq.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Gq(e,t,n){var r=kq.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Uq(e,t,n){var r=kq.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Wq(e,t,n){var r=kq.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Vq(e,t,n){var r=kq.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Hq(e,t,n){var r=kq.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function qq(e,t,n){var r=Sq.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Xq(e,t,n){var r=kq.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Yq(e,t,n){var r=kq.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Kq(e,t){return Mq(e.getDate(),t,2)}function Jq(e,t){return Mq(e.getHours(),t,2)}function Zq(e,t){return Mq(e.getHours()%12||12,t,2)}function Qq(e,t){return Mq(1+SH.count(UH(e),e),t,3)}function eX(e,t){return Mq(e.getMilliseconds(),t,3)}function tX(e,t){return eX(e,t)+"000"}function nX(e,t){return Mq(e.getMonth()+1,t,2)}function rX(e,t){return Mq(e.getMinutes(),t,2)}function iX(e,t){return Mq(e.getSeconds(),t,2)}function oX(e){var t=e.getDay();return 0===t?7:t}function aX(e,t){return Mq(EH.count(UH(e)-1,e),t,2)}function sX(e){var t=e.getDay();return t>=4||0===t?RH(e):RH.ceil(e)}function uX(e,t){return e=sX(e),Mq(RH.count(UH(e),e)+(4===UH(e).getDay()),t,2)}function lX(e){return e.getDay()}function cX(e,t){return Mq(AH.count(UH(e)-1,e),t,2)}function pX(e,t){return Mq(e.getFullYear()%100,t,2)}function dX(e,t){return Mq((e=sX(e)).getFullYear()%100,t,2)}function hX(e,t){return Mq(e.getFullYear()%1e4,t,4)}function fX(e,t){var n=e.getDay();return Mq((e=n>=4||0===n?RH(e):RH.ceil(e)).getFullYear()%1e4,t,4)}function gX(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Mq(t/60|0,"0",2)+Mq(t%60,"0",2)}function mX(e,t){return Mq(e.getUTCDate(),t,2)}function yX(e,t){return Mq(e.getUTCHours(),t,2)}function bX(e,t){return Mq(e.getUTCHours()%12||12,t,2)}function vX(e,t){return Mq(1+CH.count(WH(e),e),t,3)}function xX(e,t){return Mq(e.getUTCMilliseconds(),t,3)}function _X(e,t){return xX(e,t)+"000"}function wX(e,t){return Mq(e.getUTCMonth()+1,t,2)}function kX(e,t){return Mq(e.getUTCMinutes(),t,2)}function SX(e,t){return Mq(e.getUTCSeconds(),t,2)}function CX(e){var t=e.getUTCDay();return 0===t?7:t}function MX(e,t){return Mq(BH.count(WH(e)-1,e),t,2)}function TX(e){var t=e.getUTCDay();return t>=4||0===t?zH(e):zH.ceil(e)}function EX(e,t){return e=TX(e),Mq(zH.count(WH(e),e)+(4===WH(e).getUTCDay()),t,2)}function AX(e){return e.getUTCDay()}function FX(e,t){return Mq(LH.count(WH(e)-1,e),t,2)}function OX(e,t){return Mq(e.getUTCFullYear()%100,t,2)}function RX(e,t){return Mq((e=TX(e)).getUTCFullYear()%100,t,2)}function NX(e,t){return Mq(e.getUTCFullYear()%1e4,t,4)}function DX(e,t){var n=e.getUTCDay();return Mq((e=n>=4||0===n?zH(e):zH.ceil(e)).getUTCFullYear()%1e4,t,4)}function IX(){return"+0000"}function BX(){return"%"}function LX(e){return+e}function PX(e){return Math.floor(+e/1e3)}function $X(e){const t={};return n=>t[n]||(t[n]=e(n))}let zX,jX;function GX(e,t,n){pW(n=n||{})||aW(`Invalid time multi-format specifier: ${n}`);const r=t(uq),i=t(sq),o=t(aq),a=t(rq),s=t(nq),u=t(tq),l=t(eq),c=t(QH),p=e(n[lq]||".%L"),d=e(n[uq]||":%S"),h=e(n[sq]||"%I:%M"),f=e(n[aq]||"%I %p"),g=e(n[rq]||n[iq]||"%a %d"),m=e(n[nq]||"%b %d"),y=e(n[tq]||"%B"),b=e(n[eq]||"%B"),v=e(n[QH]||"%Y");return e=>(r(e)<e?p:i(e)<e?d:o(e)<e?h:a(e)<e?f:u(e)<e?s(e)<e?g:m:c(e)<e?l(e)<e?y:b:v)(e)}yq=function(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=Eq(i),c=Aq(i),p=Eq(o),d=Aq(o),h=Eq(a),f=Aq(a),g=Eq(s),m=Aq(s),y=Eq(u),b=Aq(u),v={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:Kq,e:Kq,f:tX,g:dX,G:fX,H:Jq,I:Zq,j:Qq,L:eX,m:nX,M:rX,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:LX,s:PX,S:iX,u:oX,U:aX,V:uX,w:lX,W:cX,x:null,X:null,y:pX,Y:hX,Z:gX,"%":BX},x={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return u[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:mX,e:mX,f:_X,g:RX,G:DX,H:yX,I:bX,j:vX,L:xX,m:wX,M:kX,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:LX,s:PX,S:SX,u:CX,U:MX,V:EX,w:AX,W:FX,x:null,X:null,y:OX,Y:NX,Z:IX,"%":BX},_={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=f.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=p.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=y.exec(t.slice(n));return r?(e.m=b.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=g.exec(t.slice(n));return r?(e.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return S(e,t,n,r)},d:zq,e:zq,f:Hq,g:Bq,G:Iq,H:Gq,I:Gq,j:jq,L:Vq,m:$q,M:Uq,p:function(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=c.get(r[0].toLowerCase()),n+r[0].length):-1},q:Pq,Q:Xq,s:Yq,S:Wq,u:Oq,U:Rq,V:Nq,w:Fq,W:Dq,x:function(e,t,r){return S(e,n,t,r)},X:function(e,t,n){return S(e,r,t,n)},y:Bq,Y:Iq,Z:Lq,"%":qq};function w(e,t){return function(n){var r,i,o,a=[],s=-1,u=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===e.charCodeAt(s)&&(a.push(e.slice(u,s)),null!=(i=wq[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(e.slice(u,s)),a.join("")}}function k(e,t){return function(n){var r,i,o=mq(1900,void 0,1);if(S(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=gq(mq(o.y,0,1))).getUTCDay(),r=i>4||0===i?LH.ceil(r):LH(r),r=CH.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=fq(mq(o.y,0,1))).getDay(),r=i>4||0===i?AH.ceil(r):AH(r),r=SH.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?gq(mq(o.y,0,1)).getUTCDay():fq(mq(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,gq(o)):fq(o)}}function S(e,t,n,r){for(var i,o,a=0,s=t.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=_[i in wq?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return v.x=w(n,v),v.X=w(r,v),v.c=w(t,v),x.x=w(n,x),x.X=w(r,x),x.c=w(t,x),{format:function(e){var t=w(e+="",v);return t.toString=function(){return e},t},parse:function(e){var t=k(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=k(e+="",!0);return t.toString=function(){return e},t}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),bq=yq.format,vq=yq.parse,xq=yq.utcFormat,_q=yq.utcParse,zX=function(e){const t=$X(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(e){const n=eH(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let o=function(e,t){let n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if(n=e.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const a=o<r.length?r.slice(o):"";for(;--o>i;)if("0"!==r[o]){++o;break}return r.slice(0,o)+a}}(t(n),t(".1f")(1)[1])}return t(n)},formatSpan(e,r,i,o){o=eH(null==o?",f":o);const a=JV(e,r,i),s=Math.max(Math.abs(e),Math.abs(r));let u;if(null==o.precision)switch(o.type){case"s":return isNaN(u=iH(a,s))||(o.precision=u),n(o,s);case"":case"e":case"g":case"p":case"r":isNaN(u=oH(a,s))||(o.precision=u-("e"===o.type));break;case"f":case"%":isNaN(u=aH(a))||(o.precision=u-2*("%"===o.type))}return t(o)}}}({format:pH,formatPrefix:dH}),jX=function(e){const t=$X(e.format),n=$X(e.utcFormat);return{timeFormat:e=>_W(e)?t(e):GX(t,dq,e),utcFormat:e=>_W(e)?n(e):GX(n,hq,e),timeParse:$X(e.parse),utcParse:$X(e.utcParse)}}({format:bq,parse:vq,utcFormat:xq,utcParse:_q});const UX=/^(data:|([A-Za-z]+:)?\/\/)/,WX=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,VX=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,HX="file://";async function qX(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function XX(e,t){t=mW({},this.options,t);const n=this.fileAccess,r={href:null};let i,o,a;const s=WX.test(e.replace(VX,""));null!=e&&"string"==typeof e&&s||aW("Sanitize failure, invalid URI: "+wW(e));const u=UX.test(e);return(a=t.baseURL)&&!u&&(e.startsWith("/")||a.endsWith("/")||(e="/"+e),e=a+e),o=(i=e.startsWith(HX))||"file"===t.mode||"http"!==t.mode&&!u&&n,i?e=e.slice(7):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),"image"===t.context&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function YX(e){return e?t=>new Promise(((n,r)=>{e.readFile(t,((e,t)=>{e?r(e):n(t)}))})):KX}async function KX(){aW("No file system access.")}function JX(e){return e?async function(t,n){const r=mW({},this.options.http,n),i=n&&n.response,o=await e(t,r);return o.ok?gW(o[i])?o[i]():o.text():aW(o.status+""+o.statusText)}:ZX}async function ZX(){aW("No HTTP fetch method available.")}function QX(e){const t=function(t,n){const r={delimiter:e};return eY(t,n?mW(n,r):r)};return t.responseType="text",t}function eY(e,t){return t.header&&(e=t.header.map(wW).join(t.delimiter)+"\n"+e),WV(t.delimiter).parse(e+"")}function tY(e,t){const n=t&&t.property?sW(t.property):uW;return!pW(e)||(r=e,"function"==typeof Buffer&&gW(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(e)):function(e,t){return!cW(e)&&function(e){return e&&gW(e[Symbol.iterator])}(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}(n(e),t);var r}eY.responseType="text",tY.responseType="json";QX(","),QX("\t");const nY=function(e,t){return t=>({options:t||{},sanitize:XX,load:qX,fileAccess:!1,file:YX(null),http:JX(e)})}("undefined"!=typeof fetch&&fetch);function rY(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function iY(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function oY(e){let t,n,r;function i(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<0?i=t+1:o=t}while(i<o)}return i}return 2!==e.length?(t=rY,n=(t,n)=>rY(e(t),n),r=(t,n)=>e(t)-n):(t=e===rY||e===iY?e:aY,n=e,r=e),{left:i,center:function(e,t,n=0,o=e.length){const a=i(e,t,n,o-1);return a>n&&r(e[a-1],t)>-r(e[a],t)?a-1:a},right:function(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<=0?i=t+1:o=t}while(i<o)}return i}}}function aY(){return 0}function sY(e){return null===e?NaN:+e}const uY=oY(rY),lY=uY.right,cY=(uY.left,oY(sY).center,lY);function pY(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function dY(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function hY(){}var fY=.7,gY=1.4285714285714286,mY="\\s*([+-]?\\d+)\\s*",yY="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",bY="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vY=/^#([0-9a-f]{3,8})$/,xY=new RegExp(`^rgb\\(${mY},${mY},${mY}\\)$`),_Y=new RegExp(`^rgb\\(${bY},${bY},${bY}\\)$`),wY=new RegExp(`^rgba\\(${mY},${mY},${mY},${yY}\\)$`),kY=new RegExp(`^rgba\\(${bY},${bY},${bY},${yY}\\)$`),SY=new RegExp(`^hsl\\(${yY},${bY},${bY}\\)$`),CY=new RegExp(`^hsla\\(${yY},${bY},${bY},${yY}\\)$`),MY={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function TY(){return this.rgb().formatHex()}function EY(){return this.rgb().formatRgb()}function AY(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=vY.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?FY(t):3===n?new DY(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?OY(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?OY(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=xY.exec(e))?new DY(t[1],t[2],t[3],1):(t=_Y.exec(e))?new DY(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=wY.exec(e))?OY(t[1],t[2],t[3],t[4]):(t=kY.exec(e))?OY(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=SY.exec(e))?zY(t[1],t[2]/100,t[3]/100,1):(t=CY.exec(e))?zY(t[1],t[2]/100,t[3]/100,t[4]):MY.hasOwnProperty(e)?FY(MY[e]):"transparent"===e?new DY(NaN,NaN,NaN,0):null}function FY(e){return new DY(e>>16&255,e>>8&255,255&e,1)}function OY(e,t,n,r){return r<=0&&(e=t=n=NaN),new DY(e,t,n,r)}function RY(e){return e instanceof hY||(e=AY(e)),e?new DY((e=e.rgb()).r,e.g,e.b,e.opacity):new DY}function NY(e,t,n,r){return 1===arguments.length?RY(e):new DY(e,t,n,null==r?1:r)}function DY(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function IY(){return`#${$Y(this.r)}${$Y(this.g)}${$Y(this.b)}`}function BY(){const e=LY(this.opacity);return`${1===e?"rgb(":"rgba("}${PY(this.r)}, ${PY(this.g)}, ${PY(this.b)}${1===e?")":`, ${e})`}`}function LY(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function PY(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function $Y(e){return((e=PY(e))<16?"0":"")+e.toString(16)}function zY(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new UY(e,t,n,r)}function jY(e){if(e instanceof UY)return new UY(e.h,e.s,e.l,e.opacity);if(e instanceof hY||(e=AY(e)),!e)return new UY;if(e instanceof UY)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new UY(a,s,u,e.opacity)}function GY(e,t,n,r){return 1===arguments.length?jY(e):new UY(e,t,n,null==r?1:r)}function UY(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function WY(e){return(e=(e||0)%360)<0?e+360:e}function VY(e){return Math.max(0,Math.min(1,e||0))}function HY(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function qY(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}function XY(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return qY((n-r/t)*t,a,i,o,s)}}function YY(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return qY((n-r/t)*t,i,o,a,s)}}pY(hY,AY,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:TY,formatHex:TY,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return jY(this).formatHsl()},formatRgb:EY,toString:EY}),pY(DY,NY,dY(hY,{brighter(e){return e=null==e?gY:Math.pow(gY,e),new DY(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?fY:Math.pow(fY,e),new DY(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new DY(PY(this.r),PY(this.g),PY(this.b),LY(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:IY,formatHex:IY,formatHex8:function(){return`#${$Y(this.r)}${$Y(this.g)}${$Y(this.b)}${$Y(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:BY,toString:BY})),pY(UY,GY,dY(hY,{brighter(e){return e=null==e?gY:Math.pow(gY,e),new UY(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?fY:Math.pow(fY,e),new UY(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new DY(HY(e>=240?e-240:e+120,i,r),HY(e,i,r),HY(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new UY(WY(this.h),VY(this.s),VY(this.l),LY(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=LY(this.opacity);return`${1===e?"hsl(":"hsla("}${WY(this.h)}, ${100*VY(this.s)}%, ${100*VY(this.l)}%${1===e?")":`, ${e})`}`}}));const KY=e=>()=>e;function JY(e,t){return function(n){return e+n*t}}function ZY(e,t){var n=t-e;return n?JY(e,n>180||n<-180?n-360*Math.round(n/360):n):KY(isNaN(e)?t:e)}function QY(e,t){var n=t-e;return n?JY(e,n):KY(isNaN(e)?t:e)}const eK=function e(t){var n=function(e){return 1==(e=+e)?QY:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):KY(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=NY(e)).r,(t=NY(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=QY(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function tK(e){return function(t){var n,r,i=t.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=NY(t[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=e(o),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=s(e),r+""}}}var nK=tK(XY),rK=tK(YY);function iK(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function oK(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function aK(e,t){return(oK(t)?iK:sK)(e,t)}function sK(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=fK(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}}function uK(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function lK(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function cK(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=fK(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}var pK=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dK=new RegExp(pK.source,"g");function hK(e,t){var n,r,i,o=pK.lastIndex=dK.lastIndex=0,a=-1,s=[],u=[];for(e+="",t+="";(n=pK.exec(e))&&(r=dK.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:lK(n,r)})),o=dK.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})}function fK(e,t){var n,r=typeof t;return null==t||"boolean"===r?KY(t):("number"===r?lK:"string"===r?(n=AY(t))?(t=n,eK):hK:t instanceof AY?eK:t instanceof Date?uK:oK(t)?iK:Array.isArray(t)?sK:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?cK:lK)(e,t)}function gK(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function mK(e){return+e}var yK=[0,1];function bK(e){return e}function vK(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function xK(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=vK(i,r),o=n(a,o)):(r=vK(r,i),o=n(o,a)),function(e){return o(r(e))}}function _K(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=vK(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=cY(e,t,1,r)-1;return o[n](i[n](t))}}function wK(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function kK(){var e,t,n,r,i,o,a=yK,s=yK,u=fK,l=bK;function c(){var e=Math.min(a.length,s.length);return l!==bK&&(l=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(a[0],a[e-1])),r=e>2?_K:xK,i=o=null,p}function p(t){return null==t||isNaN(t=+t)?n:(i||(i=r(a.map(e),s,u)))(e(l(t)))}return p.invert=function(n){return l(t((o||(o=r(s,a.map(e),lK)))(n)))},p.domain=function(e){return arguments.length?(a=Array.from(e,mK),c()):a.slice()},p.range=function(e){return arguments.length?(s=Array.from(e),c()):s.slice()},p.rangeRound=function(e){return s=Array.from(e),u=gK,c()},p.clamp=function(e){return arguments.length?(l=!!e||bK,c()):l!==bK},p.interpolate=function(e){return arguments.length?(u=e,c()):u},p.unknown=function(e){return arguments.length?(n=e,p):n},function(n,r){return e=n,t=r,c()}}function SK(){return kK()(bK,bK)}function CK(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function MK(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}function TK(e,t,n,r){var i,o=JV(e,t,n);switch((r=eH(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=iH(o,a))||(r.precision=i),dH(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=oH(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=aH(o))||(r.precision=i-2*("%"===r.type))}return pH(r)}function EK(e){var t=e.domain;return e.ticks=function(e){var n=t();return YV(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return TK(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,o=t(),a=0,s=o.length-1,u=o[a],l=o[s],c=10;for(l<u&&(i=u,u=l,l=i,i=a,a=s,s=i);c-- >0;){if((i=KV(u,l,n))===r)return o[a]=u,o[s]=l,t(o);if(i>0)u=Math.floor(u/i)*i,l=Math.ceil(l/i)*i;else{if(!(i<0))break;u=Math.ceil(u*i)/i,l=Math.floor(l*i)/i}r=i}return e},e}function AK(e,t){var n,r=0,i=(e=e.slice()).length-1,o=e[r],a=e[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),e[r]=t.floor(o),e[i]=t.ceil(a),e}function FK(e){return Math.log(e)}function OK(e){return Math.exp(e)}function RK(e){return-Math.log(-e)}function NK(e){return-Math.exp(-e)}function DK(e){return isFinite(e)?+("1e"+e):e<0?0:e}function IK(e){return(t,n)=>-e(-t,n)}function BK(e){const t=e(FK,OK),n=t.domain;let r,i,o=10;function a(){return r=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(o),i=function(e){return 10===e?DK:e===Math.E?Math.exp:t=>Math.pow(e,t)}(o),n()[0]<0?(r=IK(r),i=IK(i),e(RK,NK)):e(FK,OK),t}return t.base=function(e){return arguments.length?(o=+e,a()):o},t.domain=function(e){return arguments.length?(n(e),a()):n()},t.ticks=e=>{const t=n();let a=t[0],s=t[t.length-1];const u=s<a;u&&([a,s]=[s,a]);let l,c,p=r(a),d=r(s);const h=null==e?10:+e;let f=[];if(!(o%1)&&d-p<h){if(p=Math.floor(p),d=Math.ceil(d),a>0){for(;p<=d;++p)for(l=1;l<o;++l)if(c=p<0?l/i(-p):l*i(p),!(c<a)){if(c>s)break;f.push(c)}}else for(;p<=d;++p)for(l=o-1;l>=1;--l)if(c=p>0?l/i(-p):l*i(p),!(c<a)){if(c>s)break;f.push(c)}2*f.length<h&&(f=YV(a,s,h))}else f=YV(p,d,Math.min(d-p,h)).map(i);return u?f.reverse():f},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===o?"s":","),"function"!=typeof n&&(o%1||null!=(n=eH(n)).precision||(n.trim=!0),n=pH(n)),e===1/0)return n;const a=Math.max(1,o*e/t.ticks().length);return e=>{let t=e/i(Math.round(r(e)));return t*o<o-.5&&(t*=o),t<=a?n(e):""}},t.nice=()=>n(AK(n(),{floor:e=>i(Math.floor(r(e))),ceil:e=>i(Math.ceil(r(e)))})),t}function LK(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function PK(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function $K(e){return e<0?-e*e:e*e}function zK(e){var t=e(bK,bK),n=1;return t.exponent=function(t){return arguments.length?1==(n=+t)?e(bK,bK):.5===n?e(PK,$K):e(LK(n),LK(1/n)):n},EK(t)}function jK(){var e=zK(kK());return e.copy=function(){return wK(e,jK()).exponent(e.exponent())},CK.apply(e,arguments),e}function GK(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function UK(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function WK(e){var t=1,n=e(GK(t),UK(t));return n.constant=function(n){return arguments.length?e(GK(t=+n),UK(t)):t},EK(n)}function VK(e,t,n,r,i,o){const a=[[JH,1,bH],[JH,5,5e3],[JH,15,15e3],[JH,30,3e4],[o,1,vH],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,xH],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,_H],[r,2,1728e5],[n,1,wH],[t,1,2592e6],[t,3,7776e6],[e,1,kH]];function s(t,n,r){const i=Math.abs(n-t)/r,o=oY((([,,e])=>e)).right(a,i);if(o===a.length)return e.every(JV(t/kH,n/kH,r));if(0===o)return ZH.every(Math.max(JV(t,n,r),1));const[s,u]=a[i/a[o-1][2]<a[o][2]/i?o-1:o];return s.every(u)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const i=n&&"function"==typeof n.range?n:s(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},s]}const[HK,qK]=VK(WH,HH,BH,MH,XH,KH),[XK,YK]=VK(UH,VH,EH,SH,qH,YH);function KK(e){return new Date(e)}function JK(e){return e instanceof Date?+e:+new Date(+e)}function ZK(e,t,n,r,i,o,a,s,u,l){var c=SK(),p=c.invert,d=c.domain,h=l(".%L"),f=l(":%S"),g=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),b=l("%b %d"),v=l("%B"),x=l("%Y");function _(e){return(u(e)<e?h:s(e)<e?f:a(e)<e?g:o(e)<e?m:r(e)<e?i(e)<e?y:b:n(e)<e?v:x)(e)}return c.invert=function(e){return new Date(p(e))},c.domain=function(e){return arguments.length?d(Array.from(e,JK)):d().map(KK)},c.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},c.tickFormat=function(e,t){return null==t?_:l(t)},c.nice=function(e){var n=d();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(AK(n,e)):c},c.copy=function(){return wK(c,ZK(e,t,n,r,i,o,a,s,u,l))},c}function QK(){var e,t,n,r,i,o=0,a=1,s=bK,u=!1;function l(t){return null==t||isNaN(t=+t)?i:s(0===n?.5:(t=(r(t)-e)*n,u?Math.max(0,Math.min(1,t)):t))}function c(e){return function(t){var n,r;return arguments.length?([n,r]=t,s=e(n,r),l):[s(0),s(1)]}}return l.domain=function(i){return arguments.length?([o,a]=i,e=r(o=+o),t=r(a=+a),n=e===t?0:1/(t-e),l):[o,a]},l.clamp=function(e){return arguments.length?(u=!!e,l):u},l.interpolator=function(e){return arguments.length?(s=e,l):s},l.range=c(fK),l.rangeRound=c(gK),l.unknown=function(e){return arguments.length?(i=e,l):i},function(i){return r=i,e=i(o),t=i(a),n=e===t?0:1/(t-e),l}}function eJ(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function tJ(){var e=EK(QK()(bK));return e.copy=function(){return eJ(e,tJ())},MK.apply(e,arguments)}function nJ(){var e=zK(QK());return e.copy=function(){return eJ(e,nJ()).exponent(e.exponent())},MK.apply(e,arguments)}function rJ(e,t){void 0===t&&(t=e,e=fK);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return o[t](e-t)}}function iJ(){var e,t,n,r,i,o,a,s=0,u=.5,l=1,c=1,p=bK,d=!1;function h(e){return isNaN(e=+e)?a:(e=.5+((e=+o(e))-t)*(c*e<c*t?r:i),p(d?Math.max(0,Math.min(1,e)):e))}function f(e){return function(t){var n,r,i;return arguments.length?([n,r,i]=t,p=rJ(e,[n,r,i]),h):[p(0),p(.5),p(1)]}}return h.domain=function(a){return arguments.length?([s,u,l]=a,e=o(s=+s),t=o(u=+u),n=o(l=+l),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),c=t<e?-1:1,h):[s,u,l]},h.clamp=function(e){return arguments.length?(d=!!e,h):d},h.interpolator=function(e){return arguments.length?(p=e,h):p},h.range=f(fK),h.rangeRound=f(gK),h.unknown=function(e){return arguments.length?(a=e,h):a},function(a){return o=a,e=a(s),t=a(u),n=a(l),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),c=t<e?-1:1,h}}function oJ(){var e=zK(iJ());return e.copy=function(){return eJ(e,oJ()).exponent(e.exponent())},MK.apply(e,arguments)}function aJ(e,t,n=sY){if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e);return a+(+n(e[o+1],o+1,e)-a)*(i-o)}}const sJ=Symbol("implicit");function uJ(){var e=new gy,t=[],n=[],r=sJ;function i(i){let o=e.get(i);if(void 0===o){if(r!==sJ)return r;e.set(i,o=t.push(i)-1)}return n[o%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new gy;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return uJ(t,n).unknown(r)},CK.apply(i,arguments),i}function lJ(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function cJ(e,t){var n=ZY(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}var pJ,dJ=180/Math.PI,hJ={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function fJ(e,t,n,r,i,o){var a,s,u;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*dJ,skewX:Math.atan(u)*dJ,scaleX:a,scaleY:s}}function gJ(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,a){var s=[],u=[];return o=e(o),a=e(a),function(e,r,i,o,a,s){if(e!==i||r!==o){var u=a.push("translate(",null,t,null,n);s.push({i:u-4,x:lK(e,i)},{i:u-2,x:lK(r,o)})}else(i||o)&&a.push("translate("+i+t+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,u),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:lK(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,a.rotate,s,u),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:lK(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,a.skewX,s,u),function(e,t,n,r,o,a){if(e!==n||t!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:lK(e,n)},{i:s-2,x:lK(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,u),o=a=null,function(e){for(var t,n=-1,r=u.length;++n<r;)s[(t=u[n]).i]=t.x(e);return s.join("")}}}var mJ=gJ((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?hJ:fJ(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),yJ=gJ((function(e){return null==e?hJ:(pJ||(pJ=document.createElementNS("http://www.w3.org/2000/svg","g")),pJ.setAttribute("transform",e),(e=pJ.transform.baseVal.consolidate())?fJ((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):hJ)}),", ",")",")");function bJ(e){return((e=Math.exp(e))+1/e)/2}const vJ=function e(t,n,r){function i(e,i){var o,a,s=e[0],u=e[1],l=e[2],c=i[0],p=i[1],d=i[2],h=c-s,f=p-u,g=h*h+f*f;if(g<1e-12)a=Math.log(d/l)/t,o=function(e){return[s+e*h,u+e*f,l*Math.exp(t*e*a)]};else{var m=Math.sqrt(g),y=(d*d-l*l+r*g)/(2*l*n*m),b=(d*d-l*l-r*g)/(2*d*n*m),v=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(b*b+1)-b);a=(x-v)/t,o=function(e){var r=e*a,i=bJ(v),o=l/(n*m)*(i*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*r+v)-function(e){return((e=Math.exp(e))-1/e)/2}(v));return[s+o*h,u+o*f,l*i/bJ(t*r+v)]}}return o.duration=1e3*a*t/Math.SQRT2,o}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},i}(Math.SQRT2,2,4);function xJ(e){return function(t,n){var r=e((t=GY(t)).h,(n=GY(n)).h),i=QY(t.s,n.s),o=QY(t.l,n.l),a=QY(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=i(e),t.l=o(e),t.opacity=a(e),t+""}}}const _J=xJ(ZY);var wJ=xJ(QY);const kJ=Math.PI/180,SJ=180/Math.PI,CJ=.96422,MJ=1,TJ=.82521,EJ=4/29,AJ=.12841854934601665,FJ=.008856451679035631;function OJ(e){if(e instanceof NJ)return new NJ(e.l,e.a,e.b,e.opacity);if(e instanceof $J)return zJ(e);e instanceof DY||(e=RY(e));var t,n,r=LJ(e.r),i=LJ(e.g),o=LJ(e.b),a=DJ((.2225045*r+.7168786*i+.0606169*o)/MJ);return r===i&&i===o?t=n=a:(t=DJ((.4360747*r+.3850649*i+.1430804*o)/CJ),n=DJ((.0139322*r+.0971045*i+.7141733*o)/TJ)),new NJ(116*a-16,500*(t-a),200*(a-n),e.opacity)}function RJ(e,t,n,r){return 1===arguments.length?OJ(e):new NJ(e,t,n,null==r?1:r)}function NJ(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function DJ(e){return e>FJ?Math.pow(e,1/3):e/AJ+EJ}function IJ(e){return e>.20689655172413793?e*e*e:AJ*(e-EJ)}function BJ(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function LJ(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function PJ(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof $J)return new $J(e.h,e.c,e.l,e.opacity);if(e instanceof NJ||(e=OJ(e)),0===e.a&&0===e.b)return new $J(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*SJ;return new $J(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}(e):new $J(e,t,n,null==r?1:r)}function $J(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function zJ(e){if(isNaN(e.h))return new NJ(e.l,0,0,e.opacity);var t=e.h*kJ;return new NJ(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function jJ(e,t){var n=QY((e=RJ(e)).l,(t=RJ(t)).l),r=QY(e.a,t.a),i=QY(e.b,t.b),o=QY(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=i(t),e.opacity=o(t),e+""}}function GJ(e){return function(t,n){var r=e((t=PJ(t)).h,(n=PJ(n)).h),i=QY(t.c,n.c),o=QY(t.l,n.l),a=QY(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=i(e),t.l=o(e),t.opacity=a(e),t+""}}}pY(NJ,RJ,dY(hY,{brighter(e){return new NJ(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new NJ(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new DY(BJ(3.1338561*(t=CJ*IJ(t))-1.6168667*(e=MJ*IJ(e))-.4906146*(n=TJ*IJ(n))),BJ(-.9787684*t+1.9161415*e+.033454*n),BJ(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),pY($J,PJ,dY(hY,{brighter(e){return new $J(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new $J(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return zJ(this).rgb()}}));const UJ=GJ(ZY);var WJ=GJ(QY),VJ=-.14861,HJ=1.78277,qJ=-.29227,XJ=-.90649,YJ=1.97294,KJ=YJ*XJ,JJ=YJ*HJ,ZJ=HJ*qJ-XJ*VJ;function QJ(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof eZ)return new eZ(e.h,e.s,e.l,e.opacity);e instanceof DY||(e=RY(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(ZJ*r+KJ*t-JJ*n)/(ZJ+KJ-JJ),o=r-i,a=(YJ*(n-i)-qJ*o)/XJ,s=Math.sqrt(a*a+o*o)/(YJ*i*(1-i)),u=s?Math.atan2(a,o)*SJ-120:NaN;return new eZ(u<0?u+360:u,s,i,e.opacity)}(e):new eZ(e,t,n,null==r?1:r)}function eZ(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function tZ(e){return function t(n){function r(t,r){var i=e((t=QJ(t)).h,(r=QJ(r)).h),o=QY(t.s,r.s),a=QY(t.l,r.l),s=QY(t.opacity,r.opacity);return function(e){return t.h=i(e),t.s=o(e),t.l=a(Math.pow(e,n)),t.opacity=s(e),t+""}}return n=+n,r.gamma=t,r}(1)}pY(eZ,QJ,dY(hY,{brighter(e){return e=null==e?gY:Math.pow(gY,e),new eZ(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?fY:Math.pow(fY,e),new eZ(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*kJ,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new DY(255*(t+n*(VJ*r+HJ*i)),255*(t+n*(qJ*r+XJ*i)),255*(t+n*(YJ*r)),this.opacity)}}));const nZ=tZ(ZY);var rZ=tZ(QY);function iZ(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const oZ="linear",aZ="log",sZ="pow",uZ="sqrt",lZ="symlog",cZ="time",pZ="utc",dZ="sequential",hZ="diverging",fZ="quantile",gZ="quantize",mZ="threshold",yZ="continuous",bZ="discrete",vZ="discretizing",xZ="interpolating",_Z="temporal";function wZ(){const e=uJ().unknown(void 0),t=e.domain,n=e.range;let r,i,o=[0,1],a=!1,s=0,u=0,l=.5;function c(){const e=t().length,c=o[1]<o[0],p=o[1-c],d=function(e,t,n){const r=e-t+2*n;return e?r>0?r:1:0}(e,s,u);let h=o[c-0];r=(p-h)/(d||1),a&&(r=Math.floor(r)),h+=(p-h-r*(e-s))*l,i=r*(1-s),a&&(h=Math.round(h),i=Math.round(i));const f=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(i);++r<i;)o[r]=e+r*n;return o}(e).map((e=>h+r*e));return n(c?f.reverse():f)}return delete e.unknown,e.domain=function(e){return arguments.length?(t(e),c()):t()},e.range=function(e){return arguments.length?(o=[+e[0],+e[1]],c()):o.slice()},e.rangeRound=function(e){return o=[+e[0],+e[1]],a=!0,c()},e.bandwidth=function(){return i},e.step=function(){return r},e.round=function(e){return arguments.length?(a=!!e,c()):a},e.padding=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),s=u,c()):s},e.paddingInner=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),c()):s},e.paddingOuter=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),c()):u},e.align=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),c()):l},e.invertRange=function(e){if(null==e[0]||null==e[1])return;const r=o[1]<o[0],a=r?n().reverse():n(),s=a.length-1;let u,l,c,p=+e[0],d=+e[1];return p!=p||d!=d||(d<p&&(c=p,p=d,d=c),d<a[0]||p>o[1-r])?void 0:(u=Math.max(0,lY(a,p)-1),l=p===d?u:lY(a,d)-1,p-a[u]>i+1e-10&&++u,r&&(c=u,u=s-l,l=s-c),u>l?void 0:t().slice(u,l+1))},e.invert=function(t){const n=e.invertRange([t,t]);return n?n[0]:n},e.copy=function(){return wZ().domain(t()).range(o).round(a).paddingInner(s).paddingOuter(u).align(l)},c()}function kZ(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return kZ(t())},e}var SZ=Array.prototype.map;const CZ=Array.prototype.slice,MZ=new Map,TZ=Symbol("vega_scale");function EZ(e,t,n){return arguments.length>1?(MZ.set(e,function(e,t,n){const r=function(){const n=t();return n.invertRange||(n.invertRange=n.invert?(r=n,function(e){let t,n=e[0],i=e[1];return i<n&&(t=n,n=i,i=t),[r.invert(n),r.invert(i)]}):n.invertExtent?function(e){return function(t){const n=e.range();let r,i,o,a,s=t[0],u=t[1],l=-1;for(u<s&&(i=s,s=u,u=i),o=0,a=n.length;o<a;++o)n[o]>=s&&n[o]<=u&&(l<0&&(l=o),r=o);if(!(l<0))return s=e.invertExtent(n[l]),u=e.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}}(n):void 0),n.type=e,function(e){return e[TZ]=!0,e}(n);var r};return r.metadata=kW(fW(n)),r}(e,t,n)),this):function(e){return MZ.has(e)}(e)?MZ.get(e):void 0}function AZ(e,t){const n=MZ.get(e);return n&&n.metadata[t]}function FZ(e){return AZ(e,bZ)}function OZ(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function RZ(e,t){for(const n in e)DZ(n,t(e[n]))}EZ("identity",(function e(t){var n;function r(e){return null==e||isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=Array.from(e,mK),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,mK):[0,1],EK(r)})),EZ(oZ,(function e(){var t=SK();return t.copy=function(){return wK(t,e())},CK.apply(t,arguments),EK(t)}),yZ),EZ(aZ,(function e(){const t=BK(kK()).domain([1,10]);return t.copy=()=>wK(t,e()).base(t.base()),CK.apply(t,arguments),t}),[yZ,aZ]),EZ(sZ,jK,yZ),EZ(uZ,(function(){return jK.apply(null,arguments).exponent(.5)}),yZ),EZ(lZ,(function e(){var t=WK(kK());return t.copy=function(){return wK(t,e()).constant(t.constant())},CK.apply(t,arguments)}),yZ),EZ(cZ,(function(){return CK.apply(ZK(XK,YK,UH,VH,EH,SH,qH,YH,JH,bq).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[yZ,_Z]),EZ(pZ,(function(){return CK.apply(ZK(HK,qK,WH,HH,BH,CH,XH,KH,JH,xq).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[yZ,_Z]),EZ(dZ,tJ,[yZ,xZ]),EZ(`${dZ}-${oZ}`,tJ,[yZ,xZ]),EZ(`${dZ}-${aZ}`,(function e(){var t=BK(QK()).domain([1,10]);return t.copy=function(){return eJ(t,e()).base(t.base())},MK.apply(t,arguments)}),[yZ,xZ,aZ]),EZ(`${dZ}-${sZ}`,nJ,[yZ,xZ]),EZ(`${dZ}-${uZ}`,(function(){return nJ.apply(null,arguments).exponent(.5)}),[yZ,xZ]),EZ(`${dZ}-${lZ}`,(function e(){var t=WK(QK());return t.copy=function(){return eJ(t,e()).constant(t.constant())},MK.apply(t,arguments)}),[yZ,xZ]),EZ(`${hZ}-${oZ}`,(function e(){var t=EK(iJ()(bK));return t.copy=function(){return eJ(t,e())},MK.apply(t,arguments)}),[yZ,xZ]),EZ(`${hZ}-${aZ}`,(function e(){var t=BK(iJ()).domain([.1,1,10]);return t.copy=function(){return eJ(t,e()).base(t.base())},MK.apply(t,arguments)}),[yZ,xZ,aZ]),EZ(`${hZ}-${sZ}`,oJ,[yZ,xZ]),EZ(`${hZ}-${uZ}`,(function(){return oJ.apply(null,arguments).exponent(.5)}),[yZ,xZ]),EZ(`${hZ}-${lZ}`,(function e(){var t=WK(iJ());return t.copy=function(){return eJ(t,e()).constant(t.constant())},MK.apply(t,arguments)}),[yZ,xZ]),EZ(fZ,(function e(){var t,n=[],r=[],i=[];function o(){var e=0,t=Math.max(1,r.length);for(i=new Array(t-1);++e<t;)i[e-1]=aJ(n,e/t);return a}function a(e){return null==e||isNaN(e=+e)?t:r[cY(i,e)]}return a.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?i[t-1]:n[0],t<i.length?i[t]:n[n.length-1]]},a.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(rY),o()},a.range=function(e){return arguments.length?(r=Array.from(e),o()):r.slice()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.quantiles=function(){return i.slice()},a.copy=function(){return e().domain(n).range(r).unknown(t)},CK.apply(a,arguments)}),[vZ,fZ]),EZ(gZ,(function e(){var t,n=0,r=1,i=1,o=[.5],a=[0,1];function s(e){return null!=e&&e<=e?a[cY(o,e,0,i)]:t}function u(){var e=-1;for(o=new Array(i);++e<i;)o[e]=((e+1)*r-(e-i)*n)/(i+1);return s}return s.domain=function(e){return arguments.length?([n,r]=e,n=+n,r=+r,u()):[n,r]},s.range=function(e){return arguments.length?(i=(a=Array.from(e)).length-1,u()):a.slice()},s.invertExtent=function(e){var t=a.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,o[0]]:t>=i?[o[i-1],r]:[o[t-1],o[t]]},s.unknown=function(e){return arguments.length?(t=e,s):s},s.thresholds=function(){return o.slice()},s.copy=function(){return e().domain([n,r]).range(a).unknown(t)},CK.apply(EK(s),arguments)}),vZ),EZ(mZ,(function e(){var t,n=[.5],r=[0,1],i=1;function o(e){return null!=e&&e<=e?r[cY(n,e,0,i)]:t}return o.domain=function(e){return arguments.length?(n=Array.from(e),i=Math.min(n.length,r.length-1),o):n.slice()},o.range=function(e){return arguments.length?(r=Array.from(e),i=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},o.unknown=function(e){return arguments.length?(t=e,o):t},o.copy=function(){return e().domain(n).range(r).unknown(t)},CK.apply(o,arguments)}),vZ),EZ("bin-ordinal",(function e(){let t=[],n=[];function r(e){return null==e||e!=e?void 0:n[(cY(t,e)-1)%n.length]}return r.domain=function(e){return arguments.length?(t=function(e){return SZ.call(e,hW)}(e),r):t.slice()},r.range=function(e){return arguments.length?(n=CZ.call(e),r):n.slice()},r.tickFormat=function(e,n){return TK(t[0],dW(t),null==e?10:e,n)},r.copy=function(){return e().domain(r.domain()).range(r.range())},r}),[bZ,vZ]),EZ("ordinal",uJ,bZ),EZ("band",wZ,bZ),EZ("point",(function(){return kZ(wZ().paddingInner(1))}),bZ);const NZ={};function DZ(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(NZ[e]=t,this):NZ[e]}RZ({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},OZ),RZ({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(e=>function(e,t,n){return rJ(function(e,t){const n=y[function(e){return"interpolate"+e.toLowerCase().split("-").map((e=>e[0].toUpperCase()+e.slice(1))).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}(t||"rgb",n),e)}(OZ(e))));const IZ="symbol",BZ="discrete",LZ=e=>cW(e)?e.map((e=>String(e))):String(e),PZ=(e,t)=>e[1]-t[1],$Z=(e,t)=>t[1]-e[1];function zZ(e,t){return e.bins?function(e,t,n){let r=e.range(),i=r[0],o=dW(r),a=PZ;return i>o&&(r=o,o=i,i=r,a=$Z),i=Math.floor(i),o=Math.ceil(o),t=t.map((t=>[t,e(t)])).filter((e=>i<=e[1]&&e[1]<=o)).sort(a).map((e=>e[0]))}(e,e.bins):e.ticks?e.ticks(t):e.domain()}function jZ(e,t,n){const r=zZ(e,t),i=e.base(),o=Math.log(i),a=Math.max(1,i*t/r.length),s=e=>{let t=e/Math.pow(i,Math.round(Math.log(e)/o));return t*i<i-.5&&(t*=i),t<=a};return n?r.filter(s):s}const GZ={[fZ]:"quantiles",[gZ]:"thresholds",[mZ]:"domain"},UZ={[fZ]:"quantiles",[gZ]:"domain"};const WZ=e=>GZ[e.type]||e.bins;function VZ(e,t,n,r,i,o,a){const s=UZ[t.type]&&o!==cZ&&o!==pZ?function(e,t,n){const r=t[UZ[t.type]](),i=r.length;let o,a=i>1?r[1]-r[0]:r[0];for(o=1;o<i;++o)a=Math.min(a,r[o]-r[o-1]);return e.formatSpan(0,a,30,n)}(e,t,i):function(e,t,n,r,i,o){const a=t.type;let s=LZ;if(a===cZ||i===cZ)s=e.timeFormat(r);else if(a===pZ||i===pZ)s=e.utcFormat(r);else if(function(e){return AZ(e,aZ)}(a)){const i=e.formatFloat(r);if(o||t.bins)s=i;else{const e=jZ(t,n,!1);s=t=>e(t)?i(t):""}}else if(t.tickFormat){const i=t.domain();s=e.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=e.format(r));return s}(e,t,n,i,o,a);return r===IZ&&WZ(t)?HZ(s):r===BZ?XZ(s):YZ(s)}const HZ=e=>(t,n,r)=>{const i=qZ(r[n+1],qZ(r.max,1/0)),o=KZ(t,e),a=KZ(i,e);return o&&a?o+"  "+a:a?"< "+a:" "+o},qZ=(e,t)=>null!=e?e:t,XZ=e=>(t,n)=>n?e(t):null,YZ=e=>t=>e(t),KZ=(e,t)=>Number.isFinite(e)?t(e):null;function JZ(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=function(e,t,n,r){const i=r||t.type;return _W(n)&&function(e){return AZ(e,_Z)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==cZ?n||i!==pZ?VZ(e,t,5,null,n,r,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}(e,t,n.format,n.formatType);if(function(e){return AZ(e,vZ)}(t.type)){const e=function(e,t){return e.bins?function(e){const t=e.slice(0,-1);return t.max=dW(e),t}(e.bins):e.type===aZ?jZ(e,t,!0):GZ[e.type]?function(e){const t=[-1/0].concat(e);return t.max=1/0,t}(e[GZ[e.type]]()):zZ(e,t)}(t).slice(1).map(i),n=e.length;return`${n} boundar${1===n?"y":"ies"}: ${e.join(", ")}`}if(FZ(t.type)){const e=t.domain(),n=e.length;return`${n} value${1===n?"":"s"}: ${n>r?e.slice(0,r-2).map(i).join(", ")+", ending with "+e.slice(-1).map(i):e.map(i).join(", ")}`}{const e=t.domain();return`values from ${i(e[0])} to ${i(dW(e))}`}}let ZZ=0;const QZ="p_";function eQ(e){return e&&e.gradient}function tQ(e,t,n){const r=e.gradient;let i=e.id,o="radial"===r?QZ:"";return i||(i=e.id="gradient_"+ZZ++,"radial"===r?(e.x1=nQ(e.x1,.5),e.y1=nQ(e.y1,.5),e.r1=nQ(e.r1,0),e.x2=nQ(e.x2,.5),e.y2=nQ(e.y2,.5),e.r2=nQ(e.r2,.5),o=QZ):(e.x1=nQ(e.x1,0),e.y1=nQ(e.y1,0),e.x2=nQ(e.x2,1),e.y2=nQ(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function nQ(e,t){return null!=e?e:t}function rQ(e,t){var n,r=[];return n={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:r,stop:function(e,t){return r.push({offset:e,color:t}),n}}}const iQ={basis:{curve:function(e){return new CW(e)}},"basis-closed":{curve:function(e){return new TW(e)}},"basis-open":{curve:function(e){return new EW(e)}},bundle:{curve:FW,tension:"beta",value:.85},cardinal:{curve:NW,tension:"tension",value:0},"cardinal-open":{curve:IW,tension:"tension",value:0},"cardinal-closed":{curve:LW,tension:"tension",value:0},"catmull-rom":{curve:ZW,tension:"alpha",value:.5},"catmull-rom-closed":{curve:eV,tension:"alpha",value:.5},"catmull-rom-open":{curve:nV,tension:"alpha",value:.5},linear:{curve:iV},"linear-closed":{curve:function(e){return new oV(e)}},monotone:{horizontal:function(e){return new pV(e)},vertical:function(e){return new cV(e)}},natural:{curve:function(e){return new hV(e)}},step:{curve:function(e){return new gV(e,.5)}},"step-after":{curve:function(e){return new gV(e,1)}},"step-before":{curve:function(e){return new gV(e,0)}}};function oQ(e,t,n){var r=bW(iQ,e)&&iQ[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const aQ={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},sQ=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function uQ(e){const t=[];let n,r,i,o,a,s,u,l,c,p;const d=e.slice().replace(sQ[0],"###$1").split(sQ[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=d[u],r=n.slice(1).trim().replace(sQ[2],"$1###$2").replace(sQ[3],"$1###$2").split(sQ[4]),a=n.charAt(0),i=[a],l=0,p=r.length;l<p;++l)(o=+r[l])===o&&i.push(o);if(s=aQ[a.toLowerCase()],i.length-1>s){const e=i.length;for(l=1,t.push([a].concat(i.slice(l,l+=s))),a="M"===a?"L":"m"===a?"l":a;l<e;l+=s)t.push([a].concat(i.slice(l,l+s)))}else t.push(i)}return t}const lQ=Math.PI/180,cQ=Math.PI/2,pQ=2*Math.PI,dQ=Math.sqrt(3)/2;var hQ={},fQ={},gQ=[].join;function mQ(e){const t=gQ.call(e);if(fQ[t])return fQ[t];var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7];const c=l*a,p=-u*s,d=u*a,h=l*s,f=Math.cos(i),g=Math.sin(i),m=Math.cos(o),y=Math.sin(o),b=.5*(o-i),v=Math.sin(.5*b),x=8/3*v*v/Math.sin(b),_=n+f-x*g,w=r+g+x*f,k=n+m,S=r+y,C=k+x*y,M=S-x*m;return fQ[t]=[c*_+p*w,d*_+h*w,c*C+p*M,d*C+h*M,c*k+p*S,d*k+h*S]}const yQ=["l",0,0,0,0,0,0,0];function bQ(e,t,n){const r=yQ[0]=e[0];if("a"===r||"A"===r)yQ[1]=t*e[1],yQ[2]=n*e[2],yQ[3]=e[3],yQ[4]=e[4],yQ[5]=e[5],yQ[6]=t*e[6],yQ[7]=n*e[7];else if("h"===r||"H"===r)yQ[1]=t*e[1];else if("v"===r||"V"===r)yQ[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)yQ[i]=(i%2==1?t:n)*e[i];return yQ}function vQ(e,t,n,r,i,o){var a,s,u,l,c,p=null,d=0,h=0,f=0,g=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==o&&(o=i),e.beginPath&&e.beginPath();for(var m=0,y=t.length;m<y;++m){switch(a=t[m],1===i&&1===o||(a=bQ(a,i,o)),a[0]){case"l":d+=a[1],h+=a[2],e.lineTo(d+n,h+r);break;case"L":d=a[1],h=a[2],e.lineTo(d+n,h+r);break;case"h":d+=a[1],e.lineTo(d+n,h+r);break;case"H":d=a[1],e.lineTo(d+n,h+r);break;case"v":h+=a[1],e.lineTo(d+n,h+r);break;case"V":h=a[1],e.lineTo(d+n,h+r);break;case"m":d+=a[1],h+=a[2],e.moveTo(d+n,h+r);break;case"M":d=a[1],h=a[2],e.moveTo(d+n,h+r);break;case"c":s=d+a[5],u=h+a[6],f=d+a[3],g=h+a[4],e.bezierCurveTo(d+a[1]+n,h+a[2]+r,f+n,g+r,s+n,u+r),d=s,h=u;break;case"C":d=a[5],h=a[6],f=a[3],g=a[4],e.bezierCurveTo(a[1]+n,a[2]+r,f+n,g+r,d+n,h+r);break;case"s":s=d+a[3],u=h+a[4],f=2*d-f,g=2*h-g,e.bezierCurveTo(f+n,g+r,d+a[1]+n,h+a[2]+r,s+n,u+r),f=d+a[1],g=h+a[2],d=s,h=u;break;case"S":s=a[3],u=a[4],f=2*d-f,g=2*h-g,e.bezierCurveTo(f+n,g+r,a[1]+n,a[2]+r,s+n,u+r),d=s,h=u,f=a[1],g=a[2];break;case"q":s=d+a[3],u=h+a[4],f=d+a[1],g=h+a[2],e.quadraticCurveTo(f+n,g+r,s+n,u+r),d=s,h=u;break;case"Q":s=a[3],u=a[4],e.quadraticCurveTo(a[1]+n,a[2]+r,s+n,u+r),d=s,h=u,f=a[1],g=a[2];break;case"t":s=d+a[1],u=h+a[2],null===p[0].match(/[QqTt]/)?(f=d,g=h):"t"===p[0]?(f=2*d-l,g=2*h-c):"q"===p[0]&&(f=2*d-f,g=2*h-g),l=f,c=g,e.quadraticCurveTo(f+n,g+r,s+n,u+r),h=u,f=(d=s)+a[1],g=h+a[2];break;case"T":s=a[1],u=a[2],f=2*d-f,g=2*h-g,e.quadraticCurveTo(f+n,g+r,s+n,u+r),d=s,h=u;break;case"a":xQ(e,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+d+n,a[7]+h+r]),d+=a[6],h+=a[7];break;case"A":xQ(e,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),d=a[6],h=a[7];break;case"z":case"Z":e.closePath()}p=a}}function xQ(e,t,n,r){const i=function(e,t,n,r,i,o,a,s,u){const l=gQ.call(arguments);if(hQ[l])return hQ[l];const c=a*lQ,p=Math.sin(c),d=Math.cos(c),h=d*(s-e)*.5+p*(u-t)*.5,f=d*(u-t)*.5-p*(s-e)*.5;let g=h*h/((n=Math.abs(n))*n)+f*f/((r=Math.abs(r))*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,y=p/n,b=-p/r,v=d/r,x=m*s+y*u,_=b*s+v*u,w=m*e+y*t,k=b*e+v*t;let S=1/((w-x)*(w-x)+(k-_)*(k-_))-.25;S<0&&(S=0);let C=Math.sqrt(S);o==i&&(C=-C);const M=.5*(x+w)-C*(k-_),T=.5*(_+k)+C*(w-x),E=Math.atan2(_-T,x-M);let A=Math.atan2(k-T,w-M)-E;A<0&&1===o?A+=pQ:A>0&&0===o&&(A-=pQ);const F=Math.ceil(Math.abs(A/(cQ+.001))),O=[];for(let e=0;e<F;++e){const t=E+e*A/F,i=E+(e+1)*A/F;O[e]=[M,T,t,i,n,r,p,d]}return hQ[l]=O}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let t=0;t<i.length;++t){const n=mQ(i[t]);e.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5])}}const _Q=.5773502691896257,wQ={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,pQ)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=dQ*n,i=r-n*_Q,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=dQ*n,i=r-n*_Q;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=dQ*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=dQ*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=dQ*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=dQ*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function kQ(e){return bW(wQ,e)?wQ[e]:function(e){if(!bW(SQ,e)){const t=uQ(e);SQ[e]={draw:function(e,n){vQ(e,t,0,0,Math.sqrt(n)/2)}}}return SQ[e]}(e)}var SQ={};const CQ=.448084975506;function MQ(e){return e.x}function TQ(e){return e.y}function EQ(e){return e.width}function AQ(e){return e.height}function FQ(e){return"function"==typeof e?e:()=>+e}function OQ(e,t,n){return Math.max(t,Math.min(e,n))}function RQ(){var e=MQ,t=TQ,n=EQ,r=AQ,i=FQ(0),o=i,a=i,s=i,u=null;function l(l,c,p){var d,h=null!=c?c:+e.call(this,l),f=null!=p?p:+t.call(this,l),g=+n.call(this,l),m=+r.call(this,l),y=Math.min(g,m)/2,b=OQ(+i.call(this,l),0,y),v=OQ(+o.call(this,l),0,y),x=OQ(+a.call(this,l),0,y),_=OQ(+s.call(this,l),0,y);if(u||(u=d=wV()),b<=0&&v<=0&&x<=0&&_<=0)u.rect(h,f,g,m);else{var w=h+g,k=f+m;u.moveTo(h+b,f),u.lineTo(w-v,f),u.bezierCurveTo(w-CQ*v,f,w,f+CQ*v,w,f+v),u.lineTo(w,k-_),u.bezierCurveTo(w,k-CQ*_,w-CQ*_,k,w-_,k),u.lineTo(h+x,k),u.bezierCurveTo(h+CQ*x,k,h,k-CQ*x,h,k-x),u.lineTo(h,f+b),u.bezierCurveTo(h,f+CQ*b,h+CQ*b,f,h+b,f),u.closePath()}if(d)return u=null,d+""||null}return l.x=function(t){return arguments.length?(e=FQ(t),l):e},l.y=function(e){return arguments.length?(t=FQ(e),l):t},l.width=function(e){return arguments.length?(n=FQ(e),l):n},l.height=function(e){return arguments.length?(r=FQ(e),l):r},l.cornerRadius=function(e,t,n,r){return arguments.length?(i=FQ(e),o=null!=t?FQ(t):i,s=null!=n?FQ(n):i,a=null!=r?FQ(r):o,l):i},l.context=function(e){return arguments.length?(u=null==e?null:e,l):u},l}function NQ(){var e,t,n,r,i,o,a,s,u=null;function l(e,t,n){const r=n/2;if(i){var l=a-t,c=e-o;if(l||c){var p=Math.sqrt(l*l+c*c),d=(l/=p)*s,h=(c/=p)*s,f=Math.atan2(c,l);u.moveTo(o-d,a-h),u.lineTo(e-l*r,t-c*r),u.arc(e,t,r,f-Math.PI,f),u.lineTo(o+d,a+h),u.arc(o,a,s,f,f+Math.PI)}else u.arc(e,t,r,0,pQ);u.closePath()}else i=1;o=e,a=t,s=r}function c(o){var a,s,c,p=o.length,d=!1;for(null==u&&(u=c=wV()),a=0;a<=p;++a)!(a<p&&r(s=o[a],a,o))===d&&(d=!d)&&(i=0),d&&l(+e(s,a,o),+t(s,a,o),+n(s,a,o));if(c)return u=null,c+""||null}return c.x=function(t){return arguments.length?(e=t,c):e},c.y=function(e){return arguments.length?(t=e,c):t},c.size=function(e){return arguments.length?(n=e,c):n},c.defined=function(e){return arguments.length?(r=e,c):r},c.context=function(e){return arguments.length?(u=null==e?null:e,c):u},c}function DQ(e,t){return null!=e?e:t}const IQ=e=>e.x||0,BQ=e=>e.y||0,LQ=e=>!(!1===e.defined),PQ=function(){var e=SV,t=CV,n=kV(0),r=null,i=MV,o=TV,a=EV,s=null;function u(){var u,l,c=+e.apply(this,arguments),p=+t.apply(this,arguments),d=i.apply(this,arguments)-qW,h=o.apply(this,arguments)-qW,f=PW(h-d),g=h>d;if(s||(s=u=wV()),p<c&&(l=p,p=c,c=l),p>VW)if(f>XW-VW)s.moveTo(p*zW(d),p*UW(d)),s.arc(0,0,p,d,h,!g),c>VW&&(s.moveTo(c*zW(h),c*UW(h)),s.arc(0,0,c,h,d,g));else{var m,y,b=d,v=h,x=d,_=h,w=f,k=f,S=a.apply(this,arguments)/2,C=S>VW&&(r?+r.apply(this,arguments):WW(c*c+p*p)),M=GW(PW(p-c)/2,+n.apply(this,arguments)),T=M,E=M;if(C>VW){var A=YW(C/c*UW(S)),F=YW(C/p*UW(S));(w-=2*A)>VW?(x+=A*=g?1:-1,_-=A):(w=0,x=_=(d+h)/2),(k-=2*F)>VW?(b+=F*=g?1:-1,v-=F):(k=0,b=v=(d+h)/2)}var O=p*zW(b),R=p*UW(b),N=c*zW(_),D=c*UW(_);if(M>VW){var I,B=p*zW(v),L=p*UW(v),P=c*zW(x),$=c*UW(x);if(f<HW&&(I=function(e,t,n,r,i,o,a,s){var u=n-e,l=r-t,c=a-i,p=s-o,d=p*u-c*l;if(!(d*d<VW))return[e+(d=(c*(t-o)-p*(e-i))/d)*u,t+d*l]}(O,R,P,$,B,L,N,D))){var z=O-I[0],j=R-I[1],G=B-I[0],U=L-I[1],W=1/UW(function(e){return e>1?0:e<-1?HW:Math.acos(e)}((z*G+j*U)/(WW(z*z+j*j)*WW(G*G+U*U)))/2),V=WW(I[0]*I[0]+I[1]*I[1]);T=GW(M,(c-V)/(W-1)),E=GW(M,(p-V)/(W+1))}}k>VW?E>VW?(m=AV(P,$,O,R,p,E,g),y=AV(B,L,N,D,p,E,g),s.moveTo(m.cx+m.x01,m.cy+m.y01),E<M?s.arc(m.cx,m.cy,E,$W(m.y01,m.x01),$W(y.y01,y.x01),!g):(s.arc(m.cx,m.cy,E,$W(m.y01,m.x01),$W(m.y11,m.x11),!g),s.arc(0,0,p,$W(m.cy+m.y11,m.cx+m.x11),$W(y.cy+y.y11,y.cx+y.x11),!g),s.arc(y.cx,y.cy,E,$W(y.y11,y.x11),$W(y.y01,y.x01),!g))):(s.moveTo(O,R),s.arc(0,0,p,b,v,!g)):s.moveTo(O,R),c>VW&&w>VW?T>VW?(m=AV(N,D,B,L,c,-T,g),y=AV(O,R,P,$,c,-T,g),s.lineTo(m.cx+m.x01,m.cy+m.y01),T<M?s.arc(m.cx,m.cy,T,$W(m.y01,m.x01),$W(y.y01,y.x01),!g):(s.arc(m.cx,m.cy,T,$W(m.y01,m.x01),$W(m.y11,m.x11),!g),s.arc(0,0,c,$W(m.cy+m.y11,m.cx+m.x11),$W(y.cy+y.y11,y.cx+y.x11),g),s.arc(y.cx,y.cy,T,$W(y.y11,y.x11),$W(y.y01,y.x01),!g))):s.arc(0,0,c,_,x,g):s.lineTo(N,D)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-HW/2;return[zW(r)*n,UW(r)*n]},u.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:kV(+t),u):e},u.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:kV(+e),u):t},u.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:kV(+e),u):n},u.padRadius=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:kV(+e),u):r},u.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:kV(+e),u):i},u.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:kV(+e),u):o},u.padAngle=function(e){return arguments.length?(a="function"==typeof e?e:kV(+e),u):a},u.context=function(e){return arguments.length?(s=null==e?null:e,u):s},u}().startAngle((e=>e.startAngle||0)).endAngle((e=>e.endAngle||0)).padAngle((e=>e.padAngle||0)).innerRadius((e=>e.innerRadius||0)).outerRadius((e=>e.outerRadius||0)).cornerRadius((e=>e.cornerRadius||0)),$Q=DV().x(IQ).y1(BQ).y0((e=>(e.y||0)+(e.height||0))).defined(LQ),zQ=DV().y(BQ).x1(IQ).x0((e=>(e.x||0)+(e.width||0))).defined(LQ),jQ=NV().x(IQ).y(BQ).defined(LQ),GQ=RQ().x(IQ).y(BQ).width((e=>e.width||0)).height((e=>e.height||0)).cornerRadius((e=>DQ(e.cornerRadiusTopLeft,e.cornerRadius)||0),(e=>DQ(e.cornerRadiusTopRight,e.cornerRadius)||0),(e=>DQ(e.cornerRadiusBottomRight,e.cornerRadius)||0),(e=>DQ(e.cornerRadiusBottomLeft,e.cornerRadius)||0)),UQ=function(e,t){var n=null;function r(){var r;if(n||(n=r=wV()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return e="function"==typeof e?e:kV(e||IV),t="function"==typeof t?t:kV(void 0===t?64:+t),r.type=function(t){return arguments.length?(e="function"==typeof t?t:kV(t),r):e},r.size=function(e){return arguments.length?(t="function"==typeof e?e:kV(+e),r):t},r.context=function(e){return arguments.length?(n=null==e?null:e,r):n},r}().type((e=>kQ(e.shape||"circle"))).size((e=>DQ(e.size,64))),WQ=NQ().x(IQ).y(BQ).defined(LQ).size((e=>e.size||1));function VQ(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function HQ(e,t,n,r){return GQ.context(e)(t,n,r)}var qQ=1;function XQ(){qQ=1}function YQ(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+qQ++),a=i.clipping[o]||(i.clipping[o]={id:o});return gW(r)?a.path=r(null):VQ(n)?a.path=HQ(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"}function KQ(e){this.clear(),e&&this.union(e)}function JQ(e){this.mark=e,this.bounds=this.bounds||new KQ}function ZQ(e){JQ.call(this,e),this.items=this.items||[]}function QQ(e){this._pending=0,this._loader=e||nY()}function e0(e){e._pending+=1}function t0(e){e._pending-=1}function n0(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){const r=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(r+(n?function(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,r):0))}return e}KQ.prototype={clone(){return new KQ(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:o,y2:a}=this,s=Math.cos(e),u=Math.sin(e),l=t-t*s+n*u,c=n-t*u-n*s;return[s*r-u*i+l,u*r+s*i+c,s*r-u*a+l,u*r+s*a+c,s*o-u*i+l,u*o+s*i+c,s*o-u*a+l,u*o+s*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},vW(ZQ,JQ),QQ.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return e0(t),t._loader.sanitize(e,{context:"href"}).then((e=>(t0(t),e))).catch((()=>(t0(t),null)))},loadImage(e){const t=this,n=$d();return e0(t),t._loader.sanitize(e,{context:"image"}).then((e=>{const r=e.href;if(!r||!n)throw{url:r};const i=new n,o=bW(e,"crossOrigin")?e.crossOrigin:"anonymous";return null!=o&&(i.crossOrigin=o),i.onload=()=>t0(t),i.onerror=()=>t0(t),i.src=r,i})).catch((e=>(t0(t),{complete:!1,width:0,height:0,src:e&&e.url||""})))},ready(){const e=this;return new Promise((t=>{!function n(r){e.pending()?setTimeout((()=>{n(!0)}),10):t(r)}(!1)}))}};const r0=pQ-1e-8;let i0,o0,a0,s0,u0,l0,c0,p0;const d0=(e,t)=>i0.add(e,t),h0=(e,t)=>d0(o0=e,a0=t),f0=e=>d0(e,i0.y1),g0=e=>d0(i0.x1,e),m0=(e,t)=>u0*e+c0*t,y0=(e,t)=>l0*e+p0*t,b0=(e,t)=>d0(m0(e,t),y0(e,t)),v0=(e,t)=>h0(m0(e,t),y0(e,t));function x0(e,t){return i0=e,t?(s0=t*lQ,u0=p0=Math.cos(s0),l0=Math.sin(s0),c0=-l0):(u0=p0=1,s0=l0=c0=0),_0}const _0={beginPath(){},closePath(){},moveTo:v0,lineTo:v0,rect(e,t,n,r){s0?(b0(e+n,t),b0(e+n,t+r),b0(e,t+r),v0(e,t)):(d0(e+n,t+r),h0(e,t))},quadraticCurveTo(e,t,n,r){const i=m0(e,t),o=y0(e,t),a=m0(n,r),s=y0(n,r);w0(o0,i,a,f0),w0(a0,o,s,g0),h0(a,s)},bezierCurveTo(e,t,n,r,i,o){const a=m0(e,t),s=y0(e,t),u=m0(n,r),l=y0(n,r),c=m0(i,o),p=y0(i,o);k0(o0,a,u,c,f0),k0(a0,s,l,p,g0),h0(c,p)},arc(e,t,n,r,i,o){if(r+=s0,i+=s0,o0=n*Math.cos(i)+e,a0=n*Math.sin(i)+t,Math.abs(i-r)>r0)d0(e-n,t-n),d0(e+n,t+n);else{const a=r=>d0(n*Math.cos(r)+e,n*Math.sin(r)+t);let s,u;if(a(r),a(i),i!==r)if((r%=pQ)<0&&(r+=pQ),(i%=pQ)<0&&(i+=pQ),i<r&&(o=!o,s=r,r=i,i=s),o)for(i-=pQ,s=r-r%cQ,u=0;u<4&&s>i;++u,s-=cQ)a(s);else for(s=r-r%cQ+cQ,u=0;u<4&&s<i;++u,s+=cQ)a(s)}}};function w0(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function k0(e,t,n,r,i){const o=r-e+3*t-3*n,a=e+n-2*t,s=e-t;let u,l=0,c=0;Math.abs(o)>1e-14?(u=a*a+s*o,u>=0&&(u=Math.sqrt(u),l=(-a+u)/o,c=(-a-u)/o)):l=.5*s/a,0<l&&l<1&&i(S0(l,e,t,n,r)),0<c&&c<1&&i(S0(c,e,t,n,r))}function S0(e,t,n,r,i){const o=1-e,a=o*o,s=e*e;return a*o*t+3*a*e*n+3*o*s*r+s*e*i}var C0=(C0=Pd(1,1))?C0.getContext("2d"):null;const M0=new KQ;function T0(e){return function(t,n){if(!C0)return!0;e(C0,t),M0.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:a}=M0;for(let e=i;e<=a;++e)for(let t=r;t<=o;++t)if(C0.isPointInPath(t,e))return!0;return!1}}function E0(e,t){return t.contains(e.x||0,e.y||0)}function A0(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,o=e.height||0;return t.intersects(M0.set(n,r,n+i,r+o))}function F0(e,t){const n=e.x||0,r=e.y||0;return O0(t,n,r,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r)}function O0(e,t,n,r,i){const{x1:o,y1:a,x2:s,y2:u}=e,l=r-t,c=i-n;let p,d,h,f,g=0,m=1;for(f=0;f<4;++f){if(0===f&&(p=-l,d=-(o-t)),1===f&&(p=l,d=s-t),2===f&&(p=-c,d=-(a-n)),3===f&&(p=c,d=u-n),Math.abs(p)<1e-10&&d<0)return!1;if(h=d/p,p<0){if(h>m)return!1;h>g&&(g=h)}else if(p>0){if(h<g)return!1;h<m&&(m=h)}}return!0}function R0(e,t){e.globalCompositeOperation=t.blend||"source-over"}function N0(e,t){return null==e?t:e}function D0(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function I0(e,t,n){return eQ(n)?function(e,t,n){const r=n.width(),i=n.height();let o;if("radial"===t.gradient)o=e.createRadialGradient(n.x1+N0(t.x1,.5)*r,n.y1+N0(t.y1,.5)*i,Math.max(r,i)*N0(t.r1,0),n.x1+N0(t.x2,.5)*r,n.y1+N0(t.y2,.5)*i,Math.max(r,i)*N0(t.r2,.5));else{const a=N0(t.x1,0),s=N0(t.y1,0),u=N0(t.x2,1),l=N0(t.y2,0);if(a!==u&&s!==l&&r!==i){const n=Pd(Math.ceil(r),Math.ceil(i)),o=n.getContext("2d");return o.scale(r,i),o.fillStyle=D0(o.createLinearGradient(a,s,u,l),t.stops),o.fillRect(0,0,r,i),e.createPattern(n,"no-repeat")}o=e.createLinearGradient(n.x1+a*r,n.y1+s*i,n.x1+u*r,n.y1+l*i)}return D0(o,t.stops)}(e,n,t.bounds):n}function B0(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=I0(e,t,t.fill),!0)}var L0=[];function P0(e,t,n){var r=null!=(r=t.strokeWidth)?r:1;return!(r<=0)&&(n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=I0(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||L0),e.lineDashOffset=t.strokeDashOffset||0),!0)}function $0(e,t){return e.zindex-t.zindex||e.index-t.index}function z0(e){if(!e.zdirty)return e.zitems;var t,n,r,i=e.items,o=[];for(n=0,r=i.length;n<r;++n)(t=i[n]).index=n,t.zindex&&o.push(t);return e.zdirty=!1,e.zitems=o.sort($0)}function j0(e,t){var n,r,i=e.items;if(!i||!i.length)return;const o=z0(e);if(o&&o.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||t(i[n]);i=o}for(n=0,r=i.length;n<r;++n)t(i[n])}function G0(e,t){var n,r,i=e.items;if(!i||!i.length)return null;const o=z0(e);for(o&&o.length&&(i=o),r=i.length;--r>=0;)if(n=t(i[r]))return n;if(i===o)for(r=(i=e.items).length;--r>=0;)if(!i[r].zindex&&(n=t(i[r])))return n;return null}function U0(e){return function(t,n,r){j0(n,(n=>{r&&!r.intersects(n.bounds)||W0(e,t,n,n)}))}}function W0(e,t,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(e(t,r)||(R0(t,n),n.fill&&B0(t,n,i)&&t.fill(),n.stroke&&P0(t,n,i)&&t.stroke()))}function V0(e){return e=e||lW,function(t,n,r,i,o,a){return r*=t.pixelRatio,i*=t.pixelRatio,G0(n,(n=>{const s=n.bounds;if((!s||s.contains(o,a))&&s)return e(t,n,r,i,o,a)?n:void 0}))}}function H0(e,t){return function(n,r,i,o){var a,s,u=Array.isArray(r)?r[0]:r,l=null==t?u.fill:t,c=u.stroke&&n.isPointInStroke;return c&&(a=u.strokeWidth,s=u.strokeCap,n.lineWidth=null!=a?a:1,n.lineCap=null!=s?s:"butt"),!e(n,r)&&(l&&n.isPointInPath(i,o)||c&&n.isPointInStroke(i,o))}}function q0(e){return V0(H0(e))}function X0(e,t){return"translate("+e+","+t+")"}function Y0(e){return"rotate("+e+")"}function K0(e){return X0(e.x||0,e.y||0)}function J0(e,t,n){function r(e,n){var r=n.x||0,i=n.y||0,o=n.angle||0;e.translate(r,i),o&&e.rotate(o*=lQ),e.beginPath(),t(e,n),o&&e.rotate(-o),e.translate(-r,-i)}return{type:e,tag:"path",nested:!1,attr:function(e,n){e("transform",function(e){return X0(e.x||0,e.y||0)+(e.angle?" "+Y0(e.angle):"")}(n)),e("d",t(null,n))},bound:function(e,n){return t(x0(e,n.angle),n),n0(e,n).translate(n.x||0,n.y||0)},draw:U0(r),pick:q0(r),isect:n||T0(r)}}var Z0=J0("arc",(function(e,t){return PQ.context(e)(t)}));function Q0(e,t,n){function r(e,n){e.beginPath(),t(e,n)}const i=H0(r);return{type:e,tag:"path",nested:!0,attr:function(e,n){var r=n.mark.items;r.length&&e("d",t(null,r))},bound:function(e,n){var r=n.items;return 0===r.length?e:(t(x0(e),r),n0(e,r[0]))},draw:(o=r,function(e,t,n){!t.items.length||n&&!n.intersects(t.bounds)||W0(o,e,t.items[0],t.items)}),pick:function(e,t,n,r,o,a){var s=t.items,u=t.bounds;return!s||!s.length||u&&!u.contains(o,a)?null:(n*=e.pixelRatio,r*=e.pixelRatio,i(e,s,n,r)?s[0]:null)},isect:E0,tip:n};var o}var e1=Q0("area",(function(e,t){const n=t[0],r=n.interpolate||"linear";return("horizontal"===n.orient?zQ:$Q).curve(oQ(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,i="horizontal"===e[0].orient?t[1]:t[0],o="horizontal"===e[0].orient?"y":"x",a=e.length,s=1/0;--a>=0;)!1!==e[a].defined&&(r=Math.abs(e[a][o]-i))<s&&(s=r,n=e[a]);return n}));function t1(e,t){e.beginPath(),VQ(t)?HQ(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function n1(e){const t=N0(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function r1(e,t){const n=n1(t);e("d",HQ(null,t,n,n))}function i1(e,t,n,r){const i=n1(t);e.beginPath(),HQ(e,t,(n||0)+i,(r||0)+i)}const o1=H0(i1),a1=H0(i1,!1),s1=H0(i1,!0);var u1={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",K0(t))},bound:function(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let t=0;t<r;++t)e.union(n[t].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),n0(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){j0(t,(t=>{const r=t.x||0,i=t.y||0,o=t.strokeForeground,a=null==t.opacity?1:t.opacity;(t.stroke||t.fill)&&a&&(i1(e,t,r,i),R0(e,t),t.fill&&B0(e,t,a)&&e.fill(),t.stroke&&!o&&P0(e,t,a)&&e.stroke()),e.save(),e.translate(r,i),t.clip&&t1(e,t),n&&n.translate(-r,-i),j0(t,(t=>{this.draw(e,t,n)})),n&&n.translate(r,i),e.restore(),o&&t.stroke&&a&&(i1(e,t,r,i),R0(e,t),P0(e,t,a)&&e.stroke())}))},pick:function(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;const a=n*e.pixelRatio,s=r*e.pixelRatio;return G0(t,(u=>{let l,c,p;const d=u.bounds;if(d&&!d.contains(i,o))return;c=u.x||0,p=u.y||0;const h=c+(u.width||0),f=p+(u.height||0),g=u.clip;if(g&&(i<c||i>h||o<p||o>f))return;if(e.save(),e.translate(c,p),c=i-c,p=o-p,g&&VQ(u)&&!s1(e,u,a,s))return e.restore(),null;const m=u.strokeForeground,y=!1!==t.interactive;return y&&m&&u.stroke&&a1(e,u,a,s)?(e.restore(),u):(l=G0(u,(e=>function(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(e,c,p)?this.pick(e,n,r,c,p):null)),!l&&y&&(u.fill||!m&&u.stroke)&&o1(e,u,a,s)&&(l=u),e.restore(),l||null)}))},isect:A0,content:function(e,t,n){e("clip-path",t.clip?YQ(n,t,t):null)},background:function(e,t){e("class","background"),e("aria-hidden",!0),r1(e,t)},foreground:function(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?r1(e,t):e("d","")}},l1={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function c1(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then((t=>{e.image=t,e.image.url=e.url}))),n}function p1(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function d1(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function h1(e,t){return"center"===e?t/2:"right"===e?t:0}function f1(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var g1={type:"image",tag:"image",nested:!1,attr:function(e,t,n){const r=c1(t,n),i=p1(t,r),o=d1(t,r),a=(t.x||0)-h1(t.align,i),s=(t.y||0)-f1(t.baseline,o);e("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",l1["xmlns:xlink"],"xlink:href"),e("transform",X0(a,s)),e("width",i),e("height",o),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function(e,t){const n=t.image,r=p1(t,n),i=d1(t,n),o=(t.x||0)-h1(t.align,r),a=(t.y||0)-f1(t.baseline,i);return e.set(o,a,o+r,a+i)},draw:function(e,t,n){j0(t,(t=>{if(n&&!n.intersects(t.bounds))return;const r=c1(t,this);let i=p1(t,r),o=d1(t,r);if(0===i||0===o)return;let a,s,u,l,c=(t.x||0)-h1(t.align,i),p=(t.y||0)-f1(t.baseline,o);!1!==t.aspect&&(s=r.width/r.height,u=t.width/t.height,s==s&&u==u&&s!==u&&(u<s?(l=i/s,p+=(o-l)/2,o=l):(l=o*s,c+=(i-l)/2,i=l))),(r.complete||r.toDataURL)&&(R0(e,t),e.globalAlpha=null!=(a=t.opacity)?a:1,e.imageSmoothingEnabled=!1!==t.smooth,e.drawImage(r,c,p,i,o))}))},pick:V0(),isect:lW,get:c1,xOffset:h1,yOffset:f1},m1=Q0("line",(function(e,t){const n=t[0],r=n.interpolate||"linear";return jQ.curve(oQ(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,i=Math.pow(e[0].strokeWidth||1,2),o=e.length;--o>=0;)if(!1!==e[o].defined&&(n=e[o].x-t[0])*n+(r=e[o].y-t[1])*r<i)return e[o];return null}));function y1(e,t){var n=t.path;if(null==n)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,a=t.scaleY||1,s=(t.angle||0)*lQ,u=t.pathCache;u&&u.path===n||((t.pathCache=u=uQ(n)).path=n),s&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(s),vQ(e,u,0,0,o,a),e.rotate(-s),e.translate(-r,-i)):vQ(e,u,r,i,o,a)}var b1={type:"path",tag:"path",nested:!1,attr:function(e,t){var n=t.scaleX||1,r=t.scaleY||1;1===n&&1===r||e("vector-effect","non-scaling-stroke"),e("transform",function(e){return X0(e.x||0,e.y||0)+(e.angle?" "+Y0(e.angle):"")+(e.scaleX||e.scaleY?" "+(t=e.scaleX||1,n=e.scaleY||1,"scale("+t+","+n+")"):"");var t,n}(t)),e("d",t.path)},bound:function(e,t){return y1(x0(e,t.angle),t)?e.set(0,0,0,0):n0(e,t,!0)},draw:U0(y1),pick:q0(y1),isect:T0(y1)};function v1(e,t){e.beginPath(),HQ(e,t)}var x1={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",HQ(null,t))},bound:function(e,t){var n,r;return n0(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)},draw:U0(v1),pick:q0(v1),isect:A0};function _1(e,t,n){var r,i,o,a;return!(!t.stroke||!P0(e,t,n)||(r=t.x||0,i=t.y||0,o=null!=t.x2?t.x2:r,a=null!=t.y2?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,a),0))}var w1={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",K0(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,r;return n0(e.set(n=t.x||0,r=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r),t)},draw:function(e,t,n){j0(t,(t=>{if(!n||n.intersects(t.bounds)){var r=null==t.opacity?1:t.opacity;r&&_1(e,t,r)&&(R0(e,t),e.stroke())}}))},pick:V0((function(e,t,n,r){return!!e.isPointInStroke&&_1(e,t,1)&&e.isPointInStroke(n,r)})),isect:F0},k1=J0("shape",(function(e,t){return(t.mark.shape||t.shape).context(e)(t)})),S1=J0("symbol",(function(e,t){return UQ.context(e)(t)}),E0);const C1=function(e){let t,n,r;e=+e||1e4;const i=()=>{t={},n={},r=0},o=(i,o)=>(++r>e&&(n=t,t={},r=1),t[i]=o);return i(),{clear:i,has:e=>bW(t,e)||bW(n,e),get:e=>bW(t,e)?t[e]:bW(n,e)?o(e,n[e]):void 0,set:(e,n)=>bW(t,e)?t[e]=n:o(e,n)}}();var M1={height:R1,measureWidth:F1,estimateWidth:E1,width:E1,canvas:T1};function T1(e){M1.width=e&&C0?F1:E1}function E1(e,t){return A1(B1(e,t),R1(e))}function A1(e,t){return~~(.8*e.length*t)}function F1(e,t){return R1(e)<=0||!(t=B1(e,t))?0:O1(t,P1(e))}function O1(e,t){const n=`(${t}) ${e}`;let r=C1.get(n);return void 0===r&&(C0.font=t,r=C0.measureText(e).width,C1.set(n,r)),r}function R1(e){return null!=e.fontSize?+e.fontSize||0:11}function N1(e){return null!=e.lineHeight?e.lineHeight:R1(e)+2}function D1(e){return t=e.lineBreak&&e.text&&!cW(e.text)?e.text.split(e.lineBreak):e.text,cW(t)?t.length>1?t:t[0]:t;var t}function I1(e){const t=D1(e);return(cW(t)?t.length-1:0)*N1(e)}function B1(e,t){const n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function(e,t){var n=+e.limit,r=function(e){if(M1.width===F1){const t=P1(e);return e=>O1(e,t)}{const t=R1(e);return e=>A1(e,t)}}(e);if(r(t)<n)return t;var i,o=e.ellipsis||"",a="rtl"===e.dir,s=0,u=t.length;if(n-=r(o),a){for(;s<u;)i=s+u>>>1,r(t.slice(i))>n?s=i+1:u=i;return o+t.slice(s)}for(;s<u;)i=1+(s+u>>>1),r(t.slice(0,i))<n?s=i:u=i-1;return t.slice(0,s)+o}(e,n):n}function L1(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function P1(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+R1(e)+"px "+L1(e,t)}function $1(e){var t=e.baseline,n=R1(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*N1(e):"line-bottom"===t?.29*n-.5*N1(e):0)}T1(!0);const z1={left:"start",center:"middle",right:"end"},j1=new KQ;function G1(e){var t,n=e.x||0,r=e.y||0,i=e.radius||0;return i&&(t=(e.theta||0)-cQ,n+=i*Math.cos(t),r+=i*Math.sin(t)),j1.x1=n,j1.y1=r,j1}function U1(e,t,n){var r,i=M1.height(t),o=t.align,a=G1(t),s=a.x1,u=a.y1,l=t.dx||0,c=(t.dy||0)+$1(t)-Math.round(.8*i),p=D1(t);if(cW(p)?(i+=N1(t)*(p.length-1),r=p.reduce(((e,n)=>Math.max(e,M1.width(t,n))),0)):r=M1.width(t,p),"center"===o?l-=r/2:"right"===o&&(l-=r),e.set(l+=s,c+=u,l+r,c+i),t.angle&&!n)e.rotate(t.angle*lQ,s,u);else if(2===n)return e.rotatedPoints(t.angle*lQ,s,u);return e}var W1={type:"text",tag:"text",nested:!1,attr:function(e,t){var n,r=t.dx||0,i=(t.dy||0)+$1(t),o=G1(t),a=o.x1,s=o.y1,u=t.angle||0;e("text-anchor",z1[t.align]||"start"),u?(n=X0(a,s)+" "+Y0(u),(r||i)&&(n+=" "+X0(r,i))):n=X0(a+r,s+i),e("transform",n)},bound:U1,draw:function(e,t,n){j0(t,(t=>{var r,i,o,a,s,u,l,c=null==t.opacity?1:t.opacity;if(!(n&&!n.intersects(t.bounds)||0===c||t.fontSize<=0||null==t.text||0===t.text.length)){if(e.font=P1(t),e.textAlign=t.align||"left",i=(r=G1(t)).x1,o=r.y1,t.angle&&(e.save(),e.translate(i,o),e.rotate(t.angle*lQ),i=o=0),i+=t.dx||0,o+=(t.dy||0)+$1(t),u=D1(t),R0(e,t),cW(u))for(s=N1(t),a=0;a<u.length;++a)l=B1(t,u[a]),t.fill&&B0(e,t,c)&&e.fillText(l,i,o),t.stroke&&P0(e,t,c)&&e.strokeText(l,i,o),o+=s;else l=B1(t,u),t.fill&&B0(e,t,c)&&e.fillText(l,i,o),t.stroke&&P0(e,t,c)&&e.strokeText(l,i,o);t.angle&&e.restore()}}))},pick:V0((function(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=G1(t),s=a.x1,u=a.y1,l=U1(j1,t,1),c=-t.angle*lQ,p=Math.cos(c),d=Math.sin(c),h=p*i-d*o+(s-p*s+d*u),f=d*i+p*o+(u-d*s-p*u);return l.contains(h,f)})),isect:function(e,t){const n=U1(j1,e,2);return O0(t,n[0],n[1],n[2],n[3])||O0(t,n[0],n[1],n[4],n[5])||O0(t,n[4],n[5],n[6],n[7])||O0(t,n[2],n[3],n[6],n[7])}},V1=Q0("trail",(function(e,t){return WQ.context(e)(t)}),(function(e,t){for(var n,r,i=e.length;--i>=0;)if(!1!==e[i].defined&&(n=e[i].x-t[0])*n+(r=e[i].y-t[1])*r<(n=e[i].size||1)*n)return e[i];return null})),H1={arc:Z0,area:e1,group:u1,image:g1,line:m1,path:b1,rect:x1,rule:w1,shape:k1,symbol:S1,text:W1,trail:V1};function q1(e,t,n){var r=H1[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new KQ),e,n)}var X1={mark:null};function Y1(e,t,n){var r,i,o,a,s=H1[e.marktype],u=s.bound,l=e.items,c=l&&l.length;if(s.nested)return c?o=l[0]:(X1.mark=e,o=X1),a=q1(o,u,n),t&&t.union(a)||a;if(t=t||e.bounds&&e.bounds.clear()||new KQ,c)for(r=0,i=l.length;r<i;++r)t.union(q1(l[r],u,n));return e.bounds=t}const K1=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function J1(e,t){return JSON.stringify(e,K1,t)}function Z1(e){return Q1("string"==typeof e?JSON.parse(e):e)}function Q1(e){var t,n,r,i=e.marktype,o=e.items;if(o)for(n=0,r=o.length;n<r;++n)t=i?"mark":"group",o[n][t]=e,o[n].zindex&&(o[n][t].zdirty=!0),"group"===(i||t)&&Q1(o[n]);return i&&Y1(e),e}function e2(e){arguments.length?this.root=Z1(e):(this.root=t2({marktype:"group",name:"root",role:"frame"}),this.root.items=[new ZQ(this.root)])}function t2(e,t){const n={bounds:new KQ,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function n2(e,t,n){return!e&&"undefined"!=typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function r2(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function i2(e,t,n,r){var i,o=e.childNodes[t];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(i=o||null,o=n2(e.ownerDocument,n,r),e.insertBefore(o,i)),o}function o2(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function a2(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function s2(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function u2(e,t){this._active=null,this._handlers={},this._loader=e||nY(),this._tooltip=t||l2}function l2(e,t,n,r){e.element().setAttribute("title",r||"")}function c2(e){this._el=null,this._bgcolor=null,this._loader=new QQ(e)}e2.prototype={toJSON(e){return J1(this.root,e||0)},mark(e,t,n){const r=t2(e,t=t||this.root.items[0]);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},u2.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const e in t)n.push(...t[e]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then((t=>{const n=new MouseEvent(e.type,e),r=n2(null,"a");for(const e in t)r.setAttribute(e,t[e]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(e,t,n){if(t&&null!=t.tooltip){t=function(e,t,n,r){var i,o,a=e&&e.mark;if(a&&(i=H1[a.marktype]).tip){for((o=s2(t,n))[0]-=r[0],o[1]-=r[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=i.tip(a.items,o)}return e}(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,o=i.width(),a=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)s+=e.x||0,u+=e.y||0;return{x:s,y:u,width:o,height:a,left:s,top:u,right:s+o,bottom:u+a}}},c2.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then((()=>t)):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const e=n._call;n._ready=n._loader.ready().then((t=>{t&&e(),n._ready=null}))}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const p2="dragenter",d2="dragleave",h2="dragover",f2="mousedown",g2="mousemove",m2="mouseout",y2="mouseover",b2="click",v2="mousewheel",x2="touchstart",_2="touchmove",w2="touchend",k2=g2,S2=m2,C2=b2;function M2(e,t){u2.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function T2(e,t){(e=>e===x2||e===_2||e===w2?[x2,_2,w2]:[e])(t).forEach((t=>function(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?n=>e[t](n):n=>e.fire(t,n)))}(e,t)))}function E2(e,t,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i||(i&&i.exit||this.fire(n,r),this._active=o,this.fire(t,r)),this.fire(e,r)}}function A2(e){return function(t){this.fire(e,t),this._active=null}}vW(M2,u2,{initialize(e,t,n){return this._canvas=e&&r2(e,"canvas"),[b2,f2,g2,m2,d2].forEach((e=>T2(this,e))),u2.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",p2,d2,h2,f2,"mouseup",g2,m2,y2,b2,"dblclick","wheel",v2,x2,_2,w2],DOMMouseScroll(e){this.fire(v2,e)},mousemove:E2(g2,y2,m2),dragover:E2(h2,p2,d2),mouseout:A2(m2),dragleave:A2(d2),mousedown(e){this._down=this._active,this.fire(f2,e)},click(e){this._down===this._active&&(this.fire(b2,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(x2,e,!0)},touchmove(e){this.fire(_2,e,!0)},touchend(e){this.fire(w2,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===C2&&r&&r.href?this.handleHref(t,r,r.href):e!==k2&&e!==S2||this.handleTooltip(t,r,e!==S2),i)for(let e=0,n=i.length;e<n;++e)i[e].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(T2(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=s2(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const o=this.context();return H1[e.marktype].pick.call(this,o,e,t,n,r,i)}});var F2="undefined"!=typeof window&&window.devicePixelRatio||1;function O2(e){c2.call(this,e),this._options={},this._redraw=!1,this._dirty=new KQ,this._tempb=new KQ}const R2=c2.prototype;function N2(e,t){u2.call(this,e,t);const n=this;n._hrefHandler=D2(n,((e,t)=>{t&&t.href&&n.handleHref(e,t,t.href)})),n._tooltipHandler=D2(n,((e,t)=>{n.handleTooltip(e,t,e.type!==S2)}))}vW(O2,c2,{initialize(e,t,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:Pd(1,1,this._options.type),e&&this._canvas&&(o2(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),R2.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(R2.resize.call(this,e,t,n,r),this._canvas)!function(e,t,n,r,i,o){const a="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,s=e.getContext("2d"),u=a?F2:i;e.width=t*u,e.height=n*u;for(const e in o)s[e]=o[e];a&&1!==u&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const e=this._options.externalContext;e||aW("CanvasRenderer is missing a valid canvas or context"),e.scale(this._scale,this._scale),e.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,a=((e,t,n)=>(new KQ).set(0,0,t,n).translate(-e[0],-e[1]))(n,r,i);t.save();const s=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):function(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,a.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,s),t.restore(),o.clear(),this},draw(e,t,n){const r=H1[t.marktype];t.clip&&function(e,t){var n=t.clip;e.save(),gW(n)?(e.beginPath(),n(e),e.clip()):t1(e,t.group)}(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,o=this.context();"pdf"===i.type||i.externalContext||o.clearRect(e,t,n,r),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,r))}});const D2=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};vW(N2,u2,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(C2,this._hrefHandler),r.removeEventListener(k2,this._tooltipHandler),r.removeEventListener(S2,this._tooltipHandler)),this._svg=r=e&&r2(e,"svg"),r&&(r.addEventListener(C2,this._hrefHandler),r.addEventListener(k2,this._tooltipHandler),r.addEventListener(S2,this._tooltipHandler)),u2.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const i={type:e,handler:t,listener:D2(this,t)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const I2="aria-hidden",B2="aria-label",L2="role",P2="aria-roledescription",$2="graphics-object",z2="graphics-symbol",j2=(e,t,n)=>({[L2]:e,[P2]:t,[B2]:n||void 0}),G2=kW(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),U2={axis:{desc:"axis",caption:function(e){const t=e.datum,n=e.orient,r=t.title?X2(e):null,i=e.context,o=i.scales[t.scale].value,a=i.dataflow.locale(),s=o.type;return`${"left"===n||"right"===n?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${FZ(s)?"discrete":s} scale`+` with ${JZ(a,o,e)}`}},legend:{desc:"legend",caption:function(e){const t=e.datum,n=t.title?X2(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),a=e.context,s=a.scales[i[o[0]]].value,u=a.dataflow.locale();return((l=r).length?l[0].toUpperCase()+l.slice(1):l)+(n?` titled '${n}'`:"")+` for ${function(e){return(e=e.map((e=>e+("fill"===e||"stroke"===e?" color":"")))).length<2?e[0]:e.slice(0,-1).join(", ")+" and "+dW(e)}(o)}`+` with ${JZ(u,s,e)}`;var l}},"title-text":{desc:"title",caption:e=>`Title text '${q2(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${q2(e)}'`}},W2={ariaRole:L2,ariaRoleDescription:P2,description:B2};function V2(e,t){const n=!1===t.aria;if(e(I2,n||void 0),n||null==t.description)for(const t in W2)e(W2[t],void 0);else{const n=t.mark.marktype;e(B2,t.description),e(L2,t.ariaRole||("group"===n?$2:z2)),e(P2,t.ariaRoleDescription||`${n} mark`)}}function H2(e){return!1===e.aria?{[I2]:!0}:G2[e.role]?null:U2[e.role]?function(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return j2(t.role||z2,t.desc,n.description||r(n))}catch(e){return null}}(e,U2[e.role]):function(e){const t=e.marktype,n="group"===t||"text"===t||e.items.some((e=>null!=e.description&&!1!==e.aria));return j2(n?$2:z2,`${t} mark container`,e.description)}(e)}function q2(e){return fW(e.text).join(" ")}function X2(e){try{return fW(dW(e.items).items[0].text).join(" ")}catch(e){return null}}const Y2=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),K2=e=>Y2(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function J2(){let e="",t="",n="";const r=[],i=()=>t=n="",o=(e,n)=>(null!=n&&(t+=` ${e}="${K2(n)}"`),a),a={open(s,...u){(o=>{t&&(e+=`${t}>${n}`,i()),r.push(o)})(s),t="<"+s;for(const e of u)for(const t in e)o(t,e[t]);return a},close(){const o=r.pop();return e+=t?t+(n?`>${n}</${o}>`:"/>"):`</${o}>`,i(),a},attr:o,text:e=>(n+=Y2(e),a),toString:()=>e};return a}const Z2=e=>Q2(J2(),e)+"";function Q2(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let t=0;t<r;++t)e.attr(n[t].name,n[t].value)}if(t.hasChildNodes()){const n=t.childNodes,r=n.length;for(let t=0;t<r;t++){const r=n[t];3===r.nodeType?e.text(r.nodeValue):Q2(e,r)}}return e.close()}const e3={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},t3={fill:"none","stroke-miterlimit":10},n3="http://www.w3.org/2000/xmlns/",r3=l1.xmlns;function i3(e){c2.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const o3=c2.prototype;function a3(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function s3(e,t,n){let r,i,o;if("radial"===t.gradient){let r=i2(e,n++,"pattern",r3);g3(r,{id:QZ+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=i2(r,0,"rect",r3),g3(r,{width:1,height:1,fill:`url(${y3()}#${t.id})`}),g3(e=i2(e,n++,"radialGradient",r3),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else g3(e=i2(e,n++,"linearGradient",r3),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=i2(e,r,"stop",r3),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return o2(e,r),n}function u3(e,t,n){let r;return(e=i2(e,n,"clipPath",r3)).setAttribute("id",t.id),t.path?(r=i2(e,0,"path",r3),r.setAttribute("d",t.path)):(r=i2(e,0,"rect",r3),g3(r,{x:0,y:0,width:t.width,height:t.height})),o2(e,1),n+1}function l3(e,t,n,r,i){let o,a=e._svg;if(!a&&(o=t.ownerDocument,a=n2(o,r,r3),e._svg=a,e.mark&&(a.__data__=e,a.__values__={fill:"default"},"g"===r))){const t=n2(o,"path",r3);a.appendChild(t),t.__data__=e;const n=n2(o,"g",r3);a.appendChild(n),n.__data__=e;const r=n2(o,"path",r3);a.appendChild(r),r.__data__=e,r.__values__={fill:"default"}}return(a.ownerSVGElement!==i||function(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(a,n))&&t.insertBefore(a,n?n.nextSibling:t.firstChild),a}vW(i3,c2,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=i2(e,0,"svg",r3),this._svg.setAttributeNS(n3,"xmlns",r3),this._svg.setAttributeNS(n3,"xmlns:xlink",l1["xmlns:xlink"]),this._svg.setAttribute("version",l1.version),this._svg.setAttribute("class","marks"),o2(e,1),this._root=i2(this._svg,0,"g",r3),g3(this._root,t3),o2(this._svg,1)),this.background(this._bgcolor),o3.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),o3.background.apply(this,arguments)},resize(e,t,n,r){return o3.resize.call(this,e,t,n,r),this._svg&&(g3(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=i2(e,0,"rect",r3),g3(n,{width:this._width,height:this._height,fill:t}));const r=Z2(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),o2(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,o,a,s,u;for(a=0,s=e.length;a<s;++a)n=e[a],r=n.mark,r.marktype!==i&&(i=r.marktype,o=H1[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,a3(n,t),r.items.forEach((e=>{e.dirty=t}))),r.zdirty||(n.exit?(o.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(o,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null):(n=o.nested?r.items[0]:n,n._update!==t&&(n._svg&&n._svg.ownerSVGElement?this._update(o,n._svg,n):(this._dirtyAll=!1,a3(n,t)),n._update=t)));return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=H1[t.marktype],o=!1===t.interactive?"none":null,a="g"===i.tag;let s=null,u=0;const l=l3(t,e,n,"g",r);l.setAttribute("class",a2(t));const c=H2(t);for(const e in c)m3(l,e,c[e]);a||m3(l,"pointer-events",o),m3(l,"clip-path",t.clip?YQ(this,t,t.group):null);const p=e=>{const t=this.isDirty(e),n=l3(e,l,s,i.tag,r);t&&(this._update(i,n,e),a&&function(e,t,n){t=t.lastChild.previousSibling;let r,i=0;j0(n,(n=>{r=e.mark(t,n,r),++i})),o2(t,1+i)}(this,n,e)),s=n,++u};return i.nested?t.items.length&&p(t.items[0]):j0(t,p),o2(l,u),l},_update(e,t,n){c3=t,p3=t.__values__,V2(h3,n),e.attr(h3,n,this);const r=d3[e.type];r&&r.call(this,e,t,n),c3&&this.style(c3,n)},style(e,t){if(null!=t)for(const n in e3){let r="font"===n?L1(t):t[n];if(r===p3[n])continue;const i=e3[n];null==r?e.removeAttribute(i):(eQ(r)&&(r=tQ(r,this._defs.gradient,y3())),e.setAttribute(i,r+"")),p3[n]=r}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=i2(e,1,"defs",r3)),r=s3(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=i2(e,1,"defs",r3)),r=u3(n,t.clipping[i],r);n&&(0===r?(e.removeChild(n),t.el=null):o2(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});let c3=null,p3=null;const d3={group(e,t,n){const r=c3=t.childNodes[2];p3=r.__values__,e.foreground(h3,n,this),p3=t.__values__,c3=t.childNodes[1],e.content(h3,n,this);const i=c3=t.childNodes[0];e.background(h3,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==p3.events&&(m3(r,"pointer-events",o),m3(i,"pointer-events",o),p3.events=o),n.strokeForeground&&n.stroke){const e=n.fill;m3(r,"display",null),this.style(i,n),m3(i,"stroke",null),e&&(n.fill=null),p3=r.__values__,this.style(r,n),e&&(n.fill=e),c3=null}else m3(r,"display","none")},image(e,t,n){!1===n.smooth?(f3(t,"image-rendering","optimizeSpeed"),f3(t,"image-rendering","pixelated")):f3(t,"image-rendering",null)},text(e,t,n){const r=D1(n);let i,o,a,s;cW(r)?(o=r.map((e=>B1(n,e))),i=o.join("\n"),i!==p3.text&&(o2(t,0),a=t.ownerDocument,s=N1(n),o.forEach(((e,r)=>{const i=n2(a,"tspan",r3);i.__data__=n,i.textContent=e,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),t.appendChild(i)})),p3.text=i)):(o=B1(n,r),o!==p3.text&&(t.textContent=o,p3.text=o)),m3(t,"font-family",L1(n)),m3(t,"font-size",R1(n)+"px"),m3(t,"font-style",n.fontStyle),m3(t,"font-variant",n.fontVariant),m3(t,"font-weight",n.fontWeight)}};function h3(e,t,n){t!==p3[e]&&(n?function(e,t,n,r){null!=n?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}(c3,e,t,n):m3(c3,e,t),p3[e]=t)}function f3(e,t,n){n!==p3[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),p3[t]=n)}function g3(e,t){for(const n in t)m3(e,n,t[n])}function m3(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function y3(){let e;return"undefined"==typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function b3(e){c2.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}vW(b3,c2,{svg(){return this._text},_render(e){const t=J2();t.open("svg",mW({},l1,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",t3,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=H1[t.marktype],r=n.tag,i=[V2,n.attr];e.open("g",{class:a2(t),"clip-path":t.clip?YQ(this,t,t.group):null},H2(t),{"pointer-events":"g"!==r&&!1===t.interactive?"none":null});const o=o=>{const a=this.href(o);if(a&&e.open("a",a),e.open(r,this.attr(t,o,i,"g"!==r?r:null)),"text"===r){const t=D1(o);if(cW(t)){const n={x:0,dy:N1(o)};for(let r=0;r<t.length;++r)e.open("tspan",r?n:null).text(B1(o,t[r])).close()}else e.text(B1(o,t))}else if("g"===r){const r=o.strokeForeground,i=o.fill,a=o.stroke;r&&a&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),j0(o,(t=>this.mark(e,t))),e.close(),r&&a?(i&&(o.fill=null),o.stroke=a,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),i&&(o.fill=i)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):j0(t,o),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then((e=>{e["xlink:href"]=e.href,e.href=null,(this._hrefs||(this._hrefs={}))[t]=e}))}return null},attr(e,t,n,r){const i={},o=(e,t,n,r)=>{i[r||e]=t};return Array.isArray(n)?n.forEach((e=>e(o,t,this))):n(o,t,this),r&&function(e,t,n,r,i){if(null==t)return e;if("bgrect"===r&&!1===n.interactive&&(e["pointer-events"]="none"),"bgfore"===r&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill))return e;"image"===r&&!1===t.smooth&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),"text"===r&&(e["font-family"]=L1(t),e["font-size"]=R1(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const n in e3){let r=t[n];const o=e3[n];("transparent"!==r||"fill"!==o&&"stroke"!==o)&&null!=r&&(eQ(r)&&(r=tQ(r,i.gradient,"")),e[o]=r)}}(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(t).length+Object.keys(n).length){e.open("defs");for(const n in t){const r=t[n],i=r.stops;"radial"===r.gradient?(e.open("pattern",{id:QZ+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),e.close(),e.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):e.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let t=0;t<i.length;++t)e.open("stop",{offset:i[t].offset,"stop-color":i[t].color}).close();e.close()}for(const t in n){const r=n[t];e.open("clipPath",{id:t}),r.path?e.open("path",{d:r.path}).close():e.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),e.close()}e.close()}}});const v3="canvas",x3="none",_3={Canvas:v3,PNG:"png",SVG:"svg",None:x3},w3={};function k3(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(w3[e]=t,this):w3[e]}function S3(e,t,n){const r=[],i=(new KQ).union(t),o=e.marktype;return o?C3(e,i,n,r):"group"===o?M3(e,i,n,r):aW("Intersect scene must be mark node or group item.")}function C3(e,t,n,r){if(function(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){const i=e.items,o=e.marktype,a=i.length;let s=0;if("group"===o)for(;s<a;++s)M3(i[s],t,n,r);else for(const e=H1[o].isect;s<a;++s){const n=i[s];T3(n,t,e)&&r.push(n)}}return r}function M3(e,t,n,r){n&&n(e.mark)&&T3(e,t,H1.group.isect)&&r.push(e);const i=e.items,o=i&&i.length;if(o){const a=e.x||0,s=e.y||0;t.translate(-a,-s);for(let e=0;e<o;++e)C3(i[e],t,n,r);t.translate(a,s)}return r}function T3(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}w3[v3]=w3.png={renderer:O2,headless:O2,handler:M2},w3.svg={renderer:i3,headless:b3,handler:N2},w3[x3]={};const E3=new KQ;function A3(e){const t=e.clip;if(gW(t))t(x0(E3.clear()));else{if(!t)return;E3.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(E3)}const F3=1e-9;function O3(e,t,n){return e===t||("path"===n?R3(e,t):e instanceof Date&&t instanceof Date?+e==+t:xW(e)&&xW(t)?Math.abs(e-t)<=F3:e&&t&&(pW(e)||pW(t))?function(e,t){var n,r,i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;for(i.sort(),o.sort(),r=i.length-1;r>=0;r--)if(i[r]!=o[r])return!1;for(r=i.length-1;r>=0;r--)if(!O3(e[n=i[r]],t[n],n))return!1;return typeof e==typeof t}(e,t):e==t)}function R3(e,t){return O3(uQ(e),uQ(t))}function N3(){XQ(),ZZ=0}function D3(e,t,n){return e.fields=t||[],e.fname=n,e}function I3(e){return 1===e.length?B3(e[0]):L3(e)}const B3=e=>function(t){return t[e]},L3=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function P3(e){throw Error(e)}(function(e,t,n){const r=function(e){const t=[],n=e.length;let r,i,o,a=null,s=0,u="";function l(){t.push(u+e.substring(r,i)),u="",r=i+1}for(e+="",r=i=0;i<n;++i)if(o=e[i],"\\"===o)u+=e.substring(r,i++),r=i;else if(o===a)l(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&l(),s=r=i+1):"]"===o&&(s||P3("Access path missing open bracket: "+e),s>0&&l(),s=0,r=i+1):i>r?l():r=i+1}return s&&P3("Access path missing closing bracket: "+e),a&&P3("Access path missing closing quote: "+e),i>r&&(i++,l()),t}(e);e=1===r.length?r[0]:e,D3((n&&n.get||I3)(r),[e],t||e)})("id"),D3((e=>e),[],"identity"),D3((()=>0),[],"zero"),D3((()=>1),[],"one"),D3((()=>!0),[],"true"),D3((()=>!1),[],"false");var $3=Array.isArray;function z3(e){return e[e.length-1]}function j3(e){return null==e||""===e?null:+e}const G3=Object.prototype.hasOwnProperty;function U3(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function W3(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}const V3=Symbol("implicit");function H3(){var e=new Map,t=[],n=[],r=V3;function i(i){var o=i+"",a=e.get(o);if(!a){if(r!==V3)return r;e.set(o,a=t.push(i))}return n[(a-1)%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;for(const r of n){const n=r+"";e.has(n)||e.set(n,t.push(r))}return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return H3(t,n).unknown(r)},U3.apply(i,arguments),i}var q3,X3=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Y3(e){if(!(t=X3.exec(e)))throw new Error("invalid format: "+e);var t;return new K3({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function K3(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function J3(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Z3(e){return(e=J3(Math.abs(e)))?e[1]:NaN}function Q3(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Z3(t)/3)))-Z3(Math.abs(e)))}function e4(e,t){var n=J3(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Y3.prototype=K3.prototype,K3.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const t4={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>e4(100*e,t),r:e4,s:function(e,t){var n=J3(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(q3=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+J3(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function n4(e){return e}var r4,i4,o4,a4=Array.prototype.map,s4=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function u4(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?n4:(t=a4.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],a=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(e.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?n4:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(a4.call(e.numerals,String)),u=void 0===e.percent?"%":e.percent+"",l=void 0===e.minus?"":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function p(e){var t=(e=Y3(e)).fill,n=e.align,p=e.sign,d=e.symbol,h=e.zero,f=e.width,g=e.comma,m=e.precision,y=e.trim,b=e.type;"n"===b?(g=!0,b="g"):t4[b]||(void 0===m&&(m=12),y=!0,b="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var v="$"===d?i:"#"===d&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",x="$"===d?o:/[%p]/.test(b)?u:"",_=t4[b],w=/[defgprs%]/.test(b);function k(e){var i,o,u,d=v,k=x;if("c"===b)k=_(e)+k,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:_(Math.abs(e),m),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),S&&0==+e&&"+"!==p&&(S=!1),d=(S?"("===p?p:l:"-"===p||"("===p?"":p)+d,k=("s"===b?s4[8+q3/3]:"")+k+(S&&"("===p?")":""),w)for(i=-1,o=e.length;++i<o;)if(48>(u=e.charCodeAt(i))||u>57){k=(46===u?a+e.slice(i+1):e.slice(i))+k,e=e.slice(0,i);break}}g&&!h&&(e=r(e,1/0));var C=d.length+e.length+k.length,M=C<f?new Array(f-C+1).join(t):"";switch(g&&h&&(e=r(M+e,M.length?f-k.length:1/0),M=""),n){case"<":e=d+e+k+M;break;case"=":e=d+M+e+k;break;case"^":e=M.slice(0,C=M.length>>1)+d+e+k+M.slice(C);break;default:e=M+d+e+k}return s(e)}return m=void 0===m?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),k.toString=function(){return e+""},k}return{format:p,formatPrefix:function(e,t){var n=p(((e=Y3(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Z3(t)/3))),i=Math.pow(10,-r),o=s4[8+r/3];return function(e){return n(i*e)+o}}}}function l4(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Z3(t)-Z3(e))+1}function c4(e){return Math.max(0,-Z3(Math.abs(e)))}function p4(e,t,n,r){var i,o=eE(e,t,n);switch((r=Y3(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=Q3(o,a))||(r.precision=i),o4(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=l4(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=c4(o))||(r.precision=i-2*("%"===r.type))}return i4(r)}function d4(e){return+e}r4=u4({thousands:",",grouping:[3],currency:["$",""]}),i4=r4.format,o4=r4.formatPrefix;var h4=[0,1];function f4(e){return e}function g4(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function m4(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=g4(i,r),o=n(a,o)):(r=g4(r,i),o=n(o,a)),function(e){return o(r(e))}}function y4(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=g4(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=XB(e,t,1,r)-1;return o[n](i[n](t))}}function b4(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function v4(){var e,t,n,r,i,o,a=h4,s=h4,u=bT,l=f4;function c(){var e=Math.min(a.length,s.length);return l!==f4&&(l=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(a[0],a[e-1])),r=e>2?y4:m4,i=o=null,p}function p(t){return null==t||isNaN(t=+t)?n:(i||(i=r(a.map(e),s,u)))(e(l(t)))}return p.invert=function(n){return l(t((o||(o=r(s,a.map(e),hT)))(n)))},p.domain=function(e){return arguments.length?(a=Array.from(e,d4),c()):a.slice()},p.range=function(e){return arguments.length?(s=Array.from(e),c()):s.slice()},p.rangeRound=function(e){return s=Array.from(e),u=bM,c()},p.clamp=function(e){return arguments.length?(l=!!e||f4,c()):l!==f4},p.interpolate=function(e){return arguments.length?(u=e,c()):u},p.unknown=function(e){return arguments.length?(n=e,p):n},function(n,r){return e=n,t=r,c()}}function x4(){return v4()(f4,f4)}function _4(e){var t=e.domain;return e.ticks=function(e){var n=t();return ZT(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return p4(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,o=t(),a=0,s=o.length-1,u=o[a],l=o[s],c=10;for(l<u&&(i=u,u=l,l=i,i=a,a=s,s=i);c-- >0;){if((i=QT(u,l,n))===r)return o[a]=u,o[s]=l,t(o);if(i>0)u=Math.floor(u/i)*i,l=Math.ceil(l/i)*i;else{if(!(i<0))break;u=Math.ceil(u*i)/i,l=Math.floor(l*i)/i}r=i}return e},e}function w4(e,t){var n,r=0,i=(e=e.slice()).length-1,o=e[r],a=e[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),e[r]=t.floor(o),e[i]=t.ceil(a),e}function k4(e){return Math.log(e)}function S4(e){return Math.exp(e)}function C4(e){return-Math.log(-e)}function M4(e){return-Math.exp(-e)}function T4(e){return isFinite(e)?+("1e"+e):e<0?0:e}function E4(e){return function(t){return-e(-t)}}function A4(e){var t,n,r=e(k4,S4),i=r.domain,o=10;function a(){return t=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(o),n=function(e){return 10===e?T4:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(o),i()[0]<0?(t=E4(t),n=E4(n),e(C4,M4)):e(k4,S4),r}return r.base=function(e){return arguments.length?(o=+e,a()):o},r.domain=function(e){return arguments.length?(i(e),a()):i()},r.ticks=function(e){var r,a=i(),s=a[0],u=a[a.length-1];(r=u<s)&&(d=s,s=u,u=d);var l,c,p,d=t(s),h=t(u),f=null==e?10:+e,g=[];if(!(o%1)&&h-d<f){if(d=Math.floor(d),h=Math.ceil(h),s>0){for(;d<=h;++d)for(c=1,l=n(d);c<o;++c)if(!((p=l*c)<s)){if(p>u)break;g.push(p)}}else for(;d<=h;++d)for(c=o-1,l=n(d);c>=1;--c)if(!((p=l*c)<s)){if(p>u)break;g.push(p)}2*g.length<f&&(g=ZT(s,u,f))}else g=ZT(d,h,Math.min(h-d,f)).map(n);return r?g.reverse():g},r.tickFormat=function(e,i){if(null==i&&(i=10===o?".0e":","),"function"!=typeof i&&(i=i4(i)),e===1/0)return i;null==e&&(e=10);var a=Math.max(1,o*e/r.ticks().length);return function(e){var r=e/n(Math.round(t(e)));return r*o<o-.5&&(r*=o),r<=a?i(e):""}},r.nice=function(){return i(w4(i(),{floor:function(e){return n(Math.floor(t(e)))},ceil:function(e){return n(Math.ceil(t(e)))}}))},r}function F4(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function O4(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function R4(e){return e<0?-e*e:e*e}function N4(e){var t=e(f4,f4),n=1;return t.exponent=function(t){return arguments.length?1==(n=+t)?e(f4,f4):.5===n?e(O4,R4):e(F4(n),F4(1/n)):n},_4(t)}function D4(){var e=N4(v4());return e.copy=function(){return b4(e,D4()).exponent(e.exponent())},U3.apply(e,arguments),e}function I4(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function B4(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function L4(e){var t=1,n=e(I4(t),B4(t));return n.constant=function(n){return arguments.length?e(I4(t=+n),B4(t)):t},_4(n)}function P4(e,t,n,r,i,o){const a=[[qP,1,dP],[qP,5,5e3],[qP,15,15e3],[qP,30,3e4],[o,1,hP],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,fP],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,gP],[r,2,1728e5],[n,1,mP],[t,1,2592e6],[t,3,7776e6],[e,1,yP]];function s(t,n,r){const i=Math.abs(n-t)/r,o=Hl((([,,e])=>e)).right(a,i);if(o===a.length)return e.every(eE(t/yP,n/yP,r));if(0===o)return YP.every(Math.max(eE(t,n,r),1));const[s,u]=a[i/a[o-1][2]<a[o][2]/i?o-1:o];return s.every(u)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const i=n&&"function"==typeof n.range?n:s(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},s]}const[$4,z4]=P4(JP,QP,OP,AP,t$,r$),[j4,G4]=P4($P,jP,_P,vP,UP,VP);function U4(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function W4(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function V4(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function H4(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=i6(i),c=o6(i),p=i6(o),d=o6(o),h=i6(a),f=o6(a),g=i6(s),m=o6(s),y=i6(u),b=o6(u),v={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:M6,e:M6,f:O6,g:G6,G:W6,H:T6,I:E6,j:A6,L:F6,m:R6,M:N6,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:h5,s:f5,S:D6,u:I6,U:B6,V:P6,w:$6,W:z6,x:null,X:null,y:j6,Y:U6,Z:V6,"%":d5},x={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return u[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:H6,e:H6,f:J6,g:u5,G:c5,H:q6,I:X6,j:Y6,L:K6,m:Z6,M:Q6,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:h5,s:f5,S:e5,u:t5,U:n5,V:i5,w:o5,W:a5,x:null,X:null,y:s5,Y:l5,Z:p5,"%":d5},_={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=f.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=p.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=y.exec(t.slice(n));return r?(e.m=b.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=g.exec(t.slice(n));return r?(e.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return S(e,t,n,r)},d:m6,e:m6,f:w6,g:d6,G:p6,H:b6,I:b6,j:y6,L:_6,m:g6,M:v6,p:function(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=c.get(r[0].toLowerCase()),n+r[0].length):-1},q:f6,Q:S6,s:C6,S:x6,u:s6,U:u6,V:l6,w:a6,W:c6,x:function(e,t,r){return S(e,n,t,r)},X:function(e,t,n){return S(e,r,t,n)},y:d6,Y:p6,Z:h6,"%":k6};function w(e,t){return function(n){var r,i,o,a=[],s=-1,u=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===e.charCodeAt(s)&&(a.push(e.slice(u,s)),null!=(i=Z4[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(e.slice(u,s)),a.join("")}}function k(e,t){return function(n){var r,i,o=V4(1900,void 0,1);if(S(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=W4(V4(o.y,0,1))).getUTCDay(),r=i>4||0===i?RP.ceil(r):RP(r),r=AP.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=U4(V4(o.y,0,1))).getDay(),r=i>4||0===i?wP.ceil(r):wP(r),r=vP.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?W4(V4(o.y,0,1)).getUTCDay():U4(V4(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,W4(o)):U4(o)}}function S(e,t,n,r){for(var i,o,a=0,s=t.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=_[i in Z4?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return v.x=w(n,v),v.X=w(r,v),v.c=w(t,v),x.x=w(n,x),x.X=w(r,x),x.c=w(t,x),{format:function(e){var t=w(e+="",v);return t.toString=function(){return e},t},parse:function(e){var t=k(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=k(e+="",!0);return t.toString=function(){return e},t}}}var q4,X4,Y4,K4,J4,Z4={"-":"",_:" ",0:"0"},Q4=/^\s*\d+/,e6=/^%/,t6=/[\\^$*+?|[\]().{}]/g;function n6(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function r6(e){return e.replace(t6,"\\$&")}function i6(e){return new RegExp("^(?:"+e.map(r6).join("|")+")","i")}function o6(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function a6(e,t,n){var r=Q4.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function s6(e,t,n){var r=Q4.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function u6(e,t,n){var r=Q4.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function l6(e,t,n){var r=Q4.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function c6(e,t,n){var r=Q4.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function p6(e,t,n){var r=Q4.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function d6(e,t,n){var r=Q4.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function h6(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function f6(e,t,n){var r=Q4.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function g6(e,t,n){var r=Q4.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function m6(e,t,n){var r=Q4.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function y6(e,t,n){var r=Q4.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function b6(e,t,n){var r=Q4.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function v6(e,t,n){var r=Q4.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function x6(e,t,n){var r=Q4.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function _6(e,t,n){var r=Q4.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function w6(e,t,n){var r=Q4.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function k6(e,t,n){var r=e6.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function S6(e,t,n){var r=Q4.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function C6(e,t,n){var r=Q4.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function M6(e,t){return n6(e.getDate(),t,2)}function T6(e,t){return n6(e.getHours(),t,2)}function E6(e,t){return n6(e.getHours()%12||12,t,2)}function A6(e,t){return n6(1+vP.count($P(e),e),t,3)}function F6(e,t){return n6(e.getMilliseconds(),t,3)}function O6(e,t){return F6(e,t)+"000"}function R6(e,t){return n6(e.getMonth()+1,t,2)}function N6(e,t){return n6(e.getMinutes(),t,2)}function D6(e,t){return n6(e.getSeconds(),t,2)}function I6(e){var t=e.getDay();return 0===t?7:t}function B6(e,t){return n6(_P.count($P(e)-1,e),t,2)}function L6(e){var t=e.getDay();return t>=4||0===t?CP(e):CP.ceil(e)}function P6(e,t){return e=L6(e),n6(CP.count($P(e),e)+(4===$P(e).getDay()),t,2)}function $6(e){return e.getDay()}function z6(e,t){return n6(wP.count($P(e)-1,e),t,2)}function j6(e,t){return n6(e.getFullYear()%100,t,2)}function G6(e,t){return n6((e=L6(e)).getFullYear()%100,t,2)}function U6(e,t){return n6(e.getFullYear()%1e4,t,4)}function W6(e,t){var n=e.getDay();return n6((e=n>=4||0===n?CP(e):CP.ceil(e)).getFullYear()%1e4,t,4)}function V6(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+n6(t/60|0,"0",2)+n6(t%60,"0",2)}function H6(e,t){return n6(e.getUTCDate(),t,2)}function q6(e,t){return n6(e.getUTCHours(),t,2)}function X6(e,t){return n6(e.getUTCHours()%12||12,t,2)}function Y6(e,t){return n6(1+AP.count(JP(e),e),t,3)}function K6(e,t){return n6(e.getUTCMilliseconds(),t,3)}function J6(e,t){return K6(e,t)+"000"}function Z6(e,t){return n6(e.getUTCMonth()+1,t,2)}function Q6(e,t){return n6(e.getUTCMinutes(),t,2)}function e5(e,t){return n6(e.getUTCSeconds(),t,2)}function t5(e){var t=e.getUTCDay();return 0===t?7:t}function n5(e,t){return n6(OP.count(JP(e)-1,e),t,2)}function r5(e){var t=e.getUTCDay();return t>=4||0===t?IP(e):IP.ceil(e)}function i5(e,t){return e=r5(e),n6(IP.count(JP(e),e)+(4===JP(e).getUTCDay()),t,2)}function o5(e){return e.getUTCDay()}function a5(e,t){return n6(RP.count(JP(e)-1,e),t,2)}function s5(e,t){return n6(e.getUTCFullYear()%100,t,2)}function u5(e,t){return n6((e=r5(e)).getUTCFullYear()%100,t,2)}function l5(e,t){return n6(e.getUTCFullYear()%1e4,t,4)}function c5(e,t){var n=e.getUTCDay();return n6((e=n>=4||0===n?IP(e):IP.ceil(e)).getUTCFullYear()%1e4,t,4)}function p5(){return"+0000"}function d5(){return"%"}function h5(e){return+e}function f5(e){return Math.floor(+e/1e3)}function g5(e){return new Date(e)}function m5(e){return e instanceof Date?+e:+new Date(+e)}function y5(e,t,n,r,i,o,a,s,u,l){var c=x4(),p=c.invert,d=c.domain,h=l(".%L"),f=l(":%S"),g=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),b=l("%b %d"),v=l("%B"),x=l("%Y");function _(e){return(u(e)<e?h:s(e)<e?f:a(e)<e?g:o(e)<e?m:r(e)<e?i(e)<e?y:b:n(e)<e?v:x)(e)}return c.invert=function(e){return new Date(p(e))},c.domain=function(e){return arguments.length?d(Array.from(e,m5)):d().map(g5)},c.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},c.tickFormat=function(e,t){return null==t?_:l(t)},c.nice=function(e){var n=d();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(w4(n,e)):c},c.copy=function(){return b4(c,y5(e,t,n,r,i,o,a,s,u,l))},c}function b5(){var e,t,n,r,i,o=0,a=1,s=f4,u=!1;function l(t){return null==t||isNaN(t=+t)?i:s(0===n?.5:(t=(r(t)-e)*n,u?Math.max(0,Math.min(1,t)):t))}function c(e){return function(t){var n,r;return arguments.length?([n,r]=t,s=e(n,r),l):[s(0),s(1)]}}return l.domain=function(i){return arguments.length?([o,a]=i,e=r(o=+o),t=r(a=+a),n=e===t?0:1/(t-e),l):[o,a]},l.clamp=function(e){return arguments.length?(u=!!e,l):u},l.interpolator=function(e){return arguments.length?(s=e,l):s},l.range=c(bT),l.rangeRound=c(bM),l.unknown=function(e){return arguments.length?(i=e,l):i},function(i){return r=i,e=i(o),t=i(a),n=e===t?0:1/(t-e),l}}function v5(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function x5(){var e=_4(b5()(f4));return e.copy=function(){return v5(e,x5())},W3.apply(e,arguments)}function _5(){var e=N4(b5());return e.copy=function(){return v5(e,_5()).exponent(e.exponent())},W3.apply(e,arguments)}function w5(e,t){void 0===t&&(t=e,e=bT);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return o[t](e-t)}}function k5(){var e,t,n,r,i,o,a,s=0,u=.5,l=1,c=1,p=f4,d=!1;function h(e){return isNaN(e=+e)?a:(e=.5+((e=+o(e))-t)*(c*e<c*t?r:i),p(d?Math.max(0,Math.min(1,e)):e))}function f(e){return function(t){var n,r,i;return arguments.length?([n,r,i]=t,p=w5(e,[n,r,i]),h):[p(0),p(.5),p(1)]}}return h.domain=function(a){return arguments.length?([s,u,l]=a,e=o(s=+s),t=o(u=+u),n=o(l=+l),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),c=t<e?-1:1,h):[s,u,l]},h.clamp=function(e){return arguments.length?(d=!!e,h):d},h.interpolator=function(e){return arguments.length?(p=e,h):p},h.range=f(bT),h.rangeRound=f(bM),h.unknown=function(e){return arguments.length?(a=e,h):a},function(a){return o=a,e=a(s),t=a(u),n=a(l),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),c=t<e?-1:1,h}}function S5(){var e=N4(k5());return e.copy=function(){return v5(e,S5()).exponent(e.exponent())},W3.apply(e,arguments)}function C5(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function M5(e,t){var n=nT(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}q4=H4({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),X4=q4.format,Y4=q4.parse,K4=q4.utcFormat,J4=q4.utcParse;var T5,E5=180/Math.PI,A5={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function F5(e,t,n,r,i,o){var a,s,u;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*E5,skewX:Math.atan(u)*E5,scaleX:a,scaleY:s}}function O5(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,a){var s=[],u=[];return o=e(o),a=e(a),function(e,r,i,o,a,s){if(e!==i||r!==o){var u=a.push("translate(",null,t,null,n);s.push({i:u-4,x:hT(e,i)},{i:u-2,x:hT(r,o)})}else(i||o)&&a.push("translate("+i+t+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,u),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:hT(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,a.rotate,s,u),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:hT(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,a.skewX,s,u),function(e,t,n,r,o,a){if(e!==n||t!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:hT(e,n)},{i:s-2,x:hT(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,u),o=a=null,function(e){for(var t,n=-1,r=u.length;++n<r;)s[(t=u[n]).i]=t.x(e);return s.join("")}}}var R5=O5((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?A5:F5(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),N5=O5((function(e){return null==e?A5:(T5||(T5=document.createElementNS("http://www.w3.org/2000/svg","g")),T5.setAttribute("transform",e),(e=T5.transform.baseVal.consolidate())?F5((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):A5)}),", ",")",")");function D5(e){return((e=Math.exp(e))+1/e)/2}const I5=function e(t,n,r){function i(e,i){var o,a,s=e[0],u=e[1],l=e[2],c=i[0],p=i[1],d=i[2],h=c-s,f=p-u,g=h*h+f*f;if(g<1e-12)a=Math.log(d/l)/t,o=function(e){return[s+e*h,u+e*f,l*Math.exp(t*e*a)]};else{var m=Math.sqrt(g),y=(d*d-l*l+r*g)/(2*l*n*m),b=(d*d-l*l-r*g)/(2*d*n*m),v=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(b*b+1)-b);a=(x-v)/t,o=function(e){var r=e*a,i=D5(v),o=l/(n*m)*(i*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*r+v)-function(e){return((e=Math.exp(e))-1/e)/2}(v));return[s+o*h,u+o*f,l*i/D5(t*r+v)]}}return o.duration=1e3*a*t/Math.SQRT2,o}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},i}(Math.SQRT2,2,4);function B5(e){return function(t,n){var r=e((t=XM(t)).h,(n=XM(n)).h),i=rT(t.s,n.s),o=rT(t.l,n.l),a=rT(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=i(e),t.l=o(e),t.opacity=a(e),t+""}}}const L5=B5(nT);var P5=B5(rT);const $5=Math.PI/180,z5=180/Math.PI,j5=.96422,G5=1,U5=.82521,W5=4/29,V5=.12841854934601665,H5=.008856451679035631;function q5(e){if(e instanceof Y5)return new Y5(e.l,e.a,e.b,e.opacity);if(e instanceof t7)return n7(e);e instanceof GM||(e=zM(e));var t,n,r=Q5(e.r),i=Q5(e.g),o=Q5(e.b),a=K5((.2225045*r+.7168786*i+.0606169*o)/G5);return r===i&&i===o?t=n=a:(t=K5((.4360747*r+.3850649*i+.1430804*o)/j5),n=K5((.0139322*r+.0971045*i+.7141733*o)/U5)),new Y5(116*a-16,500*(t-a),200*(a-n),e.opacity)}function X5(e,t,n,r){return 1===arguments.length?q5(e):new Y5(e,t,n,null==r?1:r)}function Y5(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function K5(e){return e>H5?Math.pow(e,1/3):e/V5+W5}function J5(e){return e>.20689655172413793?e*e*e:V5*(e-W5)}function Z5(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Q5(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function e7(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof t7)return new t7(e.h,e.c,e.l,e.opacity);if(e instanceof Y5||(e=q5(e)),0===e.a&&0===e.b)return new t7(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*z5;return new t7(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}(e):new t7(e,t,n,null==r?1:r)}function t7(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function n7(e){if(isNaN(e.h))return new Y5(e.l,0,0,e.opacity);var t=e.h*$5;return new Y5(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function r7(e,t){var n=rT((e=X5(e)).l,(t=X5(t)).l),r=rT(e.a,t.a),i=rT(e.b,t.b),o=rT(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=i(t),e.opacity=o(t),e+""}}function i7(e){return function(t,n){var r=e((t=e7(t)).h,(n=e7(n)).h),i=rT(t.c,n.c),o=rT(t.l,n.l),a=rT(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=i(e),t.l=o(e),t.opacity=a(e),t+""}}}vM(Y5,X5,xM(_M,{brighter:function(e){return new Y5(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Y5(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new GM(Z5(3.1338561*(t=j5*J5(t))-1.6168667*(e=G5*J5(e))-.4906146*(n=U5*J5(n))),Z5(-.9787684*t+1.9161415*e+.033454*n),Z5(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),vM(t7,e7,xM(_M,{brighter:function(e){return new t7(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new t7(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return n7(this).rgb()}}));const o7=i7(nT);var a7=i7(rT),s7=-.14861,u7=1.78277,l7=-.29227,c7=-.90649,p7=1.97294,d7=p7*c7,h7=p7*u7,f7=u7*l7-c7*s7;function g7(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof m7)return new m7(e.h,e.s,e.l,e.opacity);e instanceof GM||(e=zM(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(f7*r+d7*t-h7*n)/(f7+d7-h7),o=r-i,a=(p7*(n-i)-l7*o)/c7,s=Math.sqrt(a*a+o*o)/(p7*i*(1-i)),u=s?Math.atan2(a,o)*z5-120:NaN;return new m7(u<0?u+360:u,s,i,e.opacity)}(e):new m7(e,t,n,null==r?1:r)}function m7(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function y7(e){return function t(n){function r(t,r){var i=e((t=g7(t)).h,(r=g7(r)).h),o=rT(t.s,r.s),a=rT(t.l,r.l),s=rT(t.opacity,r.opacity);return function(e){return t.h=i(e),t.s=o(e),t.l=a(Math.pow(e,n)),t.opacity=s(e),t+""}}return n=+n,r.gamma=t,r}(1)}vM(m7,g7,xM(_M,{brighter:function(e){return e=null==e?kM:Math.pow(kM,e),new m7(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?wM:Math.pow(wM,e),new m7(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*$5,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new GM(255*(t+n*(s7*r+u7*i)),255*(t+n*(l7*r+c7*i)),255*(t+n*(p7*r)),this.opacity)}}));const b7=y7(nT);var v7=y7(rT);function x7(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const _7=new Date,w7=new Date;function k7(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{const t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,r,o)=>{const a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return a;let s;do{a.push(s=new Date(+n)),t(n,o),e(n)}while(s<n&&n<r);return a},i.filter=n=>k7((t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),((e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})),n&&(i.count=(t,r)=>(_7.setTime(+t),w7.setTime(+r),e(_7),e(w7),Math.floor(n(_7,w7))),i.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?t=>r(t)%e==0:t=>i.count(0,t)%e==0):i:null)),i}const S7=1e3,C7=6e4,M7=36e5,T7=864e5,E7=6048e5,A7=k7((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*C7)/T7),(e=>e.getDate()-1)),F7=(A7.range,k7((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/T7),(e=>e.getUTCDate()-1))),O7=(F7.range,k7((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/T7),(e=>Math.floor(e/T7))));function R7(e){return k7((t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),((e,t)=>{e.setDate(e.getDate()+7*t)}),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*C7)/E7))}O7.range;const N7=R7(0),D7=R7(1),I7=R7(2),B7=R7(3),L7=R7(4),P7=R7(5),$7=R7(6);function z7(e){return k7((t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)}),((e,t)=>(t-e)/E7))}N7.range,D7.range,I7.range,B7.range,L7.range,P7.range,$7.range;const j7=z7(0),G7=z7(1),U7=z7(2),W7=z7(3),V7=z7(4),H7=z7(5),q7=z7(6),X7=(j7.range,G7.range,U7.range,W7.range,V7.range,H7.range,q7.range,k7((e=>{e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,t)=>{e.setFullYear(e.getFullYear()+t)}),((e,t)=>t.getFullYear()-e.getFullYear()),(e=>e.getFullYear())));X7.every=e=>isFinite(e=Math.floor(e))&&e>0?k7((t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,n)=>{t.setFullYear(t.getFullYear()+n*e)})):null,X7.range;const Y7=k7((e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)}),((e,t)=>t.getUTCFullYear()-e.getUTCFullYear()),(e=>e.getUTCFullYear()));Y7.every=e=>isFinite(e=Math.floor(e))&&e>0?k7((t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null,Y7.range;const K7=k7((e=>{e.setDate(1),e.setHours(0,0,0,0)}),((e,t)=>{e.setMonth(e.getMonth()+t)}),((e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())),(e=>e.getMonth())),J7=(K7.range,k7((e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)}),((e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())),(e=>e.getUTCMonth()))),Z7=(J7.range,k7((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*S7-e.getMinutes()*C7)}),((e,t)=>{e.setTime(+e+t*M7)}),((e,t)=>(t-e)/M7),(e=>e.getHours()))),Q7=(Z7.range,k7((e=>{e.setUTCMinutes(0,0,0)}),((e,t)=>{e.setTime(+e+t*M7)}),((e,t)=>(t-e)/M7),(e=>e.getUTCHours()))),e8=(Q7.range,k7((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*S7)}),((e,t)=>{e.setTime(+e+t*C7)}),((e,t)=>(t-e)/C7),(e=>e.getMinutes()))),t8=(e8.range,k7((e=>{e.setUTCSeconds(0,0)}),((e,t)=>{e.setTime(+e+t*C7)}),((e,t)=>(t-e)/C7),(e=>e.getUTCMinutes()))),n8=(t8.range,k7((e=>{e.setTime(e-e.getMilliseconds())}),((e,t)=>{e.setTime(+e+t*S7)}),((e,t)=>(t-e)/S7),(e=>e.getUTCSeconds()))),r8=(n8.range,k7((()=>{}),((e,t)=>{e.setTime(+e+t)}),((e,t)=>t-e)));r8.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?k7((t=>{t.setTime(Math.floor(t/e)*e)}),((t,n)=>{t.setTime(+t+n*e)}),((t,n)=>(n-t)/e)):r8:null),r8.range;const i8="year",o8="month",a8="date",s8="hours",u8="minutes",l8="seconds",c8="milliseconds";[i8,"quarter",o8,"week",a8,"day","dayofyear",s8,u8,l8,c8].reduce(((e,t,n)=>(e[t]=1+n,e)),{}),new Date,K7.every(3),J7.every(3);[i8,o8,a8,s8,u8,l8,c8].slice(0,-1).slice(0,-1).slice(0,-1).slice(0,-1);const p8="linear",d8="log",h8="pow",f8="sqrt",g8="symlog",m8="sequential",y8="diverging",b8="quantile",v8="continuous",x8="discrete",_8="discretizing",w8="interpolating",k8="temporal";function S8(){const e=H3().unknown(void 0),t=e.domain,n=e.range;let r,i,o=[0,1],a=!1,s=0,u=0,l=.5;function c(){const e=t().length,c=o[1]<o[0],p=o[1-c],d=function(e,t,n){const r=e-t+2*n;return e?r>0?r:1:0}(e,s,u);let h=o[c-0];r=(p-h)/(d||1),a&&(r=Math.floor(r)),h+=(p-h-r*(e-s))*l,i=r*(1-s),a&&(h=Math.round(h),i=Math.round(i));const f=Vl(e).map((e=>h+r*e));return n(c?f.reverse():f)}return delete e.unknown,e.domain=function(e){return arguments.length?(t(e),c()):t()},e.range=function(e){return arguments.length?(o=[+e[0],+e[1]],c()):o.slice()},e.rangeRound=function(e){return o=[+e[0],+e[1]],a=!0,c()},e.bandwidth=function(){return i},e.step=function(){return r},e.round=function(e){return arguments.length?(a=!!e,c()):a},e.padding=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),s=u,c()):s},e.paddingInner=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),c()):s},e.paddingOuter=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),c()):u},e.align=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),c()):l},e.invertRange=function(e){if(null==e[0]||null==e[1])return;const r=o[1]<o[0],a=r?n().reverse():n(),s=a.length-1;let u,l,c,p=+e[0],d=+e[1];return p!=p||d!=d||(d<p&&(c=p,p=d,d=c),d<a[0]||p>o[1-r])?void 0:(u=Math.max(0,HB(a,p)-1),l=p===d?u:HB(a,d)-1,p-a[u]>i+1e-10&&++u,r&&(c=u,u=s-l,l=s-c),u>l?void 0:t().slice(u,l+1))},e.invert=function(t){const n=e.invertRange([t,t]);return n?n[0]:n},e.copy=function(){return S8().domain(t()).range(o).round(a).paddingInner(s).paddingOuter(u).align(l)},c()}function C8(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return C8(t())},e}var M8=Array.prototype.map;const T8=Array.prototype.slice,E8={};function A8(e,t,n){return arguments.length>1?(E8[e]=function(e,t,n){const r=function(){const n=t();return n.invertRange||(n.invertRange=n.invert?function(e){return function(t){let n,r=t[0],i=t[1];return i<r&&(n=r,r=i,i=n),[e.invert(r),e.invert(i)]}}(n):n.invertExtent?function(e){return function(t){const n=e.range();let r,i,o,a,s=t[0],u=t[1],l=-1;for(u<s&&(i=s,s=u,u=i),o=0,a=n.length;o<a;++o)n[o]>=s&&n[o]<=u&&(l<0&&(l=o),r=o);if(!(l<0))return s=e.invertExtent(n[l]),u=e.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}}(n):void 0),n.type=e,n};return r.metadata=function(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}(null!=(i=n)?$3(i)?i:[i]:[]),r;var i}(e,t,n),this):function(e){return function(e,t){return G3.call(e,t)}(E8,e)}(e)?E8[e]:void 0}function F8(e,t){const n=t[0],r=z3(t)-n;return function(t){return e(n+t*r)}}function O8(e,t,n){return w5(N8(t||"rgb",n),e)}function R8(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function N8(e,t){const n=b[function(e){return"interpolate"+e.toLowerCase().split("-").map((e=>e[0].toUpperCase()+e.slice(1))).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function D8(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function I8(e,t){for(const n in e)L8(n,t(e[n]))}A8("identity",(function e(t){var n;function r(e){return null==e||isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=Array.from(e,d4),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,d4):[0,1],_4(r)})),A8(p8,(function e(){var t=x4();return t.copy=function(){return b4(t,e())},U3.apply(t,arguments),_4(t)}),v8),A8(d8,(function e(){var t=A4(v4()).domain([1,10]);return t.copy=function(){return b4(t,e()).base(t.base())},U3.apply(t,arguments),t}),[v8,d8]),A8(h8,D4,v8),A8(f8,(function(){return D4.apply(null,arguments).exponent(.5)}),v8),A8(g8,(function e(){var t=L4(v4());return t.copy=function(){return b4(t,e()).constant(t.constant())},U3.apply(t,arguments)}),v8),A8("time",(function(){return U3.apply(y5(j4,G4,$P,jP,_P,vP,UP,VP,qP,X4).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[v8,k8]),A8("utc",(function(){return U3.apply(y5($4,z4,JP,QP,OP,AP,t$,r$,qP,K4).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[v8,k8]),A8(m8,x5,[v8,w8]),A8("".concat(m8,"-").concat(p8),x5,[v8,w8]),A8("".concat(m8,"-").concat(d8),(function e(){var t=A4(b5()).domain([1,10]);return t.copy=function(){return v5(t,e()).base(t.base())},W3.apply(t,arguments)}),[v8,w8,d8]),A8("".concat(m8,"-").concat(h8),_5,[v8,w8]),A8("".concat(m8,"-").concat(f8),(function(){return _5.apply(null,arguments).exponent(.5)}),[v8,w8]),A8("".concat(m8,"-").concat(g8),(function e(){var t=L4(b5());return t.copy=function(){return v5(t,e()).constant(t.constant())},W3.apply(t,arguments)}),[v8,w8]),A8("".concat(y8,"-").concat(p8),(function e(){var t=_4(k5()(f4));return t.copy=function(){return v5(t,e())},W3.apply(t,arguments)}),[v8,w8]),A8("".concat(y8,"-").concat(d8),(function e(){var t=A4(k5()).domain([.1,1,10]);return t.copy=function(){return v5(t,e()).base(t.base())},W3.apply(t,arguments)}),[v8,w8,d8]),A8("".concat(y8,"-").concat(h8),S5,[v8,w8]),A8("".concat(y8,"-").concat(f8),(function(){return S5.apply(null,arguments).exponent(.5)}),[v8,w8]),A8("".concat(y8,"-").concat(g8),(function e(){var t=L4(k5());return t.copy=function(){return v5(t,e()).constant(t.constant())},W3.apply(t,arguments)}),[v8,w8]),A8(b8,(function e(){var t,n=[],r=[],i=[];function o(){var e=0,t=Math.max(1,r.length);for(i=new Array(t-1);++e<t;)i[e-1]=Ul(n,e/t);return a}function a(e){return null==e||isNaN(e=+e)?t:r[XB(i,e)]}return a.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?i[t-1]:n[0],t<i.length?i[t]:n[n.length-1]]},a.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(Pl),o()},a.range=function(e){return arguments.length?(r=Array.from(e),o()):r.slice()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.quantiles=function(){return i.slice()},a.copy=function(){return e().domain(n).range(r).unknown(t)},U3.apply(a,arguments)}),[_8,b8]),A8("quantize",(function e(){var t,n=0,r=1,i=1,o=[.5],a=[0,1];function s(e){return null!=e&&e<=e?a[XB(o,e,0,i)]:t}function u(){var e=-1;for(o=new Array(i);++e<i;)o[e]=((e+1)*r-(e-i)*n)/(i+1);return s}return s.domain=function(e){return arguments.length?([n,r]=e,n=+n,r=+r,u()):[n,r]},s.range=function(e){return arguments.length?(i=(a=Array.from(e)).length-1,u()):a.slice()},s.invertExtent=function(e){var t=a.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,o[0]]:t>=i?[o[i-1],r]:[o[t-1],o[t]]},s.unknown=function(e){return arguments.length?(t=e,s):s},s.thresholds=function(){return o.slice()},s.copy=function(){return e().domain([n,r]).range(a).unknown(t)},U3.apply(_4(s),arguments)}),_8),A8("threshold",(function e(){var t,n=[.5],r=[0,1],i=1;function o(e){return null!=e&&e<=e?r[XB(n,e,0,i)]:t}return o.domain=function(e){return arguments.length?(n=Array.from(e),i=Math.min(n.length,r.length-1),o):n.slice()},o.range=function(e){return arguments.length?(r=Array.from(e),i=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},o.unknown=function(e){return arguments.length?(t=e,o):t},o.copy=function(){return e().domain(n).range(r).unknown(t)},U3.apply(o,arguments)}),_8),A8("bin-ordinal",(function e(){let t=[],n=[];function r(e){return null==e||e!=e?void 0:n[(XB(t,e)-1)%n.length]}return r.domain=function(e){return arguments.length?(t=function(e){return M8.call(e,j3)}(e),r):t.slice()},r.range=function(e){return arguments.length?(n=T8.call(e),r):n.slice()},r.tickFormat=function(e,n){return p4(t[0],z3(t),null==e?10:e,n)},r.copy=function(){return e().domain(r.domain()).range(r.range())},r}),[x8,_8]),A8("ordinal",H3,x8),A8("band",S8,x8),A8("point",(function(){return C8(S8().paddingInner(1))}),x8);const B8={};function L8(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(B8[e]=t,this):B8[e]}I8({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},D8),I8({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(e=>O8(D8(e))));const P8=e=>e;function $8(e,t){e&&j8.hasOwnProperty(e.type)&&j8[e.type](e,t)}var z8={Feature:function(e,t){$8(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)$8(n[r].geometry,t)}},j8={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){G8(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)G8(n[r],t,0)},Polygon:function(e,t){U8(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)U8(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)$8(n[r],t)}};function G8(e,t,n){var r,i=-1,o=e.length-n;for(t.lineStart();++i<o;)r=e[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function U8(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)G8(e[n],t,1);t.polygonEnd()}function W8(e,t){e&&z8.hasOwnProperty(e.type)?z8[e.type](e,t):$8(e,t)}class V8{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=t[r],o=e+i,a=Math.abs(e)<Math.abs(i)?e-(o-i):i-(o-e);a&&(t[n++]=a),e=o}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,r,i=this._n,o=0;if(i>0){for(o=e[--i];i>0&&(t=o,n=e[--i],o=t+n,r=n-(o-t),!r););i>0&&(r<0&&e[i-1]<0||r>0&&e[i-1]>0)&&(n=2*r,t=o+n,n==t-o&&(o=t))}return o}}function H8(){}var q8,X8,Y8,K8,J8=new V8,Z8=new V8,Q8={point:H8,lineStart:H8,lineEnd:H8,polygonStart:function(){Q8.lineStart=e9,Q8.lineEnd=r9},polygonEnd:function(){Q8.lineStart=Q8.lineEnd=Q8.point=H8,J8.add(RR(Z8)),Z8=new V8},result:function(){var e=J8/2;return J8=new V8,e}};function e9(){Q8.point=t9}function t9(e,t){Q8.point=n9,q8=Y8=e,X8=K8=t}function n9(e,t){Z8.add(K8*e-Y8*t),Y8=e,K8=t}function r9(){n9(q8,X8)}const i9=Q8;var o9=1/0,a9=o9,s9=-o9,u9=s9,l9={point:function(e,t){e<o9&&(o9=e),e>s9&&(s9=e),t<a9&&(a9=t),t>u9&&(u9=t)},lineStart:H8,lineEnd:H8,polygonStart:H8,polygonEnd:H8,result:function(){var e=[[o9,a9],[s9,u9]];return s9=u9=-(a9=o9=1/0),e}};const c9=l9;var p9,d9,h9,f9,g9=0,m9=0,y9=0,b9=0,v9=0,x9=0,_9=0,w9=0,k9=0,S9={point:C9,lineStart:M9,lineEnd:A9,polygonStart:function(){S9.lineStart=F9,S9.lineEnd=O9},polygonEnd:function(){S9.point=C9,S9.lineStart=M9,S9.lineEnd=A9},result:function(){var e=k9?[_9/k9,w9/k9]:x9?[b9/x9,v9/x9]:y9?[g9/y9,m9/y9]:[NaN,NaN];return g9=m9=y9=b9=v9=x9=_9=w9=k9=0,e}};function C9(e,t){g9+=e,m9+=t,++y9}function M9(){S9.point=T9}function T9(e,t){S9.point=E9,C9(h9=e,f9=t)}function E9(e,t){var n=e-h9,r=t-f9,i=UR(n*n+r*r);b9+=i*(h9+e)/2,v9+=i*(f9+t)/2,x9+=i,C9(h9=e,f9=t)}function A9(){S9.point=C9}function F9(){S9.point=R9}function O9(){N9(p9,d9)}function R9(e,t){S9.point=N9,C9(p9=h9=e,d9=f9=t)}function N9(e,t){var n=e-h9,r=t-f9,i=UR(n*n+r*r);b9+=i*(h9+e)/2,v9+=i*(f9+t)/2,x9+=i,_9+=(i=f9*e-h9*t)*(h9+e),w9+=i*(f9+t),k9+=3*i,C9(h9=e,f9=t)}const D9=S9;function I9(e){this._context=e}I9.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,AR)}},result:H8};var B9,L9,P9,$9,z9,j9=new V8,G9={point:H8,lineStart:function(){G9.point=U9},lineEnd:function(){B9&&W9(L9,P9),G9.point=H8},polygonStart:function(){B9=!0},polygonEnd:function(){B9=null},result:function(){var e=+j9;return j9=new V8,e}};function U9(e,t){G9.point=W9,L9=$9=e,P9=z9=t}function W9(e,t){$9-=e,z9-=t,j9.add(UR($9*$9+z9*z9)),$9=e,z9=t}const V9=G9;function H9(){this._string=[]}function q9(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function X9(e,t){var n,r,i=4.5;function o(e){return e&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),W8(e,n(r))),r.result()}return o.area=function(e){return W8(e,n(i9)),i9.result()},o.measure=function(e){return W8(e,n(V9)),V9.result()},o.bounds=function(e){return W8(e,n(c9)),c9.result()},o.centroid=function(e){return W8(e,n(D9)),D9.result()},o.projection=function(t){return arguments.length?(n=null==t?(e=null,P8):(e=t).stream,o):e},o.context=function(e){return arguments.length?(r=null==e?(t=null,new H9):new I9(t=e),"function"!=typeof i&&r.pointRadius(i),o):t},o.pointRadius=function(e){return arguments.length?(i="function"==typeof e?e:(r.pointRadius(+e),+e),o):i},o.projection(e).context(t)}function Y9(){var e,t=[];return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){t.push(e=[])},lineEnd:H8,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function K9(e,t){return RR(e[0]-t[0])<SR&&RR(e[1]-t[1])<SR}function J9(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Z9(e,t,n,r,i){var o,a,s=[],u=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],a=e[t];if(K9(r,a)){if(!r[2]&&!a[2]){for(i.lineStart(),o=0;o<t;++o)i.point((r=e[o])[0],r[1]);return void i.lineEnd()}a[0]+=2*SR}s.push(n=new J9(r,e,null,!0)),u.push(n.o=new J9(r,null,n,!1)),s.push(n=new J9(a,e,null,!1)),u.push(n.o=new J9(a,null,n,!0))}})),s.length){for(u.sort(t),Q9(s),Q9(u),o=0,a=u.length;o<a;++o)u[o].e=n=!n;for(var l,c,p=s[0];;){for(var d=p,h=!0;d.v;)if((d=d.n)===p)return;l=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(o=0,a=l.length;o<a;++o)i.point((c=l[o])[0],c[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(l=d.p.z,o=l.length-1;o>=0;--o)i.point((c=l[o])[0],c[1]);else r(d.x,d.p.x,-1,i);d=d.p}l=(d=d.o).z,h=!h}while(!d.v);i.lineEnd()}}}function Q9(e){if(t=e.length){for(var t,n,r=0,i=e[0];++r<t;)i.n=n=e[r],n.p=i,i=n;i.n=n=e[0],n.p=i}}function eee(e){return[DR(e[1],e[0]),HR(e[2])]}function tee(e){var t=e[0],n=e[1],r=IR(n);return[r*IR(t),r*jR(t),jR(n)]}function nee(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ree(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function iee(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function oee(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function aee(e){var t=UR(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function see(e){return RR(e[0])<=MR?e[0]:GR(e[0])*((RR(e[0])+MR)%AR-MR)}function uee(e){return Array.from(function*(e){for(const t of e)yield*t}(e))}function lee(e,t,n,r){return function(i){var o,a,s,u=t(i),l=Y9(),c=t(l),p=!1,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=b,d.lineEnd=v,a=[],o=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,a=uee(a);var e=function(e,t){var n=see(t),r=t[1],i=jR(r),o=[jR(n),-IR(n),0],a=0,s=0,u=new V8;1===i?r=TR+SR:-1===i&&(r=-TR-SR);for(var l=0,c=e.length;l<c;++l)if(d=(p=e[l]).length)for(var p,d,h=p[d-1],f=see(h),g=h[1]/2+ER,m=jR(g),y=IR(g),b=0;b<d;++b,f=x,m=w,y=k,h=v){var v=p[b],x=see(v),_=v[1]/2+ER,w=jR(_),k=IR(_),S=x-f,C=S>=0?1:-1,M=C*S,T=M>MR,E=m*w;if(u.add(DR(E*C*jR(M),y*k+E*IR(M))),a+=T?S+C*AR:S,T^f>=n^x>=n){var A=ree(tee(h),tee(v));aee(A);var F=ree(o,A);aee(F);var O=(T^S>=0?-1:1)*HR(F[2]);(r>O||r===O&&(A[0]||A[1]))&&(s+=T^S>=0?1:-1)}}return(a<-SR||a<SR&&u<-CR)^1&s}(o,r);a.length?(p||(i.polygonStart(),p=!0),Z9(a,pee,e,n,i)):e&&(p||(i.polygonStart(),p=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),p&&(i.polygonEnd(),p=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(t,n){e(t,n)&&i.point(t,n)}function f(e,t){u.point(e,t)}function g(){d.point=f,u.lineStart()}function m(){d.point=h,u.lineEnd()}function y(e,t){s.push([e,t]),c.point(e,t)}function b(){c.lineStart(),s=[]}function v(){y(s[0][0],s[0][1]),c.lineEnd();var e,t,n,r,u=c.clean(),d=l.result(),h=d.length;if(s.pop(),o.push(s),s=null,h)if(1&u){if((t=(n=d[0]).length-1)>0){for(p||(i.polygonStart(),p=!0),i.lineStart(),e=0;e<t;++e)i.point((r=n[e])[0],r[1]);i.lineEnd()}}else h>1&&2&u&&d.push(d.pop().concat(d.shift())),a.push(d.filter(cee))}return d}}function cee(e){return e.length>1}function pee(e,t){return((e=e.x)[0]<0?e[1]-TR-SR:TR-e[1])-((t=t.x)[0]<0?t[1]-TR-SR:TR-t[1])}H9.prototype={_radius:4.5,_circle:q9(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=q9(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};const dee=lee((function(){return!0}),(function(e){var t,n=NaN,r=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(o,a){var s=o>0?MR:-MR,u=RR(o-n);RR(u-MR)<SR?(e.point(n,r=(r+a)/2>0?TR:-TR),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),e.point(o,r),t=0):i!==s&&u>=MR&&(RR(n-i)<SR&&(n-=i*SR),RR(o-s)<SR&&(o-=s*SR),r=function(e,t,n,r){var i,o,a=jR(e-n);return RR(a)>SR?NR((jR(t)*(o=IR(r))*jR(n)-jR(r)*(i=IR(t))*jR(e))/(i*o*a)):(t+r)/2}(n,r,o,a),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),t=0),e.point(n=o,r=a),i=s},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}),(function(e,t,n,r){var i;if(null==e)i=n*TR,r.point(-MR,i),r.point(0,i),r.point(MR,i),r.point(MR,0),r.point(MR,-i),r.point(0,-i),r.point(-MR,-i),r.point(-MR,0),r.point(-MR,i);else if(RR(e[0]-t[0])>SR){var o=e[0]<t[0]?MR:-MR;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}),[-MR,-TR]);function hee(e,t){(t=tee(t))[0]-=e,aee(t);var n=VR(-t[1]);return((-t[2]<0?-n:n)+AR-SR)%AR}var fee=1e9,gee=-fee;function mee(e,t,n,r){function i(i,o){return e<=i&&i<=n&&t<=o&&o<=r}function o(i,o,s,l){var c=0,p=0;if(null==i||(c=a(i,s))!==(p=a(o,s))||u(i,o)<0^s>0)do{l.point(0===c||3===c?e:n,c>1?r:t)}while((c=(c+s+4)%4)!==p);else l.point(o[0],o[1])}function a(r,i){return RR(r[0]-e)<SR?i>0?0:3:RR(r[0]-n)<SR?i>0?2:1:RR(r[1]-t)<SR?i>0?1:0:i>0?3:2}function s(e,t){return u(e.x,t.x)}function u(e,t){var n=a(e,1),r=a(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(a){var u,l,c,p,d,h,f,g,m,y,b,v=a,x=Y9(),_={point:w,lineStart:function(){_.point=k,l&&l.push(c=[]),y=!0,m=!1,f=g=NaN},lineEnd:function(){u&&(k(p,d),h&&m&&x.rejoin(),u.push(x.result())),_.point=w,m&&v.lineEnd()},polygonStart:function(){v=x,u=[],l=[],b=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,i=l.length;n<i;++n)for(var o,a,s=l[n],u=1,c=s.length,p=s[0],d=p[0],h=p[1];u<c;++u)o=d,a=h,d=(p=s[u])[0],h=p[1],a<=r?h>r&&(d-o)*(r-a)>(h-a)*(e-o)&&++t:h<=r&&(d-o)*(r-a)<(h-a)*(e-o)&&--t;return t}(),n=b&&t,i=(u=uee(u)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&Z9(u,s,t,o,a),a.polygonEnd()),v=a,u=l=c=null}};function w(e,t){i(e,t)&&v.point(e,t)}function k(o,a){var s=i(o,a);if(l&&c.push([o,a]),y)p=o,d=a,h=s,y=!1,s&&(v.lineStart(),v.point(o,a));else if(s&&m)v.point(o,a);else{var u=[f=Math.max(gee,Math.min(fee,f)),g=Math.max(gee,Math.min(fee,g))],x=[o=Math.max(gee,Math.min(fee,o)),a=Math.max(gee,Math.min(fee,a))];!function(e,t,n,r,i,o){var a,s=e[0],u=e[1],l=0,c=1,p=t[0]-s,d=t[1]-u;if(a=n-s,p||!(a>0)){if(a/=p,p<0){if(a<l)return;a<c&&(c=a)}else if(p>0){if(a>c)return;a>l&&(l=a)}if(a=i-s,p||!(a<0)){if(a/=p,p<0){if(a>c)return;a>l&&(l=a)}else if(p>0){if(a<l)return;a<c&&(c=a)}if(a=r-u,d||!(a>0)){if(a/=d,d<0){if(a<l)return;a<c&&(c=a)}else if(d>0){if(a>c)return;a>l&&(l=a)}if(a=o-u,d||!(a<0)){if(a/=d,d<0){if(a>c)return;a>l&&(l=a)}else if(d>0){if(a<l)return;a<c&&(c=a)}return l>0&&(e[0]=s+l*p,e[1]=u+l*d),c<1&&(t[0]=s+c*p,t[1]=u+c*d),!0}}}}}(u,x,e,t,n,r)?s&&(v.lineStart(),v.point(o,a),b=!1):(m||(v.lineStart(),v.point(u[0],u[1])),v.point(x[0],x[1]),s||v.lineEnd(),b=!1)}f=o,g=a,m=s}return _}}function yee(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n}function bee(e,t){return[RR(e)>MR?e+Math.round(-e/AR)*AR:e,t]}function vee(e,t,n){return(e%=AR)?t||n?yee(_ee(e),wee(t,n)):_ee(e):t||n?wee(t,n):bee}function xee(e){return function(t,n){return[(t+=e)>MR?t-AR:t<-MR?t+AR:t,n]}}function _ee(e){var t=xee(e);return t.invert=xee(-e),t}function wee(e,t){var n=IR(e),r=jR(e),i=IR(t),o=jR(t);function a(e,t){var a=IR(t),s=IR(e)*a,u=jR(e)*a,l=jR(t),c=l*n+s*r;return[DR(u*i-c*o,s*n-l*r),HR(c*i+u*o)]}return a.invert=function(e,t){var a=IR(t),s=IR(e)*a,u=jR(e)*a,l=jR(t),c=l*i-u*o;return[DR(u*i+l*o,s*n+c*r),HR(c*n-s*r)]},a}function kee(e){return function(t){var n=new See;for(var r in e)n[r]=e[r];return n.stream=t,n}}function See(){}function Cee(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),W8(n,e.stream(c9)),t(c9.result()),null!=r&&e.clipExtent(r),e}function Mee(e,t,n){return Cee(e,(function(n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+t[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+t[0][1]+(i-o*(n[1][1]+n[0][1]))/2;e.scale(150*o).translate([a,s])}),n)}function Tee(e,t,n){return Mee(e,[[0,0],t],n)}function Eee(e,t,n){return Cee(e,(function(n){var r=+t,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];e.scale(150*i).translate([o,a])}),n)}function Aee(e,t,n){return Cee(e,(function(n){var r=+t,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([o,a])}),n)}bee.invert=bee,See.prototype={constructor:See,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Fee=16,Oee=IR(30*OR);function Ree(e,t){return+t?function(e,t){function n(r,i,o,a,s,u,l,c,p,d,h,f,g,m){var y=l-r,b=c-i,v=y*y+b*b;if(v>4*t&&g--){var x=a+d,_=s+h,w=u+f,k=UR(x*x+_*_+w*w),S=HR(w/=k),C=RR(RR(w)-1)<SR||RR(o-p)<SR?(o+p)/2:DR(_,x),M=e(C,S),T=M[0],E=M[1],A=T-r,F=E-i,O=b*A-y*F;(O*O/v>t||RR((y*A+b*F)/v-.5)>.3||a*d+s*h+u*f<Oee)&&(n(r,i,o,a,s,u,T,E,C,x/=k,_/=k,w,g,m),m.point(T,E),n(T,E,C,x,_,w,l,c,p,d,h,f,g,m))}}return function(t){var r,i,o,a,s,u,l,c,p,d,h,f,g={point:m,lineStart:y,lineEnd:v,polygonStart:function(){t.polygonStart(),g.lineStart=x},polygonEnd:function(){t.polygonEnd(),g.lineStart=y}};function m(n,r){n=e(n,r),t.point(n[0],n[1])}function y(){c=NaN,g.point=b,t.lineStart()}function b(r,i){var o=tee([r,i]),a=e(r,i);n(c,p,l,d,h,f,c=a[0],p=a[1],l=r,d=o[0],h=o[1],f=o[2],Fee,t),t.point(c,p)}function v(){g.point=m,t.lineEnd()}function x(){y(),g.point=_,g.lineEnd=w}function _(e,t){b(r=e,t),i=c,o=p,a=d,s=h,u=f,g.point=b}function w(){n(c,p,l,d,h,f,i,o,r,a,s,u,Fee,t),g.lineEnd=v,v()}return g}}(e,t):function(e){return kee({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}var Nee=kee({point:function(e,t){this.stream.point(e*OR,t*OR)}});function Dee(e,t,n,r,i,o){if(!o)return function(e,t,n,r,i){function o(o,a){return[t+e*(o*=r),n-e*(a*=i)]}return o.invert=function(o,a){return[(o-t)/e*r,(n-a)/e*i]},o}(e,t,n,r,i);var a=IR(o),s=jR(o),u=a*e,l=s*e,c=a/e,p=s/e,d=(s*n-a*t)/e,h=(s*t+a*n)/e;function f(e,o){return[u*(e*=r)-l*(o*=i)+t,n-l*e-u*o]}return f.invert=function(e,t){return[r*(c*e-p*t+d),i*(h-p*e-c*t)]},f}function Iee(e){return Bee((function(){return e}))()}function Bee(e){var t,n,r,i,o,a,s,u,l,c,p=150,d=480,h=250,f=0,g=0,m=0,y=0,b=0,v=0,x=1,_=1,w=null,k=dee,S=null,C=P8,M=.5;function T(e){return u(e[0]*OR,e[1]*OR)}function E(e){return(e=u.invert(e[0],e[1]))&&[e[0]*FR,e[1]*FR]}function A(){var e=Dee(p,0,0,x,_,v).apply(null,t(f,g)),r=Dee(p,d-e[0],h-e[1],x,_,v);return n=vee(m,y,b),s=yee(t,r),u=yee(n,s),a=Ree(s,M),F()}function F(){return l=c=null,T}return T.stream=function(e){return l&&c===e?l:l=Nee(function(e){return kee({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(k(a(C(c=e)))))},T.preclip=function(e){return arguments.length?(k=e,w=void 0,F()):k},T.postclip=function(e){return arguments.length?(C=e,S=r=i=o=null,F()):C},T.clipAngle=function(e){return arguments.length?(k=+e?function(e){var t=IR(e),n=6*OR,r=t>0,i=RR(t)>SR;function o(e,n){return IR(e)*IR(n)>t}function a(e,n,r){var i=[1,0,0],o=ree(tee(e),tee(n)),a=nee(o,o),s=o[0],u=a-s*s;if(!u)return!r&&e;var l=t*a/u,c=-t*s/u,p=ree(i,o),d=oee(i,l);iee(d,oee(o,c));var h=p,f=nee(d,h),g=nee(h,h),m=f*f-g*(nee(d,d)-1);if(!(m<0)){var y=UR(m),b=oee(h,(-f-y)/g);if(iee(b,d),b=eee(b),!r)return b;var v,x=e[0],_=n[0],w=e[1],k=n[1];_<x&&(v=x,x=_,_=v);var S=_-x,C=RR(S-MR)<SR;if(!C&&k<w&&(v=w,w=k,k=v),C||S<SR?C?w+k>0^b[1]<(RR(b[0]-x)<SR?w:k):w<=b[1]&&b[1]<=k:S>MR^(x<=b[0]&&b[0]<=_)){var M=oee(h,(-f+y)/g);return iee(M,d),[b,eee(M)]}}}function s(t,n){var i=r?e:MR-e,o=0;return t<-i?o|=1:t>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return lee(o,(function(e){var t,n,u,l,c;return{lineStart:function(){l=u=!1,c=1},point:function(p,d){var h,f=[p,d],g=o(p,d),m=r?g?0:s(p,d):g?s(p+(p<0?MR:-MR),d):0;if(!t&&(l=u=g)&&e.lineStart(),g!==u&&(!(h=a(t,f))||K9(t,h)||K9(f,h))&&(f[2]=1),g!==u)c=0,g?(e.lineStart(),h=a(f,t),e.point(h[0],h[1])):(h=a(t,f),e.point(h[0],h[1],2),e.lineEnd()),t=h;else if(i&&t&&r^g){var y;m&n||!(y=a(f,t,!0))||(c=0,r?(e.lineStart(),e.point(y[0][0],y[0][1]),e.point(y[1][0],y[1][1]),e.lineEnd()):(e.point(y[1][0],y[1][1]),e.lineEnd(),e.lineStart(),e.point(y[0][0],y[0][1],3)))}!g||t&&K9(t,f)||e.point(f[0],f[1]),t=f,u=g,n=m},lineEnd:function(){u&&e.lineEnd(),t=null},clean:function(){return c|(l&&u)<<1}}}),(function(t,r,i,o){!function(e,t,n,r,i,o){if(n){var a=IR(t),s=jR(t),u=r*n;null==i?(i=t+r*AR,o=t-u/2):(i=hee(a,i),o=hee(a,o),(r>0?i<o:i>o)&&(i+=r*AR));for(var l,c=i;r>0?c>o:c<o;c-=u)l=eee([a,-s*IR(c),-s*jR(c)]),e.point(l[0],l[1])}}(o,e,n,i,t,r)}),r?[0,-e]:[-MR,e-MR])}(w=e*OR):(w=null,dee),F()):w*FR},T.clipExtent=function(e){return arguments.length?(C=null==e?(S=r=i=o=null,P8):mee(S=+e[0][0],r=+e[0][1],i=+e[1][0],o=+e[1][1]),F()):null==S?null:[[S,r],[i,o]]},T.scale=function(e){return arguments.length?(p=+e,A()):p},T.translate=function(e){return arguments.length?(d=+e[0],h=+e[1],A()):[d,h]},T.center=function(e){return arguments.length?(f=e[0]%360*OR,g=e[1]%360*OR,A()):[f*FR,g*FR]},T.rotate=function(e){return arguments.length?(m=e[0]%360*OR,y=e[1]%360*OR,b=e.length>2?e[2]%360*OR:0,A()):[m*FR,y*FR,b*FR]},T.angle=function(e){return arguments.length?(v=e%360*OR,A()):v*FR},T.reflectX=function(e){return arguments.length?(x=e?-1:1,A()):x<0},T.reflectY=function(e){return arguments.length?(_=e?-1:1,A()):_<0},T.precision=function(e){return arguments.length?(a=Ree(s,M=e*e),F()):UR(M)},T.fitExtent=function(e,t){return Mee(T,e,t)},T.fitSize=function(e,t){return Tee(T,e,t)},T.fitWidth=function(e,t){return Eee(T,e,t)},T.fitHeight=function(e,t){return Aee(T,e,t)},function(){return t=e.apply(this,arguments),T.invert=t.invert&&E,A()}}function Lee(e){var t=0,n=MR/3,r=Bee(e),i=r(t,n);return i.parallels=function(e){return arguments.length?r(t=e[0]*OR,n=e[1]*OR):[t*FR,n*FR]},i}function Pee(e,t){var n=jR(e),r=(n+jR(t))/2;if(RR(r)<SR)return function(e){var t=IR(e);function n(e,n){return[e*t,jR(n)/t]}return n.invert=function(e,n){return[e/t,HR(n*t)]},n}(e);var i=1+n*(2*r-n),o=UR(i)/r;function a(e,t){var n=UR(i-2*r*jR(t))/r;return[n*jR(e*=r),o-n*IR(e)]}return a.invert=function(e,t){var n=o-t,a=DR(e,RR(n))*GR(n);return n*r<0&&(a-=MR*GR(e)*GR(n)),[a/r,HR((i-(e*e+n*n)*r*r)/(2*r))]},a}function $ee(){return Lee(Pee).scale(155.424).center([0,33.6442])}function zee(){return $ee().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function jee(e){return function(t,n){var r=IR(t),i=IR(n),o=e(r*i);return o===1/0?[2,0]:[o*i*jR(t),o*jR(n)]}}function Gee(e){return function(t,n){var r=UR(t*t+n*n),i=e(r),o=jR(i),a=IR(i);return[DR(t*o,r*a),HR(r&&n*o/r)]}}var Uee=jee((function(e){return UR(2/(1+e))}));Uee.invert=Gee((function(e){return 2*HR(e/2)}));var Wee=jee((function(e){return(e=VR(e))&&e/jR(e)}));function Vee(e,t){return[e,$R(WR((TR+t)/2))]}function Hee(e){var t,n,r,i=Iee(e),o=i.center,a=i.scale,s=i.translate,u=i.clipExtent,l=null;function c(){var o=MR*a(),s=i(function(e){function t(t){return(t=e(t[0]*OR,t[1]*OR))[0]*=FR,t[1]*=FR,t}return e=vee(e[0]*OR,e[1]*OR,e.length>2?e[2]*OR:0),t.invert=function(t){return(t=e.invert(t[0]*OR,t[1]*OR))[0]*=FR,t[1]*=FR,t},t}(i.rotate()).invert([0,0]));return u(null==l?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:e===Vee?[[Math.max(s[0]-o,l),t],[Math.min(s[0]+o,n),r]]:[[l,Math.max(s[1]-o,t)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(e){return arguments.length?(a(e),c()):a()},i.translate=function(e){return arguments.length?(s(e),c()):s()},i.center=function(e){return arguments.length?(o(e),c()):o()},i.clipExtent=function(e){return arguments.length?(null==e?l=t=n=r=null:(l=+e[0][0],t=+e[0][1],n=+e[1][0],r=+e[1][1]),c()):null==l?null:[[l,t],[n,r]]},c()}function qee(e){return WR((TR+e)/2)}function Xee(e,t){var n=IR(e),r=e===t?jR(e):$R(n/IR(t))/$R(qee(t)/qee(e)),i=n*zR(qee(e),r)/r;if(!r)return Vee;function o(e,t){i>0?t<-TR+SR&&(t=-TR+SR):t>TR-SR&&(t=TR-SR);var n=i/zR(qee(t),r);return[n*jR(r*e),i-n*IR(r*e)]}return o.invert=function(e,t){var n=i-t,o=GR(r)*UR(e*e+n*n),a=DR(e,RR(n))*GR(n);return n*r<0&&(a-=MR*GR(e)*GR(n)),[a/r,2*NR(zR(i/o,1/r))-TR]},o}function Yee(e,t){return[e,t]}function Kee(e,t){var n=IR(e),r=e===t?jR(e):(n-IR(t))/(t-e),i=n/r+e;if(RR(r)<SR)return Yee;function o(e,t){var n=i-t,o=r*e;return[n*jR(o),i-n*IR(o)]}return o.invert=function(e,t){var n=i-t,o=DR(e,RR(n))*GR(n);return n*r<0&&(o-=MR*GR(e)*GR(n)),[o/r,i-GR(r)*UR(e*e+n*n)]},o}Wee.invert=Gee((function(e){return e})),Vee.invert=function(e,t){return[e,2*NR(LR(t))-TR]},Yee.invert=Yee;var Jee=1.340264,Zee=-.081106,Qee=893e-6,ete=.003796,tte=UR(3)/2;function nte(e,t){var n=HR(tte*jR(t)),r=n*n,i=r*r*r;return[e*IR(n)/(tte*(Jee+3*Zee*r+i*(7*Qee+.034164*r))),n*(Jee+Zee*r+i*(Qee+ete*r))]}function rte(e,t){var n=IR(t),r=IR(e)*n;return[n*jR(e)/r,jR(t)/r]}function ite(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),t*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function ote(e,t){return[IR(t)*jR(e),jR(t)]}function ate(e,t){var n=IR(t),r=1+IR(e)*n;return[n*jR(e)/r,jR(t)/r]}function ste(e,t){return[$R(WR((TR+t)/2)),-e]}nte.invert=function(e,t){for(var n,r=t,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=n=(r*(Jee+Zee*i+o*(Qee+ete*i))-t)/(Jee+3*Zee*i+o*(7*Qee+.034164*i)))*r)*i*i,!(RR(n)<CR));++a);return[tte*e*(Jee+3*Zee*i+o*(7*Qee+.034164*i))/IR(r),HR(jR(r)/tte)]},rte.invert=Gee(NR),ite.invert=function(e,t){var n,r=t,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-t)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(RR(n)>SR&&--i>0);return[e/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},ote.invert=Gee(HR),ate.invert=Gee((function(e){return 2*NR(e)})),ste.invert=function(e,t){return[-t,2*NR(LR(e))-TR]};var ute=Math.abs,lte=(Math.atan,Math.atan2,Math.ceil,Math.cos),cte=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),pte=(Math.tan,1e-6),dte=Math.PI,hte=dte/2,fte=(Math.SQRT1_2,mte(2));function gte(e){return e>1?hte:e<-1?-hte:Math.asin(e)}function mte(e){return e>0?Math.sqrt(e):0}function yte(e,t){var n,r=e*cte(t),i=30;do{t-=n=(t+cte(t)-r)/(1+lte(t))}while(ute(n)>pte&&--i>0);return t/2}mte(dte);var bte=function(e,t,n){function r(r,i){return[e*r*lte(i=yte(n,i)),t*cte(i)]}return r.invert=function(r,i){return i=gte(i/t),[r/(e*lte(i)),gte((2*i+cte(2*i))/n)]},r}(fte/hte,fte,dte);X9();const vte=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function xte(e,t){if(!e||"string"!=typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(_te[e]=function(e,t){return function n(){const r=t();return r.type=e,r.path=X9().projection(r),r.copy=r.copy||function(){const e=n();return vte.forEach((t=>{r[t]&&e[t](r[t]())})),e.path.pointRadius(r.path.pointRadius()),e},r}}(e,t),this):_te[e]||null}const _te={albers:zee,albersusa:function(){var e,t,n,r,i,o,a=zee(),s=$ee().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=$ee().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(e,t){o=[e,t]}};function c(e){var t=e[0],a=e[1];return o=null,n.point(t,a),o||(r.point(t,a),o)||(i.point(t,a),o)}function p(){return e=t=null,c}return c.invert=function(e){var t=a.scale(),n=a.translate(),r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?u:a).invert(e)},c.stream=function(n){return e&&t===n?e:(r=[a.stream(t=n),s.stream(n),u.stream(n)],i=r.length,e={point:function(e,t){for(var n=-1;++n<i;)r[n].point(e,t)},sphere:function(){for(var e=-1;++e<i;)r[e].sphere()},lineStart:function(){for(var e=-1;++e<i;)r[e].lineStart()},lineEnd:function(){for(var e=-1;++e<i;)r[e].lineEnd()},polygonStart:function(){for(var e=-1;++e<i;)r[e].polygonStart()},polygonEnd:function(){for(var e=-1;++e<i;)r[e].polygonEnd()}});var r,i},c.precision=function(e){return arguments.length?(a.precision(e),s.precision(e),u.precision(e),p()):a.precision()},c.scale=function(e){return arguments.length?(a.scale(e),s.scale(.35*e),u.scale(e),c.translate(a.translate())):a.scale()},c.translate=function(e){if(!arguments.length)return a.translate();var t=a.scale(),o=+e[0],c=+e[1];return n=a.translate(e).clipExtent([[o-.455*t,c-.238*t],[o+.455*t,c+.238*t]]).stream(l),r=s.translate([o-.307*t,c+.201*t]).clipExtent([[o-.425*t+SR,c+.12*t+SR],[o-.214*t-SR,c+.234*t-SR]]).stream(l),i=u.translate([o-.205*t,c+.212*t]).clipExtent([[o-.214*t+SR,c+.166*t+SR],[o-.115*t-SR,c+.234*t-SR]]).stream(l),p()},c.fitExtent=function(e,t){return Mee(c,e,t)},c.fitSize=function(e,t){return Tee(c,e,t)},c.fitWidth=function(e,t){return Eee(c,e,t)},c.fitHeight=function(e,t){return Aee(c,e,t)},c.scale(1070)},azimuthalequalarea:function(){return Iee(Uee).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return Iee(Wee).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return Lee(Xee).scale(109.5).parallels([30,30])},conicequalarea:$ee,conicequidistant:function(){return Lee(Kee).scale(131.154).center([0,13.9389])},equalEarth:function(){return Iee(nte).scale(177.158)},equirectangular:function(){return Iee(Yee).scale(152.63)},gnomonic:function(){return Iee(rte).scale(144.049).clipAngle(60)},identity:function(){var e,t,n,r,i,o,a,s=1,u=0,l=0,c=1,p=1,d=0,h=null,f=1,g=1,m=kee({point:function(e,t){var n=v([e,t]);this.stream.point(n[0],n[1])}}),y=P8;function b(){return f=s*c,g=s*p,o=a=null,v}function v(n){var r=n[0]*f,i=n[1]*g;if(d){var o=i*e-r*t;r=r*e+i*t,i=o}return[r+u,i+l]}return v.invert=function(n){var r=n[0]-u,i=n[1]-l;if(d){var o=i*e+r*t;r=r*e-i*t,i=o}return[r/f,i/g]},v.stream=function(e){return o&&a===e?o:o=m(y(a=e))},v.postclip=function(e){return arguments.length?(y=e,h=n=r=i=null,b()):y},v.clipExtent=function(e){return arguments.length?(y=null==e?(h=n=r=i=null,P8):mee(h=+e[0][0],n=+e[0][1],r=+e[1][0],i=+e[1][1]),b()):null==h?null:[[h,n],[r,i]]},v.scale=function(e){return arguments.length?(s=+e,b()):s},v.translate=function(e){return arguments.length?(u=+e[0],l=+e[1],b()):[u,l]},v.angle=function(n){return arguments.length?(t=jR(d=n%360*OR),e=IR(d),b()):d*FR},v.reflectX=function(e){return arguments.length?(c=e?-1:1,b()):c<0},v.reflectY=function(e){return arguments.length?(p=e?-1:1,b()):p<0},v.fitExtent=function(e,t){return Mee(v,e,t)},v.fitSize=function(e,t){return Tee(v,e,t)},v.fitWidth=function(e,t){return Eee(v,e,t)},v.fitHeight=function(e,t){return Aee(v,e,t)},v},mercator:function(){return Hee(Vee).scale(961/AR)},mollweide:function(){return Iee(bte).scale(169.529)},naturalEarth1:function(){return Iee(ite).scale(175.295)},orthographic:function(){return Iee(ote).scale(249.5).clipAngle(90+SR)},stereographic:function(){return Iee(ate).scale(250).clipAngle(142)},transversemercator:function(){var e=Hee(ste),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)}};for(const e in _te)xte(e,_te[e]);const wte="Literal",kte="CallExpression";function Ste(e){this.type=e}var Cte,Mte,Tte,Ete,Ate;Ste.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=function(e){switch(e.type){case"ArrayExpression":return e.elements;case"BinaryExpression":case"LogicalExpression":return[e.left,e.right];case kte:return[e.callee].concat(e.arguments);case"ConditionalExpression":return[e.test,e.consequent,e.alternate];case"MemberExpression":return[e.object,e.property];case"ObjectExpression":return e.properties;case"Property":return[e.key,e.value];case"UnaryExpression":return[e.argument];default:return[]}}(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};var Fte=1,Ote=2,Rte=3,Nte=4,Dte=5,Ite=6,Bte=7,Lte=8;(Cte={})[Fte]="Boolean",Cte[Ote]="<end>",Cte[Rte]="Identifier",Cte[Nte]="Keyword",Cte[Dte]="Null",Cte[Ite]="Numeric",Cte[Bte]="Punctuator",Cte[Lte]="String",Cte[9]="RegularExpression";var Pte="ArrayExpression",$te="BinaryExpression",zte="CallExpression",jte="ConditionalExpression",Gte="Identifier",Ute="Literal",Wte="LogicalExpression",Vte="MemberExpression",Hte="ObjectExpression",qte="Property",Xte="UnaryExpression",Yte="Unexpected token %0",Kte="Unexpected number",Jte="Unexpected string",Zte="Unexpected identifier",Qte="Unexpected reserved word",ene="Unexpected end of input",tne="Invalid regular expression",nne="Invalid regular expression: missing /",rne="Octal literals are not allowed in strict mode.",ine="Duplicate data property in object literal not allowed in strict mode",one="ILLEGAL",ane="Disabled.",sne=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),une=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function lne(e,t){if(!e)throw new Error("ASSERT: "+t)}function cne(e){return e>=48&&e<=57}function pne(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function dne(e){return"01234567".indexOf(e)>=0}function hne(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function fne(e){return 10===e||13===e||8232===e||8233===e}function gne(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&sne.test(String.fromCharCode(e))}function mne(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&une.test(String.fromCharCode(e))}const yne={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function bne(){for(;Tte<Ete;){const e=Mte.charCodeAt(Tte);if(!hne(e)&&!fne(e))break;++Tte}}function vne(e){var t,n,r,i=0;for(n="u"===e?4:2,t=0;t<n;++t)Tte<Ete&&pne(Mte[Tte])?(r=Mte[Tte++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):Nne({},Yte,one);return String.fromCharCode(i)}function xne(){var e,t,n,r;for(t=0,"}"===(e=Mte[Tte])&&Nne({},Yte,one);Tte<Ete&&pne(e=Mte[Tte++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&Nne({},Yte,one),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function _ne(){var e,t;for(e=Mte.charCodeAt(Tte++),t=String.fromCharCode(e),92===e&&(117!==Mte.charCodeAt(Tte)&&Nne({},Yte,one),++Tte,(e=vne("u"))&&"\\"!==e&&gne(e.charCodeAt(0))||Nne({},Yte,one),t=e);Tte<Ete&&mne(e=Mte.charCodeAt(Tte));)++Tte,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==Mte.charCodeAt(Tte)&&Nne({},Yte,one),++Tte,(e=vne("u"))&&"\\"!==e&&mne(e.charCodeAt(0))||Nne({},Yte,one),t+=e);return t}function wne(){var e,t,n,r,i=Tte,o=Mte.charCodeAt(Tte),a=Mte[Tte];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Tte,{type:Bte,value:String.fromCharCode(o),start:i,end:Tte};default:if(61===(e=Mte.charCodeAt(Tte+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return Tte+=2,{type:Bte,value:String.fromCharCode(o)+String.fromCharCode(e),start:i,end:Tte};case 33:case 61:return Tte+=2,61===Mte.charCodeAt(Tte)&&++Tte,{type:Bte,value:Mte.slice(i,Tte),start:i,end:Tte}}}return">>>="===(r=Mte.substr(Tte,4))?{type:Bte,value:r,start:i,end:Tte+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:Bte,value:n,start:i,end:Tte+=3}:a===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(a)>=0||"=>"===t?{type:Bte,value:t,start:i,end:Tte+=2}:("//"===t&&Nne({},Yte,one),"<>=!+-*%&|^/".indexOf(a)>=0?(++Tte,{type:Bte,value:a,start:i,end:Tte}):void Nne({},Yte,one))}function kne(){var e,t,n;if(lne(cne((n=Mte[Tte]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=Tte,e="","."!==n){if(e=Mte[Tte++],n=Mte[Tte],"0"===e){if("x"===n||"X"===n)return++Tte,function(e){let t="";for(;Tte<Ete&&pne(Mte[Tte]);)t+=Mte[Tte++];return 0===t.length&&Nne({},Yte,one),gne(Mte.charCodeAt(Tte))&&Nne({},Yte,one),{type:Ite,value:parseInt("0x"+t,16),start:e,end:Tte}}(t);if(dne(n))return function(e){let t="0"+Mte[Tte++];for(;Tte<Ete&&dne(Mte[Tte]);)t+=Mte[Tte++];return(gne(Mte.charCodeAt(Tte))||cne(Mte.charCodeAt(Tte)))&&Nne({},Yte,one),{type:Ite,value:parseInt(t,8),octal:!0,start:e,end:Tte}}(t);n&&cne(n.charCodeAt(0))&&Nne({},Yte,one)}for(;cne(Mte.charCodeAt(Tte));)e+=Mte[Tte++];n=Mte[Tte]}if("."===n){for(e+=Mte[Tte++];cne(Mte.charCodeAt(Tte));)e+=Mte[Tte++];n=Mte[Tte]}if("e"===n||"E"===n)if(e+=Mte[Tte++],"+"!==(n=Mte[Tte])&&"-"!==n||(e+=Mte[Tte++]),cne(Mte.charCodeAt(Tte)))for(;cne(Mte.charCodeAt(Tte));)e+=Mte[Tte++];else Nne({},Yte,one);return gne(Mte.charCodeAt(Tte))&&Nne({},Yte,one),{type:Ite,value:parseFloat(e),start:t,end:Tte}}function Sne(){if(bne(),Tte>=Ete)return{type:Ote,start:Tte,end:Tte};const e=Mte.charCodeAt(Tte);return gne(e)?function(){var e,t;return e=Tte,t=92===Mte.charCodeAt(Tte)?_ne():function(){var e,t;for(e=Tte++;Tte<Ete;){if(92===(t=Mte.charCodeAt(Tte)))return Tte=e,_ne();if(!mne(t))break;++Tte}return Mte.slice(e,Tte)}(),{type:1===t.length?Rte:yne.hasOwnProperty(t)?Nte:"null"===t?Dte:"true"===t||"false"===t?Fte:Rte,value:t,start:e,end:Tte}}():40===e||41===e||59===e?wne():39===e||34===e?function(){var e,t,n,r,i="",o=!1;for(lne("'"===(e=Mte[Tte])||'"'===e,"String literal must starts with a quote"),t=Tte,++Tte;Tte<Ete;){if((n=Mte[Tte++])===e){e="";break}if("\\"===n)if((n=Mte[Tte++])&&fne(n.charCodeAt(0)))"\r"===n&&"\n"===Mte[Tte]&&++Tte;else switch(n){case"u":case"x":"{"===Mte[Tte]?(++Tte,i+=xne()):i+=vne(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:dne(n)?(0!==(r="01234567".indexOf(n))&&(o=!0),Tte<Ete&&dne(Mte[Tte])&&(o=!0,r=8*r+"01234567".indexOf(Mte[Tte++]),"0123".indexOf(n)>=0&&Tte<Ete&&dne(Mte[Tte])&&(r=8*r+"01234567".indexOf(Mte[Tte++]))),i+=String.fromCharCode(r)):i+=n}else{if(fne(n.charCodeAt(0)))break;i+=n}}return""!==e&&Nne({},Yte,one),{type:Lte,value:i,octal:o,start:t,end:Tte}}():46===e?cne(Mte.charCodeAt(Tte+1))?kne():wne():cne(e)?kne():wne()}function Cne(){const e=Ate;return Tte=e.end,Ate=Sne(),Tte=e.end,e}function Mne(){const e=Tte;Ate=Sne(),Tte=e}function Tne(e,t,n){const r=new Ste("||"===e||"&&"===e?Wte:$te);return r.operator=e,r.left=t,r.right=n,r}function Ene(e,t){const n=new Ste(zte);return n.callee=e,n.arguments=t,n}function Ane(e){const t=new Ste(Gte);return t.name=e,t}function Fne(e){const t=new Ste(Ute);return t.value=e.value,t.raw=Mte.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function One(e,t,n){const r=new Ste(Vte);return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function Rne(e,t,n){const r=new Ste(qte);return r.key=t,r.value=n,r.kind=e,r}function Nne(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,((e,t)=>(lne(t<r.length,"Message reference must be in range"),r[t])));throw(n=new Error(i)).index=Tte,n.description=i,n}function Dne(e){e.type===Ote&&Nne(e,ene),e.type===Ite&&Nne(e,Kte),e.type===Lte&&Nne(e,Jte),e.type===Rte&&Nne(e,Zte),e.type===Nte&&Nne(e,Qte),Nne(e,Yte,e.value)}function Ine(e){const t=Cne();t.type===Bte&&t.value===e||Dne(t)}function Bne(e){return Ate.type===Bte&&Ate.value===e}function Lne(e){return Ate.type===Nte&&Ate.value===e}function Pne(){Tte=Ate.start;const e=Cne();return e.type===Lte||e.type===Ite?(e.octal&&Nne(e,rne),Fne(e)):Ane(e.value)}function $ne(){var e,t,n;return Tte=Ate.start,(e=Ate).type===Rte?(n=Pne(),Ine(":"),Rne("init",n,Xne())):e.type!==Ote&&e.type!==Bte?(t=Pne(),Ine(":"),Rne("init",t,Xne())):void Dne(e)}const zne={if:1};function jne(){var e,t,n;if(Bne("("))return function(){Ine("(");const e=Yne();return Ine(")"),e}();if(Bne("["))return function(){const e=[];for(Tte=Ate.start,Ine("[");!Bne("]");)Bne(",")?(Cne(),e.push(null)):(e.push(Xne()),Bne("]")||Ine(","));return Cne(),function(e){const t=new Ste(Pte);return t.elements=e,t}(e)}();if(Bne("{"))return function(){var e,t,n=[],r={},i=String;for(Tte=Ate.start,Ine("{");!Bne("}");)t="$"+((e=$ne()).key.type===Gte?e.key.name:i(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?Nne({},ine):r[t]=!0,n.push(e),Bne("}")||Ine(",");return Ine("}"),function(e){const t=new Ste(Hte);return t.properties=e,t}(n)}();if(e=Ate.type,Tte=Ate.start,e===Rte||zne[Ate.value])n=Ane(Cne().value);else if(e===Lte||e===Ite)Ate.octal&&Nne(Ate,rne),n=Fne(Cne());else{if(e===Nte)throw new Error(ane);e===Fte?((t=Cne()).value="true"===t.value,n=Fne(t)):e===Dte?((t=Cne()).value=null,n=Fne(t)):Bne("/")||Bne("/=")?(n=Fne(function(){var e,t,n,r;return Ate=null,bne(),e=Tte,t=function(){var e,t,n,r;for(lne("/"===(e=Mte[Tte]),"Regular expression literal must start with a slash"),t=Mte[Tte++],n=!1,r=!1;Tte<Ete;)if(t+=e=Mte[Tte++],"\\"===e)fne((e=Mte[Tte++]).charCodeAt(0))&&Nne({},nne),t+=e;else if(fne(e.charCodeAt(0)))Nne({},nne);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||Nne({},nne),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";Tte<Ete&&mne((e=Mte[Tte]).charCodeAt(0));)++Tte,"\\"===e&&Tte<Ete?Nne({},Yte,one):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Nne({},tne,n),{value:n,literal:t}}(),r=function(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((e,t)=>{if(parseInt(t,16)<=1114111)return"x";Nne({},tne)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(e){Nne({},tne)}try{return new RegExp(e,t)}catch(e){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:Tte}}()),Mne()):Dne(Cne())}return n}function Gne(){const e=[];if(Ine("("),!Bne(")"))for(;Tte<Ete&&(e.push(Xne()),!Bne(")"));)Ine(",");return Ine(")"),e}function Une(){Tte=Ate.start;const e=Cne();return function(e){return e.type===Rte||e.type===Nte||e.type===Fte||e.type===Dte}(e)||Dne(e),Ane(e.value)}function Wne(){Ine("[");const e=Yne();return Ine("]"),e}function Vne(){const e=function(){var e;for(e=jne();;)if(Bne("."))Ine("."),e=One(".",e,Une());else if(Bne("("))e=Ene(e,Gne());else{if(!Bne("["))break;e=One("[",e,Wne())}return e}();if(Ate.type===Bte&&(Bne("++")||Bne("--")))throw new Error(ane);return e}function Hne(){var e,t;if(Ate.type!==Bte&&Ate.type!==Nte)t=Vne();else{if(Bne("++")||Bne("--"))throw new Error(ane);if(Bne("+")||Bne("-")||Bne("~")||Bne("!"))e=Cne(),t=Hne(),t=function(e,t){const n=new Ste(Xte);return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(Lne("delete")||Lne("void")||Lne("typeof"))throw new Error(ane);t=Vne()}}return t}function qne(e){let t=0;if(e.type!==Bte&&e.type!==Nte)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function Xne(){var e,t;return e=function(){var e,t,n,r,i,o,a,s,u,l;if(e=Ate,u=Hne(),0===(i=qne(r=Ate)))return u;for(r.prec=i,Cne(),t=[e,Ate],o=[u,r,a=Hne()];(i=qne(Ate))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,u=o.pop(),t.pop(),n=Tne(s,u,a),o.push(n);(r=Cne()).prec=i,o.push(r),t.push(Ate),n=Hne(),o.push(n)}for(n=o[l=o.length-1],t.pop();l>1;)t.pop(),n=Tne(o[l-1].value,o[l-2],n),l-=2;return n}(),Bne("?")&&(Cne(),t=Xne(),Ine(":"),e=function(e,t,n){const r=new Ste(jte);return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,Xne())),e}function Yne(){const e=Xne();if(Bne(","))throw new Error(ane);return e}var Kne={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Jne(e){function t(t,n,r){return i=>function(t,n,r,i){let o=e(n[0]);return r&&(o=r+"("+o+")",0===r.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+t+(i<0?"":0===i?"()":"("+n.slice(1).map(e).join(",")+")")}(t,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&Vt("Missing arguments to clamp function."),t.length>3&&Vt("Too many arguments to clamp function.");const n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:t("getDate",n,0),day:t("getDay",n,0),year:t("getFullYear",n,0),month:t("getMonth",n,0),hours:t("getHours",n,0),minutes:t("getMinutes",n,0),seconds:t("getSeconds",n,0),milliseconds:t("getMilliseconds",n,0),time:t("getTime",n,0),timezoneoffset:t("getTimezoneOffset",n,0),utcdate:t("getUTCDate",n,0),utcday:t("getUTCDay",n,0),utcyear:t("getUTCFullYear",n,0),utcmonth:t("getUTCMonth",n,0),utchours:t("getUTCHours",n,0),utcminutes:t("getUTCMinutes",n,0),utcseconds:t("getUTCSeconds",n,0),utcmilliseconds:t("getUTCMilliseconds",n,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",r,0),lower:t("toLowerCase",r,0),substring:t("substring",r),split:t("split",r),trim:t("trim",r,0),regexp:i,test:t("test",i),if:function(t){t.length<3&&Vt("Missing arguments to if function."),t.length>3&&Vt("Too many arguments to if function.");const n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}class Zne{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=t[r],o=e+i,a=Math.abs(e)<Math.abs(i)?e-(o-i):i-(o-e);a&&(t[n++]=a),e=o}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,r,i=this._n,o=0;if(i>0){for(o=e[--i];i>0&&(t=o,n=e[--i],o=t+n,r=n-(o-t),!r););i>0&&(r<0&&e[i-1]<0||r>0&&e[i-1]>0)&&(n=2*r,t=o+n,n==t-o&&(o=t))}return o}}var Qne=1e-6,ere=Math.PI,tre=ere/2,nre=ere/4,rre=2*ere,ire=180/ere,ore=ere/180,are=Math.abs,sre=(Math.atan,Math.atan2),ure=Math.cos,lre=(Math.ceil,Math.exp,Math.floor,Math.hypot),cre=(Math.log,Math.pow,Math.sin),pre=(Math.sign,Math.sqrt);function dre(e){return e>1?tre:e<-1?-tre:Math.asin(e)}function hre(){}function fre(e,t){e&&mre.hasOwnProperty(e.type)&&mre[e.type](e,t)}Math.tan;var gre={Feature:function(e,t){fre(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)fre(n[r].geometry,t)}},mre={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){yre(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)yre(n[r],t,0)},Polygon:function(e,t){bre(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)bre(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)fre(n[r],t)}};function yre(e,t,n){var r,i=-1,o=e.length-n;for(t.lineStart();++i<o;)r=e[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function bre(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)yre(e[n],t,1);t.polygonEnd()}function vre(e,t){e&&gre.hasOwnProperty(e.type)?gre[e.type](e,t):fre(e,t)}var xre,_re,wre,kre,Sre,Cre,Mre,Tre,Ere,Are,Fre,Ore,Rre,Nre,Dre,Ire,Bre=new Zne,Lre=new Zne,Pre={point:hre,lineStart:hre,lineEnd:hre,polygonStart:function(){Bre=new Zne,Pre.lineStart=$re,Pre.lineEnd=zre},polygonEnd:function(){var e=+Bre;Lre.add(e<0?rre+e:e),this.lineStart=this.lineEnd=this.point=hre},sphere:function(){Lre.add(rre)}};function $re(){Pre.point=jre}function zre(){Gre(xre,_re)}function jre(e,t){Pre.point=Gre,xre=e,_re=t,wre=e*=ore,kre=ure(t=(t*=ore)/2+nre),Sre=cre(t)}function Gre(e,t){var n=(e*=ore)-wre,r=n>=0?1:-1,i=r*n,o=ure(t=(t*=ore)/2+nre),a=cre(t),s=Sre*a,u=kre*o+s*ure(i),l=s*r*cre(i);Bre.add(sre(l,u)),wre=e,kre=o,Sre=a}function Ure(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}var Wre,Vre,Hre,qre,Xre,Yre,Kre,Jre,Zre,Qre,eie,tie,nie,rie,iie,oie,aie={point:sie,lineStart:lie,lineEnd:cie,polygonStart:function(){aie.point=pie,aie.lineStart=die,aie.lineEnd=hie,Nre=new Zne,Pre.polygonStart()},polygonEnd:function(){Pre.polygonEnd(),aie.point=sie,aie.lineStart=lie,aie.lineEnd=cie,Bre<0?(Cre=-(Tre=180),Mre=-(Ere=90)):Nre>Qne?Ere=90:Nre<-1e-6&&(Mre=-90),Ire[0]=Cre,Ire[1]=Tre},sphere:function(){Cre=-(Tre=180),Mre=-(Ere=90)}};function sie(e,t){Dre.push(Ire=[Cre=e,Tre=e]),t<Mre&&(Mre=t),t>Ere&&(Ere=t)}function uie(e,t){var n,r,i=function(e){var t=e[0],n=e[1],r=ure(n);return[r*ure(t),r*cre(t),cre(n)]}([e*ore,t*ore]);if(Rre){var o=Ure(Rre,i),a=Ure([o[1],-o[0],0],o);r=pre((n=a)[0]*n[0]+n[1]*n[1]+n[2]*n[2]),n[0]/=r,n[1]/=r,n[2]/=r,a=function(e){return[sre(e[1],e[0]),dre(e[2])]}(a);var s,u=e-Are,l=u>0?1:-1,c=a[0]*ire*l,p=are(u)>180;p^(l*Are<c&&c<l*e)?(s=a[1]*ire)>Ere&&(Ere=s):p^(l*Are<(c=(c+360)%360-180)&&c<l*e)?(s=-a[1]*ire)<Mre&&(Mre=s):(t<Mre&&(Mre=t),t>Ere&&(Ere=t)),p?e<Are?fie(Cre,e)>fie(Cre,Tre)&&(Tre=e):fie(e,Tre)>fie(Cre,Tre)&&(Cre=e):Tre>=Cre?(e<Cre&&(Cre=e),e>Tre&&(Tre=e)):e>Are?fie(Cre,e)>fie(Cre,Tre)&&(Tre=e):fie(e,Tre)>fie(Cre,Tre)&&(Cre=e)}else Dre.push(Ire=[Cre=e,Tre=e]);t<Mre&&(Mre=t),t>Ere&&(Ere=t),Rre=i,Are=e}function lie(){aie.point=uie}function cie(){Ire[0]=Cre,Ire[1]=Tre,aie.point=sie,Rre=null}function pie(e,t){if(Rre){var n=e-Are;Nre.add(are(n)>180?n+(n>0?360:-360):n)}else Fre=e,Ore=t;Pre.point(e,t),uie(e,t)}function die(){Pre.lineStart()}function hie(){pie(Fre,Ore),Pre.lineEnd(),are(Nre)>Qne&&(Cre=-(Tre=180)),Ire[0]=Cre,Ire[1]=Tre,Rre=null}function fie(e,t){return(t-=e)<0?t+360:t}function gie(e,t){return e[0]-t[0]}function mie(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var yie={sphere:hre,point:bie,lineStart:xie,lineEnd:kie,polygonStart:function(){yie.lineStart=Sie,yie.lineEnd=Cie},polygonEnd:function(){yie.lineStart=xie,yie.lineEnd=kie}};function bie(e,t){e*=ore;var n=ure(t*=ore);vie(n*ure(e),n*cre(e),cre(t))}function vie(e,t,n){++Wre,Hre+=(e-Hre)/Wre,qre+=(t-qre)/Wre,Xre+=(n-Xre)/Wre}function xie(){yie.point=_ie}function _ie(e,t){e*=ore;var n=ure(t*=ore);rie=n*ure(e),iie=n*cre(e),oie=cre(t),yie.point=wie,vie(rie,iie,oie)}function wie(e,t){e*=ore;var n=ure(t*=ore),r=n*ure(e),i=n*cre(e),o=cre(t),a=sre(pre((a=iie*o-oie*i)*a+(a=oie*r-rie*o)*a+(a=rie*i-iie*r)*a),rie*r+iie*i+oie*o);Vre+=a,Yre+=a*(rie+(rie=r)),Kre+=a*(iie+(iie=i)),Jre+=a*(oie+(oie=o)),vie(rie,iie,oie)}function kie(){yie.point=bie}function Sie(){yie.point=Mie}function Cie(){Tie(tie,nie),yie.point=bie}function Mie(e,t){tie=e,nie=t,e*=ore,t*=ore,yie.point=Tie;var n=ure(t);rie=n*ure(e),iie=n*cre(e),oie=cre(t),vie(rie,iie,oie)}function Tie(e,t){e*=ore;var n=ure(t*=ore),r=n*ure(e),i=n*cre(e),o=cre(t),a=iie*o-oie*i,s=oie*r-rie*o,u=rie*i-iie*r,l=lre(a,s,u),c=dre(l),p=l&&-c/l;Zre.add(p*a),Qre.add(p*s),eie.add(p*u),Vre+=c,Yre+=c*(rie+(rie=r)),Kre+=c*(iie+(iie=i)),Jre+=c*(oie+(oie=o)),vie(rie,iie,oie)}function Eie(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Aie(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Fie(){}var Oie=.7,Rie=1.4285714285714286,Nie="\\s*([+-]?\\d+)\\s*",Die="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Iie="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Bie=/^#([0-9a-f]{3,8})$/,Lie=new RegExp(`^rgb\\(${Nie},${Nie},${Nie}\\)$`),Pie=new RegExp(`^rgb\\(${Iie},${Iie},${Iie}\\)$`),$ie=new RegExp(`^rgba\\(${Nie},${Nie},${Nie},${Die}\\)$`),zie=new RegExp(`^rgba\\(${Iie},${Iie},${Iie},${Die}\\)$`),jie=new RegExp(`^hsl\\(${Die},${Iie},${Iie}\\)$`),Gie=new RegExp(`^hsla\\(${Die},${Iie},${Iie},${Die}\\)$`),Uie={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Wie(){return this.rgb().formatHex()}function Vie(){return this.rgb().formatRgb()}function Hie(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Bie.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?qie(t):3===n?new Jie(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Xie(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Xie(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Lie.exec(e))?new Jie(t[1],t[2],t[3],1):(t=Pie.exec(e))?new Jie(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=$ie.exec(e))?Xie(t[1],t[2],t[3],t[4]):(t=zie.exec(e))?Xie(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=jie.exec(e))?roe(t[1],t[2]/100,t[3]/100,1):(t=Gie.exec(e))?roe(t[1],t[2]/100,t[3]/100,t[4]):Uie.hasOwnProperty(e)?qie(Uie[e]):"transparent"===e?new Jie(NaN,NaN,NaN,0):null}function qie(e){return new Jie(e>>16&255,e>>8&255,255&e,1)}function Xie(e,t,n,r){return r<=0&&(e=t=n=NaN),new Jie(e,t,n,r)}function Yie(e){return e instanceof Fie||(e=Hie(e)),e?new Jie((e=e.rgb()).r,e.g,e.b,e.opacity):new Jie}function Kie(e,t,n,r){return 1===arguments.length?Yie(e):new Jie(e,t,n,null==r?1:r)}function Jie(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Zie(){return`#${noe(this.r)}${noe(this.g)}${noe(this.b)}`}function Qie(){const e=eoe(this.opacity);return`${1===e?"rgb(":"rgba("}${toe(this.r)}, ${toe(this.g)}, ${toe(this.b)}${1===e?")":`, ${e})`}`}function eoe(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function toe(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function noe(e){return((e=toe(e))<16?"0":"")+e.toString(16)}function roe(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new aoe(e,t,n,r)}function ioe(e){if(e instanceof aoe)return new aoe(e.h,e.s,e.l,e.opacity);if(e instanceof Fie||(e=Hie(e)),!e)return new aoe;if(e instanceof aoe)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new aoe(a,s,u,e.opacity)}function ooe(e,t,n,r){return 1===arguments.length?ioe(e):new aoe(e,t,n,null==r?1:r)}function aoe(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function soe(e){return(e=(e||0)%360)<0?e+360:e}function uoe(e){return Math.max(0,Math.min(1,e||0))}function loe(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}Eie(Fie,Hie,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Wie,formatHex:Wie,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return ioe(this).formatHsl()},formatRgb:Vie,toString:Vie}),Eie(Jie,Kie,Aie(Fie,{brighter(e){return e=null==e?Rie:Math.pow(Rie,e),new Jie(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?Oie:Math.pow(Oie,e),new Jie(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Jie(toe(this.r),toe(this.g),toe(this.b),eoe(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Zie,formatHex:Zie,formatHex8:function(){return`#${noe(this.r)}${noe(this.g)}${noe(this.b)}${noe(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Qie,toString:Qie})),Eie(aoe,ooe,Aie(Fie,{brighter(e){return e=null==e?Rie:Math.pow(Rie,e),new aoe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Oie:Math.pow(Oie,e),new aoe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Jie(loe(e>=240?e-240:e+120,i,r),loe(e,i,r),loe(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new aoe(soe(this.h),uoe(this.s),uoe(this.l),eoe(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=eoe(this.opacity);return`${1===e?"hsl(":"hsla("}${soe(this.h)}, ${100*uoe(this.s)}%, ${100*uoe(this.l)}%${1===e?")":`, ${e})`}`}}));const coe=Math.PI/180,poe=180/Math.PI,doe=.96422,hoe=1,foe=.82521,goe=4/29,moe=.12841854934601665,yoe=.008856451679035631;function boe(e){if(e instanceof xoe)return new xoe(e.l,e.a,e.b,e.opacity);if(e instanceof Moe)return Toe(e);e instanceof Jie||(e=Yie(e));var t,n,r=Soe(e.r),i=Soe(e.g),o=Soe(e.b),a=_oe((.2225045*r+.7168786*i+.0606169*o)/hoe);return r===i&&i===o?t=n=a:(t=_oe((.4360747*r+.3850649*i+.1430804*o)/doe),n=_oe((.0139322*r+.0971045*i+.7141733*o)/foe)),new xoe(116*a-16,500*(t-a),200*(a-n),e.opacity)}function voe(e,t,n,r){return 1===arguments.length?boe(e):new xoe(e,t,n,null==r?1:r)}function xoe(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function _oe(e){return e>yoe?Math.pow(e,1/3):e/moe+goe}function woe(e){return e>.20689655172413793?e*e*e:moe*(e-goe)}function koe(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Soe(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Coe(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof Moe)return new Moe(e.h,e.c,e.l,e.opacity);if(e instanceof xoe||(e=boe(e)),0===e.a&&0===e.b)return new Moe(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*poe;return new Moe(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}(e):new Moe(e,t,n,null==r?1:r)}function Moe(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function Toe(e){if(isNaN(e.h))return new xoe(e.l,0,0,e.opacity);var t=e.h*coe;return new xoe(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function Eoe(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Aoe(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Foe(){return 0}function Ooe(e){return e instanceof my?e:new my(e)}Eie(xoe,voe,Aie(Fie,{brighter(e){return new xoe(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new xoe(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new Jie(koe(3.1338561*(t=doe*woe(t))-1.6168667*(e=hoe*woe(e))-.4906146*(n=foe*woe(n))),koe(-.9787684*t+1.9161415*e+.033454*n),koe(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),Eie(Moe,Coe,Aie(Fie,{brighter(e){return new Moe(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new Moe(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return Toe(this).rgb()}}));const Roe="intersect",Noe="union",Doe="_vgsid_",Ioe=qt(Doe),Boe="E",Loe="R",Poe="R-E",$oe="R-LE",zoe="R-RE",joe="index:unit";function Goe(e,t){for(var n,r,i=t.fields,o=t.values,a=i.length,s=0;s<a;++s)if((r=i[s]).getter=qt.getter||qt(r.field),Un(n=r.getter(e))&&(n=hn(n)),Un(o[s])&&(o[s]=hn(o[s])),Un(o[s][0])&&(o[s]=o[s].map(hn)),r.type===Boe){if(sn(o[s])?o[s].indexOf(n)<0:n!==o[s])return!1}else if(r.type===Loe){if(!Gn(n,o[s]))return!1}else if(r.type===zoe){if(!Gn(n,o[s],!0,!1))return!1}else if(r.type===Poe){if(!Gn(n,o[s],!1,!1))return!1}else if(r.type===$oe&&!Gn(n,o[s],!1,!0))return!1;return!0}function Uoe(e,t,n){for(var r,i,o,a,s,u=this.context.data[e],l=u?u.values.value:[],c=u?u[joe]&&u[joe].value:void 0,p=n===Roe,d=l.length,h=0;h<d;++h)if(r=l[h],c&&p){if(-1===(o=(i=i||{})[a=r.unit]||0))continue;if(s=Goe(t,r),i[a]=s?-1:++o,s&&1===c.size)return!0;if(!s&&o===c.get(a).count)return!1}else if(p^(s=Goe(t,r)))return s;return d&&p}const Woe=function(e){let t,n,r;function i(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<0?i=t+1:o=t}while(i<o)}return i}return 2!==e.length?(t=Eoe,n=(t,n)=>Eoe(e(t),n),r=(t,n)=>e(t)-n):(t=e===Eoe||e===Aoe?e:Foe,n=e,r=e),{left:i,center:function(e,t,n=0,o=e.length){const a=i(e,t,n,o-1);return a>n&&r(e[a-1],t)>-r(e[a],t)?a-1:a},right:function(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<=0?i=t+1:o=t}while(i<o)}return i}}}(Ioe),Voe=Woe.left,Hoe=Woe.right;function qoe(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],o=r?r[joe]&&r[joe].value:void 0,a=n===Roe,s=Ioe(t),u=Voe(i,s);if(u===i.length)return!1;if(Ioe(i[u])!==s)return!1;if(o&&a){if(1===o.size)return!0;if(Hoe(i,s)-u<o.size)return!1}return!0}function Xoe(e,t){return e.map((e=>In(t.fields?{values:t.fields.map((t=>(t.getter||(t.getter=qt(t.field)))(e.datum)))}:{[Doe]:Ioe(e.datum)},t)))}function Yoe(e,t,n,r){for(var i,o,a,s,u,l,c,p,d,h,f,g,m=this.context.data[e],y=m?m.values.value:[],b={},v={},x={},_=y.length,w=0;w<_;++w)if(s=(i=y[w]).unit,o=i.fields,a=i.values,o&&a){for(f=0,g=o.length;f<g;++f)u=o[f],p=(c=b[u.field]||(b[u.field]={}))[s]||(c[s]=[]),x[u.field]=d=u.type.charAt(0),h=Koe[`${d}_union`],c[s]=h(p,Cn(a[f]));n&&(p=v[s]||(v[s]=[])).push(Cn(a).reduce(((e,t,n)=>(e[o[n].field]=t,e)),{}))}else u=Doe,l=Ioe(i),(p=(c=b[u]||(b[u]={}))[s]||(c[s]=[])).push(l),n&&(p=v[s]||(v[s]=[])).push({[Doe]:l});return t=t||Noe,b[Doe]?b[Doe]=Koe[`${Doe}_${t}`](...Object.values(b[Doe])):Object.keys(b).forEach((e=>{b[e]=Object.keys(b[e]).map((t=>b[e][t])).reduce(((n,r)=>void 0===n?r:Koe[`${x[e]}_${t}`](n,r)))})),y=Object.keys(v),n&&y.length&&(b[r?"vlPoint":"vlMulti"]=t===Noe?{or:y.reduce(((e,t)=>(e.push(...v[t]),e)),[])}:{and:y.map((e=>({or:v[e]})))}),b}var Koe={[`${Doe}_union`]:function(...e){const t=new my;for(const n of e)for(const e of n)t.add(e);return t},[`${Doe}_intersect`]:function(e,...t){e=new my(e),t=t.map(Ooe);e:for(const n of e)for(const r of t)if(!r.has(n)){e.delete(n);continue e}return e},E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter((e=>t.indexOf(e)>=0)):t},R_union:function(e,t){var n=hn(t[0]),r=hn(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=hn(t[0]),r=hn(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};function Joe(e,t,n,r){t[0].type!==wte&&Vt("First argument to selection functions must be a string literal.");const i=t[0].value,o="unit",a="@"+o,s=":"+i;(t.length>=2&&dn(t).value)!==Roe||Pn(r,a)||(r[a]=n.getData(i).indataRef(n,o)),Pn(r,s)||(r[s]=n.getData(i).tuplesRef())}function Zoe(e){const t=this.context.data[e];return t?t.values.value:[]}const Qoe=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},eae=Qoe("format"),tae=Qoe("timeFormat"),nae=Qoe("utcFormat"),rae=Qoe("timeParse"),iae=Qoe("utcParse"),oae=new Date(2e3,0,1);function aae(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(oae.setYear(2e3),oae.setMonth(e),oae.setDate(t),tae.call(this,oae,n)):""}const sae="%",uae="$";function lae(e,t,n,r){t[0].type!==wte&&Vt("First argument to data functions must be a string literal.");const i=t[0].value,o=":"+i;if(!Pn(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(e){}}function cae(e,t,n,r){if(t[0].type===wte)pae(n,r,t[0].value);else for(e in n.scales)pae(n,r,e)}function pae(e,t,n){const r=sae+n;if(!Pn(t,r))try{t[r]=e.scaleRef(n)}catch(e){}}function dae(e,t){if(Mn(e))return e;if(Vn(e)){const r=t.scales[e];return r&&((n=r.value)&&!0===n[Qv])?r.value:void 0}var n}function hae(e,t){return function(n,r,i){if(n){const t=dae(n,(i||this).context);return t&&t.path[e](r)}return t(r)}}const fae=hae("area",(function(e){return Lre=new Zne,vre(e,Pre),2*Lre})),gae=hae("bounds",(function(e){var t,n,r,i,o,a,s;if(Ere=Tre=-(Cre=Mre=1/0),Dre=[],vre(e,aie),n=Dre.length){for(Dre.sort(gie),t=1,o=[r=Dre[0]];t<n;++t)mie(r,(i=Dre[t])[0])||mie(r,i[1])?(fie(r[0],i[1])>fie(r[0],r[1])&&(r[1]=i[1]),fie(i[0],r[1])>fie(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,t=0,r=o[n=o.length-1];t<=n;r=i,++t)i=o[t],(s=fie(r[1],i[0]))>a&&(a=s,Cre=i[0],Tre=r[1])}return Dre=Ire=null,Cre===1/0||Mre===1/0?[[NaN,NaN],[NaN,NaN]]:[[Cre,Mre],[Tre,Ere]]})),mae=hae("centroid",(function(e){Wre=Vre=Hre=qre=Xre=Yre=Kre=Jre=0,Zre=new Zne,Qre=new Zne,eie=new Zne,vre(e,yie);var t=+Zre,n=+Qre,r=+eie,i=lre(t,n,r);return i<1e-12&&(t=Yre,n=Kre,r=Jre,Vre<Qne&&(t=Hre,n=qre,r=Xre),(i=lre(t,n,r))<1e-12)?[NaN,NaN]:[sre(n,t)*ire,dre(r/i)*ire]}));function yae(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(t){e.warn(t)}return n[n.length-1]}function bae(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function vae(e){const t=Kie(e);return.2126*bae(t.r)+.7152*bae(t.g)+.0722*bae(t.b)}function xae(e,t){return e===t||e!=e&&t!=t||(sn(e)?!(!sn(t)||e.length!==t.length)&&function(e,t){for(let n=0,r=e.length;n<r;++n)if(!xae(e[n],t[n]))return!1;return!0}(e,t):!(!un(e)||!un(t))&&_ae(e,t))}function _ae(e,t){for(const n in e)if(!xae(e[n],t[n]))return!1;return!0}function wae(e){return t=>_ae(e,t)}const kae={};function Sae(e){return sn(e)||ArrayBuffer.isView(e)?e:null}function Cae(e){return Sae(e)||(Vn(e)?e:null)}const Mae=e=>e.data;function Tae(e,t){const n=Zoe.call(t,e);return n.root&&n.root.lookup||{}}const Eae=()=>"undefined"!=typeof window&&window||null;function Aae(e,t,n){if(!e)return[];const[r,i]=e,o=(new I_).set(r[0],r[1],i[0],i[1]);return function(e,t,n){const r=[],i=(new I_).union(t),o=e.marktype;return o?aC(e,i,n,r):"group"===o?sC(e,i,n,r):Vt("Intersect scene must be mark node or group item.")}(n||this.context.dataflow.scenegraph().root,o,function(e){let t=null;if(e){const n=Cn(e.marktype),r=Cn(e.markname);t=e=>(!n.length||n.some((t=>e.marktype===t)))&&(!r.length||r.some((t=>e.name===t)))}return t}(t))}const Fae={random:()=>ol(),cumulativeNormal:dl,cumulativeLogNormal:bl,cumulativeUniform:wl,densityNormal:pl,densityLogNormal:yl,densityUniform:_l,quantileNormal:hl,quantileLogNormal:vl,quantileUniform:kl,sampleNormal:cl,sampleLogNormal:ml,sampleUniform:xl,isArray:sn,isBoolean:function(e){return"boolean"==typeof e},isDate:Un,isDefined:e=>void 0!==e,isNumber:Wn,isObject:un,isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},isString:Vn,isTuple:lu,isValid:e=>null!=e&&e==e,toBoolean:Kn,toDate:e=>Zn(e),toNumber:hn,toString:Qn,indexof:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Cae(e).indexOf(...n)},join:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Sae(e).join(...n)},lastindexof:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Cae(e).lastIndexOf(...n)},replace:function(e,t,n){return Mn(n)&&Vt("Function argument passed to replace."),String(e).replace(t,n)},reverse:function(e){return Sae(e).slice().reverse()},slice:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Cae(e).slice(...n)},flush:function(e,t,n,r,i,o){if(!n&&0!==n)return o;const a=+n;let s,u=e[0],l=dn(e);l<u&&(s=u,u=l,l=s),s=Math.abs(t-u);const c=Math.abs(l-t);return s<c&&s<=a?r:c<=a?i:o},lerp:function(e,t){const n=e[0],r=dn(e),i=+t;return i?1===i?r:n+i*(r-n):n},merge:function(){const e=[].slice.call(arguments);return e.unshift({}),In(...e)},pad:function(e,t,n,r){const i=n||" ",o=e+"",a=t-o.length;return a<=0?o:"left"===r?qn(i,a)+o:"center"===r?qn(i,~~(a/2))+o+qn(i,Math.ceil(a/2)):o+qn(i,a)},peek:dn,pluck:function(e,t){const n=kae[t]||(kae[t]=qt(t));return sn(e)?e.map(n):n(e)},span:Xn,inrange:Gn,truncate:function(e,t,n,r){const i=null!=r?r:"",o=e+"",a=o.length,s=Math.max(0,t-i.length);return a<=t?o:"left"===n?i+o.slice(a-s):"center"===n?o.slice(0,Math.ceil(s/2))+i+o.slice(a-~~(s/2)):o.slice(0,s)+i},rgb:Kie,lab:voe,hcl:Coe,hsl:ooe,luminance:vae,contrast:function(e,t){const n=vae(e),r=vae(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(i);++r<i;)o[r]=e+r*n;return o},format:eae,utcFormat:nae,utcParse:iae,utcOffset:function(e,t,n){return fo(ho(e),t,n)},utcSequence:function(e,t,n,r){return go(ho(e),t,n,r)},timeFormat:tae,timeParse:rae,timeOffset:function(e,t,n){return fo(po(e),t,n)},timeSequence:function(e,t,n,r){return go(po(e),t,n,r)},timeUnitSpecifier:function(e,t){const n=In({},Wi,t),r=Ui(e),i=r.length;let o,a,s="",u=0;for(u=0;u<i;)for(o=r.length;o>u;--o)if(a=r.slice(u,o).join("-"),null!=n[a]){s+=n[a],u=o;break}return s.trim()},monthFormat:function(e){return aae.call(this,e,1,"%B")},monthAbbrevFormat:function(e){return aae.call(this,e,1,"%b")},dayFormat:function(e){return aae.call(this,0,2+e,"%A")},dayAbbrevFormat:function(e){return aae.call(this,0,2+e,"%a")},quarter:function(e){return 1+~~(new Date(e).getMonth()/3)},utcquarter:function(e){return 1+~~(new Date(e).getUTCMonth()/3)},week:function(e){return Xi(new Date(e))},utcweek:function(e){return Zi(new Date(e))},dayofyear:function(e){return qi(new Date(e))},utcdayofyear:function(e){return Ji(new Date(e))},warn:function(){return yae(this.context.dataflow,"warn",arguments)},info:function(){return yae(this.context.dataflow,"info",arguments)},debug:function(){return yae(this.context.dataflow,"debug",arguments)},extent:e=>Bn(e),inScope:function(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n},intersect:Aae,clampRange:function(e,t,n){let r,i=e[0],o=e[1];return o<i&&(r=o,o=i,i=r),r=o-i,r>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-r),i+r]},pinchDistance:function(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.hypot(n,r)},pinchAngle:function(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)},screen:function(){const e=Eae();return e?e.screen:{}},containerSize:function(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function(){const e=Eae();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]},bandspace:function(e,t,n){return Mv(e||0,t||0,n||0)},setdata:function(e,t){const n=this.context.dataflow,r=this.context.data[e].input;return n.pulse(r,n.changeset().remove(Zt).insert(t)),1},pathShape:function(e){let t=null;return function(n){return n?u_(n,t=t||Jx(e)):e}},panLinear:function(e,t){return vn(e,t,hn,Yt)},panLog:function(e,t){var n=Math.sign(e[0]);return vn(e,t,gn(n),fn(n))},panPow:function(e,t,n){return vn(e,t,bn(n),bn(1/n))},panSymlog:function(e,t,n){return vn(e,t,mn(n),yn(n))},zoomLinear:_n,zoomLog:wn,zoomPow:kn,zoomSymlog:Sn,encode:function(e,t,n){if(e){const n=this.context.dataflow,r=e.mark.source;n.pulse(r,n.changeset().encode(e,t))}return void 0!==n?n:e},modify:function(e,t,n,r,i,o){const a=this.context.dataflow,s=this.context.data[e],u=s.input,l=a.stamp();let c,p,d=s.changes;if(!1===a._trigger||!(u.value.length||t||r))return 0;if((!d||d.stamp<l)&&(s.changes=d=a.changeset(),d.stamp=l,a.runAfter((()=>{s.modified=!0,a.pulse(u,d).run()}),!0,1)),n&&(c=!0===n?Zt:sn(n)||lu(n)?n:wae(n),d.remove(c)),t&&d.insert(t),r&&(c=wae(r),u.value.some(c)?d.remove(c):d.insert(r)),i)for(p in o)d.modify(i,p,o[p]);return 1},lassoAppend:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const i=(e=Cn(e))[e.length-1];return void 0===i||Math.hypot(i[0]-t,i[1]-n)>r?[...e,[t,n]]:e},lassoPath:function(e){return Cn(e).reduce(((t,n,r)=>{let[i,o]=n;return t+(0==r?`M ${i},${o} `:r===e.length-1?" Z":`L ${i},${o} `)}),"")},intersectLasso:function(e,t,n){const{x:r,y:i,mark:o}=n,a=(new I_).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[e,n]of t)e<a.x1&&(a.x1=e),e>a.x2&&(a.x2=e),n<a.y1&&(a.y1=n),n>a.y2&&(a.y2=n);return a.translate(r,i),Aae([[a.x1,a.y1],[a.x2,a.y2]],e,o).filter((e=>function(e,t,n){let r=0;for(let i=0,o=n.length-1;i<n.length;o=i++){const[a,s]=n[o],[u,l]=n[i];l>t!=s>t&&e<(a-u)*(t-l)/(s-l)+u&&r++}return 1&r}(e.x,e.y,t)))}},Oae=["view","item","group","xy","x","y"],Rae="this.",Nae={},Dae={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${Yn(uae+e)}]`,functions:function(e){const t=Jne(e);Oae.forEach((e=>t[e]="event.vega."+e));for(const e in Fae)t[e]=Rae+e;return In(t,function(e,t,n){t.__bandwidth=e=>e&&e.bandwidth?e.bandwidth():0,n._bandwidth=cae,n._range=cae,n._scale=cae;const r=t=>"_["+(t.type===wte?Yn(sae+t.value):Yn(sae)+"+"+e(t))+"]";return{_bandwidth:e=>`this.__bandwidth(${r(e[0])})`,_range:e=>`${r(e[0])}.range()`,_scale:t=>`${r(t[0])}(${e(t[1])})`}}(e,Fae,Nae)),t},constants:Kne,visitors:Nae},Iae=function(e){const t=(e=e||{}).allowed?er(e.allowed):{},n=e.forbidden?er(e.forbidden):{},r=e.constants||Kne,i=(e.functions||Jne)(p),o=e.globalvar,a=e.fieldvar,s=Mn(o)?o:e=>`${o}["${e}"]`;let u={},l={},c=0;function p(e){if(Vn(e))return e;const t=d[e.type];return null==t&&Vt("Unsupported type: "+e.type),t(e)}const d={Literal:e=>e.raw,Identifier:e=>{const i=e.name;return c>0?i:Pn(n,i)?Vt("Illegal identifier: "+i):Pn(r,i)?r[i]:Pn(t,i)?i:(u[i]=1,s(i))},MemberExpression:e=>{const t=!e.computed,n=p(e.object);t&&(c+=1);const r=p(e.property);return n===a&&(l[function(e){const t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(r)]=1),t&&(c-=1),n+(t?"."+r:"["+r+"]")},CallExpression:e=>{"Identifier"!==e.callee.type&&Vt("Illegal callee type: "+e.callee.type);const t=e.callee.name,n=e.arguments,r=Pn(i,t)&&i[t];return r||Vt("Unrecognized function: "+t),Mn(r)?r(n):r+"("+n.map(p).join(",")+")"},ArrayExpression:e=>"["+e.elements.map(p).join(",")+"]",BinaryExpression:e=>"("+p(e.left)+" "+e.operator+" "+p(e.right)+")",UnaryExpression:e=>"("+e.operator+p(e.argument)+")",ConditionalExpression:e=>"("+p(e.test)+"?"+p(e.consequent)+":"+p(e.alternate)+")",LogicalExpression:e=>"("+p(e.left)+e.operator+p(e.right)+")",ObjectExpression:e=>"{"+e.properties.map(p).join(",")+"}",Property:e=>{c+=1;const t=p(e.key);return c-=1,t+":"+p(e.value)}};function h(e){const t={code:p(e),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},t}return h.functions=i,h.constants=r,h}(Dae);function Bae(e,t,n){return 1===arguments.length?Fae[e]:(Fae[e]=t,n&&(Nae[e]=n),Iae&&(Iae.functions[e]=Rae+e),this)}function Lae(e,t){const n={};let r;try{r=function(e){Tte=0,Ete=(Mte=e).length,Ate=null,Mne();const t=Yne();if(Ate.type!==Ote)throw new Error("Unexpect token after expression.");return t}(e=Vn(e)?e:Yn(e)+"")}catch(t){Vt("Expression parse error: "+e)}r.visit((e=>{if(e.type!==kte)return;const r=e.callee.name,i=Dae.visitors[r];i&&i(r,e.arguments,t,n)}));const i=Iae(r);return i.globals.forEach((e=>{const r=uae+e;!Pn(n,r)&&t.getSignal(e)&&(n[r]=t.signalRef(e))})),{$expr:In({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}Bae("bandwidth",(function(e,t){const n=dae(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}),cae),Bae("copy",(function(e,t){const n=dae(e,(t||this).context);return n?n.copy():void 0}),cae),Bae("domain",(function(e,t){const n=dae(e,(t||this).context);return n?n.domain():[]}),cae),Bae("range",(function(e,t){const n=dae(e,(t||this).context);return n&&n.range?n.range():[]}),cae),Bae("invert",(function(e,t,n){const r=dae(e,(n||this).context);return r?sn(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}),cae),Bae("scale",(function(e,t,n){const r=dae(e,(n||this).context);return r?r(t):void 0}),cae),Bae("gradient",(function(e,t,n,r,i){e=dae(e,(i||this).context);const o=function(e,t){var n,r=[];return n={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:r,stop:function(e,t){return r.push({offset:e,color:t}),n}}}(t,n);let a=e.domain(),s=a[0],u=dn(a),l=Yt;return u-s?l=dx(e,s,u):e=(e.interpolator?tx("sequential")().interpolator(e.interpolator()):tx("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,u=1]),e.ticks&&(a=e.ticks(+r||15),s!==a[0]&&a.unshift(s),u!==dn(a)&&a.push(u)),a.forEach((t=>o.stop(l(t),e(t)))),o}),cae),Bae("geoArea",fae,cae),Bae("geoBounds",gae,cae),Bae("geoCentroid",mae,cae),Bae("geoShape",(function(e,t,n){const r=dae(e,(n||this).context);return function(e){return r?r.path.context(e)(t):""}}),cae),Bae("indata",(function(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(e,t,n,r){t[0].type!==wte&&Vt("First argument to indata must be a string literal."),t[1].type!==wte&&Vt("Second argument to indata must be a string literal.");const i=t[0].value,o=t[1].value,a="@"+o;Pn(a,r)||(r[a]=n.getData(i).indataRef(n,o))})),Bae("data",Zoe,lae),Bae("treePath",(function(e,t,n){const r=Tae(e,this),i=r[t],o=r[n];return i&&o?i.path(o).map(Mae):void 0}),lae),Bae("treeAncestors",(function(e,t){const n=Tae(e,this)[t];return n?n.ancestors().map(Mae):void 0}),lae),Bae("vlSelectionTest",Uoe,Joe),Bae("vlSelectionIdTest",qoe,Joe),Bae("vlSelectionResolve",Yoe,Joe),Bae("vlSelectionTuples",Xoe);const Pae=er(["rule"]),$ae=er(["group","image","rect"]);function zae(e){return(e+"").toLowerCase()}function jae(e,t,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}var Gae={operator:(e,t)=>jae(e,["_"],t.code),parameter:(e,t)=>jae(e,["datum","_"],t.code),event:(e,t)=>jae(e,["event"],t.code),handler:(e,t)=>jae(e,["_","event"],`var datum=event.item&&event.item.datum;return ${t.code};`),encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const e in r){const t="o["+Yn(e)+"]";i+=`$=${r[e].code};if(${t}!==$)${t}=$,m=1;`}return i+=function(e,t){let n="";return Pae[t]||(e.x2&&(e.x?($ae[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?($ae[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),i+="return m;",jae(e,["item","_"],i)},codegen:{get(e){const t=`[${e.map(Yn).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const r=Function("a","b","var u, v; return "+e.map(((e,r)=>{const i=t[r];let o,a;return e.path?(o=`a${e.path}`,a=`b${e.path}`):((n=n||{})["f"+r]=e,o=`this.f${r}(a)`,a=`this.f${r}(b)`),function(e,t,n,r){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}\n  : (u > v || v == null) && u != null ? ${r}\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}\n  : v !== v && u === u ? ${r} : `}(o,a,-i,i)})).join("")+"0;");return n?r.bind(n):r}}};function Uae(e,t,n){if(!e||!un(e))return e;for(let r,i=0,o=Wae.length;i<o;++i)if(r=Wae[i],Pn(e,r.key))return r.parse(e,t,n);return e}var Wae=[{key:"$ref",parse:function(e,t){return t.get(e.$ref)||Vt("Operator not defined: "+e.$ref)}},{key:"$key",parse:function(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=Hn(e.$key,e.$flat,t.expr.codegen))}},{key:"$expr",parse:function(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=$t(t.parameterExpression(e.$expr),e.$fields))}},{key:"$field",parse:function(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=qt(e.$field,e.$name,t.expr.codegen))}},{key:"$encode",parse:function(e,t){const n=e.$encode,r={};for(const e in n){const i=n[e];r[e]=$t(t.encodeExpression(i.$expr),i.$fields),r[e].output=i.$output}return r}},{key:"$compare",parse:function(e,t){const n="c:"+e.$compare+"_"+e.$order,r=Cn(e.$compare).map((e=>e&&e.$tupleid?cu:e));return t.fn[n]||(t.fn[n]=En(r,e.$order,t.expr.codegen))}},{key:"$context",parse:function(e,t){return t}},{key:"$subflow",parse:function(e,t){const n=e.$subflow;return function(e,r,i){const o=t.fork().parse(n),a=o.get(n.operators[0].id),s=o.signals.parent;return s&&s.set(i),a.detachSubflow=()=>t.detach(o),a}}},{key:"$tupleid",parse:function(){return cu}}];const Vae={skip:!0};function Hae(e,t,n,r){return new qae(e,t,n,r)}function qae(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||Gae,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function Xae(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}function Yae(e,t){e&&(null==t?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}qae.prototype=Xae.prototype={fork(){const e=new Xae(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter((t=>t!==e));const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),"collect"===zae(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let i=n.get(e.parent.$ref);i?(r.connect(i,[t]),t.targets().add(i)):(n.unresolved=n.unresolved||[]).push((()=>{i=n.get(e.parent.$ref),r.connect(i,[t]),t.targets().add(i)}))}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const r in e.data){const i=n.data[r]||(n.data[r]={});e.data[r].forEach((e=>i[e]=t))}},resolve(){return(this.unresolved||[]).forEach((e=>e())),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[zae(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:function(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach((e=>t.parseOperator(e))),n.forEach((e=>t.parseOperatorParameters(e))),(e.streams||[]).forEach((e=>t.parseStream(e))),(e.updates||[]).forEach((e=>t.parseUpdate(e))),t.resolve()},parseOperator:function(e){const t=this;"operator"!==zae(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?t.operatorExpression(e.update):null)},parseOperatorParameters:function(e){const t=this;if(e.params){const n=t.get(e.id);n||Vt("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}},parseParameters:function(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=sn(i)?i.map((e=>Uae(e,n,t))):Uae(i,n,t)}return t},parseStream:function(e){var t,n=this,r=null!=e.filter?n.eventExpression(e.filter):void 0,i=null!=e.stream?n.get(e.stream):void 0;e.source?i=n.events(e.source,e.type,r):e.merge&&(i=(t=e.merge.map((e=>n.get(e))))[0].merge.apply(t[0],t.slice(1))),e.between&&(t=e.between.map((e=>n.get(e))),i=i.between(t[0],t[1])),e.filter&&(i=i.filter(r)),null!=e.throttle&&(i=i.throttle(+e.throttle)),null!=e.debounce&&(i=i.debounce(+e.debounce)),null==i&&Vt("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),n.stream(e,i)},parseUpdate:function(e){var t,n=this,r=un(r=e.source)?r.$ref:r,i=n.get(r),o=e.update,a=void 0;i||Vt("Source not defined: "+e.source),t=e.target&&e.target.$expr?n.eventExpression(e.target.$expr):n.get(e.target),o&&o.$expr&&(o.$params&&(a=n.parseParameters(o.$params)),o=n.handlerExpression(o.$expr)),n.update(e,i,t,o,a)},getState:function(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach((n=>{const i=t.signals[n];e.signals(n,i)&&(r[n]=i.value)}))}if(e.data){var i=n.data={};Object.keys(t.data).forEach((n=>{const r=t.data[n];e.data(n,r)&&(i[n]=r.input.value)}))}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map((t=>t.getState(e)))),n},setState:function(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach((e=>{n.update(t.signals[e],i[e],Vae)})),Object.keys(r||{}).forEach((e=>{n.pulse(t.data[e].input,n.changeset().remove(Zt).insert(r[e]))})),(e.subcontext||[]).forEach(((e,n)=>{const r=t.subcontext[n];r&&r.setState(e)}))}};const Kae="default";function Jae(e,t){const n=e.globalCursor()?"undefined"!=typeof document&&document.body:e.container();if(n)return null==t?n.style.removeProperty("cursor"):n.style.cursor=t}function Zae(e,t){var n=e._runtime.data;return Pn(n,t)||Vt("Unrecognized data set: "+t),n[t]}function Qae(e,t){yu(t)||Vt("Second argument to changes must be a changeset.");const n=Zae(this,e);return n.modified=!0,this.pulse(n.input,t)}function ese(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function tse(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function nse(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}const rse="view",ise={trap:!1};function ose(e,t,n,r){e._eventListeners.push({type:n,sources:Cn(t),handler:r})}function ase(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return!(!1===r||un(r)&&!r[n])||(e.warn(`Blocked ${t} ${n} event listener.`),!1)}function sse(e){return e.item}function use(e){return e.item.mark.source}function lse(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function cse(e,t,n){const r=document.createElement(e);for(const e in t)r.setAttribute(e,t[e]);return null!=n&&(r.textContent=n),r}const pse="vega-bind-radio";function dse(e,t,n,r){const i=n.event||"input",o=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,o),ose(r,t,i,o),e.set=e=>{t.value=e,t.dispatchEvent(function(e){return"undefined"!=typeof Event?new Event(e):{type:e}}(i))}}function hse(e,t,n,r){const i=r.signal(n.signal),o=cse("div",{class:"vega-bind"}),a="radio"===n.input?o:o.appendChild(cse("label"));a.appendChild(cse("span",{class:"vega-bind-name"},n.name||n.signal)),t.appendChild(o);let s=fse;switch(n.input){case"checkbox":s=gse;break;case"select":s=mse;break;case"radio":s=yse;break;case"range":s=bse}s(e,a,n,i)}function fse(e,t,n,r){const i=cse("input");for(const e in n)"signal"!==e&&"element"!==e&&i.setAttribute("input"===e?"type":e,n[e]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",(()=>e.update(i.value))),e.elements=[i],e.set=e=>i.value=e}function gse(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=cse("input",i);t.appendChild(o),o.addEventListener("change",(()=>e.update(o.checked))),e.elements=[o],e.set=e=>o.checked=!!e||null}function mse(e,t,n,r){const i=cse("select",{name:n.signal}),o=n.labels||[];n.options.forEach(((e,t)=>{const n={value:e};vse(e,r)&&(n.selected=!0),i.appendChild(cse("option",n,(o[t]||e)+""))})),t.appendChild(i),i.addEventListener("change",(()=>{e.update(n.options[i.selectedIndex])})),e.elements=[i],e.set=e=>{for(let t=0,r=n.options.length;t<r;++t)if(vse(n.options[t],e))return void(i.selectedIndex=t)}}function yse(e,t,n,r){const i=cse("span",{class:pse}),o=n.labels||[];t.appendChild(i),e.elements=n.options.map(((t,a)=>{const s={type:"radio",name:n.signal,value:t};vse(t,r)&&(s.checked=!0);const u=cse("input",s);u.addEventListener("change",(()=>e.update(t)));const l=cse("label",{},(o[a]||t)+"");return l.prepend(u),i.appendChild(l),u})),e.set=t=>{const n=e.elements,r=n.length;for(let e=0;e<r;++e)vse(n[e].value,t)&&(n[e].checked=!0)}}function bse(e,t,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,a=n.step||eE(o,i,100),s=cse("input",{type:"range",name:n.signal,min:o,max:i,step:a});s.value=r;const u=cse("span",{},+r);t.appendChild(s),t.appendChild(u);const l=()=>{u.textContent=s.value,e.update(+s.value)};s.addEventListener("input",l),s.addEventListener("change",l),e.elements=[s],e.set=e=>{s.value=e,u.textContent=e}}function vse(e,t){return e===t||e+""==t+""}function xse(e,t,n,r,i,o){return(t=t||new r(e.loader())).initialize(n,ese(e),tse(e),nse(e),i,o).background(e.background())}function _se(e,t){return t?function(){try{t.apply(this,arguments)}catch(t){e.error(t)}}:null}function wse(e,t,n){if("string"==typeof t){if("undefined"==typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null}if(t&&n)try{t.innerHTML=""}catch(n){t=null,e.error(n)}return t}const kse=e=>+e||0;function Sse(e){return un(e)?{top:kse(e.top),bottom:kse(e.bottom),left:kse(e.left),right:kse(e.right)}:(e=>({top:e,bottom:e,left:e,right:e}))(kse(e))}async function Cse(e,t,n,r){const i=oC(t),o=i&&i.headless;return o||Vt("Unrecognized renderer type: "+t),await e.runAsync(),xse(e,null,null,o,n,r).renderAsync(e._scenegraph.root)}var Mse="width",Tse="height",Ese="padding",Ase={skip:!0};function Fse(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===Ese?r.left+r.right:0)}function Ose(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===Ese?r.top+r.bottom:0)}function Rse(e,t){return t.modified&&sn(t.input.value)&&e.indexOf("_:vega:_")}function Nse(e,t){return!("parent"===e||t instanceof Uu.proxy)}function Dse(e,t,n,r){const i=e.element();i&&i.setAttribute("title",function(e){return null==e?"":sn(e)?Ise(e):un(e)&&!Un(e)?(t=e,Object.keys(t).map((e=>{const n=t[e];return e+": "+(sn(n)?Ise(n):Bse(n))})).join("\n")):e+"";var t}(r))}function Ise(e){return"["+e.map(Bse).join(", ")+"]"}function Bse(e){return sn(e)?"[]":un(e)&&!Un(e)?"{}":e}function Lse(e,t){const n=this;if(t=t||{},zu.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),null!=t.logLevel&&n.logLevel(t.logLevel),t.locale||e.locale){const r=In({},e.locale,t.locale);n.locale(function(e,t){const n=e?Ts(e):Es(),r=t?Os(t):Rs();return Ns(n,r)}(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||rC.Canvas,n._scenegraph=new Bk;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Dse,n._redraw=!0,n._handler=(new uS).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(e){const t=In({defaults:{}},e),n=(e,t)=>{t.forEach((t=>{sn(e[t])&&(e[t]=er(e[t]))}))};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=function(e,t,n){return Hae(e,Uu,Fae,n).parse(t)}(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map((e=>({state:null,param:In({},e)}))),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=Fse(n,n._width),n._viewHeight=Ose(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(e){var t=e._signals,n=t[Mse],r=t[Tse],i=t[Ese];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,(t=>{e._width=t.size,e._viewWidth=Fse(e,t.size),o()}),{size:n}),e._resizeHeight=e.add(null,(t=>{e._height=t.size,e._viewHeight=Ose(e,t.size),o()}),{size:r});const a=e.add(null,o,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,a.rank=i.rank+1}(n),function(e){e.add(null,(t=>(e._background=t.bg,e._resize=1,t.bg)),{bg:e._signals.background})}(n),function(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:Kae,item:null}));e.on(e.events("view","mousemove"),t,((e,n)=>{const r=t.value,i=r?Vn(r)?r:r.user:Kae,o=n.item&&n.item.cursor||null;return r&&i===r.user&&o==r.item?r:{user:i,item:o}})),e.add(null,(function(t){let n=t.cursor,r=this.value;return Vn(n)||(r=n.item,n=n.user),Jae(e,n&&n!==Kae?n:r||n),r}),{cursor:t})}(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function Pse(e,t){return Pn(e._signals,t)?e._signals[t]:Vt("Unrecognized signal name: "+Yn(t))}function $se(e,t){const n=(e._targets||[]).filter((e=>e._update&&e._update.handler===t));return n.length?n[0]:null}function zse(e,t,n,r){let i=$se(n,r);return i||(i=_se(e,(()=>r(t,n.value))),i.handler=r,e.on(n,null,i)),e}function jse(e,t,n){const r=$se(t,n);return r&&t._targets.remove(r),e}function Gse(e,t,n){return e.fields=t||[],e.fname=n,e}function Use(e){return 1===e.length?Wse(e[0]):Vse(e)}jn(Lse,zu,{async evaluate(e,t,n){if(await zu.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,i=nse(r=this),o=ese(r),a=tse(r),r._renderer.background(r.background()),r._renderer.resize(o,a,i),r._handler.origin(i),r._resizeListeners.forEach((e=>{try{e(o,a)}catch(e){r.error(e)}}))),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(e){this.error(e)}var r,i,o,a;return n&&au(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=null!=e?e+"":null;return t!==this._desc&&Yae(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=Pse(this,e);return 1===arguments.length?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",Sse(e)):Sse(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(oC(e)||Vt("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(zu.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(Pse(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(e,t,n,r,i,o){this.runAfter((a=>{let s=0;a._autosize=0,a.width()!==n&&(s=1,a.signal(Mse,n,Ase),a._resizeWidth.skip(!0)),a.height()!==r&&(s=1,a.signal(Tse,r,Ase),a._resizeHeight.skip(!0)),a._viewWidth!==e&&(a._resize=1,a._viewWidth=e),a._viewHeight!==t&&(a._resize=1,a._viewHeight=t),a._origin[0]===i[0]&&a._origin[1]===i[1]||(a._resize=1,a._origin=i),s&&a.run("enter"),o&&a.runAfter((e=>e.resize()))}),!1,1)},addEventListener(e,t,n){let r=t;return n&&!1===n.trap||(r=_se(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n,r,i=this._handler.handlers(e),o=i.length;--o>=0;)if(r=i[o].type,n=i[o].handler,e===r&&(t===n||t===n.raw)){this._handler.off(r,n);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return zse(this,e,Pse(this,e),t)},removeSignalListener(e,t){return jse(this,Pse(this,e),t)},addDataListener(e,t){return zse(this,e,Zae(this,e).values,t)},removeDataListener(e,t){return jse(this,Zae(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=Jae(this,null);this._globalCursor=!!e,t&&Jae(this,t)}return this}return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:function(e,t){this._timers.push(function(e,t,n){var r=new tD,i=t;return null==t?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(e,t,n){t=+t,n=null==n?QN():+n,r._restart((function o(a){a+=i,r._restart(o,i+=t,n),e(a)}),t,n)},r.restart(e,t,n),r)}((function(t){e({timestamp:Date.now(),elapsed:t})}),t))},events:function(e,t,n){var r,i=this,o=new Mu(n),a=function(n,r){i.runAsync(null,(()=>{e===rse&&function(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[t]:i?!i[t]:e.preventDefault()))}(i,t)&&n.preventDefault(),o.receive(function(e,t,n){var r,i,o=e._renderer,a=o&&o.canvas();return a&&(i=nse(e),(r=Uk(t.changedTouches?t.changedTouches[0]:t,a))[0]-=i[0],r[1]-=i[1]),t.dataflow=e,t.item=n,t.vega=function(e,t,n){const r=t?"group"===t.mark.marktype?t:t.mark.group:null;function i(e){var n,i=r;if(e)for(n=t;n;n=n.mark.group)if(n.mark.name===e){i=n;break}return i&&i.mark&&i.mark.interactive?i:{}}function o(e){if(!e)return n;Vn(e)&&(e=i(e));const t=n.slice();for(;e;)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t}return{view:Nn(e),item:Nn(t||{}),group:i,xy:o,x:e=>o(e)[0],y:e=>o(e)[1]}}(e,n,r),t}(i,n,r))}))};if("timer"===e)ase(i,"timer",t)&&i.timer(a,t);else if(e===rse)ase(i,"view",t)&&i.addEventListener(t,a,ise);else if("window"===e?ase(i,"window",t)&&"undefined"!=typeof window&&(r=[window]):"undefined"!=typeof document&&ase(i,"selector",t)&&(r=document.querySelectorAll(e)),r){for(var s=0,u=r.length;s<u;++s)r[s].addEventListener(t,a);ose(i,r,t,a)}else i.warn("Can not resolve event source: "+e);return o},finalize:function(){var e,t,n,r=this._tooltip,i=this._timers,o=this._eventListeners;for(e=i.length;--e>=0;)i[e].stop();for(e=o.length;--e>=0;)for(t=(n=o[e]).sources.length;--t>=0;)n.sources[t].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","mouseover",sse),use,lse(e)),this.on(this.events("view","mouseout",sse),use,lse(t)),this},data:function(e,t){return arguments.length<2?Zae(this,e).values.value:Qae.call(this,e,bu().remove(Zt).insert(t))},change:Qae,insert:function(e,t){return Qae.call(this,e,bu().insert(t))},remove:function(e,t){return Qae.call(this,e,bu().remove(t))},scale:function(e){var t=this._runtime.scales;return Pn(t,e)||Vt("Unrecognized scale or projection: "+e),t[e].value},initialize:function(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,o=oC(r);e=n._el=e?wse(n,e,!0):null,function(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),Yae(t,e.description()))}(n),o||n.error("Unrecognized renderer type: "+r);const a=o.handler||uS,s=e?o.renderer:o.headless;return n._renderer=s?xse(n,n._renderer,e,s):null,n._handler=function(e,t,n,r){const i=new r(e.loader(),_se(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,nse(e),e);return t&&t.handlers().forEach((e=>{i.on(e.type,e.handler)})),i}(n,n._handler,e,a),n._redraw=!0,e&&"none"!==i&&(t=t?n._elBind=wse(n,t,!0):e.appendChild(cse("form",{class:"vega-bindings"})),n._bind.forEach((e=>{e.param.element&&"container"!==i&&(e.element=wse(n,e.param.element,!!e.param.input))})),n._bind.forEach((e=>{!function(e,t,n){if(!t)return;const r=n.param;let i=n.state;i||(i=n.state={elements:null,active:!1,set:null,update:t=>{t!=e.signal(r.signal)&&e.runAsync(null,(()=>{i.source=!0,e.signal(r.signal,t)}))}},r.debounce&&(i.update=Dn(r.debounce,i.update))),(null==r.input&&r.element?dse:hse)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,(()=>{i.source?i.source=!1:i.set(e.signal(r.signal))})),i.active=!0)}(n,e.element||t,e)}))),n},toImageURL:async function(e,t){e!==rC.Canvas&&e!==rC.SVG&&e!==rC.PNG&&Vt("Unrecognized image type: "+e);const n=await Cse(this,e,t);return e===rC.SVG?function(e,t){const n=new Blob([e],{type:"image/svg+xml"});return window.URL.createObjectURL(n)}(n.svg()):n.canvas().toDataURL("image/png")},toCanvas:async function(e,t){return(await Cse(this,rC.Canvas,e,t)).canvas()},toSVG:async function(e){return(await Cse(this,rC.SVG,e)).svg()},getState:function(e){return this._runtime.getState(e||{data:Rse,signals:Nse,recurse:!0})},setState:function(e){return this.runAsync(null,(t=>{t._trigger=!1,t._runtime.setState(e)}),(e=>{e._trigger=!0})),this}});const Wse=e=>function(t){return t[e]},Vse=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function Hse(e){throw Error(e)}function qse(e){return"string"==typeof e}(function(e,t,n){const r=function(e){const t=[],n=e.length;let r,i,o,a=null,s=0,u="";function l(){t.push(u+e.substring(r,i)),u="",r=i+1}for(e+="",r=i=0;i<n;++i)if(o=e[i],"\\"===o)u+=e.substring(r,i++),r=i;else if(o===a)l(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&l(),s=r=i+1):"]"===o&&(s||Hse("Access path missing open bracket: "+e),s>0&&l(),s=0,r=i+1):i>r?l():r=i+1}return s&&Hse("Access path missing closing bracket: "+e),a&&Hse("Access path missing closing quote: "+e),i>r&&(i++,l()),t}(e);e=1===r.length?r[0]:e,Gse((n&&n.get||Use)(r),[e],t||e)})("id"),Gse((e=>e),[],"identity"),Gse((()=>0),[],"zero"),Gse((()=>1),[],"one"),Gse((()=>!0),[],"true"),Gse((()=>!1),[],"false"),Array.isArray,Object.prototype.hasOwnProperty;const Xse=new Date,Yse=new Date;function Kse(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{const t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,r,o)=>{const a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return a;let s;do{a.push(s=new Date(+n)),t(n,o),e(n)}while(s<n&&n<r);return a},i.filter=n=>Kse((t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),((e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})),n&&(i.count=(t,r)=>(Xse.setTime(+t),Yse.setTime(+r),e(Xse),e(Yse),Math.floor(n(Xse,Yse))),i.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?t=>r(t)%e==0:t=>i.count(0,t)%e==0):i:null)),i}const Jse=1e3,Zse=6e4,Qse=36e5,eue=864e5,tue=6048e5,nue=Kse((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Zse)/eue),(e=>e.getDate()-1)),rue=(nue.range,Kse((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/eue),(e=>e.getUTCDate()-1))),iue=(rue.range,Kse((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/eue),(e=>Math.floor(e/eue))));function oue(e){return Kse((t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),((e,t)=>{e.setDate(e.getDate()+7*t)}),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Zse)/tue))}iue.range;const aue=oue(0),sue=oue(1),uue=oue(2),lue=oue(3),cue=oue(4),pue=oue(5),due=oue(6);function hue(e){return Kse((t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)}),((e,t)=>(t-e)/tue))}aue.range,sue.range,uue.range,lue.range,cue.range,pue.range,due.range;const fue=hue(0),gue=hue(1),mue=hue(2),yue=hue(3),bue=hue(4),vue=hue(5),xue=hue(6),_ue=(fue.range,gue.range,mue.range,yue.range,bue.range,vue.range,xue.range,Kse((e=>{e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,t)=>{e.setFullYear(e.getFullYear()+t)}),((e,t)=>t.getFullYear()-e.getFullYear()),(e=>e.getFullYear())));_ue.every=e=>isFinite(e=Math.floor(e))&&e>0?Kse((t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,n)=>{t.setFullYear(t.getFullYear()+n*e)})):null,_ue.range;const wue=Kse((e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)}),((e,t)=>t.getUTCFullYear()-e.getUTCFullYear()),(e=>e.getUTCFullYear()));wue.every=e=>isFinite(e=Math.floor(e))&&e>0?Kse((t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null,wue.range;const kue=Kse((e=>{e.setDate(1),e.setHours(0,0,0,0)}),((e,t)=>{e.setMonth(e.getMonth()+t)}),((e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())),(e=>e.getMonth())),Sue=(kue.range,Kse((e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)}),((e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())),(e=>e.getUTCMonth()))),Cue=(Sue.range,Kse((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Jse-e.getMinutes()*Zse)}),((e,t)=>{e.setTime(+e+t*Qse)}),((e,t)=>(t-e)/Qse),(e=>e.getHours()))),Mue=(Cue.range,Kse((e=>{e.setUTCMinutes(0,0,0)}),((e,t)=>{e.setTime(+e+t*Qse)}),((e,t)=>(t-e)/Qse),(e=>e.getUTCHours()))),Tue=(Mue.range,Kse((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Jse)}),((e,t)=>{e.setTime(+e+t*Zse)}),((e,t)=>(t-e)/Zse),(e=>e.getMinutes()))),Eue=(Tue.range,Kse((e=>{e.setUTCSeconds(0,0)}),((e,t)=>{e.setTime(+e+t*Zse)}),((e,t)=>(t-e)/Zse),(e=>e.getUTCMinutes()))),Aue=(Eue.range,Kse((e=>{e.setTime(e-e.getMilliseconds())}),((e,t)=>{e.setTime(+e+t*Jse)}),((e,t)=>(t-e)/Jse),(e=>e.getUTCSeconds()))),Fue=(Aue.range,Kse((()=>{}),((e,t)=>{e.setTime(+e+t)}),((e,t)=>t-e)));Fue.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?Kse((t=>{t.setTime(Math.floor(t/e)*e)}),((t,n)=>{t.setTime(+t+n*e)}),((t,n)=>(n-t)/e)):Fue:null),Fue.range;const Oue="year",Rue="quarter",Nue="month",Due="week",Iue="date",Bue="day",Lue="dayofyear",Pue="hours",$ue="minutes",zue="seconds",jue="milliseconds";[Oue,Rue,Nue,Due,Iue,Bue,Lue,Pue,$ue,zue,jue].reduce(((e,t,n)=>(e[t]=1+n,e)),{}),new Date;const Gue={[Oue]:_ue,[Rue]:kue.every(3),[Nue]:kue,[Due]:aue,[Iue]:nue,[Bue]:nue,[Lue]:nue,[Pue]:Cue,[$ue]:Tue,[zue]:Aue,[jue]:Fue},Uue={[Oue]:wue,[Rue]:Sue.every(3),[Nue]:Sue,[Due]:fue,[Iue]:rue,[Bue]:rue,[Lue]:rue,[Pue]:Mue,[$ue]:Eue,[zue]:Aue,[jue]:Fue};function Wue(e){return Gue[e]}function Vue(e){return Uue[e]}function Hue(e){const t={};return n=>t[n]||(t[n]=e(n))}function que(e){const t=Hue(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(e){const n=Y3(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let o=function(e,t){let n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if(n=e.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const a=o<r.length?r.slice(o):"";for(;--o>i;)if("0"!==r[o]){++o;break}return r.slice(0,o)+a}}(t(n),t(".1f")(1)[1])}return t(n)},formatSpan(e,r,i,o){o=Y3(null==o?",f":o);const a=eE(e,r,i),s=Math.max(Math.abs(e),Math.abs(r));let u;if(null==o.precision)switch(o.type){case"s":return isNaN(u=Q3(a,s))||(o.precision=u),n(o,s);case"":case"e":case"g":case"p":case"r":isNaN(u=l4(a,s))||(o.precision=u-("e"===o.type));break;case"f":case"%":isNaN(u=c4(a))||(o.precision=u-2*("%"===o.type))}return t(o)}}}let Xue,Yue;function Kue(){return Xue=que({format:i4,formatPrefix:o4})}function Jue(e){return que(u4(e))}function Zue(e){return arguments.length?Xue=Jue(e):Xue}function Que(e,t,n){var r;(r=n=n||{})===Object(r)||Hse("Invalid time multi-format specifier: ".concat(n));const i=t(zue),o=t($ue),a=t(Pue),s=t(Iue),u=t(Due),l=t(Nue),c=t(Rue),p=t(Oue),d=e(n[jue]||".%L"),h=e(n[zue]||":%S"),f=e(n[$ue]||"%I:%M"),g=e(n[Pue]||"%I %p"),m=e(n[Iue]||n[Bue]||"%a %d"),y=e(n[Due]||"%b %d"),b=e(n[Nue]||"%B"),v=e(n[Rue]||"%B"),x=e(n[Oue]||"%Y");return e=>(i(e)<e?d:o(e)<e?h:a(e)<e?f:s(e)<e?g:l(e)<e?u(e)<e?m:y:p(e)<e?c(e)<e?b:v:x)(e)}function ele(e){const t=Hue(e.format),n=Hue(e.utcFormat);return{timeFormat:e=>qse(e)?t(e):Que(t,Wue,e),utcFormat:e=>qse(e)?n(e):Que(n,Vue,e),timeParse:Hue(e.parse),utcParse:Hue(e.utcParse)}}function tle(){return Yue=ele({format:X4,parse:Y4,utcFormat:K4,utcParse:J4})}function nle(e){return ele(H4(e))}function rle(e){return arguments.length?Yue=nle(e):Yue}[Oue,Nue,Iue,Pue,$ue,zue,jue].slice(0,-1).slice(0,-1).slice(0,-1).slice(0,-1),Kue(),tle();const ile=(e,t)=>function(e){for(let t,n,r=1,i=arguments.length;r<i;++r)for(n in t=arguments[r],t)e[n]=t[n];return e}({},e,t);function ole(e,t){const n=e?Jue(e):Zue(),r=t?nle(t):rle();return ile(n,r)}function ale(e,t){const n=arguments.length;return n&&2!==n&&Hse("defaultLocale expects either zero or two arguments."),n?ile(Zue(e),rle(t)):ile(Zue(),rle())}function sle(){return Kue(),tle(),ale()}function ule(e,t,n){return e.fields=t||[],e.fname=n,e}function lle(e){return 1===e.length?cle(e[0]):ple(e)}const cle=e=>function(t){return t[e]},ple=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function dle(e){throw Error(e)}function hle(e,t,n){const r=function(e){const t=[],n=e.length;let r,i,o,a=null,s=0,u="";function l(){t.push(u+e.substring(r,i)),u="",r=i+1}for(e+="",r=i=0;i<n;++i)if(o=e[i],"\\"===o)u+=e.substring(r,i++),r=i;else if(o===a)l(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&l(),s=r=i+1):"]"===o&&(s||dle("Access path missing open bracket: "+e),s>0&&l(),s=0,r=i+1):i>r?l():r=i+1}return s&&dle("Access path missing closing bracket: "+e),a&&dle("Access path missing closing quote: "+e),i>r&&(i++,l()),t}(e);return e=1===r.length?r[0]:e,ule((n&&n.get||lle)(r),[e],t||e)}hle("id");const fle=ule((e=>e),[],"identity"),gle=(ule((()=>0),[],"zero"),ule((()=>1),[],"one"),ule((()=>!0),[],"true"));ule((()=>!1),[],"false");var mle=Array.isArray;function yle(e){return e===Object(e)}function ble(e){return e[e.length-1]}function vle(e){return null==e||""===e?null:+e}const xle=e=>t=>e*Math.exp(t),_le=e=>t=>Math.log(e*t),wle=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),kle=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,Sle=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function Cle(e,t,n,r){const i=n(e[0]),o=n(ble(e)),a=(o-i)*t;return[r(i-a),r(o-a)]}function Mle(e,t,n,r,i){const o=r(e[0]),a=r(ble(e)),s=null!=t?r(t):(o+a)/2;return[i(s+(o-s)*n),i(s+(a-s)*n)]}function Tle(e){return null!=e?mle(e)?e:[e]:[]}function Ele(e){return"function"==typeof e}function Ale(e){for(let t,n,r=1,i=arguments.length;r<i;++r)for(n in t=arguments[r],t)e[n]=t[n];return e}const Fle=Object.prototype.hasOwnProperty;function Ole(e,t){return Fle.call(e,t)}function Rle(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Ale(r,n)}function Nle(e){return"[object Date]"===Object.prototype.toString.call(e)}function Dle(e){return"number"==typeof e}function Ile(e){return"string"==typeof e}function Ble(e,t){let n="";for(;--t>=0;)n+=e;return n}function Lle(e){return mle(e)?"["+e.map(Lle)+"]":yle(e)||Ile(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}const Ple=e=>Dle(e)||Nle(e)?e:Date.parse(e);function $le(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}const zle="Literal";var jle;(jle={})[1]="Boolean",jle[2]="<end>",jle[3]="Identifier",jle[4]="Keyword",jle[5]="Null",jle[6]="Numeric",jle[7]="Punctuator",jle[8]="String",jle[9]="RegularExpression";var Gle={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Ule(e){function t(t,n,r){return i=>function(t,n,r,i){let o=e(n[0]);return r&&(o=r+"("+o+")",0===r.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+t+(i<0?"":0===i?"()":"("+n.slice(1).map(e).join(",")+")")}(t,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&dle("Missing arguments to clamp function."),t.length>3&&dle("Too many arguments to clamp function.");const n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:t("getDate",n,0),day:t("getDay",n,0),year:t("getFullYear",n,0),month:t("getMonth",n,0),hours:t("getHours",n,0),minutes:t("getMinutes",n,0),seconds:t("getSeconds",n,0),milliseconds:t("getMilliseconds",n,0),time:t("getTime",n,0),timezoneoffset:t("getTimezoneOffset",n,0),utcdate:t("getUTCDate",n,0),utcday:t("getUTCDay",n,0),utcyear:t("getUTCFullYear",n,0),utcmonth:t("getUTCMonth",n,0),utchours:t("getUTCHours",n,0),utcminutes:t("getUTCMinutes",n,0),utcseconds:t("getUTCSeconds",n,0),utcmilliseconds:t("getUTCMilliseconds",n,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",r,0),lower:t("toLowerCase",r,0),substring:t("substring",r),split:t("split",r),trim:t("trim",r,0),regexp:i,test:t("test",i),if:function(t){t.length<3&&dle("Missing arguments to if function."),t.length>3&&dle("Too many arguments to if function.");const n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}var Wle,Vle,Hle,qle,Xle,Yle,Kle,Jle,Zle,Qle,ece,tce,nce,rce,ice,oce,ace=new V8,sce=new V8,uce={point:H8,lineStart:H8,lineEnd:H8,polygonStart:function(){ace=new V8,uce.lineStart=lce,uce.lineEnd=cce},polygonEnd:function(){var e=+ace;sce.add(e<0?AR+e:e),this.lineStart=this.lineEnd=this.point=H8},sphere:function(){sce.add(AR)}};function lce(){uce.point=pce}function cce(){dce(Wle,Vle)}function pce(e,t){uce.point=dce,Wle=e,Vle=t,Hle=e*=OR,qle=IR(t=(t*=OR)/2+ER),Xle=jR(t)}function dce(e,t){var n=(e*=OR)-Hle,r=n>=0?1:-1,i=r*n,o=IR(t=(t*=OR)/2+ER),a=jR(t),s=Xle*a,u=qle*o+s*IR(i),l=s*r*jR(i);ace.add(DR(l,u)),Hle=e,qle=o,Xle=a}var hce,fce,gce,mce,yce,bce,vce,xce,_ce,wce,kce,Sce,Cce,Mce,Tce,Ece,Ace={point:Fce,lineStart:Rce,lineEnd:Nce,polygonStart:function(){Ace.point=Dce,Ace.lineStart=Ice,Ace.lineEnd=Bce,rce=new V8,uce.polygonStart()},polygonEnd:function(){uce.polygonEnd(),Ace.point=Fce,Ace.lineStart=Rce,Ace.lineEnd=Nce,ace<0?(Yle=-(Jle=180),Kle=-(Zle=90)):rce>SR?Zle=90:rce<-SR&&(Kle=-90),oce[0]=Yle,oce[1]=Jle},sphere:function(){Yle=-(Jle=180),Kle=-(Zle=90)}};function Fce(e,t){ice.push(oce=[Yle=e,Jle=e]),t<Kle&&(Kle=t),t>Zle&&(Zle=t)}function Oce(e,t){var n=tee([e*OR,t*OR]);if(nce){var r=ree(nce,n),i=ree([r[1],-r[0],0],r);aee(i),i=eee(i);var o,a=e-Qle,s=a>0?1:-1,u=i[0]*FR*s,l=RR(a)>180;l^(s*Qle<u&&u<s*e)?(o=i[1]*FR)>Zle&&(Zle=o):l^(s*Qle<(u=(u+360)%360-180)&&u<s*e)?(o=-i[1]*FR)<Kle&&(Kle=o):(t<Kle&&(Kle=t),t>Zle&&(Zle=t)),l?e<Qle?Lce(Yle,e)>Lce(Yle,Jle)&&(Jle=e):Lce(e,Jle)>Lce(Yle,Jle)&&(Yle=e):Jle>=Yle?(e<Yle&&(Yle=e),e>Jle&&(Jle=e)):e>Qle?Lce(Yle,e)>Lce(Yle,Jle)&&(Jle=e):Lce(e,Jle)>Lce(Yle,Jle)&&(Yle=e)}else ice.push(oce=[Yle=e,Jle=e]);t<Kle&&(Kle=t),t>Zle&&(Zle=t),nce=n,Qle=e}function Rce(){Ace.point=Oce}function Nce(){oce[0]=Yle,oce[1]=Jle,Ace.point=Fce,nce=null}function Dce(e,t){if(nce){var n=e-Qle;rce.add(RR(n)>180?n+(n>0?360:-360):n)}else ece=e,tce=t;uce.point(e,t),Oce(e,t)}function Ice(){uce.lineStart()}function Bce(){Dce(ece,tce),uce.lineEnd(),RR(rce)>SR&&(Yle=-(Jle=180)),oce[0]=Yle,oce[1]=Jle,nce=null}function Lce(e,t){return(t-=e)<0?t+360:t}function Pce(e,t){return e[0]-t[0]}function $ce(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var zce={sphere:H8,point:jce,lineStart:Uce,lineEnd:Hce,polygonStart:function(){zce.lineStart=qce,zce.lineEnd=Xce},polygonEnd:function(){zce.lineStart=Uce,zce.lineEnd=Hce}};function jce(e,t){e*=OR;var n=IR(t*=OR);Gce(n*IR(e),n*jR(e),jR(t))}function Gce(e,t,n){++hce,gce+=(e-gce)/hce,mce+=(t-mce)/hce,yce+=(n-yce)/hce}function Uce(){zce.point=Wce}function Wce(e,t){e*=OR;var n=IR(t*=OR);Mce=n*IR(e),Tce=n*jR(e),Ece=jR(t),zce.point=Vce,Gce(Mce,Tce,Ece)}function Vce(e,t){e*=OR;var n=IR(t*=OR),r=n*IR(e),i=n*jR(e),o=jR(t),a=DR(UR((a=Tce*o-Ece*i)*a+(a=Ece*r-Mce*o)*a+(a=Mce*i-Tce*r)*a),Mce*r+Tce*i+Ece*o);fce+=a,bce+=a*(Mce+(Mce=r)),vce+=a*(Tce+(Tce=i)),xce+=a*(Ece+(Ece=o)),Gce(Mce,Tce,Ece)}function Hce(){zce.point=jce}function qce(){zce.point=Yce}function Xce(){Kce(Sce,Cce),zce.point=jce}function Yce(e,t){Sce=e,Cce=t,e*=OR,t*=OR,zce.point=Kce;var n=IR(t);Mce=n*IR(e),Tce=n*jR(e),Ece=jR(t),Gce(Mce,Tce,Ece)}function Kce(e,t){e*=OR;var n=IR(t*=OR),r=n*IR(e),i=n*jR(e),o=jR(t),a=Tce*o-Ece*i,s=Ece*r-Mce*o,u=Mce*i-Tce*r,l=PR(a,s,u),c=HR(l),p=l&&-c/l;_ce.add(p*a),wce.add(p*s),kce.add(p*u),fce+=c,bce+=c*(Mce+(Mce=r)),vce+=c*(Tce+(Tce=i)),xce+=c*(Ece+(Ece=o)),Gce(Mce,Tce,Ece)}function Jce(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Zce(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Qce(e){let t,n,r;function i(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<0?i=t+1:o=t}while(i<o)}return i}return 2!==e.length?(t=Jce,n=(t,n)=>Jce(e(t),n),r=(t,n)=>e(t)-n):(t=e===Jce||e===Zce?e:epe,n=e,r=e),{left:i,center:function(e,t,n=0,o=e.length){const a=i(e,t,n,o-1);return a>n&&r(e[a-1],t)>-r(e[a],t)?a-1:a},right:function(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<=0?i=t+1:o=t}while(i<o)}return i}}}function epe(){return 0}const tpe=Qce(Jce),npe=tpe.right,rpe=(tpe.left,Qce((function(e){return null===e?NaN:+e})).center,npe),ipe=Math.sqrt(50),ope=Math.sqrt(10),ape=Math.sqrt(2);function spe(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=ipe?10:o>=ope?5:o>=ape?2:1;let s,u,l;return i<0?(l=Math.pow(10,-i)/a,s=Math.round(e*l),u=Math.round(t*l),s/l<e&&++s,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*a,s=Math.round(e/l),u=Math.round(t/l),s*l<e&&++s,u*l>t&&--u),u<s&&.5<=n&&n<2?spe(e,t,2*n):[s,u,l]}function upe(e,t,n){if(!((n=+n)>0))return[];if((e=+e)==(t=+t))return[e];const r=t<e,[i,o,a]=r?spe(t,e,n):spe(e,t,n);if(!(o>=i))return[];const s=o-i+1,u=new Array(s);if(r)if(a<0)for(let e=0;e<s;++e)u[e]=(o-e)/-a;else for(let e=0;e<s;++e)u[e]=(o-e)*a;else if(a<0)for(let e=0;e<s;++e)u[e]=(i+e)/-a;else for(let e=0;e<s;++e)u[e]=(i+e)*a;return u}function lpe(e,t,n){return spe(e=+e,t=+t,n=+n)[2]}function cpe(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ppe(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function dpe(e){let t,n,r;function i(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<0?i=t+1:o=t}while(i<o)}return i}return 2!==e.length?(t=cpe,n=(t,n)=>cpe(e(t),n),r=(t,n)=>e(t)-n):(t=e===cpe||e===ppe?e:hpe,n=e,r=e),{left:i,center:function(e,t,n=0,o=e.length){const a=i(e,t,n,o-1);return a>n&&r(e[a-1],t)>-r(e[a],t)?a-1:a},right:function(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<=0?i=t+1:o=t}while(i<o)}return i}}}function hpe(){return 0}function fpe(e){return null===e?NaN:+e}const gpe=dpe(cpe),mpe=gpe.right,ype=(gpe.left,dpe(fpe).center,mpe);function bpe(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function vpe(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function xpe(){}var _pe=.7,wpe=1.4285714285714286,kpe="\\s*([+-]?\\d+)\\s*",Spe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Cpe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Mpe=/^#([0-9a-f]{3,8})$/,Tpe=new RegExp(`^rgb\\(${kpe},${kpe},${kpe}\\)$`),Epe=new RegExp(`^rgb\\(${Cpe},${Cpe},${Cpe}\\)$`),Ape=new RegExp(`^rgba\\(${kpe},${kpe},${kpe},${Spe}\\)$`),Fpe=new RegExp(`^rgba\\(${Cpe},${Cpe},${Cpe},${Spe}\\)$`),Ope=new RegExp(`^hsl\\(${Spe},${Cpe},${Cpe}\\)$`),Rpe=new RegExp(`^hsla\\(${Spe},${Cpe},${Cpe},${Spe}\\)$`),Npe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Dpe(){return this.rgb().formatHex()}function Ipe(){return this.rgb().formatRgb()}function Bpe(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Mpe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Lpe(t):3===n?new jpe(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Ppe(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Ppe(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Tpe.exec(e))?new jpe(t[1],t[2],t[3],1):(t=Epe.exec(e))?new jpe(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Ape.exec(e))?Ppe(t[1],t[2],t[3],t[4]):(t=Fpe.exec(e))?Ppe(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Ope.exec(e))?qpe(t[1],t[2]/100,t[3]/100,1):(t=Rpe.exec(e))?qpe(t[1],t[2]/100,t[3]/100,t[4]):Npe.hasOwnProperty(e)?Lpe(Npe[e]):"transparent"===e?new jpe(NaN,NaN,NaN,0):null}function Lpe(e){return new jpe(e>>16&255,e>>8&255,255&e,1)}function Ppe(e,t,n,r){return r<=0&&(e=t=n=NaN),new jpe(e,t,n,r)}function $pe(e){return e instanceof xpe||(e=Bpe(e)),e?new jpe((e=e.rgb()).r,e.g,e.b,e.opacity):new jpe}function zpe(e,t,n,r){return 1===arguments.length?$pe(e):new jpe(e,t,n,null==r?1:r)}function jpe(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Gpe(){return`#${Hpe(this.r)}${Hpe(this.g)}${Hpe(this.b)}`}function Upe(){const e=Wpe(this.opacity);return`${1===e?"rgb(":"rgba("}${Vpe(this.r)}, ${Vpe(this.g)}, ${Vpe(this.b)}${1===e?")":`, ${e})`}`}function Wpe(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Vpe(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Hpe(e){return((e=Vpe(e))<16?"0":"")+e.toString(16)}function qpe(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Kpe(e,t,n,r)}function Xpe(e){if(e instanceof Kpe)return new Kpe(e.h,e.s,e.l,e.opacity);if(e instanceof xpe||(e=Bpe(e)),!e)return new Kpe;if(e instanceof Kpe)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Kpe(a,s,u,e.opacity)}function Ype(e,t,n,r){return 1===arguments.length?Xpe(e):new Kpe(e,t,n,null==r?1:r)}function Kpe(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Jpe(e){return(e=(e||0)%360)<0?e+360:e}function Zpe(e){return Math.max(0,Math.min(1,e||0))}function Qpe(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function ede(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}function tde(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return ede((n-r/t)*t,a,i,o,s)}}function nde(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return ede((n-r/t)*t,i,o,a,s)}}bpe(xpe,Bpe,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Dpe,formatHex:Dpe,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Xpe(this).formatHsl()},formatRgb:Ipe,toString:Ipe}),bpe(jpe,zpe,vpe(xpe,{brighter(e){return e=null==e?wpe:Math.pow(wpe,e),new jpe(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?_pe:Math.pow(_pe,e),new jpe(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new jpe(Vpe(this.r),Vpe(this.g),Vpe(this.b),Wpe(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Gpe,formatHex:Gpe,formatHex8:function(){return`#${Hpe(this.r)}${Hpe(this.g)}${Hpe(this.b)}${Hpe(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Upe,toString:Upe})),bpe(Kpe,Ype,vpe(xpe,{brighter(e){return e=null==e?wpe:Math.pow(wpe,e),new Kpe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?_pe:Math.pow(_pe,e),new Kpe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new jpe(Qpe(e>=240?e-240:e+120,i,r),Qpe(e,i,r),Qpe(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Kpe(Jpe(this.h),Zpe(this.s),Zpe(this.l),Wpe(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Wpe(this.opacity);return`${1===e?"hsl(":"hsla("}${Jpe(this.h)}, ${100*Zpe(this.s)}%, ${100*Zpe(this.l)}%${1===e?")":`, ${e})`}`}}));const rde=e=>()=>e;function ide(e,t){return function(n){return e+n*t}}function ode(e,t){var n=t-e;return n?ide(e,n>180||n<-180?n-360*Math.round(n/360):n):rde(isNaN(e)?t:e)}function ade(e,t){var n=t-e;return n?ide(e,n):rde(isNaN(e)?t:e)}const sde=function e(t){var n=function(e){return 1==(e=+e)?ade:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):rde(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=zpe(e)).r,(t=zpe(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=ade(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function ude(e){return function(t){var n,r,i=t.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=zpe(t[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=e(o),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=s(e),r+""}}}var lde=ude(tde),cde=ude(nde);function pde(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function dde(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function hde(e,t){return(dde(t)?pde:fde)(e,t)}function fde(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=_de(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}}function gde(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function mde(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function yde(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=_de(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}var bde=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,vde=new RegExp(bde.source,"g");function xde(e,t){var n,r,i,o=bde.lastIndex=vde.lastIndex=0,a=-1,s=[],u=[];for(e+="",t+="";(n=bde.exec(e))&&(r=vde.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:mde(n,r)})),o=vde.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})}function _de(e,t){var n,r=typeof t;return null==t||"boolean"===r?rde(t):("number"===r?mde:"string"===r?(n=Bpe(t))?(t=n,sde):xde:t instanceof Bpe?sde:t instanceof Date?gde:dde(t)?pde:Array.isArray(t)?fde:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?yde:mde)(e,t)}function wde(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function kde(e){return+e}var Sde=[0,1];function Cde(e){return e}function Mde(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function Tde(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=Mde(i,r),o=n(a,o)):(r=Mde(r,i),o=n(o,a)),function(e){return o(r(e))}}function Ede(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=Mde(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=ype(e,t,1,r)-1;return o[n](i[n](t))}}function Ade(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Fde(){var e,t,n,r,i,o,a=Sde,s=Sde,u=_de,l=Cde;function c(){var e=Math.min(a.length,s.length);return l!==Cde&&(l=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(a[0],a[e-1])),r=e>2?Ede:Tde,i=o=null,p}function p(t){return null==t||isNaN(t=+t)?n:(i||(i=r(a.map(e),s,u)))(e(l(t)))}return p.invert=function(n){return l(t((o||(o=r(s,a.map(e),mde)))(n)))},p.domain=function(e){return arguments.length?(a=Array.from(e,kde),c()):a.slice()},p.range=function(e){return arguments.length?(s=Array.from(e),c()):s.slice()},p.rangeRound=function(e){return s=Array.from(e),u=wde,c()},p.clamp=function(e){return arguments.length?(l=!!e||Cde,c()):l!==Cde},p.interpolate=function(e){return arguments.length?(u=e,c()):u},p.unknown=function(e){return arguments.length?(n=e,p):n},function(n,r){return e=n,t=r,c()}}function Ode(){return Fde()(Cde,Cde)}function Rde(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function Nde(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}var Dde,Ide=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Bde(e){if(!(t=Ide.exec(e)))throw new Error("invalid format: "+e);var t;return new Lde({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Lde(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Pde(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function $de(e){return(e=Pde(Math.abs(e)))?e[1]:NaN}function zde(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor($de(t)/3)))-$de(Math.abs(e)))}function jde(e,t){var n=Pde(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Bde.prototype=Lde.prototype,Lde.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Gde={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>jde(100*e,t),r:jde,s:function(e,t){var n=Pde(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(Dde=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Pde(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Ude(e){return e}var Wde,Vde,Hde,qde=Array.prototype.map,Xde=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Yde(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,$de(t)-$de(e))+1}function Kde(e){return Math.max(0,-$de(Math.abs(e)))}function Jde(e,t,n,r){var i,o=function(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?lpe(t,e,n):lpe(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}(e,t,n);switch((r=Bde(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=zde(o,a))||(r.precision=i),Hde(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=Yde(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=Kde(o))||(r.precision=i-2*("%"===r.type))}return Vde(r)}function Zde(e){var t=e.domain;return e.ticks=function(e){var n=t();return upe(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return Jde(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,o=t(),a=0,s=o.length-1,u=o[a],l=o[s],c=10;for(l<u&&(i=u,u=l,l=i,i=a,a=s,s=i);c-- >0;){if((i=lpe(u,l,n))===r)return o[a]=u,o[s]=l,t(o);if(i>0)u=Math.floor(u/i)*i,l=Math.ceil(l/i)*i;else{if(!(i<0))break;u=Math.ceil(u*i)/i,l=Math.floor(l*i)/i}r=i}return e},e}function Qde(e,t){var n,r=0,i=(e=e.slice()).length-1,o=e[r],a=e[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),e[r]=t.floor(o),e[i]=t.ceil(a),e}function ehe(e){return Math.log(e)}function the(e){return Math.exp(e)}function nhe(e){return-Math.log(-e)}function rhe(e){return-Math.exp(-e)}function ihe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function ohe(e){return(t,n)=>-e(-t,n)}function ahe(e){const t=e(ehe,the),n=t.domain;let r,i,o=10;function a(){return r=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(o),i=function(e){return 10===e?ihe:e===Math.E?Math.exp:t=>Math.pow(e,t)}(o),n()[0]<0?(r=ohe(r),i=ohe(i),e(nhe,rhe)):e(ehe,the),t}return t.base=function(e){return arguments.length?(o=+e,a()):o},t.domain=function(e){return arguments.length?(n(e),a()):n()},t.ticks=e=>{const t=n();let a=t[0],s=t[t.length-1];const u=s<a;u&&([a,s]=[s,a]);let l,c,p=r(a),d=r(s);const h=null==e?10:+e;let f=[];if(!(o%1)&&d-p<h){if(p=Math.floor(p),d=Math.ceil(d),a>0){for(;p<=d;++p)for(l=1;l<o;++l)if(c=p<0?l/i(-p):l*i(p),!(c<a)){if(c>s)break;f.push(c)}}else for(;p<=d;++p)for(l=o-1;l>=1;--l)if(c=p>0?l/i(-p):l*i(p),!(c<a)){if(c>s)break;f.push(c)}2*f.length<h&&(f=upe(a,s,h))}else f=upe(p,d,Math.min(d-p,h)).map(i);return u?f.reverse():f},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===o?"s":","),"function"!=typeof n&&(o%1||null!=(n=Bde(n)).precision||(n.trim=!0),n=Vde(n)),e===1/0)return n;const a=Math.max(1,o*e/t.ticks().length);return e=>{let t=e/i(Math.round(r(e)));return t*o<o-.5&&(t*=o),t<=a?n(e):""}},t.nice=()=>n(Qde(n(),{floor:e=>i(Math.floor(r(e))),ceil:e=>i(Math.ceil(r(e)))})),t}function she(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function uhe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function lhe(e){return e<0?-e*e:e*e}function che(e){var t=e(Cde,Cde),n=1;return t.exponent=function(t){return arguments.length?1==(n=+t)?e(Cde,Cde):.5===n?e(uhe,lhe):e(she(n),she(1/n)):n},Zde(t)}function phe(){var e=che(Fde());return e.copy=function(){return Ade(e,phe()).exponent(e.exponent())},Rde.apply(e,arguments),e}function dhe(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function hhe(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function fhe(e){var t=1,n=e(dhe(t),hhe(t));return n.constant=function(n){return arguments.length?e(dhe(t=+n),hhe(t)):t},Zde(n)}function ghe(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function mhe(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function yhe(){return 0}Wde=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Ude:(t=qde.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],a=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(e.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?Ude:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(qde.call(e.numerals,String)),u=void 0===e.percent?"%":e.percent+"",l=void 0===e.minus?"":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function p(e){var t=(e=Bde(e)).fill,n=e.align,p=e.sign,d=e.symbol,h=e.zero,f=e.width,g=e.comma,m=e.precision,y=e.trim,b=e.type;"n"===b?(g=!0,b="g"):Gde[b]||(void 0===m&&(m=12),y=!0,b="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var v="$"===d?i:"#"===d&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",x="$"===d?o:/[%p]/.test(b)?u:"",_=Gde[b],w=/[defgprs%]/.test(b);function k(e){var i,o,u,d=v,k=x;if("c"===b)k=_(e)+k,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:_(Math.abs(e),m),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),S&&0==+e&&"+"!==p&&(S=!1),d=(S?"("===p?p:l:"-"===p||"("===p?"":p)+d,k=("s"===b?Xde[8+Dde/3]:"")+k+(S&&"("===p?")":""),w)for(i=-1,o=e.length;++i<o;)if(48>(u=e.charCodeAt(i))||u>57){k=(46===u?a+e.slice(i+1):e.slice(i))+k,e=e.slice(0,i);break}}g&&!h&&(e=r(e,1/0));var C=d.length+e.length+k.length,M=C<f?new Array(f-C+1).join(t):"";switch(g&&h&&(e=r(M+e,M.length?f-k.length:1/0),M=""),n){case"<":e=d+e+k+M;break;case"=":e=d+M+e+k;break;case"^":e=M.slice(0,C=M.length>>1)+d+e+k+M.slice(C);break;default:e=M+d+e+k}return s(e)}return m=void 0===m?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),k.toString=function(){return e+""},k}return{format:p,formatPrefix:function(e,t){var n=p(((e=Bde(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor($de(t)/3))),i=Math.pow(10,-r),o=Xde[8+r/3];return function(e){return n(i*e)+o}}}}({thousands:",",grouping:[3],currency:["$",""]}),Vde=Wde.format,Hde=Wde.formatPrefix;const bhe=Math.sqrt(50),vhe=Math.sqrt(10),xhe=Math.sqrt(2);function _he(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=bhe?10:o>=vhe?5:o>=xhe?2:1;let s,u,l;return i<0?(l=Math.pow(10,-i)/a,s=Math.round(e*l),u=Math.round(t*l),s/l<e&&++s,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*a,s=Math.round(e/l),u=Math.round(t/l),s*l<e&&++s,u*l>t&&--u),u<s&&.5<=n&&n<2?_he(e,t,2*n):[s,u,l]}function whe(e,t,n){return _he(e=+e,t=+t,n=+n)[2]}function khe(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?whe(t,e,n):whe(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}const She=1e3,Che=6e4,Mhe=36e5,The=864e5,Ehe=6048e5,Ahe=31536e6,Fhe=new Date,Ohe=new Date;function Rhe(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{const t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,r,o)=>{const a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return a;let s;do{a.push(s=new Date(+n)),t(n,o),e(n)}while(s<n&&n<r);return a},i.filter=n=>Rhe((t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),((e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})),n&&(i.count=(t,r)=>(Fhe.setTime(+t),Ohe.setTime(+r),e(Fhe),e(Ohe),Math.floor(n(Fhe,Ohe))),i.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?t=>r(t)%e==0:t=>i.count(0,t)%e==0):i:null)),i}const Nhe=Rhe((()=>{}),((e,t)=>{e.setTime(+e+t)}),((e,t)=>t-e));Nhe.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?Rhe((t=>{t.setTime(Math.floor(t/e)*e)}),((t,n)=>{t.setTime(+t+n*e)}),((t,n)=>(n-t)/e)):Nhe:null),Nhe.range;const Dhe=Rhe((e=>{e.setTime(e-e.getMilliseconds())}),((e,t)=>{e.setTime(+e+t*She)}),((e,t)=>(t-e)/She),(e=>e.getUTCSeconds())),Ihe=(Dhe.range,Rhe((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*She)}),((e,t)=>{e.setTime(+e+t*Che)}),((e,t)=>(t-e)/Che),(e=>e.getMinutes()))),Bhe=(Ihe.range,Rhe((e=>{e.setUTCSeconds(0,0)}),((e,t)=>{e.setTime(+e+t*Che)}),((e,t)=>(t-e)/Che),(e=>e.getUTCMinutes()))),Lhe=(Bhe.range,Rhe((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*She-e.getMinutes()*Che)}),((e,t)=>{e.setTime(+e+t*Mhe)}),((e,t)=>(t-e)/Mhe),(e=>e.getHours()))),Phe=(Lhe.range,Rhe((e=>{e.setUTCMinutes(0,0,0)}),((e,t)=>{e.setTime(+e+t*Mhe)}),((e,t)=>(t-e)/Mhe),(e=>e.getUTCHours()))),$he=(Phe.range,Rhe((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Che)/The),(e=>e.getDate()-1))),zhe=($he.range,Rhe((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/The),(e=>e.getUTCDate()-1))),jhe=(zhe.range,Rhe((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/The),(e=>Math.floor(e/The))));function Ghe(e){return Rhe((t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),((e,t)=>{e.setDate(e.getDate()+7*t)}),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Che)/Ehe))}jhe.range;const Uhe=Ghe(0),Whe=Ghe(1),Vhe=Ghe(2),Hhe=Ghe(3),qhe=Ghe(4),Xhe=Ghe(5),Yhe=Ghe(6);function Khe(e){return Rhe((t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)}),((e,t)=>(t-e)/Ehe))}Uhe.range,Whe.range,Vhe.range,Hhe.range,qhe.range,Xhe.range,Yhe.range;const Jhe=Khe(0),Zhe=Khe(1),Qhe=Khe(2),efe=Khe(3),tfe=Khe(4),nfe=Khe(5),rfe=Khe(6),ife=(Jhe.range,Zhe.range,Qhe.range,efe.range,tfe.range,nfe.range,rfe.range,Rhe((e=>{e.setDate(1),e.setHours(0,0,0,0)}),((e,t)=>{e.setMonth(e.getMonth()+t)}),((e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())),(e=>e.getMonth()))),ofe=(ife.range,Rhe((e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)}),((e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())),(e=>e.getUTCMonth()))),afe=(ofe.range,Rhe((e=>{e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,t)=>{e.setFullYear(e.getFullYear()+t)}),((e,t)=>t.getFullYear()-e.getFullYear()),(e=>e.getFullYear())));afe.every=e=>isFinite(e=Math.floor(e))&&e>0?Rhe((t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,n)=>{t.setFullYear(t.getFullYear()+n*e)})):null,afe.range;const sfe=Rhe((e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)}),((e,t)=>t.getUTCFullYear()-e.getUTCFullYear()),(e=>e.getUTCFullYear()));function ufe(e,t,n,r,i,o){const a=[[Dhe,1,She],[Dhe,5,5e3],[Dhe,15,15e3],[Dhe,30,3e4],[o,1,Che],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,Mhe],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,The],[r,2,1728e5],[n,1,Ehe],[t,1,2592e6],[t,3,7776e6],[e,1,Ahe]];function s(t,n,r){const i=Math.abs(n-t)/r,o=function(e){let t,n,r;function i(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<0?i=t+1:o=t}while(i<o)}return i}return 2!==e.length?(t=ghe,n=(t,n)=>ghe(e(t),n),r=(t,n)=>e(t)-n):(t=e===ghe||e===mhe?e:yhe,n=e,r=e),{left:i,center:function(e,t,n=0,o=e.length){const a=i(e,t,n,o-1);return a>n&&r(e[a-1],t)>-r(e[a],t)?a-1:a},right:function(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<=0?i=t+1:o=t}while(i<o)}return i}}}((([,,e])=>e)).right(a,i);if(o===a.length)return e.every(khe(t/Ahe,n/Ahe,r));if(0===o)return Nhe.every(Math.max(khe(t,n,r),1));const[s,u]=a[i/a[o-1][2]<a[o][2]/i?o-1:o];return s.every(u)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const i=n&&"function"==typeof n.range?n:s(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},s]}sfe.every=e=>isFinite(e=Math.floor(e))&&e>0?Rhe((t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null,sfe.range;const[lfe,cfe]=ufe(sfe,ofe,Jhe,jhe,Phe,Bhe),[pfe,dfe]=ufe(afe,ife,Uhe,$he,Lhe,Ihe);function hfe(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function ffe(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function gfe(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var mfe,yfe,bfe,vfe,xfe,_fe={"-":"",_:" ",0:"0"},wfe=/^\s*\d+/,kfe=/^%/,Sfe=/[\\^$*+?|[\]().{}]/g;function Cfe(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function Mfe(e){return e.replace(Sfe,"\\$&")}function Tfe(e){return new RegExp("^(?:"+e.map(Mfe).join("|")+")","i")}function Efe(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function Afe(e,t,n){var r=wfe.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Ffe(e,t,n){var r=wfe.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Ofe(e,t,n){var r=wfe.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Rfe(e,t,n){var r=wfe.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Nfe(e,t,n){var r=wfe.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Dfe(e,t,n){var r=wfe.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Ife(e,t,n){var r=wfe.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Bfe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Lfe(e,t,n){var r=wfe.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function Pfe(e,t,n){var r=wfe.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function $fe(e,t,n){var r=wfe.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function zfe(e,t,n){var r=wfe.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function jfe(e,t,n){var r=wfe.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Gfe(e,t,n){var r=wfe.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Ufe(e,t,n){var r=wfe.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Wfe(e,t,n){var r=wfe.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Vfe(e,t,n){var r=wfe.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Hfe(e,t,n){var r=kfe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function qfe(e,t,n){var r=wfe.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Xfe(e,t,n){var r=wfe.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Yfe(e,t){return Cfe(e.getDate(),t,2)}function Kfe(e,t){return Cfe(e.getHours(),t,2)}function Jfe(e,t){return Cfe(e.getHours()%12||12,t,2)}function Zfe(e,t){return Cfe(1+$he.count(afe(e),e),t,3)}function Qfe(e,t){return Cfe(e.getMilliseconds(),t,3)}function ege(e,t){return Qfe(e,t)+"000"}function tge(e,t){return Cfe(e.getMonth()+1,t,2)}function nge(e,t){return Cfe(e.getMinutes(),t,2)}function rge(e,t){return Cfe(e.getSeconds(),t,2)}function ige(e){var t=e.getDay();return 0===t?7:t}function oge(e,t){return Cfe(Uhe.count(afe(e)-1,e),t,2)}function age(e){var t=e.getDay();return t>=4||0===t?qhe(e):qhe.ceil(e)}function sge(e,t){return e=age(e),Cfe(qhe.count(afe(e),e)+(4===afe(e).getDay()),t,2)}function uge(e){return e.getDay()}function lge(e,t){return Cfe(Whe.count(afe(e)-1,e),t,2)}function cge(e,t){return Cfe(e.getFullYear()%100,t,2)}function pge(e,t){return Cfe((e=age(e)).getFullYear()%100,t,2)}function dge(e,t){return Cfe(e.getFullYear()%1e4,t,4)}function hge(e,t){var n=e.getDay();return Cfe((e=n>=4||0===n?qhe(e):qhe.ceil(e)).getFullYear()%1e4,t,4)}function fge(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Cfe(t/60|0,"0",2)+Cfe(t%60,"0",2)}function gge(e,t){return Cfe(e.getUTCDate(),t,2)}function mge(e,t){return Cfe(e.getUTCHours(),t,2)}function yge(e,t){return Cfe(e.getUTCHours()%12||12,t,2)}function bge(e,t){return Cfe(1+zhe.count(sfe(e),e),t,3)}function vge(e,t){return Cfe(e.getUTCMilliseconds(),t,3)}function xge(e,t){return vge(e,t)+"000"}function _ge(e,t){return Cfe(e.getUTCMonth()+1,t,2)}function wge(e,t){return Cfe(e.getUTCMinutes(),t,2)}function kge(e,t){return Cfe(e.getUTCSeconds(),t,2)}function Sge(e){var t=e.getUTCDay();return 0===t?7:t}function Cge(e,t){return Cfe(Jhe.count(sfe(e)-1,e),t,2)}function Mge(e){var t=e.getUTCDay();return t>=4||0===t?tfe(e):tfe.ceil(e)}function Tge(e,t){return e=Mge(e),Cfe(tfe.count(sfe(e),e)+(4===sfe(e).getUTCDay()),t,2)}function Ege(e){return e.getUTCDay()}function Age(e,t){return Cfe(Zhe.count(sfe(e)-1,e),t,2)}function Fge(e,t){return Cfe(e.getUTCFullYear()%100,t,2)}function Oge(e,t){return Cfe((e=Mge(e)).getUTCFullYear()%100,t,2)}function Rge(e,t){return Cfe(e.getUTCFullYear()%1e4,t,4)}function Nge(e,t){var n=e.getUTCDay();return Cfe((e=n>=4||0===n?tfe(e):tfe.ceil(e)).getUTCFullYear()%1e4,t,4)}function Dge(){return"+0000"}function Ige(){return"%"}function Bge(e){return+e}function Lge(e){return Math.floor(+e/1e3)}function Pge(e){return new Date(e)}function $ge(e){return e instanceof Date?+e:+new Date(+e)}function zge(e,t,n,r,i,o,a,s,u,l){var c=Ode(),p=c.invert,d=c.domain,h=l(".%L"),f=l(":%S"),g=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),b=l("%b %d"),v=l("%B"),x=l("%Y");function _(e){return(u(e)<e?h:s(e)<e?f:a(e)<e?g:o(e)<e?m:r(e)<e?i(e)<e?y:b:n(e)<e?v:x)(e)}return c.invert=function(e){return new Date(p(e))},c.domain=function(e){return arguments.length?d(Array.from(e,$ge)):d().map(Pge)},c.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},c.tickFormat=function(e,t){return null==t?_:l(t)},c.nice=function(e){var n=d();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(Qde(n,e)):c},c.copy=function(){return Ade(c,zge(e,t,n,r,i,o,a,s,u,l))},c}function jge(){var e,t,n,r,i,o=0,a=1,s=Cde,u=!1;function l(t){return null==t||isNaN(t=+t)?i:s(0===n?.5:(t=(r(t)-e)*n,u?Math.max(0,Math.min(1,t)):t))}function c(e){return function(t){var n,r;return arguments.length?([n,r]=t,s=e(n,r),l):[s(0),s(1)]}}return l.domain=function(i){return arguments.length?([o,a]=i,e=r(o=+o),t=r(a=+a),n=e===t?0:1/(t-e),l):[o,a]},l.clamp=function(e){return arguments.length?(u=!!e,l):u},l.interpolator=function(e){return arguments.length?(s=e,l):s},l.range=c(_de),l.rangeRound=c(wde),l.unknown=function(e){return arguments.length?(i=e,l):i},function(i){return r=i,e=i(o),t=i(a),n=e===t?0:1/(t-e),l}}function Gge(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Uge(){var e=Zde(jge()(Cde));return e.copy=function(){return Gge(e,Uge())},Nde.apply(e,arguments)}function Wge(){var e=che(jge());return e.copy=function(){return Gge(e,Wge()).exponent(e.exponent())},Nde.apply(e,arguments)}function Vge(e,t){void 0===t&&(t=e,e=_de);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return o[t](e-t)}}function Hge(){var e,t,n,r,i,o,a,s=0,u=.5,l=1,c=1,p=Cde,d=!1;function h(e){return isNaN(e=+e)?a:(e=.5+((e=+o(e))-t)*(c*e<c*t?r:i),p(d?Math.max(0,Math.min(1,e)):e))}function f(e){return function(t){var n,r,i;return arguments.length?([n,r,i]=t,p=Vge(e,[n,r,i]),h):[p(0),p(.5),p(1)]}}return h.domain=function(a){return arguments.length?([s,u,l]=a,e=o(s=+s),t=o(u=+u),n=o(l=+l),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),c=t<e?-1:1,h):[s,u,l]},h.clamp=function(e){return arguments.length?(d=!!e,h):d},h.interpolator=function(e){return arguments.length?(p=e,h):p},h.range=f(_de),h.rangeRound=f(wde),h.unknown=function(e){return arguments.length?(a=e,h):a},function(a){return o=a,e=a(s),t=a(u),n=a(l),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),c=t<e?-1:1,h}}function qge(){var e=che(Hge());return e.copy=function(){return Gge(e,qge()).exponent(e.exponent())},Nde.apply(e,arguments)}function Xge(e,t,n=fpe){if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e);return a+(+n(e[o+1],o+1,e)-a)*(i-o)}}mfe=function(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=Tfe(i),c=Efe(i),p=Tfe(o),d=Efe(o),h=Tfe(a),f=Efe(a),g=Tfe(s),m=Efe(s),y=Tfe(u),b=Efe(u),v={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:Yfe,e:Yfe,f:ege,g:pge,G:hge,H:Kfe,I:Jfe,j:Zfe,L:Qfe,m:tge,M:nge,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:Bge,s:Lge,S:rge,u:ige,U:oge,V:sge,w:uge,W:lge,x:null,X:null,y:cge,Y:dge,Z:fge,"%":Ige},x={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return u[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:gge,e:gge,f:xge,g:Oge,G:Nge,H:mge,I:yge,j:bge,L:vge,m:_ge,M:wge,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:Bge,s:Lge,S:kge,u:Sge,U:Cge,V:Tge,w:Ege,W:Age,x:null,X:null,y:Fge,Y:Rge,Z:Dge,"%":Ige},_={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=f.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=p.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=y.exec(t.slice(n));return r?(e.m=b.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=g.exec(t.slice(n));return r?(e.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return S(e,t,n,r)},d:$fe,e:$fe,f:Vfe,g:Ife,G:Dfe,H:jfe,I:jfe,j:zfe,L:Wfe,m:Pfe,M:Gfe,p:function(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=c.get(r[0].toLowerCase()),n+r[0].length):-1},q:Lfe,Q:qfe,s:Xfe,S:Ufe,u:Ffe,U:Ofe,V:Rfe,w:Afe,W:Nfe,x:function(e,t,r){return S(e,n,t,r)},X:function(e,t,n){return S(e,r,t,n)},y:Ife,Y:Dfe,Z:Bfe,"%":Hfe};function w(e,t){return function(n){var r,i,o,a=[],s=-1,u=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===e.charCodeAt(s)&&(a.push(e.slice(u,s)),null!=(i=_fe[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(e.slice(u,s)),a.join("")}}function k(e,t){return function(n){var r,i,o=gfe(1900,void 0,1);if(S(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=ffe(gfe(o.y,0,1))).getUTCDay(),r=i>4||0===i?Zhe.ceil(r):Zhe(r),r=zhe.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=hfe(gfe(o.y,0,1))).getDay(),r=i>4||0===i?Whe.ceil(r):Whe(r),r=$he.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?ffe(gfe(o.y,0,1)).getUTCDay():hfe(gfe(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,ffe(o)):hfe(o)}}function S(e,t,n,r){for(var i,o,a=0,s=t.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=_[i in _fe?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return v.x=w(n,v),v.X=w(r,v),v.c=w(t,v),x.x=w(n,x),x.X=w(r,x),x.c=w(t,x),{format:function(e){var t=w(e+="",v);return t.toString=function(){return e},t},parse:function(e){var t=k(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=k(e+="",!0);return t.toString=function(){return e},t}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),yfe=mfe.format,bfe=mfe.parse,vfe=mfe.utcFormat,xfe=mfe.utcParse;const Yge=Symbol("implicit");function Kge(){var e=new gy,t=[],n=[],r=Yge;function i(i){let o=e.get(i);if(void 0===o){if(r!==Yge)return r;e.set(i,o=t.push(i)-1)}return n[o%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new gy;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return Kge(t,n).unknown(r)},Rde.apply(i,arguments),i}function Jge(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Zge(e,t){var n=ode(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}var Qge,eme=180/Math.PI,tme={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function nme(e,t,n,r,i,o){var a,s,u;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*eme,skewX:Math.atan(u)*eme,scaleX:a,scaleY:s}}function rme(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,a){var s=[],u=[];return o=e(o),a=e(a),function(e,r,i,o,a,s){if(e!==i||r!==o){var u=a.push("translate(",null,t,null,n);s.push({i:u-4,x:mde(e,i)},{i:u-2,x:mde(r,o)})}else(i||o)&&a.push("translate("+i+t+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,u),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:mde(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,a.rotate,s,u),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:mde(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,a.skewX,s,u),function(e,t,n,r,o,a){if(e!==n||t!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:mde(e,n)},{i:s-2,x:mde(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,u),o=a=null,function(e){for(var t,n=-1,r=u.length;++n<r;)s[(t=u[n]).i]=t.x(e);return s.join("")}}}var ime=rme((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?tme:nme(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),ome=rme((function(e){return null==e?tme:(Qge||(Qge=document.createElementNS("http://www.w3.org/2000/svg","g")),Qge.setAttribute("transform",e),(e=Qge.transform.baseVal.consolidate())?nme((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):tme)}),", ",")",")");function ame(e){return((e=Math.exp(e))+1/e)/2}const sme=function e(t,n,r){function i(e,i){var o,a,s=e[0],u=e[1],l=e[2],c=i[0],p=i[1],d=i[2],h=c-s,f=p-u,g=h*h+f*f;if(g<1e-12)a=Math.log(d/l)/t,o=function(e){return[s+e*h,u+e*f,l*Math.exp(t*e*a)]};else{var m=Math.sqrt(g),y=(d*d-l*l+r*g)/(2*l*n*m),b=(d*d-l*l-r*g)/(2*d*n*m),v=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(b*b+1)-b);a=(x-v)/t,o=function(e){var r=e*a,i=ame(v),o=l/(n*m)*(i*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*r+v)-function(e){return((e=Math.exp(e))-1/e)/2}(v));return[s+o*h,u+o*f,l*i/ame(t*r+v)]}}return o.duration=1e3*a*t/Math.SQRT2,o}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},i}(Math.SQRT2,2,4);function ume(e){return function(t,n){var r=e((t=Ype(t)).h,(n=Ype(n)).h),i=ade(t.s,n.s),o=ade(t.l,n.l),a=ade(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=i(e),t.l=o(e),t.opacity=a(e),t+""}}}const lme=ume(ode);var cme=ume(ade);const pme=Math.PI/180,dme=180/Math.PI,hme=.96422,fme=1,gme=.82521,mme=4/29,yme=.12841854934601665,bme=.008856451679035631;function vme(e){if(e instanceof _me)return new _me(e.l,e.a,e.b,e.opacity);if(e instanceof Tme)return Eme(e);e instanceof jpe||(e=$pe(e));var t,n,r=Cme(e.r),i=Cme(e.g),o=Cme(e.b),a=wme((.2225045*r+.7168786*i+.0606169*o)/fme);return r===i&&i===o?t=n=a:(t=wme((.4360747*r+.3850649*i+.1430804*o)/hme),n=wme((.0139322*r+.0971045*i+.7141733*o)/gme)),new _me(116*a-16,500*(t-a),200*(a-n),e.opacity)}function xme(e,t,n,r){return 1===arguments.length?vme(e):new _me(e,t,n,null==r?1:r)}function _me(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function wme(e){return e>bme?Math.pow(e,1/3):e/yme+mme}function kme(e){return e>.20689655172413793?e*e*e:yme*(e-mme)}function Sme(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Cme(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Mme(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof Tme)return new Tme(e.h,e.c,e.l,e.opacity);if(e instanceof _me||(e=vme(e)),0===e.a&&0===e.b)return new Tme(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*dme;return new Tme(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}(e):new Tme(e,t,n,null==r?1:r)}function Tme(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function Eme(e){if(isNaN(e.h))return new _me(e.l,0,0,e.opacity);var t=e.h*pme;return new _me(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function Ame(e,t){var n=ade((e=xme(e)).l,(t=xme(t)).l),r=ade(e.a,t.a),i=ade(e.b,t.b),o=ade(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=i(t),e.opacity=o(t),e+""}}function Fme(e){return function(t,n){var r=e((t=Mme(t)).h,(n=Mme(n)).h),i=ade(t.c,n.c),o=ade(t.l,n.l),a=ade(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=i(e),t.l=o(e),t.opacity=a(e),t+""}}}bpe(_me,xme,vpe(xpe,{brighter(e){return new _me(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new _me(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new jpe(Sme(3.1338561*(t=hme*kme(t))-1.6168667*(e=fme*kme(e))-.4906146*(n=gme*kme(n))),Sme(-.9787684*t+1.9161415*e+.033454*n),Sme(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),bpe(Tme,Mme,vpe(xpe,{brighter(e){return new Tme(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new Tme(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return Eme(this).rgb()}}));const Ome=Fme(ode);var Rme=Fme(ade),Nme=-.14861,Dme=1.78277,Ime=-.29227,Bme=-.90649,Lme=1.97294,Pme=Lme*Bme,$me=Lme*Dme,zme=Dme*Ime-Bme*Nme;function jme(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof Gme)return new Gme(e.h,e.s,e.l,e.opacity);e instanceof jpe||(e=$pe(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(zme*r+Pme*t-$me*n)/(zme+Pme-$me),o=r-i,a=(Lme*(n-i)-Ime*o)/Bme,s=Math.sqrt(a*a+o*o)/(Lme*i*(1-i)),u=s?Math.atan2(a,o)*dme-120:NaN;return new Gme(u<0?u+360:u,s,i,e.opacity)}(e):new Gme(e,t,n,null==r?1:r)}function Gme(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Ume(e){return function t(n){function r(t,r){var i=e((t=jme(t)).h,(r=jme(r)).h),o=ade(t.s,r.s),a=ade(t.l,r.l),s=ade(t.opacity,r.opacity);return function(e){return t.h=i(e),t.s=o(e),t.l=a(Math.pow(e,n)),t.opacity=s(e),t+""}}return n=+n,r.gamma=t,r}(1)}bpe(Gme,jme,vpe(xpe,{brighter(e){return e=null==e?wpe:Math.pow(wpe,e),new Gme(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?_pe:Math.pow(_pe,e),new Gme(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*pme,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new jpe(255*(t+n*(Nme*r+Dme*i)),255*(t+n*(Ime*r+Bme*i)),255*(t+n*(Lme*r)),this.opacity)}}));const Wme=Ume(ode);var Vme=Ume(ade);function Hme(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const qme="year",Xme="quarter",Yme="month",Kme="week",Jme="date",Zme="day",Qme="dayofyear",eye="hours",tye="minutes",nye="seconds",rye="milliseconds",iye=[qme,Xme,Yme,Kme,Jme,Zme,Qme,eye,tye,nye,rye].reduce(((e,t,n)=>(e[t]=1+n,e)),{}),oye={[qme]:"%Y ",[Xme]:"Q%q ",[Yme]:"%b ",[Jme]:"%d ",[Kme]:"W%U ",[Zme]:"%a ",[Qme]:"%j ",[eye]:"%H:00",[tye]:"00:%M",[nye]:":%S",[rye]:".%L",[`${qme}-${Yme}`]:"%Y-%m ",[`${qme}-${Yme}-${Jme}`]:"%Y-%m-%d ",[`${eye}-${tye}`]:"%H:%M"},aye=new Date;function sye(e){return aye.setFullYear(e),aye.setMonth(0),aye.setDate(1),aye.setHours(0,0,0,0),aye}const uye={[qme]:afe,[Xme]:ife.every(3),[Yme]:ife,[Kme]:Uhe,[Jme]:$he,[Zme]:$he,[Qme]:$he,[eye]:Lhe,[tye]:Ihe,[nye]:Dhe,[rye]:Nhe},lye={[qme]:sfe,[Xme]:ofe.every(3),[Yme]:ofe,[Kme]:Jhe,[Jme]:zhe,[Zme]:zhe,[Qme]:zhe,[eye]:Phe,[tye]:Bhe,[nye]:Dhe,[rye]:Nhe};function cye(e){return uye[e]}function pye(e){return lye[e]}function dye(e,t,n){return e?e.offset(t,n):void 0}function hye(e,t,n,r){return e?e.range(t,n,r):void 0}function fye(e,t,n){const r=e-t+2*n;return e?r>0?r:1:0}[qme,Yme,Jme,eye,tye,nye,rye].slice(0,-1).slice(0,-1).slice(0,-1).slice(0,-1);const gye="linear",mye="log",yye="pow",bye="sqrt",vye="symlog",xye="time",_ye="utc",wye="sequential",kye="diverging",Sye="quantile",Cye="quantize",Mye="threshold",Tye="continuous",Eye="discrete",Aye="discretizing",Fye="interpolating",Oye="temporal";function Rye(){const e=Kge().unknown(void 0),t=e.domain,n=e.range;let r,i,o=[0,1],a=!1,s=0,u=0,l=.5;function c(){const e=t().length,c=o[1]<o[0],p=o[1-c],d=fye(e,s,u);let h=o[c-0];r=(p-h)/(d||1),a&&(r=Math.floor(r)),h+=(p-h-r*(e-s))*l,i=r*(1-s),a&&(h=Math.round(h),i=Math.round(i));const f=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(i);++r<i;)o[r]=e+r*n;return o}(e).map((e=>h+r*e));return n(c?f.reverse():f)}return delete e.unknown,e.domain=function(e){return arguments.length?(t(e),c()):t()},e.range=function(e){return arguments.length?(o=[+e[0],+e[1]],c()):o.slice()},e.rangeRound=function(e){return o=[+e[0],+e[1]],a=!0,c()},e.bandwidth=function(){return i},e.step=function(){return r},e.round=function(e){return arguments.length?(a=!!e,c()):a},e.padding=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),s=u,c()):s},e.paddingInner=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),c()):s},e.paddingOuter=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),c()):u},e.align=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),c()):l},e.invertRange=function(e){if(null==e[0]||null==e[1])return;const r=o[1]<o[0],a=r?n().reverse():n(),s=a.length-1;let u,l,c,p=+e[0],d=+e[1];return p!=p||d!=d||(d<p&&(c=p,p=d,d=c),d<a[0]||p>o[1-r])?void 0:(u=Math.max(0,npe(a,p)-1),l=p===d?u:npe(a,d)-1,p-a[u]>i+1e-10&&++u,r&&(c=u,u=s-l,l=s-c),u>l?void 0:t().slice(u,l+1))},e.invert=function(t){const n=e.invertRange([t,t]);return n?n[0]:n},e.copy=function(){return Rye().domain(t()).range(o).round(a).paddingInner(s).paddingOuter(u).align(l)},c()}function Nye(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return Nye(t())},e}var Dye=Array.prototype.map;const Iye=Array.prototype.slice,Bye=new Map,Lye=Symbol("vega_scale");function Pye(e,t,n){return arguments.length>1?(Bye.set(e,function(e,t,n){const r=function(){const n=t();return n.invertRange||(n.invertRange=n.invert?(r=n,function(e){let t,n=e[0],i=e[1];return i<n&&(t=n,n=i,i=t),[r.invert(n),r.invert(i)]}):n.invertExtent?function(e){return function(t){const n=e.range();let r,i,o,a,s=t[0],u=t[1],l=-1;for(u<s&&(i=s,s=u,u=i),o=0,a=n.length;o<a;++o)n[o]>=s&&n[o]<=u&&(l<0&&(l=o),r=o);if(!(l<0))return s=e.invertExtent(n[l]),u=e.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}}(n):void 0),n.type=e,function(e){return e[Lye]=!0,e}(n);var r};return r.metadata=$le(Tle(n)),r}(e,t,n)),this):function(e){return Bye.has(e)}(e)?Bye.get(e):void 0}function $ye(e,t){const n=Bye.get(e);return n&&n.metadata[t]}function zye(e){return $ye(e,Eye)}Pye("identity",(function e(t){var n;function r(e){return null==e||isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=Array.from(e,kde),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,kde):[0,1],Zde(r)})),Pye(gye,(function e(){var t=Ode();return t.copy=function(){return Ade(t,e())},Rde.apply(t,arguments),Zde(t)}),Tye),Pye(mye,(function e(){const t=ahe(Fde()).domain([1,10]);return t.copy=()=>Ade(t,e()).base(t.base()),Rde.apply(t,arguments),t}),[Tye,mye]),Pye(yye,phe,Tye),Pye(bye,(function(){return phe.apply(null,arguments).exponent(.5)}),Tye),Pye(vye,(function e(){var t=fhe(Fde());return t.copy=function(){return Ade(t,e()).constant(t.constant())},Rde.apply(t,arguments)}),Tye),Pye(xye,(function(){return Rde.apply(zge(pfe,dfe,afe,ife,Uhe,$he,Lhe,Ihe,Dhe,yfe).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[Tye,Oye]),Pye(_ye,(function(){return Rde.apply(zge(lfe,cfe,sfe,ofe,Jhe,zhe,Phe,Bhe,Dhe,vfe).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[Tye,Oye]),Pye(wye,Uge,[Tye,Fye]),Pye(`${wye}-${gye}`,Uge,[Tye,Fye]),Pye(`${wye}-${mye}`,(function e(){var t=ahe(jge()).domain([1,10]);return t.copy=function(){return Gge(t,e()).base(t.base())},Nde.apply(t,arguments)}),[Tye,Fye,mye]),Pye(`${wye}-${yye}`,Wge,[Tye,Fye]),Pye(`${wye}-${bye}`,(function(){return Wge.apply(null,arguments).exponent(.5)}),[Tye,Fye]),Pye(`${wye}-${vye}`,(function e(){var t=fhe(jge());return t.copy=function(){return Gge(t,e()).constant(t.constant())},Nde.apply(t,arguments)}),[Tye,Fye]),Pye(`${kye}-${gye}`,(function e(){var t=Zde(Hge()(Cde));return t.copy=function(){return Gge(t,e())},Nde.apply(t,arguments)}),[Tye,Fye]),Pye(`${kye}-${mye}`,(function e(){var t=ahe(Hge()).domain([.1,1,10]);return t.copy=function(){return Gge(t,e()).base(t.base())},Nde.apply(t,arguments)}),[Tye,Fye,mye]),Pye(`${kye}-${yye}`,qge,[Tye,Fye]),Pye(`${kye}-${bye}`,(function(){return qge.apply(null,arguments).exponent(.5)}),[Tye,Fye]),Pye(`${kye}-${vye}`,(function e(){var t=fhe(Hge());return t.copy=function(){return Gge(t,e()).constant(t.constant())},Nde.apply(t,arguments)}),[Tye,Fye]),Pye(Sye,(function e(){var t,n=[],r=[],i=[];function o(){var e=0,t=Math.max(1,r.length);for(i=new Array(t-1);++e<t;)i[e-1]=Xge(n,e/t);return a}function a(e){return null==e||isNaN(e=+e)?t:r[ype(i,e)]}return a.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?i[t-1]:n[0],t<i.length?i[t]:n[n.length-1]]},a.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(cpe),o()},a.range=function(e){return arguments.length?(r=Array.from(e),o()):r.slice()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.quantiles=function(){return i.slice()},a.copy=function(){return e().domain(n).range(r).unknown(t)},Rde.apply(a,arguments)}),[Aye,Sye]),Pye(Cye,(function e(){var t,n=0,r=1,i=1,o=[.5],a=[0,1];function s(e){return null!=e&&e<=e?a[ype(o,e,0,i)]:t}function u(){var e=-1;for(o=new Array(i);++e<i;)o[e]=((e+1)*r-(e-i)*n)/(i+1);return s}return s.domain=function(e){return arguments.length?([n,r]=e,n=+n,r=+r,u()):[n,r]},s.range=function(e){return arguments.length?(i=(a=Array.from(e)).length-1,u()):a.slice()},s.invertExtent=function(e){var t=a.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,o[0]]:t>=i?[o[i-1],r]:[o[t-1],o[t]]},s.unknown=function(e){return arguments.length?(t=e,s):s},s.thresholds=function(){return o.slice()},s.copy=function(){return e().domain([n,r]).range(a).unknown(t)},Rde.apply(Zde(s),arguments)}),Aye),Pye(Mye,(function e(){var t,n=[.5],r=[0,1],i=1;function o(e){return null!=e&&e<=e?r[ype(n,e,0,i)]:t}return o.domain=function(e){return arguments.length?(n=Array.from(e),i=Math.min(n.length,r.length-1),o):n.slice()},o.range=function(e){return arguments.length?(r=Array.from(e),i=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},o.unknown=function(e){return arguments.length?(t=e,o):t},o.copy=function(){return e().domain(n).range(r).unknown(t)},Rde.apply(o,arguments)}),Aye),Pye("bin-ordinal",(function e(){let t=[],n=[];function r(e){return null==e||e!=e?void 0:n[(rpe(t,e)-1)%n.length]}return r.domain=function(e){return arguments.length?(t=function(e){return Dye.call(e,vle)}(e),r):t.slice()},r.range=function(e){return arguments.length?(n=Iye.call(e),r):n.slice()},r.tickFormat=function(e,n){return Jde(t[0],ble(t),null==e?10:e,n)},r.copy=function(){return e().domain(r.domain()).range(r.range())},r}),[Eye,Aye]),Pye("ordinal",Kge,Eye),Pye("band",Rye,Eye),Pye("point",(function(){return Nye(Rye().paddingInner(1))}),Eye);const jye=["clamp","base","constant","exponent"];function Gye(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function Uye(e,t){for(const n in e)Vye(n,t(e[n]))}const Wye={};function Vye(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(Wye[e]=t,this):Wye[e]}Uye({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},Gye),Uye({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(e=>function(e,t,n){return Vge(function(e,t){const n=v[function(e){return"interpolate"+e.toLowerCase().split("-").map((e=>e[0].toUpperCase()+e.slice(1))).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}(t||"rgb",n),e)}(Gye(e))));const Hye="symbol",qye="discrete",Xye=e=>mle(e)?e.map((e=>String(e))):String(e),Yye=(e,t)=>e[1]-t[1],Kye=(e,t)=>t[1]-e[1];function Jye(e,t){return e.bins?function(e,t,n){let r=e.range(),i=r[0],o=ble(r),a=Yye;return i>o&&(r=o,o=i,i=r,a=Kye),i=Math.floor(i),o=Math.ceil(o),t=t.map((t=>[t,e(t)])).filter((e=>i<=e[1]&&e[1]<=o)).sort(a).map((e=>e[0]))}(e,e.bins):e.ticks?e.ticks(t):e.domain()}function Zye(e,t,n){const r=Jye(e,t),i=e.base(),o=Math.log(i),a=Math.max(1,i*t/r.length),s=e=>{let t=e/Math.pow(i,Math.round(Math.log(e)/o));return t*i<i-.5&&(t*=i),t<=a};return n?r.filter(s):s}const Qye={[Sye]:"quantiles",[Cye]:"thresholds",[Mye]:"domain"},ebe={[Sye]:"quantiles",[Cye]:"domain"};const tbe=e=>Qye[e.type]||e.bins;function nbe(e,t,n,r,i,o,a){const s=ebe[t.type]&&o!==xye&&o!==_ye?function(e,t,n){const r=t[ebe[t.type]](),i=r.length;let o,a=i>1?r[1]-r[0]:r[0];for(o=1;o<i;++o)a=Math.min(a,r[o]-r[o-1]);return e.formatSpan(0,a,30,n)}(e,t,i):function(e,t,n,r,i,o){const a=t.type;let s=Xye;if(a===xye||i===xye)s=e.timeFormat(r);else if(a===_ye||i===_ye)s=e.utcFormat(r);else if(function(e){return $ye(e,mye)}(a)){const i=e.formatFloat(r);if(o||t.bins)s=i;else{const e=Zye(t,n,!1);s=t=>e(t)?i(t):""}}else if(t.tickFormat){const i=t.domain();s=e.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=e.format(r));return s}(e,t,n,i,o,a);return r===Hye&&tbe(t)?rbe(s):r===qye?obe(s):abe(s)}const rbe=e=>(t,n,r)=>{const i=ibe(r[n+1],ibe(r.max,1/0)),o=sbe(t,e),a=sbe(i,e);return o&&a?o+"  "+a:a?"< "+a:" "+o},ibe=(e,t)=>null!=e?e:t,obe=e=>(t,n)=>n?e(t):null,abe=e=>t=>e(t),sbe=(e,t)=>Number.isFinite(e)?t(e):null;function ube(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=function(e,t,n,r){const i=r||t.type;return Ile(n)&&function(e){return $ye(e,Oye)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==xye?n||i!==_ye?nbe(e,t,5,null,n,r,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}(e,t,n.format,n.formatType);if(function(e){return $ye(e,Aye)}(t.type)){const e=function(e,t){return e.bins?function(e){const t=e.slice(0,-1);return t.max=ble(e),t}(e.bins):e.type===mye?Zye(e,t,!0):Qye[e.type]?function(e){const t=[-1/0].concat(e);return t.max=1/0,t}(e[Qye[e.type]]()):Jye(e,t)}(t).slice(1).map(i),n=e.length;return`${n} boundar${1===n?"y":"ies"}: ${e.join(", ")}`}if(zye(t.type)){const e=t.domain(),n=e.length;return`${n} value${1===n?"":"s"}: ${n>r?e.slice(0,r-2).map(i).join(", ")+", ending with "+e.slice(-1).map(i):e.map(i).join(", ")}`}{const e=t.domain();return`values from ${i(e[0])} to ${i(ble(e))}`}}function lbe(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function cbe(e){this._context=e}function pbe(){}function dbe(e){this._context=e}function hbe(e){this._context=e}function fbe(e,t){this._basis=new cbe(e),this._beta=t}cbe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:lbe(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:lbe(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},dbe.prototype={areaStart:pbe,areaEnd:pbe,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:lbe(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},hbe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:lbe(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},fbe.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,i=e[0],o=t[0],a=e[n]-i,s=t[n]-o,u=-1;++u<=n;)r=u/n,this._basis.point(this._beta*e[u]+(1-this._beta)*(i+r*a),this._beta*t[u]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const gbe=function e(t){function n(e){return 1===t?new cbe(e):new fbe(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function mbe(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function ybe(e,t){this._context=e,this._k=(1-t)/6}ybe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:mbe(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:mbe(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const bbe=function e(t){function n(e){return new ybe(e,t)}return n.tension=function(t){return e(+t)},n}(0);function vbe(e,t){this._context=e,this._k=(1-t)/6}vbe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:mbe(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const xbe=function e(t){function n(e){return new vbe(e,t)}return n.tension=function(t){return e(+t)},n}(0);function _be(e,t){this._context=e,this._k=(1-t)/6}_be.prototype={areaStart:pbe,areaEnd:pbe,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:mbe(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const wbe=function e(t){function n(e){return new _be(e,t)}return n.tension=function(t){return e(+t)},n}(0),kbe=Math.abs,Sbe=Math.atan2,Cbe=Math.cos,Mbe=Math.max,Tbe=Math.min,Ebe=Math.sin,Abe=Math.sqrt,Fbe=1e-12,Obe=Math.PI,Rbe=Obe/2,Nbe=2*Obe;function Dbe(e){return e>=1?Rbe:e<=-1?-Rbe:Math.asin(e)}function Ibe(e,t,n){var r=e._x1,i=e._y1,o=e._x2,a=e._y2;if(e._l01_a>Fbe){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>Fbe){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,a,e._x2,e._y2)}function Bbe(e,t){this._context=e,this._alpha=t}Bbe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Ibe(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Lbe=function e(t){function n(e){return t?new Bbe(e,t):new ybe(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Pbe(e,t){this._context=e,this._alpha=t}Pbe.prototype={areaStart:pbe,areaEnd:pbe,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Ibe(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const $be=function e(t){function n(e){return t?new Pbe(e,t):new _be(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function zbe(e,t){this._context=e,this._alpha=t}zbe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ibe(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const jbe=function e(t){function n(e){return t?new zbe(e,t):new vbe(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Gbe(e){this._context=e}function Ube(e){return new Gbe(e)}function Wbe(e){this._context=e}function Vbe(e){return e<0?-1:1}function Hbe(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(Vbe(o)+Vbe(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function qbe(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Xbe(e,t,n){var r=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,i+s*t,o-s,a-s*n,o,a)}function Ybe(e){this._context=e}function Kbe(e){this._context=new Jbe(e)}function Jbe(e){this._context=e}function Zbe(e){this._context=e}function Qbe(e){var t,n,r=e.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/o[t-1],o[t]-=n,a[t]-=n*a[t-1];for(i[r-1]=a[r-1]/o[r-1],t=r-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function eve(e,t){this._context=e,this._t=t}function tve(e){return function(){return e}}Gbe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},Wbe.prototype={areaStart:pbe,areaEnd:pbe,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},Ybe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Xbe(this,this._t0,qbe(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Xbe(this,qbe(this,n=Hbe(this,e,t)),n);break;default:Xbe(this,this._t0,n=Hbe(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(Kbe.prototype=Object.create(Ybe.prototype)).point=function(e,t){Ybe.prototype.point.call(this,t,e)},Jbe.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}},Zbe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=Qbe(e),i=Qbe(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[a],t[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},eve.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};const nve=Math.PI,rve=2*nve,ive=1e-6,ove=rve-ive;function ave(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class sve{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?ave:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return ave;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,n,r){this._append`Q${+e},${+t},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(e,t,n,r,i,o){this._append`C${+e},${+t},${+n},${+r},${this._x1=+i},${this._y1=+o}`}arcTo(e,t,n,r,i){if(e=+e,t=+t,n=+n,r=+r,(i=+i)<0)throw new Error(`negative radius: ${i}`);let o=this._x1,a=this._y1,s=n-e,u=r-t,l=o-e,c=a-t,p=l*l+c*c;if(null===this._x1)this._append`M${this._x1=e},${this._y1=t}`;else if(p>ive)if(Math.abs(c*s-u*l)>ive&&i){let d=n-o,h=r-a,f=s*s+u*u,g=d*d+h*h,m=Math.sqrt(f),y=Math.sqrt(p),b=i*Math.tan((nve-Math.acos((f+p-g)/(2*m*y)))/2),v=b/y,x=b/m;Math.abs(v-1)>ive&&this._append`L${e+v*l},${t+v*c}`,this._append`A${i},${i},0,0,${+(c*d>l*h)},${this._x1=e+x*s},${this._y1=t+x*u}`}else this._append`L${this._x1=e},${this._y1=t}`}arc(e,t,n,r,i,o){if(e=+e,t=+t,o=!!o,(n=+n)<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(r),s=n*Math.sin(r),u=e+a,l=t+s,c=1^o,p=o?r-i:i-r;null===this._x1?this._append`M${u},${l}`:(Math.abs(this._x1-u)>ive||Math.abs(this._y1-l)>ive)&&this._append`L${u},${l}`,n&&(p<0&&(p=p%rve+rve),p>ove?this._append`A${n},${n},0,1,${c},${e-a},${t-s}A${n},${n},0,1,${c},${this._x1=u},${this._y1=l}`:p>ive&&this._append`A${n},${n},0,${+(p>=nve)},${c},${this._x1=e+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(e,t,n,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function uve(){return new sve}function lve(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError(`invalid digits: ${n}`);t=e}return e},()=>new sve(t)}function cve(e){return e.innerRadius}function pve(e){return e.outerRadius}function dve(e){return e.startAngle}function hve(e){return e.endAngle}function fve(e){return e&&e.padAngle}function gve(e,t,n,r,i,o,a){var s=e-n,u=t-r,l=(a?o:-o)/Abe(s*s+u*u),c=l*u,p=-l*s,d=e+c,h=t+p,f=n+c,g=r+p,m=(d+f)/2,y=(h+g)/2,b=f-d,v=g-h,x=b*b+v*v,_=i-o,w=d*g-f*h,k=(v<0?-1:1)*Abe(Mbe(0,_*_*x-w*w)),S=(w*v-b*k)/x,C=(-w*b-v*k)/x,M=(w*v+b*k)/x,T=(-w*b+v*k)/x,E=S-m,A=C-y,F=M-m,O=T-y;return E*E+A*A>F*F+O*O&&(S=M,C=T),{cx:S,cy:C,x01:-c,y01:-p,x11:S*(i/_-1),y11:C*(i/_-1)}}function mve(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function yve(e){return e[0]}function bve(e){return e[1]}function vve(e,t){var n=tve(!0),r=null,i=Ube,o=null,a=lve(s);function s(s){var u,l,c,p=(s=mve(s)).length,d=!1;for(null==r&&(o=i(c=a())),u=0;u<=p;++u)!(u<p&&n(l=s[u],u,s))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+e(l,u,s),+t(l,u,s));if(c)return o=null,c+""||null}return e="function"==typeof e?e:void 0===e?yve:tve(e),t="function"==typeof t?t:void 0===t?bve:tve(t),s.x=function(t){return arguments.length?(e="function"==typeof t?t:tve(+t),s):e},s.y=function(e){return arguments.length?(t="function"==typeof e?e:tve(+e),s):t},s.defined=function(e){return arguments.length?(n="function"==typeof e?e:tve(!!e),s):n},s.curve=function(e){return arguments.length?(i=e,null!=r&&(o=i(r)),s):i},s.context=function(e){return arguments.length?(null==e?r=o=null:o=i(r=e),s):r},s}function xve(e,t,n){var r=null,i=tve(!0),o=null,a=Ube,s=null,u=lve(l);function l(l){var c,p,d,h,f,g=(l=mve(l)).length,m=!1,y=new Array(g),b=new Array(g);for(null==o&&(s=a(f=u())),c=0;c<=g;++c){if(!(c<g&&i(h=l[c],c,l))===m)if(m=!m)p=c,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=c-1;d>=p;--d)s.point(y[d],b[d]);s.lineEnd(),s.areaEnd()}m&&(y[c]=+e(h,c,l),b[c]=+t(h,c,l),s.point(r?+r(h,c,l):y[c],n?+n(h,c,l):b[c]))}if(f)return s=null,f+""||null}function c(){return vve().defined(i).curve(a).context(o)}return e="function"==typeof e?e:void 0===e?yve:tve(+e),t="function"==typeof t?t:tve(void 0===t?0:+t),n="function"==typeof n?n:void 0===n?bve:tve(+n),l.x=function(t){return arguments.length?(e="function"==typeof t?t:tve(+t),r=null,l):e},l.x0=function(t){return arguments.length?(e="function"==typeof t?t:tve(+t),l):e},l.x1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:tve(+e),l):r},l.y=function(e){return arguments.length?(t="function"==typeof e?e:tve(+e),n=null,l):t},l.y0=function(e){return arguments.length?(t="function"==typeof e?e:tve(+e),l):t},l.y1=function(e){return arguments.length?(n=null==e?null:"function"==typeof e?e:tve(+e),l):n},l.lineX0=l.lineY0=function(){return c().x(e).y(t)},l.lineY1=function(){return c().x(e).y(n)},l.lineX1=function(){return c().x(r).y(t)},l.defined=function(e){return arguments.length?(i="function"==typeof e?e:tve(!!e),l):i},l.curve=function(e){return arguments.length?(a=e,null!=o&&(s=a(o)),l):a},l.context=function(e){return arguments.length?(null==e?o=s=null:s=a(o=e),l):o},l}uve.prototype=sve.prototype,Array.prototype.slice,Abe(3);const _ve={draw(e,t){const n=Abe(t/Obe);e.moveTo(n,0),e.arc(0,0,n,0,Nbe)}};Abe(1/3),Ebe(Obe/10),Ebe(7*Obe/10);Ebe(Nbe/10),Cbe(Nbe/10),Abe(3),Abe(3),Abe(3),Abe(12);var wve={},kve={},Sve=34,Cve=10,Mve=13;function Tve(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function Eve(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function Ave(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function Fve(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,i=[],o=e.length,a=0,s=0,u=o<=0,l=!1;function c(){if(u)return kve;if(l)return l=!1,wve;var t,r,i=a;if(e.charCodeAt(i)===Sve){for(;a++<o&&e.charCodeAt(a)!==Sve||e.charCodeAt(++a)===Sve;);return(t=a)>=o?u=!0:(r=e.charCodeAt(a++))===Cve?l=!0:r===Mve&&(l=!0,e.charCodeAt(a)===Cve&&++a),e.slice(i+1,t-1).replace(/""/g,'"')}for(;a<o;){if((r=e.charCodeAt(t=a++))===Cve)l=!0;else if(r===Mve)l=!0,e.charCodeAt(a)===Cve&&++a;else if(r!==n)continue;return e.slice(i,t)}return u=!0,e.slice(i,o)}for(e.charCodeAt(o-1)===Cve&&--o,e.charCodeAt(o-1)===Mve&&--o;(r=c())!==kve;){for(var p=[];r!==wve&&r!==kve;)p.push(r),r=c();t&&null==(p=t(p,s++))||i.push(p)}return i}function i(t,n){return t.map((function(t){return n.map((function(e){return a(t[e])})).join(e)}))}function o(t){return t.map(a).join(e)}function a(e){return null==e?"":e instanceof Date?function(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":function(e){return e<0?"-"+Ave(-e,6):e>9999?"+"+Ave(e,6):Ave(e,4)}(e.getUTCFullYear())+"-"+Ave(e.getUTCMonth()+1,2)+"-"+Ave(e.getUTCDate(),2)+(i?"T"+Ave(t,2)+":"+Ave(n,2)+":"+Ave(r,2)+"."+Ave(i,3)+"Z":r?"T"+Ave(t,2)+":"+Ave(n,2)+":"+Ave(r,2)+"Z":n||t?"T"+Ave(t,2)+":"+Ave(n,2)+"Z":"")}(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,i,o=r(e,(function(e,r){if(n)return n(e,r-1);i=e,n=t?function(e,t){var n=Tve(e);return function(r,i){return t(n(r),i,e)}}(e,t):Tve(e)}));return o.columns=i||[],o},parseRows:r,format:function(t,n){return null==n&&(n=Eve(t)),[n.map(a).join(e)].concat(i(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=Eve(e)),i(e,t).join("\n")},formatRows:function(e){return e.map(o).join("\n")},formatRow:o,formatValue:a}}const Ove=Math.sqrt(50),Rve=Math.sqrt(10),Nve=Math.sqrt(2);function Dve(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=Ove?10:o>=Rve?5:o>=Nve?2:1;let s,u,l;return i<0?(l=Math.pow(10,-i)/a,s=Math.round(e*l),u=Math.round(t*l),s/l<e&&++s,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*a,s=Math.round(e/l),u=Math.round(t/l),s*l<e&&++s,u*l>t&&--u),u<s&&.5<=n&&n<2?Dve(e,t,2*n):[s,u,l]}function Ive(e,t,n){return Dve(e=+e,t=+t,n=+n)[2]}function Bve(e){const t={};return n=>t[n]||(t[n]=e(n))}let Lve,Pve;function $ve(e,t,n){yle(n=n||{})||dle(`Invalid time multi-format specifier: ${n}`);const r=t(nye),i=t(tye),o=t(eye),a=t(Jme),s=t(Kme),u=t(Yme),l=t(Xme),c=t(qme),p=e(n[rye]||".%L"),d=e(n[nye]||":%S"),h=e(n[tye]||"%I:%M"),f=e(n[eye]||"%I %p"),g=e(n[Jme]||n[Zme]||"%a %d"),m=e(n[Kme]||"%b %d"),y=e(n[Yme]||"%B"),b=e(n[Xme]||"%B"),v=e(n[qme]||"%Y");return e=>(r(e)<e?p:i(e)<e?d:o(e)<e?h:a(e)<e?f:u(e)<e?s(e)<e?g:m:c(e)<e?l(e)<e?y:b:v)(e)}Lve=function(e){const t=Bve(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(e){const n=Bde(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let o=function(e,t){let n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if(n=e.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const a=o<r.length?r.slice(o):"";for(;--o>i;)if("0"!==r[o]){++o;break}return r.slice(0,o)+a}}(t(n),t(".1f")(1)[1])}return t(n)},formatSpan(e,r,i,o){o=Bde(null==o?",f":o);const a=function(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?Ive(t,e,n):Ive(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}(e,r,i),s=Math.max(Math.abs(e),Math.abs(r));let u;if(null==o.precision)switch(o.type){case"s":return isNaN(u=zde(a,s))||(o.precision=u),n(o,s);case"":case"e":case"g":case"p":case"r":isNaN(u=Yde(a,s))||(o.precision=u-("e"===o.type));break;case"f":case"%":isNaN(u=Kde(a))||(o.precision=u-2*("%"===o.type))}return t(o)}}}({format:Vde,formatPrefix:Hde}),Pve=function(e){const t=Bve(e.format),n=Bve(e.utcFormat);return{timeFormat:e=>Ile(e)?t(e):$ve(t,cye,e),utcFormat:e=>Ile(e)?n(e):$ve(n,pye,e),timeParse:Bve(e.parse),utcParse:Bve(e.utcParse)}}({format:yfe,parse:bfe,utcFormat:vfe,utcParse:xfe});const zve=/^(data:|([A-Za-z]+:)?\/\/)/,jve=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Gve=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Uve="file://";async function Wve(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function Vve(e,t){t=Ale({},this.options,t);const n=this.fileAccess,r={href:null};let i,o,a;const s=jve.test(e.replace(Gve,""));null!=e&&"string"==typeof e&&s||dle("Sanitize failure, invalid URI: "+Lle(e));const u=zve.test(e);return(a=t.baseURL)&&!u&&(e.startsWith("/")||a.endsWith("/")||(e="/"+e),e=a+e),o=(i=e.startsWith(Uve))||"file"===t.mode||"http"!==t.mode&&!u&&n,i?e=e.slice(7):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),"image"===t.context&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function Hve(e){return e?t=>new Promise(((n,r)=>{e.readFile(t,((e,t)=>{e?r(e):n(t)}))})):qve}async function qve(){dle("No file system access.")}function Xve(e){return e?async function(t,n){const r=Ale({},this.options.http,n),i=n&&n.response,o=await e(t,r);return o.ok?Ele(o[i])?o[i]():o.text():dle(o.status+""+o.statusText)}:Yve}async function Yve(){dle("No HTTP fetch method available.")}function Kve(e){const t=function(t,n){const r={delimiter:e};return Jve(t,n?Ale(n,r):r)};return t.responseType="text",t}function Jve(e,t){return t.header&&(e=t.header.map(Lle).join(t.delimiter)+"\n"+e),Fve(t.delimiter).parse(e+"")}function Zve(e,t){const n=t&&t.property?hle(t.property):fle;return!yle(e)||(r=e,"function"==typeof Buffer&&Ele(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(e)):function(e,t){return!mle(e)&&function(e){return e&&Ele(e[Symbol.iterator])}(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}(n(e),t);var r}Jve.responseType="text",Zve.responseType="json";Kve(","),Kve("\t");const Qve=function(e,t){return t=>({options:t||{},sanitize:Vve,load:Wve,fileAccess:!1,file:Hve(null),http:Xve(e)})}("undefined"!=typeof fetch&&fetch);let exe=0;const txe="p_";function nxe(e){return e&&e.gradient}function rxe(e,t,n){const r=e.gradient;let i=e.id,o="radial"===r?txe:"";return i||(i=e.id="gradient_"+exe++,"radial"===r?(e.x1=ixe(e.x1,.5),e.y1=ixe(e.y1,.5),e.r1=ixe(e.r1,0),e.x2=ixe(e.x2,.5),e.y2=ixe(e.y2,.5),e.r2=ixe(e.r2,.5),o=txe):(e.x1=ixe(e.x1,0),e.y1=ixe(e.y1,0),e.x2=ixe(e.x2,1),e.y2=ixe(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function ixe(e,t){return null!=e?e:t}const oxe={basis:{curve:function(e){return new cbe(e)}},"basis-closed":{curve:function(e){return new dbe(e)}},"basis-open":{curve:function(e){return new hbe(e)}},bundle:{curve:gbe,tension:"beta",value:.85},cardinal:{curve:bbe,tension:"tension",value:0},"cardinal-open":{curve:xbe,tension:"tension",value:0},"cardinal-closed":{curve:wbe,tension:"tension",value:0},"catmull-rom":{curve:Lbe,tension:"alpha",value:.5},"catmull-rom-closed":{curve:$be,tension:"alpha",value:.5},"catmull-rom-open":{curve:jbe,tension:"alpha",value:.5},linear:{curve:Ube},"linear-closed":{curve:function(e){return new Wbe(e)}},monotone:{horizontal:function(e){return new Kbe(e)},vertical:function(e){return new Ybe(e)}},natural:{curve:function(e){return new Zbe(e)}},step:{curve:function(e){return new eve(e,.5)}},"step-after":{curve:function(e){return new eve(e,1)}},"step-before":{curve:function(e){return new eve(e,0)}}};function axe(e,t,n){var r=Ole(oxe,e)&&oxe[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const sxe={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},uxe=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,lxe=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,cxe=/^((\s+,?\s*)|(,\s*))/,pxe=/^[01]/;function dxe(e){const t=[];return(e.match(uxe)||[]).forEach((e=>{let n=e[0];const r=n.toLowerCase(),i=sxe[r],o=function(e,t,n){const r=[];for(let i=0;t&&i<n.length;)for(let o=0;o<t;++o){const t="a"!==e||3!==o&&4!==o?lxe:pxe,a=n.slice(i).match(t);if(null===a)throw Error("Invalid SVG path, incorrect parameter type");i+=a[0].length,r.push(+a[0]);const s=n.slice(i).match(cxe);null!==s&&(i+=s[0].length)}return r}(r,i,e.slice(1).trim()),a=o.length;if(a<i||a&&a%i!=0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([n,...o.slice(0,i)]),a!==i){"m"===r&&(n="M"===n?"L":"l");for(let e=i;e<a;e+=i)t.push([n,...o.slice(e,e+i)])}})),t}const hxe=Math.PI/180,fxe=Math.PI/2,gxe=2*Math.PI,mxe=Math.sqrt(3)/2;var yxe={},bxe={},vxe=[].join;function xxe(e){const t=vxe.call(e);if(bxe[t])return bxe[t];var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7];const c=l*a,p=-u*s,d=u*a,h=l*s,f=Math.cos(i),g=Math.sin(i),m=Math.cos(o),y=Math.sin(o),b=.5*(o-i),v=Math.sin(.5*b),x=8/3*v*v/Math.sin(b),_=n+f-x*g,w=r+g+x*f,k=n+m,S=r+y,C=k+x*y,M=S-x*m;return bxe[t]=[c*_+p*w,d*_+h*w,c*C+p*M,d*C+h*M,c*k+p*S,d*k+h*S]}const _xe=["l",0,0,0,0,0,0,0];function wxe(e,t,n){const r=_xe[0]=e[0];if("a"===r||"A"===r)_xe[1]=t*e[1],_xe[2]=n*e[2],_xe[3]=e[3],_xe[4]=e[4],_xe[5]=e[5],_xe[6]=t*e[6],_xe[7]=n*e[7];else if("h"===r||"H"===r)_xe[1]=t*e[1];else if("v"===r||"V"===r)_xe[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)_xe[i]=(i%2==1?t:n)*e[i];return _xe}function kxe(e,t,n,r,i,o){var a,s,u,l,c,p=null,d=0,h=0,f=0,g=0,m=0,y=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==o&&(o=i),e.beginPath&&e.beginPath();for(var b=0,v=t.length;b<v;++b){switch(a=t[b],1===i&&1===o||(a=wxe(a,i,o)),a[0]){case"l":d+=a[1],h+=a[2],e.lineTo(d+n,h+r);break;case"L":d=a[1],h=a[2],e.lineTo(d+n,h+r);break;case"h":d+=a[1],e.lineTo(d+n,h+r);break;case"H":d=a[1],e.lineTo(d+n,h+r);break;case"v":h+=a[1],e.lineTo(d+n,h+r);break;case"V":h=a[1],e.lineTo(d+n,h+r);break;case"m":m=d+=a[1],y=h+=a[2],e.moveTo(d+n,h+r);break;case"M":m=d=a[1],y=h=a[2],e.moveTo(d+n,h+r);break;case"c":s=d+a[5],u=h+a[6],f=d+a[3],g=h+a[4],e.bezierCurveTo(d+a[1]+n,h+a[2]+r,f+n,g+r,s+n,u+r),d=s,h=u;break;case"C":d=a[5],h=a[6],f=a[3],g=a[4],e.bezierCurveTo(a[1]+n,a[2]+r,f+n,g+r,d+n,h+r);break;case"s":s=d+a[3],u=h+a[4],f=2*d-f,g=2*h-g,e.bezierCurveTo(f+n,g+r,d+a[1]+n,h+a[2]+r,s+n,u+r),f=d+a[1],g=h+a[2],d=s,h=u;break;case"S":s=a[3],u=a[4],f=2*d-f,g=2*h-g,e.bezierCurveTo(f+n,g+r,a[1]+n,a[2]+r,s+n,u+r),d=s,h=u,f=a[1],g=a[2];break;case"q":s=d+a[3],u=h+a[4],f=d+a[1],g=h+a[2],e.quadraticCurveTo(f+n,g+r,s+n,u+r),d=s,h=u;break;case"Q":s=a[3],u=a[4],e.quadraticCurveTo(a[1]+n,a[2]+r,s+n,u+r),d=s,h=u,f=a[1],g=a[2];break;case"t":s=d+a[1],u=h+a[2],null===p[0].match(/[QqTt]/)?(f=d,g=h):"t"===p[0]?(f=2*d-l,g=2*h-c):"q"===p[0]&&(f=2*d-f,g=2*h-g),l=f,c=g,e.quadraticCurveTo(f+n,g+r,s+n,u+r),h=u,f=(d=s)+a[1],g=h+a[2];break;case"T":s=a[1],u=a[2],f=2*d-f,g=2*h-g,e.quadraticCurveTo(f+n,g+r,s+n,u+r),d=s,h=u;break;case"a":Sxe(e,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+d+n,a[7]+h+r]),d+=a[6],h+=a[7];break;case"A":Sxe(e,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),d=a[6],h=a[7];break;case"z":case"Z":d=m,h=y,e.closePath()}p=a}}function Sxe(e,t,n,r){const i=function(e,t,n,r,i,o,a,s,u){const l=vxe.call(arguments);if(yxe[l])return yxe[l];const c=a*hxe,p=Math.sin(c),d=Math.cos(c),h=d*(s-e)*.5+p*(u-t)*.5,f=d*(u-t)*.5-p*(s-e)*.5;let g=h*h/((n=Math.abs(n))*n)+f*f/((r=Math.abs(r))*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,y=p/n,b=-p/r,v=d/r,x=m*s+y*u,_=b*s+v*u,w=m*e+y*t,k=b*e+v*t;let S=1/((w-x)*(w-x)+(k-_)*(k-_))-.25;S<0&&(S=0);let C=Math.sqrt(S);o==i&&(C=-C);const M=.5*(x+w)-C*(k-_),T=.5*(_+k)+C*(w-x),E=Math.atan2(_-T,x-M);let A=Math.atan2(k-T,w-M)-E;A<0&&1===o?A+=gxe:A>0&&0===o&&(A-=gxe);const F=Math.ceil(Math.abs(A/(fxe+.001))),O=[];for(let e=0;e<F;++e){const t=E+e*A/F,i=E+(e+1)*A/F;O[e]=[M,T,t,i,n,r,p,d]}return yxe[l]=O}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let t=0;t<i.length;++t){const n=xxe(i[t]);e.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5])}}const Cxe=.5773502691896257,Mxe={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,gxe)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=mxe*n,i=r-n*Cxe,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=mxe*n,i=r-n*Cxe;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=mxe*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=mxe*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=mxe*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=mxe*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};var Txe={};const Exe=.448084975506;function Axe(e){return e.x}function Fxe(e){return e.y}function Oxe(e){return e.width}function Rxe(e){return e.height}function Nxe(e){return"function"==typeof e?e:()=>+e}function Dxe(e,t,n){return Math.max(t,Math.min(e,n))}function Ixe(e,t){return null!=e?e:t}const Bxe=e=>e.x||0,Lxe=e=>e.y||0,Pxe=e=>!(!1===e.defined),$xe=function(){var e=cve,t=pve,n=tve(0),r=null,i=dve,o=hve,a=fve,s=null,u=lve(l);function l(){var l,c,p=+e.apply(this,arguments),d=+t.apply(this,arguments),h=i.apply(this,arguments)-Rbe,f=o.apply(this,arguments)-Rbe,g=kbe(f-h),m=f>h;if(s||(s=l=u()),d<p&&(c=d,d=p,p=c),d>Fbe)if(g>Nbe-Fbe)s.moveTo(d*Cbe(h),d*Ebe(h)),s.arc(0,0,d,h,f,!m),p>Fbe&&(s.moveTo(p*Cbe(f),p*Ebe(f)),s.arc(0,0,p,f,h,m));else{var y,b,v=h,x=f,_=h,w=f,k=g,S=g,C=a.apply(this,arguments)/2,M=C>Fbe&&(r?+r.apply(this,arguments):Abe(p*p+d*d)),T=Tbe(kbe(d-p)/2,+n.apply(this,arguments)),E=T,A=T;if(M>Fbe){var F=Dbe(M/p*Ebe(C)),O=Dbe(M/d*Ebe(C));(k-=2*F)>Fbe?(_+=F*=m?1:-1,w-=F):(k=0,_=w=(h+f)/2),(S-=2*O)>Fbe?(v+=O*=m?1:-1,x-=O):(S=0,v=x=(h+f)/2)}var R=d*Cbe(v),N=d*Ebe(v),D=p*Cbe(w),I=p*Ebe(w);if(T>Fbe){var B,L=d*Cbe(x),P=d*Ebe(x),$=p*Cbe(_),z=p*Ebe(_);if(g<Obe)if(B=function(e,t,n,r,i,o,a,s){var u=n-e,l=r-t,c=a-i,p=s-o,d=p*u-c*l;if(!(d*d<Fbe))return[e+(d=(c*(t-o)-p*(e-i))/d)*u,t+d*l]}(R,N,$,z,L,P,D,I)){var j=R-B[0],G=N-B[1],U=L-B[0],W=P-B[1],V=1/Ebe(function(e){return e>1?0:e<-1?Obe:Math.acos(e)}((j*U+G*W)/(Abe(j*j+G*G)*Abe(U*U+W*W)))/2),H=Abe(B[0]*B[0]+B[1]*B[1]);E=Tbe(T,(p-H)/(V-1)),A=Tbe(T,(d-H)/(V+1))}else E=A=0}S>Fbe?A>Fbe?(y=gve($,z,R,N,d,A,m),b=gve(L,P,D,I,d,A,m),s.moveTo(y.cx+y.x01,y.cy+y.y01),A<T?s.arc(y.cx,y.cy,A,Sbe(y.y01,y.x01),Sbe(b.y01,b.x01),!m):(s.arc(y.cx,y.cy,A,Sbe(y.y01,y.x01),Sbe(y.y11,y.x11),!m),s.arc(0,0,d,Sbe(y.cy+y.y11,y.cx+y.x11),Sbe(b.cy+b.y11,b.cx+b.x11),!m),s.arc(b.cx,b.cy,A,Sbe(b.y11,b.x11),Sbe(b.y01,b.x01),!m))):(s.moveTo(R,N),s.arc(0,0,d,v,x,!m)):s.moveTo(R,N),p>Fbe&&k>Fbe?E>Fbe?(y=gve(D,I,L,P,p,-E,m),b=gve(R,N,$,z,p,-E,m),s.lineTo(y.cx+y.x01,y.cy+y.y01),E<T?s.arc(y.cx,y.cy,E,Sbe(y.y01,y.x01),Sbe(b.y01,b.x01),!m):(s.arc(y.cx,y.cy,E,Sbe(y.y01,y.x01),Sbe(y.y11,y.x11),!m),s.arc(0,0,p,Sbe(y.cy+y.y11,y.cx+y.x11),Sbe(b.cy+b.y11,b.cx+b.x11),m),s.arc(b.cx,b.cy,E,Sbe(b.y11,b.x11),Sbe(b.y01,b.x01),!m))):s.arc(0,0,p,w,_,m):s.lineTo(D,I)}else s.moveTo(0,0);if(s.closePath(),l)return s=null,l+""||null}return l.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-Obe/2;return[Cbe(r)*n,Ebe(r)*n]},l.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:tve(+t),l):e},l.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:tve(+e),l):t},l.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:tve(+e),l):n},l.padRadius=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:tve(+e),l):r},l.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:tve(+e),l):i},l.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:tve(+e),l):o},l.padAngle=function(e){return arguments.length?(a="function"==typeof e?e:tve(+e),l):a},l.context=function(e){return arguments.length?(s=null==e?null:e,l):s},l}().startAngle((e=>e.startAngle||0)).endAngle((e=>e.endAngle||0)).padAngle((e=>e.padAngle||0)).innerRadius((e=>e.innerRadius||0)).outerRadius((e=>e.outerRadius||0)).cornerRadius((e=>e.cornerRadius||0)),zxe=xve().x(Bxe).y1(Lxe).y0((e=>(e.y||0)+(e.height||0))).defined(Pxe),jxe=xve().y(Lxe).x1(Bxe).x0((e=>(e.x||0)+(e.width||0))).defined(Pxe),Gxe=vve().x(Bxe).y(Lxe).defined(Pxe),Uxe=function(){var e=Axe,t=Fxe,n=Oxe,r=Rxe,i=Nxe(0),o=i,a=i,s=i,u=null;function l(l,c,p){var d,h=null!=c?c:+e.call(this,l),f=null!=p?p:+t.call(this,l),g=+n.call(this,l),m=+r.call(this,l),y=Math.min(g,m)/2,b=Dxe(+i.call(this,l),0,y),v=Dxe(+o.call(this,l),0,y),x=Dxe(+a.call(this,l),0,y),_=Dxe(+s.call(this,l),0,y);if(u||(u=d=uve()),b<=0&&v<=0&&x<=0&&_<=0)u.rect(h,f,g,m);else{var w=h+g,k=f+m;u.moveTo(h+b,f),u.lineTo(w-v,f),u.bezierCurveTo(w-Exe*v,f,w,f+Exe*v,w,f+v),u.lineTo(w,k-_),u.bezierCurveTo(w,k-Exe*_,w-Exe*_,k,w-_,k),u.lineTo(h+x,k),u.bezierCurveTo(h+Exe*x,k,h,k-Exe*x,h,k-x),u.lineTo(h,f+b),u.bezierCurveTo(h,f+Exe*b,h+Exe*b,f,h+b,f),u.closePath()}if(d)return u=null,d+""||null}return l.x=function(t){return arguments.length?(e=Nxe(t),l):e},l.y=function(e){return arguments.length?(t=Nxe(e),l):t},l.width=function(e){return arguments.length?(n=Nxe(e),l):n},l.height=function(e){return arguments.length?(r=Nxe(e),l):r},l.cornerRadius=function(e,t,n,r){return arguments.length?(i=Nxe(e),o=null!=t?Nxe(t):i,s=null!=n?Nxe(n):i,a=null!=r?Nxe(r):o,l):i},l.context=function(e){return arguments.length?(u=null==e?null:e,l):u},l}().x(Bxe).y(Lxe).width((e=>e.width||0)).height((e=>e.height||0)).cornerRadius((e=>Ixe(e.cornerRadiusTopLeft,e.cornerRadius)||0),(e=>Ixe(e.cornerRadiusTopRight,e.cornerRadius)||0),(e=>Ixe(e.cornerRadiusBottomRight,e.cornerRadius)||0),(e=>Ixe(e.cornerRadiusBottomLeft,e.cornerRadius)||0)),Wxe=function(e,t){let n=null,r=lve(i);function i(){let i;if(n||(n=i=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return e="function"==typeof e?e:tve(e||_ve),t="function"==typeof t?t:tve(void 0===t?64:+t),i.type=function(t){return arguments.length?(e="function"==typeof t?t:tve(t),i):e},i.size=function(e){return arguments.length?(t="function"==typeof e?e:tve(+e),i):t},i.context=function(e){return arguments.length?(n=null==e?null:e,i):n},i}().type((e=>{return t=e.shape||"circle",Ole(Mxe,t)?Mxe[t]:function(e){if(!Ole(Txe,e)){const t=dxe(e);Txe[e]={draw:function(e,n){kxe(e,t,0,0,Math.sqrt(n)/2)}}}return Txe[e]}(t);var t})).size((e=>Ixe(e.size,64))),Vxe=function(){var e,t,n,r,i,o,a,s,u=null;function l(e,t,n){const r=n/2;if(i){var l=a-t,c=e-o;if(l||c){var p=Math.sqrt(l*l+c*c),d=(l/=p)*s,h=(c/=p)*s,f=Math.atan2(c,l);u.moveTo(o-d,a-h),u.lineTo(e-l*r,t-c*r),u.arc(e,t,r,f-Math.PI,f),u.lineTo(o+d,a+h),u.arc(o,a,s,f,f+Math.PI)}else u.arc(e,t,r,0,gxe);u.closePath()}else i=1;o=e,a=t,s=r}function c(o){var a,s,c,p=o.length,d=!1;for(null==u&&(u=c=uve()),a=0;a<=p;++a)!(a<p&&r(s=o[a],a,o))===d&&(d=!d)&&(i=0),d&&l(+e(s,a,o),+t(s,a,o),+n(s,a,o));if(c)return u=null,c+""||null}return c.x=function(t){return arguments.length?(e=t,c):e},c.y=function(e){return arguments.length?(t=e,c):t},c.size=function(e){return arguments.length?(n=e,c):n},c.defined=function(e){return arguments.length?(r=e,c):r},c.context=function(e){return arguments.length?(u=null==e?null:e,c):u},c}().x(Bxe).y(Lxe).defined(Pxe).size((e=>e.size||1));function Hxe(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function qxe(e,t,n,r){return Uxe.context(e)(t,n,r)}var Xxe=1;function Yxe(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+Xxe++),a=i.clipping[o]||(i.clipping[o]={id:o});return Ele(r)?a.path=r(null):Hxe(n)?a.path=qxe(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"}function Kxe(e){this.clear(),e&&this.union(e)}function Jxe(e){this.mark=e,this.bounds=this.bounds||new Kxe}function Zxe(e){this._pending=0,this._loader=e||Qve()}function Qxe(e){e._pending+=1}function e_e(e){e._pending-=1}function t_e(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){const r=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(r+(n?function(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,r):0))}return e}Kxe.prototype={clone(){return new Kxe(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:o,y2:a}=this,s=Math.cos(e),u=Math.sin(e),l=t-t*s+n*u,c=n-t*u-n*s;return[s*r-u*i+l,u*r+s*i+c,s*r-u*a+l,u*r+s*a+c,s*o-u*i+l,u*o+s*i+c,s*o-u*a+l,u*o+s*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},Rle((function(e){Jxe.call(this,e),this.items=this.items||[]}),Jxe),Zxe.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return Qxe(t),t._loader.sanitize(e,{context:"href"}).then((e=>(e_e(t),e))).catch((()=>(e_e(t),null)))},loadImage(e){const t=this,n=$d();return Qxe(t),t._loader.sanitize(e,{context:"image"}).then((e=>{const r=e.href;if(!r||!n)throw{url:r};const i=new n,o=Ole(e,"crossOrigin")?e.crossOrigin:"anonymous";return null!=o&&(i.crossOrigin=o),i.onload=()=>e_e(t),i.onerror=()=>e_e(t),i.src=r,i})).catch((e=>(e_e(t),{complete:!1,width:0,height:0,src:e&&e.url||""})))},ready(){const e=this;return new Promise((t=>{!function n(r){e.pending()?setTimeout((()=>{n(!0)}),10):t(r)}(!1)}))}};const n_e=gxe-1e-8;let r_e,i_e,o_e,a_e,s_e,u_e,l_e,c_e;const p_e=(e,t)=>r_e.add(e,t),d_e=(e,t)=>p_e(i_e=e,o_e=t),h_e=e=>p_e(e,r_e.y1),f_e=e=>p_e(r_e.x1,e),g_e=(e,t)=>s_e*e+l_e*t,m_e=(e,t)=>u_e*e+c_e*t,y_e=(e,t)=>p_e(g_e(e,t),m_e(e,t)),b_e=(e,t)=>d_e(g_e(e,t),m_e(e,t));function v_e(e,t){return r_e=e,t?(a_e=t*hxe,s_e=c_e=Math.cos(a_e),u_e=Math.sin(a_e),l_e=-u_e):(s_e=c_e=1,a_e=u_e=l_e=0),x_e}const x_e={beginPath(){},closePath(){},moveTo:b_e,lineTo:b_e,rect(e,t,n,r){a_e?(y_e(e+n,t),y_e(e+n,t+r),y_e(e,t+r),b_e(e,t)):(p_e(e+n,t+r),d_e(e,t))},quadraticCurveTo(e,t,n,r){const i=g_e(e,t),o=m_e(e,t),a=g_e(n,r),s=m_e(n,r);__e(i_e,i,a,h_e),__e(o_e,o,s,f_e),d_e(a,s)},bezierCurveTo(e,t,n,r,i,o){const a=g_e(e,t),s=m_e(e,t),u=g_e(n,r),l=m_e(n,r),c=g_e(i,o),p=m_e(i,o);w_e(i_e,a,u,c,h_e),w_e(o_e,s,l,p,f_e),d_e(c,p)},arc(e,t,n,r,i,o){if(r+=a_e,i+=a_e,i_e=n*Math.cos(i)+e,o_e=n*Math.sin(i)+t,Math.abs(i-r)>n_e)p_e(e-n,t-n),p_e(e+n,t+n);else{const a=r=>p_e(n*Math.cos(r)+e,n*Math.sin(r)+t);let s,u;if(a(r),a(i),i!==r)if((r%=gxe)<0&&(r+=gxe),(i%=gxe)<0&&(i+=gxe),i<r&&(o=!o,s=r,r=i,i=s),o)for(i-=gxe,s=r-r%fxe,u=0;u<4&&s>i;++u,s-=fxe)a(s);else for(s=r-r%fxe+fxe,u=0;u<4&&s<i;++u,s+=fxe)a(s)}}};function __e(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function w_e(e,t,n,r,i){const o=r-e+3*t-3*n,a=e+n-2*t,s=e-t;let u,l=0,c=0;Math.abs(o)>1e-14?(u=a*a+s*o,u>=0&&(u=Math.sqrt(u),l=(-a+u)/o,c=(-a-u)/o)):l=.5*s/a,0<l&&l<1&&i(k_e(l,e,t,n,r)),0<c&&c<1&&i(k_e(c,e,t,n,r))}function k_e(e,t,n,r,i){const o=1-e,a=o*o,s=e*e;return a*o*t+3*a*e*n+3*o*s*r+s*e*i}var S_e=(S_e=Pd(1,1))?S_e.getContext("2d"):null;const C_e=new Kxe;function M_e(e){return function(t,n){if(!S_e)return!0;e(S_e,t),C_e.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:a}=C_e;for(let e=i;e<=a;++e)for(let t=r;t<=o;++t)if(S_e.isPointInPath(t,e))return!0;return!1}}function T_e(e,t){return t.contains(e.x||0,e.y||0)}function E_e(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,o=e.height||0;return t.intersects(C_e.set(n,r,n+i,r+o))}function A_e(e,t,n,r,i){const{x1:o,y1:a,x2:s,y2:u}=e,l=r-t,c=i-n;let p,d,h,f,g=0,m=1;for(f=0;f<4;++f){if(0===f&&(p=-l,d=-(o-t)),1===f&&(p=l,d=s-t),2===f&&(p=-c,d=-(a-n)),3===f&&(p=c,d=u-n),Math.abs(p)<1e-10&&d<0)return!1;if(h=d/p,p<0){if(h>m)return!1;h>g&&(g=h)}else if(p>0){if(h<g)return!1;h<m&&(m=h)}}return!0}function F_e(e,t){e.globalCompositeOperation=t.blend||"source-over"}function O_e(e,t){return null==e?t:e}function R_e(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function N_e(e,t,n){return nxe(n)?function(e,t,n){const r=n.width(),i=n.height();let o;if("radial"===t.gradient)o=e.createRadialGradient(n.x1+O_e(t.x1,.5)*r,n.y1+O_e(t.y1,.5)*i,Math.max(r,i)*O_e(t.r1,0),n.x1+O_e(t.x2,.5)*r,n.y1+O_e(t.y2,.5)*i,Math.max(r,i)*O_e(t.r2,.5));else{const a=O_e(t.x1,0),s=O_e(t.y1,0),u=O_e(t.x2,1),l=O_e(t.y2,0);if(a!==u&&s!==l&&r!==i){const n=Pd(Math.ceil(r),Math.ceil(i)),o=n.getContext("2d");return o.scale(r,i),o.fillStyle=R_e(o.createLinearGradient(a,s,u,l),t.stops),o.fillRect(0,0,r,i),e.createPattern(n,"no-repeat")}o=e.createLinearGradient(n.x1+a*r,n.y1+s*i,n.x1+u*r,n.y1+l*i)}return R_e(o,t.stops)}(e,n,t.bounds):n}function D_e(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=N_e(e,t,t.fill),!0)}var I_e=[];function B_e(e,t,n){var r=null!=(r=t.strokeWidth)?r:1;return!(r<=0)&&(n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=N_e(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||I_e),e.lineDashOffset=t.strokeDashOffset||0),!0)}function L_e(e,t){return e.zindex-t.zindex||e.index-t.index}function P_e(e){if(!e.zdirty)return e.zitems;var t,n,r,i=e.items,o=[];for(n=0,r=i.length;n<r;++n)(t=i[n]).index=n,t.zindex&&o.push(t);return e.zdirty=!1,e.zitems=o.sort(L_e)}function $_e(e,t){var n,r,i=e.items;if(!i||!i.length)return;const o=P_e(e);if(o&&o.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||t(i[n]);i=o}for(n=0,r=i.length;n<r;++n)t(i[n])}function z_e(e,t){var n,r,i=e.items;if(!i||!i.length)return null;const o=P_e(e);for(o&&o.length&&(i=o),r=i.length;--r>=0;)if(n=t(i[r]))return n;if(i===o)for(r=(i=e.items).length;--r>=0;)if(!i[r].zindex&&(n=t(i[r])))return n;return null}function j_e(e){return function(t,n,r){$_e(n,(n=>{r&&!r.intersects(n.bounds)||G_e(e,t,n,n)}))}}function G_e(e,t,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(e(t,r)||(F_e(t,n),n.fill&&D_e(t,n,i)&&t.fill(),n.stroke&&B_e(t,n,i)&&t.stroke()))}function U_e(e){return e=e||gle,function(t,n,r,i,o,a){return r*=t.pixelRatio,i*=t.pixelRatio,z_e(n,(n=>{const s=n.bounds;if((!s||s.contains(o,a))&&s)return e(t,n,r,i,o,a)?n:void 0}))}}function W_e(e,t){return function(n,r,i,o){var a,s,u=Array.isArray(r)?r[0]:r,l=null==t?u.fill:t,c=u.stroke&&n.isPointInStroke;return c&&(a=u.strokeWidth,s=u.strokeCap,n.lineWidth=null!=a?a:1,n.lineCap=null!=s?s:"butt"),!e(n,r)&&(l&&n.isPointInPath(i,o)||c&&n.isPointInStroke(i,o))}}function V_e(e){return U_e(W_e(e))}function H_e(e,t){return"translate("+e+","+t+")"}function q_e(e){return"rotate("+e+")"}function X_e(e){return H_e(e.x||0,e.y||0)}function Y_e(e,t,n){function r(e,n){var r=n.x||0,i=n.y||0,o=n.angle||0;e.translate(r,i),o&&e.rotate(o*=hxe),e.beginPath(),t(e,n),o&&e.rotate(-o),e.translate(-r,-i)}return{type:e,tag:"path",nested:!1,attr:function(e,n){e("transform",function(e){return H_e(e.x||0,e.y||0)+(e.angle?" "+q_e(e.angle):"")}(n)),e("d",t(null,n))},bound:function(e,n){return t(v_e(e,n.angle),n),t_e(e,n).translate(n.x||0,n.y||0)},draw:j_e(r),pick:V_e(r),isect:n||M_e(r)}}var K_e=Y_e("arc",(function(e,t){return $xe.context(e)(t)}));function J_e(e,t,n){function r(e,n){e.beginPath(),t(e,n)}const i=W_e(r);return{type:e,tag:"path",nested:!0,attr:function(e,n){var r=n.mark.items;r.length&&e("d",t(null,r))},bound:function(e,n){var r=n.items;return 0===r.length?e:(t(v_e(e),r),t_e(e,r[0]))},draw:(o=r,function(e,t,n){!t.items.length||n&&!n.intersects(t.bounds)||G_e(o,e,t.items[0],t.items)}),pick:function(e,t,n,r,o,a){var s=t.items,u=t.bounds;return!s||!s.length||u&&!u.contains(o,a)?null:(n*=e.pixelRatio,r*=e.pixelRatio,i(e,s,n,r)?s[0]:null)},isect:T_e,tip:n};var o}var Z_e=J_e("area",(function(e,t){const n=t[0],r=n.interpolate||"linear";return("horizontal"===n.orient?jxe:zxe).curve(axe(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,i="horizontal"===e[0].orient?t[1]:t[0],o="horizontal"===e[0].orient?"y":"x",a=e.length,s=1/0;--a>=0;)!1!==e[a].defined&&(r=Math.abs(e[a][o]-i))<s&&(s=r,n=e[a]);return n}));function Q_e(e,t){e.beginPath(),Hxe(t)?qxe(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function ewe(e){const t=O_e(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function twe(e,t){const n=ewe(t);e("d",qxe(null,t,n,n))}function nwe(e,t,n,r){const i=ewe(t);e.beginPath(),qxe(e,t,(n||0)+i,(r||0)+i)}const rwe=W_e(nwe),iwe=W_e(nwe,!1),owe=W_e(nwe,!0);var awe={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",X_e(t))},bound:function(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let t=0;t<r;++t)e.union(n[t].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),t_e(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){$_e(t,(t=>{const r=t.x||0,i=t.y||0,o=t.strokeForeground,a=null==t.opacity?1:t.opacity;(t.stroke||t.fill)&&a&&(nwe(e,t,r,i),F_e(e,t),t.fill&&D_e(e,t,a)&&e.fill(),t.stroke&&!o&&B_e(e,t,a)&&e.stroke()),e.save(),e.translate(r,i),t.clip&&Q_e(e,t),n&&n.translate(-r,-i),$_e(t,(t=>{this.draw(e,t,n)})),n&&n.translate(r,i),e.restore(),o&&t.stroke&&a&&(nwe(e,t,r,i),F_e(e,t),B_e(e,t,a)&&e.stroke())}))},pick:function(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;const a=n*e.pixelRatio,s=r*e.pixelRatio;return z_e(t,(u=>{let l,c,p;const d=u.bounds;if(d&&!d.contains(i,o))return;c=u.x||0,p=u.y||0;const h=c+(u.width||0),f=p+(u.height||0),g=u.clip;if(g&&(i<c||i>h||o<p||o>f))return;if(e.save(),e.translate(c,p),c=i-c,p=o-p,g&&Hxe(u)&&!owe(e,u,a,s))return e.restore(),null;const m=u.strokeForeground,y=!1!==t.interactive;return y&&m&&u.stroke&&iwe(e,u,a,s)?(e.restore(),u):(l=z_e(u,(e=>function(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(e,c,p)?this.pick(e,n,r,c,p):null)),!l&&y&&(u.fill||!m&&u.stroke)&&rwe(e,u,a,s)&&(l=u),e.restore(),l||null)}))},isect:E_e,content:function(e,t,n){e("clip-path",t.clip?Yxe(n,t,t):null)},background:function(e,t){e("class","background"),e("aria-hidden",!0),twe(e,t)},foreground:function(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?twe(e,t):e("d","")}},swe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function uwe(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then((t=>{e.image=t,e.image.url=e.url}))),n}function lwe(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function cwe(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function pwe(e,t){return"center"===e?t/2:"right"===e?t:0}function dwe(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var hwe={type:"image",tag:"image",nested:!1,attr:function(e,t,n){const r=uwe(t,n),i=lwe(t,r),o=cwe(t,r),a=(t.x||0)-pwe(t.align,i),s=(t.y||0)-dwe(t.baseline,o);e("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",swe["xmlns:xlink"],"xlink:href"),e("transform",H_e(a,s)),e("width",i),e("height",o),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function(e,t){const n=t.image,r=lwe(t,n),i=cwe(t,n),o=(t.x||0)-pwe(t.align,r),a=(t.y||0)-dwe(t.baseline,i);return e.set(o,a,o+r,a+i)},draw:function(e,t,n){$_e(t,(t=>{if(n&&!n.intersects(t.bounds))return;const r=uwe(t,this);let i=lwe(t,r),o=cwe(t,r);if(0===i||0===o)return;let a,s,u,l,c=(t.x||0)-pwe(t.align,i),p=(t.y||0)-dwe(t.baseline,o);!1!==t.aspect&&(s=r.width/r.height,u=t.width/t.height,s==s&&u==u&&s!==u&&(u<s?(l=i/s,p+=(o-l)/2,o=l):(l=o*s,c+=(i-l)/2,i=l))),(r.complete||r.toDataURL)&&(F_e(e,t),e.globalAlpha=null!=(a=t.opacity)?a:1,e.imageSmoothingEnabled=!1!==t.smooth,e.drawImage(r,c,p,i,o))}))},pick:U_e(),isect:gle,get:uwe,xOffset:pwe,yOffset:dwe},fwe=J_e("line",(function(e,t){const n=t[0],r=n.interpolate||"linear";return Gxe.curve(axe(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,i=Math.pow(e[0].strokeWidth||1,2),o=e.length;--o>=0;)if(!1!==e[o].defined&&(n=e[o].x-t[0])*n+(r=e[o].y-t[1])*r<i)return e[o];return null}));function gwe(e,t){var n=t.path;if(null==n)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,a=t.scaleY||1,s=(t.angle||0)*hxe,u=t.pathCache;u&&u.path===n||((t.pathCache=u=dxe(n)).path=n),s&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(s),kxe(e,u,0,0,o,a),e.rotate(-s),e.translate(-r,-i)):kxe(e,u,r,i,o,a)}var mwe={type:"path",tag:"path",nested:!1,attr:function(e,t){var n=t.scaleX||1,r=t.scaleY||1;1===n&&1===r||e("vector-effect","non-scaling-stroke"),e("transform",function(e){return H_e(e.x||0,e.y||0)+(e.angle?" "+q_e(e.angle):"")+(e.scaleX||e.scaleY?" "+(t=e.scaleX||1,n=e.scaleY||1,"scale("+t+","+n+")"):"");var t,n}(t)),e("d",t.path)},bound:function(e,t){return gwe(v_e(e,t.angle),t)?e.set(0,0,0,0):t_e(e,t,!0)},draw:j_e(gwe),pick:V_e(gwe),isect:M_e(gwe)};function ywe(e,t){e.beginPath(),qxe(e,t)}var bwe={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",qxe(null,t))},bound:function(e,t){var n,r;return t_e(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)},draw:j_e(ywe),pick:V_e(ywe),isect:E_e};function vwe(e,t,n){var r,i,o,a;return!(!t.stroke||!B_e(e,t,n)||(r=t.x||0,i=t.y||0,o=null!=t.x2?t.x2:r,a=null!=t.y2?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,a),0))}var xwe={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",X_e(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,r;return t_e(e.set(n=t.x||0,r=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r),t)},draw:function(e,t,n){$_e(t,(t=>{if(!n||n.intersects(t.bounds)){var r=null==t.opacity?1:t.opacity;r&&vwe(e,t,r)&&(F_e(e,t),e.stroke())}}))},pick:U_e((function(e,t,n,r){return!!e.isPointInStroke&&vwe(e,t,1)&&e.isPointInStroke(n,r)})),isect:function(e,t){const n=e.x||0,r=e.y||0;return A_e(t,n,r,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r)}},_we=Y_e("shape",(function(e,t){return(t.mark.shape||t.shape).context(e)(t)})),wwe=Y_e("symbol",(function(e,t){return Wxe.context(e)(t)}),T_e);const kwe=function(e){let t,n,r;e=+e||1e4;const i=()=>{t={},n={},r=0},o=(i,o)=>(++r>e&&(n=t,t={},r=1),t[i]=o);return i(),{clear:i,has:e=>Ole(t,e)||Ole(n,e),get:e=>Ole(t,e)?t[e]:Ole(n,e)?o(e,n[e]):void 0,set:(e,n)=>Ole(t,e)?t[e]=n:o(e,n)}}();var Swe={height:Fwe,measureWidth:Ewe,estimateWidth:Mwe,width:Mwe,canvas:Cwe};function Cwe(e){Swe.width=e&&S_e?Ewe:Mwe}function Mwe(e,t){return Twe(Nwe(e,t),Fwe(e))}function Twe(e,t){return~~(.8*e.length*t)}function Ewe(e,t){return Fwe(e)<=0||!(t=Nwe(e,t))?0:Awe(t,Iwe(e))}function Awe(e,t){const n=`(${t}) ${e}`;let r=kwe.get(n);return void 0===r&&(S_e.font=t,r=S_e.measureText(e).width,kwe.set(n,r)),r}function Fwe(e){return null!=e.fontSize?+e.fontSize||0:11}function Owe(e){return null!=e.lineHeight?e.lineHeight:Fwe(e)+2}function Rwe(e){return t=e.lineBreak&&e.text&&!mle(e.text)?e.text.split(e.lineBreak):e.text,mle(t)?t.length>1?t:t[0]:t;var t}function Nwe(e,t){const n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function(e,t){var n=+e.limit,r=function(e){if(Swe.width===Ewe){const t=Iwe(e);return e=>Awe(e,t)}{const t=Fwe(e);return e=>Twe(e,t)}}(e);if(r(t)<n)return t;var i,o=e.ellipsis||"",a="rtl"===e.dir,s=0,u=t.length;if(n-=r(o),a){for(;s<u;)i=s+u>>>1,r(t.slice(i))>n?s=i+1:u=i;return o+t.slice(s)}for(;s<u;)i=1+(s+u>>>1),r(t.slice(0,i))<n?s=i:u=i-1;return t.slice(0,s)+o}(e,n):n}function Dwe(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Iwe(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Fwe(e)+"px "+Dwe(e,t)}function Bwe(e){var t=e.baseline,n=Fwe(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*Owe(e):"line-bottom"===t?.29*n-.5*Owe(e):0)}Cwe(!0);const Lwe={left:"start",center:"middle",right:"end"},Pwe=new Kxe;function $we(e){var t,n=e.x||0,r=e.y||0,i=e.radius||0;return i&&(t=(e.theta||0)-fxe,n+=i*Math.cos(t),r+=i*Math.sin(t)),Pwe.x1=n,Pwe.y1=r,Pwe}function zwe(e,t,n){var r,i=Swe.height(t),o=t.align,a=$we(t),s=a.x1,u=a.y1,l=t.dx||0,c=(t.dy||0)+Bwe(t)-Math.round(.8*i),p=Rwe(t);if(mle(p)?(i+=Owe(t)*(p.length-1),r=p.reduce(((e,n)=>Math.max(e,Swe.width(t,n))),0)):r=Swe.width(t,p),"center"===o?l-=r/2:"right"===o&&(l-=r),e.set(l+=s,c+=u,l+r,c+i),t.angle&&!n)e.rotate(t.angle*hxe,s,u);else if(2===n)return e.rotatedPoints(t.angle*hxe,s,u);return e}var jwe={type:"text",tag:"text",nested:!1,attr:function(e,t){var n,r=t.dx||0,i=(t.dy||0)+Bwe(t),o=$we(t),a=o.x1,s=o.y1,u=t.angle||0;e("text-anchor",Lwe[t.align]||"start"),u?(n=H_e(a,s)+" "+q_e(u),(r||i)&&(n+=" "+H_e(r,i))):n=H_e(a+r,s+i),e("transform",n)},bound:zwe,draw:function(e,t,n){$_e(t,(t=>{var r,i,o,a,s,u,l,c=null==t.opacity?1:t.opacity;if(!(n&&!n.intersects(t.bounds)||0===c||t.fontSize<=0||null==t.text||0===t.text.length)){if(e.font=Iwe(t),e.textAlign=t.align||"left",i=(r=$we(t)).x1,o=r.y1,t.angle&&(e.save(),e.translate(i,o),e.rotate(t.angle*hxe),i=o=0),i+=t.dx||0,o+=(t.dy||0)+Bwe(t),u=Rwe(t),F_e(e,t),mle(u))for(s=Owe(t),a=0;a<u.length;++a)l=Nwe(t,u[a]),t.fill&&D_e(e,t,c)&&e.fillText(l,i,o),t.stroke&&B_e(e,t,c)&&e.strokeText(l,i,o),o+=s;else l=Nwe(t,u),t.fill&&D_e(e,t,c)&&e.fillText(l,i,o),t.stroke&&B_e(e,t,c)&&e.strokeText(l,i,o);t.angle&&e.restore()}}))},pick:U_e((function(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=$we(t),s=a.x1,u=a.y1,l=zwe(Pwe,t,1),c=-t.angle*hxe,p=Math.cos(c),d=Math.sin(c),h=p*i-d*o+(s-p*s+d*u),f=d*i+p*o+(u-d*s-p*u);return l.contains(h,f)})),isect:function(e,t){const n=zwe(Pwe,e,2);return A_e(t,n[0],n[1],n[2],n[3])||A_e(t,n[0],n[1],n[4],n[5])||A_e(t,n[4],n[5],n[6],n[7])||A_e(t,n[2],n[3],n[6],n[7])}},Gwe=J_e("trail",(function(e,t){return Vxe.context(e)(t)}),(function(e,t){for(var n,r,i=e.length;--i>=0;)if(!1!==e[i].defined&&(n=e[i].x-t[0])*n+(r=e[i].y-t[1])*r<(n=e[i].size||1)*n)return e[i];return null})),Uwe={arc:K_e,area:Z_e,group:awe,image:hwe,line:fwe,path:mwe,rect:bwe,rule:xwe,shape:_we,symbol:wwe,text:jwe,trail:Gwe};function Wwe(e,t,n){return!e&&"undefined"!=typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function Vwe(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Hwe(e,t,n,r){var i,o=e.childNodes[t];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(i=o||null,o=Wwe(e.ownerDocument,n,r),e.insertBefore(o,i)),o}function qwe(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function Xwe(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Ywe(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function Kwe(e,t){this._active=null,this._handlers={},this._loader=e||Qve(),this._tooltip=t||Jwe}function Jwe(e,t,n,r){e.element().setAttribute("title",r||"")}function Zwe(e){this._el=null,this._bgcolor=null,this._loader=new Zxe(e)}Kwe.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const e in t)n.push(...t[e]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then((t=>{const n=new MouseEvent(e.type,e),r=Wwe(null,"a");for(const e in t)r.setAttribute(e,t[e]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(e,t,n){if(t&&null!=t.tooltip){t=function(e,t,n,r){var i,o,a=e&&e.mark;if(a&&(i=Uwe[a.marktype]).tip){for((o=Ywe(t,n))[0]-=r[0],o[1]-=r[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=i.tip(a.items,o)}return e}(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,o=i.width(),a=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)s+=e.x||0,u+=e.y||0;return{x:s,y:u,width:o,height:a,left:s,top:u,right:s+o,bottom:u+a}}},Zwe.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then((()=>t)):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const e=n._call;n._ready=n._loader.ready().then((t=>{t&&e(),n._ready=null}))}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const Qwe="dragenter",eke="dragleave",tke="dragover",nke="mousedown",rke="mousemove",ike="mouseout",oke="mouseover",ake="click",ske="mousewheel",uke="touchstart",lke="touchmove",cke="touchend",pke=rke,dke=ike,hke=ake;function fke(e,t){Kwe.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function gke(e,t){(e=>e===uke||e===lke||e===cke?[uke,lke,cke]:[e])(t).forEach((t=>function(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?n=>e[t](n):n=>e.fire(t,n)))}(e,t)))}function mke(e,t,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i||(i&&i.exit||this.fire(n,r),this._active=o,this.fire(t,r)),this.fire(e,r)}}function yke(e){return function(t){this.fire(e,t),this._active=null}}Rle(fke,Kwe,{initialize(e,t,n){return this._canvas=e&&Vwe(e,"canvas"),[ake,nke,rke,ike,eke].forEach((e=>gke(this,e))),Kwe.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",Qwe,eke,tke,nke,"mouseup",rke,ike,oke,ake,"dblclick","wheel",ske,uke,lke,cke],DOMMouseScroll(e){this.fire(ske,e)},mousemove:mke(rke,oke,ike),dragover:mke(tke,Qwe,eke),mouseout:yke(ike),dragleave:yke(eke),mousedown(e){this._down=this._active,this.fire(nke,e)},click(e){this._down===this._active&&(this.fire(ake,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(uke,e,!0)},touchmove(e){this.fire(lke,e,!0)},touchend(e){this.fire(cke,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===hke&&r&&r.href?this.handleHref(t,r,r.href):e!==pke&&e!==dke||this.handleTooltip(t,r,e!==dke),i)for(let e=0,n=i.length;e<n;++e)i[e].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(gke(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=Ywe(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const o=this.context();return Uwe[e.marktype].pick.call(this,o,e,t,n,r,i)}});var bke="undefined"!=typeof window&&window.devicePixelRatio||1;function vke(e){Zwe.call(this,e),this._options={},this._redraw=!1,this._dirty=new Kxe,this._tempb=new Kxe}const xke=Zwe.prototype;function _ke(e,t){Kwe.call(this,e,t);const n=this;n._hrefHandler=wke(n,((e,t)=>{t&&t.href&&n.handleHref(e,t,t.href)})),n._tooltipHandler=wke(n,((e,t)=>{n.handleTooltip(e,t,e.type!==dke)}))}Rle(vke,Zwe,{initialize(e,t,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:Pd(1,1,this._options.type),e&&this._canvas&&(qwe(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),xke.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(xke.resize.call(this,e,t,n,r),this._canvas)!function(e,t,n,r,i,o){const a="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,s=e.getContext("2d"),u=a?bke:i;e.width=t*u,e.height=n*u;for(const e in o)s[e]=o[e];a&&1!==u&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const e=this._options.externalContext;e||dle("CanvasRenderer is missing a valid canvas or context"),e.scale(this._scale,this._scale),e.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,a=((e,t,n)=>(new Kxe).set(0,0,t,n).translate(-e[0],-e[1]))(n,r,i);t.save();const s=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):function(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,a.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,s),t.restore(),o.clear(),this},draw(e,t,n){const r=Uwe[t.marktype];t.clip&&function(e,t){var n=t.clip;e.save(),Ele(n)?(e.beginPath(),n(e),e.clip()):Q_e(e,t.group)}(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,o=this.context();"pdf"===i.type||i.externalContext||o.clearRect(e,t,n,r),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,r))}});const wke=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};Rle(_ke,Kwe,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(hke,this._hrefHandler),r.removeEventListener(pke,this._tooltipHandler),r.removeEventListener(dke,this._tooltipHandler)),this._svg=r=e&&Vwe(e,"svg"),r&&(r.addEventListener(hke,this._hrefHandler),r.addEventListener(pke,this._tooltipHandler),r.addEventListener(dke,this._tooltipHandler)),Kwe.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const i={type:e,handler:t,listener:wke(this,t)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const kke="aria-hidden",Ske="aria-label",Cke="role",Mke="aria-roledescription",Tke="graphics-object",Eke="graphics-symbol",Ake=(e,t,n)=>({[Cke]:e,[Mke]:t,[Ske]:n||void 0}),Fke=$le(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Oke={axis:{desc:"axis",caption:function(e){const t=e.datum,n=e.orient,r=t.title?Bke(e):null,i=e.context,o=i.scales[t.scale].value,a=i.dataflow.locale(),s=o.type;return`${"left"===n||"right"===n?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${zye(s)?"discrete":s} scale`+` with ${ube(a,o,e)}`}},legend:{desc:"legend",caption:function(e){const t=e.datum,n=t.title?Bke(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),a=e.context,s=a.scales[i[o[0]]].value,u=a.dataflow.locale();return((l=r).length?l[0].toUpperCase()+l.slice(1):l)+(n?` titled '${n}'`:"")+` for ${function(e){return(e=e.map((e=>e+("fill"===e||"stroke"===e?" color":"")))).length<2?e[0]:e.slice(0,-1).join(", ")+" and "+ble(e)}(o)}`+` with ${ube(u,s,e)}`;var l}},"title-text":{desc:"title",caption:e=>`Title text '${Ike(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${Ike(e)}'`}},Rke={ariaRole:Cke,ariaRoleDescription:Mke,description:Ske};function Nke(e,t){const n=!1===t.aria;if(e(kke,n||void 0),n||null==t.description)for(const t in Rke)e(Rke[t],void 0);else{const n=t.mark.marktype;e(Ske,t.description),e(Cke,t.ariaRole||("group"===n?Tke:Eke)),e(Mke,t.ariaRoleDescription||`${n} mark`)}}function Dke(e){return!1===e.aria?{[kke]:!0}:Fke[e.role]?null:Oke[e.role]?function(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return Ake(t.role||Eke,t.desc,n.description||r(n))}catch(e){return null}}(e,Oke[e.role]):function(e){const t=e.marktype,n="group"===t||"text"===t||e.items.some((e=>null!=e.description&&!1!==e.aria));return Ake(n?Tke:Eke,`${t} mark container`,e.description)}(e)}function Ike(e){return Tle(e.text).join(" ")}function Bke(e){try{return Tle(ble(e.items).items[0].text).join(" ")}catch(e){return null}}const Lke=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function Pke(){let e="",t="",n="";const r=[],i=()=>t=n="",o=(e,n)=>{var r;return null!=n&&(t+=` ${e}="${r=n,Lke(r).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")}"`),a},a={open(s){(o=>{t&&(e+=`${t}>${n}`,i()),r.push(o)})(s),t="<"+s;for(var u=arguments.length,l=new Array(u>1?u-1:0),c=1;c<u;c++)l[c-1]=arguments[c];for(const e of l)for(const t in e)o(t,e[t]);return a},close(){const o=r.pop();return e+=t?t+(n?`>${n}</${o}>`:"/>"):`</${o}>`,i(),a},attr:o,text:e=>(n+=Lke(e),a),toString:()=>e};return a}const $ke=e=>zke(Pke(),e)+"";function zke(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let t=0;t<r;++t)e.attr(n[t].name,n[t].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const t of n)3===t.nodeType?e.text(t.nodeValue):zke(e,t)}return e.close()}const jke={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},Gke={blend:"mix-blend-mode"},Uke={fill:"none","stroke-miterlimit":10},Wke="http://www.w3.org/2000/xmlns/",Vke=swe.xmlns;function Hke(e){Zwe.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const qke=Zwe.prototype;function Xke(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function Yke(e,t,n){let r,i,o;if("radial"===t.gradient){let r=Hwe(e,n++,"pattern",Vke);rSe(r,{id:txe+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=Hwe(r,0,"rect",Vke),rSe(r,{width:1,height:1,fill:`url(${oSe()}#${t.id})`}),rSe(e=Hwe(e,n++,"radialGradient",Vke),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else rSe(e=Hwe(e,n++,"linearGradient",Vke),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=Hwe(e,r,"stop",Vke),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return qwe(e,r),n}function Kke(e,t,n){let r;return(e=Hwe(e,n,"clipPath",Vke)).setAttribute("id",t.id),t.path?(r=Hwe(e,0,"path",Vke),r.setAttribute("d",t.path)):(r=Hwe(e,0,"rect",Vke),rSe(r,{x:0,y:0,width:t.width,height:t.height})),qwe(e,1),n+1}function Jke(e,t,n,r,i){let o,a=e._svg;if(!a&&(o=t.ownerDocument,a=Wwe(o,r,Vke),e._svg=a,e.mark&&(a.__data__=e,a.__values__={fill:"default"},"g"===r))){const t=Wwe(o,"path",Vke);a.appendChild(t),t.__data__=e;const n=Wwe(o,"g",Vke);a.appendChild(n),n.__data__=e;const r=Wwe(o,"path",Vke);a.appendChild(r),r.__data__=e,r.__values__={fill:"default"}}return(a.ownerSVGElement!==i||function(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(a,n))&&t.insertBefore(a,n?n.nextSibling:t.firstChild),a}Rle(Hke,Zwe,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=Hwe(e,0,"svg",Vke),this._svg.setAttributeNS(Wke,"xmlns",Vke),this._svg.setAttributeNS(Wke,"xmlns:xlink",swe["xmlns:xlink"]),this._svg.setAttribute("version",swe.version),this._svg.setAttribute("class","marks"),qwe(e,1),this._root=Hwe(this._svg,0,"g",Vke),rSe(this._root,Uke),qwe(this._svg,1)),this.background(this._bgcolor),qke.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),qke.background.apply(this,arguments)},resize(e,t,n,r){return qke.resize.call(this,e,t,n,r),this._svg&&(rSe(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Hwe(e,0,"rect",Vke),rSe(n,{width:this._width,height:this._height,fill:t}));const r=$ke(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),qwe(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,o,a,s,u;for(a=0,s=e.length;a<s;++a)n=e[a],r=n.mark,r.marktype!==i&&(i=r.marktype,o=Uwe[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,Xke(n,t),r.items.forEach((e=>{e.dirty=t}))),r.zdirty||(n.exit?(o.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(o,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null):(n=o.nested?r.items[0]:n,n._update!==t&&(n._svg&&n._svg.ownerSVGElement?this._update(o,n._svg,n):(this._dirtyAll=!1,Xke(n,t)),n._update=t)));return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=Uwe[t.marktype],o=!1===t.interactive?"none":null,a="g"===i.tag,s=Jke(t,e,n,"g",r);s.setAttribute("class",Xwe(t));const u=Dke(t);for(const e in u)iSe(s,e,u[e]);a||iSe(s,"pointer-events",o),iSe(s,"clip-path",t.clip?Yxe(this,t,t.group):null);let l=null,c=0;const p=e=>{const t=this.isDirty(e),n=Jke(e,s,l,i.tag,r);t&&(this._update(i,n,e),a&&function(e,t,n){t=t.lastChild.previousSibling;let r,i=0;$_e(n,(n=>{r=e.mark(t,n,r),++i})),qwe(t,1+i)}(this,n,e)),l=n,++c};return i.nested?t.items.length&&p(t.items[0]):$_e(t,p),qwe(s,c),s},_update(e,t,n){Zke=t,Qke=t.__values__,Nke(tSe,n),e.attr(tSe,n,this);const r=eSe[e.type];r&&r.call(this,e,t,n),Zke&&this.style(Zke,n)},style(e,t){if(null!=t){for(const n in jke){let r="font"===n?Dwe(t):t[n];if(r===Qke[n])continue;const i=jke[n];null==r?e.removeAttribute(i):(nxe(r)&&(r=rxe(r,this._defs.gradient,oSe())),e.setAttribute(i,r+"")),Qke[n]=r}for(const n in Gke)nSe(e,Gke[n],t[n])}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=Hwe(e,1,"defs",Vke)),r=Yke(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=Hwe(e,1,"defs",Vke)),r=Kke(n,t.clipping[i],r);n&&(0===r?(e.removeChild(n),t.el=null):qwe(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});let Zke=null,Qke=null;const eSe={group(e,t,n){const r=Zke=t.childNodes[2];Qke=r.__values__,e.foreground(tSe,n,this),Qke=t.__values__,Zke=t.childNodes[1],e.content(tSe,n,this);const i=Zke=t.childNodes[0];e.background(tSe,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==Qke.events&&(iSe(r,"pointer-events",o),iSe(i,"pointer-events",o),Qke.events=o),n.strokeForeground&&n.stroke){const e=n.fill;iSe(r,"display",null),this.style(i,n),iSe(i,"stroke",null),e&&(n.fill=null),Qke=r.__values__,this.style(r,n),e&&(n.fill=e),Zke=null}else iSe(r,"display","none")},image(e,t,n){!1===n.smooth?(nSe(t,"image-rendering","optimizeSpeed"),nSe(t,"image-rendering","pixelated")):nSe(t,"image-rendering",null)},text(e,t,n){const r=Rwe(n);let i,o,a,s;mle(r)?(o=r.map((e=>Nwe(n,e))),i=o.join("\n"),i!==Qke.text&&(qwe(t,0),a=t.ownerDocument,s=Owe(n),o.forEach(((e,r)=>{const i=Wwe(a,"tspan",Vke);i.__data__=n,i.textContent=e,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),t.appendChild(i)})),Qke.text=i)):(o=Nwe(n,r),o!==Qke.text&&(t.textContent=o,Qke.text=o)),iSe(t,"font-family",Dwe(n)),iSe(t,"font-size",Fwe(n)+"px"),iSe(t,"font-style",n.fontStyle),iSe(t,"font-variant",n.fontVariant),iSe(t,"font-weight",n.fontWeight)}};function tSe(e,t,n){t!==Qke[e]&&(n?function(e,t,n,r){null!=n?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}(Zke,e,t,n):iSe(Zke,e,t),Qke[e]=t)}function nSe(e,t,n){n!==Qke[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),Qke[t]=n)}function rSe(e,t){for(const n in t)iSe(e,n,t[n])}function iSe(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function oSe(){let e;return"undefined"==typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function aSe(e){Zwe.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}Rle(aSe,Zwe,{svg(){return this._text},_render(e){const t=Pke();t.open("svg",Ale({},swe,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",Uke,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Uwe[t.marktype],r=n.tag,i=[Nke,n.attr];e.open("g",{class:Xwe(t),"clip-path":t.clip?Yxe(this,t,t.group):null},Dke(t),{"pointer-events":"g"!==r&&!1===t.interactive?"none":null});const o=o=>{const a=this.href(o);if(a&&e.open("a",a),e.open(r,this.attr(t,o,i,"g"!==r?r:null)),"text"===r){const t=Rwe(o);if(mle(t)){const n={x:0,dy:Owe(o)};for(let r=0;r<t.length;++r)e.open("tspan",r?n:null).text(Nwe(o,t[r])).close()}else e.text(Nwe(o,t))}else if("g"===r){const r=o.strokeForeground,i=o.fill,a=o.stroke;r&&a&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),$_e(o,(t=>this.mark(e,t))),e.close(),r&&a?(i&&(o.fill=null),o.stroke=a,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),i&&(o.fill=i)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):$_e(t,o),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then((e=>{e["xlink:href"]=e.href,e.href=null,(this._hrefs||(this._hrefs={}))[t]=e}))}return null},attr(e,t,n,r){const i={},o=(e,t,n,r)=>{i[r||e]=t};return Array.isArray(n)?n.forEach((e=>e(o,t,this))):n(o,t,this),r&&function(e,t,n,r,i){let o;if(null==t)return e;if("bgrect"===r&&!1===n.interactive&&(e["pointer-events"]="none"),"bgfore"===r&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill))return e;"image"===r&&!1===t.smooth&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),"text"===r&&(e["font-family"]=Dwe(t),e["font-size"]=Fwe(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const n in jke){let r=t[n];const o=jke[n];("transparent"!==r||"fill"!==o&&"stroke"!==o)&&null!=r&&(nxe(r)&&(r=rxe(r,i.gradient,"")),e[o]=r)}for(const e in Gke){const n=t[e];null!=n&&(o=o||[],o.push(`${Gke[e]}: ${n};`))}o&&(e.style=o.join(" "))}(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(t).length+Object.keys(n).length){e.open("defs");for(const n in t){const r=t[n],i=r.stops;"radial"===r.gradient?(e.open("pattern",{id:txe+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),e.close(),e.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):e.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let t=0;t<i.length;++t)e.open("stop",{offset:i[t].offset,"stop-color":i[t].color}).close();e.close()}for(const t in n){const r=n[t];e.open("clipPath",{id:t}),r.path?e.open("path",{d:r.path}).close():e.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),e.close()}e.close()}}});const sSe={};function uSe(e,t,n,r){if(function(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){const i=e.items,o=e.marktype,a=i.length;let s=0;if("group"===o)for(;s<a;++s)lSe(i[s],t,n,r);else for(const e=Uwe[o].isect;s<a;++s){const n=i[s];cSe(n,t,e)&&r.push(n)}}return r}function lSe(e,t,n,r){n&&n(e.mark)&&cSe(e,t,Uwe.group.isect)&&r.push(e);const i=e.items,o=i&&i.length;if(o){const a=e.x||0,s=e.y||0;t.translate(-a,-s);for(let e=0;e<o;++e)uSe(i[e],t,n,r);t.translate(a,s)}return r}function cSe(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}sSe.canvas=sSe.png={renderer:vke,headless:vke,handler:fke},sSe.svg={renderer:Hke,headless:aSe,handler:_ke},sSe.none={},new Kxe;var pSe=Math.random;const dSe=Math.sqrt(2*Math.PI),hSe=Math.SQRT2;let fSe=NaN;function gSe(e,t){e=e||0,t=null==t?1:t;let n,r,i=0,o=0;if(fSe==fSe)i=fSe,fSe=NaN;else{do{i=2*pSe()-1,o=2*pSe()-1,n=i*i+o*o}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,fSe=o*r}return e+i*t}function mSe(e,t,n){const r=(e-(t=t||0))/(n=null==n?1:n),i=Math.abs(r);let o;if(i>37)o=0;else{const e=Math.exp(-i*i/2);let t;i<7.07106781186547?(t=.0352624965998911*i+.700383064443688,t=t*i+6.37396220353165,t=t*i+33.912866078383,t=t*i+112.079291497871,t=t*i+221.213596169931,t=t*i+220.206867912376,o=e*t,t=.0883883476483184*i+1.75566716318264,t=t*i+16.064177579207,t=t*i+86.7807322029461,t=t*i+296.564248779674,t=t*i+637.333633378831,t=t*i+793.826512519948,t=t*i+440.413735824752,o/=t):(t=i+.65,t=i+4/t,t=i+3/t,t=i+2/t,t=i+1/t,o=e/t/2.506628274631)}return r>0?1-o:o}function ySe(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*hSe*function(e){let t,n=-Math.log((1-e)*(1+e));return n<6.25?(n-=3.125,t=-364441206401782e-35,t=t*n-16850591381820166e-35,t=128584807152564e-32+t*n,t=11157877678025181e-33+t*n,t=t*n-1333171662854621e-31,t=20972767875968562e-33+t*n,t=6637638134358324e-30+t*n,t=t*n-4054566272975207e-29,t=t*n-8151934197605472e-29,t=26335093153082323e-28+t*n,t=t*n-12975133253453532e-27,t=t*n-5415412054294628e-26,t=1.0512122733215323e-9+t*n,t=t*n-4.112633980346984e-9,t=t*n-2.9070369957882005e-8,t=4.2347877827932404e-7+t*n,t=t*n-13654692000834679e-22,t=t*n-13882523362786469e-21,t=.00018673420803405714+t*n,t=t*n-.000740702534166267,t=t*n-.006033670871430149,t=.24015818242558962+t*n,t=1.6536545626831027+t*n):n<16?(n=Math.sqrt(n)-3.25,t=2.2137376921775787e-9,t=9.075656193888539e-8+t*n,t=t*n-2.7517406297064545e-7,t=1.8239629214389228e-8+t*n,t=15027403968909828e-22+t*n,t=t*n-4013867526981546e-21,t=29234449089955446e-22+t*n,t=12475304481671779e-21+t*n,t=t*n-47318229009055734e-21,t=6828485145957318e-20+t*n,t=24031110387097894e-21+t*n,t=t*n-.0003550375203628475,t=.0009532893797373805+t*n,t=t*n-.0016882755560235047,t=.002491442096107851+t*n,t=t*n-.003751208507569241,t=.005370914553590064+t*n,t=1.0052589676941592+t*n,t=3.0838856104922208+t*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,t=-27109920616438573e-27,t=t*n-2.555641816996525e-10,t=1.5076572693500548e-9+t*n,t=t*n-3.789465440126737e-9,t=7.61570120807834e-9+t*n,t=t*n-1.496002662714924e-8,t=2.914795345090108e-8+t*n,t=t*n-6.771199775845234e-8,t=2.2900482228026655e-7+t*n,t=t*n-9.9298272942317e-7,t=4526062597223154e-21+t*n,t=t*n-1968177810553167e-20,t=7599527703001776e-20+t*n,t=t*n-.00021503011930044477,t=t*n-.00013871931833623122,t=1.0103004648645344+t*n,t=4.849906401408584+t*n):t=1/0,t*e}(2*e-1)}function bSe(e){const t=this.context.data[e];return t?t.values.value:[]}Math.PI;const vSe=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},xSe=vSe("format"),_Se=vSe("timeFormat"),wSe=vSe("utcFormat"),kSe=vSe("timeParse"),SSe=vSe("utcParse"),CSe=new Date(2e3,0,1);function MSe(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(CSe.setYear(2e3),CSe.setMonth(e),CSe.setDate(t),_Se.call(this,CSe,n)):""}const TSe="%";function ESe(e,t,n,r){t[0].type!==zle&&dle("First argument to data functions must be a string literal.");const i=t[0].value,o=":"+i;if(!Ole(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(e){}}function ASe(e,t,n,r){if(t[0].type===zle)FSe(n,r,t[0].value);else for(e in n.scales)FSe(n,r,e)}function FSe(e,t,n){const r=TSe+n;if(!Ole(t,r))try{t[r]=e.scaleRef(n)}catch(e){}}function OSe(e,t){let n;return Ele(e)?e:Ile(e)?(n=t.scales[e])&&n.value:void 0}function RSe(e,t){return function(n,r,i){if(n){const t=OSe(n,(i||this).context);return t&&t.path[e](r)}return t(r)}}const NSe=RSe("area",(function(e){return sce=new V8,W8(e,uce),2*sce})),DSe=RSe("bounds",(function(e){var t,n,r,i,o,a,s;if(Zle=Jle=-(Yle=Kle=1/0),ice=[],W8(e,Ace),n=ice.length){for(ice.sort(Pce),t=1,o=[r=ice[0]];t<n;++t)$ce(r,(i=ice[t])[0])||$ce(r,i[1])?(Lce(r[0],i[1])>Lce(r[0],r[1])&&(r[1]=i[1]),Lce(i[0],r[1])>Lce(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,t=0,r=o[n=o.length-1];t<=n;r=i,++t)i=o[t],(s=Lce(r[1],i[0]))>a&&(a=s,Yle=i[0],Jle=r[1])}return ice=oce=null,Yle===1/0||Kle===1/0?[[NaN,NaN],[NaN,NaN]]:[[Yle,Kle],[Jle,Zle]]})),ISe=RSe("centroid",(function(e){hce=fce=gce=mce=yce=bce=vce=xce=0,_ce=new V8,wce=new V8,kce=new V8,W8(e,zce);var t=+_ce,n=+wce,r=+kce,i=PR(t,n,r);return i<CR&&(t=bce,n=vce,r=xce,fce<SR&&(t=gce,n=mce,r=yce),(i=PR(t,n,r))<CR)?[NaN,NaN]:[DR(n,t)*FR,HR(r/i)*FR]}));function BSe(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(t){e.warn(t)}return n[n.length-1]}function LSe(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function PSe(e){const t=jM(e);return.2126*LSe(t.r)+.7152*LSe(t.g)+.0722*LSe(t.b)}function $Se(e,t){return e===t||e!=e&&t!=t||(mle(e)?!(!mle(t)||e.length!==t.length)&&function(e,t){for(let n=0,r=e.length;n<r;++n)if(!$Se(e[n],t[n]))return!1;return!0}(e,t):!(!yle(e)||!yle(t))&&zSe(e,t))}function zSe(e,t){for(const n in e)if(!$Se(e[n],t[n]))return!1;return!0}function jSe(e){return t=>zSe(e,t)}const GSe={};function USe(e){return mle(e)||ArrayBuffer.isView(e)?e:null}function WSe(e){return USe(e)||(Ile(e)?e:null)}const VSe=e=>e.data;function HSe(e,t){const n=bSe.call(t,e);return n.root&&n.root.lookup||{}}const qSe=()=>"undefined"!=typeof window&&window||null,XSe={random:()=>pSe(),cumulativeNormal:mSe,cumulativeLogNormal:function(e,t,n){return mSe(Math.log(e),t,n)},cumulativeUniform:function(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)},densityNormal:function(e,t,n){const r=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*dSe)},densityLogNormal:function(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*dSe*e)},densityUniform:function(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0},quantileNormal:ySe,quantileLogNormal:function(e,t,n){return Math.exp(ySe(e,t,n))},quantileUniform:function(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN},sampleNormal:gSe,sampleLogNormal:function(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+gSe()*t)},sampleUniform:function(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*pSe()},isArray:mle,isBoolean:function(e){return"boolean"==typeof e},isDate:Nle,isDefined:e=>void 0!==e,isNumber:Dle,isObject:yle,isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},isString:Ile,isTuple:lu,isValid:e=>null!=e&&e==e,toBoolean:function(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e||!e)},toDate:function(e,t){return t=t||Ple,null==e||""===e?null:t(e)},toNumber:vle,toString:function(e){return null==e||""===e?null:e+""},indexof:function(e,...t){return WSe(e).indexOf(...t)},join:function(e,...t){return USe(e).join(...t)},lastindexof:function(e,...t){return WSe(e).lastIndexOf(...t)},replace:function(e,t,n){return Ele(n)&&dle("Function argument passed to replace."),String(e).replace(t,n)},reverse:function(e){return USe(e).slice().reverse()},slice:function(e,...t){return WSe(e).slice(...t)},flush:function(e,t,n,r,i,o){if(!n&&0!==n)return o;const a=+n;let s,u=e[0],l=ble(e);l<u&&(s=u,u=l,l=s),s=Math.abs(t-u);const c=Math.abs(l-t);return s<c&&s<=a?r:c<=a?i:o},lerp:function(e,t){const n=e[0],r=ble(e),i=+t;return i?1===i?r:n+i*(r-n):n},merge:function(){const e=[].slice.call(arguments);return e.unshift({}),Ale(...e)},pad:function(e,t,n,r){const i=n||" ",o=e+"",a=t-o.length;return a<=0?o:"left"===r?Ble(i,a)+o:"center"===r?Ble(i,~~(a/2))+o+Ble(i,Math.ceil(a/2)):o+Ble(i,a)},peek:ble,pluck:function(e,t){const n=GSe[t]||(GSe[t]=hle(t));return mle(e)?e.map(n):n(e)},span:function(e){return e&&ble(e)-e[0]||0},inrange:function(e,t,n,r){let i,o=t[0],a=t[t.length-1];return o>a&&(i=o,o=a,a=i),r=void 0===r||r,((n=void 0===n||n)?o<=e:o<e)&&(r?e<=a:e<a)},truncate:function(e,t,n,r){const i=null!=r?r:"",o=e+"",a=o.length,s=Math.max(0,t-i.length);return a<=t?o:"left"===n?i+o.slice(a-s):"center"===n?o.slice(0,Math.ceil(s/2))+i+o.slice(a-~~(s/2)):o.slice(0,s)+i},rgb:jM,lab:X5,hcl:e7,hsl:XM,luminance:PSe,contrast:function(e,t){const n=PSe(e),r=PSe(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:Vl,format:xSe,utcFormat:wSe,utcParse:SSe,utcOffset:function(e,t,n){return dye(pye(e),t,n)},utcSequence:function(e,t,n,r){return hye(pye(e),t,n,r)},timeFormat:_Se,timeParse:kSe,timeOffset:function(e,t,n){return dye(cye(e),t,n)},timeSequence:function(e,t,n,r){return hye(cye(e),t,n,r)},timeUnitSpecifier:function(e,t){const n=Ale({},oye,t),r=function(e){const t=Tle(e).slice(),n={};return t.length||dle("Missing time unit."),t.forEach((e=>{Ole(iye,e)?n[e]=1:dle(`Invalid time unit: ${e}.`)})),(n[Kme]||n[Zme]?1:0)+(n[Xme]||n[Yme]||n[Jme]?1:0)+(n[Qme]?1:0)>1&&dle(`Incompatible time units: ${e}`),t.sort(((e,t)=>iye[e]-iye[t])),t}(e),i=r.length;let o,a,s="",u=0;for(u=0;u<i;)for(o=r.length;o>u;--o)if(a=r.slice(u,o).join("-"),null!=n[a]){s+=n[a],u=o;break}return s.trim()},monthFormat:function(e){return MSe.call(this,e,1,"%B")},monthAbbrevFormat:function(e){return MSe.call(this,e,1,"%b")},dayFormat:function(e){return MSe.call(this,0,2+e,"%A")},dayAbbrevFormat:function(e){return MSe.call(this,0,2+e,"%a")},quarter:function(e){return 1+~~(new Date(e).getMonth()/3)},utcquarter:function(e){return 1+~~(new Date(e).getUTCMonth()/3)},week:function(e){return function(e){return Uhe.count(sye(e.getFullYear())-1,e)}(new Date(e))},utcweek:function(e){return function(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Jhe.count(t-1,e)}(new Date(e))},dayofyear:function(e){return function(e){return $he.count(sye(e.getFullYear())-1,e)}(new Date(e))},utcdayofyear:function(e){return function(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return zhe.count(t-1,e)}(new Date(e))},warn:function(){return BSe(this.context.dataflow,"warn",arguments)},info:function(){return BSe(this.context.dataflow,"info",arguments)},debug:function(){return BSe(this.context.dataflow,"debug",arguments)},extent:function(e,t){let n,r,i,o,a=0;if(e&&(n=e.length))if(null==t){for(r=e[a];a<n&&(null==r||r!=r);r=e[++a]);for(i=o=r;a<n;++a)r=e[a],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=t(e[a]);a<n&&(null==r||r!=r);r=t(e[++a]));for(i=o=r;a<n;++a)r=t(e[a]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]},inScope:function(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n},intersect:function(e,t,n){if(!e)return[];const[r,i]=e,o=(new Kxe).set(r[0],r[1],i[0],i[1]);return function(e,t,n){const r=[],i=(new Kxe).union(t),o=e.marktype;return o?uSe(e,i,n,r):"group"===o?lSe(e,i,n,r):dle("Intersect scene must be mark node or group item.")}(n||this.context.dataflow.scenegraph().root,o,function(e){let t=null;if(e){const n=Tle(e.marktype),r=Tle(e.markname);t=e=>(!n.length||n.some((t=>e.marktype===t)))&&(!r.length||r.some((t=>e.name===t)))}return t}(t))},clampRange:function(e,t,n){let r,i=e[0],o=e[1];return o<i&&(r=o,o=i,i=r),r=o-i,r>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-r),i+r]},pinchDistance:function(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)},pinchAngle:function(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)},screen:function(){const e=qSe();return e?e.screen:{}},containerSize:function(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function(){const e=qSe();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]},bandspace:function(e,t,n){return fye(e||0,t||0,n||0)},setdata:function(e,t){const n=this.context.dataflow,r=this.context.data[e].input;return n.pulse(r,n.changeset().remove(gle).insert(t)),1},pathShape:function(e){let t=null;return function(n){return n?kxe(n,t=t||dxe(e)):e}},panLinear:function(e,t){return Cle(e,t,vle,fle)},panLog:function(e,t){var n=Math.sign(e[0]);return Cle(e,t,_le(n),xle(n))},panPow:function(e,t,n){return Cle(e,t,Sle(n),Sle(1/n))},panSymlog:function(e,t,n){return Cle(e,t,wle(n),kle(n))},zoomLinear:function(e,t,n){return Mle(e,t,n,vle,fle)},zoomLog:function(e,t,n){const r=Math.sign(e[0]);return Mle(e,t,n,_le(r),xle(r))},zoomPow:function(e,t,n,r){return Mle(e,t,n,Sle(r),Sle(1/r))},zoomSymlog:function(e,t,n,r){return Mle(e,t,n,wle(r),kle(r))},encode:function(e,t,n){if(e){const n=this.context.dataflow,r=e.mark.source;n.pulse(r,n.changeset().encode(e,t))}return void 0!==n?n:e},modify:function(e,t,n,r,i,o){const a=this.context.dataflow,s=this.context.data[e],u=s.input,l=a.stamp();let c,p,d=s.changes;if(!1===a._trigger||!(u.value.length||t||r))return 0;if((!d||d.stamp<l)&&(s.changes=d=a.changeset(),d.stamp=l,a.runAfter((()=>{s.modified=!0,a.pulse(u,d).run()}),!0,1)),n&&(c=!0===n?gle:mle(n)||lu(n)?n:jSe(n),d.remove(c)),t&&d.insert(t),r&&(c=jSe(r),u.value.some(c)?d.remove(c):d.insert(r)),i)for(p in o)d.modify(i,p,o[p]);return 1}},YSe=["view","item","group","xy","x","y"],KSe="this.",JSe={},ZSe={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${Lle("$"+e)}]`,functions:function(e){const t=Ule(e);YSe.forEach((e=>t[e]="event.vega."+e));for(const e in XSe)t[e]=KSe+e;return Ale(t,function(e,t,n){t.__bandwidth=e=>e&&e.bandwidth?e.bandwidth():0,n._bandwidth=ASe,n._range=ASe,n._scale=ASe;const r=t=>"_["+(t.type===zle?Lle(TSe+t.value):Lle(TSe)+"+"+e(t))+"]";return{_bandwidth:e=>`this.__bandwidth(${r(e[0])})`,_range:e=>`${r(e[0])}.range()`,_scale:t=>`${r(t[0])}(${e(t[1])})`}}(e,XSe,JSe)),t},constants:Gle,visitors:JSe},QSe=function(e){const t=(e=e||{}).allowed?$le(e.allowed):{},n=e.forbidden?$le(e.forbidden):{},r=e.constants||Gle,i=(e.functions||Ule)(p),o=e.globalvar,a=e.fieldvar,s=Ele(o)?o:e=>`${o}["${e}"]`;let u={},l={},c=0;function p(e){if(Ile(e))return e;const t=d[e.type];return null==t&&dle("Unsupported type: "+e.type),t(e)}const d={Literal:e=>e.raw,Identifier:e=>{const i=e.name;return c>0?i:Ole(n,i)?dle("Illegal identifier: "+i):Ole(r,i)?r[i]:Ole(t,i)?i:(u[i]=1,s(i))},MemberExpression:e=>{const t=!e.computed,n=p(e.object);t&&(c+=1);const r=p(e.property);return n===a&&(l[function(e){const t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(r)]=1),t&&(c-=1),n+(t?"."+r:"["+r+"]")},CallExpression:e=>{"Identifier"!==e.callee.type&&dle("Illegal callee type: "+e.callee.type);const t=e.callee.name,n=e.arguments,r=Ole(i,t)&&i[t];return r||dle("Unrecognized function: "+t),Ele(r)?r(n):r+"("+n.map(p).join(",")+")"},ArrayExpression:e=>"["+e.elements.map(p).join(",")+"]",BinaryExpression:e=>"("+p(e.left)+" "+e.operator+" "+p(e.right)+")",UnaryExpression:e=>"("+e.operator+p(e.argument)+")",ConditionalExpression:e=>"("+p(e.test)+"?"+p(e.consequent)+":"+p(e.alternate)+")",LogicalExpression:e=>"("+p(e.left)+e.operator+p(e.right)+")",ObjectExpression:e=>"{"+e.properties.map(p).join(",")+"}",Property:e=>{c+=1;const t=p(e.key);return c-=1,t+":"+p(e.value)}};function h(e){const t={code:p(e),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},t}return h.functions=i,h.constants=r,h}(ZSe);function eCe(e,t,n){return 1===arguments.length?XSe[e]:(XSe[e]=t,n&&(JSe[e]=n),QSe&&(QSe.functions[e]=KSe+e),this)}eCe("bandwidth",(function(e,t){const n=OSe(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}),ASe),eCe("copy",(function(e,t){const n=OSe(e,(t||this).context);return n?n.copy():void 0}),ASe),eCe("domain",(function(e,t){const n=OSe(e,(t||this).context);return n?n.domain():[]}),ASe),eCe("range",(function(e,t){const n=OSe(e,(t||this).context);return n&&n.range?n.range():[]}),ASe),eCe("invert",(function(e,t,n){const r=OSe(e,(n||this).context);return r?mle(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}),ASe),eCe("scale",(function(e,t,n){const r=OSe(e,(n||this).context);return r?r(t):void 0}),ASe),eCe("gradient",(function(e,t,n,r,i){e=OSe(e,(i||this).context);const o=function(e,t){var n,r=[];return n={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:r,stop:function(e,t){return r.push({offset:e,color:t}),n}}}(t,n);let a=e.domain(),s=a[0],u=ble(a),l=fle;return u-s?l=function(e,t,n){const r=n-t;let i,o,a;return r&&Number.isFinite(r)?(i=(o=e.type).indexOf("-"),o=i<0?o:o.slice(i+1),a=Pye(o)().domain([t,n]).range([0,1]),jye.forEach((t=>e[t]?a[t](e[t]()):0)),a):Ele(.5)?.5:()=>.5}(e,s,u):e=(e.interpolator?Pye("sequential")().interpolator(e.interpolator()):Pye("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,u=1]),e.ticks&&(a=e.ticks(+r||15),s!==a[0]&&a.unshift(s),u!==ble(a)&&a.push(u)),a.forEach((t=>o.stop(l(t),e(t)))),o}),ASe),eCe("geoArea",NSe,ASe),eCe("geoBounds",DSe,ASe),eCe("geoCentroid",ISe,ASe),eCe("geoShape",(function(e,t,n){const r=OSe(e,(n||this).context);return function(e){return r?r.path.context(e)(t):""}}),ASe),eCe("indata",(function(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(e,t,n,r){t[0].type!==zle&&dle("First argument to indata must be a string literal."),t[1].type!==zle&&dle("Second argument to indata must be a string literal.");const i=t[0].value,o=t[1].value,a="@"+o;Ole(a,r)||(r[a]=n.getData(i).indataRef(n,o))})),eCe("data",bSe,ESe),eCe("treePath",(function(e,t,n){const r=HSe(e,this),i=r[t],o=r[n];return i&&o?i.path(o).map(VSe):void 0}),ESe),eCe("treeAncestors",(function(e,t){const n=HSe(e,this)[t];return n?n.ancestors().map(VSe):void 0}),ESe),eCe("vlSelectionTest",Uoe,Joe),eCe("vlSelectionIdTest",qoe,Joe),eCe("vlSelectionResolve",Yoe,Joe),eCe("vlSelectionTuples",Xoe);const tCe="view",nCe="[",rCe="]",iCe="{",oCe="}",aCe=":",sCe=",",uCe="@",lCe=">",cCe=/[[\]{}]/,pCe={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let dCe,hCe;function fCe(e,t,n,r,i){const o=e.length;let a,s=0;for(;t<o;++t){if(a=e[t],!s&&a===n)return t;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return t}function gCe(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=fCe(e,i,sCe,nCe+iCe,rCe+oCe),t.push(e.substring(r,i).trim()),r=++i;if(0===t.length)throw"Empty event selector: "+e;return t}function mCe(e){return"["===e[0]?function(e){const t=e.length;let n,r=1;if(r=fCe(e,r,rCe,nCe,rCe),r===t)throw"Empty between selector: "+e;if(n=gCe(e.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+e;if((e=e.slice(r+1).trim())[0]!==lCe)throw"Expected '>' after between selector: "+e;n=n.map(mCe);const i=mCe(e.slice(1).trim());return i.between?{between:n,stream:i}:(i.between=n,i)}(e):function(e){const t={source:dCe},n=[];let r,i,o=[0,0],a=0,s=0,u=e.length,l=0;if(e[u-1]===oCe){if(l=e.lastIndexOf(iCe),!(l>=0))throw"Unmatched right brace: "+e;try{o=function(e){const t=e.split(sCe);if(!e.length||t.length>2)throw e;return t.map((t=>{const n=+t;if(n!=n)throw e;return n}))}(e.substring(l+1,u-1))}catch(t){throw"Invalid throttle specification: "+e}u=(e=e.slice(0,l).trim()).length,l=0}if(!u)throw e;if(e[0]===uCe&&(a=++l),r=fCe(e,l,aCe),r<u&&(n.push(e.substring(s,r).trim()),s=l=++r),l=fCe(e,l,nCe),l===u)n.push(e.substring(s,u).trim());else if(n.push(e.substring(s,l).trim()),i=[],s=++l,s===u)throw"Unmatched left bracket: "+e;for(;l<u;){if(l=fCe(e,l,rCe),l===u)throw"Unmatched left bracket: "+e;if(i.push(e.substring(s,l).trim()),l<u-1&&e[++l]!==nCe)throw"Expected left bracket: "+e;s=++l}if(!(u=n.length)||cCe.test(n[u-1]))throw"Invalid event selector: "+e;var c;return u>1?(t.type=n[1],a?t.markname=n[0].slice(1):(c=n[0],hCe[c]?t.marktype=n[0]:t.source=n[0])):t.type=n[0],"!"===t.type.slice(-1)&&(t.consume=!0,t.type=t.type.slice(0,-1)),null!=i&&(t.filter=i),o[0]&&(t.throttle=o[0]),o[1]&&(t.debounce=o[1]),t}(e)}function yCe(e){return un(e)?e:{type:e||"pad"}}const bCe=e=>+e||0,vCe=e=>({top:e,bottom:e,left:e,right:e});function xCe(e){return un(e)?e.signal?e:{top:bCe(e.top),bottom:bCe(e.bottom),left:bCe(e.left),right:bCe(e.right)}:vCe(bCe(e))}const _Ce=e=>un(e)&&!sn(e)?In({},e):{value:e};function wCe(e,t,n,r){return null!=n?(un(n)&&!sn(n)||sn(n)&&n.length&&un(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function kCe(e,t,n){for(const n in t)wCe(e,n,t[n]);for(const t in n)wCe(e,t,n[t],"update")}function SCe(e,t,n){for(const r in t)n&&Pn(n,r)||(e[r]=In(e[r]||{},t[r]));return e}function CCe(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const MCe="mark",TCe="frame",ECe="scope",ACe="axis",FCe="axis-domain",OCe="axis-grid",RCe="axis-label",NCe="axis-tick",DCe="axis-title",ICe="legend",BCe="legend-band",LCe="legend-entry",PCe="legend-gradient",$Ce="legend-label",zCe="legend-symbol",jCe="legend-title",GCe="title",UCe="title-text",WCe="title-subtitle";function VCe(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const HCe=e=>Vn(e)?Yn(e):e.signal?`(${e.signal})`:KCe(e);function qCe(e){if(null!=e.gradient)return function(e){const t=[e.start,e.stop,e.count].map((e=>null==e?null:Yn(e)));for(;t.length&&null==dn(t);)t.pop();return t.unshift(HCe(e.gradient)),`gradient(${t.join(",")})`}(e);let t=e.signal?`(${e.signal})`:e.color?function(e){return e.c?XCe("hcl",e.h,e.c,e.l):e.h||e.s?XCe("hsl",e.h,e.s,e.l):e.l||e.a?XCe("lab",e.l,e.a,e.b):e.r||e.g||e.b?XCe("rgb",e.r,e.g,e.b):null}(e.color):null!=e.field?KCe(e.field):void 0!==e.value?Yn(e.value):void 0;return null!=e.scale&&(t=function(e,t){const n=HCe(e.scale);return null!=e.range?t=`lerp(_range(${n}), ${+e.range})`:(void 0!==t&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(1==+e.band?"":"*"+YCe(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),null==t&&(t="0")),t}(e,t)),void 0===t&&(t=null),null!=e.exponent&&(t=`pow(${t},${YCe(e.exponent)})`),null!=e.mult&&(t+=`*${YCe(e.mult)}`),null!=e.offset&&(t+=`+${YCe(e.offset)}`),e.round&&(t=`round(${t})`),t}const XCe=(e,t,n,r)=>`(${e}(${[t,n,r].map(qCe).join(",")})+'')`;function YCe(e){return un(e)?"("+qCe(e)+")":e}function KCe(e){return JCe(un(e)?e:{datum:e})}function JCe(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):Vt("Invalid field reference: "+Yn(e));return e.signal||(r=Vn(r)?Ht(r).map(Yn).join("]["):JCe(r)),t+"["+r+"]"}function ZCe(e,t,n,r,i,o){const a={};(o=o||{}).encoders={$encode:a},e=function(e,t,n,r,i){const o={},a={};let s,u,l,c;for(u in u="lineBreak","text"!==t||null==i[u]||CCe(u,e)||VCe(o,u,i[u]),("legend"==n||String(n).startsWith("axis"))&&(n=null),c=n===TCe?i.group:n===MCe?In({},i.mark,i[t]):null,c)l=CCe(u,e)||("fill"===u||"stroke"===u)&&(CCe("fill",e)||CCe("stroke",e)),l||VCe(o,u,c[u]);for(u in Cn(r).forEach((t=>{const n=i.style&&i.style[t];for(const t in n)CCe(t,e)||VCe(o,t,n[t])})),e=In({},e),o)c=o[u],c.signal?(s=s||{})[u]=c:a[u]=c;return e.enter=In(a,e.enter),s&&(e.update=In(s,e.update)),e}(e,t,n,r,i.config);for(const n in e)a[n]=QCe(e[n],t,o,i);return o}function QCe(e,t,n,r){const i={},o={};for(const t in e)null!=e[t]&&(i[t]=eMe((a=e[t],sn(a)?function(e){let t="";return e.forEach((e=>{const n=qCe(e);t+=e.test?`(${e.test})?${n}:`:n})),":"===dn(t)&&(t+="null"),t}(a):qCe(a)),r,n,o));var a;return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function eMe(e,t,n,r){const i=Lae(e,t);return i.$fields.forEach((e=>r[e]=1)),In(n,i.$params),i.$expr}const tMe="outer",nMe=["value","update","init","react","bind"];function rMe(e,t){Vt(e+' for "outer" push: '+Yn(t))}function iMe(e,t){const n=e.name;if(e.push===tMe)t.signals[n]||rMe("No prior signal definition",n),nMe.forEach((t=>{void 0!==e[t]&&rMe("Invalid property ",t)}));else{const r=t.addSignal(n,e.value);!1===e.react&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function oMe(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function aMe(e,t,n,r){return new oMe(e,t,n,r)}function sMe(e,t){return aMe("operator",e,t)}function uMe(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function lMe(e,t){return t?{$field:e,$name:t}:{$field:e}}const cMe=lMe("key");function pMe(e,t){return{$compare:e,$order:t}}function dMe(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const hMe="scope",fMe="view";function gMe(e){return e&&e.signal}function mMe(e){if(gMe(e))return!0;if(un(e))for(const t in e)if(mMe(e[t]))return!0;return!1}function yMe(e,t){return null!=e?e:t}function bMe(e){return e&&e.signal||e}const vMe="timer";function xMe(e,t){return(e.merge?_Me:e.stream?wMe:e.type?kMe:Vt("Invalid stream specification: "+Yn(e)))(e,t)}function _Me(e,t){const n=SMe({merge:e.merge.map((e=>xMe(e,t)))},e,t);return t.addStream(n).id}function wMe(e,t){const n=SMe({stream:xMe(e.stream,t)},e,t);return t.addStream(n).id}function kMe(e,t){let n;var r;e.type===vMe?(n=t.event(vMe,e.throttle),e={between:e.between,filter:e.filter}):n=t.event((r=e.source)===hMe?fMe:r||fMe,e.type);const i=SMe({stream:n},e,t);return 1===Object.keys(i).length?n:t.addStream(i).id}function SMe(e,t,n){let r=t.between;return r&&(2!==r.length&&Vt('Stream "between" parameter must have 2 entries: '+Yn(t)),e.between=[xMe(r[0],n),xMe(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(function(e,t,n){const r="event.item";return r+(e&&"*"!==e?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}(t.marktype,t.markname,t.markrole)),t.source===hMe&&r.push("inScope(event.item)"),r.length&&(e.filter=Lae("("+r.join(")&&(")+")",n).$expr),null!=(r=t.throttle)&&(e.throttle=+r),null!=(r=t.debounce)&&(e.debounce=+r),t.consume&&(e.consume=!0),e}const CMe={code:"_.$value",ast:{type:"Identifier",value:"value"}};function MMe(e){return{signal:"["+e.map((e=>e.scale?'scale("'+e.scale+'")':e.signal))+"]"}}const TMe=e=>(t,n,r)=>aMe(e,n,t||void 0,r),EMe=TMe("aggregate"),AMe=TMe("axisticks"),FMe=TMe("bound"),OMe=TMe("collect"),RMe=TMe("compare"),NMe=TMe("datajoin"),DMe=TMe("encode"),IMe=TMe("expression"),BMe=TMe("facet"),LMe=TMe("field"),PMe=TMe("key"),$Me=TMe("legendentries"),zMe=TMe("load"),jMe=TMe("mark"),GMe=TMe("multiextent"),UMe=TMe("multivalues"),WMe=TMe("overlap"),VMe=TMe("params"),HMe=TMe("prefacet"),qMe=TMe("projection"),XMe=TMe("proxy"),YMe=TMe("relay"),KMe=TMe("render"),JMe=TMe("scale"),ZMe=TMe("sieve"),QMe=TMe("sortitems"),eTe=TMe("viewlayout"),tTe=TMe("values");let nTe=0;const rTe={min:"min",max:"max",count:"sum"};function iTe(e,t){const n=t.getScale(e.name).params;let r;for(r in n.domain=uTe(e.domain,e,t),null!=e.range&&(n.range=mTe(e,t,n)),null!=e.interpolate&&function(e,t){t.interpolate=oTe(e.type||e),null!=e.gamma&&(t.interpolateGamma=oTe(e.gamma))}(e.interpolate,n),null!=e.nice&&(n.nice=function(e){return un(e)?{interval:oTe(e.interval),step:oTe(e.step)}:oTe(e)}(e.nice)),null!=e.bins&&(n.bins=function(e,t){return e.signal||sn(e)?aTe(e,t):t.objectProperty(e)}(e.bins,t)),e)Pn(n,r)||"name"===r||(n[r]=oTe(e[r],t))}function oTe(e,t){return un(e)?e.signal?t.signalRef(e.signal):Vt("Unsupported object: "+Yn(e)):e}function aTe(e,t){return e.signal?t.signalRef(e.signal):e.map((e=>oTe(e,t)))}function sTe(e){Vt("Can not find data set: "+Yn(e))}function uTe(e,t,n){if(e)return e.signal?n.signalRef(e.signal):(sn(e)?lTe:e.fields?pTe:cTe)(e,t,n);null==t.domainMin&&null==t.domainMax||Vt("No scale domain defined for domainMin/domainMax to override.")}function lTe(e,t,n){return e.map((e=>oTe(e,n)))}function cTe(e,t,n){const r=n.getData(e.data);return r||sTe(e.data),ox(t.type)?r.valuesRef(n,e.field,hTe(e.sort,!1)):lx(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function pTe(e,t,n){const r=e.data,i=e.fields.reduce(((e,t)=>(t=Vn(t)?{data:r,field:t}:sn(t)||t.signal?function(e,t){const n="_:vega:_"+nTe++,r=OMe({});if(sn(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+Yn(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,ZMe({})]),{data:n,field:"data"}}(t,n):t,e.push(t),e)),[]);return(ox(t.type)?dTe:lx(t.type)?fTe:gTe)(e,n,i)}function dTe(e,t,n){const r=hTe(e.sort,!0);let i,o;const a=n.map((e=>{const n=t.getData(e.data);return n||sTe(e.data),n.countsRef(t,e.field,r)})),s={groupby:cMe,pulse:a};r&&(i=r.op||"count",o=r.field?dMe(i,r.field):"count",s.ops=[rTe[i]],s.fields=[t.fieldRef(o)],s.as=[o]),i=t.add(EMe(s));const u=t.add(OMe({pulse:uMe(i)}));return o=t.add(tTe({field:cMe,sort:t.sortRef(r),pulse:uMe(u)})),uMe(o)}function hTe(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field&&e.op&&!rTe[e.op]&&Vt("Multiple domain scales can not be sorted using "+e.op):Vt("No field provided for sort aggregate op: "+e.op):un(e)?e.field="key":e={field:"key"}),e}function fTe(e,t,n){const r=n.map((e=>{const n=t.getData(e.data);return n||sTe(e.data),n.domainRef(t,e.field)}));return uMe(t.add(UMe({values:r})))}function gTe(e,t,n){const r=n.map((e=>{const n=t.getData(e.data);return n||sTe(e.data),n.extentRef(t,e.field)}));return uMe(t.add(GMe({extents:r})))}function mTe(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(Vn(i)){if(r&&Pn(r,i))return mTe(e=In({},e,{range:r[i]}),t,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=ox(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Vt("Unrecognized scale range value: "+Yn(i))}else{if(i.scheme)return n.scheme=sn(i.scheme)?aTe(i.scheme,t):oTe(i.scheme,t),i.extent&&(n.schemeExtent=aTe(i.extent,t)),void(i.count&&(n.schemeCount=oTe(i.count,t)));if(i.step)return void(n.rangeStep=oTe(i.step,t));if(ox(e.type)&&!sn(i))return uTe(i,e,t);sn(i)||Vt("Unsupported range type: "+Yn(i))}return i.map((e=>(sn(e)?aTe:oTe)(e,t)))}function yTe(e,t,n){return sn(e)?e.map((e=>yTe(e,t,n))):un(e)?e.signal?n.signalRef(e.signal):"fit"===t?e:Vt("Unsupported parameter object: "+Yn(e)):e}const bTe="top",vTe="left",xTe="right",_Te="bottom",wTe="center",kTe="vertical",STe="start",CTe="end",MTe="index",TTe="label",ETe="offset",ATe="perc",FTe="perc2",OTe="value",RTe="guide-label",NTe="guide-title",DTe="group-title",ITe="group-subtitle",BTe="symbol",LTe="gradient",PTe="discrete",$Te="size",zTe=[$Te,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],jTe={name:1,style:1,interactive:1},GTe={value:0},UTe={value:1},WTe="group",VTe="rect",HTe="rule",qTe="symbol",XTe="text";function YTe(e){return e.type=WTe,e.interactive=e.interactive||!1,e}function KTe(e,t){const n=(n,r)=>yMe(e[n],yMe(t[n],r));return n.isVertical=n=>kTe===yMe(e.direction,t.direction||(n?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>yMe(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>yMe(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>yMe(e.columns,yMe(t.columns,+n.isVertical(!0))),n}function JTe(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function ZTe(e,t,n){return`item.anchor === '${STe}' ? ${e} : item.anchor === '${CTe}' ? ${t} : ${n}`}const QTe=ZTe(Yn(vTe),Yn(xTe),Yn(wTe));function eEe(e,t){return t?e?un(e)?Object.assign({},e,{offset:eEe(e.offset,t)}):{value:e,offset:t}:t:e}function tEe(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=SCe(e.encode,t,jTe)):e.interactive=!1,e}function nEe(e,t,n,r){const i=KTe(e,n),o=i.isVertical(),a=i.gradientThickness(),s=i.gradientLength();let u,l,c,p,d;o?(l=[0,1],c=[0,0],p=a,d=s):(l=[0,0],c=[1,0],p=s,d=a);const h={enter:u={opacity:GTe,x:GTe,y:GTe,width:_Ce(p),height:_Ce(d)},update:In({},u,{opacity:UTe,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:GTe}};return kCe(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),tEe({type:VTe,role:PCe,encode:h},r)}function rEe(e,t,n,r,i){const o=KTe(e,n),a=o.isVertical(),s=o.gradientThickness(),u=o.gradientLength();let l,c,p,d,h="";a?(l="y",p="y2",c="x",d="width",h="1-"):(l="x",p="x2",c="y",d="height");const f={opacity:GTe,fill:{scale:t,field:OTe}};f[l]={signal:h+"datum."+ATe,mult:u},f[c]=GTe,f[p]={signal:h+"datum."+FTe,mult:u},f[d]=_Ce(s);const g={enter:f,update:In({},f,{opacity:UTe}),exit:{opacity:GTe}};return kCe(g,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),tEe({type:VTe,role:BCe,key:OTe,from:i,encode:g},r)}const iEe=`datum.${ATe}<=0?"${vTe}":datum.${ATe}>=1?"${xTe}":"${wTe}"`,oEe=`datum.${ATe}<=0?"${_Te}":datum.${ATe}>=1?"${bTe}":"middle"`;function aEe(e,t,n,r){const i=KTe(e,t),o=i.isVertical(),a=_Ce(i.gradientThickness()),s=i.gradientLength();let u,l,c,p,d=i("labelOverlap"),h="";const f={enter:u={opacity:GTe},update:l={opacity:UTe,text:{field:TTe}},exit:{opacity:GTe}};return kCe(f,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:yMe(e.labelLimit,t.gradientLabelLimit)}),o?(u.align={value:"left"},u.baseline=l.baseline={signal:oEe},c="y",p="x",h="1-"):(u.align=l.align={signal:iEe},u.baseline={value:"top"},c="x",p="y"),u[c]=l[c]={signal:h+"datum."+ATe,mult:s},u[p]=l[p]=a,a.offset=yMe(e.labelOffset,t.gradientLabelOffset)||0,d=d?{separation:i("labelSeparation"),method:d,order:"datum."+MTe}:void 0,tEe({type:XTe,role:$Ce,style:RTe,key:OTe,from:r,encode:f,overlap:d},n)}function sEe(e,t,n,r,i){const o=KTe(e,t),a=n.entries,s=!(!a||!a.interactive),u=a?a.name:void 0,l=o("clipHeight"),c=o("symbolOffset"),p={data:"value"},d=`(${i}) ? datum.${ETe} : datum.${$Te}`,h=l?_Ce(l):{field:$Te},f=`datum.${MTe}`,g=`max(1, ${i})`;let m,y,b,v,x;h.mult=.5,m={enter:y={opacity:GTe,x:{signal:d,mult:.5,offset:c},y:h},update:b={opacity:UTe,x:y.x,y:y.y},exit:{opacity:GTe}};let _=null,w=null;e.fill||(_=t.symbolBaseFillColor,w=t.symbolBaseStrokeColor),kCe(m,{fill:o("symbolFillColor",_),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",w),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),zTe.forEach((t=>{e[t]&&(b[t]=y[t]={scale:e[t],field:OTe})}));const k=tEe({type:qTe,role:zCe,key:OTe,from:p,clip:!!l||void 0,encode:m},n.symbols),S=_Ce(c);S.offset=o("labelOffset"),m={enter:y={opacity:GTe,x:{signal:d,offset:S},y:h},update:b={opacity:UTe,text:{field:TTe},x:y.x,y:y.y},exit:{opacity:GTe}},kCe(m,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const C=tEe({type:XTe,role:$Ce,style:RTe,key:OTe,from:p,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:GTe,height:l?_Ce(l):GTe,opacity:GTe},exit:{opacity:GTe},update:b={opacity:UTe,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(v=`ceil(item.mark.items.length / ${g})`,b.row.signal=`${f}%${v}`,b.column.signal=`floor(${f} / ${v})`,x={field:["row",f]}):(b.row.signal=`floor(${f} / ${g})`,b.column.signal=`${f} % ${g}`,x={field:f}),b.column.signal=`(${i})?${b.column.signal}:${f}`,YTe({role:ECe,from:r={facet:{data:r,name:"value",groupby:MTe}},encode:SCe(m,a,jTe),marks:[k,C],name:u,interactive:s,sort:x})}const uEe='item.orient === "left"',lEe='item.orient === "right"',cEe=`(${uEe} || ${lEe})`,pEe=`datum.vgrad && ${cEe}`,dEe=ZTe('"top"','"bottom"','"middle"'),hEe=`datum.vgrad && ${lEe} ? (${ZTe('"right"','"left"','"center"')}) : (${cEe} && !(datum.vgrad && ${uEe})) ? "left" : ${QTe}`,fEe=`item._anchor || (${cEe} ? "middle" : "start")`,gEe=`${pEe} ? (${uEe} ? -90 : 90) : 0`,mEe=`${cEe} ? (datum.vgrad ? (${lEe} ? "bottom" : "top") : ${dEe}) : "top"`;function yEe(e,t){let n;return un(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+bEe(e.path)+")":e.sphere&&(n="geoShape("+bEe(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function bEe(e){return un(e)&&e.signal?e.signal:Yn(e)}function vEe(e){const t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")&&t.indexOf("title")?e.type===WTe?ECe:t||MCe:t}function xEe(e){return{marktype:e.type,name:e.name||void 0,role:e.role||vEe(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function _Ee(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}function wEe(e,t){const n=Wu(e.type);n||Vt("Unrecognized transform type: "+Yn(e.type));const r=aMe(n.type.toLowerCase(),null,kEe(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function kEe(e,t,n){const r={},i=e.params.length;for(let o=0;o<i;++o){const i=e.params[o];r[i.name]=SEe(i,t,n)}return r}function SEe(e,t,n){const r=e.type,i=t[e.name];return"index"===r?function(e,t,n){return Vn(t.from)||Vt('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}(0,t,n):void 0!==i?"param"===r?function(e,t,n){const r=t[e.name];return e.array?(sn(r)||Vt("Expected an array of sub-parameters. Instead: "+Yn(r)),r.map((t=>MEe(e,t,n)))):MEe(e,r,n)}(e,t,n):"projection"===r?n.projectionRef(t[e.name]):e.array&&!gMe(i)?i.map((t=>CEe(e,t,n))):CEe(e,i,n):void(e.required&&Vt("Missing required "+Yn(t.type)+" parameter: "+Yn(e.name)))}function CEe(e,t,n){const r=e.type;if(gMe(t))return FEe(r)?Vt("Expression references can not be signals."):OEe(r)?n.fieldRef(t):REe(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||OEe(r);return i&&TEe(t)?n.exprRef(t.expr,t.as):i&&EEe(t)?lMe(t.field,t.as):FEe(r)?Lae(t,n):AEe(r)?uMe(n.getData(t).values):OEe(r)?lMe(t):REe(r)?n.compareRef(t):t}}function MEe(e,t,n){const r=e.params.length;let i;for(let n=0;n<r;++n){i=e.params[n];for(const e in i.key)if(i.key[e]!==t[e]){i=null;break}if(i)break}i||Vt("Unsupported parameter: "+Yn(t));const o=In(kEe(i,t,n),i.key);return uMe(n.add(VMe(o)))}const TEe=e=>e&&e.expr,EEe=e=>e&&e.field,AEe=e=>"data"===e,FEe=e=>"expr"===e,OEe=e=>"field"===e,REe=e=>"compare"===e;function NEe(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:uMe(t.getData(e.data).output)}function DEe(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}function IEe(e){return Vn(e)?e:null}function BEe(e,t,n){const r=dMe(n.op,n.field);let i;if(t.ops){for(let e=0,n=t.as.length;e<n;++e)if(t.as[e]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function LEe(e,t,n,r,i,o,a){const s=t[n]||(t[n]={}),u=function(e){return un(e)?("descending"===e.order?"-":"+")+dMe(e.op,e.field):""}(o);let l,c,p=IEe(i);if(null!=p&&(e=t.scope,p+=u?"|"+u:"",l=s[p]),!l){const n=o?{field:cMe,pulse:t.countsRef(e,i,o)}:{field:e.fieldRef(i),pulse:uMe(t.output)};u&&(n.sort=e.sortRef(o)),c=e.add(aMe(r,void 0,n)),a&&(t.index[i]=c),l=uMe(c),null!=p&&(s[p]=l)}return l}function PEe(e,t,n){const r=e.remove,i=e.insert,o=e.toggle,a=e.modify,s=e.values,u=t.add(sMe()),l=Lae("if("+e.trigger+',modify("'+n+'",'+[i,r,o,a,s].map((e=>null==e?"null":e)).join(",")+"),0)",t);u.update=l.$expr,u.params=l.$params}function $Ee(e,t){const n=vEe(e),r=e.type===WTe,i=e.from&&e.from.facet,o=e.overlap;let a,s,u,l,c,p,d,h=e.layout||n===ECe||n===TCe;const f=n===MCe||h||i,g=function(e,t,n){let r,i,o,a,s;return e?(r=e.facet)&&(t||Vt("Only group marks can be faceted."),null!=r.field?a=s=NEe(r,n):(e.data?s=uMe(n.getData(e.data).aggregate):(o=wEe(In({type:"aggregate",groupby:Cn(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=NEe(r,n),a=s=uMe(n.add(o))),i=n.keyRef(r.groupby,!0))):a=uMe(n.add(OMe(null,[{}]))),a||(a=NEe(e,n)),{key:i,pulse:a,parent:s}}(e.from,r,t);s=t.add(NMe({key:g.key||(e.key?lMe(e.key):void 0),pulse:g.pulse,clean:!r}));const m=uMe(s);s=u=t.add(OMe({pulse:m})),s=t.add(jMe({markdef:xEe(e),interactive:_Ee(e.interactive,t),clip:yEe(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:uMe(s)}));const y=uMe(s);s=l=t.add(DMe(ZCe(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),s.params.parent=t.encode(),e.transform&&e.transform.forEach((e=>{const n=wEe(e,t),r=n.metadata;(r.generates||r.changes)&&Vt("Mark transforms should not generate new data."),r.nomod||(l.params.mod=!0),n.params.pulse=uMe(s),t.add(s=n)})),e.sort&&(s=t.add(QMe({sort:t.compareRef(e.sort),pulse:uMe(s)})));const b=uMe(s);(i||h)&&(h=t.add(eTe({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:b})),p=uMe(h));const v=t.add(FMe({mark:y,pulse:p||b}));d=uMe(v),r&&(f&&(a=t.operators,a.pop(),h&&a.pop()),t.pushState(b,p||d,m),i?function(e,t,n){const r=e.from.facet,i=r.name,o=NEe(r,t);let a;r.name||Vt("Facet must have a name: "+Yn(r)),r.data||Vt("Facet must reference a data set: "+Yn(r)),r.field?a=t.add(HMe({field:t.fieldRef(r.field),pulse:o})):r.groupby?a=t.add(BMe({key:t.keyRef(r.groupby),group:uMe(t.proxy(n.parent)),pulse:o})):Vt("Facet must specify groupby or field: "+Yn(r));const s=t.fork(),u=s.add(OMe()),l=s.add(ZMe({pulse:uMe(u)}));s.addData(i,new DEe(s,u,u,l)),s.addSignal("parent",null),a.params.subflow={$subflow:s.parse(e).toRuntime()}}(e,t,g):f?function(e,t,n){const r=t.add(HMe({pulse:n.pulse})),i=t.fork();i.add(ZMe()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}(e,t,g):t.parse(e),t.popState(),f&&(h&&a.push(h),a.push(v))),o&&(d=function(e,t,n){const r=e.method,i=e.bound,o=e.separation,a={separation:gMe(o)?n.signalRef(o.signal):o,method:gMe(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(a.sort=n.compareRef({field:e.order})),i){const e=i.tolerance;a.boundTolerance=gMe(e)?n.signalRef(e.signal):+e,a.boundScale=n.scaleRef(i.scale),a.boundOrient=i.orient}return uMe(n.add(WMe(a)))}(o,d,t));const x=t.add(KMe({pulse:d})),_=t.add(ZMe({pulse:uMe(x)},void 0,t.parent()));null!=e.name&&(c=e.name,t.addData(c,new DEe(t,u,x,_)),e.on&&e.on.forEach((e=>{(e.insert||e.remove||e.toggle)&&Vt("Marks only support modify triggers."),PEe(e,t,c)})))}function zEe(e,t,n){const r={enter:{},update:{}};return kCe(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function jEe(e,t,n){return t[e]?`scale("${t[e]}",datum)`:JTe(e,n[0].encode)}DEe.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let o=t[0],a=null,s=1;for(o&&"load"===o.type&&(o=t[1]),e.add(t[0]);s<n;++s)t[s].params.pulse=uMe(t[s-1]),e.add(t[s]),"aggregate"===t[s].type&&(a=t[s]);return new DEe(e,o,i,r,a)},DEe.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),o=IEe(t);let a,s,u;return null!=o&&(e=r.scope,a=i[o]),a?n&&n.field&&BEe(e,a.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:uMe(r.output)},n&&n.field&&BEe(e,u,n),s=e.add(EMe(u)),a=e.add(OMe({pulse:uMe(s)})),a={agg:s,ref:uMe(a)},null!=o&&(i[o]=a)),a.ref},tuplesRef(){return uMe(this.values)},extentRef(e,t){return LEe(e,this,"extent","extent",t,!1)},domainRef(e,t){return LEe(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return LEe(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return LEe(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return LEe(e,this,"indata","tupleindex",t,!0,!0)}};const GEe=`item.orient==="${vTe}"?-90:item.orient==="${xTe}"?90:0`;function UEe(e,t){const n={enter:{},update:{}};return kCe(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:QTe},angle:{signal:GEe},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),SCe(n,t,jTe)}function WEe(e){const t=OMe({},e);return t.metadata={source:!0},t}function VEe(e,t){return zMe({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const HEe=e=>e===_Te||e===bTe,qEe=(e,t,n)=>gMe(e)?eAe(e.signal,t,n):e===vTe||e===bTe?t:n,XEe=(e,t,n)=>gMe(e)?ZEe(e.signal,t,n):HEe(e)?t:n,YEe=(e,t,n)=>gMe(e)?QEe(e.signal,t,n):HEe(e)?n:t,KEe=(e,t,n)=>gMe(e)?tAe(e.signal,t,n):e===bTe?{value:t}:{value:n},JEe=(e,t,n)=>gMe(e)?nAe(e.signal,t,n):e===xTe?{value:t}:{value:n},ZEe=(e,t,n)=>rAe(`${e} === '${bTe}' || ${e} === '${_Te}'`,t,n),QEe=(e,t,n)=>rAe(`${e} !== '${bTe}' && ${e} !== '${_Te}'`,t,n),eAe=(e,t,n)=>oAe(`${e} === '${vTe}' || ${e} === '${bTe}'`,t,n),tAe=(e,t,n)=>oAe(`${e} === '${bTe}'`,t,n),nAe=(e,t,n)=>oAe(`${e} === '${xTe}'`,t,n),rAe=(e,t,n)=>(t=null!=t?_Ce(t):t,n=null!=n?_Ce(n):n,iAe(t)&&iAe(n)?{signal:`${e} ? (${t=t?t.signal||Yn(t.value):null}) : (${n=n?n.signal||Yn(n.value):null})`}:[In({test:e},t)].concat(n||[])),iAe=e=>null==e||1===Object.keys(e).length,oAe=(e,t,n)=>({signal:`${e} ? (${sAe(t)}) : (${sAe(n)})`}),aAe=(e,t,n,r,i)=>({signal:(null!=r?`${e} === '${vTe}' ? (${sAe(r)}) : `:"")+(null!=n?`${e} === '${_Te}' ? (${sAe(n)}) : `:"")+(null!=i?`${e} === '${xTe}' ? (${sAe(i)}) : `:"")+(null!=t?`${e} === '${bTe}' ? (${sAe(t)}) : `:"")+"(null)"}),sAe=e=>gMe(e)?e.signal:null==e?null:Yn(e),uAe=(e,t)=>0===t?0:gMe(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},lAe=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function cAe(e,t,n,r){let i;if(t&&Pn(t,e))return t[e];if(Pn(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[NTe][i]}if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[RTe][i]}return null}function pAe(e){const t={};for(const n of e)if(n)for(const e in n)t[e]=1;return Object.keys(t)}function dAe(e,t){return{scale:e.scale,range:t}}function hAe(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function fAe(e,t){const n=function(e,t){var n,r,i,o=t.config,a=o.style,s=o.axis,u="band"===t.scaleType(e.scale)&&o.axisBand,l=e.orient;if(gMe(l)){const e=pAe([o.axisX,o.axisY]),t=pAe([o.axisTop,o.axisBottom,o.axisLeft,o.axisRight]);for(i of(n={},e))n[i]=XEe(l,cAe(i,o.axisX,s,a),cAe(i,o.axisY,s,a));for(i of(r={},t))r[i]=aAe(l.signal,cAe(i,o.axisTop,s,a),cAe(i,o.axisBottom,s,a),cAe(i,o.axisLeft,s,a),cAe(i,o.axisRight,s,a))}else n=l===bTe||l===_Te?o.axisX:o.axisY,r=o["axis"+l[0].toUpperCase()+l.slice(1)];return n||r||u?In({},s,n,r,u):s}(e,t),r=e.encode||{},i=r.axis||{},o=i.name||void 0,a=i.interactive,s=i.style,u=KTe(e,n),l=function(e){const t=e("tickBand");let n,r,i=e("tickOffset");return t?t.signal?(n={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},un(i)||(i={signal:`(${t.signal}) === 'extent' ? 0 : ${i}`})):"extent"===t?(n=1,r=!0,i=0):(n=.5,r=!1):(n=e("bandPosition"),r=e("tickExtra")),{extra:r,band:n,offset:i}}(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:null!=e.title},p=uMe(t.add(OMe({},[c]))),d=uMe(t.add(AMe({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let f;return c.grid&&h.push(function(e,t,n,r,i){const o=KTe(e,t),a=e.orient,s=e.gridScale,u=qEe(a,1,-1),l=function(e,t){if(1===t);else if(un(e)){let n=e=In({},e);for(;null!=n.mult;){if(!un(n.mult))return n.mult=gMe(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n=n.mult=In({},n.mult)}n.mult=t}else e=gMe(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);return e}(e.offset,u);let c,p,d;const h={enter:c={opacity:GTe},update:d={opacity:UTe},exit:p={opacity:GTe}};kCe(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const f={scale:e.scale,field:OTe,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},g=XEe(a,{signal:"height"},{signal:"width"}),m=s?{scale:s,range:0,mult:u,offset:l}:{value:0,offset:l},y=s?{scale:s,range:1,mult:u,offset:l}:In(g,{mult:u,offset:l});return c.x=d.x=XEe(a,f,m),c.y=d.y=YEe(a,f,m),c.x2=d.x2=YEe(a,y),c.y2=d.y2=XEe(a,y),p.x=XEe(a,f),p.y=YEe(a,f),tEe({type:HTe,role:OCe,key:OTe,from:r,encode:h},n)}(e,n,r.grid,d,l)),c.ticks&&(f=u("tickSize"),h.push(function(e,t,n,r,i,o){const a=KTe(e,t),s=e.orient,u=qEe(s,-1,1);let l,c,p;const d={enter:l={opacity:GTe},update:p={opacity:UTe},exit:c={opacity:GTe}};kCe(d,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const h=_Ce(i);h.mult=u;const f={scale:e.scale,field:OTe,band:o.band,extra:o.extra,offset:o.offset,round:a("tickRound")};return p.y=l.y=XEe(s,GTe,f),p.y2=l.y2=XEe(s,h),c.x=XEe(s,f),p.x=l.x=YEe(s,GTe,f),p.x2=l.x2=YEe(s,h),c.y=YEe(s,f),tEe({type:HTe,role:NCe,key:OTe,from:r,encode:d},n)}(e,n,r.ticks,d,f,l))),c.labels&&(f=c.ticks?f:0,h.push(function(e,t,n,r,i,o){const a=KTe(e,t),s=e.orient,u=e.scale,l=qEe(s,-1,1),c=bMe(a("labelFlush")),p=bMe(a("labelFlushOffset")),d=a("labelAlign"),h=a("labelBaseline");let f,g=0===c||!!c;const m=_Ce(i);m.mult=l,m.offset=_Ce(a("labelPadding")||0),m.offset.mult=l;const y={scale:u,field:OTe,band:.5,offset:eEe(o.offset,a("labelOffset"))},b=XEe(s,g?hAe(u,c,'"left"','"right"','"center"'):{value:"center"},JEe(s,"left","right")),v=XEe(s,KEe(s,"bottom","top"),g?hAe(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=hAe(u,c,`-(${p})`,p,0);g=g&&p;const _={opacity:GTe,x:XEe(s,y,m),y:YEe(s,y,m)},w={enter:_,update:f={opacity:UTe,text:{field:TTe},x:_.x,y:_.y,align:b,baseline:v},exit:{opacity:GTe,x:_.x,y:_.y}};kCe(w,{dx:!d&&g?XEe(s,x):null,dy:!h&&g?YEe(s,x):null}),kCe(w,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:d,baseline:h});const k=a("labelBound");let S=a("labelOverlap");return S=S||k?{separation:a("labelSeparation"),method:S,order:"datum.index",bound:k?{scale:u,orient:s,tolerance:k}:null}:void 0,f.align!==b&&(f.align=lAe(f.align,b)),f.baseline!==v&&(f.baseline=lAe(f.baseline,v)),tEe({type:XTe,role:RCe,style:RTe,key:OTe,from:r,encode:w,overlap:S},n)}(e,n,r.labels,d,f,l))),c.domain&&h.push(function(e,t,n,r){const i=KTe(e,t),o=e.orient;let a,s;const u={enter:a={opacity:GTe},update:s={opacity:UTe},exit:{opacity:GTe}};kCe(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const l=dAe(e,0),c=dAe(e,1);return a.x=s.x=XEe(o,l,GTe),a.x2=s.x2=XEe(o,c),a.y=s.y=YEe(o,l,GTe),a.y2=s.y2=YEe(o,c),tEe({type:HTe,role:FCe,from:r,encode:u},n)}(e,n,r.domain,p)),c.title&&h.push(function(e,t,n,r){const i=KTe(e,t),o=e.orient,a=qEe(o,-1,1);let s,u;const l={enter:s={opacity:GTe,anchor:_Ce(i("titleAnchor",null)),align:{signal:QTe}},update:u=In({},s,{opacity:UTe,text:_Ce(e.title)}),exit:{opacity:GTe}},c={signal:`lerp(range("${e.scale}"), ${ZTe(0,1,.5)})`};return u.x=XEe(o,c),u.y=YEe(o,c),s.angle=XEe(o,GTe,uAe(a,90)),s.baseline=XEe(o,KEe(o,_Te,bTe),{value:_Te}),u.angle=s.angle,u.baseline=s.baseline,kCe(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),function(e,t,n,r){const i=(e,t)=>null!=e?(n.update[t]=lAe(_Ce(e),n.update[t]),!1):!CCe(t,r),o=i(e("titleX"),"x"),a=i(e("titleY"),"y");n.enter.auto=a===o?_Ce(a):XEe(t,_Ce(a),_Ce(o))}(i,o,l,n),l.update.align=lAe(l.update.align,s.align),l.update.angle=lAe(l.update.angle,s.angle),l.update.baseline=lAe(l.update.baseline,s.baseline),tEe({type:XTe,role:DCe,style:NTe,from:r,encode:l},n)}(e,n,r.title,p)),$Ee(YTe({role:ACe,from:p,encode:SCe(gAe(u,e),i,jTe),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:o,interactive:a,style:s}),t)}function gAe(e,t){const n={enter:{},update:{}};return kCe(n,{orient:e("orient"),offset:e("offset")||0,position:yMe(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function mAe(e,t,n){const r=Cn(e.signals),i=Cn(e.scales);return n||r.forEach((e=>iMe(e,t))),Cn(e.projections).forEach((e=>function(e,t){const n=t.config.projection||{},r={};for(const n in e)"name"!==n&&(r[n]=yTe(e[n],n,t));for(const e in n)null==r[e]&&(r[e]=yTe(n[e],e,t));t.addProjection(e.name,r)}(e,t))),i.forEach((e=>function(e,t){const n=e.type||"linear";nx(n)||Vt("Unrecognized scale type: "+Yn(n)),t.addScale(e.name,{type:n,domain:void 0})}(e,t))),Cn(e.data).forEach((e=>function(e,t){const n=[];e.transform&&e.transform.forEach((e=>{n.push(wEe(e,t))})),e.on&&e.on.forEach((n=>{PEe(n,t,e.name)})),t.addDataPipeline(e.name,function(e,t,n){const r=[];let i,o,a,s,u,l=null,c=!1,p=!1;for(e.values?gMe(e.values)||mMe(e.format)?(r.push(VEe(t,e)),r.push(l=WEe())):r.push(l=WEe({$ingest:e.values,$format:e.format})):e.url?mMe(e.url)||mMe(e.format)?(r.push(VEe(t,e)),r.push(l=WEe())):r.push(l=WEe({$request:e.url,$format:e.format})):e.source&&(l=i=Cn(e.source).map((e=>uMe(t.getData(e).output))),r.push(null)),o=0,a=n.length;o<a;++o)s=n[o],u=s.metadata,l||u.source||r.push(l=WEe()),r.push(s),u.generates&&(p=!0),u.modifies&&!p&&(c=!0),u.source?l=s:u.changes&&(l=null);return i&&(a=i.length-1,r[0]=YMe({derive:c,pulse:a?i:i[0]}),(c||a)&&r.splice(1,0,WEe())),l||r.push(WEe()),r.push(ZMe({})),r}(e,t,n))}(e,t))),i.forEach((e=>iTe(e,t))),(n||r).forEach((e=>function(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?Vt("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=Lae(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach((e=>function(e,t,n){const r=e.encode,i={target:n};let o=e.events,a=e.update,s=[];var u,l;o||Vt("Signal update missing events specification."),Vn(o)&&(u=o,l=t.isSubscope()?hMe:fMe,dCe=l||tCe,hCe=pCe,o=gCe(u.trim()).map(mCe)),o=Cn(o).filter((e=>e.signal||e.scale?(s.push(e),0):1)),s.length>1&&(s=[MMe(s)]),o.length&&s.push(o.length>1?{merge:o}:o[0]),null!=r&&(a&&Vt("Signal encode and update are mutually exclusive."),a="encode(item(),"+Yn(r)+")"),i.update=Vn(a)?Lae(a,t):null!=a.expr?Lae(a.expr,t):null!=a.value?a.value:null!=a.signal?{$expr:CMe,$params:{$value:t.signalRef(a.signal)}}:Vt("Invalid signal update specification."),e.force&&(i.options={force:!0}),s.forEach((e=>t.addUpdate(In(function(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):xMe(e,t)}}(e,t),i))))}(e,t,n.id)))}(e,t))),Cn(e.axes).forEach((e=>fAe(e,t))),Cn(e.marks).forEach((e=>$Ee(e,t))),Cn(e.legends).forEach((e=>function(e,t){const n=t.config.legend,r=e.encode||{},i=KTe(e,n),o=r.legend||{},a=o.name||void 0,s=o.interactive,u=o.style,l={};let c,p,d,h=0;zTe.forEach((t=>e[t]?(l[t]=e[t],h=h||e[t]):0)),h||Vt("Missing valid scale for legend.");const f=function(e,t){let n=e.type||BTe;return e.type||1!==function(e){return zTe.reduce(((t,n)=>t+(e[n]?1:0)),0)}(e)||!e.fill&&!e.stroke||(n=ix(t)?LTe:ax(t)?PTe:BTe),n!==LTe?n:ax(t)?PTe:LTe}(e,t.scaleType(h)),g={title:null!=e.title,scales:l,type:f,vgrad:"symbol"!==f&&i.isVertical()},m=uMe(t.add(OMe(null,[g]))),y=uMe(t.add($Me(p={type:f,scale:t.scaleRef(h),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return f===LTe?(d=[nEe(e,h,n,r.gradient),aEe(e,n,r.labels,y)],p.count=p.count||t.signalRef(`max(2,2*floor((${bMe(i.gradientLength())})/100))`)):f===PTe?d=[rEe(e,h,n,r.gradient,y),aEe(e,n,r.labels,y)]:(c=function(e,t){const n=KTe(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(e,n),d=[sEe(e,n,r,y,bMe(c.columns))],p.size=function(e,t,n){const r=bMe(jEe("size",e,n)),i=bMe(jEe("strokeWidth",e,n)),o=bMe(function(e,t,n){return JTe("fontSize",e)||function(e,t,n){const r=t.config.style[n];return r&&r.fontSize}(0,t,n)}(n[1].encode,t,RTe));return Lae(`max(ceil(sqrt(${r})+${i}),${o})`,t)}(e,t,d[0].marks)),d=[YTe({role:LCe,from:m,encode:{enter:{x:{value:0},y:{value:0}}},marks:d,layout:c,interactive:s})],g.title&&d.push(function(e,t,n,r){const i=KTe(e,t),o={enter:{opacity:GTe},update:{opacity:UTe,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:GTe}};return kCe(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:fEe},angle:{signal:gEe},align:{signal:hEe},baseline:{signal:mEe},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),tEe({type:XTe,role:jCe,style:NTe,from:r,encode:o},n)}(e,n,r.title,m)),$Ee(YTe({role:ICe,from:m,encode:SCe(zEe(i,e,n),o,jTe),marks:d,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:a,interactive:s,style:u}),t)}(e,t))),e.title&&function(e,t){const n=KTe(e=Vn(e)?{text:e}:e,t.config.title),r=e.encode||{},i=r.group||{},o=i.name||void 0,a=i.interactive,s=i.style,u=[],l=uMe(t.add(OMe(null,[{}])));u.push(function(e,t,n,r){const i={value:0},o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return kCe(o,{text:e.text,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),tEe({type:XTe,role:UCe,style:DTe,from:r,encode:o},n)}(e,n,function(e){const t=e.encode;return t&&t.title||In({name:e.name,interactive:e.interactive,style:e.style},t)}(e),l)),e.subtitle&&u.push(function(e,t,n,r){const i={value:0},o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return kCe(o,{text:e.subtitle,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),tEe({type:XTe,role:WCe,style:ITe,from:r,encode:o},n)}(e,n,r.subtitle,l)),$Ee(YTe({role:GCe,from:l,encode:UEe(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:a,style:s}),t)}(e.title,t),t.parseLambdas(),t}const yAe=e=>SCe({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function bAe(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function vAe(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function xAe(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function _Ae(e){return(sn(e)?wAe:kAe)(e)}function wAe(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const t=e[r];n+=(r>0?",":"")+(un(t)?t.signal||_Ae(t):Yn(t))}return n+"]"}function kAe(e){let t,n,r="{",i=0;for(t in e)n=e[t],r+=(++i>1?",":"")+Yn(t)+":"+(un(n)?n.signal||_Ae(n):Yn(n));return r+"}"}function SAe(e,t,n){return un(e)||Vt("Input Vega specification must be an object."),t=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(((e,t)=>{for(const n in t)if("signals"===n)e.signals=pn(e.signals,t.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;cn(e,n,t[n],r)}return e}),{})}(function(){const e="sans-serif",t="#4c78a8",n="#000",r="#888",i="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:t},area:{fill:t},image:null,line:{stroke:t,strokeWidth:2},path:{stroke:t},rect:{fill:t},rule:{stroke:n},shape:{stroke:t},symbol:{fill:t,size:64},text:{fill:n,font:e,fontSize:11},trail:{fill:t,size:2},style:{"guide-label":{fill:n,font:e,fontSize:10},"guide-title":{fill:n,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:n,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:n,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:i}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:r,grid:!1,gridWidth:1,gridColor:i,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:r,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:i,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:r,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),t,e.config),function(e,t){const n=t.config,r=uMe(t.root=t.add(sMe())),i=function(e,t){const n=n=>yMe(e[n],t[n]),r=[bAe("background",n("background")),bAe("autosize",yCe(n("autosize"))),bAe("padding",xCe(n("padding"))),bAe("width",n("width")||0),bAe("height",n("height")||0)],i=r.reduce(((e,t)=>(e[t.name]=t,e)),{}),o={};return Cn(e.signals).forEach((e=>{Pn(i,e.name)?e=In(i[e.name],e):r.push(e),o[e.name]=e})),Cn(t.signals).forEach((e=>{Pn(o,e.name)||Pn(i,e.name)||r.push(e)})),r}(e,n);i.forEach((e=>iMe(e,t))),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(OMe()),a=t.add(DMe(ZCe(yAe(e.encode),WTe,TCe,e.style,t,{pulse:uMe(o)}))),s=t.add(eTe({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:uMe(a)}));t.operators.pop(),t.pushState(uMe(a),uMe(s),null),mAe(e,t,i),t.operators.push(s);let u=t.add(FMe({mark:r,pulse:uMe(s)}));return u=t.add(KMe({pulse:uMe(u)})),u=t.add(ZMe({pulse:uMe(u)})),t.addData("root",new DEe(t,o,o,u)),t}(e,new vAe(t,n)).toRuntime()}function CAe(e,t,n){return e.fields=t||[],e.fname=n,e}function MAe(e){return 1===e.length?TAe(e[0]):EAe(e)}vAe.prototype=xAe.prototype={parse(e){return mAe(e,this)},fork(){return new xAe(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach((t=>{t.$ref=e.id})),e.refs=null),e},proxy(e){const t=e instanceof oMe?uMe(e):e;return this.add(XMe({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(e,t,n){let r,i;e&&(r=e.data||(e.data={}),i=r[t]||(r[t]=[]),i.push(n))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(uMe(this.add(ZMe({pulse:e})))),this._parent.push(t),this._lookup.push(n?uMe(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return dn(this._parent)},encode(){return dn(this._encode)},lookup(){return dn(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(Vn(e))return lMe(e,t);e.signal||Vt("Unsupported field reference: "+Yn(e));const n=e.signal;let r=this.field[n];if(!r){const e={name:this.signalRef(n)};t&&(e.as=t),this.field[n]=r=uMe(this.add(LMe(e)))}return r},compareRef(e){let t=!1;const n=e=>gMe(e)?(t=!0,this.signalRef(e.signal)):function(e){return e&&e.expr}(e)?(t=!0,this.exprRef(e.expr)):e,r=Cn(e.field).map(n),i=Cn(e.order).map(n);return t?uMe(this.add(RMe({fields:r,orders:i}))):pMe(r,i)},keyRef(e,t){let n=!1;const r=this.signals;return e=Cn(e).map((e=>gMe(e)?(n=!0,uMe(r[e.signal])):e)),n?uMe(this.add(PMe({fields:e,flat:t}))):function(e,t){const n={$key:e};return t&&(n.$flat=!0),n}(e,t)},sortRef(e){if(!e)return e;const t=dMe(e.op,e.field),n=e.order||"ascending";return n.signal?uMe(this.add(RMe({fields:t,orders:this.signalRef(n.signal)}))):pMe(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return Pn(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&Vt("Duplicate signal name: "+Yn(e));const n=t instanceof oMe?t:this.add(sMe(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||Vt("Unrecognized signal name: "+Yn(e)),this.signals[e]},signalRef(e){return this.signals[e]?uMe(this.signals[e]):(Pn(this.lambdas,e)||(this.lambdas[e]=this.add(sMe(null))),uMe(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const n=e[t],r=Lae(n,this),i=this.lambdas[n];i.params=r.$params,i.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return e&&un(e)?this.signalRef(e.signal||_Ae(e)):e},exprRef(e,t){const n={expr:Lae(e,this)};return t&&(n.expr.$name=t),uMe(this.add(IMe(n)))},addBinding(e,t){this.bindings||Vt("Nested signals do not support binding: "+Yn(e)),this.bindings.push(In({signal:e},t))},addScaleProj(e,t){Pn(this.scales,e)&&Vt("Duplicate scale or projection name: "+Yn(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,JMe(t))},addProjection(e,t){this.addScaleProj(e,qMe(t))},getScale(e){return this.scales[e]||Vt("Unrecognized scale name: "+Yn(e)),this.scales[e]},scaleRef(e){return uMe(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return Pn(this.data,e)&&Vt("Duplicate data set name: "+Yn(e)),this.data[e]=t},getData(e){return this.data[e]||Vt("Undefined data set name: "+Yn(e)),this.data[e]},addDataPipeline(e,t){return Pn(this.data,e)&&Vt("Duplicate data set name: "+Yn(e)),this.addData(e,DEe.fromEntries(this,t))}};const TAe=e=>function(t){return t[e]},EAe=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function AAe(e){throw Error(e)}function FAe(e){return"function"==typeof e}(function(e,t,n){const r=function(e){const t=[],n=e.length;let r,i,o,a=null,s=0,u="";function l(){t.push(u+e.substring(r,i)),u="",r=i+1}for(e+="",r=i=0;i<n;++i)if(o=e[i],"\\"===o)u+=e.substring(r,i++),r=i;else if(o===a)l(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&l(),s=r=i+1):"]"===o&&(s||AAe("Access path missing open bracket: "+e),s>0&&l(),s=0,r=i+1):i>r?l():r=i+1}return s&&AAe("Access path missing closing bracket: "+e),a&&AAe("Access path missing closing quote: "+e),i>r&&(i++,l()),t}(e);e=1===r.length?r[0]:e,CAe((n&&n.get||MAe)(r),[e],t||e)})("id"),CAe((e=>e),[],"identity"),CAe((()=>0),[],"zero"),CAe((()=>1),[],"one"),CAe((()=>!0),[],"true"),CAe((()=>!1),[],"false"),Array.isArray;const OAe=Object.prototype.hasOwnProperty;function RAe(e,t){return OAe.call(e,t)}function NAe(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function DAe(e){this.type=e}var IAe,BAe,LAe,PAe,$Ae;DAe.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=function(e){switch(e.type){case"ArrayExpression":return e.elements;case"BinaryExpression":case"LogicalExpression":return[e.left,e.right];case"CallExpression":return[e.callee].concat(e.arguments);case"ConditionalExpression":return[e.test,e.consequent,e.alternate];case"MemberExpression":return[e.object,e.property];case"ObjectExpression":return e.properties;case"Property":return[e.key,e.value];case"UnaryExpression":return[e.argument];default:return[]}}(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};var zAe=1,jAe=2,GAe=3,UAe=4,WAe=5,VAe=6,HAe=7,qAe=8;(IAe={})[zAe]="Boolean",IAe[jAe]="<end>",IAe[GAe]="Identifier",IAe[UAe]="Keyword",IAe[WAe]="Null",IAe[VAe]="Numeric",IAe[HAe]="Punctuator",IAe[qAe]="String",IAe[9]="RegularExpression";var XAe="ArrayExpression",YAe="BinaryExpression",KAe="CallExpression",JAe="ConditionalExpression",ZAe="Identifier",QAe="Literal",eFe="LogicalExpression",tFe="MemberExpression",nFe="ObjectExpression",rFe="Property",iFe="UnaryExpression",oFe="Unexpected token %0",aFe="Unexpected number",sFe="Unexpected string",uFe="Unexpected identifier",lFe="Unexpected reserved word",cFe="Unexpected end of input",pFe="Invalid regular expression",dFe="Invalid regular expression: missing /",hFe="Octal literals are not allowed in strict mode.",fFe="Duplicate data property in object literal not allowed in strict mode",gFe="ILLEGAL",mFe="Disabled.",yFe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),bFe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function vFe(e,t){if(!e)throw new Error("ASSERT: "+t)}function xFe(e){return e>=48&&e<=57}function _Fe(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function wFe(e){return"01234567".indexOf(e)>=0}function kFe(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function SFe(e){return 10===e||13===e||8232===e||8233===e}function CFe(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&yFe.test(String.fromCharCode(e))}function MFe(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&bFe.test(String.fromCharCode(e))}const TFe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function EFe(){for(;LAe<PAe;){const e=BAe.charCodeAt(LAe);if(!kFe(e)&&!SFe(e))break;++LAe}}function AFe(e){var t,n,r,i=0;for(n="u"===e?4:2,t=0;t<n;++t)LAe<PAe&&_Fe(BAe[LAe])?(r=BAe[LAe++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):UFe({},oFe,gFe);return String.fromCharCode(i)}function FFe(){var e,t,n,r;for(t=0,"}"===(e=BAe[LAe])&&UFe({},oFe,gFe);LAe<PAe&&_Fe(e=BAe[LAe++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&UFe({},oFe,gFe),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function OFe(){var e,t;for(e=BAe.charCodeAt(LAe++),t=String.fromCharCode(e),92===e&&(117!==BAe.charCodeAt(LAe)&&UFe({},oFe,gFe),++LAe,(e=AFe("u"))&&"\\"!==e&&CFe(e.charCodeAt(0))||UFe({},oFe,gFe),t=e);LAe<PAe&&MFe(e=BAe.charCodeAt(LAe));)++LAe,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==BAe.charCodeAt(LAe)&&UFe({},oFe,gFe),++LAe,(e=AFe("u"))&&"\\"!==e&&MFe(e.charCodeAt(0))||UFe({},oFe,gFe),t+=e);return t}function RFe(){var e,t,n,r,i=LAe,o=BAe.charCodeAt(LAe),a=BAe[LAe];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++LAe,{type:HAe,value:String.fromCharCode(o),start:i,end:LAe};default:if(61===(e=BAe.charCodeAt(LAe+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return LAe+=2,{type:HAe,value:String.fromCharCode(o)+String.fromCharCode(e),start:i,end:LAe};case 33:case 61:return LAe+=2,61===BAe.charCodeAt(LAe)&&++LAe,{type:HAe,value:BAe.slice(i,LAe),start:i,end:LAe}}}return">>>="===(r=BAe.substr(LAe,4))?{type:HAe,value:r,start:i,end:LAe+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:HAe,value:n,start:i,end:LAe+=3}:a===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(a)>=0||"=>"===t?{type:HAe,value:t,start:i,end:LAe+=2}:("//"===t&&UFe({},oFe,gFe),"<>=!+-*%&|^/".indexOf(a)>=0?(++LAe,{type:HAe,value:a,start:i,end:LAe}):void UFe({},oFe,gFe))}function NFe(){var e,t,n;if(vFe(xFe((n=BAe[LAe]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=LAe,e="","."!==n){if(e=BAe[LAe++],n=BAe[LAe],"0"===e){if("x"===n||"X"===n)return++LAe,function(e){let t="";for(;LAe<PAe&&_Fe(BAe[LAe]);)t+=BAe[LAe++];return 0===t.length&&UFe({},oFe,gFe),CFe(BAe.charCodeAt(LAe))&&UFe({},oFe,gFe),{type:VAe,value:parseInt("0x"+t,16),start:e,end:LAe}}(t);if(wFe(n))return function(e){let t="0"+BAe[LAe++];for(;LAe<PAe&&wFe(BAe[LAe]);)t+=BAe[LAe++];return(CFe(BAe.charCodeAt(LAe))||xFe(BAe.charCodeAt(LAe)))&&UFe({},oFe,gFe),{type:VAe,value:parseInt(t,8),octal:!0,start:e,end:LAe}}(t);n&&xFe(n.charCodeAt(0))&&UFe({},oFe,gFe)}for(;xFe(BAe.charCodeAt(LAe));)e+=BAe[LAe++];n=BAe[LAe]}if("."===n){for(e+=BAe[LAe++];xFe(BAe.charCodeAt(LAe));)e+=BAe[LAe++];n=BAe[LAe]}if("e"===n||"E"===n)if(e+=BAe[LAe++],"+"!==(n=BAe[LAe])&&"-"!==n||(e+=BAe[LAe++]),xFe(BAe.charCodeAt(LAe)))for(;xFe(BAe.charCodeAt(LAe));)e+=BAe[LAe++];else UFe({},oFe,gFe);return CFe(BAe.charCodeAt(LAe))&&UFe({},oFe,gFe),{type:VAe,value:parseFloat(e),start:t,end:LAe}}function DFe(){if(EFe(),LAe>=PAe)return{type:jAe,start:LAe,end:LAe};const e=BAe.charCodeAt(LAe);return CFe(e)?function(){var e,t;return e=LAe,t=92===BAe.charCodeAt(LAe)?OFe():function(){var e,t;for(e=LAe++;LAe<PAe;){if(92===(t=BAe.charCodeAt(LAe)))return LAe=e,OFe();if(!MFe(t))break;++LAe}return BAe.slice(e,LAe)}(),{type:1===t.length?GAe:TFe.hasOwnProperty(t)?UAe:"null"===t?WAe:"true"===t||"false"===t?zAe:GAe,value:t,start:e,end:LAe}}():40===e||41===e||59===e?RFe():39===e||34===e?function(){var e,t,n,r,i="",o=!1;for(vFe("'"===(e=BAe[LAe])||'"'===e,"String literal must starts with a quote"),t=LAe,++LAe;LAe<PAe;){if((n=BAe[LAe++])===e){e="";break}if("\\"===n)if((n=BAe[LAe++])&&SFe(n.charCodeAt(0)))"\r"===n&&"\n"===BAe[LAe]&&++LAe;else switch(n){case"u":case"x":"{"===BAe[LAe]?(++LAe,i+=FFe()):i+=AFe(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:wFe(n)?(0!==(r="01234567".indexOf(n))&&(o=!0),LAe<PAe&&wFe(BAe[LAe])&&(o=!0,r=8*r+"01234567".indexOf(BAe[LAe++]),"0123".indexOf(n)>=0&&LAe<PAe&&wFe(BAe[LAe])&&(r=8*r+"01234567".indexOf(BAe[LAe++]))),i+=String.fromCharCode(r)):i+=n}else{if(SFe(n.charCodeAt(0)))break;i+=n}}return""!==e&&UFe({},oFe,gFe),{type:qAe,value:i,octal:o,start:t,end:LAe}}():46===e?xFe(BAe.charCodeAt(LAe+1))?NFe():RFe():xFe(e)?NFe():RFe()}function IFe(){const e=$Ae;return LAe=e.end,$Ae=DFe(),LAe=e.end,e}function BFe(){const e=LAe;$Ae=DFe(),LAe=e}function LFe(e,t,n){const r=new DAe("||"===e||"&&"===e?eFe:YAe);return r.operator=e,r.left=t,r.right=n,r}function PFe(e,t){const n=new DAe(KAe);return n.callee=e,n.arguments=t,n}function $Fe(e){const t=new DAe(ZAe);return t.name=e,t}function zFe(e){const t=new DAe(QAe);return t.value=e.value,t.raw=BAe.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function jFe(e,t,n){const r=new DAe(tFe);return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function GFe(e,t,n){const r=new DAe(rFe);return r.key=t,r.value=n,r.kind=e,r}function UFe(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,((e,t)=>(vFe(t<r.length,"Message reference must be in range"),r[t])));throw(n=new Error(i)).index=LAe,n.description=i,n}function WFe(e){e.type===jAe&&UFe(e,cFe),e.type===VAe&&UFe(e,aFe),e.type===qAe&&UFe(e,sFe),e.type===GAe&&UFe(e,uFe),e.type===UAe&&UFe(e,lFe),UFe(e,oFe,e.value)}function VFe(e){const t=IFe();t.type===HAe&&t.value===e||WFe(t)}function HFe(e){return $Ae.type===HAe&&$Ae.value===e}function qFe(e){return $Ae.type===UAe&&$Ae.value===e}function XFe(){LAe=$Ae.start;const e=IFe();return e.type===qAe||e.type===VAe?(e.octal&&UFe(e,hFe),zFe(e)):$Fe(e.value)}function YFe(){var e,t,n;return LAe=$Ae.start,(e=$Ae).type===GAe?(n=XFe(),VFe(":"),GFe("init",n,iOe())):e.type!==jAe&&e.type!==HAe?(t=XFe(),VFe(":"),GFe("init",t,iOe())):void WFe(e)}const KFe={if:1};function JFe(){var e,t,n;if(HFe("("))return function(){VFe("(");const e=oOe();return VFe(")"),e}();if(HFe("["))return function(){const e=[];for(LAe=$Ae.start,VFe("[");!HFe("]");)HFe(",")?(IFe(),e.push(null)):(e.push(iOe()),HFe("]")||VFe(","));return IFe(),function(e){const t=new DAe(XAe);return t.elements=e,t}(e)}();if(HFe("{"))return function(){var e,t,n=[],r={},i=String;for(LAe=$Ae.start,VFe("{");!HFe("}");)t="$"+((e=YFe()).key.type===ZAe?e.key.name:i(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?UFe({},fFe):r[t]=!0,n.push(e),HFe("}")||VFe(",");return VFe("}"),function(e){const t=new DAe(nFe);return t.properties=e,t}(n)}();if(e=$Ae.type,LAe=$Ae.start,e===GAe||KFe[$Ae.value])n=$Fe(IFe().value);else if(e===qAe||e===VAe)$Ae.octal&&UFe($Ae,hFe),n=zFe(IFe());else{if(e===UAe)throw new Error(mFe);e===zAe?((t=IFe()).value="true"===t.value,n=zFe(t)):e===WAe?((t=IFe()).value=null,n=zFe(t)):HFe("/")||HFe("/=")?(n=zFe(function(){var e,t,n,r;return $Ae=null,EFe(),e=LAe,t=function(){var e,t,n,r;for(vFe("/"===(e=BAe[LAe]),"Regular expression literal must start with a slash"),t=BAe[LAe++],n=!1,r=!1;LAe<PAe;)if(t+=e=BAe[LAe++],"\\"===e)SFe((e=BAe[LAe++]).charCodeAt(0))&&UFe({},dFe),t+=e;else if(SFe(e.charCodeAt(0)))UFe({},dFe);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||UFe({},dFe),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";LAe<PAe&&MFe((e=BAe[LAe]).charCodeAt(0));)++LAe,"\\"===e&&LAe<PAe?UFe({},oFe,gFe):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&UFe({},pFe,n),{value:n,literal:t}}(),r=function(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((e,t)=>{if(parseInt(t,16)<=1114111)return"x";UFe({},pFe)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(e){UFe({},pFe)}try{return new RegExp(e,t)}catch(e){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:LAe}}()),BFe()):WFe(IFe())}return n}function ZFe(){const e=[];if(VFe("("),!HFe(")"))for(;LAe<PAe&&(e.push(iOe()),!HFe(")"));)VFe(",");return VFe(")"),e}function QFe(){LAe=$Ae.start;const e=IFe();return function(e){return e.type===GAe||e.type===UAe||e.type===zAe||e.type===WAe}(e)||WFe(e),$Fe(e.value)}function eOe(){VFe("[");const e=oOe();return VFe("]"),e}function tOe(){const e=function(){var e;for(e=JFe();;)if(HFe("."))VFe("."),e=jFe(".",e,QFe());else if(HFe("("))e=PFe(e,ZFe());else{if(!HFe("["))break;e=jFe("[",e,eOe())}return e}();if($Ae.type===HAe&&(HFe("++")||HFe("--")))throw new Error(mFe);return e}function nOe(){var e,t;if($Ae.type!==HAe&&$Ae.type!==UAe)t=tOe();else{if(HFe("++")||HFe("--"))throw new Error(mFe);if(HFe("+")||HFe("-")||HFe("~")||HFe("!"))e=IFe(),t=nOe(),t=function(e,t){const n=new DAe(iFe);return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(qFe("delete")||qFe("void")||qFe("typeof"))throw new Error(mFe);t=tOe()}}return t}function rOe(e){let t=0;if(e.type!==HAe&&e.type!==UAe)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function iOe(){var e,t;return e=function(){var e,t,n,r,i,o,a,s,u,l;if(e=$Ae,u=nOe(),0===(i=rOe(r=$Ae)))return u;for(r.prec=i,IFe(),t=[e,$Ae],o=[u,r,a=nOe()];(i=rOe($Ae))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,u=o.pop(),t.pop(),n=LFe(s,u,a),o.push(n);(r=IFe()).prec=i,o.push(r),t.push($Ae),n=nOe(),o.push(n)}for(n=o[l=o.length-1],t.pop();l>1;)t.pop(),n=LFe(o[l-1].value,o[l-2],n),l-=2;return n}(),HFe("?")&&(IFe(),t=iOe(),VFe(":"),e=function(e,t,n){const r=new DAe(JAe);return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,iOe())),e}function oOe(){const e=iOe();if(HFe(","))throw new Error(mFe);return e}function aOe(e){LAe=0,PAe=(BAe=e).length,$Ae=null,BFe();const t=oOe();if($Ae.type!==jAe)throw new Error("Unexpect token after expression.");return t}var sOe={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function uOe(e){function t(t,n,r){return i=>function(t,n,r,i){let o=e(n[0]);return r&&(o=r+"("+o+")",0===r.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+t+(i<0?"":0===i?"()":"("+n.slice(1).map(e).join(",")+")")}(t,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&AAe("Missing arguments to clamp function."),t.length>3&&AAe("Too many arguments to clamp function.");const n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:t("getDate",n,0),day:t("getDay",n,0),year:t("getFullYear",n,0),month:t("getMonth",n,0),hours:t("getHours",n,0),minutes:t("getMinutes",n,0),seconds:t("getSeconds",n,0),milliseconds:t("getMilliseconds",n,0),time:t("getTime",n,0),timezoneoffset:t("getTimezoneOffset",n,0),utcdate:t("getUTCDate",n,0),utcday:t("getUTCDay",n,0),utcyear:t("getUTCFullYear",n,0),utcmonth:t("getUTCMonth",n,0),utchours:t("getUTCHours",n,0),utcminutes:t("getUTCMinutes",n,0),utcseconds:t("getUTCSeconds",n,0),utcmilliseconds:t("getUTCMilliseconds",n,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",r,0),lower:t("toLowerCase",r,0),substring:t("substring",r),split:t("split",r),trim:t("trim",r,0),regexp:i,test:t("test",i),if:function(t){t.length<3&&AAe("Missing arguments to if function."),t.length>3&&AAe("Too many arguments to if function.");const n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function lOe(e){const t=(e=e||{}).allowed?NAe(e.allowed):{},n=e.forbidden?NAe(e.forbidden):{},r=e.constants||sOe,i=(e.functions||uOe)(p),o=e.globalvar,a=e.fieldvar,s=FAe(o)?o:e=>"".concat(o,'["').concat(e,'"]');let u={},l={},c=0;function p(e){if("string"==typeof e)return e;const t=d[e.type];return null==t&&AAe("Unsupported type: "+e.type),t(e)}const d={Literal:e=>e.raw,Identifier:e=>{const i=e.name;return c>0?i:RAe(n,i)?AAe("Illegal identifier: "+i):RAe(r,i)?r[i]:RAe(t,i)?i:(u[i]=1,s(i))},MemberExpression:e=>{const t=!e.computed,n=p(e.object);t&&(c+=1);const r=p(e.property);return n===a&&(l[function(e){const t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(r)]=1),t&&(c-=1),n+(t?"."+r:"["+r+"]")},CallExpression:e=>{"Identifier"!==e.callee.type&&AAe("Illegal callee type: "+e.callee.type);const t=e.callee.name,n=e.arguments,r=RAe(i,t)&&i[t];return r||AAe("Unrecognized function: "+t),FAe(r)?r(n):r+"("+n.map(p).join(",")+")"},ArrayExpression:e=>"["+e.elements.map(p).join(",")+"]",BinaryExpression:e=>"("+p(e.left)+" "+e.operator+" "+p(e.right)+")",UnaryExpression:e=>"("+e.operator+p(e.argument)+")",ConditionalExpression:e=>"("+p(e.test)+"?"+p(e.consequent)+":"+p(e.alternate)+")",LogicalExpression:e=>"("+p(e.left)+e.operator+p(e.right)+")",ObjectExpression:e=>"{"+e.properties.map(p).join(",")+"}",Property:e=>{c+=1;const t=p(e.key);return c-=1,t+":"+p(e.value)}};function h(e){const t={code:p(e),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},t}return h.functions=i,h.constants=r,h}const cOe="view",pOe="[",dOe="]",hOe="{",fOe="}",gOe=":",mOe=",",yOe="@",bOe=">",vOe=/[[\]{}]/,xOe={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let _Oe,wOe;function kOe(e,t,n){return _Oe=t||cOe,wOe=n||xOe,COe(e.trim()).map(MOe)}function SOe(e,t,n,r,i){const o=e.length;let a,s=0;for(;t<o;++t){if(a=e[t],!s&&a===n)return t;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return t}function COe(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=SOe(e,i,mOe,pOe+hOe,dOe+fOe),t.push(e.substring(r,i).trim()),r=++i;if(0===t.length)throw"Empty event selector: "+e;return t}function MOe(e){return"["===e[0]?function(e){const t=e.length;let n,r=1;if(r=SOe(e,r,dOe,pOe,dOe),r===t)throw"Empty between selector: "+e;if(n=COe(e.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+e;if((e=e.slice(r+1).trim())[0]!==bOe)throw"Expected '>' after between selector: "+e;n=n.map(MOe);const i=MOe(e.slice(1).trim());return i.between?{between:n,stream:i}:(i.between=n,i)}(e):function(e){const t={source:_Oe},n=[];let r,i,o=[0,0],a=0,s=0,u=e.length,l=0;if(e[u-1]===fOe){if(l=e.lastIndexOf(hOe),!(l>=0))throw"Unmatched right brace: "+e;try{o=function(e){const t=e.split(mOe);if(!e.length||t.length>2)throw e;return t.map((t=>{const n=+t;if(n!=n)throw e;return n}))}(e.substring(l+1,u-1))}catch(t){throw"Invalid throttle specification: "+e}u=(e=e.slice(0,l).trim()).length,l=0}if(!u)throw e;if(e[0]===yOe&&(a=++l),r=SOe(e,l,gOe),r<u&&(n.push(e.substring(s,r).trim()),s=l=++r),l=SOe(e,l,pOe),l===u)n.push(e.substring(s,u).trim());else if(n.push(e.substring(s,l).trim()),i=[],s=++l,s===u)throw"Unmatched left bracket: "+e;for(;l<u;){if(l=SOe(e,l,dOe),l===u)throw"Unmatched left bracket: "+e;if(i.push(e.substring(s,l).trim()),l<u-1&&e[++l]!==pOe)throw"Expected left bracket: "+e;s=++l}if(!(u=n.length)||vOe.test(n[u-1]))throw"Invalid event selector: "+e;var c;return u>1?(t.type=n[1],a?t.markname=n[0].slice(1):(c=n[0],wOe[c]?t.marktype=n[0]:t.source=n[0])):t.type=n[0],"!"===t.type.slice(-1)&&(t.consume=!0,t.type=t.type.slice(0,-1)),null!=i&&(t.filter=i),o[0]&&(t.throttle=o[0]),o[1]&&(t.debounce=o[1]),t}(e)}st(Uu,o,s,u,l,c,d,p,h,f,g,m);const TOe="5.20.0";function EOe(e,t,n){return e.fields=t||[],e.fname=n,e}function AOe(e){return 1===e.length?FOe(e[0]):OOe(e)}const FOe=e=>function(t){return t[e]},OOe=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function ROe(e){throw Error(e)}function NOe(e){var t,n,r,i=[],o=null,a=0,s=e.length,u="";function l(){i.push(u+e.substring(t,n)),u="",t=n+1}for(e+="",t=n=0;n<s;++n)if("\\"===(r=e[n]))u+=e.substring(t,n),u+=e.substring(++n,++n),t=n;else if(r===o)l(),o=null,a=-1;else{if(o)continue;t===a&&'"'===r||t===a&&"'"===r?(t=n+1,o=r):"."!==r||a?"["===r?(n>t&&l(),a=t=n+1):"]"===r&&(a||ROe("Access path missing open bracket: "+e),a>0&&l(),a=0,t=n+1):n>t?l():t=n+1}return a&&ROe("Access path missing closing bracket: "+e),o&&ROe("Access path missing closing quote: "+e),n>t&&(n++,l()),i}var DOe=[],IOe=(function(e,t,n){const r=NOe(e);e=1===r.length?r[0]:e,EOe(AOe(r),[e],e)}("id"),EOe((function(e){return e}),DOe,"identity"));function BOe(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}EOe((function(){return 0}),DOe,"zero"),EOe((function(){return 1}),DOe,"one"),EOe((function(){return!0}),DOe,"true"),EOe((function(){return!1}),DOe,"false");const LOe=Array.isArray;function POe(e){return e===Object(e)}const $Oe=e=>"__proto__"!==e;function zOe(...e){return e.reduce(((e,t)=>{for(var n in t)if("signals"===n)e.signals=GOe(e.signals,t.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;jOe(e,n,t[n],r)}return e}),{})}function jOe(e,t,n,r){var i,o;if($Oe(t))if(POe(n)&&!LOe(n))for(i in o=POe(e[t])?e[t]:e[t]={},n)r&&(!0===r||r[i])?jOe(o,i,n[i]):$Oe(i)&&(o[i]=n[i]);else e[t]=n}function GOe(e,t){if(null==e)return t;const n={},r=[];function i(e){n[e.name]||(n[e.name]=1,r.push(e))}return t.forEach(i),e.forEach(i),r}function UOe(e){return null!=e?LOe(e)?e:[e]:[]}const WOe=Object.prototype.hasOwnProperty;function VOe(e,t){return WOe.call(e,t)}function HOe(e){return"boolean"==typeof e}function qOe(e){return"number"==typeof e}function XOe(e){return"string"==typeof e}function YOe(e){return LOe(e)?"["+e.map(YOe)+"]":POe(e)||XOe(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function KOe(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}function JOe(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create,Object.create,Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,(function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var ZOe=n(6313),QOe=n.n(ZOe),eRe=n(4063),tRe=n.n(eRe),nRe=n(5035),rRe=n.n(nRe);function iRe(e){return!!e.or}function oRe(e){return!!e.and}function aRe(e){return!!e.not}function sRe(e,t){if(aRe(e))sRe(e.not,t);else if(oRe(e))for(const n of e.and)sRe(n,t);else if(iRe(e))for(const n of e.or)sRe(n,t);else t(e)}function uRe(e,t){return aRe(e)?{not:uRe(e.not,t)}:oRe(e)?{and:e.and.map((e=>uRe(e,t)))}:iRe(e)?{or:e.or.map((e=>uRe(e,t)))}:t(e)}const lRe=tRe(),cRe=QOe();function pRe(e,t){const n={};for(const r of t)VOe(e,r)&&(n[r]=e[r]);return n}function dRe(e,t){const n=Object.assign({},e);for(const e of t)delete n[e];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map((e=>rRe()(e))).join(",")})`};const hRe=rRe();function fRe(e){if(qOe(e))return e;const t=XOe(e)?e:rRe()(e);if(t.length<250)return t;let n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n&=n;return n}function gRe(e){return!1===e||null===e}function mRe(e,t){return e.indexOf(t)>-1}function yRe(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function bRe(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function vRe(e,t){for(const n of CRe(t))jOe(e,n,t[n],!0)}function xRe(e,t){const n=[],r={};let i;for(const o of e)i=t(o),i in r||(r[i]=1,n.push(o));return n}function _Re(e,t){for(const n of e)if(t.has(n))return!0;return!1}function wRe(e){const t=new Set;for(const n of e){const e=NOe(n).map(((e,t)=>0===t?e:`[${e}]`)),r=e.map(((t,n)=>e.slice(0,n+1).join("")));for(const e of r)t.add(e)}return t}function kRe(e,t){return void 0===e||void 0===t||_Re(wRe(e),wRe(t))}function SRe(e){return 0===CRe(e).length}const CRe=Object.keys,MRe=Object.values;function TRe(e){const t=[];for(const n in e)VOe(e,n)&&t.push({key:n,value:e[n]});return t}function ERe(e){return!0===e||!1===e}function ARe(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function FRe(e,t){return aRe(e)?"!("+FRe(e.not,t)+")":oRe(e)?"("+e.and.map((e=>FRe(e,t))).join(") && (")+")":iRe(e)?"("+e.or.map((e=>FRe(e,t))).join(") || (")+")":t(e)}function ORe(e,t){if(0===t.length)return!0;const n=t.shift();return n in e&&ORe(e[n],t)&&delete e[n],SRe(e)}function RRe(e){return e.charAt(0).toUpperCase()+e.substr(1)}function NRe(e,t="datum"){const n=NOe(e),r=[];for(let e=1;e<=n.length;e++){const i=`[${n.slice(0,e).map(YOe).join("][")}]`;r.push(`${t}${i}`)}return r.join(" && ")}function DRe(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function IRe(e){return`${NOe(e).map(DRe).join("\\.")}`}function BRe(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function LRe(e){return`${NOe(e).join(".")}`}function PRe(e){return e?NOe(e).length:0}function $Re(...e){for(const t of e)if(void 0!==t)return t}let zRe=42;function jRe(e){if(void 0!==e)return(e%360+360)%360}function GRe(e){return!!qOe(e)||!isNaN(e)&&!isNaN(parseFloat(e))}const URe={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function WRe(e){return e&&e.condition}const VRe=["domain","grid","labels","ticks","title"],HRe={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},qRe={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},XRe=Object.assign(Object.assign({},qRe),{style:1,labelExpr:1,encoding:1});function YRe(e){return!!XRe[e]}CRe(XRe);const KRe={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},JRe=KRe.arc,ZRe=KRe.area,QRe=KRe.bar,eNe=KRe.image,tNe=KRe.line,nNe=KRe.point,rNe=KRe.rect,iNe=KRe.rule,oNe=KRe.text,aNe=KRe.tick,sNe=KRe.trail,uNe=KRe.circle,lNe=KRe.square,cNe=KRe.geoshape;function pNe(e){return mRe(["line","area","trail"],e)}function dNe(e){return mRe(["rect","bar","image","arc"],e)}const hNe=CRe(KRe);function fNe(e){return e.type}KOe(hNe);const gNe=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],mNe=CRe({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1}),yNe={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]};function bNe(e){return"mark"in e}class vNe{constructor(e,t){this.name=e,this.run=t}hasMatchingType(e){return!!bNe(e)&&function(e){return fNe(e)?e.type:e}(e.mark)===this.name}}const xNe={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},_Ne={count:1,min:1,max:1};function wNe(e){return!!e&&!!e.argmin}function kNe(e){return!!e&&!!e.argmax}function SNe(e){return XOe(e)&&!!xNe[e]}CRe(xNe);const CNe=["count","valid","missing","distinct"];function MNe(e){return XOe(e)&&mRe(CNe,e)}const TNe=["count","sum","distinct","valid","missing"],ENe=KOe(["mean","average","median","q1","q3","min","max"]),ANe="row",FNe="column",ONe="facet",RNe="x",NNe="y",DNe="x2",INe="y2",BNe="radius",LNe="radius2",PNe="theta",$Ne="theta2",zNe="latitude",jNe="longitude",GNe="latitude2",UNe="longitude2",WNe="color",VNe="fill",HNe="stroke",qNe="shape",XNe="size",YNe="angle",KNe="opacity",JNe="fillOpacity",ZNe="strokeOpacity",QNe="strokeWidth",eDe="strokeDash",tDe="text",nDe="order",rDe="detail",iDe="key",oDe="tooltip",aDe="href",sDe="url",uDe="description",lDe={theta:1,theta2:1,radius:1,radius2:1};function cDe(e){return e in lDe}const pDe={longitude:1,longitude2:1,latitude:1,latitude2:1},dDe=CRe(pDe),hDe=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),lDe),pDe),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function fDe(e){return e===WNe||e===VNe||e===HNe}const gDe={row:1,column:1,facet:1},mDe=CRe(gDe),yDe=Object.assign(Object.assign({},hDe),gDe),bDe=CRe(yDe),{order:vDe,detail:xDe,tooltip:_De}=yDe,wDe=JOe(yDe,["order","detail","tooltip"]),{row:kDe,column:SDe,facet:CDe}=wDe,MDe=JOe(wDe,["row","column","facet"]);function TDe(e){return!!yDe[e]}CRe(wDe),CRe(MDe);const EDe=[DNe,INe,GNe,UNe,$Ne,LNe];function ADe(e){return FDe(e)!==e}function FDe(e){switch(e){case DNe:return RNe;case INe:return NNe;case GNe:return zNe;case UNe:return jNe;case $Ne:return PNe;case LNe:return BNe}return e}function ODe(e){if(cDe(e))switch(e){case PNe:return"startAngle";case $Ne:return"endAngle";case BNe:return"outerRadius";case LNe:return"innerRadius"}return e}function RDe(e){switch(e){case RNe:return DNe;case NNe:return INe;case zNe:return GNe;case jNe:return UNe;case PNe:return $Ne;case BNe:return LNe}}function NDe(e){switch(e){case RNe:case DNe:return"width";case NNe:case INe:return"height"}}CRe(hDe);const{x:DDe,y:IDe,x2:BDe,y2:LDe,latitude:PDe,longitude:$De,latitude2:zDe,longitude2:jDe,theta:GDe,theta2:UDe,radius:WDe,radius2:VDe}=hDe,HDe=JOe(hDe,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),qDe=CRe(HDe),XDe={x:1,y:1},YDe=CRe(XDe);function KDe(e){return e in XDe}const JDe={theta:1,radius:1},ZDe=CRe(JDe);function QDe(e){return"width"===e?RNe:NNe}const{text:eIe,tooltip:tIe,href:nIe,url:rIe,description:iIe,detail:oIe,key:aIe,order:sIe}=HDe,uIe=JOe(HDe,["text","tooltip","href","url","description","detail","key","order"]),lIe=CRe(uIe),cIe=Object.assign(Object.assign(Object.assign({},XDe),JDe),uIe),pIe=CRe(cIe);function dIe(e){return!!cIe[e]}const hIe={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:fIe}=hIe,gIe=JOe(hIe,["geoshape"]);function mIe(e){switch(e){case RNe:case NNe:case PNe:case BNe:case XNe:case YNe:case QNe:case KNe:case JNe:case ZNe:case DNe:case INe:case $Ne:case LNe:return;case ONe:case ANe:case FNe:case qNe:case eDe:case tDe:case oDe:case aDe:case sDe:case uDe:return"discrete";case WNe:case VNe:case HNe:return"flexible";case zNe:case jNe:case GNe:case UNe:case rDe:case iDe:case nDe:return}}function yIe(e){return HOe(e)&&(e=kPe(e,void 0)),"bin"+CRe(e).map((t=>_Ie(e[t])?ARe(`_${t}_${Object.entries(e[t])}`):ARe(`_${t}_${e[t]}`))).join("")}function bIe(e){return!0===e||xIe(e)&&!e.binned}function vIe(e){return"binned"===e||xIe(e)&&!0===e.binned}function xIe(e){return POe(e)}function _Ie(e){return null==e?void 0:e.selection}function wIe(e){switch(e){case ANe:case FNe:case XNe:case WNe:case VNe:case HNe:case QNe:case KNe:case JNe:case ZNe:case qNe:return 6;case eDe:return 4;default:return 10}}function kIe(e){return`Invalid specification ${JSON.stringify(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const SIe='Autosize "fit" only works for single views and layered views.';function CIe(e){return("width"==e?"Width":"Height")+' "container" only works for single views and layered views.'}function MIe(e){return`${"width"==e?"Width":"Height"} "container" only works well with autosize "fit" or "fit-${"width"==e?"x":"y"}".`}function TIe(e){return e?`Dropping "fit-${e}" because spec has discrete ${NDe(e)}.`:'Dropping "fit" because spec has discrete size.'}function EIe(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function AIe(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function FIe(e){return`Selection not supported for ${e} yet.`}function OIe(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}function RIe(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function NIe(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function DIe(e){return`Invalid field type "${e}".`}function IIe(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function BIe(e,t){return`Dropping ${hRe(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}function LIe(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function PIe(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function $Ie(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${"ordinal"===t?"order":"magnitude"}.`}function zIe(e){return`Using unaggregated domain with raw field has no effect (${hRe(e)}).`}function jIe(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function GIe(e){return`Unaggregated domain is currently unsupported for log scale (${hRe(e)}).`}function UIe(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function WIe(e){return`The step for "${e}" is dropped because the ${"width"===e?"x":"y"} is continuous.`}const VIe="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function HIe(e,t){return`Invalid ${e}: ${hRe(t)}.`}function qIe(e){return`1D error band does not support ${e}.`}function XIe(e){return`Channel ${e} is required for "binned" bin.`}const YIe=(KIe=2,{level:function(e){return arguments.length?(KIe=+e,this):KIe},error:function(){return KIe>=1&&BOe("error","ERROR",arguments),this},warn:function(){return KIe>=2&&BOe("warn","WARN",arguments),this},info:function(){return KIe>=3&&BOe("log","INFO",arguments),this},debug:function(){return KIe>=4&&BOe("log","DEBUG",arguments),this}});var KIe;let JIe=YIe;function ZIe(...e){JIe.warn(...e)}function QIe(e){if(e&&POe(e))for(const t of sBe)if(t in e)return!0;return!1}const eBe=["january","february","march","april","may","june","july","august","september","october","november","december"],tBe=eBe.map((e=>e.substr(0,3))),nBe=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],rBe=nBe.map((e=>e.substr(0,3)));function iBe(e,t){const n=[];if(t&&void 0!==e.day&&CRe(e).length>1&&(ZIe(function(e){return`Dropping day from datetime ${hRe(e)} as day cannot be combined with other units.`}(e)),delete(e=cRe(e)).day),void 0!==e.year?n.push(e.year):n.push(2012),void 0!==e.month){const r=t?function(e){if(GRe(e)&&(e=+e),qOe(e))return e-1;{const t=e.toLowerCase(),n=eBe.indexOf(t);if(-1!==n)return n;const r=t.substr(0,3),i=tBe.indexOf(r);if(-1!==i)return i;throw new Error(HIe("month",e))}}(e.month):e.month;n.push(r)}else if(void 0!==e.quarter){const r=t?function(e){if(GRe(e)&&(e=+e),qOe(e))return e>4&&ZIe(HIe("quarter",e)),e-1;throw new Error(HIe("quarter",e))}(e.quarter):e.quarter;n.push(qOe(r)?3*r:r+"*3")}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){const r=t?function(e){if(GRe(e)&&(e=+e),qOe(e))return e%7;{const t=e.toLowerCase(),n=nBe.indexOf(t);if(-1!==n)return n;const r=t.substr(0,3),i=rBe.indexOf(r);if(-1!==i)return i;throw new Error(HIe("day",e))}}(e.day):e.day;n.push(qOe(r)?r+1:r+"+1")}else n.push(1);for(const t of["hours","minutes","seconds","milliseconds"]){const r=e[t];n.push(void 0===r?0:r)}return n}function oBe(e){const t=iBe(e,!0).join(", ");return e.utc?`utc(${t})`:`datetime(${t})`}const aBe={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},sBe=CRe(aBe);function uBe(e){return e.startsWith("utc")}const lBe={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function cBe(e){const t=[];for(const n of sBe)pBe(e,n)&&t.push(n);return t}function pBe(e,t){const n=e.indexOf(t);return!(n<0||n>0&&"seconds"===t&&"i"===e.charAt(n-1)||e.length>n+3&&"day"===t&&"o"===e.charAt(n+3)||n>0&&"year"===t&&"f"===e.charAt(n-1))}function dBe(e){if(!e)return;const t=cBe(e);return`timeUnitSpecifier(${rRe()(t)}, ${rRe()(lBe)})`}function hBe(e){if(!e)return;let t;return XOe(e)?t={unit:e}:POe(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),uBe(t.unit)&&(t.utc=!0,t.unit=t.unit.substr(3)),t}function fBe(e){return e&&!!e.signal}function gBe(e){return!!e.step}function mBe(e){return!LOe(e)&&"field"in e&&"data"in e}const yBe=CRe({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1}),bBe={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},vBe=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function xBe(e){return e&&!!e.field&&void 0!==e.equal}function _Be(e){return e&&!!e.field&&void 0!==e.lt}function wBe(e){return e&&!!e.field&&void 0!==e.lte}function kBe(e){return e&&!!e.field&&void 0!==e.gt}function SBe(e){return e&&!!e.field&&void 0!==e.gte}function CBe(e){if(e&&e.field){if(LOe(e.range)&&2===e.range.length)return!0;if(fBe(e.range))return!0}return!1}function MBe(e){return e&&!!e.field&&(LOe(e.oneOf)||LOe(e.in))}function TBe(e){return MBe(e)||xBe(e)||CBe(e)||_Be(e)||kBe(e)||wBe(e)||SBe(e)}function EBe(e,t){return MPe(e,{timeUnit:t,wrapTime:!0})}function ABe(e,t=!0){var n;const{field:r}=e,i=null===(n=hBe(e.timeUnit))||void 0===n?void 0:n.unit,o=i?"time("+function(e,t,{end:n}={end:!1}){const r=NRe(t),i=uBe(e)?"utc":"";let o;const a={};for(const t of sBe)pBe(e,t)&&(a[t]="quarter"===(s=t)?`(${i}quarter(${r})-1)`:`${i}${s}(${r})`,o=t);var s;return n&&(a[o]+="+1"),function(e){const t=iBe(e,!1).join(", ");return e.utc?`utc(${t})`:`datetime(${t})`}(a)}(i,r)+")":uPe(e,{expr:"datum"});if(xBe(e))return o+"==="+EBe(e.equal,i);if(_Be(e))return`${o}<${EBe(e.lt,i)}`;if(kBe(e))return`${o}>${EBe(e.gt,i)}`;if(wBe(e))return`${o}<=${EBe(e.lte,i)}`;if(SBe(e))return`${o}>=${EBe(e.gte,i)}`;if(MBe(e))return`indexof([${function(e,t){return e.map((e=>EBe(e,t)))}(e.oneOf,i).join(",")}], ${o}) !== -1`;if(function(e){return e&&!!e.field&&void 0!==e.valid}(e))return FBe(o,e.valid);if(CBe(e)){const{range:n}=e,r=fBe(n)?{signal:`${n.signal}[0]`}:n[0],a=fBe(n)?{signal:`${n.signal}[1]`}:n[1];if(null!==r&&null!==a&&t)return"inrange("+o+", ["+EBe(r,i)+", "+EBe(a,i)+"])";const s=[];return null!==r&&s.push(`${o} >= ${EBe(r,i)}`),null!==a&&s.push(`${o} <= ${EBe(a,i)}`),s.length>0?s.join(" && "):"true"}throw new Error(`Invalid field predicate: ${JSON.stringify(e)}`)}function FBe(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function OBe(e){var t;return TBe(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:null===(t=hBe(e.timeUnit))||void 0===t?void 0:t.unit}):e}const RBe={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},NBe=RBe.quantitative,DBe=RBe.ordinal,IBe=RBe.temporal,BBe=RBe.nominal,LBe=RBe.geojson,PBe=CRe(RBe),$Be={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},zBe={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},jBe=CRe(zBe);function GBe(e,t){const n=zBe[e],r=zBe[t];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}const UBe={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function WBe(e){return UBe[e]}const VBe=["linear","log","pow","sqrt","symlog","time","utc"],HBe=KOe(VBe),qBe=KOe(["linear","log","pow","sqrt","symlog"]),XBe=KOe(["quantile","quantize","threshold"]),YBe=KOe(VBe.concat(["quantile","quantize","threshold","sequential","identity"])),KBe=KOe(["ordinal","bin-ordinal","point","band"]);function JBe(e){return e in KBe}function ZBe(e){return e in YBe}function QBe(e){return e in HBe}function eLe(e){return e in XBe}function tLe(e){return null==e?void 0:e.selection}const nLe={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:rLe,domain:iLe,range:oLe,scheme:aLe}=(CRe(nLe),nLe),sLe=JOe(nLe,["type","domain","range","scheme"]),uLe=CRe(sLe);function lLe(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!mRe(["point","band","identity"],e);case"bins":return!mRe(["point","band","identity","ordinal"],e);case"round":return QBe(e)||"band"===e||"point"===e;case"padding":return QBe(e)||mRe(["point","band"],e);case"paddingOuter":case"align":return mRe(["point","band"],e);case"paddingInner":return"band"===e;case"domainMid":case"clamp":return QBe(e);case"nice":return QBe(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return ZBe(e)&&!mRe(["log","time","utc","threshold","quantile"],e)}}function cLe(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return fDe(e)?void 0:`Cannot use the scale property "${e}" with non-color channel.`;case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function pLe(e,t){return mRe([DBe,BBe],t)?void 0===e||JBe(e):t===IBe?mRe([$Be.TIME,$Be.UTC,void 0],e):t!==NBe||mRe([$Be.LOG,$Be.POW,$Be.SQRT,$Be.SYMLOG,$Be.QUANTILE,$Be.QUANTIZE,$Be.THRESHOLD,$Be.LINEAR,void 0],e)}function dLe(e,t){if(!dIe(e))return!1;switch(e){case RNe:case NNe:case PNe:case BNe:return QBe(t)||mRe(["band","point"],t);case XNe:case QNe:case KNe:case JNe:case ZNe:case YNe:return QBe(t)||eLe(t)||mRe(["band","point","ordinal"],t);case WNe:case VNe:case HNe:return"band"!==t;case eDe:return"ordinal"===t||eLe(t);case qNe:return"ordinal"===t}}function hLe(e,t){return e+"_"+t}function fLe(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:o}=e,a=xLe(e);return KLe(n)&&!MNe(n.aggregate)&&i&&QBe(i.get("type"))&&!1===i.get("zero")?gLe({fieldDef:n,channel:t,markDef:r,ref:a,config:o}):a}function gLe({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){return pNe(n.type)||null===IPe("invalid",n,i)?r:[mLe(e,t),r]}function mLe(e,t){const n=yLe(e,!0),r="y"===FDe(t)?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function yLe(e,t=!0){return FBe(XOe(e)?e:uPe(e,{expr:"datum"}),!t)}function bLe(e,t,n,r){const i={};if(t&&(i.scale=t),ZLe(e)){const{datum:t}=e;QIe(t)?i.signal=oBe(t):fBe(t)?i.signal=t.signal:i.value=t}else i.field=uPe(e,n);if(r){const{offset:e,band:t}=r;e&&(i.offset=e),t&&(i.band=t)}return i}function vLe({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,band:o=.5}){const a=0<o&&o<1?"datum":void 0,s=uPe(t,{expr:a,suffix:i}),u=void 0!==n?uPe(n,{expr:a}):uPe(t,{suffix:"end",expr:a}),l={};if(0===o||1===o){l.scale=e;const t=0===o?s:u;l.field=t}else{const t=`${o} * ${s} + ${1-o} * ${u}`;l.signal=`scale("${e}", ${t})`}return r&&(l.offset=r),l}function xLe({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:a,stack:s,offset:u,defaultRef:l,band:c}){var p;if(t){if(tPe(t)){if(nPe(t)){c=null!=c?c:VLe({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:s,config:i,isMidPoint:!0});const{bin:a,timeUnit:l,type:p}=t;if(bIe(a)||c&&l&&p===IBe)return s&&s.impute?bLe(t,o,{binSuffix:"mid"},{offset:u}):c?vLe({scaleName:o,fieldOrDatumDef:t,band:c,offset:u}):bLe(t,o,EPe(t,e)?{binSuffix:"range"}:{},{offset:u});if(vIe(a)){if(KLe(n))return vLe({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,band:c,offset:u});ZIe(XIe(e===RNe?DNe:INe))}}const l=null==a?void 0:a.get("type");return bLe(t,o,JBe(l)?{binSuffix:"range"}:{},{offset:u,band:"band"===l?null!==(p=null!=c?c:t.band)&&void 0!==p?p:.5:void 0})}if(rPe(t)){const n=t.value,r=u?{offset:u}:{};return Object.assign(Object.assign({},_Le(e,n)),r)}}return"function"==typeof l&&(l=l()),l?Object.assign(Object.assign({},l),u?{offset:u}:{}):l}function _Le(e,t){return mRe(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:mRe(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:OPe(t)}function wLe(e){return e&&"number"!==e&&"time"!==e}function kLe(e,t,n){return`${e}(${t}${n?`, ${JSON.stringify(n)}`:""})`}!function(){var e;const t={};for(const n of bDe)for(const r of PBe)for(const i of jBe){const o=hLe(n,r);dLe(n,i)&&pLe(i,r)&&(t[o]=null!==(e=t[o])&&void 0!==e?e:[],t[o].push(i))}}();const SLe="  ";function CLe({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o}){var a,s;if(wLe(n))return TLe({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:o});const u=MLe(e,r,i);if(CPe(e)){const n=function(e,t,n,r,i){return!t||n?`${i?"utc":"time"}Format(${e}, '${n=XOe(n)?n:r}')`:function(e,t,n){if(!e)return;const r=dBe(e);return`${n||uBe(e)?"utc":"time"}Format(${t}, ${r})`}(t,e,i)}(u,KLe(e)?null===(a=hBe(e.timeUnit))||void 0===a?void 0:a.unit:void 0,t,o.timeFormat,iPe(e)&&(null===(s=e.scale)||void 0===s?void 0:s.type)===$Be.UTC);return n?{signal:n}:void 0}return t=FLe(JLe(e),t,o),KLe(e)&&bIe(e.bin)?{signal:NLe(u,uPe(e,{expr:r,binSuffix:"end"}),t,n,o)}:t||"quantitative"===JLe(e)?{signal:`${OLe(u,t)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function MLe(e,t,n){return KLe(e)?n?`${uPe(e,{expr:t,suffix:"end"})}-${uPe(e,{expr:t,suffix:"start"})}`:uPe(e,{expr:t}):function(e){const{datum:t}=e;return QIe(t)?oBe(t):`${JSON.stringify(t)}`}(e)}function TLe({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o,field:a}){return a=null!=a?a:MLe(e,r,i),KLe(e)&&bIe(e.bin)?{signal:NLe(a,uPe(e,{expr:r,binSuffix:"end"}),t,n,o)}:{signal:kLe(n,a,t)}}function ELe(e,t,n,r,i,o){var a;if(!wLe(r))return CPe(e)?function(e,t,n,r){return e||(t?{signal:dBe(t)}:r?void 0:n.timeFormat)}(n,KLe(e)?null===(a=hBe(e.timeUnit))||void 0===a?void 0:a.unit:void 0,i,o):FLe(t,n,i)}function ALe(e,t,n){return e&&(fBe(e)||"number"===e||"time"===e)?e:CPe(t)&&"time"!==n&&"utc"!==n?"time":void 0}function FLe(e,t,n){return XOe(t)?t:e===NBe?n.numberFormat:void 0}function OLe(e,t){return`format(${e}, "${t||""}")`}function RLe(e,t,n,r){var i;return wLe(n)?kLe(n,e,t):OLe(e,null!==(i=XOe(t)?t:void 0)&&void 0!==i?i:r.numberFormat)}function NLe(e,t,n,r,i){const o=RLe(e,n,r,i),a=RLe(t,n,r,i);return`${FBe(e,!1)} ? "null" : ${o} + "${SLe}" + ${a}`}const DLe="min",ILe={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function BLe(e){return e in ILe}function LLe(e){return!!e&&!!e.encoding}function PLe(e){return!(!e||"count"!==e.op&&!e.field)}function $Le(e){return!!e&&LOe(e)}function zLe(e){return"row"in e||"column"in e}function jLe(e){return!!e&&"header"in e}function GLe(e){return"facet"in e}function ULe(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function WLe(e){return nPe(e)&&"sort"in e}function VLe({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:i,config:o,isMidPoint:a}){if(tPe(t)&&void 0!==t.band)return t.band;if(KLe(t)){const{timeUnit:e,bin:i}=t;if(e&&!n)return a?BPe("timeUnitBandPosition",r,o):dNe(r.type)?BPe("timeUnitBand",r,o):0;if(bIe(i))return dNe(r.type)&&!a?1:.5}return(null==i?void 0:i.fieldChannel)===e&&a?.5:void 0}function HLe(e,t,n,r,i,o){return!!(bIe(t.bin)||t.timeUnit&&nPe(t)&&"temporal"===t.type)&&!!VLe({channel:e,fieldDef:t,fieldDef2:n,stack:r,markDef:i,config:o})}function qLe(e){return!!e&&"condition"in e}function XLe(e){const t=e&&e.condition;return!!t&&!LOe(t)&&KLe(t)}function YLe(e){const t=e&&e.condition;return!!t&&!LOe(t)&&tPe(t)}function KLe(e){return!(!e||!e.field&&"count"!==e.aggregate)}function JLe(e){return e&&e.type}function ZLe(e){return!!e&&"datum"in e}function QLe(e){return nPe(e)&&cPe(e)||ePe(e)}function ePe(e){return ZLe(e)&&qOe(e.datum)}function tPe(e){return KLe(e)||ZLe(e)}function nPe(e){return!!e&&("field"in e&&"type"in e||"count"===e.aggregate)}function rPe(e){return e&&"value"in e&&"value"in e}function iPe(e){return!!e&&("scale"in e||"sort"in e)}function oPe(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function aPe(e){return!!e&&"legend"in e}function sPe(e){return!!e&&("format"in e||"formatType"in e)}function uPe(e,t={}){var n,r,i;let o=e.field;const a=t.prefix;let s=t.suffix,u="";if(function(e){return"count"===e.aggregate}(e))o=function(e){return 0===e.indexOf("__")}(l="count")?l:`__${l}`;else{let a;if(!t.nofn)if(function(e){return"op"in e}(e))a=e.op;else{const{bin:l,aggregate:c,timeUnit:p}=e;bIe(l)?(a=yIe(l),s=(null!==(n=t.binSuffix)&&void 0!==n?n:"")+(null!==(r=t.suffix)&&void 0!==r?r:"")):c?kNe(c)?(u=`["${o}"]`,o=`argmax_${c.argmax}`):wNe(c)?(u=`["${o}"]`,o=`argmin_${c.argmin}`):a=String(c):p&&(a=function(e){const t=hBe(e),{utc:n}=t,r=JOe(t,["utc"]);return r.unit?(n?"utc":"")+CRe(r).map((e=>ARe(`${"unit"===e?"":`_${e}_`}${r[e]}`))).join(""):(n?"utc":"")+"timeunit"+CRe(r).map((e=>ARe(`_${e}_${r[e]}`))).join("")}(p),s=(!mRe(["range","mid"],t.binSuffix)&&t.binSuffix||"")+(null!==(i=t.suffix)&&void 0!==i?i:""))}a&&(o=o?`${a}_${o}`:a)}var l;return s&&(o=`${o}_${s}`),a&&(o=`${a}_${o}`),t.forAs?LRe(o):t.expr?function(e,t="datum"){return`${t}[${YOe(NOe(e).join("."))}]`}(o,t.expr)+u:IRe(o)+u}function lPe(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return KLe(e)&&!!e.bin;case"temporal":return!1}throw new Error(DIe(e.type))}function cPe(e){return!lPe(e)}const pPe=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return function(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(kNe(t))return`${i} for argmax(${t.argmax})`;if(wNe(t))return`${i} for argmin(${t.argmin})`;const o=hBe(r),a=t||(null==o?void 0:o.unit)||(null==o?void 0:o.maxbins)&&"timeunit"||bIe(n)&&"bin";return a?a.toUpperCase()+"("+i+")":i}(e);default:return function(e,t){var n;const{field:r,bin:i,timeUnit:o,aggregate:a}=e;if("count"===a)return t.countTitle;if(bIe(i))return`${r} (binned)`;if(o){const e=null===(n=hBe(o))||void 0===n?void 0:n.unit;if(e)return`${r} (${cBe(e).join("-")})`}else if(a)return kNe(a)?`${r} for max ${a.argmax}`:wNe(a)?`${r} for min ${a.argmin}`:`${RRe(a)} of ${r}`;return r}(e,t)}};let dPe=pPe;function hPe(e){dPe=e}function fPe(e,t,{allowDisabling:n,includeDefault:r=!0}){var i,o;const a=(null!==(i=gPe(e))&&void 0!==i?i:{}).title;if(!KLe(e))return a;const s=e,u=r?mPe(s,t):void 0;return n?$Re(a,s.title,u):null!==(o=null!=a?a:s.title)&&void 0!==o?o:u}function gPe(e){return oPe(e)&&e.axis?e.axis:aPe(e)&&e.legend?e.legend:jLe(e)&&e.header?e.header:void 0}function mPe(e,t){return dPe(e,t)}function yPe(e){var t;if(sPe(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}{const n=null!==(t=gPe(e))&&void 0!==t?t:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function bPe(e){return KLe(e)?e:XLe(e)?e.condition:void 0}function vPe(e){return tPe(e)?e:YLe(e)?e.condition:void 0}function xPe(e,t,n){return XOe(e)||qOe(e)||HOe(e)?(ZIe(function(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${hRe(n)}}.`}(t,XOe(e)?"string":qOe(e)?"number":"boolean",e)),{value:e}):tPe(e)?_Pe(e,t,n):YLe(e)?Object.assign(Object.assign({},e),{condition:_Pe(e.condition,t,n)}):e}function _Pe(e,t,n){if(sPe(e)){const{format:r,formatType:i}=e,o=JOe(e,["format","formatType"]);if(wLe(i)&&!n.customFormatTypes)return ZIe(NIe(t)),_Pe(o,t,n)}else{const r=oPe(e)?"axis":aPe(e)?"legend":jLe(e)?"header":null;if(r&&e[r]){const i=e[r],{format:o,formatType:a}=i,s=JOe(i,["format","formatType"]);if(wLe(a)&&!n.customFormatTypes)return ZIe(NIe(t)),_Pe(Object.assign(Object.assign({},e),{[r]:s}),t,n)}}return KLe(e)?wPe(e,t):function(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=qOe(n)?"quantitative":XOe(n)?"nominal":QIe(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}(e)}function wPe(e,t){const{aggregate:n,timeUnit:r,bin:i,field:o}=e,a=Object.assign({},e);if(!n||SNe(n)||kNe(n)||wNe(n)||(ZIe(function(e){return`Invalid aggregation operator "${e}".`}(n)),delete a.aggregate),r&&(a.timeUnit=hBe(r)),o&&(a.field=`${o}`),bIe(i)&&(a.bin=kPe(i,t)),vIe(i)&&!KDe(t)&&ZIe(`Channel ${t} should not be used with "binned" bin.`),nPe(a)){const{type:e}=a,t=function(e){if(e)switch(e=e.toLowerCase()){case"q":case NBe:return"quantitative";case"t":case IBe:return"temporal";case"o":case DBe:return"ordinal";case"n":case BBe:return"nominal";case LBe:return"geojson"}}(e);e!==t&&(a.type=t),"quantitative"!==e&&MNe(n)&&(ZIe(function(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}(e,n)),a.type="quantitative")}else if(!ADe(t)){const e=function(e,t){if(e.timeUnit)return"temporal";if(bIe(e.bin))return"quantitative";switch(mIe(t)){case"continuous":default:return"quantitative";case"discrete":case"flexible":return"nominal"}}(a,t);ZIe(function(e,t){return`Missing type for channel "${e}", using "${t}" instead.`}(t,e)),a.type=e}if(nPe(a)){const{compatible:e,warning:n}=function(e,t){const n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case ANe:case FNe:case ONe:return cPe(e)?{compatible:!1,warning:PIe(t)}:SPe;case RNe:case NNe:case WNe:case VNe:case HNe:case tDe:case rDe:case iDe:case oDe:case aDe:case sDe:case YNe:case PNe:case BNe:case uDe:return SPe;case jNe:case UNe:case zNe:case GNe:return n!==NBe?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:SPe;case KNe:case JNe:case ZNe:case QNe:case XNe:case $Ne:case LNe:case DNe:case INe:return"nominal"!==n||e.sort?SPe:{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`};case eDe:return mRe(["ordinal","nominal"],e.type)?SPe:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case qNe:return mRe(["ordinal","nominal","geojson"],e.type)?SPe:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case nDe:return"nominal"!==e.type||"sort"in e?SPe:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(a,t);e||ZIe(n)}if(WLe(a)&&XOe(a.sort)){const{sort:e}=a;if(BLe(e))return Object.assign(Object.assign({},a),{sort:{encoding:e}});const t=e.substr(1);if("-"===e.charAt(0)&&BLe(t))return Object.assign(Object.assign({},a),{sort:{encoding:t,order:"descending"}})}if(jLe(a)){const{header:e}=a,{orient:t}=e,n=JOe(e,["orient"]);if(t)return Object.assign(Object.assign({},a),{header:Object.assign(Object.assign({},n),{labelOrient:e.labelOrient||t,titleOrient:e.titleOrient||t})})}return a}function kPe(e,t){return HOe(e)?{maxbins:wIe(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:Object.assign(Object.assign({},e),{maxbins:wIe(t)})}const SPe={compatible:!0};function CPe(e){const{formatType:t}=yPe(e);return"time"===t||!t&&function(e){return e&&("temporal"===e.type||KLe(e)&&!!e.timeUnit)}(e)}function MPe(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var o;const a=t&&(null===(o=hBe(t))||void 0===o?void 0:o.unit);let s,u=a||"temporal"===n;return fBe(e)?s=e.signal:QIe(e)?(u=!0,s=oBe(e)):(XOe(e)||qOe(e))&&u&&(s=`datetime(${JSON.stringify(e)})`,function(e){return!!aBe[e]}(a)&&(qOe(e)&&e<1e4||XOe(e)&&isNaN(Date.parse(e)))&&(s=oBe({[a]:e}))),s?r&&u?`time(${s})`:s:i?void 0:JSON.stringify(e)}function TPe(e,t){const{type:n}=e;return t.map((t=>{const r=MPe(t,{timeUnit:KLe(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:t}))}function EPe(e,t){return bIe(e.bin)?dIe(t)&&mRe(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}function APe(e){const{anchor:t,frame:n,offset:r,orient:i,color:o,subtitleColor:a,subtitleFont:s,subtitleFontSize:u,subtitleFontStyle:l,subtitleFontWeight:c,subtitleLineHeight:p,subtitlePadding:d}=e,h=JOe(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),f=Object.assign(Object.assign({},h),o?{fill:o}:{}),g=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},a?{subtitleColor:a}:{}),s?{subtitleFont:s}:{}),u?{subtitleFontSize:u}:{}),l?{subtitleFontStyle:l}:{}),c?{subtitleFontWeight:c}:{}),p?{subtitleLineHeight:p}:{}),d?{subtitlePadding:d}:{});return{titleMarkConfig:f,subtitleMarkConfig:pRe(f,["align","baseline","dx","dy","limit"]),nonMark:g,subtitle:m}}function FPe(e){return XOe(e)||LOe(e)&&XOe(e[0])}function OPe(e){return fBe(e)?e:void 0!==e?{value:e}:void 0}function RPe(e){return fBe(e)?e.signal:YOe(e.value)}function NPe(e){return fBe(e)?e.signal:null==e?null:YOe(e)}function DPe(e){var t;return[].concat(e.type,null!==(t=e.style)&&void 0!==t?t:[])}function IPe(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:o}=r;return i&&void 0!==t[i]?t[i]:void 0!==t[e]?t[e]:!o||i&&i!==e?BPe(e,t,n,r):void 0}function BPe(e,t,n,{vgChannel:r}={}){return $Re(r?LPe(e,t,n.style):void 0,LPe(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function LPe(e,t,n){return PPe(e,DPe(t),n)}function PPe(e,t,n){let r;t=UOe(t);for(const i of t){const t=n[i];t&&void 0!==t[e]&&(r=t[e])}return r}function $Pe(e,t){return UOe(e).reduce(((e,n)=>{var r;return e.field.push(uPe(n,t)),e.order.push(null!==(r=n.sort)&&void 0!==r?r:"ascending"),e}),{field:[],order:[]})}function zPe(e,t){const n=[...e];return t.forEach((e=>{for(const t of n)if(lRe(t,e))return;n.push(e)})),n}function jPe(e,t){return lRe(e,t)||!t?e:e?[...UOe(e),...UOe(t)].join(", "):t}function GPe(e,t){const n=e.value,r=t.value;if(null==n||null===r)return{explicit:e.explicit,value:null};if((FPe(n)||fBe(n))&&(FPe(r)||fBe(r)))return{explicit:e.explicit,value:jPe(n,r)};if(FPe(n)||fBe(n))return{explicit:e.explicit,value:n};if(FPe(r)||fBe(r))return{explicit:e.explicit,value:r};if(!(FPe(n)||fBe(n)||FPe(r)||fBe(r)))return{explicit:e.explicit,value:zPe(n,r)};throw new Error("It should never reach here")}function UPe(e,t){const n=e&&e[t];return!!n&&(LOe(n)?yRe(n,(e=>!!e.field)):KLe(n)||XLe(n))}function WPe(e){return yRe(bDe,(t=>{if(UPe(e,t)){const n=e[t];if(LOe(n))return yRe(n,(e=>!!e.aggregate));{const e=bPe(n);return e&&!!e.aggregate}}return!1}))}function VPe(e,t){const n=[],r=[],i=[],o=[],a={};return XPe(e,((s,u)=>{if(KLe(s)){const{field:l,aggregate:c,bin:p,timeUnit:d}=s,h=JOe(s,["field","aggregate","bin","timeUnit"]);if(c||d||p){const e=gPe(s),f=e&&e.title;let g=uPe(s,{forAs:!0});const m=Object.assign(Object.assign(Object.assign({},f?[]:{title:fPe(s,t,{allowDisabling:!0})}),h),{field:g});if(c){let e;if(kNe(c)?(e="argmax",g=uPe({op:"argmax",field:c.argmax},{forAs:!0}),m.field=`${g}.${l}`):wNe(c)?(e="argmin",g=uPe({op:"argmin",field:c.argmin},{forAs:!0}),m.field=`${g}.${l}`):"boxplot"!==c&&"errorbar"!==c&&"errorband"!==c&&(e=c),e){const t={op:e,as:g};l&&(t.field=l),o.push(t)}}else if(n.push(g),nPe(s)&&bIe(p)){if(r.push({bin:p,field:l,as:g}),n.push(uPe(s,{binSuffix:"end"})),EPe(s,u)&&n.push(uPe(s,{binSuffix:"range"})),KDe(u)){const e={field:g+"_end"};a[u+"2"]=e}m.bin="binned",ADe(u)||(m.type=NBe)}else if(d){i.push({timeUnit:d,field:l,as:g});const e=nPe(s)&&s.type!==IBe&&"time";e&&(u===tDe||u===oDe?m.formatType=e:function(e){return!!HDe[e]}(u)?m.legend=Object.assign({formatType:e},m.legend):KDe(u)&&(m.axis=Object.assign({formatType:e},m.axis)))}a[u]=m}else n.push(l),a[u]=e[u]}else a[u]=e[u]})),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:a}}function HPe(e,t,n){const r=t.type;return CRe(e).reduce(((i,o)=>{if(!TDe(o))return ZIe(function(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}(o)),i;const a=e[o];if("angle"!==o||"arc"!==r||e.theta||(ZIe("Arc marks uses theta channel rather than angle, replacing angle with theta."),o=PNe),!function(e,t,n){const r=function(e,t){return function(e){switch(e){case WNe:case VNe:case HNe:case uDe:case rDe:case iDe:case oDe:case aDe:case nDe:case KNe:case JNe:case ZNe:case QNe:case ONe:case ANe:case FNe:return hIe;case RNe:case NNe:case zNe:case jNe:return gIe;case DNe:case INe:case GNe:case UNe:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case XNe:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case eDe:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case qNe:return{point:"always",geoshape:"always"};case tDe:return{text:"always"};case YNe:return{point:"always",square:"always",text:"always"};case sDe:return{image:"always"};case PNe:case BNe:return{text:"always",arc:"always"};case $Ne:case LNe:return{arc:"always"}}}(e)[t]}(t,n);if(!r)return!1;if("binned"===r){const n=e[t===DNe?RNe:NNe];return!!(KLe(n)&&KLe(e[t])&&vIe(n.bin))}return!0}(e,o,r))return ZIe(LIe(o,r)),i;if(o===XNe&&"line"===r){const t=bPe(e[o]);if(null==t?void 0:t.aggregate)return ZIe("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead."),i}if(o===WNe&&(t.filled?"fill"in e:"stroke"in e))return ZIe(IIe("encoding",{fill:"fill"in e,stroke:"stroke"in e})),i;if(o===rDe||o===nDe&&!LOe(a)&&!rPe(a)||o===oDe&&LOe(a))a&&(i[o]=UOe(a).reduce(((e,t)=>(KLe(t)?e.push(wPe(t,o)):ZIe(BIe(t,o)),e)),[]));else{if(o===oDe&&null===a)i[o]=null;else if(!(KLe(a)||ZLe(a)||rPe(a)||qLe(a)||fBe(a)))return ZIe(BIe(a,o)),i;i[o]=xPe(a,o,n)}return i}),{})}function qPe(e){const t=[];for(const n of CRe(e))if(UPe(e,n)){const r=UOe(e[n]);for(const e of r)KLe(e)?t.push(e):XLe(e)&&t.push(e.condition)}return t}function XPe(e,t,n){if(e)for(const r of CRe(e)){const i=e[r];if(LOe(i))for(const e of i)t.call(n,e,r);else t.call(n,i,r)}}function YPe(e,t,n,r){return e?CRe(e).reduce(((n,i)=>{const o=e[i];return LOe(o)?o.reduce(((e,n)=>t.call(r,e,n,i)),n):t.call(r,n,o,i)}),n):n}function KPe(e,t){return CRe(t).reduce(((n,r)=>{switch(r){case RNe:case NNe:case aDe:case uDe:case sDe:case DNe:case INe:case PNe:case $Ne:case BNe:case LNe:case zNe:case jNe:case GNe:case UNe:case tDe:case qNe:case YNe:case oDe:return n;case nDe:if("line"===e||"trail"===e)return n;case rDe:case iDe:{const e=t[r];if(LOe(e)||KLe(e))for(const t of UOe(e))t.aggregate||n.push(uPe(t,{}));return n}case XNe:if("trail"===e)return n;case WNe:case VNe:case HNe:case KNe:case JNe:case ZNe:case eDe:case QNe:{const e=bPe(t[r]);return e&&!e.aggregate&&n.push(uPe(e,{})),n}}}),[])}function JPe(e,t,n,r=!0){return"tooltip"in n?{tooltip:n.tooltip}:{tooltip:[...e.map((({fieldPrefix:e,titlePrefix:n})=>{const i=r?` of ${t.field}`:"";return{field:e+t.field,type:t.type,title:fBe(n)?{signal:n+`"${escape(i)}"`}:n+i}})),...qPe(n)]}}function ZPe(e){const{axis:t,title:n,field:r}=e;return t&&void 0!==t.title?void 0:$Re(n,r)}function QPe(e,t,n,r,i){const{scale:o,axis:a}=n;return({partName:s,mark:u,positionPrefix:l,endPositionPrefix:c,aria:p,extraEncoding:d={}})=>{const h=ZPe(n);return e$e(e,s,i,p,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:l+"_"+n.field,type:n.type},void 0!==h?{title:h}:{}),void 0!==o?{scale:o}:{}),void 0!==a?{axis:a}:{})},XOe(c)?{[t+"2"]:{field:c+"_"+n.field}}:{}),r),d)})}}function e$e(e,t,n,r,i){const{clip:o,color:a,opacity:s}=e,u=e.type;return e[t]||void 0===e[t]&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),o?{clip:o}:{}),a?{color:a}:{}),s?{opacity:s}:{}),fNe(i.mark)?i.mark:{type:i.mark}),{style:`${u}-${t}`}),HOe(e[t])?{}:e[t]),!1===r?{aria:r}:{})})]:[]}function t$e(e,t,n){const{encoding:r}=e,i="vertical"===t?"y":"x",o=r[i],a=r[i+"2"],s=r[i+"Error"],u=r[i+"Error2"];return{continuousAxisChannelDef:n$e(o,n),continuousAxisChannelDef2:n$e(a,n),continuousAxisChannelDefError:n$e(s,n),continuousAxisChannelDefError2:n$e(u,n),continuousAxis:i}}function n$e(e,t){if(e&&e.aggregate){const{aggregate:n}=e,r=JOe(e,["aggregate"]);return n!==t&&ZIe(function(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}(n,t)),r}return e}function r$e(e,t){const{mark:n,encoding:r}=e,{x:i,y:o}=r;if(QLe(i)){if(QLe(o)){const e=KLe(i)&&i.aggregate,r=KLe(o)&&o.aggregate;if(e||r!==t){if(r||e!==t){if(e===t&&r===t)throw new Error("Both x and y cannot have aggregate");return fNe(n)&&n.orient?n.orient:"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(QLe(o))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}const i$e="boxplot",o$e=new vNe(i$e,s$e);function a$e(e){return qOe(e)?"tukey":e}function s$e(e,{config:t}){var n,r;const{mark:i,encoding:o,selection:a,projection:s}=e,u=JOe(e,["mark","encoding","selection","projection"]),l=fNe(i)?i:{type:i};a&&ZIe(FIe("boxplot"));const c=null!==(n=l.extent)&&void 0!==n?n:t.boxplot.extent,p=IPe("size",l,t),d=a$e(c),{transform:h,continuousAxisChannelDef:f,continuousAxis:g,groupby:m,aggregate:y,encodingWithoutContinuousAxis:b,ticksOrient:v,boxOrient:x,customTooltipWithoutAggregatedField:_}=function(e,t,n){const r=r$e(e,i$e),{continuousAxisChannelDef:i,continuousAxis:o}=t$e(e,r,i$e),a=i.field,s=a$e(t),u=[...u$e(a),{op:"median",field:a,as:"mid_box_"+a},{op:"min",field:a,as:("min-max"===s?"lower_whisker_":"min_")+a},{op:"max",field:a,as:("min-max"===s?"upper_whisker_":"max_")+a}],l="min-max"===s||"tukey"===s?[]:[{calculate:`datum["upper_box_${a}"] - datum["lower_box_${a}"]`,as:"iqr_"+a},{calculate:`min(datum["upper_box_${a}"] + datum["iqr_${a}"] * ${t}, datum["max_${a}"])`,as:"upper_whisker_"+a},{calculate:`max(datum["lower_box_${a}"] - datum["iqr_${a}"] * ${t}, datum["min_${a}"])`,as:"lower_whisker_"+a}],c=e.encoding,p=o,d=(c[p],JOe(c,["symbol"==typeof p?p:p+""])),{customTooltipWithoutAggregatedField:h,filteredEncoding:f}=function(e){const{tooltip:t}=e,n=JOe(e,["tooltip"]);if(!t)return{filteredEncoding:e};let r,i;if(LOe(t)){for(const e of t)e.aggregate?(r||(r=[]),r.push(e)):(i||(i=[]),i.push(e));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return LOe(i)&&1===i.length&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}(d),{bins:g,timeUnits:m,aggregate:y,groupby:b,encoding:v}=VPe(f,n),x="vertical"===r?"horizontal":"vertical",_=r;return{transform:[...g,...m,{aggregate:[...y,...u],groupby:b},...l],groupby:b,aggregate:y,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:v,ticksOrient:x,boxOrient:_,customTooltipWithoutAggregatedField:h}}(e,c,t),{color:w,size:k}=b,S=JOe(b,["color","size"]),C=e=>QPe(l,g,f,e,t.boxplot),M=C(S),T=C(b),E=C(Object.assign(Object.assign({},S),k?{size:k}:{})),A=JPe([{fieldPrefix:"min-max"===d?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===d?"lower_whisker_":"min_",titlePrefix:"Min"}],f,b),F={type:"tick",color:"black",opacity:1,orient:v,invalid:null},O="min-max"===d?A:JPe([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],f,b),R=[...M({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:O}),...M({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:O}),...M({partName:"ticks",mark:F,positionPrefix:"lower_whisker",aria:!1,extraEncoding:O}),...M({partName:"ticks",mark:F,positionPrefix:"upper_whisker",aria:!1,extraEncoding:O})],N=[..."tukey"!==d?R:[],...T({partName:"box",mark:Object.assign(Object.assign({type:"bar"},p?{size:p}:{}),{orient:x,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:A}),...E({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},POe(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),p?{size:p}:{}),{orient:v,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:A})];let D;if("min-max"!==d){const e=`datum["lower_box_${f.field}"]`,n=`datum["upper_box_${f.field}"]`,r=`(${n} - ${e})`,i=`${e} - ${c} * ${r}`,o=`${n} + ${c} * ${r}`,a=`datum["${f.field}"]`,s={joinaggregate:u$e(f.field),groupby:m};let u;"tukey"===d&&(u={transform:[{filter:`(${i} <= ${a}) && (${a} <= ${o})`},{aggregate:[{op:"min",field:f.field,as:"lower_whisker_"+f.field},{op:"max",field:f.field,as:"upper_whisker_"+f.field},{op:"min",field:"lower_box_"+f.field,as:"lower_box_"+f.field},{op:"max",field:"upper_box_"+f.field,as:"upper_box_"+f.field},...y],groupby:m}],layer:R});const{tooltip:p}=S,h=JOe(S,["tooltip"]),{scale:b,axis:v}=f,x=ZPe(f),w=e$e(l,"outliers",t.boxplot,!0,{transform:[{filter:`(${a} < ${i}) || (${a} > ${o})`}],mark:"point",encoding:Object.assign(Object.assign({[g]:Object.assign(Object.assign(Object.assign({field:f.field,type:f.type},void 0!==x?{title:x}:{}),void 0!==b?{scale:b}:{}),void 0!==v?{axis:v}:{})},h),_?{tooltip:_}:{})})[0];w&&u?D={transform:[s],layer:[w,u]}:w?(D=w,D.transform.unshift(s)):u&&(D=u,D.transform.unshift(s))}return D?Object.assign(Object.assign({},u),{layer:[D,{transform:h,layer:N}]}):Object.assign(Object.assign({},u),{transform:(null!==(r=u.transform)&&void 0!==r?r:[]).concat(h),layer:N})}function u$e(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}const l$e="errorbar",c$e=new vNe(l$e,p$e);function p$e(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,ticksOrient:a,markDef:s,outerSpec:u,tooltipEncoding:l}=d$e(e,l$e,t),c=QPe(s,i,r,o,t.errorbar),p={type:"tick",orient:a},d=[...c({partName:"ticks",mark:p,positionPrefix:"lower",aria:!1,extraEncoding:l}),...c({partName:"ticks",mark:p,positionPrefix:"upper",aria:!1,extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),d.length>1?{layer:d}:Object.assign({},d[0]))}function d$e(e,t,n){var r;const{mark:i,encoding:o,selection:a,projection:s}=e,u=JOe(e,["mark","encoding","selection","projection"]),l=fNe(i)?i:{type:i};a&&ZIe(FIe(t));const{orient:c,inputType:p}=function(e,t){const{encoding:n}=e;if(function(e){return(tPe(e.x)||tPe(e.y))&&!tPe(e.x2)&&!tPe(e.y2)&&!tPe(e.xError)&&!tPe(e.xError2)&&!tPe(e.yError)&&!tPe(e.yError2)}(n))return{orient:r$e(e,t),inputType:"raw"};const r=function(e){return tPe(e.x2)||tPe(e.y2)}(n),i=function(e){return tPe(e.xError)||tPe(e.xError2)||tPe(e.yError)||tPe(e.yError2)}(n),o=n.x,a=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const e=n.x2,r=n.y2;if(tPe(e)&&tPe(r))throw new Error(`${t} cannot have both x2 and y2`);if(tPe(e)){if(QLe(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}if(tPe(r)){if(QLe(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}{const e=n.xError,r=n.xError2,i=n.yError,s=n.yError2;if(tPe(r)&&!tPe(e))throw new Error(`${t} cannot have xError2 without xError`);if(tPe(s)&&!tPe(i))throw new Error(`${t} cannot have yError2 without yError`);if(tPe(e)&&tPe(i))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(tPe(e)){if(QLe(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(tPe(i)){if(QLe(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:f,continuousAxisChannelDefError2:g,continuousAxis:m}=t$e(e,c,t),{errorBarSpecificAggregate:y,postAggregateCalculates:b,tooltipSummary:v,tooltipTitleWithFieldName:x}=function(e,t,n,r,i,o,a,s){let u=[],l=[];const c=t.field;let p,d=!1;if("raw"===o){const t=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":s.errorbar.center,n=e.extent?e.extent:"mean"===t?"stderr":"iqr";if("median"===t!=("iqr"===n)&&ZIe(function(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}(t,n,a)),"stderr"===n||"stdev"===n)u=[{op:n,field:c,as:"extent_"+c},{op:t,field:c,as:"center_"+c}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:"upper_"+c},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:"lower_"+c}],p=[{fieldPrefix:"center_",titlePrefix:RRe(t)},{fieldPrefix:"upper_",titlePrefix:h$e(t,n,"+")},{fieldPrefix:"lower_",titlePrefix:h$e(t,n,"-")}],d=!0;else{let t,r,i;e.center&&e.extent&&ZIe(function(e,t){return`Center is not needed to be specified in ${t} when extent is ${e}.`}(e.extent,a)),"ci"===n?(t="mean",r="ci0",i="ci1"):(t="median",r="q1",i="q3"),u=[{op:r,field:c,as:"lower_"+c},{op:i,field:c,as:"upper_"+c},{op:t,field:c,as:"center_"+c}],p=[{fieldPrefix:"upper_",titlePrefix:fPe({field:c,aggregate:i,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:fPe({field:c,aggregate:r,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:fPe({field:c,aggregate:t,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&ZIe(function(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}(e.center,e.extent)),"aggregated-upper-lower"===o?(p=[],l=[{calculate:`datum["${n.field}"]`,as:"upper_"+c},{calculate:`datum["${c}"]`,as:"lower_"+c}]):"aggregated-error"===o&&(p=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:"upper_"+c}],i?l.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:"lower_"+c}):l.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:"lower_"+c}));for(const e of l)p.push({fieldPrefix:e.as.substring(0,6),titlePrefix:BRe(BRe(e.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:p,tooltipTitleWithFieldName:d}}(l,d,h,f,g,p,t,n),_=o,w=m,k=(_[w],"x"===m?"x2":"y2"),S=(_[k],"x"===m?"xError":"yError"),C=(_[S],"x"===m?"xError2":"yError2"),M=(_[C],JOe(_,["symbol"==typeof w?w:w+"","symbol"==typeof k?k:k+"","symbol"==typeof S?S:S+"","symbol"==typeof C?C:C+""])),{bins:T,timeUnits:E,aggregate:A,groupby:F,encoding:O}=VPe(M,n),R=[...A,...y],N="raw"!==p?[]:F,D=JPe(v,d,O,x);return{transform:[...null!==(r=u.transform)&&void 0!==r?r:[],...T,...E,...0===R.length?[]:[{aggregate:R,groupby:N}],...b],groupby:N,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:O,ticksOrient:"vertical"===c?"horizontal":"vertical",markDef:l,outerSpec:u,tooltipEncoding:D}}function h$e(e,t,n){return RRe(e)+" "+n+" "+t}const f$e="errorband",g$e=new vNe(f$e,m$e);function m$e(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,markDef:a,outerSpec:s,tooltipEncoding:u}=d$e(e,f$e,t),l=a,c=QPe(l,i,r,o,t.errorband),p=void 0!==e.encoding.x&&void 0!==e.encoding.y;let d={type:p?"area":"rect"},h={type:p?"line":"rule"};const f=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return p?(d=Object.assign(Object.assign(Object.assign({},d),f),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign({},h),f)):l.interpolate?ZIe(qIe("interpolate")):l.tension&&ZIe(qIe("tension")),Object.assign(Object.assign({},s),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",aria:!1,extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",aria:!1,extraEncoding:u})]})}const y$e={};function b$e(e,t,n){const r=new vNe(e,t);y$e[e]={normalizer:r,parts:n}}b$e(i$e,s$e,["box","median","outliers","rule","ticks"]),b$e(l$e,p$e,["ticks","rule"]),b$e(f$e,m$e,["band","borders"]);const v$e=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],x$e=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],_$e={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},w$e={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},k$e=(CRe(w$e),"_vgsid_"),S$e={single:{on:"click",fields:[k$e],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[k$e],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function C$e(e){return!(!e||"legend"!==e&&!e.legend)}function M$e(e){return C$e(e)&&POe(e)}function T$e(e){return"concat"in e}function E$e(e){return"vconcat"in e}function A$e(e){return"hconcat"in e}function F$e(e){return POe(e)&&void 0!==e.step}function O$e(e){return e.view||e.width||e.height}const R$e=CRe({align:1,bounds:1,center:1,columns:1,spacing:1});function N$e(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:e["width"===t?"continuousWidth":"continuousHeight"]}function D$e(e,t){const n=I$e(e,t);return F$e(n)?n.step:B$e}function I$e(e,t){var n;return $Re(null!==(n=e[t])&&void 0!==n?n:e["width"===t?"discreteWidth":"discreteHeight"],{step:e.step})}const B$e=20,L$e={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:B$e},mark:{color:"#4c78a8",invalid:"filter",timeUnitBand:1},arc:{},area:{},bar:{binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},circle:{},geoshape:{},image:{},line:{},point:{},rect:{binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5},rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:S$e,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},P$e=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],$$e={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},z$e={blue:P$e[0],orange:P$e[1],red:P$e[2],teal:P$e[3],green:P$e[4],yellow:P$e[5],purple:P$e[6],pink:P$e[7],brown:P$e[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function j$e(e={}){const{color:t,font:n,fontSize:r}=e,i=JOe(e,["color","font","fontSize"]);return zOe({},L$e,n?function(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}(n):{},t?function(e={}){return{signals:[{name:"color",value:POe(e)?Object.assign(Object.assign({},z$e),e):z$e}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(t):{},r?function(e){return{signals:[{name:"fontSize",value:POe(e)?Object.assign(Object.assign({},$$e),e):$$e}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(r):{},i||{})}const G$e=["view",...hNe],U$e=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],W$e=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function V$e(e,t,n,r){const i=r?e[t][r]:e[t];"view"===t&&(n="cell");const o=Object.assign(Object.assign({},i),e.style[null!=n?n:t]);SRe(o)||(e.style[null!=n?n:t]=o),r||delete e[t]}function H$e(e){return"layer"in e}class q$e{map(e,t){return GLe(e)?this.mapFacet(e,t):function(e){return"repeat"in e}(e)?this.mapRepeat(e,t):A$e(e)?this.mapHConcat(e,t):E$e(e)?this.mapVConcat(e,t):T$e(e)?this.mapConcat(e,t):this.mapLayerOrUnit(e,t)}mapLayerOrUnit(e,t){if(H$e(e))return this.mapLayer(e,t);if(bNe(e))return this.mapUnit(e,t);throw new Error(kIe(e))}mapLayer(e,t){return Object.assign(Object.assign({},e),{layer:e.layer.map((e=>this.mapLayerOrUnit(e,t)))})}mapHConcat(e,t){return Object.assign(Object.assign({},e),{hconcat:e.hconcat.map((e=>this.map(e,t)))})}mapVConcat(e,t){return Object.assign(Object.assign({},e),{vconcat:e.vconcat.map((e=>this.map(e,t)))})}mapConcat(e,t){const{concat:n}=e,r=JOe(e,["concat"]);return Object.assign(Object.assign({},r),{concat:n.map((e=>this.map(e,t)))})}mapFacet(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}mapRepeat(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}}const X$e={zero:1,center:1,normalize:1},Y$e=new Set([JRe,QRe,ZRe,iNe,nNe,uNe,lNe,tNe,oNe,aNe]),K$e=new Set([QRe,ZRe,JRe]);function J$e(e,t){var n,r;const i="x"===t?"y":"radius",o=e[t],a=e[i];if(KLe(o)&&KLe(a))if("quantitative"===JLe(o)&&"quantitative"===JLe(a)){if(o.stack)return t;if(a.stack)return i;const e=KLe(o)&&!!o.aggregate;if(e!==(KLe(a)&&!!a.aggregate))return e?t:i;{const e=null===(n=o.scale)||void 0===n?void 0:n.type,s=null===(r=a.scale)||void 0===r?void 0:r.type;if(e&&"linear"!==e)return i;if(s&&"linear"!==s)return t}}else{if("quantitative"===JLe(o))return t;if("quantitative"===JLe(a))return i}else{if("quantitative"===JLe(o))return t;if("quantitative"===JLe(a))return i}}function Z$e(e,t,n={}){const r=fNe(e)?e.type:e;if(!Y$e.has(r))return null;const i=J$e(t,"x")||J$e(t,"theta");if(!i)return null;const o=t[i],a=KLe(o)?uPe(o,{}):void 0;let s=function(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(i),u=t[s],l=KLe(u)?uPe(u,{}):void 0;l===a&&(l=void 0,u=void 0,s=void 0);const c=qDe.reduce(((e,n)=>{if("tooltip"!==n&&UPe(t,n)){const r=t[n];for(const t of UOe(r)){const r=bPe(t);if(r.aggregate)continue;const i=uPe(r,{});i&&i===l||e.push({channel:n,fieldDef:r})}}return e}),[]);let p;if(void 0!==o.stack?p=HOe(o.stack)?o.stack?"zero":null:o.stack:c.length>0&&K$e.has(r)&&(p="zero"),!p||!(p in X$e))return null;var d;if(WPe(t)&&0===c.length)return null;if(o.scale&&o.scale.type&&o.scale.type!==$Be.LINEAR){if(n.disallowNonLinearStack)return null;ZIe(function(e){return`Cannot stack non-linear scale (${e}).`}(o.scale.type))}return tPe(t[RDe(i)])?(void 0!==o.stack&&ZIe(`Cannot stack "${d=i}" if there is already "${d}2".`),null):(KLe(o)&&o.aggregate&&!mRe(TNe,o.aggregate)&&ZIe(`Stacking is applied even though the aggregate function is non-summative ("${o.aggregate}").`),{groupbyChannel:u?s:void 0,groupbyField:l,fieldChannel:i,impute:null!==o.impute&&pNe(r),stackBy:c,offset:p})}function Q$e(e){const{point:t,line:n}=e,r=JOe(e,["point","line"]);return CRe(r).length>1?r:r.type}function eze(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:dRe(e[t],["point","line"])}));return e}function tze(e,t={},n){return"transparent"===e.point?{opacity:0}:e.point?POe(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?POe(t.point)?t.point:{}:void 0}function nze(e,t={}){return e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}class rze{constructor(){this.name="path-overlay"}hasMatchingType(e,t){if(bNe(e)){const{mark:n,encoding:r}=e,i=fNe(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!tze(i,t[i.type],r);case"area":return!!tze(i,t[i.type],r)||!!nze(i,t[i.type])}}return!1}run(e,t,n){const{config:r}=t,{selection:i,projection:o,encoding:a,mark:s}=e,u=JOe(e,["selection","projection","encoding","mark"]),l=fNe(s)?s:{type:s},c=tze(l,r[l.type],a),p="area"===l.type&&nze(l,r[l.type]),d=[Object.assign(Object.assign({},i?{selection:i}:{}),{mark:Q$e(Object.assign(Object.assign({},"area"===l.type&&void 0===l.opacity&&void 0===l.fillOpacity?{opacity:.7}:{}),l)),encoding:dRe(a,["shape"])})],h=Z$e(l,a);let f=a;if(h){const{fieldChannel:e,offset:t}=h;f=Object.assign(Object.assign({},a),{[e]:Object.assign(Object.assign({},a[e]),t?{stack:t}:{})})}return p&&d.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},pRe(l,["clip","interpolate","tension","tooltip"])),p),encoding:f})),c&&d.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},pRe(l,["clip","tooltip"])),c),encoding:f})),n(Object.assign(Object.assign({},u),{layer:d}),Object.assign(Object.assign({},t),{config:eze(r)}))}}class ize{constructor(){this.name="RangeStep"}hasMatchingType(e){var t;if(bNe(e)&&e.encoding)for(const n of YDe){const r=e.encoding[n];if(r&&tPe(r)&&(null===(t=null==r?void 0:r.scale)||void 0===t?void 0:t.rangeStep))return!0}return!1}run(e){var t;const n={};let r=Object.assign({},e.encoding);for(const e of YDe){const i=NDe(e),o=r[e];if(o&&tPe(o)&&(null===(t=null==o?void 0:o.scale)||void 0===t?void 0:t.rangeStep)){const{scale:t}=o,a=JOe(o,["scale"]),s=t,{rangeStep:u}=s,l=JOe(s,["rangeStep"]);n[i]={step:t.rangeStep},ZIe('Scale\'s "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.'),r=Object.assign(Object.assign({},r),{[e]:Object.assign(Object.assign({},a),SRe(l)?{}:{scale:l})})}}return Object.assign(Object.assign(Object.assign({},n),e),{encoding:r})}}function oze(e,t){return t?zLe(e)?pze(e,t):uze(e,t):e}function aze(e,t){return t?pze(e,t):e}function sze(e,t,n){const r=t[e];return(i=r)&&!XOe(i)&&"repeat"in i?r.repeat in n?Object.assign(Object.assign({},t),{[e]:n[r.repeat]}):void ZIe(function(e){return`Unknown repeated value "${e}".`}(r.repeat)):t;var i}function uze(e,t){if(void 0!==(e=sze("field",e,t))){if(null===e)return null;if(WLe(e)&&PLe(e.sort)){const n=sze("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function lze(e,t){if(KLe(e))return uze(e,t);{const n=sze("datum",e,t);return n===e||n.type||(n.type="nominal"),n}}function cze(e,t){if(!tPe(e)){if(YLe(e)){const n=lze(e.condition,t);if(n)return Object.assign(Object.assign({},e),{condition:n});{const{condition:t}=e;return JOe(e,["condition"])}}return e}{const n=lze(e,t);if(n)return n;if(qLe(e))return{condition:e.condition}}}function pze(e,t){const n={};for(const r in e)if(VOe(e,r)){const i=e[r];if(LOe(i))n[r]=i.map((e=>cze(e,t))).filter((e=>e));else{const e=cze(i,t);void 0!==e&&(n[r]=e)}}return n}class dze{constructor(){this.name="RuleForRangedLine"}hasMatchingType(e){if(bNe(e)){const{encoding:t,mark:n}=e;if("line"===n)for(const e of EDe){const n=t[FDe(e)];if(t[e]&&(KLe(n)&&!vIe(n.bin)||ZLe(n)))return!0}}return!1}run(e,t,n){const{encoding:r}=e;var i,o;return ZIe((i=!!r.x2,o=!!r.y2,`Line mark is for continuous lines and thus cannot be used with ${i&&o?"x2 and y2":i?"x2":"y2"}. We will use the rule mark (line segments) instead.`)),n(Object.assign(Object.assign({},e),{mark:"rule"}),t)}}function hze(e){const{parentEncoding:t,encoding:n}=e;if(t&&n){const e=CRe(t).reduce(((e,t)=>(n[t]&&e.push(t),e)),[]);e.length>0&&ZIe(`Layer's shared ${(r=e).join(",")} channel ${1===r.length?"is":"are"} overriden.`)}var r;const i=Object.assign(Object.assign({},null!=t?t:{}),null!=n?n:{});return SRe(i)?void 0:i}function fze(e){const{parentProjection:t,projection:n}=e;return t&&n&&ZIe(function(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${hRe(t)} is overridden by a child projection ${hRe(n)}.`}({parentProjection:t,projection:n})),null!=n?n:t}function gze(e,t){void 0===t&&(t=j$e(e.config));const n=function(e,t={}){return mze.map(e,{config:t})}(e,t),{width:r,height:i}=e,o=function(e,t,n){let{width:r,height:i}=t;const o=bNe(e)||H$e(e),a={};o?"container"==r&&"container"==i?(a.type="fit",a.contains="padding"):"container"==r?(a.type="fit-x",a.contains="padding"):"container"==i&&(a.type="fit-y",a.contains="padding"):("container"==r&&(ZIe(CIe("width")),r=void 0),"container"==i&&(ZIe(CIe("height")),i=void 0));const s=Object.assign(Object.assign(Object.assign({type:"pad"},a),n?yze(n.autosize):{}),yze(e.autosize));if("fit"!==s.type||o||(ZIe(SIe),s.type="pad"),"container"==r&&"fit"!=s.type&&"fit-x"!=s.type&&ZIe(MIe("width")),"container"==i&&"fit"!=s.type&&"fit-y"!=s.type&&ZIe(MIe("height")),!lRe(s,{type:"pad"}))return s}(n,{width:r,height:i,autosize:e.autosize},t);return Object.assign(Object.assign({},n),o?{autosize:o}:{})}const mze=new class extends q$e{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[o$e,c$e,g$e,new rze,new dze,new ize]}map(e,t){if(bNe(e)){const n=UPe(e.encoding,ANe),r=UPe(e.encoding,FNe),i=UPe(e.encoding,ONe);if(n||r||i)return this.mapFacetedUnit(e,t)}return super.map(e,t)}mapUnit(e,t){const{parentEncoding:n,parentProjection:r}=t,i=Object.assign(Object.assign({},e),{encoding:aze(e.encoding,t.repeater)});if(n||r)return this.mapUnitWithParentEncodingOrProjection(i,t);const o=this.mapLayerOrUnit.bind(this);for(const e of this.nonFacetUnitNormalizers)if(e.hasMatchingType(i,t.config))return e.run(i,t,o);return i}mapRepeat(e,t){return function(e){return!LOe(e.repeat)&&e.repeat.layer}(e)?this.mapLayerRepeat(e,t):this.mapNonLayerRepeat(e,t)}mapLayerRepeat(e,t){const{repeat:n,spec:r}=e,i=JOe(e,["repeat","spec"]),{row:o,column:a,layer:s}=n,{repeater:u={},repeaterPrefix:l=""}=t;return o||a?this.mapRepeat(Object.assign(Object.assign({},e),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),a?{column:a}:{}),spec:{repeat:{layer:s},spec:r}}),t):Object.assign(Object.assign({},i),{layer:s.map((e=>{const n=Object.assign(Object.assign({},u),{layer:e}),i=(r.name||"")+l+`child__layer_${ARe(e)}`,o=this.mapLayerOrUnit(r,Object.assign(Object.assign({},t),{repeater:n,repeaterPrefix:i}));return o.name=i,o}))})}mapNonLayerRepeat(e,t){var n;const{repeat:r,spec:i,data:o}=e,a=JOe(e,["repeat","spec","data"]);!LOe(r)&&e.columns&&(e=dRe(e,["columns"]),ZIe(OIe("repeat")));const s=[],{repeater:u={},repeaterPrefix:l=""}=t,c=!LOe(r)&&r.row||[u?u.row:null],p=!LOe(r)&&r.column||[u?u.column:null],d=LOe(r)&&r||[u?u.repeat:null];for(const e of d)for(const n of c)for(const o of p){const a={repeat:e,row:n,column:o,layer:u.layer},c=(i.name||"")+l+"child__"+(LOe(r)?`${ARe(e)}`:(r.row?`row_${ARe(n)}`:"")+(r.column?`column_${ARe(o)}`:"")),p=this.map(i,Object.assign(Object.assign({},t),{repeater:a,repeaterPrefix:c}));p.name=c,s.push(dRe(p,["data"]))}const h=LOe(r)?e.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:null!==(n=i.data)&&void 0!==n?n:o,align:"all"},a),{columns:h,concat:s})}mapFacet(e,t){const{facet:n}=e;return zLe(n)&&e.columns&&(e=dRe(e,["columns"]),ZIe(OIe("facet"))),super.mapFacet(e,t)}mapUnitWithParentEncodingOrProjection(e,t){const{encoding:n,projection:r}=e,{parentEncoding:i,parentProjection:o,config:a}=t,s=fze({parentProjection:o,projection:r}),u=hze({parentEncoding:i,encoding:aze(n,t.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},e),s?{projection:s}:{}),u?{encoding:u}:{}),{config:a})}mapFacetedUnit(e,t){const n=e.encoding,{row:r,column:i,facet:o}=n,a=JOe(n,["row","column","facet"]),{mark:s,width:u,projection:l,height:c,view:p,selection:d,encoding:h}=e,f=JOe(e,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:g,layout:m}=this.getFacetMappingAndLayout({row:r,column:i,facet:o},t),y=aze(a,t.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},f),m),{facet:g,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{width:u}:{}),c?{height:c}:{}),p?{view:p}:{}),l?{projection:l}:{}),{mark:s,encoding:y}),d?{selection:d}:{})}),t)}getFacetMappingAndLayout(e,t){var n;const{row:r,column:i,facet:o}=e;if(r||i){o&&ZIe(`Facet encoding dropped as ${(a=[...r?[ANe]:[],...i?[FNe]:[]]).join(" and ")} ${a.length>1?"are":"is"} also specified.`);const t={},s={};for(const r of[ANe,FNe]){const i=e[r];if(i){const{align:e,center:o,spacing:a,columns:u}=i,l=JOe(i,["align","center","spacing","columns"]);t[r]=l;for(const e of["align","center","spacing"])void 0!==i[e]&&(s[e]=null!==(n=s[e])&&void 0!==n?n:{},s[e][r]=i[e])}}return{facetMapping:t,layout:s}}{const{align:e,center:n,spacing:r,columns:i}=o;return{facetMapping:oze(JOe(o,["align","center","spacing","columns"]),t.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},e?{align:e}:{}),n?{center:n}:{}),r?{spacing:r}:{}),i?{columns:i}:{})}}var a}mapLayer(e,t){var{parentEncoding:n,parentProjection:r}=t,i=JOe(t,["parentEncoding","parentProjection"]);const{encoding:o,projection:a}=e,s=JOe(e,["encoding","projection"]),u=Object.assign(Object.assign({},i),{parentEncoding:hze({parentEncoding:n,encoding:o}),parentProjection:fze({parentProjection:r,projection:a})});return super.mapLayer(s,u)}};function yze(e){return XOe(e)?{type:e}:null!=e?e:{}}const bze=["background","padding"];function vze(e){return bze.reduce(((t,n)=>(e&&void 0!==e[n]&&(t[n]=e[n]),t)),{})}class xze{constructor(e={},t={}){this.explicit=e,this.implicit=t}clone(){return new xze(cRe(this.explicit),cRe(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(e){return $Re(this.explicit[e],this.implicit[e])}getWithExplicit(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}}setWithExplicit(e,t){void 0!==t.value&&this.set(e,t.value,t.explicit)}set(e,t,n){return delete this[n?"implicit":"explicit"][e],this[n?"explicit":"implicit"][e]=t,this}copyKeyFromSplit(e,t){void 0!==t.explicit[e]?this.set(e,t.explicit[e],!0):void 0!==t.implicit[e]&&this.set(e,t.implicit[e],!1)}copyKeyFromObject(e,t){void 0!==t[e]&&this.set(e,t[e],!0)}copyAll(e){for(const t of CRe(e.combine())){const n=e.getWithExplicit(t);this.setWithExplicit(t,n)}}}function _ze(e){return{explicit:!0,value:e}}function wze(e){return{explicit:!1,value:e}}function kze(e){return(t,n,r,i)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:Sze(t,n,r,i)}}function Sze(e,t,n,r){return e.explicit&&t.explicit&&ZIe(function(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${hRe(n)} and ${hRe(r)}). Using ${hRe(n)}.`}(n,r,e.value,t.value)),e}function Cze(e,t,n,r,i=Sze){return void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:lRe(e.value,t.value)?e:i(e,t,n,r)}class Mze extends xze{constructor(e={},t={},n=!1){super(e,t),this.explicit=e,this.implicit=t,this.parseNothing=n}clone(){const e=super.clone();return e.parseNothing=this.parseNothing,e}}function Tze(e){return"url"in e}function Eze(e){return"values"in e}function Aze(e){return"name"in e&&!Tze(e)&&!Eze(e)&&!Fze(e)}function Fze(e){return e&&(Oze(e)||Rze(e)||Nze(e))}function Oze(e){return"sequence"in e}function Rze(e){return"sphere"in e}function Nze(e){return"graticule"in e}const Dze="main",Ize="raw";function Bze(e){return"filter"in e}function Lze(e){return"lookup"in e}function Pze(e){return"pivot"in e}function $ze(e){return"density"in e}function zze(e){return"quantile"in e}function jze(e){return"regression"in e}function Gze(e){return"loess"in e}function Uze(e){return"sample"in e}function Wze(e){return"window"in e}function Vze(e){return"joinaggregate"in e}function Hze(e){return"flatten"in e}function qze(e){return"calculate"in e}function Xze(e){return"bin"in e}function Yze(e){return"impute"in e}function Kze(e){return"timeUnit"in e}function Jze(e){return"aggregate"in e}function Zze(e){return"stack"in e}function Qze(e){return"fold"in e}function eje(e,t,n,r){const i=qLe(t)&&t.condition,o=r(t);if(i){const t=UOe(i).map((t=>{const n=r(t),i=function(e){return e.selection}(t)?JUe(e,t.selection):QUe(e,t.test);return Object.assign({test:i},n)}));return{[n]:[...t,...void 0!==o?[o]:[]]}}return void 0!==o?{[n]:o}:{}}function tje(e,t="text"){const n=e.encoding[t];return eje(e,n,t,(t=>nje(t,e.config)))}function nje(e,t,n="datum"){if(e){if(rPe(e))return OPe(e.value);if(tPe(e)){const{format:r,formatType:i}=yPe(e);return CLe({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function rje(e,t={}){const{encoding:n,markDef:r,config:i,stack:o}=e,a=n.tooltip;if(LOe(a))return{tooltip:oje({tooltip:a},o,i,t)};{const s=t.reactiveGeom?"datum.datum":"datum";return eje(e,a,"tooltip",(e=>{const a=nje(e,i,s);if(a)return a;if(null===e)return;let u=IPe("tooltip",r,i);return!0===u&&(u={content:"encoding"}),XOe(u)?{value:u}:POe(u)?"encoding"===u.content?oje(n,o,i,t):{signal:s}:void 0}))}}function ije(e,t,n,{reactiveGeom:r}={}){const i={},o=r?"datum.datum":"datum",a=[];function s(r,s){const u=FDe(s),l=nPe(r)?r:Object.assign(Object.assign({},r),{type:e[u].type}),c=UOe(fPe(l,n,{allowDisabling:!1})).join(", ");let p;if(KDe(s)){const r="x"===s?"x2":"y2",a=bPe(e[r]);if(vIe(l.bin)&&a){const e=uPe(l,{expr:o}),t=uPe(a,{expr:o}),{format:s,formatType:u}=yPe(l);p=NLe(e,t,s,u,n),i[r]=!0}else if(t&&t.fieldChannel===s&&"normalize"===t.offset){const{format:e,formatType:t}=yPe(l);p=CLe({fieldOrDatumDef:l,format:e,formatType:t,expr:o,config:n,normalizeStack:!0}).signal}}p=null!=p?p:nje(l,n,o).signal,a.push({channel:s,key:c,value:p})}XPe(e,((e,t)=>{KLe(e)?s(e,t):XLe(e)&&s(e.condition,t)}));const u={};for(const{channel:e,key:t,value:n}of a)i[e]||u[t]||(u[YOe(t)]=n);return u}function oje(e,t,n,{reactiveGeom:r}={}){const i=TRe(ije(e,t,n,{reactiveGeom:r})).map((({key:e,value:t})=>`${e}: ${t}`));return i.length>0?{signal:`{${i.join(", ")}}`}:void 0}function aje(e,t,n={}){const{markDef:r,encoding:i,config:o}=t,{vgChannel:a}=n;let{defaultRef:s,defaultValue:u}=n;void 0===s&&(u=null!=u?u:IPe(e,r,o,{vgChannel:a,ignoreVgConfig:!0}),void 0!==u&&(s=OPe(u)));const l=i[e];return eje(t,l,null!=a?a:e,(n=>xLe({channel:e,channelDef:n,markDef:r,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s})))}function sje(e,t={filled:void 0}){var n,r,i,o;const{markDef:a,encoding:s,config:u}=e,{type:l}=a,c=null!==(n=t.filled)&&void 0!==n?n:IPe("filled",a,u),p=mRe(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,d=null!==(i=null!==(r=IPe(!0===c?"color":void 0,a,u,{vgChannel:"fill"}))&&void 0!==r?r:u.mark[!0===c&&"color"])&&void 0!==i?i:p,h=null!==(o=IPe(!1===c?"color":void 0,a,u,{vgChannel:"stroke"}))&&void 0!==o?o:u.mark[!1===c&&"color"],f=c?"fill":"stroke",g=Object.assign(Object.assign({},d?{fill:OPe(d)}:{}),h?{stroke:OPe(h)}:{});return a.color&&(c?a.fill:a.stroke)&&ZIe(IIe("property",{fill:"fill"in a,stroke:"stroke"in a})),Object.assign(Object.assign(Object.assign(Object.assign({},g),aje("color",e,{vgChannel:f,defaultValue:c?d:h})),aje("fill",e,{defaultValue:s.fill?d:void 0})),aje("stroke",e,{defaultValue:s.stroke?h:void 0}))}function uje(e,t){const n=function(e){switch(e){case RNe:return"xOffset";case NNe:return"yOffset";case DNe:return"x2Offset";case INe:return"y2Offset";case PNe:return"thetaOffset";case BNe:return"radiusOffset";case $Ne:return"theta2Offset";case LNe:return"radius2Offset"}}(e),r=t[n];if(r)return r}function lje(e,t,{defaultPos:n,vgChannel:r,isMidPoint:i}){const{encoding:o,markDef:a,config:s,stack:u}=t,l=o[e],c=o[RDe(e)],p=t.scaleName(e),d=t.getScaleComponent(e),h=uje(e,a),f=cje({model:t,defaultPos:n,channel:e,scaleName:p,scale:d}),g=!l&&KDe(e)&&(o.latitude||o.longitude)?{field:t.getName(e)}:function(e){const{channel:t,channelDef:n,isMidPoint:r,scaleName:i,stack:o,offset:a,markDef:s,config:u}=e;if(tPe(n)&&o&&t===o.fieldChannel){if(KLe(n)){const e=VLe({channel:t,fieldDef:n,isMidPoint:r,markDef:s,stack:o,config:u});if(void 0!==e)return vLe({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",band:e,offset:a})}return bLe(n,i,{suffix:"end"},{offset:a})}return fLe(e)}({channel:e,channelDef:l,channel2Def:c,markDef:a,config:s,isMidPoint:i,scaleName:p,scale:d,stack:u,offset:h,defaultRef:f});return g?{[r||e]:g}:void 0}function cje({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:o,config:a}=e;return()=>{const s=FDe(n),u=ODe(n),l=IPe(n,o,a,{vgChannel:u});if(void 0!==l)return _Le(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){const e=i.get("type");if(mRe([$Be.LOG,$Be.TIME,$Be.UTC],e));else if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}if("zeroOrMin"===t)return"y"===s?{field:{group:"height"}}:{value:0};switch(s){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const t=e[NDe(n)];return Object.assign(Object.assign({},t),{mult:.5})}}}}const pje={left:"x",center:"xc",right:"x2"},dje={top:"y",middle:"yc",bottom:"y2"};function hje(e,t,n,r="middle"){if("radius"===e||"theta"===e)return ODe(e);const i=IPe("x"===e?"align":"baseline",t,n);return"x"===e?pje[i||("top"===r?"left":"center")]:dje[i||r]}function fje(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?gje(e,t,{defaultPos:n,defaultPos2:r}):lje(e,t,{defaultPos:n})}function gje(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:o}=t,a=RDe(e),s=NDe(e),u=function(e,t,n){const{encoding:r,mark:i,markDef:o,stack:a,config:s}=e,u=FDe(n),l=NDe(n),c=ODe(n),p=r[u],d=e.scaleName(u),h=e.getScaleComponent(u),f=uje(n in r||n in o?n:u,e.markDef);if(!p&&("x2"===n||"y2"===n)&&(r.latitude||r.longitude))return{[c]:{field:e.getName(n)}};const g=function({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:a,stack:s,offset:u,defaultRef:l}){return tPe(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0)?bLe(t,o,{suffix:"start"},{offset:u}):fLe({channel:e,channelDef:n,scaleName:o,scale:a,stack:s,markDef:r,config:i,offset:u,defaultRef:l})}({channel:n,channelDef:p,channel2Def:r[n],markDef:o,config:s,scaleName:d,scale:h,stack:a,offset:f,defaultRef:void 0});return void 0!==g?{[c]:g}:mje(n,o)||mje(n,{[n]:LPe(n,o,s.style),[l]:LPe(l,o,s.style)})||mje(n,s[i])||mje(n,s.mark)||{[c]:cje({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}(t,r,a),l=u[s]?hje(e,i,o):ODe(e);return Object.assign(Object.assign({},lje(e,t,{defaultPos:n,vgChannel:l})),u)}function mje(e,t){const n=NDe(e),r=ODe(e);return void 0!==t[r]?{[r]:_Le(e,t[r])}:void 0!==t[e]?{[r]:_Le(e,t[e])}:t[n]?{[n]:_Le(e,t[n])}:void 0}function yje(e,t,n){var r,i,o,a;const{config:s,encoding:u,markDef:l,stack:c}=e,p=RDe(t),d=NDe(t),h=u[t],f=u[p],g=e.getScaleComponent(t),m=g?g.get("type"):void 0,y=e.scaleName(t),b=l.orient,v=null!==(i=null!==(r=u[d])&&void 0!==r?r:u.size)&&void 0!==i?i:IPe("size",l,s,{vgChannel:d}),x="bar"===n&&("x"===t?"vertical"===b:"horizontal"===b);if(KLe(h)&&(bIe(h.bin)||vIe(h.bin)||h.timeUnit&&!f)&&!v&&!JBe(m)){const n=VLe({channel:t,fieldDef:h,stack:c,markDef:l,config:s}),r=null===(o=e.component.axes[t])||void 0===o?void 0:o[0];return function({fieldDef:e,fieldDef2:t,channel:n,band:r,scaleName:i,markDef:o,spacing:a=0,axisTranslate:s,reverse:u,config:l}){const c=RDe(n),p=ODe(n),d=ODe(c),h=uje(n,o);if(bIe(e.bin)||e.timeUnit)return{[d]:xje({channel:n,fieldDef:e,scaleName:i,markDef:o,band:(1-r)/2,offset:vje(c,a,u,s,h),config:l}),[p]:xje({channel:n,fieldDef:e,scaleName:i,markDef:o,band:1-(1-r)/2,offset:vje(n,a,u,s,h),config:l})};if(vIe(e.bin)){const r=bLe(e,i,{},{offset:vje(c,a,u,s,h)});if(KLe(t))return{[d]:r,[p]:bLe(t,i,{},{offset:vje(n,a,u,s,h)})};if(xIe(e.bin)&&e.bin.step)return{[d]:r,[p]:{signal:`scale("${i}", ${uPe(e,{expr:"datum"})} + ${e.bin.step})`,offset:vje(n,a,u,s,h)}}}ZIe(XIe(c))}({fieldDef:h,fieldDef2:f,channel:t,markDef:l,scaleName:y,band:n,axisTranslate:null!==(a=null==r?void 0:r.get("translate"))&&void 0!==a?a:.5,spacing:KDe(t)?IPe("binSpacing",l,s):void 0,reverse:g.get("reverse"),config:s})}return(tPe(h)&&JBe(m)||x)&&!f?function(e,t,n,r){var i;const{markDef:o,encoding:a,config:s,stack:u}=r,l=o.orient,c=r.scaleName(n),p=r.getScaleComponent(n),d=NDe(n),h=RDe(n),f="horizontal"===l&&"y"===n||"vertical"===l&&"x"===n,g=IPe(f?"size":d,o,s,{vgChannel:d});let m;(a.size||void 0!==g)&&(f?m=aje("size",r,{vgChannel:d,defaultValue:g}):ZIe(function(e){return`Cannot apply size to non-oriented mark "${e}".`}(o.type)));const y=null!==(i=tPe(t)?VLe({channel:n,fieldDef:t,markDef:o,stack:u,config:s}):void 0)&&void 0!==i?i:1;m=m||{[d]:bje(e,d,c,p,s,y)};const b="band"!==(null==p?void 0:p.get("type"))||!("band"in m[d]),v=hje(n,o,s,b?"middle":"top"),x=uje(n,o),_=fLe({channel:n,channelDef:t,markDef:o,config:s,scaleName:c,scale:p,stack:u,offset:x,defaultRef:cje({model:r,defaultPos:"mid",channel:n,scaleName:c,scale:p}),band:b?.5:(1-y)/2});if(d)return Object.assign({[v]:_},m);{const e=ODe(h),t=m[d],n=x?Object.assign(Object.assign({},t),{offset:x}):t;return{[v]:_,[e]:LOe(_)?[_[0],Object.assign(Object.assign({},_[1]),{offset:n})]:Object.assign(Object.assign({},_),{offset:n})}}}(n,h,t,e):gje(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function bje(e,t,n,r,i,o){if(r){const t=r.get("type");if("point"===t||"band"===t){if(void 0!==i[e].discreteBandSize)return{value:i[e].discreteBandSize};if(t===$Be.POINT){const e=r.get("range");return gBe(e)&&qOe(e.step)?{value:e.step-2}:{value:B$e-2}}return{scale:n,band:o}}return{value:i[e].continuousBandSize}}const a=D$e(i.view,t),s=$Re(i[e].discreteBandSize,a-2);return void 0!==s?{value:s}:void 0}function vje(e,t,n,r,i){if(cDe(e))return 0;const o="x"===e||"y2"===e?-t/2:t/2;if(fBe(n)){const e=NPe(i);return{signal:`${n.signal} ? ${r-o}${e?"-"+e:""} : ${r+o}${e?"+"+e:""}`}}if(fBe(i)){const e=r+(n?-o:o);return{signal:`${e||""}${n?" - ":e?" + ":""}${i.signal}`}}return i=i||0,r+(n?-i-o:+i+o)}function xje({channel:e,fieldDef:t,scaleName:n,markDef:r,band:i,offset:o,config:a}){return gLe({fieldDef:t,channel:e,markDef:r,ref:vLe({scaleName:n,fieldOrDatumDef:t,band:i,offset:o}),config:a})}const _je=new Set(["aria"]);function wje(e,t){const{fill:n,stroke:r}="include"===t.color?sje(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(e,t){return yBe.reduce(((n,r)=>(_je.has(r)||void 0===e[r]||"ignore"===t[r]||(n[r]=OPe(e[r])),n)),{})}(e.markDef,t)),kje(e,"fill",n)),kje(e,"stroke",r)),aje("opacity",e)),aje("fillOpacity",e)),aje("strokeOpacity",e)),aje("strokeWidth",e)),aje("strokeDash",e)),rje(e)),tje(e,"href")),function(e){const{markDef:t,config:n}=e,r=IPe("aria",t,n);return!1===r?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),function(e){const{mark:t,markDef:n,config:r}=e;if(!1===r.aria)return{};const i=IPe("ariaRoleDescription",n,r);return null!=i?{ariaRoleDescription:{value:i}}:t in bBe?{}:{ariaRoleDescription:{value:t}}}(e)),function(e){const{encoding:t,markDef:n,config:r,stack:i}=e,o=t.description;if(o)return eje(e,o,"description",(t=>nje(t,e.config)));const a=IPe("description",n,r);if(null!=a)return{description:OPe(a)};if(!1===r.aria)return{};const s=ije(t,i,r);return SRe(s)?void 0:{description:{signal:TRe(s).map((({key:e,value:t})=>`${e} + ": " + (${t})`)).join(' + "; " + ')}}}(e))}(e))}function kje(e,t,n){const{config:r,mark:i,markDef:o}=e;if("hide"===IPe("invalid",o,r)&&n&&!pNe(i)){const r=function(e,{invalid:t=!1,channels:n}){const r=n.reduce(((t,n)=>{const r=e.getScaleComponent(n);if(r){const i=r.get("type"),o=e.vgField(n,{expr:"datum"});o&&ZBe(i)&&(t[o]=!0)}return t}),{}),i=CRe(r);if(i.length>0){const e=t?"||":"&&";return i.map((e=>yLe(e,t))).join(` ${e} `)}}(e,{invalid:!0,channels:pIe});if(r)return{[t]:[{test:r,value:null},...UOe(n)]}}return n?{[t]:n}:{}}function Sje(e){const{config:t,markDef:n}=e;if(IPe("invalid",n,t)){const t=function(e,{invalid:t=!1,channels:n}){const r=n.reduce(((t,n)=>{const r=e.getScaleComponent(n);if(r){const i=r.get("type"),o=e.vgField(n,{expr:"datum"});o&&ZBe(i)&&(t[o]=!0)}return t}),{}),i=CRe(r);if(i.length>0){const e=t?"||":"&&";return i.map((e=>yLe(e,t))).join(` ${e} `)}}(e,{channels:YDe});if(t)return{defined:{signal:t}}}return{}}function Cje(e,t){if(void 0!==t)return{[e]:OPe(t)}}const Mje="voronoi",Tje={has:e=>"interval"!==e.type&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(Mje)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,o=e.mark;if(pNe(o))return ZIe(`The "nearest" transform is not supported for ${o} marks.`),n;const a={name:e.getName(Mje),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},rje(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let s=0,u=!1;return n.forEach(((t,n)=>{var r;const i=null!==(r=t.name)&&void 0!==r?r:"";i===e.component.mark[0].name?s=n:i.indexOf(Mje)>=0&&(u=!0)})),u||n.splice(s+1,0,a),n}},Eje=Tje;class Aje{constructor(e,t){this.debugName=t,this._children=[],this._parent=null,e&&(this.parent=e)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(e){this._parent=e,e&&e.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(e,t){this._children.indexOf(e)>-1?console.warn("Attempt to add the same child twice."):void 0!==t?this._children.splice(t,0,e):this._children.push(e)}removeChild(e){const t=this._children.indexOf(e);return this._children.splice(t,1),t}remove(){let e=this._parent.removeChild(this);for(const t of this._children)t._parent=this._parent,this._parent.addChild(t,e++)}insertAsParentOf(e){const t=e.parent;t.removeChild(this),this.parent=t,e.parent=this}swapWithParent(){const e=this._parent,t=e.parent;for(const t of this._children)t.parent=e;this._children=[],e.removeChild(this),e.parent.removeChild(e),this.parent=t,e.parent=this}}class Fje extends Aje{constructor(e,t,n,r){super(e,t),this.type=n,this.refCounts=r,this._source=this._name=t,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const e=new this.constructor;return e.debugName="clone_"+this.debugName,e._source=this._source,e._name="clone_"+this._name,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash=`Output ${function(e){const t=++zRe;return t}()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(e){this._source=e}}class Oje extends Aje{constructor(e,t){super(e),this.formula=t}clone(){return new Oje(null,cRe(this.formula))}static makeFromEncoding(e,t){const n=t.reduceFieldDef(((e,n,r)=>{const{field:i,timeUnit:o}=n,a=wHe(t)?t.encoding[RDe(r)]:void 0,s=wHe(t)&&HLe(r,n,a,t.stack,t.markDef,t.config);if(o){const t=uPe(n,{forAs:!0});e[fRe({as:t,field:i,timeUnit:o})]=Object.assign({as:t,field:i,timeUnit:o},s?{band:!0}:{})}return e}),{});return SRe(n)?null:new Oje(e,n)}static makeFromTransform(e,t){const n=Object.assign({},t),{timeUnit:r}=n,i=JOe(n,["timeUnit"]),o=hBe(r),a=Object.assign(Object.assign({},i),{timeUnit:o});return new Oje(e,{[fRe(a)]:a})}merge(e){this.formula=Object.assign({},this.formula);for(const t in e.formula)this.formula[t]&&!e.formula[t].band||(this.formula[t]=e.formula[t]);for(const t of e.children)e.removeChild(t),t.parent=this;e.remove()}producedFields(){return new Set(MRe(this.formula).map((e=>e.as)))}dependentFields(){return new Set(MRe(this.formula).map((e=>e.field)))}hash(){return`TimeUnit ${fRe(this.formula)}`}assemble(){const e=[];for(const t of MRe(this.formula)){const{field:n,as:r,timeUnit:i}=t,o=hBe(i),{unit:a,utc:s}=o,u=JOe(o,["unit","utc"]);e.push(Object.assign(Object.assign(Object.assign(Object.assign({field:IRe(n),type:"timeunit"},a?{units:cBe(a)}:{}),s?{timezone:"utc"}:{}),u),{as:[r,`${r}_end`]}))}return e}}const Rje="_tuple_fields";class Nje{constructor(...e){this.items=e,this.hasChannel={},this.hasField={}}}const Dje={has:()=>!0,parse:(e,t,n)=>{var r,i,o;const a=t.name,s=null!==(r=t.project)&&void 0!==r?r:t.project=new Nje,u={},l={},c=new Set,p=(e,t)=>{const n="visual"===t?e.channel:e.field;let r=ARe(`${a}_${n}`);for(let e=1;c.has(r);e++)r=ARe(`${a}_${n}_${e}`);return c.add(r),{[t]:r}};if(!n.fields&&!n.encodings){const t=e.config.selection[n.type];if(n.init)for(const e of UOe(n.init))for(const r of CRe(e))MDe[r]?(n.encodings||(n.encodings=[])).push(r):"interval"===n.type?(ZIe('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=t.encodings):(n.fields||(n.fields=[])).push(r);else n.encodings=t.encodings,n.fields=t.fields}for(const e of null!==(i=n.fields)&&void 0!==i?i:[]){const t={type:"E",field:e};t.signals=Object.assign({},p(t,"data")),s.items.push(t),s.hasField[e]=t}for(const r of null!==(o=n.encodings)&&void 0!==o?o:[]){const n=e.fieldDef(r);if(n){let i=n.field;if(n.aggregate){ZIe(AIe(r,n.aggregate));continue}if(!i){ZIe(EIe(r));continue}if(n.timeUnit){i=e.vgField(r);const t={timeUnit:n.timeUnit,as:i,field:n.field};l[fRe(t)]=t}if(!u[i]){let o="E";"interval"===t.type?ZBe(e.getScaleComponent(r).get("type"))&&(o="R"):n.bin&&(o="R-RE");const a={field:i,channel:r,type:o};a.signals=Object.assign(Object.assign({},p(a,"data")),p(a,"visual")),s.items.push(u[i]=a),s.hasField[i]=s.hasChannel[r]=u[i]}}else ZIe(EIe(r))}if(n.init){const e=e=>s.items.map((t=>void 0!==e[t.channel]?e[t.channel]:e[t.field]));if("interval"===n.type)t.init=e(n.init);else{const r=UOe(n.init);t.init=r.map(e)}}SRe(l)||(s.timeUnit=new Oje(null,l))},signals:(e,t,n)=>{const r=t.name+Rje;return n.filter((e=>e.name===r)).length>0?n:n.concat({name:r,value:t.project.items.map((e=>{const{signals:t,hasLegend:n}=e,r=JOe(e,["signals","hasLegend"]);return r.field=IRe(r.field),r}))})}},Ije={has:e=>"single"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind&&!C$e(e.bind),parse:(e,t,n,r)=>{r.on||delete t.events,r.clear||delete t.clear},topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,o=t.bind,a=t.init&&t.init[0],s=Eje.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach(((e,i)=>{var u,l;const c=ARe(`${r}_${e.field}`);n.filter((e=>e.name===c)).length||n.unshift(Object.assign(Object.assign({name:c},a?{init:tGe(a[i])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${s}[${YOe(e.field)}] : null`}]:[],bind:null!==(l=null!==(u=o[e.field])&&void 0!==u?u:o[e.channel])&&void 0!==l?l:o}))})),n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.filter((e=>e.name===r+dGe))[0],a=r+Rje,s=i.items.map((e=>ARe(`${r}_${e.field}`))),u=s.map((e=>`${e} !== null`)).join(" && ");return s.length&&(o.update=`${u} ? {fields: ${a}, values: [${s.join(", ")}]} : null`),delete o.value,delete o.on,n}},Bje=Ije,Lje="_toggle",Pje={has:e=>"multi"===e.type&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+Lje,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+dGe,r=t.name+Lje;return`${r} ? null : ${n}, `+("global"===t.resolve?`${r} ? null : true, `:`${r} ? null : {unit: ${mGe(e)}}, `)+`${r} ? ${n} : null`}},$je={has:e=>void 0!==e.clear&&!1!==e.clear,parse:(e,t,n)=>{n.clear&&(t.clear=XOe(n.clear)?kOe(n.clear,"scope"):n.clear)},topLevelSignals:(e,t,n)=>{if(Bje.has(t))for(const e of t.project.items){const r=n.findIndex((n=>n.name===ARe(`${t.name}_${e.field}`)));-1!==r&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(e,r){-1!==e&&n[e].on&&n[e].on.push({events:t.clear,update:r})}if("interval"===t.type)for(const e of t.project.items){const t=n.findIndex((t=>t.name===e.signals.visual));r(t,"[0, 0]"),-1===t&&r(n.findIndex((t=>t.name===e.signals.data)),"null")}else{let e=n.findIndex((e=>e.name===t.name+dGe));r(e,"null"),Pje.has(t)&&(e=n.findIndex((e=>e.name===t.name+Lje)),r(e,"false"))}return n}},zje={has:e=>"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind,parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!dIe(i))continue;const o=e.getScaleComponent(i),a=o?o.get("type"):void 0;if(!o||!ZBe(a)){ZIe("Scale bindings are currently only supported for scales with unbinned, continuous domains.");continue}const s={selection:t.name,field:r.field};o.set("selectionExtent",s,!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter((e=>0===n.filter((t=>t.name===e.signals.data)).length));if(!e.parent||Uje(e)||0===r.length)return n;const i=n.filter((e=>e.name===t.name))[0];let o=i.update;if(o.indexOf(hGe)>=0)i.update=`{${r.map((e=>`${YOe(e.field)}: ${e.signals.data}`)).join(", ")}}`;else{for(const e of r){const t=`${YOe(e.field)}: ${e.signals.data}`;o.indexOf(t)<0&&(o=`${o.substring(0,o.length-1)}, ${t}}`)}i.update=o}return n.concat(r.map((e=>({name:e.signals.data}))))},signals:(e,t,n)=>{if(e.parent&&!Uje(e))for(const e of t.scales){const t=n.filter((t=>t.name===e.signals.data))[0];t.push="outer",delete t.value,delete t.update}return n}},jje=zje;function Gje(e,t){return`domain(${YOe(e.scaleName(t))})`}function Uje(e){var t;return e.parent&&CHe(e.parent)&&(null!==(t=!e.parent.parent)&&void 0!==t?t:Uje(e.parent.parent))}const Wje={has:e=>{const t="global"===e.resolve&&e.bind&&C$e(e.bind),n=1===e.project.items.length&&e.project.items[0].field!==k$e;return t&&!n&&ZIe("Legend bindings are only supported for selections over an individual field or encoding channel."),t&&n},parse:(e,t,n,r)=>{var i;if(r.on||delete t.events,r.clear||delete t.clear,r.on||r.clear){const e='event.item && indexof(event.item.mark.role, "legend") < 0';for(const n of t.events)n.filter=UOe(null!==(i=n.filter)&&void 0!==i?i:[]),n.filter.indexOf(e)<0&&n.filter.push(e)}const o=M$e(t.bind)?t.bind.legend:"click",a=XOe(o)?kOe(o,"view"):UOe(o);t.bind={legend:{merge:a}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=M$e(t.bind)&&t.bind.legend,o=e=>t=>{const n=cRe(t);return n.markname=e,n};for(const e of t.project.items){if(!e.hasLegend)continue;const a=`${ARe(e.field)}_legend`,s=`${r}_${a}`;if(0===n.filter((e=>e.name===s)).length){const e=i.merge.map(o(`${a}_symbols`)).concat(i.merge.map(o(`${a}_labels`))).concat(i.merge.map(o(`${a}_entries`)));n.unshift(Object.assign(Object.assign({name:s},t.init?{}:{value:null}),{on:[{events:e,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${s}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.find((e=>e.name===r+dGe)),a=r+Rje,s=i.items.filter((e=>e.hasLegend)).map((e=>ARe(`${r}_${ARe(e.field)}_legend`))),u=`${s.map((e=>`${e} !== null`)).join(" && ")} ? {fields: ${a}, values: [${s.join(", ")}]} : null`;t.events&&s.length>0?o.on.push({events:s.map((e=>({signal:e}))),update:u}):s.length>0&&(o.update=u,delete o.value,delete o.on);const l=n.find((e=>e.name===r+Lje)),c=M$e(t.bind)&&t.bind.legend;return l&&(t.events?l.on.push(Object.assign(Object.assign({},l.on[0]),{events:c})):l.on[0].events=c),n}},Vje="_translate_anchor",Hje="_translate_delta",qje={has:e=>"interval"===e.type&&e.translate,signals:(e,t,n)=>{const r=t.name,i=jje.has(t),o=r+Vje,{x:a,y:s}=t.project.hasChannel;let u=kOe(t.translate,"scope");return i||(u=u.map((e=>(e.between[0].markname=r+iGe,e)))),n.push({name:o,value:{},on:[{events:u.map((e=>e.between[0])),update:"{x: x(unit), y: y(unit)"+(void 0!==a?", extent_x: "+(i?Gje(e,RNe):`slice(${a.signals.visual})`):"")+(void 0!==s?", extent_y: "+(i?Gje(e,NNe):`slice(${s.signals.visual})`):"")+"}"}]},{name:r+Hje,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),void 0!==a&&Xje(e,t,a,"width",n),void 0!==s&&Xje(e,t,s,"height",n),n}};function Xje(e,t,n,r,i){var o;const a=t.name,s=a+Vje,u=a+Hje,l=n.channel,c=jje.has(t),p=i.filter((e=>e.name===n.signals[c?"data":"visual"]))[0],d=e.getSizeSignalRef(r).signal,h=e.getScaleComponent(l),f=h.get("type"),g=`${s}.extent_${l}`,m=`${c?"log"===f?"panLog":"pow"===f?"panPow":"panLinear":"panLinear"}(${g}, ${`${c&&l===RNe?"-":""}${u}.${l} / `+(c?`${d}`:`span(${g})`)}`+(c&&"pow"===f?`, ${null!==(o=h.get("exponent"))&&void 0!==o?o:1}`:"")+")";p.on.push({events:{signal:u},update:c?m:`clampRange(${m}, 0, ${d})`})}const Yje="_zoom_anchor",Kje="_zoom_delta",Jje={has:e=>"interval"===e.type&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=jje.has(t),o=r+Kje,{x:a,y:s}=t.project.hasChannel,u=YOe(e.scaleName(RNe)),l=YOe(e.scaleName(NNe));let c=kOe(t.zoom,"scope");return i||(c=c.map((e=>(e.markname=r+iGe,e)))),n.push({name:r+Yje,on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter((e=>!!e)).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==a&&Zje(e,t,a,"width",n),void 0!==s&&Zje(e,t,s,"height",n),n}};function Zje(e,t,n,r,i){var o;const a=t.name,s=n.channel,u=jje.has(t),l=i.filter((e=>e.name===n.signals[u?"data":"visual"]))[0],c=e.getSizeSignalRef(r).signal,p=e.getScaleComponent(s),d=p.get("type"),h=u?Gje(e,s):l.name,f=a+Kje,g=`${u?"log"===d?"zoomLog":"pow"===d?"zoomPow":"zoomLinear":"zoomLinear"}(${h}, ${a}${Yje}.${s}, ${f}`+(u&&"pow"===d?`, ${null!==(o=p.get("exponent"))&&void 0!==o?o:1}`:"")+")";l.on.push({events:{signal:f},update:u?g:`clampRange(${g}, 0, ${c})`})}const Qje=[Dje,Pje,jje,Wje,qje,Jje,Bje,Eje,$je];function eGe(e,t){for(const n of Qje)n.has(e)&&t(n)}function tGe(e,t=!0,n=IOe){if(LOe(e)){const r=e.map((e=>tGe(e,t,n)));return t?`[${r.join(", ")}]`:r}return QIe(e)?n(t?oBe(e):function(e){const t=iBe(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}(e)):t?n(JSON.stringify(e)):e}function nGe(e,t){return gGe(e,((n,r)=>{t=r.marks?r.marks(e,n,t):t,eGe(n,(r=>{r.marks&&(t=r.marks(e,n,t))}))})),t}function rGe(e){return e.map((e=>(e.on&&!e.on.length&&delete e.on,e)))}const iGe="_brush",oGe="_scale_trigger",aGe={signals:(e,t)=>{const n=t.name,r=n+Rje,i=jje.has(t),o=[],a=[],s=[];if(t.translate&&!i){const e=`!event.item || event.item.mark.name !== ${YOe(n+iGe)}`;sGe(t,((t,n)=>{var r;const i=UOe(null!==(r=n.between[0].filter)&&void 0!==r?r:n.between[0].filter=[]);return i.indexOf(e)<0&&i.push(e),t}))}t.project.items.forEach(((n,r)=>{const i=n.channel;if(i!==RNe&&i!==NNe)return void ZIe("Interval selections only support x and y encoding channels.");const u=t.init?t.init[r]:null,l=function(e,t,n,r){const i=n.channel,o=n.signals.visual,a=n.signals.data,s=jje.has(t),u=YOe(e.scaleName(i)),l=e.getScaleComponent(i),c=l?l.get("type"):void 0,p=e=>`scale(${u}, ${e})`,d=e.getSizeSignalRef(i===RNe?"width":"height").signal,h=`${i}(unit)`,f=sGe(t,((e,t)=>[...e,{events:t.between[0],update:`[${h}, ${h}]`},{events:t,update:`[${o}[0], clamp(${h}, 0, ${d})]`}]));return f.push({events:{signal:t.name+oGe},update:ZBe(c)?`[${p(`${a}[0]`)}, ${p(`${a}[1]`)}]`:"[0, 0]"}),s?[{name:a,on:[]}]:[Object.assign(Object.assign({name:o},r?{init:tGe(r,!0,p)}:{value:[]}),{on:f}),Object.assign(Object.assign({name:a},r?{init:tGe(r)}:{}),{on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${u}, ${o})`}]})]}(e,t,n,u),c=n.signals.data,p=n.signals.visual,d=YOe(e.scaleName(i)),h=ZBe(e.getScaleComponent(i).get("type"))?"+":"";o.push(...l),a.push(c),s.push({scaleName:e.scaleName(i),expr:`(!isArray(${c}) || (${h}invert(${d}, ${p})[0] === ${h}${c}[0] && ${h}invert(${d}, ${p})[1] === ${h}${c}[1]))`})})),i||o.push({name:n+oGe,value:{},on:[{events:s.map((e=>({scale:e.scaleName}))),update:s.map((e=>e.expr)).join(" && ")+` ? ${n+oGe} : {}`}]});const u=t.init,l=`unit: ${mGe(e)}, fields: ${r}, values`;return o.concat(Object.assign(Object.assign({name:n+dGe},u?{init:`{${l}: ${tGe(u)}}`}:{}),{on:[{events:[{signal:a.join(" || ")}],update:a.join(" && ")+` ? {${l}: [${a}]} : null`}]}))},modifyExpr:(e,t)=>t.name+dGe+", "+("global"===t.resolve?"true":`{unit: ${mGe(e)}}`),marks:(e,t,n)=>{const r=t.name,{x:i,y:o}=t.project.hasChannel,a=i&&i.signals.visual,s=o&&o.signals.visual,u=`data(${YOe(t.name+pGe)})`;if(jje.has(t))return n;const l={x:void 0!==i?{signal:`${a}[0]`}:{value:0},y:void 0!==o?{signal:`${s}[0]`}:{value:0},x2:void 0!==i?{signal:`${a}[1]`}:{field:{group:"width"}},y2:void 0!==o?{signal:`${s}[1]`}:{field:{group:"height"}}};if("global"===t.resolve)for(const t of CRe(l))l[t]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${mGe(e)}`},l[t]),{value:0}];const c=t.mark,{fill:p,fillOpacity:d,cursor:h}=c,f=JOe(c,["fill","fillOpacity","cursor"]),g=CRe(f).reduce(((e,t)=>(e[t]=[{test:[void 0!==i&&`${a}[0] !== ${a}[1]`,void 0!==o&&`${s}[0] !== ${s}[1]`].filter((e=>e)).join(" && "),value:f[t]},{value:null}],e)),{});return[{name:r+iGe+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:p},fillOpacity:{value:d}},update:l}},...n,{name:r+iGe,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),g)}}]}};function sGe(e,t){return e.events.reduce(((e,n)=>n.between?t(e,n):(ZIe(`${n} is not an ordered event stream for interval selections.`),e)),[])}function uGe(e,t){const n=t.name,r=n+Rje,i=t.project,o="(item().isVoronoi ? datum.datum : datum)",a=i.items.map((t=>{const n=e.fieldDef(t.channel);return n&&n.bin?`[${o}[${YOe(e.vgField(t.channel,{}))}], ${o}[${YOe(e.vgField(t.channel,{binSuffix:"end"}))}]]`:`${o}[${YOe(t.field)}]`})).join(", "),s=`unit: ${mGe(e)}, fields: ${r}, values`,u=t.events;return[{name:n+dGe,on:u?[{events:u,update:`datum && item().mark.marktype !== 'group' ? {${s}: [${a}]} : null`,force:!0}]:[]}]}const lGe={signals:uGe,modifyExpr:(e,t)=>t.name+dGe+", "+("global"===t.resolve?"null":`{unit: ${mGe(e)}}`)},cGe={signals:uGe,modifyExpr:(e,t)=>t.name+dGe+", "+("global"===t.resolve?"true":`{unit: ${mGe(e)}}`)},pGe="_store",dGe="_tuple",hGe="vlSelectionResolve",fGe={single:cGe,multi:lGe,interval:aGe};function gGe(e,t){const n=e.component.selection;if(n)for(const e of MRe(n))if(!0===t(e,fGe[e.type]))break}function mGe(e,{escape:t}={escape:!0}){let n=t?YOe(e.name):e.name;const r=function(e){let t=e.parent;for(;t&&!kHe(t);)t=t.parent;return t}(e);if(r){const{facet:e}=r;for(const t of mDe)e[t]&&(n+=` + '__facet_${t}_' + (facet[${YOe(r.vgField(t))}])`)}return n}function yGe(e){let t=!1;return gGe(e,(e=>{t=t||e.project.items.some((e=>e.field===k$e))})),t}function bGe(e){this.type=e}var vGe,xGe,_Ge,wGe,kGe;bGe.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=function(e){switch(e.type){case"ArrayExpression":return e.elements;case"BinaryExpression":case"LogicalExpression":return[e.left,e.right];case"CallExpression":return[e.callee].concat(e.arguments);case"ConditionalExpression":return[e.test,e.consequent,e.alternate];case"MemberExpression":return[e.object,e.property];case"ObjectExpression":return e.properties;case"Property":return[e.key,e.value];case"UnaryExpression":return[e.argument];default:return[]}}(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};var SGe=1,CGe=2,MGe=3,TGe=4,EGe=5,AGe=6,FGe=7,OGe=8;(vGe={})[SGe]="Boolean",vGe[CGe]="<end>",vGe[MGe]="Identifier",vGe[TGe]="Keyword",vGe[EGe]="Null",vGe[AGe]="Numeric",vGe[FGe]="Punctuator",vGe[OGe]="String",vGe[9]="RegularExpression";var RGe="ArrayExpression",NGe="BinaryExpression",DGe="CallExpression",IGe="ConditionalExpression",BGe="Identifier",LGe="Literal",PGe="LogicalExpression",$Ge="MemberExpression",zGe="ObjectExpression",jGe="Property",GGe="UnaryExpression",UGe="Unexpected token %0",WGe="Unexpected number",VGe="Unexpected string",HGe="Unexpected identifier",qGe="Unexpected reserved word",XGe="Unexpected end of input",YGe="Invalid regular expression",KGe="Invalid regular expression: missing /",JGe="Octal literals are not allowed in strict mode.",ZGe="Duplicate data property in object literal not allowed in strict mode",QGe="ILLEGAL",eUe="Disabled.",tUe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),nUe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function rUe(e,t){if(!e)throw new Error("ASSERT: "+t)}function iUe(e){return e>=48&&e<=57}function oUe(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function aUe(e){return"01234567".indexOf(e)>=0}function sUe(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function uUe(e){return 10===e||13===e||8232===e||8233===e}function lUe(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&tUe.test(String.fromCharCode(e))}function cUe(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&nUe.test(String.fromCharCode(e))}var pUe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function dUe(){for(var e;_Ge<wGe&&(sUe(e=xGe.charCodeAt(_Ge))||uUe(e));)++_Ge}function hUe(e){var t,n,r,i=0;for(n="u"===e?4:2,t=0;t<n;++t)_Ge<wGe&&oUe(xGe[_Ge])?(r=xGe[_Ge++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):MUe({},UGe,QGe);return String.fromCharCode(i)}function fUe(){var e,t,n,r;for(t=0,"}"===(e=xGe[_Ge])&&MUe({},UGe,QGe);_Ge<wGe&&oUe(e=xGe[_Ge++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&MUe({},UGe,QGe),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function gUe(){var e,t;for(e=xGe.charCodeAt(_Ge++),t=String.fromCharCode(e),92===e&&(117!==xGe.charCodeAt(_Ge)&&MUe({},UGe,QGe),++_Ge,(e=hUe("u"))&&"\\"!==e&&lUe(e.charCodeAt(0))||MUe({},UGe,QGe),t=e);_Ge<wGe&&cUe(e=xGe.charCodeAt(_Ge));)++_Ge,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==xGe.charCodeAt(_Ge)&&MUe({},UGe,QGe),++_Ge,(e=hUe("u"))&&"\\"!==e&&cUe(e.charCodeAt(0))||MUe({},UGe,QGe),t+=e);return t}function mUe(){var e,t,n,r,i=_Ge,o=xGe.charCodeAt(_Ge),a=xGe[_Ge];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++_Ge,{type:FGe,value:String.fromCharCode(o),start:i,end:_Ge};default:if(61===(e=xGe.charCodeAt(_Ge+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return _Ge+=2,{type:FGe,value:String.fromCharCode(o)+String.fromCharCode(e),start:i,end:_Ge};case 33:case 61:return _Ge+=2,61===xGe.charCodeAt(_Ge)&&++_Ge,{type:FGe,value:xGe.slice(i,_Ge),start:i,end:_Ge}}}return">>>="===(r=xGe.substr(_Ge,4))?{type:FGe,value:r,start:i,end:_Ge+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:FGe,value:n,start:i,end:_Ge+=3}:a===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(a)>=0||"=>"===t?{type:FGe,value:t,start:i,end:_Ge+=2}:"<>=!+-*%&|^/".indexOf(a)>=0?(++_Ge,{type:FGe,value:a,start:i,end:_Ge}):void MUe({},UGe,QGe)}function yUe(){var e,t,n;if(rUe(iUe((n=xGe[_Ge]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=_Ge,e="","."!==n){if(e=xGe[_Ge++],n=xGe[_Ge],"0"===e){if("x"===n||"X"===n)return++_Ge,function(e){for(var t="";_Ge<wGe&&oUe(xGe[_Ge]);)t+=xGe[_Ge++];return 0===t.length&&MUe({},UGe,QGe),lUe(xGe.charCodeAt(_Ge))&&MUe({},UGe,QGe),{type:AGe,value:parseInt("0x"+t,16),start:e,end:_Ge}}(t);if(aUe(n))return function(e){for(var t="0"+xGe[_Ge++];_Ge<wGe&&aUe(xGe[_Ge]);)t+=xGe[_Ge++];return(lUe(xGe.charCodeAt(_Ge))||iUe(xGe.charCodeAt(_Ge)))&&MUe({},UGe,QGe),{type:AGe,value:parseInt(t,8),octal:!0,start:e,end:_Ge}}(t);n&&iUe(n.charCodeAt(0))&&MUe({},UGe,QGe)}for(;iUe(xGe.charCodeAt(_Ge));)e+=xGe[_Ge++];n=xGe[_Ge]}if("."===n){for(e+=xGe[_Ge++];iUe(xGe.charCodeAt(_Ge));)e+=xGe[_Ge++];n=xGe[_Ge]}if("e"===n||"E"===n)if(e+=xGe[_Ge++],"+"!==(n=xGe[_Ge])&&"-"!==n||(e+=xGe[_Ge++]),iUe(xGe.charCodeAt(_Ge)))for(;iUe(xGe.charCodeAt(_Ge));)e+=xGe[_Ge++];else MUe({},UGe,QGe);return lUe(xGe.charCodeAt(_Ge))&&MUe({},UGe,QGe),{type:AGe,value:parseFloat(e),start:t,end:_Ge}}function bUe(){var e;return dUe(),_Ge>=wGe?{type:CGe,start:_Ge,end:_Ge}:lUe(e=xGe.charCodeAt(_Ge))?function(){var e,t;return e=_Ge,t=92===xGe.charCodeAt(_Ge)?gUe():function(){var e,t;for(e=_Ge++;_Ge<wGe;){if(92===(t=xGe.charCodeAt(_Ge)))return _Ge=e,gUe();if(!cUe(t))break;++_Ge}return xGe.slice(e,_Ge)}(),{type:1===t.length?MGe:pUe.hasOwnProperty(t)?TGe:"null"===t?EGe:"true"===t||"false"===t?SGe:MGe,value:t,start:e,end:_Ge}}():40===e||41===e||59===e?mUe():39===e||34===e?function(){var e,t,n,r,i="",o=!1;for(rUe("'"===(e=xGe[_Ge])||'"'===e,"String literal must starts with a quote"),t=_Ge,++_Ge;_Ge<wGe;){if((n=xGe[_Ge++])===e){e="";break}if("\\"===n)if((n=xGe[_Ge++])&&uUe(n.charCodeAt(0)))"\r"===n&&"\n"===xGe[_Ge]&&++_Ge;else switch(n){case"u":case"x":"{"===xGe[_Ge]?(++_Ge,i+=fUe()):i+=hUe(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:aUe(n)?(0!==(r="01234567".indexOf(n))&&(o=!0),_Ge<wGe&&aUe(xGe[_Ge])&&(o=!0,r=8*r+"01234567".indexOf(xGe[_Ge++]),"0123".indexOf(n)>=0&&_Ge<wGe&&aUe(xGe[_Ge])&&(r=8*r+"01234567".indexOf(xGe[_Ge++]))),i+=String.fromCharCode(r)):i+=n}else{if(uUe(n.charCodeAt(0)))break;i+=n}}return""!==e&&MUe({},UGe,QGe),{type:OGe,value:i,octal:o,start:t,end:_Ge}}():46===e?iUe(xGe.charCodeAt(_Ge+1))?yUe():mUe():iUe(e)?yUe():mUe()}function vUe(){var e;return _Ge=(e=kGe).end,kGe=bUe(),_Ge=e.end,e}function xUe(){var e;e=_Ge,kGe=bUe(),_Ge=e}function _Ue(e,t,n){var r=new bGe("||"===e||"&&"===e?PGe:NGe);return r.operator=e,r.left=t,r.right=n,r}function wUe(e){var t=new bGe(BGe);return t.name=e,t}function kUe(e){var t=new bGe(LGe);return t.value=e.value,t.raw=xGe.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function SUe(e,t,n){var r=new bGe($Ge);return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function CUe(e,t,n){var r=new bGe(jGe);return r.key=t,r.value=n,r.kind=e,r}function MUe(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(function(e,t){return rUe(t<r.length,"Message reference must be in range"),r[t]}));throw(n=new Error(i)).index=_Ge,n.description=i,n}function TUe(e){e.type===CGe&&MUe(e,XGe),e.type===AGe&&MUe(e,WGe),e.type===OGe&&MUe(e,VGe),e.type===MGe&&MUe(e,HGe),e.type===TGe&&MUe(e,qGe),MUe(e,UGe,e.value)}function EUe(e){var t=vUe();t.type===FGe&&t.value===e||TUe(t)}function AUe(e){return kGe.type===FGe&&kGe.value===e}function FUe(e){return kGe.type===TGe&&kGe.value===e}function OUe(){var e;return _Ge=kGe.start,(e=vUe()).type===OGe||e.type===AGe?(e.octal&&MUe(e,JGe),kUe(e)):wUe(e.value)}function RUe(){var e,t,n;return _Ge=kGe.start,(e=kGe).type===MGe?(n=OUe(),EUe(":"),CUe("init",n,zUe())):e.type!==CGe&&e.type!==FGe?(t=OUe(),EUe(":"),CUe("init",t,zUe())):void TUe(e)}var NUe={if:1};function DUe(){var e,t,n;if(AUe("("))return function(){var e;return EUe("("),e=jUe(),EUe(")"),e}();if(AUe("["))return function(){var e=[];for(_Ge=kGe.start,EUe("[");!AUe("]");)AUe(",")?(vUe(),e.push(null)):(e.push(zUe()),AUe("]")||EUe(","));return vUe(),function(e){var t=new bGe(RGe);return t.elements=e,t}(e)}();if(AUe("{"))return function(){var e,t,n=[],r={},i=String;for(_Ge=kGe.start,EUe("{");!AUe("}");)t="$"+((e=RUe()).key.type===BGe?e.key.name:i(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?MUe({},ZGe):r[t]=!0,n.push(e),AUe("}")||EUe(",");return EUe("}"),function(e){var t=new bGe(zGe);return t.properties=e,t}(n)}();if(e=kGe.type,_Ge=kGe.start,e===MGe||NUe[kGe.value])n=wUe(vUe().value);else if(e===OGe||e===AGe)kGe.octal&&MUe(kGe,JGe),n=kUe(vUe());else{if(e===TGe)throw new Error(eUe);e===SGe?((t=vUe()).value="true"===t.value,n=kUe(t)):e===EGe?((t=vUe()).value=null,n=kUe(t)):AUe("/")||AUe("/=")?(n=kUe(function(){var e,t,n,r;return kGe=null,dUe(),e=_Ge,t=function(){var e,t,n,r;for(rUe("/"===(e=xGe[_Ge]),"Regular expression literal must start with a slash"),t=xGe[_Ge++],n=!1,r=!1;_Ge<wGe;)if(t+=e=xGe[_Ge++],"\\"===e)uUe((e=xGe[_Ge++]).charCodeAt(0))&&MUe({},KGe),t+=e;else if(uUe(e.charCodeAt(0)))MUe({},KGe);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||MUe({},KGe),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";_Ge<wGe&&cUe((e=xGe[_Ge]).charCodeAt(0));)++_Ge,"\\"===e&&_Ge<wGe?MUe({},UGe,QGe):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&MUe({},YGe,n),{value:n,literal:t}}(),r=function(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111)return"x";MUe({},YGe)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(e){MUe({},YGe)}try{return new RegExp(e,t)}catch(e){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:_Ge}}()),xUe()):TUe(vUe())}return n}function IUe(){var e=[];if(EUe("("),!AUe(")"))for(;_Ge<wGe&&(e.push(zUe()),!AUe(")"));)EUe(",");return EUe(")"),e}function BUe(){var e;return EUe("["),e=jUe(),EUe("]"),e}function LUe(){var e=function(){var e,t,n,r,i;for(e=DUe();;)if(AUe("."))EUe("."),e=SUe(".",e,(i=void 0,_Ge=kGe.start,function(e){return e.type===MGe||e.type===TGe||e.type===SGe||e.type===EGe}(i=vUe())||TUe(i),wUe(i.value)));else if(AUe("("))t=e,n=IUe(),r=void 0,(r=new bGe(DGe)).callee=t,r.arguments=n,e=r;else{if(!AUe("["))break;e=SUe("[",e,BUe())}return e}();if(kGe.type===FGe&&(AUe("++")||AUe("--")))throw new Error(eUe);return e}function PUe(){var e,t;if(kGe.type!==FGe&&kGe.type!==TGe)t=LUe();else{if(AUe("++")||AUe("--"))throw new Error(eUe);if(AUe("+")||AUe("-")||AUe("~")||AUe("!"))e=vUe(),t=PUe(),t=function(e,t){var n=new bGe(GGe);return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(FUe("delete")||FUe("void")||FUe("typeof"))throw new Error(eUe);t=LUe()}}return t}function $Ue(e){var t=0;if(e.type!==FGe&&e.type!==TGe)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function zUe(){var e,t;return e=function(){var e,t,n,r,i,o,a,s,u,l;if(e=kGe,u=PUe(),0===(i=$Ue(r=kGe)))return u;for(r.prec=i,vUe(),t=[e,kGe],o=[u,r,a=PUe()];(i=$Ue(kGe))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,u=o.pop(),t.pop(),n=_Ue(s,u,a),o.push(n);(r=vUe()).prec=i,o.push(r),t.push(kGe),n=PUe(),o.push(n)}for(n=o[l=o.length-1],t.pop();l>1;)t.pop(),n=_Ue(o[l-1].value,o[l-2],n),l-=2;return n}(),AUe("?")&&(vUe(),t=zUe(),EUe(":"),e=function(e,t,n){var r=new bGe(IGe);return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,zUe())),e}function jUe(){var e=zUe();if(AUe(","))throw new Error(eUe);return e}function GUe(e,t,n){return e.fields=t||[],e.fname=n,e}function UUe(e){return 1===e.length?WUe(e[0]):VUe(e)}const WUe=e=>function(t){return t[e]},VUe=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function HUe(e){throw Error(e)}function qUe(e){const t=[];return"Identifier"===e.type?[e.name]:"Literal"===e.type?[e.value]:("MemberExpression"===e.type&&(t.push(...qUe(e.object)),t.push(...qUe(e.property))),t)}function XUe(e){return"MemberExpression"===e.object.type?XUe(e.object):"datum"===e.object.name}function YUe(e){const t=function(e){_Ge=0,wGe=(xGe=e).length,kGe=null,xUe();var t=jUe();if(kGe.type!==CGe)throw new Error("Unexpect token after expression.");return t}(e),n=new Set;return t.visit((e=>{"MemberExpression"===e.type&&XUe(e)&&n.add(qUe(e).slice(1).join("."))})),n}(function(e,t,n){const r=function(e){const t=[],n=e.length;let r,i,o,a=null,s=0,u="";function l(){t.push(u+e.substring(r,i)),u="",r=i+1}for(e+="",r=i=0;i<n;++i)if(o=e[i],"\\"===o)u+=e.substring(r,i++),r=i;else if(o===a)l(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&l(),s=r=i+1):"]"===o&&(s||HUe("Access path missing open bracket: "+e),s>0&&l(),s=0,r=i+1):i>r?l():r=i+1}return s&&HUe("Access path missing closing bracket: "+e),a&&HUe("Access path missing closing quote: "+e),i>r&&(i++,l()),t}(e);e=1===r.length?r[0]:e,GUe((n&&n.get||UUe)(r),[e],t||e)})("id"),GUe((e=>e),[],"identity"),GUe((()=>0),[],"zero"),GUe((()=>1),[],"one"),GUe((()=>!0),[],"true"),GUe((()=>!1),[],"false"),Array.isArray,Object.prototype.hasOwnProperty;class KUe extends Aje{constructor(e,t,n){super(e),this.model=t,this.filter=n,this.expr=QUe(this.model,this.filter,this),this._dependentFields=YUe(this.expr)}clone(){return new KUe(null,this.model,cRe(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function JUe(e,t,n,r="datum"){const i=[],o=FRe(t,(function(t){const o=ARe(t),a=e.getSelectionComponent(o,t),s=YOe(o+pGe);if(a.project.timeUnit){const t=null!=n?n:e.component.data.raw,r=a.project.timeUnit.clone();t.parent?r.insertAsParentOf(t):t.parent=r}return"none"!==a.empty&&i.push(s),`vlSelectionTest(${s}, ${r}`+("global"===a.resolve?")":`, ${YOe(a.resolve)})`)}));return(i.length?"!("+i.map((e=>`length(data(${e}))`)).join(" || ")+") || ":"")+`(${o})`}function ZUe(e,t){const n=t.encoding;let r=t.field;if(n||r){if(n&&!r){const i=e.project.items.filter((e=>e.channel===n));!i.length||i.length>1?(r=e.project.items[0].field,ZIe((i.length?"Multiple ":"No ")+`matching ${YOe(n)} encoding found for selection ${YOe(t.selection)}. `+`Using "field": ${YOe(r)}.`)):r=i[0].field}}else r=e.project.items[0].field,e.project.items.length>1&&ZIe(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${YOe(r)}.`);return`${e.name}[${YOe(r)}]`}function QUe(e,t,n){return FRe(t,(t=>XOe(t)?t:function(e){return null==e?void 0:e.selection}(t)?JUe(e,t.selection,n):ABe(t)))}function eWe(e,t,n,r){var i,o,a;e.encode=null!==(i=e.encode)&&void 0!==i?i:{},e.encode[t]=null!==(o=e.encode[t])&&void 0!==o?o:{},e.encode[t].update=null!==(a=e.encode[t].update)&&void 0!==a?a:{},e.encode[t].update[n]=r}function tWe(e,t,n,r={header:!1}){var i,o;const a=e.combine(),{disable:s,orient:u,scale:l,labelExpr:c,title:p,zindex:d}=a,h=JOe(a,["disable","orient","scale","labelExpr","title","zindex"]);if(!s){for(const e in h){const n=HRe[e],r=h[e];if(n&&n!==t&&"both"!==n)delete h[e];else if(WRe(r)){const{condition:t}=r,n=JOe(r,["condition"]),i=UOe(t),o=URe[e];if(o){const{vgProp:t,part:r}=o,a=[...i.map((e=>{const{test:t}=e,n=JOe(e,["test"]);return Object.assign({test:QUe(null,t)},n)})),n];eWe(h,r,t,a),delete h[e]}else if(null===o){const t={signal:i.map((e=>{const{test:t}=e,n=JOe(e,["test"]);return`${QUe(null,t)} ? ${RPe(n)} : `})).join("")+RPe(n)};h[e]=t}}else if(fBe(r)){const t=URe[e];if(t){const{vgProp:n,part:i}=t;eWe(h,i,n,r),delete h[e]}}}if("grid"===t){if(!h.grid)return;if(h.encode){const{grid:e}=h.encode;h.encode=Object.assign({},e?{grid:e}:{}),SRe(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:l,orient:u},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:$Re(d,0)})}{if(!r.header&&e.mainExtracted)return;if(void 0!==c){let e=c;(null===(o=null===(i=h.encode)||void 0===i?void 0:i.labels)||void 0===o?void 0:o.update)&&fBe(h.encode.labels.update.text)&&(e=BRe(c,"datum.label",h.encode.labels.update.text.signal)),eWe(h,"labels","text",{signal:e})}if(null===h.labelAlign&&delete h.labelAlign,h.encode){for(const t of VRe)e.hasAxisPart(t)||delete h.encode[t];SRe(h.encode)&&delete h.encode}const t=function(e,t){if(e)return LOe(e)&&!FPe(e)?e.map((e=>mPe(e,t))).join(", "):e}(p,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},t?{title:t}:{}),h),!1===n.aria?{aria:!1}:{}),{zindex:$Re(d,0)})}}}function nWe(e){const{axes:t}=e.component,n=[];for(const r of YDe)if(t[r])for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const t="x"===r?"height":"width",i=e.getSizeSignalRef(t).signal;t!==i&&n.push({name:t,update:i})}return n}const rWe={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},iWe={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},oWe=CRe(rWe),aWe=CRe(iWe);function sWe(e,t,n,r){return Object.assign.apply(null,[{},...e.map((e=>{if("axisOrient"===e){const e="x"===n?"bottom":"left",i=t["x"===n?"axisBottom":"axisLeft"]||{},o=t["x"===n?"axisTop":"axisRight"]||{},a=new Set([...CRe(i),...CRe(o)]),s={};for(const t of a.values())s[t]={signal:`${r.signal} === "${e}" ? ${NPe(i[t])} : ${NPe(o[t])}`};return s}return t[e]}))])}function uWe(e,t){var n;const r=[{}];for(const i of e){let e=null===(n=t[i])||void 0===n?void 0:n.style;if(e){e=UOe(e);for(const n of e)r.push(t.style[n])}}return Object.assign.apply(null,r)}function lWe(e,t,n,r={}){var i;const o=PPe(e,n,t.style);if(void 0!==o)return{configFrom:"style",configValue:o};for(const t of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==(null===(i=r[t])||void 0===i?void 0:i[e]))return{configFrom:t,configValue:r[t][e]};return{}}const cWe={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:r,formatType:i}=n;return ELe(e,e.type,r,i,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return ALe(r,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var r;return(!KLe(e)||!vIe(e.bin))&&(null!==(r=t.grid)&&void 0!==r?r:function(e,t){return!JBe(e)&&KLe(t)&&!bIe(null==t?void 0:t.bin)}(n,e))},gridScale:({model:e,channel:t})=>function(e,t){const n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||hWe(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||dWe(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var r;return null!==(r=e.labelFlush)&&void 0!==r?r:function(e,t){if("x"===t&&mRe(["quantitative","temporal"],e))return!0}(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var r;return null!==(r=e.labelOverlap)&&void 0!==r?r:function(e,t){if("nominal"!==e)return"log"!==t||"greedy"}(t.type,n)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{var o;const a="x"===e?"width":"y"===e?"height":void 0,s=a?t.getSizeSignalRef(a):void 0;return null!==(o=n.tickCount)&&void 0!==o?o:function({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!JBe(t)&&"log"!==t){if(KLe(e)){if(bIe(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&mRe(["month","hours","day","quarter"],null===(i=hBe(e.timeUnit))||void 0===i?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(void 0!==e.title)return e.title;const r=fWe(t,n);if(void 0!==r)return r;const i=t.typedFieldDef(n),o="x"===n?"x2":"y2",a=t.fieldDef(o);return zPe(i?[ULe(i)]:[],KLe(a)?[ULe(a)]:[])},values:({axis:e,fieldOrDatumDef:t})=>function(e,t){const n=e.values;return LOe(n)?TPe(t,n):fBe(n)?n:void 0}(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var r;return null!==(r=e.zindex)&&void 0!==r?r:function(e,t){return"rect"===e&&lPe(t)?1:0}(n,t)}};function pWe(e){return`(((${e.signal} % 360) + 360) % 360)`}function dWe(e,t,n,r){if(void 0!==e){if("x"===n){if(fBe(e)){const n=pWe(e);return{signal:`(45 < ${n} && ${n} < 135) || (225 < ${n} && ${n} < 315) ? "middle" :(${n} <= 45 || 315 <= ${n}) === ${fBe(t)?`(${t.signal} === "top")`:"top"===t} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(fBe(t)){const n=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${n} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==("top"===t)?"bottom":"top"}if(fBe(e)){const n=pWe(e);return{signal:`${n} <= 45 || 315 <= ${n} || (135 <= ${n} && ${n} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${n} && ${n} <= 135) === ${fBe(t)?`(${t.signal} === "left")`:"left"===t} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(fBe(t)){const n=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${n} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==("left"===t)?"top":"bottom"}}function hWe(e,t,n){if(void 0===e)return;const r="x"===n,i=r?0:90,o=r?"bottom":"left";if(fBe(e)){const n=pWe(e);return{signal:`(${i?"("+n+" + 90)":n} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${n} && ${n} < ${180+i}) === ${fBe(t)?`(${t.signal} === "${o}")`:t===o} ? "left" : "right"`}}if((e+i)%180==0)return r?null:"center";if(fBe(t)){const n=i<e&&e<180+i?"===":"!==";return{signal:`${t.signal} ${n} "${o}" ? "left" : "right"`}}return(i<e&&e<180+i)==(t===o)?"left":"right"}function fWe(e,t){const n="x"===t?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),o=r?r.title:void 0,a=i?i.title:void 0;return o&&a?jPe(o,a):o||a||(void 0!==o?o:void 0!==a?a:void 0)}class gWe extends Aje{constructor(e,t){super(e),this.transform=t,this._dependentFields=YUe(this.transform.calculate)}clone(){return new gWe(null,cRe(this.transform))}static parseAllForSortIndex(e,t){return t.forEachFieldDef(((t,n)=>{if(iPe(t)&&$Le(t.sort)){const{field:r,timeUnit:i}=t,o=t.sort,a=o.map(((e,t)=>`${ABe({field:r,timeUnit:i,equal:e})} ? ${t} : `)).join("")+o.length;e=new gWe(e,{calculate:a,as:mWe(t,n,{forAs:!0})})}})),e}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${fRe(this.transform)}`}}function mWe(e,t,n){return uPe(e,Object.assign({prefix:t,suffix:"sort_index"},null!=n?n:{}))}function yWe(e,t){return mRe(["top","bottom"],t)?"column":mRe(["left","right"],t)||"row"===e?"row":"column"}function bWe(e,t,n,r){const i="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return $Re(((null==t?void 0:t.header)||{})[e],i[e],n.header[e])}function vWe(e,t,n,r){const i={};for(const o of e){const e=bWe(o,t,n,r);void 0!==e&&(i[o]=e)}return i}const xWe=["row","column"],_We=["header","footer"];function wWe(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:a,titleOrient:s}=vWe(["titleAnchor","titleAngle","titleOrient"],i,r,t),u=yWe(t,s),l=jRe(a);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===t?{orient:"left"}:{}),{style:"guide-title"}),SWe(l,u)),kWe(u,l,o)),OWe(r,i,t,oWe,rWe))}}function kWe(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=hWe(t,"row"===e?"left":"top","row"===e?"y":"x");return r?{align:r}:{}}function SWe(e,t){const n=dWe(e,"row"===t?"left":"top","row"===t?"y":"x",!0);return n?{baseline:n}:{}}function CWe(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of _We)if(n[i])for(const o of n[i]){const a=EWe(e,t,i,n,o);null!=a&&r.push(a)}return r}function MWe(e,t){var n;const{sort:r}=e;return PLe(r)?{field:uPe(r,{expr:"datum"}),order:null!==(n=r.order)&&void 0!==n?n:"ascending"}:LOe(r)?{field:mWe(e,t,{expr:"datum"}),order:"ascending"}:{field:uPe(e,{expr:"datum"}),order:null!=r?r:"ascending"}}function TWe(e,t,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:a,labelOrient:s,labelExpr:u}=vWe(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),l=CLe({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=yWe(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?BRe(BRe(u,"datum.label",l),"datum.value",uPe(e,{expr:"parent"})):l}},"row"===t?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),SWe(o,c)),kWe(c,o,a)),OWe(n,e,t,aWe,iWe))}function EWe(e,t,n,r,i){if(i){let o=null;const{facetFieldDef:a}=r,s=e.config?e.config:void 0;if(a&&i.labels){const{labelOrient:e}=vWe(["labelOrient"],a,s,t);("row"===t&&!mRe(["top","bottom"],e)||"column"===t&&!mRe(["left","right"],e))&&(o=TWe(a,t,s))}const u=kHe(e)&&!zLe(e.facet),l=i.axes,c=(null==l?void 0:l.length)>0;if(o||c){const s="row"===t?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:MWe(a,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),o?{title:o}:{}),i.sizeSignal?{encode:{update:{[s]:i.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const AWe={column:{start:0,end:1},row:{start:1,end:0}};function FWe(e,t){return AWe[t][e]}function OWe(e,t,n,r,i){const o={};for(const a of r){if(!i[a])continue;const r=bWe(a,t,e,n);void 0!==r&&(o[i[a]]=r)}return o}function RWe(e){return[...NWe(e,"width"),...NWe(e,"height"),...NWe(e,"childWidth"),...NWe(e,"childHeight")]}function NWe(e,t){const n="width"===t?"x":"y",r=e.component.layoutSize.get(t);if(!r||"merged"===r)return[];const i=e.getSizeSignalRef(t).signal;if("step"===r){const t=e.getScaleComponent(n);if(t){const r=t.get("type"),o=t.get("range");if(JBe(r)&&gBe(o)){const r=e.scaleName(n);return kHe(e.parent)&&"independent"===e.parent.component.resolve.scale[n]?[DWe(r,o)]:[DWe(r,o),{name:i,update:IWe(r,t,`domain('${r}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){const t=i.endsWith("width"),n=t?"containerSize()[0]":"containerSize()[1]",r=`isFinite(${n}) ? ${n} : ${N$e(e.config.view,t?"width":"height")}`;return[{name:i,init:r,on:[{update:r,events:"window:resize"}]}]}return[{name:i,value:r}]}function DWe(e,t){return{name:e+"_step",value:t.step}}function IWe(e,t,n){const r=t.get("type"),i=t.get("padding"),o=$Re(t.get("paddingOuter"),i);let a=t.get("paddingInner");return a="band"===r?void 0!==a?a:i:1,`bandspace(${n}, ${a}, ${o}) * ${e}_step`}function BWe(e){return"childWidth"===e?"width":"childHeight"===e?"height":e}function LWe(e,t){return CRe(e).reduce(((n,r)=>{const i=e[r];return Object.assign(Object.assign({},n),eje(t,i,r,(e=>fBe(e)?e:{value:e.value})))}),{})}function PWe(e,t){if(CHe(t)||kHe(t))return"shared";if(SHe(t))return KDe(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function $We(e,t){const n=e.scale[t],r=KDe(t)?"axis":"legend";return"independent"===n?("shared"===e[r][t]&&ZIe(function(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}(t)),"independent"):e[r][t]||"shared"}const zWe=Object.assign(Object.assign({},w$e),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),jWe=CRe(zWe);class GWe extends xze{}const UWe={symbols:function(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:o}){var a,s,u,l,c;if("symbol"!==o)return;const{markDef:p,encoding:d,config:h,mark:f}=n,g=p.filled&&"trail"!==f;let m=Object.assign(Object.assign({},function(e,t,n){for(const r of n){const n=BPe(r,t.markDef,t.config);void 0!==n&&(e[r]=OPe(n))}return e}({},n,gNe)),sje(n,{filled:g}));const y=null!==(a=WWe(d.opacity))&&void 0!==a?a:p.opacity;if(m.fill)if("fill"===r||g&&r===WNe)delete m.fill;else if(m.fill.field)i.get("symbolFillColor")?delete m.fill:(m.fill=OPe(null!==(s=h.legend.symbolBaseFillColor)&&void 0!==s?s:"black"),m.fillOpacity=OPe(null!=y?y:1));else if(LOe(m.fill)){const e=null!==(c=null!==(l=VWe(null!==(u=d.fill)&&void 0!==u?u:d.color))&&void 0!==l?l:p.fill)&&void 0!==c?c:g&&p.color;e&&(m.fill=OPe(e))}if(m.stroke)if("stroke"===r||!g&&r===WNe)delete m.stroke;else if(m.stroke.field)delete m.stroke;else if(LOe(m.stroke)){const e=$Re(VWe(d.stroke||d.color),p.stroke,g?p.color:void 0);e&&(m.stroke={value:e})}if(r!==KNe){const e=KLe(t)&&qWe(0,i,t);e?m.opacity=[Object.assign({test:e},OPe(null!=y?y:1)),OPe(h.legend.unselectedOpacity)]:y&&(m.opacity=OPe(y))}return m=Object.assign(Object.assign({},m),e),SRe(m)?void 0:m},gradient:function(e,{model:t,legendType:n}){if("gradient"!==n)return;let r={};const i=WWe(t.encoding.opacity)||t.markDef.opacity;return i&&(r.opacity=OPe(i)),r=Object.assign(Object.assign({},r),e),SRe(r)?void 0:r},labels:function(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const o=n.legend(r)||{},a=n.config,s=KLe(t)?qWe(0,i,t):void 0,u=s?[{test:s,value:1},{value:a.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=o,p=wLe(c)?TLe({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:a}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),p?{text:p}:{}),e);return SRe(d)?void 0:d},entries:function(e,{legendCmpt:t}){const n=t.get("selections");return(null==n?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}};function WWe(e){return HWe(e,((e,t)=>Math.max(e,t.value)))}function VWe(e){return HWe(e,((e,t)=>$Re(e,t.value)))}function HWe(e,t){return function(e){const t=e&&e.condition;return!!t&&(LOe(t)||rPe(t))}(e)?UOe(e.condition).reduce(t,e.value):rPe(e)?e.value:void 0}function qWe(e,t,n){const r=t.get("selections");if(!(null==r?void 0:r.length))return;const i=YOe(n.field);return r.map((e=>`(!length(data(${YOe(ARe(e)+pGe)})) || (${e}[${i}] && indexof(${e}[${i}], datum.value) >= 0))`)).join(" || ")}const XWe={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return ELe(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return ALe(r,t,n)},gradientLength:e=>{var t,n;const{legend:r,legendConfig:i}=e;return null!==(n=null!==(t=r.gradientLength)&&void 0!==t?t:i.gradientLength)&&void 0!==n?n:function({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:a,gradientVerticalMaxLength:s,gradientVerticalMinLength:u}=e;if(QBe(i))return"horizontal"===n?"top"===r||"bottom"===r?KWe(t,"width",a,o):a:KWe(t,"height",u,s)}(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var r,i;return null!==(i=null!==(r=e.labelOverlap)&&void 0!==r?r:t.labelOverlap)&&void 0!==i?i:function(e){if(mRe(["quantile","threshold","log"],e))return"greedy"}(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>{var i;return null!==(i=e.symbolType)&&void 0!==i?i:function(e,t,n,r){var i;if("shape"!==t){const e=null!==(i=VWe(n))&&void 0!==i?i:r;if(e)return e}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(t.type,n,r.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>fPe(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(fDe(n)&&QBe(t)){if("gradient"===e)return}else if("symbol"===e)return;return e},values:({fieldOrDatumDef:e,legend:t})=>function(e,t){const n=e.values;return LOe(n)?TPe(t,n):fBe(n)?n:void 0}(t,e)};function YWe({legendConfig:e,legendType:t,orient:n,legend:r}){var i,o;return null!==(o=null!==(i=r.direction)&&void 0!==i?i:e[t?"gradientDirection":"symbolDirection"])&&void 0!==o?o:function(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0}}(n,t)}function KWe(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function JWe(e){const t=wHe(e)?function(e){const{encoding:t}=e,n={};for(const r of[WNe,...x$e]){const i=vPe(t[r]);i&&e.getScaleComponent(r)&&(r===qNe&&KLe(i)&&i.type===LBe||(n[r]=QWe(e,r)))}return n}(e):function(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){JWe(r);for(const i of CRe(r.component.legends))n.legend[i]=$We(e.component.resolve,i),"shared"===n.legend[i]&&(t[i]=eVe(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of CRe(t))for(const t of e.children)t.component.legends[r]&&"shared"===n.legend[r]&&delete t.component.legends[r];return t}(e);return e.component.legends=t,t}function ZWe(e,t,n,r){switch(t){case"disable":return void 0!==n;case"values":return!!(null==n?void 0:n.values);case"title":if("title"===t&&e===(null==r?void 0:r.title))return!0}return e===(n||{})[t]}function QWe(e,t){var n,r,i;let o=e.legend(t);const{markDef:a,encoding:s,config:u}=e,l=u.legend,c=new GWe({},function(e,t){const n=e.scaleName(t);if("trail"===e.mark){if("color"===t)return{stroke:n};if("size"===t)return{strokeWidth:n}}return"color"===t?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}(e,t));!function(e,t,n){var r;const i=null===(r=e.fieldDef(t))||void 0===r?void 0:r.field;gGe(e,(e=>{var r,o;const a=null!==(r=e.project.hasField[i])&&void 0!==r?r:e.project.hasChannel[t];if(a&&Wje.has(e)){const t=null!==(o=n.get("selections"))&&void 0!==o?o:[];t.push(e.name),n.set("selections",t,!1),a.hasLegend=!0}}))}(e,t,c);const p=void 0!==o?!o:l.disable;if(c.set("disable",p,void 0!==o),p)return c;o=o||{};const d=e.getScaleComponent(t).get("type"),h=vPe(s[t]),f=KLe(h)?null===(n=hBe(h.timeUnit))||void 0===n?void 0:n.unit:void 0,g=o.orient||u.legend.orient||"right",m=function(e){const{legend:t}=e;return $Re(t.type,function({channel:e,timeUnit:t,scaleType:n}){if(fDe(e)){if(mRe(["quarter","month","day"],t))return"symbol";if(QBe(n))return"gradient"}return"symbol"}(e))}({legend:o,channel:t,timeUnit:f,scaleType:d}),y={legend:o,channel:t,model:e,markDef:a,encoding:s,fieldOrDatumDef:h,legendConfig:l,config:u,scaleType:d,orient:g,legendType:m,direction:YWe({legend:o,legendType:m,orient:g,legendConfig:l})};for(const n of jWe){const r=n in XWe?XWe[n](y):o[n];if(void 0!==r){const i=ZWe(r,n,o,e.fieldDef(t));(i||void 0===u.legend[n])&&c.set(n,r,i)}}const b=null!==(r=null==o?void 0:o.encoding)&&void 0!==r?r:{},v=c.get("selections"),x={},_={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const t of["labels","legend","title","symbols","gradient","entries"]){const n=LWe(null!==(i=b[t])&&void 0!==i?i:{},e),r=t in UWe?UWe[t](n,_):n;void 0===r||SRe(r)||(x[t]=Object.assign(Object.assign(Object.assign({},(null==v?void 0:v.length)&&KLe(h)?{name:`${ARe(h.field)}_legend_${t}`}:{}),(null==v?void 0:v.length)?{interactive:!!v}:{}),{update:r}))}return SRe(x)||c.set("encode",x,!!(null==o?void 0:o.encoding)),c}function eVe(e,t){var n,r,i,o;if(!e)return t.clone();const a=e.getWithExplicit("orient"),s=t.getWithExplicit("orient");if(a.explicit&&s.explicit&&a.value!==s.value)return;let u=!1;for(const n of jWe){const r=Cze(e.getWithExplicit(n),t.getWithExplicit(n),n,"legend",((e,t)=>{switch(n){case"symbolType":return r=e,"circle"===(i=t).value?i:r;case"title":return GPe(e,t);case"type":return u=!0,wze("symbol")}var r,i;return Sze(e,t,n,"legend")}));e.setWithExplicit(n,r)}return u&&((null===(r=null===(n=e.implicit)||void 0===n?void 0:n.encode)||void 0===r?void 0:r.gradient)&&ORe(e.implicit,["encode","gradient"]),(null===(o=null===(i=e.explicit)||void 0===i?void 0:i.encode)||void 0===o?void 0:o.gradient)&&ORe(e.explicit,["encode","gradient"])),e}function tVe(e,t,n,r){var i,o,a;e.encode=null!==(i=e.encode)&&void 0!==i?i:{},e.encode[t]=null!==(o=e.encode[t])&&void 0!==o?o:{},e.encode[t].update=null!==(a=e.encode[t].update)&&void 0!==a?a:{},e.encode[t].update[n]=r}function nVe(e){const t=e.component.legends,n={};for(const r of CRe(t)){const i=e.getScaleComponent(r),o=hRe(i.get("domains"));if(n[o])for(const e of n[o])eVe(e,t[r])||n[o].push(t[r]);else n[o]=[t[r].clone()]}const r=MRe(n).flat().map((t=>function(e,t){var n,r,i;const o=e.combine(),{disable:a,labelExpr:s,selections:u}=o,l=JOe(o,["disable","labelExpr","selections"]);if(!a){if(!1===t.aria&&null==l.aria&&(l.aria=!1),null===(n=l.encode)||void 0===n?void 0:n.symbols){const e=l.encode.symbols.update;!e.fill||"transparent"===e.fill.value||e.stroke||l.stroke||(e.stroke={value:"transparent"});for(const t of x$e)l[t]&&delete e[t]}if(l.title||delete l.title,void 0!==s){let e=s;(null===(i=null===(r=l.encode)||void 0===r?void 0:r.labels)||void 0===i?void 0:i.update)&&fBe(l.encode.labels.update.text)&&(e=BRe(s,"datum.label",l.encode.labels.update.text.signal)),tVe(l,"labels","text",{signal:e})}for(const e in l){const t=l[e];if(fBe(t)){const n=_$e[e];if(n){const{vgProp:r,part:i}=n;tVe(l,i,r,t),delete l[e]}}}return l}}(t,e.config))).filter((e=>void 0!==e));return r}function rVe(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map((e=>e.signal)).join(", ")}]`},o=t.data.reduce(((t,n)=>{const r=fBe(n)?n.signal:`data('${e.lookupDataSource(n)}')`;return mRe(t,r)||t.push(r),t}),[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]}},n)]}return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const iVe=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class oVe extends xze{constructor(e,t,n,r){super(Object.assign({},t),{name:e}),this.specifiedProjection=t,this.size=n,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function aVe(e){e.component.projection=wHe(e)?function(e){var t;if(e.hasProjection){const n=e.specifiedProjection,r=!(n&&(null!=n.scale||null!=n.translate)),i=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,o=r?function(e){const t=[],{encoding:n}=e;for(const r of[[jNe,zNe],[UNe,GNe]])(vPe(n[r[0]])||vPe(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(qNe)&&e.typedFieldDef(qNe).type===LBe&&t.push({signal:e.getName(`geojson_${t.length}`)}),0===t.length&&t.push(e.requestDataName(Dze)),t}(e):void 0;return new oVe(e.projectionName(!0),Object.assign(Object.assign({},null!==(t=e.config.projection)&&void 0!==t?t:{}),null!=n?n:{}),i,o)}}(e):function(e){if(0===e.children.length)return;let t;for(const t of e.children)aVe(t);const n=bRe(e.children,(e=>{const n=e.component.projection;if(n){if(t){const e=function(e,t){const n=bRe(iVe,(n=>!VOe(e.explicit,n)&&!VOe(t.explicit,n)||!(!VOe(e.explicit,n)||!VOe(t.explicit,n)||hRe(e.get(n))!==hRe(t.get(n)))));if(hRe(e.size)===hRe(t.size)){if(n)return e;if(hRe(e.explicit)===hRe({}))return t;if(hRe(t.explicit)===hRe({}))return e}return null}(t,n);return e&&(t=e),!!e}return t=n,!0}return!0}));if(t&&n){const n=e.projectionName(!0),r=new oVe(n,t.specifiedProjection,t.size,cRe(t.data));for(const t of e.children){const e=t.component.projection;e&&(e.isFit&&r.data.push(...t.component.projection.data),t.renameProjection(e.get("name"),n),e.merged=!0)}return r}}(e)}function sVe(e,t){return`${yIe(e)}_${t}`}function uVe(e,t,n){var r;const i=sVe(null!==(r=kPe(n,void 0))&&void 0!==r?r:{},t);return e.getName(`${i}_bins`)}function lVe(e,t,n){let r,i;r=function(e){return"as"in e}(e)?XOe(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:[uPe(e,{forAs:!0}),uPe(e,{binSuffix:"end",forAs:!0})];const o=Object.assign({},kPe(t,void 0)),a=sVe(o,e.field),{signal:s,extentSignal:u}=function(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}(n,a);if(_Ie(o.extent)){const e=o.extent,t=e.selection;i=ZUe(n.getSelectionComponent(ARe(t),t),e),delete o.extent}return{key:a,binComponent:Object.assign(Object.assign(Object.assign({bin:o,field:e.field,as:[r]},s?{signal:s}:{}),u?{extentSignal:u}:{}),i?{span:i}:{})}}class cVe extends Aje{constructor(e,t){super(e),this.bins=t}clone(){return new cVe(null,cRe(this.bins))}static makeFromEncoding(e,t){const n=t.reduceFieldDef(((e,n,r)=>{if(nPe(n)&&bIe(n.bin)){const{key:i,binComponent:o}=lVe(n,n.bin,t);e[i]=Object.assign(Object.assign(Object.assign({},o),e[i]),function(e,t,n,r){var i,o;if(EPe(t,n)){const a=wHe(e)&&null!==(o=null!==(i=e.axis(n))&&void 0!==i?i:e.legend(n))&&void 0!==o?o:{},s=uPe(t,{expr:"datum"}),u=uPe(t,{expr:"datum",binSuffix:"end"});return{formulaAs:uPe(t,{binSuffix:"range",forAs:!0}),formula:NLe(s,u,a.format,a.formatType,r)}}return{}}(t,n,r,t.config))}return e}),{});return SRe(n)?null:new cVe(e,n)}static makeFromTransform(e,t,n){const{key:r,binComponent:i}=lVe(t,t.bin,n);return new cVe(e,{[r]:i})}merge(e,t){for(const n of CRe(e.bins))n in this.bins?(t(e.bins[n].signal,this.bins[n].signal),this.bins[n].as=xRe([...this.bins[n].as,...e.bins[n].as],fRe)):this.bins[n]=e.bins[n];for(const t of e.children)e.removeChild(t),t.parent=this;e.remove()}producedFields(){return new Set(MRe(this.bins).map((e=>e.as)).flat(2))}dependentFields(){return new Set(MRe(this.bins).map((e=>e.field)))}hash(){return`Bin ${fRe(this.bins)}`}assemble(){return MRe(this.bins).flatMap((e=>{const t=[],[n,...r]=e.as,i=e.bin,{extent:o}=i,a=JOe(i,["extent"]),s=Object.assign(Object.assign(Object.assign({type:"bin",field:IRe(e.field),as:n,signal:e.signal},_Ie(o)?{extent:null}:{extent:o}),e.span?{span:{signal:`span(${e.span})`}}:{}),a);!o&&e.extentSignal&&(t.push({type:"extent",field:IRe(e.field),signal:e.extentSignal}),s.extent={signal:e.extentSignal}),t.push(s);for(const e of r)for(let r=0;r<2;r++)t.push({type:"formula",expr:uPe({field:n[r]},{expr:"datum"}),as:e[r]});return e.formula&&t.push({type:"formula",expr:e.formula,as:e.formulaAs}),t}))}}class pVe extends Aje{constructor(e){let t;if(super(null),Fze(e=null!=e?e:{name:"source"})||(t=e.format?Object.assign({},dRe(e.format,["parse"])):{}),Eze(e))this._data={values:e.values};else if(Tze(e)){if(this._data={url:e.url},!t.type){let n=/(?:\.([^.]+))?$/.exec(e.url)[1];mRe(["json","csv","tsv","dsv","topojson"],n)||(n="json"),t.type=n}}else Rze(e)?this._data={values:[{type:"Sphere"}]}:(Aze(e)||Fze(e))&&(this._data={});this._generator=Fze(e),e.name&&(this._name=e.name),t&&!SRe(t)&&(this._data.format=t)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(e){this._name=e}set parent(e){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function dVe(e){for(const t of e){for(const e of t.children)if(e.parent!==t)return console.error("Dataflow graph is inconsistent.",t,e),!1;if(!dVe(t.children))return!1}return!0}class hVe extends Aje{constructor(e,t){super(e),this.params=t}clone(){return new hVe(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${fRe(this.params)}`}assemble(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}class fVe extends Aje{constructor(e,t){super(e),this.params=t}clone(){return new fVe(null,this.params)}dependentFields(){return new Set}producedFields(){var e;return new Set([null!==(e=this.params.as)&&void 0!==e?e:"data"])}hash(){return`Hash ${fRe(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}function gVe(e){return e instanceof pVe||e instanceof hVe||e instanceof fVe}class mVe{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class yVe extends mVe{constructor(){super(),this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:e,mutatedFlag:t}){e&&this.setContinue(),t&&this.setMutated()}reset(){}optimizeNextFromLeaves(e){if(gVe(e))return!1;const t=e.parent,{continueFlag:n}=this.run(e);return n&&this.optimizeNextFromLeaves(t),this.mutatedFlag}}class bVe extends mVe{}class vVe extends Aje{constructor(e,t,n){super(e),this.dimensions=t,this.measures=n}clone(){return new vVe(null,new Set(this.dimensions),cRe(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(e,t){let n=!1;t.forEachFieldDef((e=>{e.aggregate&&(n=!0)}));const r={},i=new Set;return n?(t.forEachFieldDef(((e,n)=>{var o,a,s,u;const{aggregate:l,field:c}=e;if(l)if("count"===l)r["*"]=null!==(o=r["*"])&&void 0!==o?o:{},r["*"].count=new Set([uPe(e,{forAs:!0})]);else{if(wNe(l)||kNe(l)){const e=wNe(l)?"argmin":"argmax",t=l[e];r[t]=null!==(a=r[t])&&void 0!==a?a:{},r[t][e]=new Set([uPe({op:e,field:t},{forAs:!0})])}else r[c]=null!==(s=r[c])&&void 0!==s?s:{},r[c][l]=new Set([uPe(e,{forAs:!0})]);dIe(n)&&"unaggregated"===t.scaleDomain(n)&&(r[c]=null!==(u=r[c])&&void 0!==u?u:{},r[c].min=new Set([uPe({field:c,aggregate:"min"},{forAs:!0})]),r[c].max=new Set([uPe({field:c,aggregate:"max"},{forAs:!0})]))}else!function(e,t,n,r){const i=wHe(r)?r.encoding[RDe(t)]:void 0;if(nPe(n)&&wHe(r)&&HLe(t,n,i,r.stack,r.markDef,r.config))e.add(uPe(n,{})),e.add(uPe(n,{suffix:"end"})),n.bin&&EPe(n,t)&&e.add(uPe(n,{binSuffix:"range"}));else if(t in pDe){const n=function(e){switch(e){case zNe:return"y";case GNe:return"y2";case jNe:return"x";case UNe:return"x2"}}(t);e.add(r.getName(n))}else e.add(uPe(n))}(i,n,e,t)})),i.size+CRe(r).length===0?null:new vVe(e,i,r)):null}static makeFromTransform(e,t){var n,r,i;const o=new Set,a={};for(const e of t.aggregate){const{op:t,field:i,as:o}=e;t&&("count"===t?(a["*"]=null!==(n=a["*"])&&void 0!==n?n:{},a["*"].count=new Set([o||uPe(e,{forAs:!0})])):(a[i]=null!==(r=a[i])&&void 0!==r?r:{},a[i][t]=new Set([o||uPe(e,{forAs:!0})])))}for(const e of null!==(i=t.groupby)&&void 0!==i?i:[])o.add(e);return o.size+CRe(a).length===0?null:new vVe(e,o,a)}merge(e){return function(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}(this.dimensions,e.dimensions)?(function(e,t){var n;for(const r of CRe(t)){const i=t[r];for(const t of CRe(i))r in e?e[r][t]=new Set([...null!==(n=e[r][t])&&void 0!==n?n:[],...i[t]]):e[r]={[t]:i[t]}}}(this.measures,e.measures),!0):(function(...e){JIe.debug(...e)}("different dimensions, cannot merge"),!1)}addDimensions(e){e.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...CRe(this.measures)])}producedFields(){const e=new Set;for(const t of CRe(this.measures))for(const n of CRe(this.measures[t])){const r=this.measures[t][n];0===r.size?e.add(`${n}_${t}`):r.forEach(e.add,e)}return e}hash(){return`Aggregate ${fRe({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const e=[],t=[],n=[];for(const r of CRe(this.measures))for(const i of CRe(this.measures[r]))for(const o of this.measures[r][i])n.push(o),e.push(i),t.push("*"===r?null:IRe(r));return{type:"aggregate",groupby:[...this.dimensions].map(IRe),ops:e,fields:t,as:n}}}class xVe extends Aje{constructor(e,t,n,r){super(e),this.model=t,this.name=n,this.data=r;for(const e of mDe){const n=t.facet[e];if(n){const{bin:r,sort:i}=n;this[e]=Object.assign({name:t.getName(`${e}_domain`),fields:[uPe(n),...bIe(r)?[uPe(n,{binSuffix:"end"})]:[]]},PLe(i)?{sortField:i}:LOe(i)?{sortIndexField:mWe(n,e)}:{})}}this.childModel=t.child}hash(){let e="Facet";for(const t of mDe)this[t]&&(e+=` ${t.charAt(0)}:${fRe(this[t])}`);return e}get fields(){var e;const t=[];for(const n of mDe)(null===(e=this[n])||void 0===e?void 0:e.fields)&&t.push(...this[n].fields);return t}dependentFields(){const e=new Set(this.fields);for(const t of mDe)this[t]&&(this[t].sortField&&e.add(this[t].sortField.field),this[t].sortIndexField&&e.add(this[t].sortIndexField));return e}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const e={};for(const t of YDe){const n=this.childModel.component.scales[t];if(n&&!n.merged){const r=n.get("type"),i=n.get("range");if(JBe(r)&&gBe(i)){const n=nHe(rHe(this.childModel,t));n?e[t]=n:ZIe(`Unknown field for ${t}. Cannot calculate view size.`)}}}return e}assembleRowColumnHeaderData(e,t,n){const r={row:"y",column:"x"}[e],i=[],o=[],a=[];n&&n[r]&&(t?(i.push(`distinct_${n[r]}`),o.push("max")):(i.push(n[r]),o.push("distinct")),a.push(`distinct_${n[r]}`));const{sortField:s,sortIndexField:u}=this[e];if(s){const{op:e=DLe,field:t}=s;i.push(t),o.push(e),a.push(uPe(s,{forAs:!0}))}else u&&(i.push(u),o.push("max"),a.push(u));return{name:this[e].name,source:null!=t?t:this.data,transform:[Object.assign({type:"aggregate",groupby:this[e].fields},i.length?{fields:i,ops:o,as:a}:{})]}}assembleFacetHeaderData(e){var t,n;const{columns:r}=this.model.layout,{layoutHeaders:i}=this.model.component,o=[],a={};for(const e of xWe){for(const r of _We){const o=null!==(t=i[e]&&i[e][r])&&void 0!==t?t:[];for(const t of o)if((null===(n=t.axes)||void 0===n?void 0:n.length)>0){a[e]=!0;break}}if(a[e]){const t=`length(data("${this.facet.name}"))`,n="row"===e?r?{signal:`ceil(${t} / ${r})`}:1:r?{signal:`min(${t}, ${r})`}:{signal:t};o.push({name:`${this.facet.name}_${e}`,transform:[{type:"sequence",start:0,stop:n}]})}}const{row:s,column:u}=a;return(s||u)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,e)),o}assemble(){var e,t;const n=[];let r=null;const i=this.getChildIndependentFieldsWithStep(),{column:o,row:a,facet:s}=this;if(o&&a&&(i.x||i.y)){r=`cross_${this.column.name}_${this.row.name}`;const o=[].concat(null!==(e=i.x)&&void 0!==e?e:[],null!==(t=i.y)&&void 0!==t?t:[]),a=o.map((()=>"distinct"));n.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:o,ops:a}]})}for(const e of[FNe,ANe])this[e]&&n.push(this.assembleRowColumnHeaderData(e,r,i));if(s){const e=this.assembleFacetHeaderData(i);e&&n.push(...e)}return n}}function _Ve(e){return"'"===e[0]&&"'"===e[e.length-1]||'"'===e[0]&&'"'===e[e.length-1]?e.slice(1,-1):e}function wVe(e){const t={};return sRe(e.filter,(e=>{var n;if(TBe(e)){let r=null;xBe(e)?r=e.equal:CBe(e)?r=e.range[0]:MBe(e)&&(r=(null!==(n=e.oneOf)&&void 0!==n?n:e.in)[0]),r&&(QIe(r)?t[e.field]="date":qOe(r)?t[e.field]="number":XOe(r)&&(t[e.field]="string")),e.timeUnit&&(t[e.field]="date")}})),t}class kVe extends Aje{constructor(e,t){super(e),this._parse=t}clone(){return new kVe(null,cRe(this._parse))}hash(){return`Parse ${fRe(this._parse)}`}static makeExplicit(e,t,n){let r={};const i=t.data;return!Fze(i)&&i&&i.format&&i.format.parse&&(r=i.format.parse),this.makeWithAncestors(e,r,{},n)}static makeWithAncestors(e,t,n,r){for(const e of CRe(n)){const t=r.getWithExplicit(e);void 0!==t.value&&(t.explicit||t.value===n[e]||"derived"===t.value||"flatten"===n[e]?delete n[e]:ZIe(RIe(e,n[e],t.value)))}for(const e of CRe(t)){const n=r.get(e);void 0!==n&&(n===t[e]?delete t[e]:ZIe(RIe(e,t[e],n)))}const i=new xze(t,n);r.copyAll(i);const o={};for(const e of CRe(i.combine())){const t=i.get(e);null!==t&&(o[e]=t)}return 0===CRe(o).length||r.parseNothing?null:new kVe(e,o)}get parse(){return this._parse}merge(e){this._parse=Object.assign(Object.assign({},this._parse),e.parse),e.remove()}assembleFormatParse(){const e={};for(const t of CRe(this._parse)){const n=this._parse[t];1===PRe(t)&&(e[t]=n)}return e}producedFields(){return new Set(CRe(this._parse))}dependentFields(){return new Set(CRe(this._parse))}assembleTransforms(e=!1){return CRe(this._parse).filter((t=>!e||PRe(t)>1)).map((e=>{const t=function(e,t){const n=NRe(e);return"number"===t?`toNumber(${n})`:"boolean"===t?`toBoolean(${n})`:"string"===t?`toString(${n})`:"date"===t?`toDate(${n})`:"flatten"===t?n:0===t.indexOf("date:")?`timeParse(${n},'${_Ve(t.slice(5,t.length))}')`:0===t.indexOf("utc:")?`utcParse(${n},'${_Ve(t.slice(4,t.length))}')`:(ZIe(`Unrecognized parse "${t}".`),null)}(e,this._parse[e]);return t?{type:"formula",expr:t,as:LRe(e)}:null})).filter((e=>null!==e))}}class SVe extends Aje{clone(){return new SVe(null)}constructor(e){super(e)}dependentFields(){return new Set}producedFields(){return new Set([k$e])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:k$e}}}class CVe extends Aje{constructor(e,t){super(e),this.transform=t}clone(){return new CVe(null,cRe(this.transform))}addDimensions(e){this.transform.groupby=xRe(this.transform.groupby.concat(e),(e=>e))}dependentFields(){const e=new Set;return this.transform.groupby&&this.transform.groupby.forEach(e.add,e),this.transform.joinaggregate.map((e=>e.field)).filter((e=>void 0!==e)).forEach(e.add,e),e}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(e){var t;return null!==(t=e.as)&&void 0!==t?t:uPe(e)}hash(){return`JoinAggregateTransform ${fRe(this.transform)}`}assemble(){const e=[],t=[],n=[];for(const r of this.transform.joinaggregate)t.push(r.op),n.push(this.getDefaultName(r)),e.push(void 0===r.field?null:r.field);const r=this.transform.groupby;return Object.assign({type:"joinaggregate",as:n,ops:t,fields:e},void 0!==r?{groupby:r}:{})}}class MVe extends Aje{constructor(e,t){super(e),this._stack=t}clone(){return new MVe(null,cRe(this._stack))}static makeFromTransform(e,t){const{stack:n,groupby:r,as:i,offset:o="zero"}=t,a=[],s=[];if(void 0!==t.sort)for(const e of t.sort)a.push(e.field),s.push($Re(e.order,"ascending"));const u={field:a,order:s};let l;return l=function(e){return LOe(e)&&e.every((e=>XOe(e)))&&e.length>1}(i)?i:XOe(i)?[i,i+"_end"]:[t.stack+"_start",t.stack+"_end"],new MVe(e,{stackField:n,groupby:r,offset:o,sort:u,facetby:[],as:l})}static makeFromEncoding(e,t){const n=t.stack,{encoding:r}=t;if(!n)return null;const{groupbyChannel:i,fieldChannel:o,offset:a,impute:s}=n;let u;i&&(u=bPe(r[i]));const l=function(e){return e.stack.stackBy.reduce(((e,t)=>{const n=uPe(t.fieldDef);return n&&e.push(n),e}),[])}(t),c=t.encoding.order;let p;return p=LOe(c)||KLe(c)?$Pe(c):l.reduce(((e,t)=>(e.field.push(t),e.order.push("y"===o?"descending":"ascending"),e)),{field:[],order:[]}),new MVe(e,{dimensionFieldDef:u,stackField:t.vgField(o),facetby:[],stackby:l,sort:p,offset:a,impute:s,as:[t.vgField(o,{suffix:"start",forAs:!0}),t.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(e){this._stack.facetby.push(...e)}dependentFields(){const e=new Set;return e.add(this._stack.stackField),this.getGroupbyFields().forEach(e.add,e),this._stack.facetby.forEach(e.add,e),this._stack.sort.field.forEach(e.add,e),e}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${fRe(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:e,impute:t,groupby:n}=this._stack;return e?e.bin?t?[uPe(e,{binSuffix:"mid"})]:[uPe(e,{}),uPe(e,{binSuffix:"end"})]:[uPe(e)]:null!=n?n:[]}assemble(){const e=[],{facetby:t,dimensionFieldDef:n,stackField:r,stackby:i,sort:o,offset:a,impute:s,as:u}=this._stack;if(s&&n){const{band:o=.5,bin:a}=n;a&&e.push({type:"formula",expr:`${o}*`+uPe(n,{expr:"datum"})+`+${1-o}*`+uPe(n,{expr:"datum",binSuffix:"end"}),as:uPe(n,{binSuffix:"mid",forAs:!0})}),e.push({type:"impute",field:r,groupby:[...i,...t],key:uPe(n,{binSuffix:"mid"}),method:"value",value:0})}return e.push({type:"stack",groupby:[...this.getGroupbyFields(),...t],field:r,sort:o,as:u,offset:a}),e}}class TVe extends Aje{constructor(e,t){super(e),this.transform=t}clone(){return new TVe(null,cRe(this.transform))}addDimensions(e){this.transform.groupby=xRe(this.transform.groupby.concat(e),(e=>e))}dependentFields(){var e,t;const n=new Set;return(null!==(e=this.transform.groupby)&&void 0!==e?e:[]).forEach(n.add,n),(null!==(t=this.transform.sort)&&void 0!==t?t:[]).forEach((e=>n.add(e.field))),this.transform.window.map((e=>e.field)).filter((e=>void 0!==e)).forEach(n.add,n),n}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(e){var t;return null!==(t=e.as)&&void 0!==t?t:uPe(e)}hash(){return`WindowTransform ${fRe(this.transform)}`}assemble(){var e;const t=[],n=[],r=[],i=[];for(const e of this.transform.window)n.push(e.op),r.push(this.getDefaultName(e)),i.push(void 0===e.param?null:e.param),t.push(void 0===e.field?null:e.field);const o=this.transform.frame,a=this.transform.groupby;if(o&&null===o[0]&&null===o[1]&&n.every((e=>SNe(e))))return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},void 0!==a?{groupby:a}:{});const s=[],u=[];if(void 0!==this.transform.sort)for(const t of this.transform.sort)s.push(t.field),u.push(null!==(e=t.order)&&void 0!==e?e:"ascending");const l={field:s,order:u},c=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:i,as:r,ops:n,fields:t,sort:l},void 0!==c?{ignorePeers:c}:{}),void 0!==a?{groupby:a}:{}),void 0!==o?{frame:o}:{})}}class EVe extends yVe{run(e){const t=e.parent;if(e instanceof kVe){if(gVe(t))return this.flags;if(t.numChildren()>1)return this.setContinue(),this.flags;if(t instanceof kVe)this.setMutated(),t.merge(e);else{if(kRe(t.producedFields(),e.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),e.swapWithParent()}}return this.setContinue(),this.flags}}class AVe extends bVe{mergeNodes(e,t){const n=t.shift();for(const r of t)e.removeChild(r),r.parent=n,r.remove()}run(e){const t=e.children.map((e=>e.hash())),n={};for(let r=0;r<t.length;r++)void 0===n[t[r]]?n[t[r]]=[e.children[r]]:n[t[r]].push(e.children[r]);for(const t of CRe(n))n[t].length>1&&(this.setMutated(),this.mergeNodes(e,n[t]));for(const t of e.children)this.run(t);return this.mutatedFlag}}class FVe extends yVe{run(e){return e instanceof Fje||e.numChildren()>0||e instanceof xVe||(this.setMutated(),e.remove()),this.flags}}class OVe extends yVe{constructor(){super(...arguments),this.fields=new Set,this.prev=null}run(e){if(this.setContinue(),e instanceof Oje){const t=e.producedFields();_Re(t,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...t]),this.prev=e}return this.flags}reset(){this.fields.clear()}}class RVe extends yVe{run(e){this.setContinue();const t=e.parent.children.filter((e=>e instanceof Oje)),n=t.pop();for(const e of t)this.setMutated(),n.merge(e);return this.flags}}function NVe(e){if(e instanceof xVe)if(1!==e.numChildren()||e.children[0]instanceof Fje){const n=e.model.component.data.main;DVe(n);const r=(t=e,function e(n){if(!(n instanceof xVe)){const r=n.clone();if(r instanceof Fje){const e=jVe+r.getSource();r.setSource(e),t.model.component.data.outputNodes[e]=r}else(r instanceof vVe||r instanceof MVe||r instanceof TVe||r instanceof CVe)&&r.addDimensions(t.fields);for(const t of n.children.flatMap(e))t.parent=r;return[r]}return n.children.flatMap(e)}),i=e.children.map(r).flat();for(const e of i)e.parent=n}else{const t=e.children[0];(t instanceof vVe||t instanceof MVe||t instanceof TVe||t instanceof CVe)&&t.addDimensions(e.fields),t.swapWithParent(),NVe(e)}else e.children.map(NVe);var t}function DVe(e){if(e instanceof Fje&&e.type===Dze&&1===e.numChildren()){const t=e.children[0];t instanceof xVe||(t.swapWithParent(),DVe(e))}}class IVe extends bVe{constructor(){super()}run(e){e instanceof Fje&&!e.isRequired()&&(this.setMutated(),e.remove());for(const t of e.children)this.run(t);return this.mutatedFlag}}class BVe extends bVe{constructor(e){super(),this.requiresSelectionId=e&&yGe(e)}run(e){e instanceof SVe&&(this.requiresSelectionId&&(gVe(e.parent)||e.parent instanceof vVe||e.parent instanceof kVe)||(this.setMutated(),e.remove()));for(const t of e.children)this.run(t);return this.mutatedFlag}}class LVe extends yVe{run(e){const t=e.parent,n=[...t.children],r=t.children.filter((e=>e instanceof kVe));if(t.numChildren()>1&&r.length>=1){const e={},i=new Set;for(const t of r){const n=t.parse;for(const t of CRe(n))t in e?e[t]!==n[t]&&i.add(t):e[t]=n[t]}for(const t of i)delete e[t];if(!SRe(e)){this.setMutated();const r=new kVe(t,e);for(const i of n){if(i instanceof kVe)for(const t of CRe(e))delete i.parse[t];t.removeChild(i),i.parent=r,i instanceof kVe&&0===CRe(i.parse).length&&i.remove()}}}return this.setContinue(),this.flags}}class PVe extends yVe{run(e){const t=e.parent,n=t.children.filter((e=>e instanceof vVe)),r={};for(const e of n){const t=fRe(e.groupBy);t in r||(r[t]=[]),r[t].push(e)}for(const e of CRe(r)){const n=r[e];if(n.length>1){const e=n.pop();for(const r of n)e.merge(r)&&(t.removeChild(r),r.parent=e,r.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class $Ve extends yVe{constructor(e){super(),this.model=e}run(e){const t=e.parent,n=!(gVe(t)||t instanceof KUe||t instanceof kVe||t instanceof SVe),r=[],i=[];for(const e of t.children)e instanceof cVe&&(n&&!kRe(t.producedFields(),e.dependentFields())?r.push(e):i.push(e));if(r.length>0){const e=r.pop();for(const t of r)e.merge(t,this.model.renameSignal.bind(this.model));this.setMutated(),t instanceof cVe?t.merge(e,this.model.renameSignal.bind(this.model)):e.swapWithParent()}if(i.length>1){const e=i.pop();for(const t of i)e.merge(t,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class zVe extends yVe{run(e){const t=e.parent,n=[...t.children];if(!yRe(n,(e=>e instanceof Fje))||t.numChildren()<=1)return this.setContinue(),this.flags;const r=[];let i;for(const e of n)if(e instanceof Fje){let n=e;for(;1===n.numChildren();){const e=n.children[0];if(!(e instanceof Fje))break;n=e}r.push(...n.children),i?(t.removeChild(e),e.parent=i.parent,i.parent.removeChild(i),i.parent=n,this.setMutated()):i=n}else r.push(e);if(r.length){this.setMutated();for(const e of r)e.parent.removeChild(e),e.parent=i}return this.setContinue(),this.flags}}const jVe="scale_",GVe=5;function UVe(e){const t=[];function n(e){if(0===e.numChildren())t.push(e);else for(const t of e.children)n(t)}for(const t of e)n(t);return t}function WVe(e){return e}function VVe(e,t){return t.map((t=>{if(e instanceof yVe){const n=e.optimizeNextFromLeaves(t);return e.reset(),n}return e.run(t)})).some(WVe)}function HVe(e,t){let n=e.sources;const r=new Set;return r.add(VVe(new IVe,n)),r.add(VVe(new BVe(t),n)),n=n.filter((e=>e.numChildren()>0)),r.add(VVe(new FVe,UVe(n))),n=n.filter((e=>e.numChildren()>0)),r.add(VVe(new EVe,UVe(n))),r.add(VVe(new $Ve(t),UVe(n))),r.add(VVe(new OVe,UVe(n))),r.add(VVe(new LVe,UVe(n))),r.add(VVe(new PVe,UVe(n))),r.add(VVe(new RVe,UVe(n))),r.add(VVe(new AVe,n)),r.add(VVe(new zVe,UVe(n))),e.sources=n,r.has(!0)}class qVe{constructor(e){Object.defineProperty(this,"signal",{enumerable:!0,get:e})}static fromName(e,t){return new qVe((()=>e(t)))}}function XVe(e){wHe(e)?function(e){const t=e.component.scales;for(const n of CRe(t)){const r=YVe(e,n);if(t[n].setWithExplicit("domains",r),QVe(e,n),e.component.data.isFaceted){let t=e;for(;!kHe(t)&&t.parent;)t=t.parent;if("shared"===t.component.resolve.scale[n])for(const e of r.value)mBe(e)&&(e.data=jVe+e.data.replace(jVe,""))}}}(e):function(e){for(const t of e.children)XVe(t);const t=e.component.scales;for(const n of CRe(t)){let r,i=null;for(const t of e.children){const e=t.component.scales[n];if(e){r=void 0===r?e.getWithExplicit("domains"):Cze(r,e.getWithExplicit("domains"),"domains","scale",tHe);const t=e.get("selectionExtent");i&&t&&i.selection!==t.selection&&ZIe("The same selection must be used to override scale domains in a layered view."),i=t}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}(e)}function YVe(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=function(e,t,n,r){if("unaggregated"===e){const{valid:e,reason:r}=eHe(t,n);if(!e)return void ZIe(r)}else if(void 0===e&&r.useUnaggregatedDomain){const{valid:e}=eHe(t,n);if(e)return"unaggregated"}return e}(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:i})),"x"===t&&vPe(r.x2)?vPe(r.x)?Cze(JVe(n,i,e,"x"),JVe(n,i,e,"x2"),"domain","scale",tHe):JVe(n,i,e,"x2"):"y"===t&&vPe(r.y2)?vPe(r.y)?Cze(JVe(n,i,e,"y"),JVe(n,i,e,"y2"),"domain","scale",tHe):JVe(n,i,e,"y2"):JVe(n,i,e,t)}function KVe(e,t,n){var r;const i=null===(r=hBe(n))||void 0===r?void 0:r.unit;return"temporal"===t||i?function(e,t,n){return e.map((e=>({signal:`{data: ${MPe(e,{timeUnit:n,type:t})}}`})))}(e,t,i):[e]}function JVe(e,t,n,r){const{encoding:i}=n,o=vPe(i[r]),{type:a}=o,s=o.timeUnit;if(function(e){return e&&e.unionWith}(t)){const i=JVe(e,void 0,n,r),o=KVe(t.unionWith,a,s);return _ze([...i.value,...o])}if(fBe(t))return _ze([t]);if(t&&"unaggregated"!==t&&!tLe(t))return _ze(KVe(t,a,s));const u=n.stack;if(u&&r===u.fieldChannel){if("normalize"===u.offset)return wze([[0,1]]);const e=n.requestDataName(Dze);return wze([{data:e,field:n.vgField(r,{suffix:"start"})},{data:e,field:n.vgField(r,{suffix:"end"})}])}const l=dIe(r)&&KLe(o)?function(e,t,n){if(!JBe(n))return;const r=e.fieldDef(t),i=r.sort;if($Le(i))return{op:"min",field:mWe(r,t),order:"ascending"};const{stack:o}=e,a=o?[...o.groupbyField?[o.groupbyField]:[],...o.stackBy.map((e=>e.fieldDef.field))]:void 0;if(PLe(i))return ZVe(i,o&&!mRe(a,i.field));if(LLe(i)){const{encoding:t,order:n}=i,r=e.fieldDef(t),{aggregate:s,field:u}=r,l=o&&!mRe(a,u);if(wNe(s)||kNe(s))return ZVe({field:uPe(r),order:n},l);if(SNe(s)||!s)return ZVe({op:s,field:u,order:n},l)}else{if("descending"===i)return{op:"min",field:e.vgField(t),order:"descending"};if(mRe(["ascending",void 0],i))return!0}}(n,r,e):void 0;if(ZLe(o))return wze(KVe([o.datum],a,s));const c=o;if("unaggregated"===t){const e=n.requestDataName(Dze),{field:t}=o;return wze([{data:e,field:uPe({field:t,aggregate:"min"})},{data:e,field:uPe({field:t,aggregate:"max"})}])}if(bIe(c.bin)){if(JBe(e))return wze("bin-ordinal"===e?[]:[{data:ERe(l)?n.requestDataName(Dze):n.requestDataName(Ize),field:n.vgField(r,EPe(c,r)?{binSuffix:"range"}:{}),sort:!0!==l&&POe(l)?l:{field:n.vgField(r,{}),op:"min"}}]);{const{bin:e}=c;if(bIe(e)){const t=uVe(n,c.field,e);return wze([new qVe((()=>{const e=n.getSignalName(t);return`[${e}.start, ${e}.stop]`}))])}return wze([{data:n.requestDataName(Dze),field:n.vgField(r,{})}])}}if(c.timeUnit&&mRe(["time","utc"],e)&&HLe(r,c,wHe(n)?n.encoding[RDe(r)]:void 0,n.stack,n.markDef,n.config)){const e=n.requestDataName(Dze);return wze([{data:e,field:n.vgField(r)},{data:e,field:n.vgField(r,{suffix:"end"})}])}return wze(l?[{data:ERe(l)?n.requestDataName(Dze):n.requestDataName(Ize),field:n.vgField(r),sort:l}]:[{data:n.requestDataName(Dze),field:n.vgField(r)}])}function ZVe(e,t){const{op:n,field:r,order:i}=e;return Object.assign(Object.assign({op:null!=n?n:t?"sum":DLe},r?{field:IRe(r)}:{}),i?{order:i}:{})}function QVe(e,t){var n;const r=e.component.scales[t],i=e.specifiedScales[t].domain,o=null===(n=e.fieldDef(t))||void 0===n?void 0:n.bin,a=tLe(i)&&i,s=xIe(o)&&_Ie(o.extent)&&o.extent;(a||s)&&r.set("selectionExtent",null!=a?a:s,!0)}function eHe(e,t){const{aggregate:n,type:r}=e;return n?XOe(n)&&!ENe[n]?{valid:!1,reason:jIe(n)}:"quantitative"===r&&"log"===t?{valid:!1,reason:GIe(e)}:{valid:!0}:{valid:!1,reason:zIe(e)}}function tHe(e,t,n,r){return e.explicit&&t.explicit&&ZIe(function(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${hRe(n)} and ${hRe(r)}). Using the union of the two domains.`}(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function nHe(e){if(mBe(e)&&XOe(e.field))return e.field;if(function(e){return!LOe(e)&&"fields"in e&&!("data"in e)}(e)){let t;for(const n of e.fields)if(mBe(n)&&XOe(n.field))if(t){if(t!==n.field)return ZIe("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),t}else t=n.field;return ZIe("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),t}if(function(e){return!LOe(e)&&"fields"in e&&"data"in e}(e)){ZIe("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");const t=e.fields[0];return XOe(t)?t:void 0}}function rHe(e,t){return function(e){const t=xRe(e.map((e=>{if(mBe(e)){const{sort:t}=e;return JOe(e,["sort"])}return e})),fRe),n=xRe(e.map((e=>{if(mBe(e)){const t=e.sort;return void 0===t||ERe(t)||("op"in t&&"count"===t.op&&delete t.field,"ascending"===t.order&&delete t.order),t}})).filter((e=>void 0!==e)),fRe);if(0===t.length)return;if(1===t.length){const t=e[0];if(mBe(t)&&n.length>0){let e=n[0];if(n.length>1)ZIe(VIe),e=!0;else if(POe(e)&&"field"in e){const n=e.field;t.field===n&&(e=!e.order||{order:e.order})}return Object.assign(Object.assign({},t),{sort:e})}return t}const r=xRe(n.map((e=>ERe(e)||!("op"in e)||e.op in _Ne?e:(ZIe(function(e){return`Dropping sort property ${hRe(e)} as unioned domains only support boolean or op "count", "min", and "max".`}(e)),!0))),fRe);let i;1===r.length?i=r[0]:r.length>1&&(ZIe(VIe),i=!0);const o=xRe(e.map((e=>mBe(e)?e.data:null)),(e=>e));return 1===o.length&&null!==o[0]?Object.assign({data:o[0],fields:t.map((e=>e.field))},i?{sort:i}:{}):Object.assign({fields:t},i?{sort:i}:{})}(e.component.scales[t].get("domains").map((t=>(mBe(t)&&(t.data=e.lookupDataSource(t.data)),t))))}function iHe(e){return CHe(e)||SHe(e)?e.children.reduce(((e,t)=>e.concat(iHe(t))),oHe(e)):oHe(e)}function oHe(e){return CRe(e.component.scales).reduce(((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:o,type:a,selectionExtent:s,domains:u,range:l,reverse:c}=i,p=JOe(i,["name","type","selectionExtent","domains","range","reverse"]),d=function(e,t,n){return KDe(n)&&gBe(e)?{step:{signal:t+"_step"}}:e}(i.range,o,n);let h;s&&(h=function(e,t){const n=t.selection;return{signal:ZUe(e.getSelectionComponent(n,ARe(n)),t)}}(e,s));const f=rHe(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:a},f?{domain:f}:{}),h?{domainRaw:h}:{}),{range:d}),void 0!==c?{reverse:c}:{}),p)),t}),[])}class aHe extends xze{constructor(e,t){super({},{name:e}),this.merged=!1,this.setWithExplicit("type",t)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||yRe(this.get("domains"),(e=>LOe(e)&&2===e.length&&e[0]<=0&&e[1]>=0))}}const sHe=["range","scheme"];function uHe(e){return"x"===e?"width":"y"===e?"height":void 0}function lHe(e,t){const n=e.fieldDef(t);if(n&&n.bin&&bIe(n.bin)){const r=uVe(e,n.field,n.bin),i=uHe(t),o=e.getName(i);return new qVe((()=>{const t=e.getSignalName(r),n=`(${t}.stop - ${t}.start) / ${t}.step`;return`${e.getSignalName(o)} / (${n})`}))}}function cHe(e,t){const n=t.specifiedScales[e],{size:r}=t,i=t.getScaleComponent(e).get("type");for(const r of sHe)if(void 0!==n[r]){const o=lLe(i,r),a=cLe(e,r);if(o)if(a)ZIe(a);else switch(r){case"range":return LOe(n.range)&&KDe(e)?_ze(n.range.map((e=>{if("width"===e||"height"===e){const n=t.getName(e),r=t.getSignalName.bind(t);return qVe.fromName(r,n)}return e}))):_ze(n.range);case"scheme":return _ze(pHe(n[r]))}else ZIe(UIe(i,r,e))}if(e===RNe||e===NNe){const t=e===RNe?"width":"height",n=r[t];if(F$e(n)){if(JBe(i))return _ze({step:n.step});ZIe(WIe(t))}}return wze(function(e,t){const{size:n,config:r,mark:i,encoding:o}=t,a=t.getSignalName.bind(t),{type:s}=vPe(o[e]),u=t.getScaleComponent(e).get("type"),{domain:l,domainMid:c}=t.specifiedScales[e];switch(e){case RNe:case NNe:{if(mRe(["point","band"],u))if(e!==RNe||n.width){if(e===NNe&&!n.height){const e=I$e(r.view,"height");if(F$e(e))return e}}else{const e=I$e(r.view,"width");if(F$e(e))return e}const i=uHe(e),o=t.getName(i);return e===NNe&&ZBe(u)?[qVe.fromName(a,o),0]:[0,qVe.fromName(a,o)]}case XNe:{const o=dHe(i,t.component.scales[e].get("zero"),r),a=function(e,t,n,r){const i={x:lHe(n,"x"),y:lHe(n,"y")};switch(e){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const e=fHe(t,i,r.view);return qOe(e)?e-1:new qVe((()=>`${e.signal} - 1`))}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const e=fHe(t,i,r.view);return qOe(e)?Math.pow(hHe*e,2):new qVe((()=>`pow(${hHe} * ${e.signal}, 2)`))}}throw new Error(LIe("size",e))}(i,n,t,r);return eLe(u)?function(e,t,n){const r=()=>{const r=NPe(t),i=NPe(e),o=`(${r} - ${i}) / (${n} - 1)`;return`sequence(${i}, ${r} + ${o}, ${o})`};return fBe(t)?new qVe(r):{signal:r()}}(o,a,function(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&LOe(n)?n.length+1:(ZIe(function(e){return`Domain for ${e} is required for threshold scale.`}(r)),3)}}(u,r,l,e)):[o,a]}case PNe:return[0,2*Math.PI];case YNe:return[0,360];case BNe:return[0,new qVe((()=>`min(${t.getSignalName("width")},${t.getSignalName("height")})/2`))];case QNe:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case eDe:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case qNe:return"symbol";case WNe:case VNe:case HNe:return"ordinal"===u?"nominal"===s?"category":"ordinal":void 0!==c?"diverging":"rect"===i||"geoshape"===i?"heatmap":"ramp";case KNe:case JNe:case ZNe:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}(e,t))}function pHe(e){return function(e){return!XOe(e)&&!!e.name}(e)?Object.assign({scheme:e.name},dRe(e,["name"])):{scheme:e}}function dHe(e,t,n){if(t)return fBe(t)?{signal:`${t.signal} ? 0 : ${dHe(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(LIe("size",e))}const hHe=.95;function fHe(e,t,n){const r=F$e(e.width)?e.width.step:D$e(n,"width"),i=F$e(e.height)?e.height.step:D$e(n,"height");return t.x||t.y?new qVe((()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`)):Math.min(r,i)}function gHe(e,t){wHe(e)?function(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:a}=e;for(const s of CRe(n)){const u=a[s],l=n[s],c=e.getScaleComponent(s),p=vPe(i[s]),d=u[t],h=c.get("type"),f=c.get("padding"),g=c.get("paddingInner"),m=lLe(h,t),y=cLe(s,t);if(void 0!==d&&(m?y&&ZIe(y):ZIe(UIe(h,t,s))),m&&void 0===y)if(void 0!==d)l.copyKeyFromObject(t,u);else{const n=t in mHe?mHe[t]({model:e,channel:s,fieldOrDatumDef:p,scaleType:h,scalePadding:f,scalePaddingInner:g,domain:u.domain,markDef:o,config:r}):r.scale[t];void 0!==n&&l.set(t,n,!1)}}}(e,t):bHe(e,t)}const mHe={bins:({model:e,fieldOrDatumDef:t})=>KLe(t)?function(e,t){const n=t.bin;if(bIe(n)){const r=uVe(e,t.field,n);return new qVe((()=>e.getSignalName(r)))}if(vIe(n)&&xIe(n)&&void 0!==n.step)return{step:n.step}}(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>function(e,t){if(mRe([WNe,VNe,HNe],e)&&"nominal"!==t)return"hcl"}(e,t.type),nice:({scaleType:e,channel:t,fieldOrDatumDef:n})=>function(e,t,n){var r;if(!(null===(r=bPe(n))||void 0===r?void 0:r.bin)&&!mRe([$Be.TIME,$Be.UTC],e))return t in XDe||void 0}(e,t,n),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>function(e,t,n,r,i,o){if(e in XDe){if(QBe(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:t,orient:a}=i;if("bar"===t&&(!KLe(r)||!r.bin&&!r.timeUnit)&&("vertical"===a&&"x"===e||"horizontal"===a&&"y"===e))return o.continuousBandSize}if(t===$Be.POINT)return n.pointPadding}}(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:r})=>function(e,t,n,r){if(void 0===e&&t in XDe){const{bandPaddingInner:e,barBandPaddingInner:t,rectBandPaddingInner:i}=r;return $Re(e,"bar"===n?t:i)}}(e,t,n.type,r.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:r,scalePaddingInner:i,config:o})=>function(e,t,n,r,i,o){if(void 0===e&&t in XDe&&n===$Be.BAND){const{bandPaddingOuter:e}=o;return $Re(e,fBe(i)?{signal:`${i.signal}/2`}:i/2)}}(e,t,n,r.type,i,o.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>function(e,t,n,r){return"x"===n&&void 0!==r.xReverse?ZBe(e)&&"descending"===t?fBe(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse:!(!ZBe(e)||"descending"!==t)||void 0}(t,KLe(e)?e.sort:void 0,n,r.scale),zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i})=>function(e,t,n,r,i){if(n&&"unaggregated"!==n&&ZBe(i)){if(LOe(n)){const e=n[0],t=n[n.length-1];if(e<=0&&t>=0)return!0}return!1}if("size"===e&&"quantitative"===t.type&&!eLe(i))return!0;if((!KLe(t)||!t.bin)&&mRe([...YDe,...ZDe],e)){const{orient:t,type:n}=r;return!mRe(["bar","area","line","trail"],n)||!("horizontal"===t&&"y"===e||"vertical"===t&&"x"===e)}return!1}(e,t,n,r,i)};function yHe(e){wHe(e)?function(e){const t=e.component.scales;for(const n of pIe){const r=t[n];if(!r)continue;const i=cHe(n,e);r.setWithExplicit("range",i)}}(e):bHe(e,"range")}function bHe(e,t){const n=e.component.scales;for(const n of e.children)"range"===t?yHe(n):gHe(n,t);for(const r of CRe(n)){let i;for(const n of e.children){const e=n.component.scales[r];e&&(i=Cze(i,e.getWithExplicit(t),t,"scale",kze(((e,n)=>"range"===t&&e.step&&n.step?e.step-n.step:0))))}n[r].setWithExplicit(t,i)}}function vHe(e){wHe(e)?e.component.scales=function(e){const{encoding:t,mark:n}=e;return pIe.reduce(((r,i)=>{const o=vPe(t[i]);if(o&&n===cNe&&i===qNe&&o.type===LBe)return r;let a=o&&o.scale;if(o&&null!==a&&!1!==a){a=null!=a?a:{};const t=function(e,t,n,r){const i=function(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":if(fDe(e)||"discrete"===mIe(e))return"shape"===e&&"ordinal"===t.type&&ZIe($Ie(e,"ordinal")),"ordinal";if(e in XDe){if(mRe(["rect","bar","image","rule"],n))return"band"}else if("arc"===n&&e in JDe)return"band";return void 0!==t.band||oPe(t)&&(null===(r=t.axis)||void 0===r?void 0:r.tickBand)?"band":"point";case"temporal":return fDe(e)?"time":"discrete"===mIe(e)?(ZIe($Ie(e,"temporal")),"ordinal"):KLe(t)&&t.timeUnit&&hBe(t.timeUnit).utc?"utc":"time";case"quantitative":return fDe(e)?KLe(t)&&bIe(t.bin)?"bin-ordinal":"linear":"discrete"===mIe(e)?(ZIe($Ie(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(DIe(t.type))}(t,n,r),{type:o}=e;return dIe(t)?void 0!==o?dLe(t,o)?KLe(n)&&!pLe(o,n.type)?(ZIe(function(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}(o,i)),i):o:(ZIe(function(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}(t,o,i)),i):i:null}(a,i,o,n);r[i]=new aHe(e.scaleName(i+"",!0),{value:t,explicit:a.type===t})}return r}),{})}(e):e.component.scales=function(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const n of e.children){vHe(n);for(const o of CRe(n.component.scales))if(i.scale[o]=null!==(t=i.scale[o])&&void 0!==t?t:PWe(o,e),"shared"===i.scale[o]){const e=r[o],t=n.component.scales[o].getWithExplicit("type");e?GBe(e.value,t.value)?r[o]=Cze(e,t,"type","scale",xHe):(i.scale[o]="independent",delete r[o]):r[o]=t}}for(const t of CRe(r)){const i=e.scaleName(t,!0),o=r[t];n[t]=new aHe(i,o);for(const n of e.children){const e=n.component.scales[t];e&&(n.renameScale(e.get("name"),i),e.merged=!0)}}return n}(e)}const xHe=kze(((e,t)=>WBe(e)-WBe(t)));class _He{constructor(){this.nameMap={}}rename(e,t){this.nameMap[e]=t}has(e){return void 0!==this.nameMap[e]}get(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e}}function wHe(e){return"unit"===(null==e?void 0:e.type)}function kHe(e){return"facet"===(null==e?void 0:e.type)}function SHe(e){return"concat"===(null==e?void 0:e.type)}function CHe(e){return"layer"===(null==e?void 0:e.type)}class MHe{constructor(e,t,n,r,i,o,a){var s,u;this.type=t,this.parent=n,this.config=i,this.view=a,this.children=[],this.correctDataNames=e=>(e.from&&e.from.data&&(e.from.data=this.lookupDataSource(e.from.data)),e.from&&e.from.facet&&e.from.facet.data&&(e.from.facet.data=this.lookupDataSource(e.from.facet.data)),e),this.parent=n,this.config=i,this.name=null!==(s=e.name)&&void 0!==s?s:r,this.title=FPe(e.title)?{text:e.title}:e.title,this.scaleNameMap=n?n.scaleNameMap:new _He,this.projectionNameMap=n?n.projectionNameMap:new _He,this.signalNameMap=n?n.signalNameMap:new _He,this.data=e.data,this.description=e.description,this.transforms=(null!==(u=e.transform)&&void 0!==u?u:[]).map((e=>Bze(e)?{filter:uRe(e.filter,OBe)}:e)),this.layout="layer"===t||"unit"===t?{}:function(e,t,n){var r,i;const o=n[t],a={},{spacing:s,columns:u}=o;void 0!==s&&(a.spacing=s),void 0!==u&&(GLe(e)&&!zLe(e.facet)||T$e(e))&&(a.columns=u),E$e(e)&&(a.columns=1);for(const t of R$e)if(void 0!==e[t])if("spacing"===t){const n=e[t];a[t]=qOe(n)?n:{row:null!==(r=n.row)&&void 0!==r?r:s,column:null!==(i=n.column)&&void 0!==i?i:s}}else a[t]=e[t];return a}(e,t,i),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:GLe(e)||n&&n.component.data.isFaceted&&void 0===e.data},layoutSize:new xze,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?cRe(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function(e,{ignoreRange:t}={}){vHe(e),XVe(e);for(const t of uLe)gHe(e,t);t||yHe(e)}(this)}parseProjection(){aVe(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){JWe(this)}assembleGroupStyle(){var e,t;if("unit"===this.type||"layer"===this.type)return null!==(t=null===(e=this.view)||void 0===e?void 0:e.style)&&void 0!==t?t:"cell"}assembleEncodeFromView(e){const{style:t}=e,n=JOe(e,["style"]),r={};for(const e of CRe(n)){const t=n[e];void 0!==t&&(r[e]=OPe(t))}return r}assembleGroupEncodeEntry(e){let t={};return this.view&&(t=this.assembleEncodeFromView(this.view)),e||(this.description&&(t.description=OPe(this.description)),"unit"!==this.type&&"layer"!==this.type)?SRe(t)?void 0:t:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!=t?t:{})}assembleLayout(){if(!this.layout)return;const e=this.layout,{spacing:t}=e,n=JOe(e,["spacing"]),{component:r,config:i}=this,o=function(e,t){const n={};for(const r of mDe){const i=e[r];if(null==i?void 0:i.facetFieldDef){const{titleAnchor:e,titleOrient:o}=vWe(["titleAnchor","titleOrient"],i.facetFieldDef,t,r),a=yWe(r,o),s=FWe(e,a);void 0!==s&&(n[a]=s)}}return SRe(n)?void 0:n}(r.layoutHeaders,i);return Object.assign(Object.assign(Object.assign({padding:t},this.assembleDefaultLayout()),n),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:e}=this.component;let t=[];for(const n of mDe)e[n].title&&t.push(wWe(this,n));for(const e of xWe)t=t.concat(CWe(this,e));return t}assembleAxes(){return function(e,t){const{x:n=[],y:r=[]}=e;return[...n.map((e=>tWe(e,"grid",t))),...r.map((e=>tWe(e,"grid",t))),...n.map((e=>tWe(e,"main",t))),...r.map((e=>tWe(e,"main",t)))].filter((e=>e))}(this.component.axes,this.config)}assembleLegends(){return nVe(this)}assembleProjections(){return CHe(e=this)||SHe(e)?function(e){return e.children.reduce(((e,t)=>e.concat(t.assembleProjections())),rVe(e))}(e):rVe(e);var e}assembleTitle(){var e,t,n;const r=null!==(e=this.title)&&void 0!==e?e:{},{encoding:i}=r,o=JOe(r,["encoding"]),a=Object.assign(Object.assign(Object.assign({},APe(this.config.title).nonMark),o),i?{encode:{update:i}}:{});if(a.text)return mRe(["unit","layer"],this.type)?mRe(["middle",void 0],a.anchor)&&(a.frame=null!==(t=a.frame)&&void 0!==t?t:"group"):a.anchor=null!==(n=a.anchor)&&void 0!==n?n:"start",SRe(a)?void 0:a}assembleGroup(e=[]){const t={};(e=e.concat(this.assembleSignals())).length>0&&(t.signals=e);const n=this.assembleLayout();n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||kHe(this.parent)?iHe(this):[];r.length>0&&(t.scales=r);const i=this.assembleAxes();i.length>0&&(t.axes=i);const o=this.assembleLegends();return o.length>0&&(t.legends=o),t}getName(e){return ARe((this.name?this.name+"_":"")+e)}requestDataName(e){var t;const n=this.getName(e),r=this.component.data.outputNodeRefCounts;return r[n]=(null!==(t=r[n])&&void 0!==t?t:0)+1,n}getSizeSignalRef(e){if(kHe(this.parent)){const t=QDe(BWe(e)),n=this.component.scales[t];if(n&&!n.merged){const e=n.get("type"),r=n.get("range");if(JBe(e)&&gBe(r)){const e=n.get("name"),r=nHe(rHe(this,t));return r?{signal:IWe(e,n,uPe({aggregate:"distinct",field:r},{expr:"datum"}))}:(ZIe(`Unknown field for ${t}. Cannot calculate view size.`),null)}}}return{signal:this.signalNameMap.get(this.getName(e))}}lookupDataSource(e){const t=this.component.data.outputNodes[e];return t?t.getSource():e}getSignalName(e){return this.signalNameMap.get(e)}renameSignal(e,t){this.signalNameMap.rename(e,t)}renameScale(e,t){this.scaleNameMap.rename(e,t)}renameProjection(e,t){this.projectionNameMap.rename(e,t)}scaleName(e,t){return t?this.getName(e):TDe(e)&&dIe(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0}projectionName(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const t=this.component.scales[e];return t&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0}getSelectionComponent(e,t){let n=this.component.selection[e];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(e,t)),!n)throw new Error(`Cannot find a selection named "${t}".`);return n}hasAxisOrientSignalRef(){var e,t;return(null===(e=this.component.axes.x)||void 0===e?void 0:e.some((e=>e.hasOrientSignalRef())))||(null===(t=this.component.axes.y)||void 0===t?void 0:t.some((e=>e.hasOrientSignalRef())))}}class THe extends MHe{vgField(e,t={}){const n=this.fieldDef(e);if(n)return uPe(n,t)}reduceFieldDef(e,t){return YPe(this.getMapping(),((t,n,r)=>{const i=bPe(n);return i?e(t,i,r):t}),t)}forEachFieldDef(e,t){XPe(this.getMapping(),((t,n)=>{const r=bPe(t);r&&e(r,n)}),t)}}class EHe extends Aje{constructor(e,t){var n,r,i;super(e),this.transform=t,this.transform=cRe(t);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"value",null!==(i=o[1])&&void 0!==i?i:"density"]}clone(){return new EHe(null,cRe(this.transform))}dependentFields(){var e;return new Set([this.transform.density,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${fRe(this.transform)}`}assemble(){const e=this.transform,{density:t}=e,n=JOe(e,["density"]);return Object.assign({type:"kde",field:t},n)}}class AHe extends Aje{constructor(e,t){super(e),this.filter=t}clone(){return new AHe(null,Object.assign({},this.filter))}static make(e,t){const{config:n,mark:r,markDef:i}=t;if("filter"!==IPe("invalid",i,n))return null;const o=t.reduceFieldDef(((e,n,i)=>{const o=dIe(i)&&t.getScaleComponent(i);return o&&ZBe(o.get("type"))&&"count"!==n.aggregate&&!pNe(r)&&(e[n.field]=n),e}),{});return CRe(o).length?new AHe(e,o):null}dependentFields(){return new Set(CRe(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${fRe(this.filter)}`}assemble(){const e=CRe(this.filter).reduce(((e,t)=>{const n=this.filter[t],r=uPe(n,{expr:"datum"});return null!==n&&("temporal"===n.type?e.push(`(isDate(${r}) || (isValid(${r}) && isFinite(+${r})))`):"quantitative"===n.type&&(e.push(`isValid(${r})`),e.push(`isFinite(+${r})`))),e}),[]);return e.length>0?{type:"filter",expr:e.join(" && ")}:null}}class FHe extends Aje{constructor(e,t){super(e),this.transform=t,this.transform=cRe(t);const{flatten:n,as:r=[]}=this.transform;this.transform.as=n.map(((e,t)=>{var n;return null!==(n=r[t])&&void 0!==n?n:e}))}clone(){return new FHe(this.parent,cRe(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${fRe(this.transform)}`}assemble(){const{flatten:e,as:t}=this.transform;return{type:"flatten",fields:e,as:t}}}class OHe extends Aje{constructor(e,t){var n,r,i;super(e),this.transform=t,this.transform=cRe(t);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"key",null!==(i=o[1])&&void 0!==i?i:"value"]}clone(){return new OHe(null,cRe(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${fRe(this.transform)}`}assemble(){const{fold:e,as:t}=this.transform;return{type:"fold",fields:e,as:t}}}class RHe extends Aje{constructor(e,t,n,r){super(e),this.fields=t,this.geojson=n,this.signal=r}clone(){return new RHe(null,cRe(this.fields),this.geojson,this.signal)}static parseAll(e,t){if(t.component.projection&&!t.component.projection.isFit)return e;let n=0;for(const r of[[jNe,zNe],[UNe,GNe]]){const i=r.map((e=>{const n=vPe(t.encoding[e]);return KLe(n)?n.field:ZLe(n)?{expr:`${n.datum}`}:rPe(n)?{expr:`${n.value}`}:void 0}));(i[0]||i[1])&&(e=new RHe(e,i,null,t.getName("geojson_"+n++)))}if(t.channelHasField(qNe)){const r=t.typedFieldDef(qNe);r.type===LBe&&(e=new RHe(e,null,r.field,t.getName("geojson_"+n++)))}return e}dependentFields(){var e;const t=(null!==(e=this.fields)&&void 0!==e?e:[]).filter(XOe);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${fRe(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class NHe extends Aje{constructor(e,t,n,r){super(e),this.projection=t,this.fields=n,this.as=r}clone(){return new NHe(null,this.projection,cRe(this.fields),cRe(this.as))}static parseAll(e,t){if(!t.projectionName())return e;for(const n of[[jNe,zNe],[UNe,GNe]]){const r=n.map((e=>{const n=vPe(t.encoding[e]);return KLe(n)?n.field:ZLe(n)?{expr:`${n.datum}`}:rPe(n)?{expr:`${n.value}`}:void 0})),i=n[0]===UNe?"2":"";(r[0]||r[1])&&(e=new NHe(e,t.projectionName(),r,[t.getName("x"+i),t.getName("y"+i)]))}return e}dependentFields(){return new Set(this.fields.filter(XOe))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${fRe(this.fields)} ${fRe(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class DHe extends Aje{constructor(e,t){super(e),this.transform=t}clone(){return new DHe(null,cRe(this.transform))}dependentFields(){var e;return new Set([this.transform.impute,this.transform.key,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(e){const{start:t=0,stop:n,step:r}=e;return{signal:`sequence(${[t,n,...r?[r]:[]].join(",")})`}}static makeFromTransform(e,t){return new DHe(e,t)}static makeFromEncoding(e,t){const n=t.encoding,r=n.x,i=n.y;if(KLe(r)&&KLe(i)){const o=r.impute?r:i.impute?i:void 0;if(void 0===o)return;const a=r.impute?i:i.impute?r:void 0,{method:s,value:u,frame:l,keyvals:c}=o.impute,p=KPe(t.mark,n);return new DHe(e,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:a.field},s?{method:s}:{}),void 0!==u?{value:u}:{}),l?{frame:l}:{}),void 0!==c?{keyvals:c}:{}),p.length?{groupby:p}:{}))}return null}hash(){return`Impute ${fRe(this.transform)}`}assemble(){const{impute:e,key:t,keyvals:n,method:r,groupby:i,value:o,frame:a=[null,null]}=this.transform,s=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:e,key:t},n?{keyvals:(u=n,void 0!==(null==u?void 0:u.stop)?this.processSequence(n):n)}:{}),{method:"value"}),i?{groupby:i}:{}),{value:r&&"value"!==r?null:o});var u;return r&&"value"!==r?[s,Object.assign({type:"window",as:[`imputed_${e}_value`],ops:[r],fields:[e],frame:a,ignorePeers:!1},i?{groupby:i}:{}),{type:"formula",expr:`datum.${e} === null ? datum.imputed_${e}_value : datum.${e}`,as:e}]:[s]}}class IHe extends Aje{constructor(e,t){var n,r,i;super(e),this.transform=t,this.transform=cRe(t);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:t.on,null!==(i=o[1])&&void 0!==i?i:t.loess]}clone(){return new IHe(null,cRe(this.transform))}dependentFields(){var e;return new Set([this.transform.loess,this.transform.on,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${fRe(this.transform)}`}assemble(){const e=this.transform,{loess:t,on:n}=e,r=JOe(e,["loess","on"]);return Object.assign({type:"loess",x:n,y:t},r)}}class BHe extends Aje{constructor(e,t,n){super(e),this.transform=t,this.secondary=n}clone(){return new BHe(null,cRe(this.transform),this.secondary)}static make(e,t,n,r){const i=t.component.data.sources,{from:o}=n;let a=null;if(function(e){return"data"in e}(o)){let e=JHe(o.data,i);e||(e=new pVe(o.data),i.push(e));const n=t.getName(`lookup_${r}`);a=new Fje(e,n,"lookup",t.component.data.outputNodeRefCounts),t.component.data.outputNodes[n]=a}else if(function(e){return"selection"in e}(o)){const e=o.selection;if(n=Object.assign({as:e},n),a=t.getSelectionComponent(ARe(e),e).materialized,!a)throw new Error(`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`)}return new BHe(e,n,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?UOe(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${fRe({transform:this.transform,secondary:this.secondary})}`}assemble(){let e;if(this.transform.from.fields)e=Object.assign({values:this.transform.from.fields},this.transform.as?{as:UOe(this.transform.as)}:{});else{let t=this.transform.as;XOe(t)||(ZIe('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),t="_lookup"),e={as:[t]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e),this.transform.default?{default:this.transform.default}:{})}}class LHe extends Aje{constructor(e,t){var n,r,i;super(e),this.transform=t,this.transform=cRe(t);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"prob",null!==(i=o[1])&&void 0!==i?i:"value"]}clone(){return new LHe(null,cRe(this.transform))}dependentFields(){var e;return new Set([this.transform.quantile,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${fRe(this.transform)}`}assemble(){const e=this.transform,{quantile:t}=e,n=JOe(e,["quantile"]);return Object.assign({type:"quantile",field:t},n)}}class PHe extends Aje{constructor(e,t){var n,r,i;super(e),this.transform=t,this.transform=cRe(t);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:t.on,null!==(i=o[1])&&void 0!==i?i:t.regression]}clone(){return new PHe(null,cRe(this.transform))}dependentFields(){var e;return new Set([this.transform.regression,this.transform.on,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${fRe(this.transform)}`}assemble(){const e=this.transform,{regression:t,on:n}=e,r=JOe(e,["regression","on"]);return Object.assign({type:"regression",x:n,y:t},r)}}class $He extends Aje{constructor(e,t){super(e),this.transform=t}clone(){return new $He(null,cRe(this.transform))}addDimensions(e){var t;this.transform.groupby=xRe((null!==(t=this.transform.groupby)&&void 0!==t?t:[]).concat(e),(e=>e))}producedFields(){}dependentFields(){var e;return new Set([this.transform.pivot,this.transform.value,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}hash(){return`PivotTransform ${fRe(this.transform)}`}assemble(){const{pivot:e,value:t,groupby:n,limit:r,op:i}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:e,value:t},void 0!==r?{limit:r}:{}),void 0!==i?{op:i}:{}),void 0!==n?{groupby:n}:{})}}class zHe extends Aje{constructor(e,t){super(e),this.transform=t}clone(){return new zHe(null,cRe(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${fRe(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function jHe(e){let t=0;return function n(r,i){var o;if(r instanceof pVe&&!r.isGenerator&&!Tze(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof kVe&&(r.parent instanceof pVe&&!i.source?(i.format=Object.assign(Object.assign({},null!==(o=i.format)&&void 0!==o?o:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof xVe){i.name||(i.name="data_"+t++),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source;for(const t of r.assemble())e.push(t)}else switch((r instanceof hVe||r instanceof fVe||r instanceof AHe||r instanceof KUe||r instanceof gWe||r instanceof NHe||r instanceof RHe||r instanceof vVe||r instanceof BHe||r instanceof TVe||r instanceof CVe||r instanceof OHe||r instanceof FHe||r instanceof EHe||r instanceof IHe||r instanceof LHe||r instanceof PHe||r instanceof SVe||r instanceof zHe||r instanceof $He)&&i.transform.push(r.assemble()),(r instanceof cVe||r instanceof Oje||r instanceof DHe||r instanceof MVe)&&i.transform.push(...r.assemble()),r instanceof Fje&&(i.source&&0===i.transform.length?r.setSource(i.source):r.parent instanceof Fje?r.setSource(i.name):(i.name||(i.name="data_"+t++),r.setSource(i.name),1===r.numChildren()&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof Fje&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name="data_"+t++);let o=i.name;!i.source||i.transform.length>0?e.push(i):o=i.source;for(const e of r.children)n(e,{name:null,source:o,transform:[]});break}}}}function GHe(e){return"top"===e||"left"===e||fBe(e)?"header":"footer"}function UHe(e,t){var n;const{facet:r,config:i,child:o,component:a}=e;if(e.channelHasField(t)){const s=r[t],u=bWe("title",null,i,t);let l=fPe(s,i,{allowDisabling:!0,includeDefault:void 0===u||!!u});o.component.layoutHeaders[t].title&&(l=LOe(l)?l.join(", "):l,l+=" / "+o.component.layoutHeaders[t].title,o.component.layoutHeaders[t].title=null);const c=bWe("labelOrient",s,i,t),p=$Re((null!==(n=s.header)&&void 0!==n?n:{}).labels,i.header.labels,!0),d=mRe(["bottom","right"],c)?"footer":"header";a.layoutHeaders[t]={title:l,facetFieldDef:s,[d]:"facet"===t?[]:[WHe(e,t,p)]}}}function WHe(e,t,n){const r="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function VHe(e,t){var n;const{child:r}=e;if(r.component.axes[t]){const{layoutHeaders:i,resolve:o}=e.component;if(o.axis[t]=$We(o,t),"shared"===o.axis[t]){const o="x"===t?"column":"row",a=i[o];for(const i of r.component.axes[t]){const t=GHe(i.get("orient"));a[t]=null!==(n=a[t])&&void 0!==n?n:[WHe(e,o,!1)];const r=tWe(i,"main",e.config,{header:!0});r&&a[t][0].axes.push(r),i.mainExtracted=!0}}}}function HHe(e){for(const t of e.children)t.parseLayoutSize()}function qHe(e,t){const n=BWe(t),r=QDe(n),i=e.component.resolve,o=e.component.layoutSize;let a;for(const t of e.children){const e=t.component.layoutSize.getWithExplicit(n),o=i.scale[r];if("independent"===o&&"step"===e.value){a=void 0;break}if(a){if("independent"===o&&a.value!==e.value){a=void 0;break}a=Cze(a,e,n,"")}else a=e}if(a){for(const r of e.children)e.renameSignal(r.getName(n),e.getName(t)),r.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(t,a)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function XHe(e,t){const n="width"===t?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const e=i.get("type"),n=i.get("range");if(JBe(e)){const e=I$e(r.view,t);return gBe(n)||F$e(e)?"step":e}return N$e(r.view,t)}if(e.hasProjection||"arc"===e.mark)return N$e(r.view,t);{const e=I$e(r.view,t);return F$e(e)?e.step:e}}function YHe(e,t,n){return uPe(t,Object.assign({suffix:`by_${uPe(e)}`},null!=n?n:{}))}class KHe extends THe{constructor(e,t,n,r){super(e,"facet",t,n,r,e.resolve),this.child=vqe(e.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(e.facet,r)}initFacet(e,t){return zLe(e)?YPe(e,((e,n,r)=>mRe([ANe,FNe],r)?void 0===n.field?(ZIe(BIe(n,r)),e):(e[r]=xPe(n,r,t),e):(ZIe(LIe(r,"facet")),e)),{}):{facet:xPe(e,"facet",t)}}channelHasField(e){return!!this.facet[e]}fieldDef(e){return this.facet[e]}parseData(){this.component.data=ZHe(this),this.child.parseData()}parseLayoutSize(){HHe(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(e){for(const t of mDe)UHe(e,t);VHe(e,"x"),VHe(e,"y")}(this)}assembleSelectionTopLevelSignals(e){return this.child.assembleSelectionTopLevelSignals(e)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(e){return this.child.assembleSelectionData(e)}getHeaderLayoutMixins(){var e,t,n;const r={};for(const i of mDe)for(const o of _We){const a=this.component.layoutHeaders[i],s=a[o],{facetFieldDef:u}=a;if(u){const t=bWe("titleOrient",u,this.config,i);if(mRe(["right","bottom"],t)){const n=yWe(i,t);r.titleAnchor=null!==(e=r.titleAnchor)&&void 0!==e?e:{},r.titleAnchor[n]="end"}}if(null==s?void 0:s[0]){const e="row"===i?"height":"width",s="header"===o?"headerBand":"footerBand";"facet"===i||this.child.component.layoutSize.get(e)||(r[s]=null!==(t=r[s])&&void 0!==t?t:{},r[s][i]=.5),a.title&&(r.offset=null!==(n=r.offset)&&void 0!==n?n:{},r.offset["row"===i?"rowTitle":"columnTitle"]=10)}}return r}assembleDefaultLayout(){const{column:e,row:t}=this.facet,n=e?this.columnDistinctSignal():t?1:void 0;let r="all";return(t||"independent"!==this.component.resolve.scale.x)&&(e||"independent"!==this.component.resolve.scale.y)||(r="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),n?{columns:n}:{}),{bounds:"full",align:r})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof KHe))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroup(e){return this.parent&&this.parent instanceof KHe?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:uPe(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(e)):super.assembleGroup(e)}getCardinalityAggregateForChild(){const e=[],t=[],n=[];if(this.child instanceof KHe){if(this.child.channelHasField("column")){const r=uPe(this.child.facet.column);e.push(r),t.push("distinct"),n.push(`distinct_${r}`)}}else for(const r of YDe){const i=this.child.component.scales[r];if(i&&!i.merged){const o=i.get("type"),a=i.get("range");if(JBe(o)&&gBe(a)){const i=nHe(rHe(this.child,r));i?(e.push(i),t.push("distinct"),n.push(`distinct_${i}`)):ZIe(`Unknown field for ${r}. Cannot calculate view size.`)}}}return{fields:e,ops:t,as:n}}assembleFacet(){const{name:e,data:t}=this.component.data.facetRoot,{row:n,column:r}=this.facet,{fields:i,ops:o,as:a}=this.getCardinalityAggregateForChild(),s=[];for(const e of mDe){const t=this.facet[e];if(t){s.push(uPe(t));const{bin:u,sort:l}=t;if(bIe(u)&&s.push(uPe(t,{binSuffix:"end"})),PLe(l)){const{field:e,op:s=DLe}=l,u=YHe(t,l);n&&r?(i.push(u),o.push("max"),a.push(u)):(i.push(e),o.push(s),a.push(u))}else if(LOe(l)){const n=mWe(t,e);i.push(n),o.push("max"),a.push(n)}}}const u=!!n&&!!r;return Object.assign({name:e,data:t,groupby:s},u||i.length>0?{aggregate:Object.assign(Object.assign({},u?{cross:u}:{}),i.length?{fields:i,ops:o,as:a}:{})}:{})}facetSortFields(e){const{facet:t}=this,n=t[e];return n?PLe(n.sort)?[YHe(n,n.sort,{expr:"datum"})]:LOe(n.sort)?[mWe(n,e,{expr:"datum"})]:[uPe(n,{expr:"datum"})]:[]}facetSortOrder(e){const{facet:t}=this,n=t[e];if(n){const{sort:e}=n;return[(PLe(e)?e.order:!LOe(e)&&e)||"ascending"]}return[]}assembleLabelTitle(){const{facet:e,config:t}=this;if(e.facet)return TWe(e.facet,"facet",t);const n={row:["top","bottom"],column:["left","right"]};for(const r of xWe)if(e[r]){const i=bWe("labelOrient",e[r],t,r);if(mRe(n[r],i))return TWe(e[r],r,t)}}assembleMarks(){const{child:e}=this,t=function(e){const t=[],n=jHe(t);for(const t of e.children)n(t,{source:e.name,name:null,transform:[]});return t}(this.component.data.facetRoot),n=e.assembleGroupEncodeEntry(!1),r=this.assembleLabelTitle()||e.assembleTitle(),i=e.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},r?{title:r}:{}),i?{style:i}:{}),{from:{facet:this.assembleFacet()},sort:{field:mDe.map((e=>this.facetSortFields(e))).flat(),order:mDe.map((e=>this.facetSortOrder(e))).flat()}}),t.length>0?{data:t}:{}),n?{encode:{update:n}}:{}),e.assembleGroup(function(e,t){if(e.component.selection&&CRe(e.component.selection).length){const n=YOe(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:kOe("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return rGe(t)}(this,[])))]}getMapping(){return this.facet}}function JHe(e,t){var n,r,i,o,a,s,u,l,c,p;for(const d of t){const t=d.data;if(!(e.name&&d.hasName()&&e.name!==d.dataName||(null===(n=e.format)||void 0===n?void 0:n.mesh)&&(null===(r=t.format)||void 0===r?void 0:r.feature)||((null===(i=e.format)||void 0===i?void 0:i.feature)||(null===(o=t.format)||void 0===o?void 0:o.feature))&&(null===(a=e.format)||void 0===a?void 0:a.feature)!==(null===(s=t.format)||void 0===s?void 0:s.feature)||((null===(u=e.format)||void 0===u?void 0:u.mesh)||(null===(l=t.format)||void 0===l?void 0:l.mesh))&&(null===(c=e.format)||void 0===c?void 0:c.mesh)!==(null===(p=t.format)||void 0===p?void 0:p.mesh)))if(Eze(e)&&Eze(t)){if(lRe(e.values,t.values))return d}else if(Tze(e)&&Tze(t)){if(e.url===t.url)return d}else if(Aze(e)&&e.name===d.dataName)return d}return null}function ZHe(e){var t,n,r,i,o,a,s,u,l,c;let p=function(e,t){if(e.data||!e.parent){if(null===e.data){const e=new pVe({values:[]});return t.push(e),e}const n=JHe(e.data,t);if(n)return Fze(e.data)||(n.data.format=function(e,...t){for(const n of t)vRe(e,null!=n?n:{});return e}({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const n=new pVe(e.data);return t.push(n),n}}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,f=e.parent?e.parent.component.data.ancestorParse.clone():new Mze,g=e.data;Fze(g)?(Oze(g)?p=new fVe(p,g.sequence):Nze(g)&&(p=new hVe(p,g.graticule)),f.parseNothing=!0):null===(null===(t=null==g?void 0:g.format)||void 0===t?void 0:t.parse)&&(f.parseNothing=!0),p=null!==(n=kVe.makeExplicit(p,e,f))&&void 0!==n?n:p,p=new SVe(p);const m=e.parent&&CHe(e.parent);(wHe(e)||kHe(e))&&m&&(p=null!==(r=cVe.makeFromEncoding(p,e))&&void 0!==r?r:p),e.transforms.length>0&&(p=function(e,t,n){var r,i;let o=0;for(const a of t.transforms){let s,u;if(qze(a))u=e=new gWe(e,a),s="derived";else if(Bze(a)){const i=wVe(a);u=e=null!==(r=kVe.makeWithAncestors(e,{},i,n))&&void 0!==r?r:e,e=new KUe(e,t,a.filter)}else if(Xze(a))u=e=cVe.makeFromTransform(e,a,t),s="number";else if(Kze(a))s="date",void 0===n.getWithExplicit(a.field).value&&(e=new kVe(e,{[a.field]:s}),n.set(a.field,s,!1)),u=e=Oje.makeFromTransform(e,a);else if(Jze(a))u=e=vVe.makeFromTransform(e,a),s="number",yGe(t)&&(e=new SVe(e));else if(Lze(a))u=e=BHe.make(e,t,a,o++),s="derived";else if(Wze(a))u=e=new TVe(e,a),s="number";else if(Vze(a))u=e=new CVe(e,a),s="number";else if(Zze(a))u=e=MVe.makeFromTransform(e,a),s="derived";else if(Qze(a))u=e=new OHe(e,a),s="derived";else if(Hze(a))u=e=new FHe(e,a),s="derived";else if(Pze(a))u=e=new $He(e,a),s="derived";else if(Uze(a))e=new zHe(e,a);else if(Yze(a))u=e=DHe.makeFromTransform(e,a),s="derived";else if($ze(a))u=e=new EHe(e,a),s="derived";else if(zze(a))u=e=new LHe(e,a),s="derived";else if(jze(a))u=e=new PHe(e,a),s="derived";else{if(!Gze(a)){ZIe(`Ignoring an invalid transform: ${hRe(a)}.`);continue}u=e=new IHe(e,a),s="derived"}if(u&&void 0!==s)for(const e of null!==(i=u.producedFields())&&void 0!==i?i:[])n.set(e,s,!1)}return e}(p,e,f));const y=function(e){const t={};if(wHe(e)&&e.component.selection)for(const n of CRe(e.component.selection)){const r=e.component.selection[n];for(const e of r.project.items)!e.channel&&PRe(e.field)>1&&(t[e.field]="flatten")}return t}(e),b=function(e){const t={};function n(e){var n;CPe(e)?t[e.field]="date":"quantitative"===e.type&&XOe(n=e.aggregate)&&mRe(["min","max"],n)?t[e.field]="number":PRe(e.field)>1?e.field in t||(t[e.field]="flatten"):iPe(e)&&PLe(e.sort)&&PRe(e.sort.field)>1&&(e.sort.field in t||(t[e.sort.field]="flatten"))}if((wHe(e)||kHe(e))&&e.forEachFieldDef(((t,r)=>{if(nPe(t))n(t);else{const i=FDe(r),o=e.fieldDef(i);n(Object.assign(Object.assign({},t),{type:o.type}))}})),wHe(e)){const{mark:n,markDef:r,encoding:i}=e;if(pNe(n)&&!e.encoding.order){const e=i["horizontal"===r.orient?"y":"x"];KLe(e)&&"quantitative"===e.type&&!(e.field in t)&&(t[e.field]="number")}}return t}(e);p=null!==(i=kVe.makeWithAncestors(p,{},Object.assign(Object.assign({},y),b),f))&&void 0!==i?i:p,wHe(e)&&(p=RHe.parseAll(p,e),p=NHe.parseAll(p,e)),(wHe(e)||kHe(e))&&(m||(p=null!==(o=cVe.makeFromEncoding(p,e))&&void 0!==o?o:p),p=null!==(a=Oje.makeFromEncoding(p,e))&&void 0!==a?a:p,p=gWe.parseAllForSortIndex(p,e));const v=e.getName(Ize),x=new Fje(p,v,Ize,h);if(d[v]=x,p=x,wHe(e)){const t=vVe.makeFromEncoding(p,e);t&&(p=t,yGe(e)&&(p=new SVe(p))),p=null!==(s=DHe.makeFromEncoding(p,e))&&void 0!==s?s:p,p=null!==(u=MVe.makeFromEncoding(p,e))&&void 0!==u?u:p}wHe(e)&&(p=null!==(l=AHe.make(p,e))&&void 0!==l?l:p);const _=e.getName(Dze),w=new Fje(p,_,Dze,h);d[_]=w,p=w,wHe(e)&&function(e,t){gGe(e,(n=>{const r=n.name,i=e.getName(`lookup_${r}`);e.component.data.outputNodes[i]=n.materialized=new Fje(new KUe(t,e,{selection:r}),i,"lookup",e.component.data.outputNodeRefCounts)}))}(e,w);let k=null;if(kHe(e)){const t=e.getName("facet");p=null!==(c=function(e,t){const{row:n,column:r}=t;if(n&&r){let t=null;for(const i of[n,r])if(PLe(i.sort)){const{field:n,op:r=DLe}=i.sort;e=t=new CVe(e,{joinaggregate:[{op:r,field:n,as:YHe(i,i.sort,{forAs:!0})}],groupby:[uPe(i)]})}return t}return null}(p,e.facet))&&void 0!==c?c:p,k=new xVe(p,e,t,w.getSource()),d[t]=k}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:x,main:w,facetRoot:k,ancestorParse:f})}class QHe extends MHe{constructor(e,t,n,r){var i,o,a,s;super(e,"concat",t,n,r,e.resolve),"shared"!==(null===(o=null===(i=e.resolve)||void 0===i?void 0:i.axis)||void 0===o?void 0:o.x)&&"shared"!==(null===(s=null===(a=e.resolve)||void 0===a?void 0:a.axis)||void 0===s?void 0:s.y)||ZIe("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),this.children=this.getChildren(e).map(((e,t)=>vqe(e,this,this.getName("concat_"+t),void 0,r)))}parseData(){this.component.data=ZHe(this);for(const e of this.children)e.parseData()}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of CRe(e.component.selection))this.component.selection[t]=e.component.selection[t]}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){for(const e of this.children)e.parseAxesAndHeaders()}getChildren(e){return E$e(e)?e.vconcat:A$e(e)?e.hconcat:e.concat}parseLayoutSize(){!function(e){HHe(e);const t=1===e.layout.columns?"width":"childWidth",n=void 0===e.layout.columns?"height":"childHeight";qHe(e,t),qHe(e,n)}(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(e){return this.children.reduce(((e,t)=>t.assembleSelectionTopLevelSignals(e)),e)}assembleSignals(){return this.children.forEach((e=>e.assembleSignals())),[]}assembleLayoutSignals(){const e=RWe(this);for(const t of this.children)e.push(...t.assembleLayoutSignals());return e}assembleSelectionData(e){return this.children.reduce(((e,t)=>t.assembleSelectionData(e)),e)}assembleMarks(){return this.children.map((e=>{const t=e.assembleTitle(),n=e.assembleGroupStyle(),r=e.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:e.getName("group")},t?{title:t}:{}),n?{style:n}:{}),r?{encode:{update:r}}:{}),e.assembleGroup())}))}assembleDefaultLayout(){const e=this.layout.columns;return Object.assign(Object.assign({},null!=e?{columns:e}:{}),{bounds:"full",align:"each"})}}const eqe=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},qRe),{labelExpr:1,encode:1}),tqe=CRe(eqe);class nqe extends xze{constructor(e={},t={},n=!1){super(),this.explicit=e,this.implicit=t,this.mainExtracted=n}clone(){return new nqe(cRe(this.explicit),cRe(this.implicit),this.mainExtracted)}hasAxisPart(e){return!("axis"!==e&&("grid"===e||"title"===e?!this.get(e):!1===(t=this.get(e))||null===t));var t}hasOrientSignalRef(){return fBe(this.explicit.orient)}}const rqe={bottom:"top",top:"bottom",left:"right",right:"left"};function iqe(e,t){if(!e)return t.map((e=>e.clone()));{if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const n=e[r],i=t[r];if(!!n!=!!i)return;if(n&&i){const t=n.getWithExplicit("orient"),o=i.getWithExplicit("orient");if(t.explicit&&o.explicit&&t.value!==o.value)return;e[r]=oqe(n,i)}}}return e}function oqe(e,t){for(const n of tqe){const r=Cze(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",((e,t)=>{switch(n){case"title":return GPe(e,t);case"gridScale":return{explicit:e.explicit,value:$Re(e.value,t.value)}}return Sze(e,t,n,"axis")}));e.setWithExplicit(n,r)}return e}function aqe(e,t,n,r,i){if("disable"===t)return void 0!==n;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(fBe(n.labelAngle)?n.labelAngle:jRe(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===fWe(r,i))return!0}return e===n[t]}const sqe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function uqe(e,t){var n,r,i;let o=t.axis(e);const a=new nqe,s=vPe(t.encoding[e]),{mark:u,config:l}=t,c=(null==o?void 0:o.orient)||(null===(n=l["x"===e?"axisX":"axisY"])||void 0===n?void 0:n.orient)||(null===(r=l.axis)||void 0===r?void 0:r.orient)||function(e){return"x"===e?"bottom":"left"}(e),p=t.getScaleComponent(e).get("type"),d=function(e,t,n,r){const i="band"===t?["axisDiscrete","axisBand"]:"point"===t?["axisDiscrete","axisPoint"]:t in qBe?["axisQuantitative"]:"time"===t||"utc"===t?["axisTemporal"]:[],o="x"===e?"axisX":"axisY",a=fBe(n)?"axisOrient":"axis"+RRe(n),s=[...i,...i.map((e=>o+e.substr(4)))],u=["axis",a,o];return{vlOnlyAxisConfig:sWe(s,r,e,n),vgAxisConfig:sWe(u,r,e,n),axisConfigStyle:uWe([...u,...s],r)}}(e,p,c,t.config),h=void 0!==o?!o:lWe("disable",l,null==o?void 0:o.style,d).configValue;if(a.set("disable",h,void 0!==o),h)return a;o=o||{};const f=function(e,t,n,r,i){const o=null==t?void 0:t.labelAngle;if(void 0!==o)return fBe(o)?o:jRe(o);{const{configValue:o}=lWe("labelAngle",e.config,null==t?void 0:t.style,i);return void 0!==o?jRe(o):n===RNe&&mRe([BBe,DBe],r.type)?270:void 0}}(t,o,e,s,d),g={fieldOrDatumDef:s,axis:o,channel:e,model:t,scaleType:p,orient:c,labelAngle:f,mark:u,config:l};for(const n of tqe){const r=n in cWe?cWe[n](g):YRe(n)?o[n]:void 0,i=void 0!==r,s=aqe(r,n,o,t,e);if(i&&s)a.set(n,r,s);else{const{configValue:e,configFrom:u}=YRe(n)&&"values"!==n?lWe(n,t.config,o.style,d):{},l=void 0!==e;i&&!l?a.set(n,r,s):("vgAxisConfig"!==u||sqe.has(n)&&l||WRe(e)||fBe(e))&&a.set(n,e,!1)}}const m=null!==(i=o.encoding)&&void 0!==i?i:{},y=VRe.reduce(((n,r)=>{var i;if(!a.hasAxisPart(r))return n;const o=LWe(null!==(i=m[r])&&void 0!==i?i:{},t),s="labels"===r?function(e,t,n){var r;const{encoding:i,config:o}=e,a=null!==(r=vPe(i[t]))&&void 0!==r?r:vPe(i[RDe(t)]),s=e.axis(t)||{},{format:u,formatType:l}=s;return wLe(l)?Object.assign({text:TLe({fieldOrDatumDef:a,field:"datum.value",format:u,formatType:l,config:o})},n):n}(t,e,o):o;return void 0===s||SRe(s)||(n[r]={update:s}),n}),{});return SRe(y)||a.set("encode",y,!!o.encoding||void 0!==o.labelAngle),a}function lqe(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},wje(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),lje("x",e,{defaultPos:"mid"})),lje("y",e,{defaultPos:"mid"})),aje("size",e)),aje("angle",e)),function(e,t,n){return n?{shape:{value:n}}:aje("shape",e)}(e,0,t))}const cqe={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},wje(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),fje("x",e,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n})),fje("y",e,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n})),aje("size",e,{vgChannel:"strokeWidth"})):{}}},pqe={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i="horizontal"===r?"width":"height",o="horizontal"===r?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},wje(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),lje("x",e,{defaultPos:"mid",vgChannel:"xc"})),lje("y",e,{defaultPos:"mid",vgChannel:"yc"})),aje("size",e,{defaultValue:dqe(e),vgChannel:i})),{[o]:OPe(IPe("thickness",n,t))})}};function dqe(e){var t;const{config:n,markDef:r}=e,{orient:i}=r,o="horizontal"===i?"width":"height",a=e.getScaleComponent("horizontal"===i?"x":"y"),s=null!==(t=IPe("size",r,n,{vgChannel:o}))&&void 0!==t?t:n.tick.bandSize;if(void 0!==s)return s;{const e=a?a.get("range"):void 0;return e&&gBe(e)&&qOe(e.step)?3*e.step/4:3*D$e(n.view,o)/4}}const hqe={arc:{vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},wje(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),lje("x",e,{defaultPos:"mid"})),lje("y",e,{defaultPos:"mid"})),yje(e,"radius","arc")),yje(e,"theta","arc"))},area:{vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},wje(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),fje("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===e.markDef.orient})),fje("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===e.markDef.orient})),Sje(e))},bar:{vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},wje(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),yje(e,"x","bar")),yje(e,"y","bar"))},circle:{vgMark:"symbol",encodeEntry:e=>lqe(e,"circle")},geoshape:{vgMark:"shape",encodeEntry:e=>Object.assign({},wje(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&KLe(n)&&n.type===LBe?{field:uPe(n,{expr:"datum"})}:{})]}},image:{vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},wje(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),yje(e,"x","image")),yje(e,"y","image")),tje(e,"url"))},line:{vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},wje(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),lje("x",e,{defaultPos:"mid"})),lje("y",e,{defaultPos:"mid"})),aje("size",e,{vgChannel:"strokeWidth"})),Sje(e))},point:{vgMark:"symbol",encodeEntry:e=>lqe(e)},rect:{vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},wje(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),yje(e,"x","rect")),yje(e,"y","rect"))},rule:cqe,square:{vgMark:"symbol",encodeEntry:e=>lqe(e,"square")},text:{vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},wje(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),lje("x",e,{defaultPos:"mid"})),lje("y",e,{defaultPos:"mid"})),tje(e)),aje("size",e,{vgChannel:"fontSize"})),aje("angle",e)),Cje("align",function(e,t,n){if(void 0===IPe("align",e,n))return"center"}(e.markDef,0,t))),Cje("baseline",function(e,t,n){if(void 0===IPe("baseline",e,n))return"middle"}(e.markDef,0,t))),lje("radius",e,{defaultPos:null,isMidPoint:!0})),lje("theta",e,{defaultPos:null,isMidPoint:!0}))}},tick:pqe,trail:{vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},wje(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),lje("x",e,{defaultPos:"mid"})),lje("y",e,{defaultPos:"mid"})),aje("size",e)),Sje(e))}};const fqe="faceted_path_",gqe="stack_group_";function mqe(e,t={fromPrefix:""}){const{mark:n,markDef:r,config:i}=e,o=$Re(r.clip,function(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!!(t&&t.get("selectionExtent")||n&&n.get("selectionExtent"))||void 0}(e),function(e){const t=e.component.projection;return!(!t||t.isFit)||void 0}(e)),a=DPe(r),s=e.encoding.key,u=function(e){const{encoding:t,stack:n,mark:r,markDef:i,config:o}=e,a=t.order;if(!(!LOe(a)&&rPe(a)&&gRe(a.value)||!a&&gRe(IPe("order",i,o)))){if((LOe(a)||KLe(a))&&!n)return $Pe(a,{expr:"datum"});if(pNe(r)){const n="horizontal"===i.orient?"y":"x",r=t[n];if(KLe(r)){const t=r.sort;return LOe(t)?{field:uPe(r,{prefix:n,suffix:"sort_index",expr:"datum"})}:PLe(t)?{field:uPe({aggregate:WPe(e.encoding)?t.op:void 0,field:t.field},{expr:"datum"})}:LLe(t)?{field:uPe(e.fieldDef(t.encoding),{expr:"datum"}),order:t.order}:null===t?void 0:{field:uPe(r,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}}}}(e),l=function(e){if(!e.component.selection)return null;const t=CRe(e.component.selection).length;let n=t,r=e.parent;for(;r&&0===n;)n=CRe(r.component.selection).length,r=r.parent;return n?{interactive:t>0}:null}(e),c=IPe("aria",r,i),p=hqe[n].postEncodingTransform?hqe[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:hqe[n].vgMark},o?{clip:!0}:{}),a?{style:a}:{}),s?{key:s.field}:{}),u?{sort:u}:{}),l||{}),!1===c?{aria:c}:{}),{from:{data:t.fromPrefix+e.requestDataName(Dze)},encode:{update:hqe[n].encodeEntry(e)}}),p?{transform:p}:{})]}class yqe extends THe{constructor(e,t,n,r={},i){var o,a;super(e,"unit",t,n,i,void 0,O$e(e)?e.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const s=fNe(e.mark)?e.mark.type:e.mark;this.markDef=function(e,t,n,{graticule:r}){const i=fNe(e)?Object.assign({},e):{type:e},o=IPe("orient",i,n);if(i.orient=function(e,t,n){switch(e){case nNe:case uNe:case lNe:case oNe:case rNe:case eNe:return}const{x:r,y:i,x2:o,y2:a}=t;switch(e){case QRe:if(KLe(r)&&(vIe(r.bin)||KLe(i)&&i.aggregate&&!r.aggregate))return"vertical";if(KLe(i)&&(vIe(i.bin)||KLe(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(a||o){if(n)return n;if(!o&&(KLe(r)&&r.type===NBe&&!bIe(r.bin)||ePe(r)))return"horizontal";if(!a&&(KLe(i)&&i.type===NBe&&!bIe(i.bin)||ePe(i)))return"vertical"}case iNe:if(o&&(!KLe(r)||!vIe(r.bin))&&a&&(!KLe(i)||!vIe(i.bin)))return;case ZRe:if(a)return KLe(i)&&vIe(i.bin)?"horizontal":"vertical";if(o)return KLe(r)&&vIe(r.bin)?"vertical":"horizontal";if(e===iNe){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case tNe:case aNe:{const t=QLe(r),o=QLe(i);if(t&&!o)return"tick"!==e?"horizontal":"vertical";if(!t&&o)return"tick"!==e?"vertical":"horizontal";if(t&&o){const t=r,o=i,a=t.type===IBe,s=o.type===IBe;return a&&!s?"tick"!==e?"vertical":"horizontal":!a&&s?"tick"!==e?"horizontal":"vertical":!t.aggregate&&o.aggregate?"tick"!==e?"vertical":"horizontal":t.aggregate&&!o.aggregate?"tick"!==e?"horizontal":"vertical":n||"vertical"}return n||void 0}}return"vertical"}(i.type,t,o),void 0!==o&&o!==i.orient&&ZIe(`Specified orient "${i.orient}" overridden with "${o}".`),"bar"===i.type&&i.orient){const e=IPe("cornerRadiusEnd",i,n);if(void 0!==e){const n="horizontal"===i.orient&&t.x2||"vertical"===i.orient&&t.y2?["cornerRadius"]:yNe[i.orient];for(const t of n)i[t]=e;void 0!==i.cornerRadiusEnd&&delete i.cornerRadiusEnd}}return void 0===IPe("opacity",i,n)&&(i.opacity=function(e,t){if(mRe([nNe,aNe,uNe,lNe],e)&&!WPe(t))return.7}(i.type,t)),void 0===i.filled&&(i.filled=!r&&function(e,t){const n=BPe("filled",e,t),r=e.type;return $Re(n,r!==nNe&&r!==tNe&&r!==iNe)}(i,n)),void 0===IPe("cursor",i,n)&&(i.cursor=function(e,t,n){return t.href||e.href||IPe("href",e,n)?"pointer":e.cursor}(i,t,n)),i}(e.mark,null!==(o=e.encoding)&&void 0!==o?o:{},i,{graticule:e.data&&Nze(e.data)});const u=this.encoding=HPe(null!==(a=e.encoding)&&void 0!==a?a:{},this.markDef,i);this.size=function({encoding:e,size:t}){for(const n of YDe){const r=NDe(n);F$e(t[r])&&QLe(e[n])&&(delete t[r],ZIe(WIe(r)))}return t}({encoding:u,size:O$e(e)?Object.assign(Object.assign(Object.assign({},r),e.width?{width:e.width}:{}),e.height?{height:e.height}:{}):r}),this.stack=Z$e(s,u),this.specifiedScales=this.initScales(s,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegend(u),this.specifiedProjection=e.projection,this.selection=e.selection}get hasProjection(){const{encoding:e}=this,t=this.mark===cNe,n=e&&dDe.some((t=>tPe(e[t])));return t||n}scaleDomain(e){const t=this.specifiedScales[e];return t?t.domain:void 0}axis(e){return this.specifiedAxes[e]}legend(e){return this.specifiedLegends[e]}initScales(e,t){return pIe.reduce(((e,n)=>{var r;const i=vPe(t[n]);return i&&(e[n]=null!==(r=i.scale)&&void 0!==r?r:{}),e}),{})}initAxes(e){return YDe.reduce(((t,n)=>{const r=e[n];if(tPe(r)||n===RNe&&tPe(e.x2)||n===NNe&&tPe(e.y2)){const e=tPe(r)?r.axis:void 0;t[n]=e?Object.assign({},e):e}return t}),{})}initLegend(e){return lIe.reduce(((t,n)=>{const r=vPe(e[n]);if(r&&function(e){switch(e){case WNe:case VNe:case HNe:case XNe:case qNe:case KNe:case QNe:case eDe:return!0;case JNe:case ZNe:case YNe:return!1}}(n)){const e=r.legend;t[n]=e?Object.assign({},e):e}return t}),{})}parseData(){this.component.data=ZHe(this)}parseLayoutSize(){!function(e){const{size:t,component:n}=e;for(const r of YDe){const i=NDe(r);if(t[i]){const e=t[i];n.layoutSize.set(i,F$e(e)?"step":e,!0)}else{const t=XHe(e,i);n.layoutSize.set(i,t,!1)}}}(this)}parseSelections(){this.component.selection=function(e,t){var n;const r={},i=e.config.selection;for(const o of CRe(null!=t?t:{})){const a=cRe(t[o]),s=i[a.type],{fields:u,encodings:l}=s,c=JOe(s,["fields","encodings"]);for(const e in c)"encodings"===e&&a.fields||"fields"===e&&a.encodings||("mark"===e&&(a[e]=Object.assign(Object.assign({},c[e]),a[e])),void 0!==a[e]&&!0!==a[e]||(a[e]=null!==(n=c[e])&&void 0!==n?n:a[e]));const p=ARe(o),d=r[p]=Object.assign(Object.assign({},a),{name:p,events:XOe(a.on)?kOe(a.on,"scope"):cRe(a.on)});eGe(d,(n=>{n.has(d)&&n.parse&&n.parse(e,d,a,t[o])}))}return r}(this,this.selection)}parseMarkGroup(){var e;this.component.mark=mRe([tNe,ZRe,sNe],(e=this).mark)?function(e){const t=KPe(e.mark,e.encoding),n=mqe(e,{fromPrefix:t.length>0?fqe:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:fqe+e.requestDataName(Dze),data:e.requestDataName(Dze),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}(e):mRe([QRe],e.mark)?function(e){const t=vBe.some((t=>IPe(t,e.markDef,e.config)));if(e.stack&&!e.fieldDef("size")&&t){const[t]=mqe(e,{fromPrefix:gqe}),n=e.scaleName(e.stack.fieldChannel),r=(t={})=>e.vgField(e.stack.fieldChannel,t),i=(e,t)=>`${e}(${[r({prefix:"min",suffix:"start",expr:t}),r({prefix:"max",suffix:"start",expr:t}),r({prefix:"min",suffix:"end",expr:t}),r({prefix:"max",suffix:"end",expr:t})].map((e=>`scale('${n}',${e})`)).join(",")})`;let o,a;"x"===e.stack.fieldChannel?(o=Object.assign(Object.assign({},pRe(t.encode.update,["y","yc","y2","height",...vBe])),{x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}}),a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update=Object.assign(Object.assign({},dRe(t.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},pRe(t.encode.update,["x","xc","x2","width"])),{y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}}),a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update=Object.assign(Object.assign({},dRe(t.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const n of vBe){const r=BPe(n,e.markDef,e.config);t.encode.update[n]?(o[n]=t.encode.update[n],delete t.encode.update[n]):r&&(o[n]=OPe(r)),r&&(t.encode.update[n]={value:0})}const s=e.fieldDef(e.stack.groupbyChannel),u=uPe(s)?[uPe(s)]:[];return((null==s?void 0:s.bin)||(null==s?void 0:s.timeUnit))&&u.push(uPe(s,{binSuffix:"end"})),o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce(((n,r)=>{if(t.encode.update[r])return Object.assign(Object.assign({},n),{[r]:t.encode.update[r]});{const t=BPe(r,e.markDef,e.config);return void 0!==t?Object.assign(Object.assign({},n),{[r]:OPe(t)}):n}}),o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(Dze),name:gqe+e.requestDataName(Dze),groupby:u,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:a},marks:[t]}]}]}return mqe(e)}(e):mqe(e)}parseAxesAndHeaders(){var e;this.component.axes=(e=this,YDe.reduce(((t,n)=>(e.component.scales[n]&&(t[n]=[uqe(n,e)]),t)),{}))}assembleSelectionTopLevelSignals(e){return function(e,t){let n=!1;if(gGe(e,((r,i)=>{const o=r.name,a=YOe(o+pGe);if(0===t.filter((e=>e.name===o)).length){const e="global"===r.resolve?"union":r.resolve,n="multi"===r.type?", true)":")";t.push({name:r.name,update:`${hGe}(${a}, ${YOe(e)}${n}`})}n=!0,i.topLevelSignals&&(t=i.topLevelSignals(e,r,t)),eGe(r,(n=>{n.topLevelSignals&&(t=n.topLevelSignals(e,r,t))}))})),n){0===t.filter((e=>"unit"===e.name)).length&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})}return rGe(t)}(this,e)}assembleSignals(){return[...nWe(this),...(e=this,t=[],gGe(e,((n,r)=>{const i=n.name;let o=r.modifyExpr(e,n);t.push(...r.signals(e,n)),eGe(n,(r=>{r.signals&&(t=r.signals(e,n,t)),r.modifyExpr&&(o=r.modifyExpr(e,n,o))})),t.push({name:i+"_modify",on:[{events:{signal:n.name+dGe},update:`modify(${YOe(n.name+pGe)}, ${o})`}]})})),rGe(t))];var e,t}assembleSelectionData(e){return function(e,t){const n=[...t];return gGe(e,(t=>{const r={name:t.name+pGe};if(t.init){const n=t.project.items.map((e=>{const{signals:t}=e;return JOe(e,["signals"])})),i=t.init.map((e=>tGe(e,!1)));r.values="interval"===t.type?[{unit:mGe(e,{escape:!1}),fields:n,values:i}]:i.map((t=>({unit:mGe(e,{escape:!1}),fields:n,values:t})))}n.filter((e=>e.name===t.name+pGe)).length||n.push(r)})),n}(this,e)}assembleLayout(){return null}assembleLayoutSignals(){return RWe(this)}assembleMarks(){var e;let t=null!==(e=this.component.mark)&&void 0!==e?e:[];return this.parent&&CHe(this.parent)||(t=nGe(this,t)),t.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(e){return UPe(this.encoding,e)}fieldDef(e){return bPe(this.encoding[e])}typedFieldDef(e){const t=this.fieldDef(e);return nPe(t)?t:null}}class bqe extends MHe{constructor(e,t,n,r,i){super(e,"layer",t,n,i,e.resolve,e.view);const o=Object.assign(Object.assign(Object.assign({},r),e.width?{width:e.width}:{}),e.height?{height:e.height}:{});this.children=e.layer.map(((e,t)=>{if(H$e(e))return new bqe(e,this,this.getName("layer_"+t),o,i);if(bNe(e))return new yqe(e,this,this.getName("layer_"+t),o,i);throw new Error(kIe(e))}))}parseData(){this.component.data=ZHe(this);for(const e of this.children)e.parseData()}parseLayoutSize(){HHe(this),qHe(this,"width"),qHe(this,"height")}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of CRe(e.component.selection))this.component.selection[t]=e.component.selection[t]}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){!function(e){var t;const{axes:n,resolve:r}=e.component,i={top:0,bottom:0,right:0,left:0};for(const t of e.children){t.parseAxesAndHeaders();for(const i of CRe(t.component.axes))r.axis[i]=$We(e.component.resolve,i),"shared"===r.axis[i]&&(n[i]=iqe(n[i],t.component.axes[i]),n[i]||(r.axis[i]="independent",delete n[i]))}for(const o of YDe){for(const a of e.children)if(a.component.axes[o]){if("independent"===r.axis[o]){n[o]=(null!==(t=n[o])&&void 0!==t?t:[]).concat(a.component.axes[o]);for(const e of a.component.axes[o]){const{value:t,explicit:n}=e.getWithExplicit("orient");if(!fBe(t)){if(i[t]>0&&!n){const n=rqe[t];i[t]>i[n]&&e.set("orient",n,!1)}i[t]++}}}delete a.component.axes[o]}if("independent"===r.axis[o]&&n[o]&&n[o].length>1)for(const e of n[o])e.get("grid")&&!e.explicit.grid&&(e.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(e){return this.children.reduce(((e,t)=>t.assembleSelectionTopLevelSignals(e)),e)}assembleSignals(){return this.children.reduce(((e,t)=>e.concat(t.assembleSignals())),nWe(this))}assembleLayoutSignals(){return this.children.reduce(((e,t)=>e.concat(t.assembleLayoutSignals())),RWe(this))}assembleSelectionData(e){return this.children.reduce(((e,t)=>t.assembleSelectionData(e)),e)}assembleTitle(){let e=super.assembleTitle();if(e)return e;for(const t of this.children)if(e=t.assembleTitle(),e)return e}assembleLayout(){return null}assembleMarks(){return function(e,t){for(const n of e.children)wHe(n)&&(t=nGe(n,t));return t}(this,this.children.flatMap((e=>e.assembleMarks())))}assembleLegends(){return this.children.reduce(((e,t)=>e.concat(t.assembleLegends())),nVe(this))}}function vqe(e,t,n,r,i){if(GLe(e))return new KHe(e,t,n,i);if(H$e(e))return new bqe(e,t,n,r,i);if(bNe(e))return new yqe(e,t,n,r,i);if(function(e){return E$e(e)||A$e(e)||T$e(e)}(e))return new QHe(e,t,n,i);throw new Error(kIe(e))}function xqe(e,t={}){var n;t.logger&&(n=t.logger,JIe=n),t.fieldTitle&&hPe(t.fieldTitle);try{const n=j$e(zOe(t.config,e.config)),r=gze(e,n),i=vqe(r,null,"",void 0,n);i.parse(),function(e,t){dVe(e.sources);let n=0,r=0;for(let r=0;r<GVe&&HVe(e,t);r++)n++;e.sources.map(NVe);for(let n=0;n<GVe&&HVe(e,t);n++)r++;dVe(e.sources),Math.max(n,r)===GVe&&ZIe(`Maximum optimization runs(${GVe}) reached.`)}(i.component.data,i);const o=function(e,t,n={},r){const i=e.config?function(e){e=cRe(e);for(const t of U$e)delete e[t];if(e.axis)for(const t in e.axis)WRe(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of v$e)delete e.legend[t];if(e.mark){for(const t of mNe)delete e.mark[t];e.mark.tooltip&&POe(e.mark.tooltip)&&delete e.mark.tooltip}for(const t of G$e){for(const n of mNe)delete e[t][n];const n=W$e[t];if(n)for(const r of n)delete e[t][r];V$e(e,t)}for(const t of CRe(y$e))delete e[t];!function(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=APe(e.title);SRe(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),SRe(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),SRe(r)?delete e.title:e.title=r}(e);for(const t in e)POe(e[t])&&SRe(e[t])&&delete e[t];return SRe(e)?void 0:e}(e.config):void 0,o=[].concat(e.assembleSelectionData([]),function(e,t){var n,r;const i=[],o=jHe(i);let a=0;for(const t of e.sources){t.hasName()||(t.dataName="source_"+a++);const e=t.assemble();o(t,e)}for(const e of i)0===e.transform.length&&delete e.transform;let s=0;for(const[e,t]of i.entries())0!==(null!==(n=t.transform)&&void 0!==n?n:[]).length||t.source||i.splice(s++,0,i.splice(e,1)[0]);for(const t of i)for(const n of null!==(r=t.transform)&&void 0!==r?r:[])"lookup"===n.type&&(n.from=e.outputNodes[n.from].getSource());for(const e of i)e.name in t&&(e.values=t[e.name]);return i}(e.component.data,n)),a=e.assembleProjections(),s=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();return c=c.filter((e=>"width"!==e.name&&"height"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1))),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),s?{title:s}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:o}),a.length>0?{projections:a}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([])])),i?{config:i}:{}),r?{usermeta:r}:{})}(i,function(e,t,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(void 0===t?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):XOe(t)&&(t={type:t}),i&&o&&("fit"===(a=t.type)||"fit-x"===a||"fit-y"===a))if("step"===i&&"step"===o)ZIe(TIe()),t.type="pad";else if("step"===i||"step"===o){const e="step"===i?"width":"height";ZIe(TIe(QDe(e)));const n="width"===e?"height":"width";t.type=function(e){return e?`fit-${QDe(e)}`:"fit"}(n)}var a;return Object.assign(Object.assign(Object.assign({},1===CRe(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t}),vze(n)),vze(e))}(e,r.autosize,n,i),e.datasets,e.usermeta);return{spec:o,normalized:r}}finally{t.logger&&(JIe=YIe),t.fieldTitle&&hPe(pPe)}}const _qe=new class extends q$e{mapUnit(e,{config:t}){if(e.encoding){const{encoding:n,transform:r}=e,{bins:i,timeUnits:o,aggregate:a,groupby:s,encoding:u}=VPe(n,t),l=[...r||[],...i,...o,...0===a.length?[]:[{aggregate:a,groupby:s}]];return Object.assign(Object.assign(Object.assign({},e),l.length>0?{transform:l}:{}),{encoding:u})}return e}};function wqe(e,t){return _qe.map(e,{config:t})}const kqe="4.13.1",Sqe=function(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}};const Cqe="#fff",Mqe="#888",Tqe={background:"#333",view:{stroke:Mqe},title:{color:Cqe,subtitleColor:Cqe},style:{"guide-label":{fill:Cqe},"guide-title":{fill:Cqe}},axis:{domainColor:Cqe,gridColor:Mqe,tickColor:Cqe}},Eqe="#4572a7",Aqe={background:"#fff",arc:{fill:Eqe},area:{fill:Eqe},line:{stroke:Eqe,strokeWidth:2},path:{stroke:Eqe},rect:{fill:Eqe},shape:{stroke:Eqe},symbol:{fill:Eqe,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Fqe="#30a2da",Oqe="#cbcbcb",Rqe="#f0f0f0",Nqe="#333",Dqe={arc:{fill:Fqe},area:{fill:Fqe},axis:{domainColor:Oqe,grid:!0,gridColor:Oqe,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:Oqe,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:Rqe,group:{fill:Rqe},legend:{labelColor:Nqe,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:Nqe,titleFontSize:14,titlePadding:10},line:{stroke:Fqe,strokeWidth:2},path:{stroke:Fqe,strokeWidth:.5},rect:{fill:Fqe},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Fqe},bar:{binSpacing:2,fill:Fqe,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Iqe="#000",Bqe={group:{fill:"#e5e5e5"},arc:{fill:Iqe},area:{fill:Iqe},line:{stroke:Iqe},path:{stroke:Iqe},rect:{fill:Iqe},shape:{stroke:Iqe},symbol:{fill:Iqe,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},Lqe="Benton Gothic, sans-serif",Pqe="#82c6df",$qe="Benton Gothic Bold, sans-serif",zqe="normal",jqe={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},Gqe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:$qe,fontSize:22,fontWeight:"normal"},arc:{fill:Pqe},area:{fill:Pqe},line:{stroke:Pqe,strokeWidth:2},path:{stroke:Pqe},rect:{fill:Pqe},shape:{stroke:Pqe},symbol:{fill:Pqe,size:30},axis:{labelFont:Lqe,labelFontSize:11.5,labelFontWeight:"normal",titleFont:$qe,titleFontSize:13,titleFontWeight:zqe},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:Lqe,labelFontSize:11.5,symbolType:"square",titleFont:$qe,titleFontSize:13,titleFontWeight:zqe},range:{category:jqe["category-6"],diverging:jqe["fireandice-6"],heatmap:jqe["fire-7"],ordinal:jqe["fire-7"],ramp:jqe["fire-7"]}},Uqe="#ab5787",Wqe="#979797",Vqe={background:"#f9f9f9",arc:{fill:Uqe},area:{fill:Uqe},line:{stroke:Uqe},path:{stroke:Uqe},rect:{fill:Uqe},shape:{stroke:Uqe},symbol:{fill:Uqe,size:30},axis:{domainColor:Wqe,domainWidth:.5,gridWidth:.2,labelColor:Wqe,tickColor:Wqe,tickWidth:.2,titleColor:Wqe},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Hqe="#3e5c69",qqe={background:"#fff",arc:{fill:Hqe},area:{fill:Hqe},line:{stroke:Hqe},path:{stroke:Hqe},rect:{fill:Hqe},shape:{stroke:Hqe},symbol:{fill:Hqe},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Xqe="#1696d2",Yqe="#000000",Kqe="Lato",Jqe="Lato",Zqe={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},Qqe={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:Kqe},axisX:{domain:!0,domainColor:Yqe,domainWidth:1,grid:!1,labelFontSize:12,labelFont:Jqe,labelAngle:0,tickColor:Yqe,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Kqe},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:Jqe,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Kqe,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:Jqe,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Kqe,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Zqe["six-groups-cat-1"],diverging:Zqe["diverging-colors"],heatmap:Zqe["diverging-colors"],ordinal:Zqe["six-groups-seq"],ramp:Zqe["shades-blue"]},area:{fill:Xqe},rect:{fill:Xqe},line:{color:Xqe,stroke:Xqe,strokeWidth:5},trail:{color:Xqe,stroke:Xqe,strokeWidth:0,size:1},path:{stroke:Xqe,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:Xqe,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Xqe,stroke:null}},arc:{fill:Xqe},shape:{stroke:Xqe},symbol:{fill:Xqe,size:30}},eXe="#3366CC",tXe="#ccc",nXe="Arial, sans-serif",rXe={arc:{fill:eXe},area:{fill:eXe},path:{stroke:eXe},rect:{fill:eXe},shape:{stroke:eXe},symbol:{stroke:eXe},circle:{fill:eXe},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:nXe,fontSize:12},"guide-title":{font:nXe,fontSize:12},"group-title":{font:nXe,fontSize:12}},title:{font:nXe,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:tXe,tickColor:tXe,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},iXe=e=>e*(1/3+1),oXe=iXe(9),aXe=iXe(10),sXe=iXe(12),uXe="Segoe UI",lXe="wf_standard-font, helvetica, arial, sans-serif",cXe="#252423",pXe="#605E5C",dXe="transparent",hXe="#118DFF",fXe="#DEEFFF",gXe=[fXe,hXe],mXe={view:{stroke:dXe},background:dXe,font:uXe,header:{titleFont:lXe,titleFontSize:sXe,titleColor:cXe,labelFont:uXe,labelFontSize:aXe,labelColor:pXe},axis:{ticks:!1,grid:!1,domain:!1,labelColor:pXe,labelFontSize:oXe,titleFont:lXe,titleColor:cXe,titleFontSize:sXe,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:"#C8C6C4",gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:hXe},line:{stroke:hXe,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:uXe,fontSize:oXe,fill:pXe},arc:{fill:hXe},area:{fill:hXe,line:!0,opacity:.6},path:{stroke:hXe},rect:{fill:hXe},point:{fill:hXe,filled:!0,size:75},shape:{stroke:hXe},symbol:{fill:hXe,strokeWidth:1.5,size:50},legend:{titleFont:uXe,titleFontWeight:"bold",titleColor:pXe,labelFont:uXe,labelFontSize:aXe,labelColor:pXe,symbolType:"circle",symbolSize:75},range:{category:[hXe,"#12239E","#E66C37","#6B007B","#E044A7","#744EC2","#D9B300","#D64550"],diverging:gXe,heatmap:gXe,ordinal:[fXe,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",hXe]}},yXe='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',bXe=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],vXe=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function xXe({type:e,background:t}){const n="dark"===e?"#161616":"#ffffff",r="dark"===e?"#f4f4f4":"#161616",i="dark"===e?"#d4bbff":"#6929c4";return{background:t,arc:{fill:i},area:{fill:i},path:{stroke:i},rect:{fill:i},shape:{stroke:i},symbol:{stroke:i},circle:{fill:i},view:{fill:n,stroke:n},group:{fill:n},title:{color:r,anchor:"start",dy:-15,fontSize:16,font:yXe,fontWeight:600},axis:{labelColor:r,labelFontSize:12,grid:!0,gridColor:"#525252",titleColor:r,labelAngle:0},style:{"guide-label":{font:yXe,fill:r,fontWeight:400},"guide-title":{font:yXe,fill:r,fontWeight:400}},range:{category:"dark"===e?bXe:vXe,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const _Xe=xXe({type:"light",background:"#ffffff"}),wXe=xXe({type:"light",background:"#f4f4f4"}),kXe=xXe({type:"dark",background:"#262626"}),SXe=xXe({type:"dark",background:"#161616"}),CXe="2.14.0";const MXe="vg-tooltip-element",TXe={offsetX:10,offsetY:10,id:MXe,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2};function EXe(e,t){return JSON.stringify(e,function(e){const t=[];return function(n,r){if("object"!=typeof r||null===r)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}(t))}class AXe{constructor(e){this.options=Object.assign(Object.assign({},TXe),e);const t=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const e=document.createElement("style");e.setAttribute("id",this.options.styleId),e.innerHTML=function(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return"#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element img {\n    max-width: 200px;\n    max-height: 200px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n".toString().replace(MXe,e)}(t);const n=document.head;n.childNodes.length>0?n.insertBefore(e,n.childNodes[0]):n.appendChild(e)}}tooltipHandler(e,t,n,r){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(null!=document.fullscreenElement?document.fullscreenElement:document.body).appendChild(this.el),null==r||""===r)return void this.el.classList.remove("visible",`${this.options.theme}-theme`);this.el.innerHTML=function(e,t,n){if(sn(e))return`[${e.map((e=>t(Vn(e)?e:EXe(e,n)))).join(", ")}]`;if(un(e)){let r="";const i=e,{title:o,image:a}=i,s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(i,["title","image"]);o&&(r+=`<h2>${t(o)}</h2>`),a&&(r+=`<img src="${t(a)}">`);const u=Object.keys(s);if(u.length>0){r+="<table>";for(const e of u){let i=s[e];void 0!==i&&(un(i)&&(i=EXe(i,n)),r+=`<tr><td class="key">${t(e)}:</td><td class="value">${t(i)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:i,y:o}=function(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let o=e.clientY+r;return o+t.height>window.innerHeight&&(o=+e.clientY-r-t.height),{x:i,y:o}}(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${o}px; left: ${i}px`)}}function FXe(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))}var OXe;function RXe(e,...t){for(const n of t)NXe(e,n);return e}function NXe(e,t){for(const n of Object.keys(t))Ae(e,n,t[n],!0)}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});const DXe=x;let IXe=_;const BXe="undefined"!=typeof window?window:void 0;void 0===IXe&&(null===(OXe=null==BXe?void 0:BXe.vl)||void 0===OXe?void 0:OXe.compile)&&(IXe=BXe.vl);const LXe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},PXe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},$Xe={vega:"Vega","vega-lite":"Vega-Lite"},zXe={vega:DXe.version,"vega-lite":IXe?IXe.version:"not available"},jXe={vega:e=>e,"vega-lite":(e,t)=>IXe.compile(e,{config:t}).spec};function GXe(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,o=`</code></pre>${n}</body></html>`,a=window.open("");a.document.write(i+e+o),a.document.title=`${$Xe[r]} JSON Source`}function UXe(e,t){var n;if(e.$schema){const r=Sqe(e.$schema);t&&t!==r.library&&console.warn(`The given visualization spec is written in ${$Xe[r.library]}, but mode argument sets ${null!==(n=$Xe[t])&&void 0!==n?n:t}.`);const i=r.library;return(0,ne.satisfies)(zXe[i],`^${r.version.slice(1)}`)||console.warn(`The input spec uses ${$Xe[i]} ${r.version}, but the current version of ${$Xe[i]} is v${zXe[i]}.`),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":null!=t?t:"vega"}function WXe(e){return(t=e)&&"load"in t?e:DXe.loader(e);var t}function VXe(e){var t;return null!==(t=e.usermeta&&e.usermeta.embedOptions)&&void 0!==t?t:{}}function HXe(e,t){var n;return FXe(this,void 0,void 0,(function*(){const r=wt(e.config)?JSON.parse(yield t.load(e.config)):null!==(n=e.config)&&void 0!==n?n:{},i=wt(e.patch)?JSON.parse(yield t.load(e.patch)):e.patch;return Object.assign(Object.assign(Object.assign({},e),i?{patch:i}:{}),r?{config:r}:{})}))}const qXe=function(e,t,n={}){var r,i,o;return FXe(this,void 0,void 0,(function*(){let a,s;wt(t)?(s=WXe(n.loader),a=JSON.parse(yield s.load(t))):a=t;const u=VXe(a).loader;s&&!u||(s=WXe(null!==(r=n.loader)&&void 0!==r?r:u));const l=yield HXe(VXe(a),s),c=yield HXe(n,s),p=Object.assign(Object.assign({},RXe(c,l)),{config:Ee(null!==(i=c.config)&&void 0!==i?i:{},null!==(o=l.config)&&void 0!==o?o:{})});return yield function(e,t,n={},r){var i,o,a,s,u,l;return FXe(this,void 0,void 0,(function*(){const c=n.theme?Ee(w[n.theme],null!==(i=n.config)&&void 0!==i?i:{}):n.config,p=yt(n.actions)?n.actions:RXe({},LXe,null!==(o=n.actions)&&void 0!==o?o:{}),d=Object.assign(Object.assign({},PXe),n.i18n),h=null!==(a=n.renderer)&&void 0!==a?a:"canvas",f=null!==(s=n.logLevel)&&void 0!==s?s:DXe.Warn,g=null!==(u=n.downloadFileName)&&void 0!==u?u:"visualization",m="string"==typeof e?document.querySelector(e):e;if(!m)throw new Error(`${e} does not exist`);if(!1!==n.defaultStyle){const e="vega-embed-style",{root:t,rootContainer:r}=function(e){var t;const n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:null!==(t=document.head)&&void 0!==t?t:document.body}}(m);if(!t.getElementById(e)){const t=document.createElement("style");t.id=e,t.innerText=void 0===n.defaultStyle||!0===n.defaultStyle?'.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    z-index: 1001;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n    text-align: left; }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n  .vega-embed .chart-wrapper {\n    width: 100%;\n    height: 100%; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n'.toString():n.defaultStyle,r.appendChild(t)}}const y=UXe(t,n.mode);let b=jXe[y](t,c);if("vega-lite"===y&&b.$schema){const e=Sqe(b.$schema);(0,ne.satisfies)(zXe.vega,`^${e.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${e.version}, but current version is v${zXe.vega}.`)}m.classList.add("vega-embed"),p&&m.classList.add("has-actions"),m.innerHTML="";let v=m;if(p){const e=document.createElement("div");e.classList.add("chart-wrapper"),m.appendChild(e),v=e}const x=n.patch;x&&(b=x instanceof Function?x(b):j(b,x,!0,!1).newDocument),n.formatLocale&&DXe.formatLocale(n.formatLocale),n.timeFormatLocale&&DXe.timeFormatLocale(n.timeFormatLocale);const{ast:_}=n,k=DXe.parse(b,"vega-lite"===y?{}:c,{ast:_}),S=new(n.viewClass||DXe.View)(k,Object.assign({loader:r,logLevel:f,renderer:h},_?{expr:DXe.expressionInterpreter}:{}));if(!1!==n.tooltip){let e;e="function"==typeof n.tooltip?n.tooltip:new AXe(!0===n.tooltip?{}:n.tooltip).call,S.tooltip(e)}let C,{hover:M}=n;if(void 0===M&&(M="vega"===y),M){const{hoverSet:e,updateSet:t}="boolean"==typeof M?{}:M;S.hover(e,t)}if(n&&(null!=n.width&&S.width(n.width),null!=n.height&&S.height(n.height),null!=n.padding&&S.padding(n.padding)),yield S.initialize(v,n.bind).runAsync(),!1!==p){let e=m;if(!1!==n.defaultStyle){const t=document.createElement("details");t.title=d.CLICK_TO_VIEW_ACTIONS,m.append(t),e=t;const n=document.createElement("summary");n.innerHTML='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',t.append(n),C=e=>{t.contains(e.target)||t.removeAttribute("open")},document.addEventListener("click",C)}const r=document.createElement("div");if(e.append(r),r.classList.add("vega-actions"),!0===p||!1!==p.export)for(const e of["svg","png"])if(!0===p||!0===p.export||p.export[e]){const t=d[`${e.toUpperCase()}_ACTION`],i=document.createElement("a");i.text=t,i.href="#",i.target="_blank",i.download=`${g}.${e}`,i.addEventListener("mousedown",(function(t){return FXe(this,void 0,void 0,(function*(){t.preventDefault();const r=yield S.toImageURL(e,n.scaleFactor);this.href=r}))})),r.append(i)}if(!0===p||!1!==p.source){const e=document.createElement("a");e.text=d.SOURCE_ACTION,e.href="#",e.addEventListener("click",(function(e){var r,i;GXe(te()(t),null!==(r=n.sourceHeader)&&void 0!==r?r:"",null!==(i=n.sourceFooter)&&void 0!==i?i:"",y),e.preventDefault()})),r.append(e)}if("vega-lite"===y&&(!0===p||!1!==p.compiled)){const e=document.createElement("a");e.text=d.COMPILED_ACTION,e.href="#",e.addEventListener("click",(function(e){var t,r;GXe(te()(b),null!==(t=n.sourceHeader)&&void 0!==t?t:"",null!==(r=n.sourceFooter)&&void 0!==r?r:"","vega"),e.preventDefault()})),r.append(e)}if(!0===p||!1!==p.editor){const e=null!==(l=n.editorUrl)&&void 0!==l?l:"https://vega.github.io/editor/",i=document.createElement("a");i.text=d.EDITOR_ACTION,i.href="#",i.addEventListener("click",(function(n){!function(e,t,n){const r=e.open(t),{origin:i}=new URL(t);let o=40;e.addEventListener("message",(function t(n){n.source===r&&(o=0,e.removeEventListener("message",t,!1))}),!1),setTimeout((function e(){o<=0||(r.postMessage(n,i),setTimeout(e,250),o-=1)}),250)}(window,e,{config:c,mode:y,renderer:h,spec:te()(t)}),n.preventDefault()})),r.append(i)}}return{view:S,spec:t,vgSpec:b,finalize:function(){C&&document.removeEventListener("click",C),S.finalize()}}}))}(e,a,p,s)}))}},9602:e=>{"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},4411:(e,t,n)=>{"use strict";function r(e){var t=this;if(t instanceof r||(t=new r),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}function i(e,t,n){var r=t===e.head?new s(n,null,t,e):new s(n,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function o(e,t){e.tail=new s(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function a(e,t){e.head=new s(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function s(e,t,n,r){if(!(this instanceof s))return new s(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}e.exports=r,r.Node=s,r.create=r,r.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},r.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},r.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},r.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},r.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)a(this,arguments[e]);return this.length},r.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},r.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},r.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},r.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},r.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},r.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},r.prototype.map=function(e,t){t=t||this;for(var n=new r,i=this.head;null!==i;)n.push(e.call(t,i.value,this)),i=i.next;return n},r.prototype.mapReverse=function(e,t){t=t||this;for(var n=new r,i=this.tail;null!==i;)n.push(e.call(t,i.value,this)),i=i.prev;return n},r.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=e(n,r.value,i),r=r.next;return n},r.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=e(n,r.value,i),r=r.prev;return n},r.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},r.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},r.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,o=this.head;null!==o&&i<e;i++)o=o.next;for(;null!==o&&i<t;i++,o=o.next)n.push(o.value);return n},r.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,o=this.tail;null!==o&&i>t;i--)o=o.prev;for(;null!==o&&i>e;i--,o=o.prev)n.push(o.value);return n},r.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,o=this.head;null!==o&&r<e;r++)o=o.next;var a=[];for(r=0;o&&r<t;r++)a.push(o.value),o=this.removeNode(o);for(null===o&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev),r=0;r<n.length;r++)o=i(this,o,n[r]);return a},r.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{n(9602)(r)}catch(e){}},5410:()=>{},8628:()=>{},1601:()=>{},7792:()=>{},4977:()=>{},5042:()=>{},1801:e=>{"use strict";var t=/("(?:[^\\"]|\\.)*")|[:,]/g;e.exports=function(e,n){var r,i,o;return n=n||{},r=JSON.stringify([1],void 0,void 0===n.indent?2:n.indent).slice(2,-3),i=""===r?1/0:void 0===n.maxLength?80:n.maxLength,o=n.replacer,function e(n,a,s){var u,l,c,p,d,h,f,g,m,y,b,v;if(n&&"function"==typeof n.toJSON&&(n=n.toJSON()),void 0===(b=JSON.stringify(n,o)))return b;if(f=i-a.length-s,b.length<=f&&(m=b.replace(t,(function(e,t){return t||e+" "}))).length<=f)return m;if(null!=o&&(n=JSON.parse(b),o=void 0),"object"==typeof n&&null!==n){if(g=a+r,c=[],l=0,Array.isArray(n))for(y="[",u="]",f=n.length;l<f;l++)c.push(e(n[l],g,l===f-1?0:1)||"null");else for(y="{",u="}",f=(h=Object.keys(n)).length;l<f;l++)p=h[l],d=JSON.stringify(p)+": ",void 0!==(v=e(n[p],g,d.length+(l===f-1?0:1)))&&c.push(d+v);if(c.length>0)return[y,r+c.join(",\n"+g),u].join("\n"+a)}return b}(e,"",0)}},203:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{n:()=>FilesetResolver_1,qe:()=>PoseLandmarker_1});var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},vision={},fileset_resolver={};let supportsSimd;Object.defineProperty(fileset_resolver,"__esModule",{value:!0}),fileset_resolver.FilesetResolver=void 0;const WASM_SIMD_CHECK=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function isSimdSupported(){if(void 0===supportsSimd)try{await WebAssembly.instantiate(WASM_SIMD_CHECK),supportsSimd=!0}catch(e){supportsSimd=!1}return supportsSimd}async function createFileset(e,t=""){const n=await isSimdSupported()?"wasm_internal":"wasm_nosimd_internal";return{wasmLoaderPath:`${t}/${e}_${n}.js`,wasmBinaryPath:`${t}/${e}_${n}.wasm`}}class FilesetResolver$1{static isSimdSupported(){return isSimdSupported()}static forAudioTasks(e){return createFileset("audio",e)}static forTextTasks(e){return createFileset("text",e)}static forVisionTasks(e){return createFileset("vision",e)}}fileset_resolver.FilesetResolver=FilesetResolver$1;var drawing_utils={};Object.defineProperty(drawing_utils,"__esModule",{value:!0}),drawing_utils.DrawingUtils=void 0;const DEFAULT_OPTIONS={color:"white",lineWidth:4,radius:6};function addDefaultOptions(e){return e=e||{},Object.assign(Object.assign(Object.assign({},DEFAULT_OPTIONS),{fillColor:e.color}),e)}function resolve(e,t){return e instanceof Function?e(t):e}class DrawingUtils$1{constructor(e){this.ctx=e}static clamp(e,t,n){const r=Math.min(t,n),i=Math.max(t,n);return Math.max(r,Math.min(i,e))}static lerp(e,t,n,r,i){const o=r*(1-(e-t)/(n-t))+i*(1-(n-e)/(n-t));return DrawingUtils$1.clamp(o,r,i)}drawLandmarks(e,t){if(!e)return;const n=this.ctx,r=addDefaultOptions(t);n.save();const i=n.canvas;let o=0;for(const t of e){n.fillStyle=resolve(r.fillColor,{index:o,from:t}),n.strokeStyle=resolve(r.color,{index:o,from:t}),n.lineWidth=resolve(r.lineWidth,{index:o,from:t});const e=new Path2D;e.arc(t.x*i.width,t.y*i.height,resolve(r.radius,{index:o,from:t}),0,2*Math.PI),n.fill(e),n.stroke(e),++o}n.restore()}drawConnectors(e,t,n){if(!e||!t)return;const r=this.ctx,i=addDefaultOptions(n);r.save();const o=r.canvas;let a=0;for(const n of t){r.beginPath();const t=e[n.start],s=e[n.end];t&&s&&(r.strokeStyle=resolve(i.color,{index:a,from:t,to:s}),r.lineWidth=resolve(i.lineWidth,{index:a,from:t,to:s}),r.moveTo(t.x*o.width,t.y*o.height),r.lineTo(s.x*o.width,s.y*o.height)),++a,r.stroke()}r.restore()}drawBoundingBox(e,t){const n=this.ctx,r=addDefaultOptions(t);n.save(),n.beginPath(),n.lineWidth=resolve(r.lineWidth,{}),n.strokeStyle=resolve(r.color,{}),n.fillStyle=resolve(r.fillColor,{}),n.moveTo(e.originX,e.originY),n.lineTo(e.originX+e.width,e.originY),n.lineTo(e.originX+e.width,e.originY+e.height),n.lineTo(e.originX,e.originY+e.height),n.lineTo(e.originX,e.originY),n.stroke(),n.fill(),n.restore()}}drawing_utils.DrawingUtils=DrawingUtils$1;var image={},image_shader_context={};Object.defineProperty(image_shader_context,"__esModule",{value:!0}),image_shader_context.MPImageShaderContext=image_shader_context.assertNotNull=void 0;const VERTEX_SHADER="\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",FRAGMENT_SHADER="\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D inputTexture;\n   void main() {\n     gl_FragColor = texture2D(inputTexture, vTex);\n   }\n ";function assertNotNull(e,t){if(null===e)throw new Error(`Unable to obtain required WebGL resource: ${t}`);return e}image_shader_context.assertNotNull=assertNotNull;class MPImageShaderBuffers{constructor(e,t,n,r){this.gl=e,this.vertexArrayObject=t,this.vertexBuffer=n,this.textureBuffer=r}bind(){this.gl.bindVertexArray(this.vertexArrayObject)}unbind(){this.gl.bindVertexArray(null)}close(){this.gl.deleteVertexArray(this.vertexArrayObject),this.gl.deleteBuffer(this.vertexBuffer),this.gl.deleteBuffer(this.textureBuffer)}}class MPImageShaderContext{compileShader(e,t){const n=this.gl,r=assertNotNull(n.createShader(t),"Failed to create WebGL shader");if(n.shaderSource(r,e),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS)){const e=n.getShaderInfoLog(r);throw new Error(`Could not compile WebGL shader: ${e}`)}return n.attachShader(this.program,r),r}setupShaders(){const e=this.gl;if(this.program=assertNotNull(e.createProgram(),"Failed to create WebGL program"),this.vertexShader=this.compileShader(VERTEX_SHADER,e.VERTEX_SHADER),this.fragmentShader=this.compileShader(FRAGMENT_SHADER,e.FRAGMENT_SHADER),e.linkProgram(this.program),!e.getProgramParameter(this.program,e.LINK_STATUS)){const t=e.getProgramInfoLog(this.program);throw new Error(`Error during program linking: ${t}`)}this.aVertex=e.getAttribLocation(this.program,"aVertex"),this.aTex=e.getAttribLocation(this.program,"aTex")}createBuffers(e){const t=this.gl,n=assertNotNull(t.createVertexArray(),"Failed to create vertex array");t.bindVertexArray(n);const r=assertNotNull(t.createBuffer(),"Failed to create buffer");t.bindBuffer(t.ARRAY_BUFFER,r),t.enableVertexAttribArray(this.aVertex),t.vertexAttribPointer(this.aVertex,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),t.STATIC_DRAW);const i=assertNotNull(t.createBuffer(),"Failed to create buffer");t.bindBuffer(t.ARRAY_BUFFER,i),t.enableVertexAttribArray(this.aTex),t.vertexAttribPointer(this.aTex,2,t.FLOAT,!1,0,0);const o=e?[0,1,0,0,1,0,1,1]:[0,0,0,1,1,1,1,0];return t.bufferData(t.ARRAY_BUFFER,new Float32Array(o),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindVertexArray(null),new MPImageShaderBuffers(t,n,r,i)}getShaderBuffers(e){return e?(this.shaderBuffersFlipVertically||(this.shaderBuffersFlipVertically=this.createBuffers(!0)),this.shaderBuffersFlipVertically):(this.shaderBuffersPassthrough||(this.shaderBuffersPassthrough=this.createBuffers(!1)),this.shaderBuffersPassthrough)}maybeInitGL(e){if(this.gl){if(e!==this.gl)throw new Error("Cannot change GL context once initialized")}else this.gl=e}run(e,t,n){this.maybeInitGL(e),this.program||this.setupShaders();const r=this.getShaderBuffers(t);e.useProgram(this.program),r.bind();const i=n();return r.unbind(),i}bindFramebuffer(e,t){this.maybeInitGL(e),this.framebuffer||(this.framebuffer=assertNotNull(e.createFramebuffer(),"Failed to create framebuffe.")),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}unbindFramebuffer(){var e;null===(e=this.gl)||void 0===e||e.bindFramebuffer(this.gl.FRAMEBUFFER,null)}close(){if(this.program){const e=this.gl;e.deleteProgram(this.program),e.deleteShader(this.vertexShader),e.deleteShader(this.fragmentShader)}this.framebuffer&&this.gl.deleteFramebuffer(this.framebuffer),this.shaderBuffersPassthrough&&this.shaderBuffersPassthrough.close(),this.shaderBuffersFlipVertically&&this.shaderBuffersFlipVertically.close()}}image_shader_context.MPImageShaderContext=MPImageShaderContext,Object.defineProperty(image,"__esModule",{value:!0}),image.MPImage=void 0;const image_shader_context_1$2=image_shader_context,INSTANCE_COUNT_WARNING_THRESHOLD$1=250;var MPImageType,e;e=MPImageType||(MPImageType={}),e[e.IMAGE_DATA=0]="IMAGE_DATA",e[e.IMAGE_BITMAP=1]="IMAGE_BITMAP",e[e.WEBGL_TEXTURE=2]="WEBGL_TEXTURE";class MPImage$1{constructor(e,t,n,r,i,o,a){this.containers=e,this.ownsImageBitmap=t,this.ownsWebGLTexture=n,this.canvas=r,this.shaderContext=i,this.width=o,this.height=a,(this.ownsImageBitmap||this.ownsWebGLTexture)&&(--MPImage$1.instancesBeforeWarning,0===MPImage$1.instancesBeforeWarning&&console.error("You seem to be creating MPImage instances without invoking .close(). This leaks resources."))}hasImageData(){return!!this.getContainer(MPImageType.IMAGE_DATA)}hasImageBitmap(){return!!this.getContainer(MPImageType.IMAGE_BITMAP)}hasWebGLTexture(){return!!this.getContainer(MPImageType.WEBGL_TEXTURE)}getAsImageData(){return this.convertToImageData()}getAsImageBitmap(){return this.convertToImageBitmap()}getAsWebGLTexture(){return this.convertToWebGLTexture()}getContainer(e){switch(e){case MPImageType.IMAGE_DATA:return this.containers.find((e=>e instanceof ImageData));case MPImageType.IMAGE_BITMAP:return this.containers.find((e=>"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap));case MPImageType.WEBGL_TEXTURE:return this.containers.find((e=>"undefined"!=typeof WebGLTexture&&e instanceof WebGLTexture));default:throw new Error(`Type is not supported: ${e}`)}}clone(){const e=[];for(const t of this.containers){let n;if(t instanceof ImageData)n=new ImageData(t.data,this.width,this.height);else if(t instanceof WebGLTexture){const e=this.getGL(),t=this.getShaderContext();e.activeTexture(e.TEXTURE1),n=(0,image_shader_context_1$2.assertNotNull)(e.createTexture(),"Failed to create texture"),e.bindTexture(e.TEXTURE_2D,n),this.configureTextureParams(),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindTexture(e.TEXTURE_2D,null),t.bindFramebuffer(e,n),t.run(e,!1,(()=>{this.bindTexture(),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLE_FAN,0,4),this.unbindTexture()})),t.unbindFramebuffer(),this.unbindTexture()}else{if(!(t instanceof ImageBitmap))throw new Error(`Type is not supported: ${t}`);this.convertToWebGLTexture(),this.bindTexture(),n=this.copyTextureToBitmap(),this.unbindTexture()}e.push(n)}return new MPImage$1(e,this.hasImageBitmap(),this.hasWebGLTexture(),this.canvas,this.shaderContext,this.width,this.height)}getOffscreenCanvas(){if(!(this.canvas instanceof OffscreenCanvas))throw new Error("Conversion to ImageBitmap requires that the MediaPipe Tasks is initialized with an OffscreenCanvas");return this.canvas}getGL(){if(!this.canvas)throw new Error("Conversion to different image formats require that a canvas is passed when iniitializing the image.");return this.gl||(this.gl=(0,image_shader_context_1$2.assertNotNull)(this.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),this.gl}getShaderContext(){return this.shaderContext||(this.shaderContext=new image_shader_context_1$2.MPImageShaderContext),this.shaderContext}convertToImageBitmap(){let e=this.getContainer(MPImageType.IMAGE_BITMAP);return e||(this.convertToWebGLTexture(),e=this.convertWebGLTextureToImageBitmap(),this.containers.push(e),this.ownsImageBitmap=!0),e}convertToImageData(){let e=this.getContainer(MPImageType.IMAGE_DATA);if(!e){const t=this.getGL(),n=this.getShaderContext(),r=new Uint8Array(this.width*this.height*4),i=this.convertToWebGLTexture();n.bindFramebuffer(t,i),t.readPixels(0,0,this.width,this.height,t.RGBA,t.UNSIGNED_BYTE,r),n.unbindFramebuffer(),e=new ImageData(new Uint8ClampedArray(r.buffer),this.width,this.height),this.containers.push(e)}return e}convertToWebGLTexture(){let e=this.getContainer(MPImageType.WEBGL_TEXTURE);if(!e){const t=this.getGL();e=this.bindTexture();const n=this.getContainer(MPImageType.IMAGE_BITMAP)||this.convertToImageData();t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n),this.unbindTexture()}return e}configureTextureParams(){const e=this.getGL();e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR)}bindTexture(){const e=this.getGL();e.viewport(0,0,this.width,this.height),e.activeTexture(e.TEXTURE0);let t=this.getContainer(MPImageType.WEBGL_TEXTURE);return t?e.bindTexture(e.TEXTURE_2D,t):(t=(0,image_shader_context_1$2.assertNotNull)(e.createTexture(),"Failed to create texture"),this.containers.push(t),this.ownsWebGLTexture=!0,e.bindTexture(e.TEXTURE_2D,t),this.configureTextureParams()),t}unbindTexture(){this.gl.bindTexture(this.gl.TEXTURE_2D,null)}copyTextureToBitmap(){const e=this.getGL();return this.getShaderContext().run(e,!0,(()=>this.runWithResizedCanvas((()=>(e.bindFramebuffer(e.FRAMEBUFFER,null),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLE_FAN,0,4),this.getOffscreenCanvas().transferToImageBitmap())))))}convertWebGLTextureToImageBitmap(){this.bindTexture();const e=this.copyTextureToBitmap();return this.unbindTexture(),e}runWithResizedCanvas(e){const t=this.canvas;if(t.width===this.width&&t.height===this.height)return e();const n=t.width,r=t.height;t.width=this.width,t.height=this.height;const i=e();return t.width=n,t.height=r,i}close(){this.ownsImageBitmap&&this.getContainer(MPImageType.IMAGE_BITMAP).close(),this.ownsWebGLTexture&&this.getGL().deleteTexture(this.getContainer(MPImageType.WEBGL_TEXTURE)),MPImage$1.instancesBeforeWarning=-1}}image.MPImage=MPImage$1,MPImage$1.instancesBeforeWarning=INSTANCE_COUNT_WARNING_THRESHOLD$1;var mask={},platform_utils={};function isWebKit(e=navigator){const t=e.userAgent;return t.includes("Safari")&&!t.includes("Chrome")}function isIOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}Object.defineProperty(platform_utils,"__esModule",{value:!0}),platform_utils.isIOS=platform_utils.isWebKit=void 0,platform_utils.isWebKit=isWebKit,platform_utils.isIOS=isIOS,Object.defineProperty(mask,"__esModule",{value:!0}),mask.MPMask=void 0;const image_shader_context_1$1=image_shader_context,platform_utils_1$1=platform_utils,INSTANCE_COUNT_WARNING_THRESHOLD=250;var MPMaskType;!function(e){e[e.UINT8_ARRAY=0]="UINT8_ARRAY",e[e.FLOAT32_ARRAY=1]="FLOAT32_ARRAY",e[e.WEBGL_TEXTURE=2]="WEBGL_TEXTURE"}(MPMaskType||(MPMaskType={}));class MPMask$1{constructor(e,t,n,r,i,o){this.containers=e,this.ownsWebGLTexture=t,this.canvas=n,this.shaderContext=r,this.width=i,this.height=o,this.ownsWebGLTexture&&(--MPMask$1.instancesBeforeWarning,0===MPMask$1.instancesBeforeWarning&&console.error("You seem to be creating MPMask instances without invoking .close(). This leaks resources."))}hasUint8Array(){return!!this.getContainer(MPMaskType.UINT8_ARRAY)}hasFloat32Array(){return!!this.getContainer(MPMaskType.FLOAT32_ARRAY)}hasWebGLTexture(){return!!this.getContainer(MPMaskType.WEBGL_TEXTURE)}getAsUint8Array(){return this.convertToUint8Array()}getAsFloat32Array(){return this.convertToFloat32Array()}getAsWebGLTexture(){return this.convertToWebGLTexture()}getTexImage2DFormat(){const e=this.getGL();if(!MPMask$1.texImage2DFormat)if(e.getExtension("EXT_color_buffer_float")&&e.getExtension("OES_texture_float_linear")&&e.getExtension("EXT_float_blend"))MPMask$1.texImage2DFormat=e.R32F;else{if(!e.getExtension("EXT_color_buffer_half_float"))throw new Error("GPU does not fully support 4-channel float32 or float16 formats");MPMask$1.texImage2DFormat=e.R16F}return MPMask$1.texImage2DFormat}getContainer(e){switch(e){case MPMaskType.UINT8_ARRAY:return this.containers.find((e=>e instanceof Uint8Array));case MPMaskType.FLOAT32_ARRAY:return this.containers.find((e=>e instanceof Float32Array));case MPMaskType.WEBGL_TEXTURE:return this.containers.find((e=>"undefined"!=typeof WebGLTexture&&e instanceof WebGLTexture));default:throw new Error(`Type is not supported: ${e}`)}}clone(){const e=[];for(const t of this.containers){let n;if(t instanceof Uint8Array)n=new Uint8Array(t);else if(t instanceof Float32Array)n=new Float32Array(t);else{if(!(t instanceof WebGLTexture))throw new Error(`Type is not supported: ${t}`);{const e=this.getGL(),t=this.getShaderContext();e.activeTexture(e.TEXTURE1),n=(0,image_shader_context_1$1.assertNotNull)(e.createTexture(),"Failed to create texture"),e.bindTexture(e.TEXTURE_2D,n),this.configureTextureParams();const r=this.getTexImage2DFormat();e.texImage2D(e.TEXTURE_2D,0,r,this.width,this.height,0,e.RED,e.FLOAT,null),e.bindTexture(e.TEXTURE_2D,null),t.bindFramebuffer(e,n),t.run(e,!1,(()=>{this.bindTexture(),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLE_FAN,0,4),this.unbindTexture()})),t.unbindFramebuffer(),this.unbindTexture()}}e.push(n)}return new MPMask$1(e,this.hasWebGLTexture(),this.canvas,this.shaderContext,this.width,this.height)}getGL(){if(!this.canvas)throw new Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return this.gl||(this.gl=(0,image_shader_context_1$1.assertNotNull)(this.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),this.gl}getShaderContext(){return this.shaderContext||(this.shaderContext=new image_shader_context_1$1.MPImageShaderContext),this.shaderContext}convertToFloat32Array(){let e=this.getContainer(MPMaskType.FLOAT32_ARRAY);if(!e){const t=this.getContainer(MPMaskType.UINT8_ARRAY);if(t)e=new Float32Array(t).map((e=>e/255));else{e=new Float32Array(this.width*this.height);const t=this.getGL(),n=this.getShaderContext(),r=this.convertToWebGLTexture();if(n.bindFramebuffer(t,r),(0,platform_utils_1$1.isIOS)()){const n=new Float32Array(this.width*this.height*4);t.readPixels(0,0,this.width,this.height,t.RGBA,t.FLOAT,n);for(let t=0,r=0;t<e.length;++t,r+=4)e[t]=n[r]}else t.readPixels(0,0,this.width,this.height,t.RED,t.FLOAT,e)}this.containers.push(e)}return e}convertToUint8Array(){let e=this.getContainer(MPMaskType.UINT8_ARRAY);if(!e){const t=this.convertToFloat32Array();e=new Uint8Array(t.map((e=>255*e))),this.containers.push(e)}return e}convertToWebGLTexture(){let e=this.getContainer(MPMaskType.WEBGL_TEXTURE);if(!e){const t=this.getGL();e=this.bindTexture();const n=this.convertToFloat32Array(),r=this.getTexImage2DFormat();t.texImage2D(t.TEXTURE_2D,0,r,this.width,this.height,0,t.RED,t.FLOAT,n),this.unbindTexture()}return e}configureTextureParams(){const e=this.getGL();e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)}bindTexture(){const e=this.getGL();e.viewport(0,0,this.width,this.height),e.activeTexture(e.TEXTURE0);let t=this.getContainer(MPMaskType.WEBGL_TEXTURE);return t?e.bindTexture(e.TEXTURE_2D,t):(t=(0,image_shader_context_1$1.assertNotNull)(e.createTexture(),"Failed to create texture"),this.containers.push(t),this.ownsWebGLTexture=!0,e.bindTexture(e.TEXTURE_2D,t),this.configureTextureParams()),t}unbindTexture(){this.gl.bindTexture(this.gl.TEXTURE_2D,null)}close(){this.ownsWebGLTexture&&this.getGL().deleteTexture(this.getContainer(MPMaskType.WEBGL_TEXTURE)),MPMask$1.instancesBeforeWarning=-1}}mask.MPMask=MPMask$1,MPMask$1.instancesBeforeWarning=INSTANCE_COUNT_WARNING_THRESHOLD;var face_detector={},calculator_pb={},googleProtobuf={};(function(exports){var $jscomp=$jscomp||{};$jscomp.scope={},$jscomp.findInternal=function(e,t,n){e instanceof String&&(e=String(e));for(var r=e.length,i=0;i<r;i++){var o=e[i];if(t.call(n,o,i,e))return{i,v:o}}return{i:-1,v:void 0}},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.SIMPLE_FROUND_POLYFILL=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},$jscomp.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:void 0!==commonjsGlobal&&null!=commonjsGlobal?commonjsGlobal:e},$jscomp.global=$jscomp.getGlobal(commonjsGlobal),$jscomp.polyfill=function(e,t,n,r){if(t){for(n=$jscomp.global,e=e.split("."),r=0;r<e.length-1;r++){var i=e[r];i in n||(n[i]={}),n=n[i]}(t=t(r=n[e=e[e.length-1]]))!=r&&null!=t&&$jscomp.defineProperty(n,e,{configurable:!0,writable:!0,value:t})}},$jscomp.polyfill("Array.prototype.findIndex",(function(e){return e||function(e,t){return $jscomp.findInternal(this,e,t).i}}),"es6","es3"),$jscomp.checkStringArgs=function(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""},$jscomp.polyfill("String.prototype.endsWith",(function(e){return e||function(e,t){var n=$jscomp.checkStringArgs(this,e,"endsWith");e+="",void 0===t&&(t=n.length),t=Math.max(0,Math.min(0|t,n.length));for(var r=e.length;0<r&&0<t;)if(n[--t]!=e[--r])return!1;return 0>=r}}),"es6","es3"),$jscomp.polyfill("Array.prototype.find",(function(e){return e||function(e,t){return $jscomp.findInternal(this,e,t).v}}),"es6","es3"),$jscomp.polyfill("String.prototype.startsWith",(function(e){return e||function(e,t){var n=$jscomp.checkStringArgs(this,e,"startsWith");e+="";var r=n.length,i=e.length;t=Math.max(0,Math.min(0|t,n.length));for(var o=0;o<i&&t<r;)if(n[t++]!=e[o++])return!1;return o>=i}}),"es6","es3"),$jscomp.polyfill("String.prototype.repeat",(function(e){return e||function(e){var t=$jscomp.checkStringArgs(this,null,"repeat");if(0>e||1342177279<e)throw new RangeError("Invalid count value");e|=0;for(var n="";e;)1&e&&(n+=t),(e>>>=1)&&(t+=t);return n}}),"es6","es3");var COMPILED=!0,goog=goog||{};goog.global=commonjsGlobal||self,goog.exportPath_=function(e,t,n){e=e.split("."),n=n||goog.global,e[0]in n||void 0===n.execScript||n.execScript("var "+e[0]);for(var r;e.length&&(r=e.shift());)e.length||void 0===t?n=n[r]&&n[r]!==Object.prototype[r]?n[r]:n[r]={}:n[r]=t},goog.define=function(e,t){return t},goog.FEATURESET_YEAR=2012,goog.DEBUG=!0,goog.LOCALE="en",goog.TRUSTED_SITE=!0,goog.STRICT_MODE_COMPATIBLE=!1,goog.DISALLOW_TEST_ONLY_CODE=!goog.DEBUG,goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1,goog.provide=function(e){if(goog.isInModuleLoader_())throw Error("goog.provide cannot be used within a module.");goog.constructNamespace_(e)},goog.constructNamespace_=function(e,t){goog.exportPath_(e,t)},goog.getScriptNonce=function(e){return e&&e!=goog.global?goog.getScriptNonce_(e.document):(null===goog.cspNonce_&&(goog.cspNonce_=goog.getScriptNonce_(goog.global.document)),goog.cspNonce_)},goog.NONCE_PATTERN_=/^[\w+/_-]+[=]{0,2}$/,goog.cspNonce_=null,goog.getScriptNonce_=function(e){return(e=e.querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&goog.NONCE_PATTERN_.test(e)?e:""},goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/,goog.module=function(e){if("string"!=typeof e||!e||-1==e.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInGoogModuleLoader_())throw Error("Module "+e+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");goog.moduleLoaderState_.moduleName=e},goog.module.get=function(e){return goog.module.getInternal_(e)},goog.module.getInternal_=function(e){return null},goog.ModuleType={ES6:"es6",GOOG:"goog"},goog.moduleLoaderState_=null,goog.isInModuleLoader_=function(){return goog.isInGoogModuleLoader_()||goog.isInEs6ModuleLoader_()},goog.isInGoogModuleLoader_=function(){return!!goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.GOOG},goog.isInEs6ModuleLoader_=function(){if(goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.ES6)return!0;var e=goog.global.$jscomp;return!!e&&"function"==typeof e.getCurrentModulePath&&!!e.getCurrentModulePath()},goog.module.declareLegacyNamespace=function(){goog.moduleLoaderState_.declareLegacyNamespace=!0},goog.declareModuleId=function(e){if(goog.moduleLoaderState_)goog.moduleLoaderState_.moduleName=e;else{var t=goog.global.$jscomp;if(!t||"function"!=typeof t.getCurrentModulePath)throw Error('Module with namespace "'+e+'" has been loaded incorrectly.');t=t.require(t.getCurrentModulePath()),goog.loadedModules_[e]={exports:t,type:goog.ModuleType.ES6,moduleId:e}}},goog.setTestOnly=function(e){if(goog.DISALLOW_TEST_ONLY_CODE)throw e=e||"",Error("Importing test-only code into non-debug environment"+(e?": "+e:"."))},goog.forwardDeclare=function(e){},goog.getObjectByName=function(e,t){e=e.split("."),t=t||goog.global;for(var n=0;n<e.length;n++)if(null==(t=t[e[n]]))return null;return t},goog.globalize=function(e,t){for(var n in t=t||goog.global,e)t[n]=e[n]},goog.addDependency=function(e,t,n,r){},goog.ENABLE_DEBUG_LOADER=!0,goog.logToConsole_=function(e){goog.global.console&&goog.global.console.error(e)},goog.require=function(e){},goog.requireType=function(e){return{}},goog.basePath="",goog.nullFunction=function(){},goog.abstractMethod=function(){throw Error("unimplemented abstract method")},goog.addSingletonGetter=function(e){e.instance_=void 0,e.getInstance=function(){return e.instance_?e.instance_:(goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=e),e.instance_=new e)}},goog.instantiatedSingletons_=[],goog.LOAD_MODULE_USING_EVAL=!0,goog.SEAL_MODULE_EXPORTS=goog.DEBUG,goog.loadedModules_={},goog.DEPENDENCIES_ENABLED=!COMPILED,goog.TRANSPILE="detect",goog.ASSUME_ES_MODULES_TRANSPILED=!1,goog.TRANSPILE_TO_LANGUAGE="",goog.TRANSPILER="transpile.js",goog.hasBadLetScoping=null,goog.useSafari10Workaround=function(){if(null==goog.hasBadLetScoping){try{var a=!eval('"use strict";let x = 1; function f() { return typeof x; };f() == "number";')}catch(e){a=!1}goog.hasBadLetScoping=a}return goog.hasBadLetScoping},goog.workaroundSafari10EvalBug=function(e){return"(function(){"+e+"\n;})();\n"},goog.loadModule=function(e){var t=goog.moduleLoaderState_;try{if(goog.moduleLoaderState_={moduleName:"",declareLegacyNamespace:!1,type:goog.ModuleType.GOOG},goog.isFunction(e))var n=e.call(void 0,{});else{if("string"!=typeof e)throw Error("Invalid module definition");goog.useSafari10Workaround()&&(e=goog.workaroundSafari10EvalBug(e)),n=goog.loadModuleFromSource_.call(void 0,e)}var r=goog.moduleLoaderState_.moduleName;if("string"!=typeof r||!r)throw Error('Invalid module name "'+r+'"');goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(r,n):goog.SEAL_MODULE_EXPORTS&&Object.seal&&"object"==typeof n&&null!=n&&Object.seal(n),goog.loadedModules_[r]={exports:n,type:goog.ModuleType.GOOG,moduleId:goog.moduleLoaderState_.moduleName}}finally{goog.moduleLoaderState_=t}},goog.loadModuleFromSource_=function(a){return eval(a),{}},goog.normalizePath_=function(e){e=e.split("/");for(var t=0;t<e.length;)"."==e[t]?e.splice(t,1):t&&".."==e[t]&&e[t-1]&&".."!=e[t-1]?e.splice(--t,2):t++;return e.join("/")},goog.loadFileSync_=function(e){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(e);try{var t=new goog.global.XMLHttpRequest;return t.open("get",e,!1),t.send(),0==t.status||200==t.status?t.responseText:null}catch(e){return null}},goog.transpile_=function(e,t,n){var r=goog.global.$jscomp;r||(goog.global.$jscomp=r={});var i=r.transpile;if(!i){var o=goog.basePath+goog.TRANSPILER,a=goog.loadFileSync_(o);if(a){if(function(){(0,eval)(a+"\n//# sourceURL="+o)}.call(goog.global),goog.global.$gwtExport&&goog.global.$gwtExport.$jscomp&&!goog.global.$gwtExport.$jscomp.transpile)throw Error('The transpiler did not properly export the "transpile" method. $gwtExport: '+JSON.stringify(goog.global.$gwtExport));goog.global.$jscomp.transpile=goog.global.$gwtExport.$jscomp.transpile,i=(r=goog.global.$jscomp).transpile}}return i||(i=r.transpile=function(e,t){return goog.logToConsole_(t+" requires transpilation but no transpiler was found."),e}),i(e,t,n)},goog.typeOf=function(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t},goog.isArray=function(e){return"array"==goog.typeOf(e)},goog.isArrayLike=function(e){var t=goog.typeOf(e);return"array"==t||"object"==t&&"number"==typeof e.length},goog.isDateLike=function(e){return goog.isObject(e)&&"function"==typeof e.getFullYear},goog.isFunction=function(e){return"function"==goog.typeOf(e)},goog.isObject=function(e){var t=typeof e;return"object"==t&&null!=e||"function"==t},goog.getUid=function(e){return Object.prototype.hasOwnProperty.call(e,goog.UID_PROPERTY_)&&e[goog.UID_PROPERTY_]||(e[goog.UID_PROPERTY_]=++goog.uidCounter_)},goog.hasUid=function(e){return!!e[goog.UID_PROPERTY_]},goog.removeUid=function(e){null!==e&&"removeAttribute"in e&&e.removeAttribute(goog.UID_PROPERTY_);try{delete e[goog.UID_PROPERTY_]}catch(e){}},goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0),goog.uidCounter_=0,goog.getHashCode=goog.getUid,goog.removeHashCode=goog.removeUid,goog.cloneObject=function(e){var t=goog.typeOf(e);if("object"==t||"array"==t){if("function"==typeof e.clone)return e.clone();for(var n in t="array"==t?[]:{},e)t[n]=goog.cloneObject(e[n]);return t}return e},goog.bindNative_=function(e,t,n){return e.call.apply(e.bind,arguments)},goog.bindJs_=function(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}},goog.bind=function(e,t,n){return Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_,goog.bind.apply(null,arguments)},goog.partial=function(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}},goog.mixin=function(e,t){for(var n in t)e[n]=t[n]},goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date},goog.globalEval=function(e){if(goog.global.execScript)goog.global.execScript(e,"JavaScript");else{if(!goog.global.eval)throw Error("goog.globalEval not available");if(null==goog.evalWorksForGlobals_){try{goog.global.eval("var _evalTest_ = 1;")}catch(e){}if(void 0!==goog.global._evalTest_){try{delete goog.global._evalTest_}catch(e){}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1}if(goog.evalWorksForGlobals_)goog.global.eval(e);else{var t=goog.global.document,n=t.createElement("script");n.type="text/javascript",n.defer=!1,n.appendChild(t.createTextNode(e)),t.head.appendChild(n),t.head.removeChild(n)}}},goog.evalWorksForGlobals_=null,goog.getCssName=function(e,t){if("."==String(e).charAt(0))throw Error('className passed in goog.getCssName must not start with ".". You passed: '+e);var n=function(e){return goog.cssNameMapping_[e]||e},r=function(e){e=e.split("-");for(var t=[],r=0;r<e.length;r++)t.push(n(e[r]));return t.join("-")};return r=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?n:r:function(e){return e},e=t?e+"-"+r(t):r(e),goog.global.CLOSURE_CSS_NAME_MAP_FN?goog.global.CLOSURE_CSS_NAME_MAP_FN(e):e},goog.setCssNameMapping=function(e,t){goog.cssNameMapping_=e,goog.cssNameMappingStyle_=t},goog.getMsg=function(e,t,n){return n&&n.html&&(e=e.replace(/</g,"&lt;")),t&&(e=e.replace(/\{\$([^}]+)}/g,(function(e,n){return null!=t&&n in t?t[n]:e}))),e},goog.getMsgWithFallback=function(e,t){return e},goog.exportSymbol=function(e,t,n){goog.exportPath_(e,t,n)},goog.exportProperty=function(e,t,n){e[t]=n},goog.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.base=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}},goog.scope=function(e){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a module.");e.call(goog.global)},goog.defineClass=function(e,t){var n=t.constructor,r=t.statics;return n&&n!=Object.prototype.constructor||(n=function(){throw Error("cannot instantiate an interface (no constructor defined).")}),n=goog.defineClass.createSealingConstructor_(n,e),e&&goog.inherits(n,e),delete t.constructor,delete t.statics,goog.defineClass.applyProperties_(n.prototype,t),null!=r&&(r instanceof Function?r(n):goog.defineClass.applyProperties_(n,r)),n},goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG,goog.defineClass.createSealingConstructor_=function(e,t){if(!goog.defineClass.SEAL_CLASS_INSTANCES)return e;var n=!goog.defineClass.isUnsealable_(t),r=function(){var t=e.apply(this,arguments)||this;return t[goog.UID_PROPERTY_]=t[goog.UID_PROPERTY_],this.constructor===r&&n&&Object.seal instanceof Function&&Object.seal(t),t};return r},goog.defineClass.isUnsealable_=function(e){return e&&e.prototype&&e.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]},goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.defineClass.applyProperties_=function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);for(var r=0;r<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;r++)n=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[r],Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},goog.tagUnsealableClass=function(e){},goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable",goog.TRUSTED_TYPES_POLICY_NAME="",goog.identity_=function(e){return e},goog.createTrustedTypesPolicy=function(e){var t=null,n=goog.global.trustedTypes||goog.global.TrustedTypes;if(!n||!n.createPolicy)return t;try{t=n.createPolicy(e,{createHTML:goog.identity_,createScript:goog.identity_,createScriptURL:goog.identity_,createURL:goog.identity_})}catch(e){goog.logToConsole_(e.message)}return t},goog.TRUSTED_TYPES_POLICY_=goog.TRUSTED_TYPES_POLICY_NAME?goog.createTrustedTypesPolicy(goog.TRUSTED_TYPES_POLICY_NAME+"#base"):null,goog.object={},goog.object.is=function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t},goog.object.forEach=function(e,t,n){for(var r in e)t.call(n,e[r],r,e)},goog.object.filter=function(e,t,n){var r,i={};for(r in e)t.call(n,e[r],r,e)&&(i[r]=e[r]);return i},goog.object.map=function(e,t,n){var r,i={};for(r in e)i[r]=t.call(n,e[r],r,e);return i},goog.object.some=function(e,t,n){for(var r in e)if(t.call(n,e[r],r,e))return!0;return!1},goog.object.every=function(e,t,n){for(var r in e)if(!t.call(n,e[r],r,e))return!1;return!0},goog.object.getCount=function(e){var t,n=0;for(t in e)n++;return n},goog.object.getAnyKey=function(e){for(var t in e)return t},goog.object.getAnyValue=function(e){for(var t in e)return e[t]},goog.object.contains=function(e,t){return goog.object.containsValue(e,t)},goog.object.getValues=function(e){var t,n=[],r=0;for(t in e)n[r++]=e[t];return n},goog.object.getKeys=function(e){var t,n=[],r=0;for(t in e)n[r++]=t;return n},goog.object.getValueByKeys=function(e,t){var n=goog.isArrayLike(t),r=n?t:arguments;for(n=n?0:1;n<r.length;n++){if(null==e)return;e=e[r[n]]}return e},goog.object.containsKey=function(e,t){return null!==e&&t in e},goog.object.containsValue=function(e,t){for(var n in e)if(e[n]==t)return!0;return!1},goog.object.findKey=function(e,t,n){for(var r in e)if(t.call(n,e[r],r,e))return r},goog.object.findValue=function(e,t,n){return(t=goog.object.findKey(e,t,n))&&e[t]},goog.object.isEmpty=function(e){for(var t in e)return!1;return!0},goog.object.clear=function(e){for(var t in e)delete e[t]},goog.object.remove=function(e,t){var n;return(n=t in e)&&delete e[t],n},goog.object.add=function(e,t,n){if(null!==e&&t in e)throw Error('The object already contains the key "'+t+'"');goog.object.set(e,t,n)},goog.object.get=function(e,t,n){return null!==e&&t in e?e[t]:n},goog.object.set=function(e,t,n){e[t]=n},goog.object.setIfUndefined=function(e,t,n){return t in e?e[t]:e[t]=n},goog.object.setWithReturnValueIfNotSet=function(e,t,n){return t in e?e[t]:(n=n(),e[t]=n)},goog.object.equals=function(e,t){for(var n in e)if(!(n in t)||e[n]!==t[n])return!1;for(var r in t)if(!(r in e))return!1;return!0},goog.object.clone=function(e){var t,n={};for(t in e)n[t]=e[t];return n},goog.object.unsafeClone=function(e){var t=goog.typeOf(e);if("object"==t||"array"==t){if(goog.isFunction(e.clone))return e.clone();for(var n in t="array"==t?[]:{},e)t[n]=goog.object.unsafeClone(e[n]);return t}return e},goog.object.transpose=function(e){var t,n={};for(t in e)n[e[t]]=t;return n},goog.object.PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.object.extend=function(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<goog.object.PROTOTYPE_FIELDS_.length;o++)n=goog.object.PROTOTYPE_FIELDS_[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}},goog.object.create=function(e){var t=arguments.length;if(1==t&&Array.isArray(arguments[0]))return goog.object.create.apply(null,arguments[0]);if(t%2)throw Error("Uneven number of arguments");for(var n={},r=0;r<t;r+=2)n[arguments[r]]=arguments[r+1];return n},goog.object.createSet=function(e){var t=arguments.length;if(1==t&&Array.isArray(arguments[0]))return goog.object.createSet.apply(null,arguments[0]);for(var n={},r=0;r<t;r++)n[arguments[r]]=!0;return n},goog.object.createImmutableView=function(e){var t=e;return Object.isFrozen&&!Object.isFrozen(e)&&(t=Object.create(e),Object.freeze(t)),t},goog.object.isImmutableView=function(e){return!!Object.isFrozen&&Object.isFrozen(e)},goog.object.getAllPropertyNames=function(e,t,n){if(!e)return[];if(!Object.getOwnPropertyNames||!Object.getPrototypeOf)return goog.object.getKeys(e);for(var r={};e&&(e!==Object.prototype||t)&&(e!==Function.prototype||n);){for(var i=Object.getOwnPropertyNames(e),o=0;o<i.length;o++)r[i[o]]=!0;e=Object.getPrototypeOf(e)}return goog.object.getKeys(r)},goog.object.getSuperClass=function(e){return(e=Object.getPrototypeOf(e.prototype))&&e.constructor};var jspb={asserts:{}};jspb.asserts.doAssertFailure=function(e,t,n,r){var i="Assertion failed";if(n){i+=": "+n;var o=r}else e&&(i+=": "+e,o=t);throw Error(""+i,o||[])},jspb.asserts.assert=function(e,t,n){for(var r=[],i=2;i<arguments.length;++i)r[i-2]=arguments[i];return e||jspb.asserts.doAssertFailure("",null,t,r),e},jspb.asserts.assertString=function(e,t,n){for(var r=[],i=2;i<arguments.length;++i)r[i-2]=arguments[i];return"string"!=typeof e&&jspb.asserts.doAssertFailure("Expected string but got %s: %s.",[goog.typeOf(e),e],t,r),e},jspb.asserts.assertArray=function(e,t,n){for(var r=[],i=2;i<arguments.length;++i)r[i-2]=arguments[i];return Array.isArray(e)||jspb.asserts.doAssertFailure("Expected array but got %s: %s.",[goog.typeOf(e),e],t,r),e},jspb.asserts.fail=function(e,t){for(var n=[],r=1;r<arguments.length;++r)n[r-1]=arguments[r];throw Error("Failure"+(e?": "+e:""),n)},jspb.asserts.assertInstanceof=function(e,t,n,r){for(var i=[],o=3;o<arguments.length;++o)i[o-3]=arguments[o];return e instanceof t||jspb.asserts.doAssertFailure("Expected instanceof %s but got %s.",[jspb.asserts.getType(t),jspb.asserts.getType(e)],n,i),e},jspb.asserts.getType=function(e){return e instanceof Function?e.displayName||e.name||"unknown type name":e instanceof Object?e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e):null===e?"null":typeof e},jspb.BinaryConstants={},jspb.ConstBinaryMessage=function(){},jspb.BinaryMessage=function(){},jspb.BinaryConstants.FieldType={INVALID:-1,DOUBLE:1,FLOAT:2,INT64:3,UINT64:4,INT32:5,FIXED64:6,FIXED32:7,BOOL:8,STRING:9,GROUP:10,MESSAGE:11,BYTES:12,UINT32:13,ENUM:14,SFIXED32:15,SFIXED64:16,SINT32:17,SINT64:18,FHASH64:30,VHASH64:31},jspb.BinaryConstants.WireType={INVALID:-1,VARINT:0,FIXED64:1,DELIMITED:2,START_GROUP:3,END_GROUP:4,FIXED32:5},jspb.BinaryConstants.FieldTypeToWireType=function(e){var t=jspb.BinaryConstants.FieldType,n=jspb.BinaryConstants.WireType;switch(e){case t.INT32:case t.INT64:case t.UINT32:case t.UINT64:case t.SINT32:case t.SINT64:case t.BOOL:case t.ENUM:case t.VHASH64:return n.VARINT;case t.DOUBLE:case t.FIXED64:case t.SFIXED64:case t.FHASH64:return n.FIXED64;case t.STRING:case t.MESSAGE:case t.BYTES:return n.DELIMITED;case t.FLOAT:case t.FIXED32:case t.SFIXED32:return n.FIXED32;default:return n.INVALID}},jspb.BinaryConstants.INVALID_FIELD_NUMBER=-1,jspb.BinaryConstants.FLOAT32_EPS=1401298464324817e-60,jspb.BinaryConstants.FLOAT32_MIN=11754943508222875e-54,jspb.BinaryConstants.FLOAT32_MAX=34028234663852886e22,jspb.BinaryConstants.FLOAT64_EPS=5e-324,jspb.BinaryConstants.FLOAT64_MIN=22250738585072014e-324,jspb.BinaryConstants.FLOAT64_MAX=17976931348623157e292,jspb.BinaryConstants.TWO_TO_20=1048576,jspb.BinaryConstants.TWO_TO_23=8388608,jspb.BinaryConstants.TWO_TO_31=2147483648,jspb.BinaryConstants.TWO_TO_32=4294967296,jspb.BinaryConstants.TWO_TO_52=4503599627370496,jspb.BinaryConstants.TWO_TO_63=0x8000000000000000,jspb.BinaryConstants.TWO_TO_64=0x10000000000000000,jspb.BinaryConstants.ZERO_HASH="\0\0\0\0\0\0\0\0",goog.debug={},goog.debug.Error=function(e){if(Error.captureStackTrace)Error.captureStackTrace(this,goog.debug.Error);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e)),this.reportErrorToServer=!0},goog.inherits(goog.debug.Error,Error),goog.debug.Error.prototype.name="CustomError",goog.dom={},goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12},goog.asserts={},goog.asserts.ENABLE_ASSERTS=goog.DEBUG,goog.asserts.AssertionError=function(e,t){goog.debug.Error.call(this,goog.asserts.subs_(e,t)),this.messagePattern=e},goog.inherits(goog.asserts.AssertionError,goog.debug.Error),goog.asserts.AssertionError.prototype.name="AssertionError",goog.asserts.DEFAULT_ERROR_HANDLER=function(e){throw e},goog.asserts.errorHandler_=goog.asserts.DEFAULT_ERROR_HANDLER,goog.asserts.subs_=function(e,t){for(var n="",r=(e=e.split("%s")).length-1,i=0;i<r;i++)n+=e[i]+(i<t.length?t[i]:"%s");return n+e[r]},goog.asserts.doAssertFailure_=function(e,t,n,r){var i="Assertion failed";if(n){i+=": "+n;var o=r}else e&&(i+=": "+e,o=t);e=new goog.asserts.AssertionError(""+i,o||[]),goog.asserts.errorHandler_(e)},goog.asserts.setErrorHandler=function(e){goog.asserts.ENABLE_ASSERTS&&(goog.asserts.errorHandler_=e)},goog.asserts.assert=function(e,t,n){return goog.asserts.ENABLE_ASSERTS&&!e&&goog.asserts.doAssertFailure_("",null,t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertExists=function(e,t,n){return goog.asserts.ENABLE_ASSERTS&&null==e&&goog.asserts.doAssertFailure_("Expected to exist: %s.",[e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.fail=function(e,t){goog.asserts.ENABLE_ASSERTS&&goog.asserts.errorHandler_(new goog.asserts.AssertionError("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1)))},goog.asserts.assertNumber=function(e,t,n){return goog.asserts.ENABLE_ASSERTS&&"number"!=typeof e&&goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertString=function(e,t,n){return goog.asserts.ENABLE_ASSERTS&&"string"!=typeof e&&goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertFunction=function(e,t,n){return goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(e)&&goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertObject=function(e,t,n){return goog.asserts.ENABLE_ASSERTS&&!goog.isObject(e)&&goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertArray=function(e,t,n){return goog.asserts.ENABLE_ASSERTS&&!Array.isArray(e)&&goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertBoolean=function(e,t,n){return goog.asserts.ENABLE_ASSERTS&&"boolean"!=typeof e&&goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertElement=function(e,t,n){return!goog.asserts.ENABLE_ASSERTS||goog.isObject(e)&&e.nodeType==goog.dom.NodeType.ELEMENT||goog.asserts.doAssertFailure_("Expected Element but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertInstanceof=function(e,t,n,r){return!goog.asserts.ENABLE_ASSERTS||e instanceof t||goog.asserts.doAssertFailure_("Expected instanceof %s but got %s.",[goog.asserts.getType_(t),goog.asserts.getType_(e)],n,Array.prototype.slice.call(arguments,3)),e},goog.asserts.assertFinite=function(e,t,n){return!goog.asserts.ENABLE_ASSERTS||"number"==typeof e&&isFinite(e)||goog.asserts.doAssertFailure_("Expected %s to be a finite number but it is not.",[e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertObjectPrototypeIsIntact=function(){for(var e in Object.prototype)goog.asserts.fail(e+" should not be enumerable in Object.prototype.")},goog.asserts.getType_=function(e){return e instanceof Function?e.displayName||e.name||"unknown type name":e instanceof Object?e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e):null===e?"null":typeof e},goog.array={},goog.NATIVE_ARRAY_PROTOTYPES=goog.TRUSTED_SITE,goog.array.ASSUME_NATIVE_FUNCTIONS=2012<goog.FEATURESET_YEAR,goog.array.peek=function(e){return e[e.length-1]},goog.array.last=goog.array.peek,goog.array.indexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.indexOf)?function(e,t,n){return goog.asserts.assert(null!=e.length),Array.prototype.indexOf.call(e,t,n)}:function(e,t,n){if(n=null==n?0:0>n?Math.max(0,e.length+n):n,"string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,n);for(;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},goog.array.lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.lastIndexOf)?function(e,t,n){return goog.asserts.assert(null!=e.length),Array.prototype.lastIndexOf.call(e,t,null==n?e.length-1:n)}:function(e,t,n){if(0>(n=null==n?e.length-1:n)&&(n=Math.max(0,e.length+n)),"string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.lastIndexOf(t,n);for(;0<=n;n--)if(n in e&&e[n]===t)return n;return-1},goog.array.forEach=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.forEach)?function(e,t,n){goog.asserts.assert(null!=e.length),Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)},goog.array.forEachRight=function(e,t,n){var r=e.length,i="string"==typeof e?e.split(""):e;for(--r;0<=r;--r)r in i&&t.call(n,i[r],r,e)},goog.array.filter=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.filter)?function(e,t,n){return goog.asserts.assert(null!=e.length),Array.prototype.filter.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=[],o=0,a="string"==typeof e?e.split(""):e,s=0;s<r;s++)if(s in a){var u=a[s];t.call(n,u,s,e)&&(i[o++]=u)}return i},goog.array.map=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.map)?function(e,t,n){return goog.asserts.assert(null!=e.length),Array.prototype.map.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=Array(r),o="string"==typeof e?e.split(""):e,a=0;a<r;a++)a in o&&(i[a]=t.call(n,o[a],a,e));return i},goog.array.reduce=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduce)?function(e,t,n,r){return goog.asserts.assert(null!=e.length),r&&(t=goog.bind(t,r)),Array.prototype.reduce.call(e,t,n)}:function(e,t,n,r){var i=n;return goog.array.forEach(e,(function(n,o){i=t.call(r,i,n,o,e)})),i},goog.array.reduceRight=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduceRight)?function(e,t,n,r){return goog.asserts.assert(null!=e.length),goog.asserts.assert(null!=t),r&&(t=goog.bind(t,r)),Array.prototype.reduceRight.call(e,t,n)}:function(e,t,n,r){var i=n;return goog.array.forEachRight(e,(function(n,o){i=t.call(r,i,n,o,e)})),i},goog.array.some=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.some)?function(e,t,n){return goog.asserts.assert(null!=e.length),Array.prototype.some.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,o=0;o<r;o++)if(o in i&&t.call(n,i[o],o,e))return!0;return!1},goog.array.every=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.every)?function(e,t,n){return goog.asserts.assert(null!=e.length),Array.prototype.every.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,o=0;o<r;o++)if(o in i&&!t.call(n,i[o],o,e))return!1;return!0},goog.array.count=function(e,t,n){var r=0;return goog.array.forEach(e,(function(e,i,o){t.call(n,e,i,o)&&++r}),n),r},goog.array.find=function(e,t,n){return 0>(t=goog.array.findIndex(e,t,n))?null:"string"==typeof e?e.charAt(t):e[t]},goog.array.findIndex=function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,o=0;o<r;o++)if(o in i&&t.call(n,i[o],o,e))return o;return-1},goog.array.findRight=function(e,t,n){return 0>(t=goog.array.findIndexRight(e,t,n))?null:"string"==typeof e?e.charAt(t):e[t]},goog.array.findIndexRight=function(e,t,n){var r=e.length,i="string"==typeof e?e.split(""):e;for(--r;0<=r;r--)if(r in i&&t.call(n,i[r],r,e))return r;return-1},goog.array.contains=function(e,t){return 0<=goog.array.indexOf(e,t)},goog.array.isEmpty=function(e){return 0==e.length},goog.array.clear=function(e){if(!Array.isArray(e))for(var t=e.length-1;0<=t;t--)delete e[t];e.length=0},goog.array.insert=function(e,t){goog.array.contains(e,t)||e.push(t)},goog.array.insertAt=function(e,t,n){goog.array.splice(e,n,0,t)},goog.array.insertArrayAt=function(e,t,n){goog.partial(goog.array.splice,e,n,0).apply(null,t)},goog.array.insertBefore=function(e,t,n){var r;2==arguments.length||0>(r=goog.array.indexOf(e,n))?e.push(t):goog.array.insertAt(e,t,r)},goog.array.remove=function(e,t){var n;return(n=0<=(t=goog.array.indexOf(e,t)))&&goog.array.removeAt(e,t),n},goog.array.removeLast=function(e,t){return 0<=(t=goog.array.lastIndexOf(e,t))&&(goog.array.removeAt(e,t),!0)},goog.array.removeAt=function(e,t){return goog.asserts.assert(null!=e.length),1==Array.prototype.splice.call(e,t,1).length},goog.array.removeIf=function(e,t,n){return 0<=(t=goog.array.findIndex(e,t,n))&&(goog.array.removeAt(e,t),!0)},goog.array.removeAllIf=function(e,t,n){var r=0;return goog.array.forEachRight(e,(function(i,o){t.call(n,i,o,e)&&goog.array.removeAt(e,o)&&r++})),r},goog.array.concat=function(e){return Array.prototype.concat.apply([],arguments)},goog.array.join=function(e){return Array.prototype.concat.apply([],arguments)},goog.array.toArray=function(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]},goog.array.clone=goog.array.toArray,goog.array.extend=function(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(goog.isArrayLike(r)){var i=e.length||0,o=r.length||0;e.length=i+o;for(var a=0;a<o;a++)e[i+a]=r[a]}else e.push(r)}},goog.array.splice=function(e,t,n,r){return goog.asserts.assert(null!=e.length),Array.prototype.splice.apply(e,goog.array.slice(arguments,1))},goog.array.slice=function(e,t,n){return goog.asserts.assert(null!=e.length),2>=arguments.length?Array.prototype.slice.call(e,t):Array.prototype.slice.call(e,t,n)},goog.array.removeDuplicates=function(e,t,n){t=t||e;var r=function(e){return goog.isObject(e)?"o"+goog.getUid(e):(typeof e).charAt(0)+e};n=n||r,r={};for(var i=0,o=0;o<e.length;){var a=e[o++],s=n(a);Object.prototype.hasOwnProperty.call(r,s)||(r[s]=!0,t[i++]=a)}t.length=i},goog.array.binarySearch=function(e,t,n){return goog.array.binarySearch_(e,n||goog.array.defaultCompare,!1,t)},goog.array.binarySelect=function(e,t,n){return goog.array.binarySearch_(e,t,!0,void 0,n)},goog.array.binarySearch_=function(e,t,n,r,i){for(var o,a=0,s=e.length;a<s;){var u=a+(s-a>>>1),l=n?t.call(i,e[u],u,e):t(r,e[u]);0<l?a=u+1:(s=u,o=!l)}return o?a:-a-1},goog.array.sort=function(e,t){e.sort(t||goog.array.defaultCompare)},goog.array.stableSort=function(e,t){for(var n=Array(e.length),r=0;r<e.length;r++)n[r]={index:r,value:e[r]};var i=t||goog.array.defaultCompare;for(goog.array.sort(n,(function(e,t){return i(e.value,t.value)||e.index-t.index})),r=0;r<e.length;r++)e[r]=n[r].value},goog.array.sortByKey=function(e,t,n){var r=n||goog.array.defaultCompare;goog.array.sort(e,(function(e,n){return r(t(e),t(n))}))},goog.array.sortObjectsByKey=function(e,t,n){goog.array.sortByKey(e,(function(e){return e[t]}),n)},goog.array.isSorted=function(e,t,n){t=t||goog.array.defaultCompare;for(var r=1;r<e.length;r++){var i=t(e[r-1],e[r]);if(0<i||0==i&&n)return!1}return!0},goog.array.equals=function(e,t,n){if(!goog.isArrayLike(e)||!goog.isArrayLike(t)||e.length!=t.length)return!1;var r=e.length;n=n||goog.array.defaultCompareEquality;for(var i=0;i<r;i++)if(!n(e[i],t[i]))return!1;return!0},goog.array.compare3=function(e,t,n){n=n||goog.array.defaultCompare;for(var r=Math.min(e.length,t.length),i=0;i<r;i++){var o=n(e[i],t[i]);if(0!=o)return o}return goog.array.defaultCompare(e.length,t.length)},goog.array.defaultCompare=function(e,t){return e>t?1:e<t?-1:0},goog.array.inverseDefaultCompare=function(e,t){return-goog.array.defaultCompare(e,t)},goog.array.defaultCompareEquality=function(e,t){return e===t},goog.array.binaryInsert=function(e,t,n){return 0>(n=goog.array.binarySearch(e,t,n))&&(goog.array.insertAt(e,t,-(n+1)),!0)},goog.array.binaryRemove=function(e,t,n){return 0<=(t=goog.array.binarySearch(e,t,n))&&goog.array.removeAt(e,t)},goog.array.bucket=function(e,t,n){for(var r={},i=0;i<e.length;i++){var o=e[i],a=t.call(n,o,i,e);void 0!==a&&(r[a]||(r[a]=[])).push(o)}return r},goog.array.toObject=function(e,t,n){var r={};return goog.array.forEach(e,(function(i,o){r[t.call(n,i,o,e)]=i})),r},goog.array.range=function(e,t,n){var r=[],i=0,o=e;if(void 0!==t&&(i=e,o=t),0>(n=n||1)*(o-i))return[];if(0<n)for(e=i;e<o;e+=n)r.push(e);else for(e=i;e>o;e+=n)r.push(e);return r},goog.array.repeat=function(e,t){for(var n=[],r=0;r<t;r++)n[r]=e;return n},goog.array.flatten=function(e){for(var t=[],n=0;n<arguments.length;n++){var r=arguments[n];if(Array.isArray(r))for(var i=0;i<r.length;i+=8192){var o=goog.array.slice(r,i,i+8192);o=goog.array.flatten.apply(null,o);for(var a=0;a<o.length;a++)t.push(o[a])}else t.push(r)}return t},goog.array.rotate=function(e,t){return goog.asserts.assert(null!=e.length),e.length&&(0<(t%=e.length)?Array.prototype.unshift.apply(e,e.splice(-t,t)):0>t&&Array.prototype.push.apply(e,e.splice(0,-t))),e},goog.array.moveItem=function(e,t,n){goog.asserts.assert(0<=t&&t<e.length),goog.asserts.assert(0<=n&&n<e.length),t=Array.prototype.splice.call(e,t,1),Array.prototype.splice.call(e,n,0,t[0])},goog.array.zip=function(e){if(!arguments.length)return[];for(var t=[],n=arguments[0].length,r=1;r<arguments.length;r++)arguments[r].length<n&&(n=arguments[r].length);for(r=0;r<n;r++){for(var i=[],o=0;o<arguments.length;o++)i.push(arguments[o][r]);t.push(i)}return t},goog.array.shuffle=function(e,t){t=t||Math.random;for(var n=e.length-1;0<n;n--){var r=Math.floor(t()*(n+1)),i=e[n];e[n]=e[r],e[r]=i}},goog.array.copyByIndex=function(e,t){var n=[];return goog.array.forEach(t,(function(t){n.push(e[t])})),n},goog.array.concatMap=function(e,t,n){return goog.array.concat.apply([],goog.array.map(e,t,n))},goog.crypt={},goog.crypt.stringToByteArray=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);255<i&&(t[n++]=255&i,i>>=8),t[n++]=i}return t},goog.crypt.byteArrayToString=function(e){if(8192>=e.length)return String.fromCharCode.apply(null,e);for(var t="",n=0;n<e.length;n+=8192){var r=goog.array.slice(e,n,n+8192);t+=String.fromCharCode.apply(null,r)}return t},goog.crypt.byteArrayToHex=function(e,t){return goog.array.map(e,(function(e){return 1<(e=e.toString(16)).length?e:"0"+e})).join(t||"")},goog.crypt.hexToByteArray=function(e){goog.asserts.assert(0==e.length%2,"Key string length must be multiple of 2");for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substring(n,n+2),16));return t},goog.crypt.stringToUtf8ByteArray=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);128>i?t[n++]=i:(2048>i?t[n++]=i>>6|192:(55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128):t[n++]=i>>12|224,t[n++]=i>>6&63|128),t[n++]=63&i|128)}return t},goog.crypt.utf8ByteArrayToString=function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(128>i)t[r++]=String.fromCharCode(i);else if(191<i&&224>i){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&365>i){o=e[n++];var a=e[n++];i=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&e[n++])-65536,t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))}else o=e[n++],a=e[n++],t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}return t.join("")},goog.crypt.xorByteArray=function(e,t){goog.asserts.assert(e.length==t.length,"XOR array lengths must match");for(var n=[],r=0;r<e.length;r++)n.push(e[r]^t[r]);return n},goog.dom.asserts={},goog.dom.asserts.assertIsLocation=function(e){if(goog.asserts.ENABLE_ASSERTS){var t=goog.dom.asserts.getWindow_(e);t&&(!e||!(e instanceof t.Location)&&e instanceof t.Element)&&goog.asserts.fail("Argument is not a Location (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(e))}return e},goog.dom.asserts.assertIsElementType_=function(e,t){if(goog.asserts.ENABLE_ASSERTS){var n=goog.dom.asserts.getWindow_(e);n&&void 0!==n[t]&&(e&&(e instanceof n[t]||!(e instanceof n.Location||e instanceof n.Element))||goog.asserts.fail("Argument is not a %s (or a non-Element, non-Location mock); got: %s",t,goog.dom.asserts.debugStringForType_(e)))}return e},goog.dom.asserts.assertIsHTMLAnchorElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLAnchorElement")},goog.dom.asserts.assertIsHTMLButtonElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLButtonElement")},goog.dom.asserts.assertIsHTMLLinkElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLLinkElement")},goog.dom.asserts.assertIsHTMLImageElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLImageElement")},goog.dom.asserts.assertIsHTMLAudioElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLAudioElement")},goog.dom.asserts.assertIsHTMLVideoElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLVideoElement")},goog.dom.asserts.assertIsHTMLInputElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLInputElement")},goog.dom.asserts.assertIsHTMLTextAreaElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLTextAreaElement")},goog.dom.asserts.assertIsHTMLCanvasElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLCanvasElement")},goog.dom.asserts.assertIsHTMLEmbedElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLEmbedElement")},goog.dom.asserts.assertIsHTMLFormElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLFormElement")},goog.dom.asserts.assertIsHTMLFrameElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLFrameElement")},goog.dom.asserts.assertIsHTMLIFrameElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLIFrameElement")},goog.dom.asserts.assertIsHTMLObjectElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLObjectElement")},goog.dom.asserts.assertIsHTMLScriptElement=function(e){return goog.dom.asserts.assertIsElementType_(e,"HTMLScriptElement")},goog.dom.asserts.debugStringForType_=function(e){if(!goog.isObject(e))return void 0===e?"undefined":null===e?"null":typeof e;try{return e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e)}catch(e){return"<object could not be stringified>"}},goog.dom.asserts.getWindow_=function(e){try{var t=e&&e.ownerDocument,n=t&&(t.defaultView||t.parentWindow);if((n=n||goog.global).Element&&n.Location)return n}catch(e){}return null},goog.functions={},goog.functions.constant=function(e){return function(){return e}},goog.functions.FALSE=function(){return!1},goog.functions.TRUE=function(){return!0},goog.functions.NULL=function(){return null},goog.functions.identity=function(e,t){return e},goog.functions.error=function(e){return function(){throw Error(e)}},goog.functions.fail=function(e){return function(){throw e}},goog.functions.lock=function(e,t){return t=t||0,function(){return e.apply(this,Array.prototype.slice.call(arguments,0,t))}},goog.functions.nth=function(e){return function(){return arguments[e]}},goog.functions.partialRight=function(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=Array.prototype.slice.call(arguments);return t.push.apply(t,n),e.apply(this,t)}},goog.functions.withReturnValue=function(e,t){return goog.functions.sequence(e,goog.functions.constant(t))},goog.functions.equalTo=function(e,t){return function(n){return t?e==n:e===n}},goog.functions.compose=function(e,t){var n=arguments,r=n.length;return function(){var e;r&&(e=n[r-1].apply(this,arguments));for(var t=r-2;0<=t;t--)e=n[t].call(this,e);return e}},goog.functions.sequence=function(e){var t=arguments,n=t.length;return function(){for(var e,r=0;r<n;r++)e=t[r].apply(this,arguments);return e}},goog.functions.and=function(e){var t=arguments,n=t.length;return function(){for(var e=0;e<n;e++)if(!t[e].apply(this,arguments))return!1;return!0}},goog.functions.or=function(e){var t=arguments,n=t.length;return function(){for(var e=0;e<n;e++)if(t[e].apply(this,arguments))return!0;return!1}},goog.functions.not=function(e){return function(){return!e.apply(this,arguments)}},goog.functions.create=function(e,t){var n=function(){};return n.prototype=e.prototype,n=new n,e.apply(n,Array.prototype.slice.call(arguments,1)),n},goog.functions.CACHE_RETURN_VALUE=!0,goog.functions.cacheReturnValue=function(e){var t,n=!1;return function(){return goog.functions.CACHE_RETURN_VALUE?(n||(t=e(),n=!0),t):e()}},goog.functions.once=function(e){var t=e;return function(){if(t){var e=t;t=null,e()}}},goog.functions.debounce=function(e,t,n){var r=0;return function(i){goog.global.clearTimeout(r);var o=arguments;r=goog.global.setTimeout((function(){e.apply(n,o)}),t)}},goog.functions.throttle=function(e,t,n){var r=0,i=!1,o=[],a=function(){r=0,i&&(i=!1,s())},s=function(){r=goog.global.setTimeout(a,t),e.apply(n,o)};return function(e){o=arguments,r?i=!0:s()}},goog.functions.rateLimit=function(e,t,n){var r=0,i=function(){r=0};return function(o){r||(r=goog.global.setTimeout(i,t),e.apply(n,arguments))}},goog.dom.HtmlElement=function(){},goog.dom.TagName=function(e){this.tagName_=e},goog.dom.TagName.prototype.toString=function(){return this.tagName_},goog.dom.TagName.A=new goog.dom.TagName("A"),goog.dom.TagName.ABBR=new goog.dom.TagName("ABBR"),goog.dom.TagName.ACRONYM=new goog.dom.TagName("ACRONYM"),goog.dom.TagName.ADDRESS=new goog.dom.TagName("ADDRESS"),goog.dom.TagName.APPLET=new goog.dom.TagName("APPLET"),goog.dom.TagName.AREA=new goog.dom.TagName("AREA"),goog.dom.TagName.ARTICLE=new goog.dom.TagName("ARTICLE"),goog.dom.TagName.ASIDE=new goog.dom.TagName("ASIDE"),goog.dom.TagName.AUDIO=new goog.dom.TagName("AUDIO"),goog.dom.TagName.B=new goog.dom.TagName("B"),goog.dom.TagName.BASE=new goog.dom.TagName("BASE"),goog.dom.TagName.BASEFONT=new goog.dom.TagName("BASEFONT"),goog.dom.TagName.BDI=new goog.dom.TagName("BDI"),goog.dom.TagName.BDO=new goog.dom.TagName("BDO"),goog.dom.TagName.BIG=new goog.dom.TagName("BIG"),goog.dom.TagName.BLOCKQUOTE=new goog.dom.TagName("BLOCKQUOTE"),goog.dom.TagName.BODY=new goog.dom.TagName("BODY"),goog.dom.TagName.BR=new goog.dom.TagName("BR"),goog.dom.TagName.BUTTON=new goog.dom.TagName("BUTTON"),goog.dom.TagName.CANVAS=new goog.dom.TagName("CANVAS"),goog.dom.TagName.CAPTION=new goog.dom.TagName("CAPTION"),goog.dom.TagName.CENTER=new goog.dom.TagName("CENTER"),goog.dom.TagName.CITE=new goog.dom.TagName("CITE"),goog.dom.TagName.CODE=new goog.dom.TagName("CODE"),goog.dom.TagName.COL=new goog.dom.TagName("COL"),goog.dom.TagName.COLGROUP=new goog.dom.TagName("COLGROUP"),goog.dom.TagName.COMMAND=new goog.dom.TagName("COMMAND"),goog.dom.TagName.DATA=new goog.dom.TagName("DATA"),goog.dom.TagName.DATALIST=new goog.dom.TagName("DATALIST"),goog.dom.TagName.DD=new goog.dom.TagName("DD"),goog.dom.TagName.DEL=new goog.dom.TagName("DEL"),goog.dom.TagName.DETAILS=new goog.dom.TagName("DETAILS"),goog.dom.TagName.DFN=new goog.dom.TagName("DFN"),goog.dom.TagName.DIALOG=new goog.dom.TagName("DIALOG"),goog.dom.TagName.DIR=new goog.dom.TagName("DIR"),goog.dom.TagName.DIV=new goog.dom.TagName("DIV"),goog.dom.TagName.DL=new goog.dom.TagName("DL"),goog.dom.TagName.DT=new goog.dom.TagName("DT"),goog.dom.TagName.EM=new goog.dom.TagName("EM"),goog.dom.TagName.EMBED=new goog.dom.TagName("EMBED"),goog.dom.TagName.FIELDSET=new goog.dom.TagName("FIELDSET"),goog.dom.TagName.FIGCAPTION=new goog.dom.TagName("FIGCAPTION"),goog.dom.TagName.FIGURE=new goog.dom.TagName("FIGURE"),goog.dom.TagName.FONT=new goog.dom.TagName("FONT"),goog.dom.TagName.FOOTER=new goog.dom.TagName("FOOTER"),goog.dom.TagName.FORM=new goog.dom.TagName("FORM"),goog.dom.TagName.FRAME=new goog.dom.TagName("FRAME"),goog.dom.TagName.FRAMESET=new goog.dom.TagName("FRAMESET"),goog.dom.TagName.H1=new goog.dom.TagName("H1"),goog.dom.TagName.H2=new goog.dom.TagName("H2"),goog.dom.TagName.H3=new goog.dom.TagName("H3"),goog.dom.TagName.H4=new goog.dom.TagName("H4"),goog.dom.TagName.H5=new goog.dom.TagName("H5"),goog.dom.TagName.H6=new goog.dom.TagName("H6"),goog.dom.TagName.HEAD=new goog.dom.TagName("HEAD"),goog.dom.TagName.HEADER=new goog.dom.TagName("HEADER"),goog.dom.TagName.HGROUP=new goog.dom.TagName("HGROUP"),goog.dom.TagName.HR=new goog.dom.TagName("HR"),goog.dom.TagName.HTML=new goog.dom.TagName("HTML"),goog.dom.TagName.I=new goog.dom.TagName("I"),goog.dom.TagName.IFRAME=new goog.dom.TagName("IFRAME"),goog.dom.TagName.IMG=new goog.dom.TagName("IMG"),goog.dom.TagName.INPUT=new goog.dom.TagName("INPUT"),goog.dom.TagName.INS=new goog.dom.TagName("INS"),goog.dom.TagName.ISINDEX=new goog.dom.TagName("ISINDEX"),goog.dom.TagName.KBD=new goog.dom.TagName("KBD"),goog.dom.TagName.KEYGEN=new goog.dom.TagName("KEYGEN"),goog.dom.TagName.LABEL=new goog.dom.TagName("LABEL"),goog.dom.TagName.LEGEND=new goog.dom.TagName("LEGEND"),goog.dom.TagName.LI=new goog.dom.TagName("LI"),goog.dom.TagName.LINK=new goog.dom.TagName("LINK"),goog.dom.TagName.MAIN=new goog.dom.TagName("MAIN"),goog.dom.TagName.MAP=new goog.dom.TagName("MAP"),goog.dom.TagName.MARK=new goog.dom.TagName("MARK"),goog.dom.TagName.MATH=new goog.dom.TagName("MATH"),goog.dom.TagName.MENU=new goog.dom.TagName("MENU"),goog.dom.TagName.MENUITEM=new goog.dom.TagName("MENUITEM"),goog.dom.TagName.META=new goog.dom.TagName("META"),goog.dom.TagName.METER=new goog.dom.TagName("METER"),goog.dom.TagName.NAV=new goog.dom.TagName("NAV"),goog.dom.TagName.NOFRAMES=new goog.dom.TagName("NOFRAMES"),goog.dom.TagName.NOSCRIPT=new goog.dom.TagName("NOSCRIPT"),goog.dom.TagName.OBJECT=new goog.dom.TagName("OBJECT"),goog.dom.TagName.OL=new goog.dom.TagName("OL"),goog.dom.TagName.OPTGROUP=new goog.dom.TagName("OPTGROUP"),goog.dom.TagName.OPTION=new goog.dom.TagName("OPTION"),goog.dom.TagName.OUTPUT=new goog.dom.TagName("OUTPUT"),goog.dom.TagName.P=new goog.dom.TagName("P"),goog.dom.TagName.PARAM=new goog.dom.TagName("PARAM"),goog.dom.TagName.PICTURE=new goog.dom.TagName("PICTURE"),goog.dom.TagName.PRE=new goog.dom.TagName("PRE"),goog.dom.TagName.PROGRESS=new goog.dom.TagName("PROGRESS"),goog.dom.TagName.Q=new goog.dom.TagName("Q"),goog.dom.TagName.RP=new goog.dom.TagName("RP"),goog.dom.TagName.RT=new goog.dom.TagName("RT"),goog.dom.TagName.RTC=new goog.dom.TagName("RTC"),goog.dom.TagName.RUBY=new goog.dom.TagName("RUBY"),goog.dom.TagName.S=new goog.dom.TagName("S"),goog.dom.TagName.SAMP=new goog.dom.TagName("SAMP"),goog.dom.TagName.SCRIPT=new goog.dom.TagName("SCRIPT"),goog.dom.TagName.SECTION=new goog.dom.TagName("SECTION"),goog.dom.TagName.SELECT=new goog.dom.TagName("SELECT"),goog.dom.TagName.SMALL=new goog.dom.TagName("SMALL"),goog.dom.TagName.SOURCE=new goog.dom.TagName("SOURCE"),goog.dom.TagName.SPAN=new goog.dom.TagName("SPAN"),goog.dom.TagName.STRIKE=new goog.dom.TagName("STRIKE"),goog.dom.TagName.STRONG=new goog.dom.TagName("STRONG"),goog.dom.TagName.STYLE=new goog.dom.TagName("STYLE"),goog.dom.TagName.SUB=new goog.dom.TagName("SUB"),goog.dom.TagName.SUMMARY=new goog.dom.TagName("SUMMARY"),goog.dom.TagName.SUP=new goog.dom.TagName("SUP"),goog.dom.TagName.SVG=new goog.dom.TagName("SVG"),goog.dom.TagName.TABLE=new goog.dom.TagName("TABLE"),goog.dom.TagName.TBODY=new goog.dom.TagName("TBODY"),goog.dom.TagName.TD=new goog.dom.TagName("TD"),goog.dom.TagName.TEMPLATE=new goog.dom.TagName("TEMPLATE"),goog.dom.TagName.TEXTAREA=new goog.dom.TagName("TEXTAREA"),goog.dom.TagName.TFOOT=new goog.dom.TagName("TFOOT"),goog.dom.TagName.TH=new goog.dom.TagName("TH"),goog.dom.TagName.THEAD=new goog.dom.TagName("THEAD"),goog.dom.TagName.TIME=new goog.dom.TagName("TIME"),goog.dom.TagName.TITLE=new goog.dom.TagName("TITLE"),goog.dom.TagName.TR=new goog.dom.TagName("TR"),goog.dom.TagName.TRACK=new goog.dom.TagName("TRACK"),goog.dom.TagName.TT=new goog.dom.TagName("TT"),goog.dom.TagName.U=new goog.dom.TagName("U"),goog.dom.TagName.UL=new goog.dom.TagName("UL"),goog.dom.TagName.VAR=new goog.dom.TagName("VAR"),goog.dom.TagName.VIDEO=new goog.dom.TagName("VIDEO"),goog.dom.TagName.WBR=new goog.dom.TagName("WBR"),goog.dom.tags={},goog.dom.tags.VOID_TAGS_={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},goog.dom.tags.isVoidTag=function(e){return!0===goog.dom.tags.VOID_TAGS_[e]},goog.html={},goog.html.trustedtypes={},goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY=goog.TRUSTED_TYPES_POLICY_NAME?goog.createTrustedTypesPolicy(goog.TRUSTED_TYPES_POLICY_NAME+"#html"):null,goog.string={},goog.string.TypedString=function(){},goog.string.Const=function(e,t){this.stringConstValueWithSecurityContract__googStringSecurityPrivate_=e===goog.string.Const.GOOG_STRING_CONSTRUCTOR_TOKEN_PRIVATE_&&t||"",this.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_=goog.string.Const.TYPE_MARKER_},goog.string.Const.prototype.implementsGoogStringTypedString=!0,goog.string.Const.prototype.getTypedStringValue=function(){return this.stringConstValueWithSecurityContract__googStringSecurityPrivate_},goog.DEBUG&&(goog.string.Const.prototype.toString=function(){return"Const{"+this.stringConstValueWithSecurityContract__googStringSecurityPrivate_+"}"}),goog.string.Const.unwrap=function(e){return e instanceof goog.string.Const&&e.constructor===goog.string.Const&&e.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_===goog.string.Const.TYPE_MARKER_?e.stringConstValueWithSecurityContract__googStringSecurityPrivate_:(goog.asserts.fail("expected object of type Const, got '"+e+"'"),"type_error:Const")},goog.string.Const.from=function(e){return new goog.string.Const(goog.string.Const.GOOG_STRING_CONSTRUCTOR_TOKEN_PRIVATE_,e)},goog.string.Const.TYPE_MARKER_={},goog.string.Const.GOOG_STRING_CONSTRUCTOR_TOKEN_PRIVATE_={},goog.string.Const.EMPTY=goog.string.Const.from(""),goog.html.SafeScript=function(){this.privateDoNotAccessOrElseSafeScriptWrappedValue_="",this.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.SafeScript.prototype.implementsGoogStringTypedString=!0,goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeScript.fromConstant=function(e){return 0===(e=goog.string.Const.unwrap(e)).length?goog.html.SafeScript.EMPTY:goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(e)},goog.html.SafeScript.fromConstantAndArgs=function(e,t){for(var n=[],r=1;r<arguments.length;r++)n.push(goog.html.SafeScript.stringify_(arguments[r]));return goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse("("+goog.string.Const.unwrap(e)+")("+n.join(", ")+");")},goog.html.SafeScript.fromJson=function(e){return goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(goog.html.SafeScript.stringify_(e))},goog.html.SafeScript.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeScriptWrappedValue_.toString()},goog.DEBUG&&(goog.html.SafeScript.prototype.toString=function(){return"SafeScript{"+this.privateDoNotAccessOrElseSafeScriptWrappedValue_+"}"}),goog.html.SafeScript.unwrap=function(e){return goog.html.SafeScript.unwrapTrustedScript(e).toString()},goog.html.SafeScript.unwrapTrustedScript=function(e){return e instanceof goog.html.SafeScript&&e.constructor===goog.html.SafeScript&&e.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?e.privateDoNotAccessOrElseSafeScriptWrappedValue_:(goog.asserts.fail("expected object of type SafeScript, got '"+e+"' of type "+goog.typeOf(e)),"type_error:SafeScript")},goog.html.SafeScript.stringify_=function(e){return JSON.stringify(e).replace(/</g,"\\x3c")},goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse=function(e){return(new goog.html.SafeScript).initSecurityPrivateDoNotAccessOrElse_(e)},goog.html.SafeScript.prototype.initSecurityPrivateDoNotAccessOrElse_=function(e){return this.privateDoNotAccessOrElseSafeScriptWrappedValue_=goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY?goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY.createScript(e):e,this},goog.html.SafeScript.EMPTY=goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(""),goog.fs={},goog.fs.url={},goog.fs.url.createObjectUrl=function(e){return goog.fs.url.getUrlObject_().createObjectURL(e)},goog.fs.url.revokeObjectUrl=function(e){goog.fs.url.getUrlObject_().revokeObjectURL(e)},goog.fs.url.UrlObject_=function(){},goog.fs.url.UrlObject_.prototype.createObjectURL=function(e){},goog.fs.url.UrlObject_.prototype.revokeObjectURL=function(e){},goog.fs.url.getUrlObject_=function(){var e=goog.fs.url.findUrlObject_();if(null!=e)return e;throw Error("This browser doesn't seem to support blob URLs")},goog.fs.url.findUrlObject_=function(){return void 0!==goog.global.URL&&void 0!==goog.global.URL.createObjectURL?goog.global.URL:void 0!==goog.global.webkitURL&&void 0!==goog.global.webkitURL.createObjectURL?goog.global.webkitURL:void 0!==goog.global.createObjectURL?goog.global:null},goog.fs.url.browserSupportsObjectUrls=function(){return null!=goog.fs.url.findUrlObject_()},goog.fs.blob={},goog.fs.blob.getBlob=function(e){var t=goog.global.BlobBuilder||goog.global.WebKitBlobBuilder;if(void 0!==t){t=new t;for(var n=0;n<arguments.length;n++)t.append(arguments[n]);return t.getBlob()}return goog.fs.blob.getBlobWithProperties(goog.array.toArray(arguments))},goog.fs.blob.getBlobWithProperties=function(e,t,n){var r=goog.global.BlobBuilder||goog.global.WebKitBlobBuilder;if(void 0!==r){r=new r;for(var i=0;i<e.length;i++)r.append(e[i],n);return r.getBlob(t)}if(void 0!==goog.global.Blob)return r={},t&&(r.type=t),n&&(r.endings=n),new Blob(e,r);throw Error("This browser doesn't seem to support creating Blobs")},goog.i18n={},goog.i18n.bidi={},goog.i18n.bidi.FORCE_RTL=!1,goog.i18n.bidi.IS_RTL=goog.i18n.bidi.FORCE_RTL||("ar"==goog.LOCALE.substring(0,2).toLowerCase()||"fa"==goog.LOCALE.substring(0,2).toLowerCase()||"he"==goog.LOCALE.substring(0,2).toLowerCase()||"iw"==goog.LOCALE.substring(0,2).toLowerCase()||"ps"==goog.LOCALE.substring(0,2).toLowerCase()||"sd"==goog.LOCALE.substring(0,2).toLowerCase()||"ug"==goog.LOCALE.substring(0,2).toLowerCase()||"ur"==goog.LOCALE.substring(0,2).toLowerCase()||"yi"==goog.LOCALE.substring(0,2).toLowerCase())&&(2==goog.LOCALE.length||"-"==goog.LOCALE.substring(2,3)||"_"==goog.LOCALE.substring(2,3))||3<=goog.LOCALE.length&&"ckb"==goog.LOCALE.substring(0,3).toLowerCase()&&(3==goog.LOCALE.length||"-"==goog.LOCALE.substring(3,4)||"_"==goog.LOCALE.substring(3,4))||7<=goog.LOCALE.length&&("-"==goog.LOCALE.substring(2,3)||"_"==goog.LOCALE.substring(2,3))&&("adlm"==goog.LOCALE.substring(3,7).toLowerCase()||"arab"==goog.LOCALE.substring(3,7).toLowerCase()||"hebr"==goog.LOCALE.substring(3,7).toLowerCase()||"nkoo"==goog.LOCALE.substring(3,7).toLowerCase()||"rohg"==goog.LOCALE.substring(3,7).toLowerCase()||"thaa"==goog.LOCALE.substring(3,7).toLowerCase())||8<=goog.LOCALE.length&&("-"==goog.LOCALE.substring(3,4)||"_"==goog.LOCALE.substring(3,4))&&("adlm"==goog.LOCALE.substring(4,8).toLowerCase()||"arab"==goog.LOCALE.substring(4,8).toLowerCase()||"hebr"==goog.LOCALE.substring(4,8).toLowerCase()||"nkoo"==goog.LOCALE.substring(4,8).toLowerCase()||"rohg"==goog.LOCALE.substring(4,8).toLowerCase()||"thaa"==goog.LOCALE.substring(4,8).toLowerCase()),goog.i18n.bidi.Format={LRE:"",RLE:"",PDF:"",LRM:"",RLM:""},goog.i18n.bidi.Dir={LTR:1,RTL:-1,NEUTRAL:0},goog.i18n.bidi.RIGHT="right",goog.i18n.bidi.LEFT="left",goog.i18n.bidi.I18N_RIGHT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.LEFT:goog.i18n.bidi.RIGHT,goog.i18n.bidi.I18N_LEFT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT,goog.i18n.bidi.toDir=function(e,t){return"number"==typeof e?0<e?goog.i18n.bidi.Dir.LTR:0>e?goog.i18n.bidi.Dir.RTL:t?null:goog.i18n.bidi.Dir.NEUTRAL:null==e?null:e?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR},goog.i18n.bidi.ltrChars_="A-Za-z------\ud801\ud804-\ud839\ud83c-\udbff---",goog.i18n.bidi.rtlChars_="--\ud802-\ud803\ud83a-\ud83b--",goog.i18n.bidi.htmlSkipReg_=/<[^>]*>|&[^;]+;/g,goog.i18n.bidi.stripHtmlIfNeeded_=function(e,t){return t?e.replace(goog.i18n.bidi.htmlSkipReg_,""):e},goog.i18n.bidi.rtlCharReg_=new RegExp("["+goog.i18n.bidi.rtlChars_+"]"),goog.i18n.bidi.ltrCharReg_=new RegExp("["+goog.i18n.bidi.ltrChars_+"]"),goog.i18n.bidi.hasAnyRtl=function(e,t){return goog.i18n.bidi.rtlCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.hasRtlChar=goog.i18n.bidi.hasAnyRtl,goog.i18n.bidi.hasAnyLtr=function(e,t){return goog.i18n.bidi.ltrCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.ltrRe_=new RegExp("^["+goog.i18n.bidi.ltrChars_+"]"),goog.i18n.bidi.rtlRe_=new RegExp("^["+goog.i18n.bidi.rtlChars_+"]"),goog.i18n.bidi.isRtlChar=function(e){return goog.i18n.bidi.rtlRe_.test(e)},goog.i18n.bidi.isLtrChar=function(e){return goog.i18n.bidi.ltrRe_.test(e)},goog.i18n.bidi.isNeutralChar=function(e){return!goog.i18n.bidi.isLtrChar(e)&&!goog.i18n.bidi.isRtlChar(e)},goog.i18n.bidi.ltrDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.rtlChars_+"]*["+goog.i18n.bidi.ltrChars_+"]"),goog.i18n.bidi.rtlDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.ltrChars_+"]*["+goog.i18n.bidi.rtlChars_+"]"),goog.i18n.bidi.startsWithRtl=function(e,t){return goog.i18n.bidi.rtlDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.isRtlText=goog.i18n.bidi.startsWithRtl,goog.i18n.bidi.startsWithLtr=function(e,t){return goog.i18n.bidi.ltrDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.isLtrText=goog.i18n.bidi.startsWithLtr,goog.i18n.bidi.isRequiredLtrRe_=/^http:\/\/.*/,goog.i18n.bidi.isNeutralText=function(e,t){return e=goog.i18n.bidi.stripHtmlIfNeeded_(e,t),goog.i18n.bidi.isRequiredLtrRe_.test(e)||!goog.i18n.bidi.hasAnyLtr(e)&&!goog.i18n.bidi.hasAnyRtl(e)},goog.i18n.bidi.ltrExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.ltrChars_+"][^"+goog.i18n.bidi.rtlChars_+"]*$"),goog.i18n.bidi.rtlExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.rtlChars_+"][^"+goog.i18n.bidi.ltrChars_+"]*$"),goog.i18n.bidi.endsWithLtr=function(e,t){return goog.i18n.bidi.ltrExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.isLtrExitText=goog.i18n.bidi.endsWithLtr,goog.i18n.bidi.endsWithRtl=function(e,t){return goog.i18n.bidi.rtlExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.isRtlExitText=goog.i18n.bidi.endsWithRtl,goog.i18n.bidi.rtlLocalesRe_=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i,goog.i18n.bidi.isRtlLanguage=function(e){return goog.i18n.bidi.rtlLocalesRe_.test(e)},goog.i18n.bidi.bracketGuardTextRe_=/(\(.*?\)+)|(\[.*?\]+)|(\{.*?\}+)|(<.*?>+)/g,goog.i18n.bidi.guardBracketInText=function(e,t){return t=(void 0===t?goog.i18n.bidi.hasAnyRtl(e):t)?goog.i18n.bidi.Format.RLM:goog.i18n.bidi.Format.LRM,e.replace(goog.i18n.bidi.bracketGuardTextRe_,t+"$&"+t)},goog.i18n.bidi.enforceRtlInHtml=function(e){return"<"==e.charAt(0)?e.replace(/<\w+/,"$& dir=rtl"):"\n<span dir=rtl>"+e+"</span>"},goog.i18n.bidi.enforceRtlInText=function(e){return goog.i18n.bidi.Format.RLE+e+goog.i18n.bidi.Format.PDF},goog.i18n.bidi.enforceLtrInHtml=function(e){return"<"==e.charAt(0)?e.replace(/<\w+/,"$& dir=ltr"):"\n<span dir=ltr>"+e+"</span>"},goog.i18n.bidi.enforceLtrInText=function(e){return goog.i18n.bidi.Format.LRE+e+goog.i18n.bidi.Format.PDF},goog.i18n.bidi.dimensionsRe_=/:\s*([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)/g,goog.i18n.bidi.leftRe_=/left/gi,goog.i18n.bidi.rightRe_=/right/gi,goog.i18n.bidi.tempRe_=/%%%%/g,goog.i18n.bidi.mirrorCSS=function(e){return e.replace(goog.i18n.bidi.dimensionsRe_,":$1 $4 $3 $2").replace(goog.i18n.bidi.leftRe_,"%%%%").replace(goog.i18n.bidi.rightRe_,goog.i18n.bidi.LEFT).replace(goog.i18n.bidi.tempRe_,goog.i18n.bidi.RIGHT)},goog.i18n.bidi.doubleQuoteSubstituteRe_=/([\u0591-\u05f2])"/g,goog.i18n.bidi.singleQuoteSubstituteRe_=/([\u0591-\u05f2])'/g,goog.i18n.bidi.normalizeHebrewQuote=function(e){return e.replace(goog.i18n.bidi.doubleQuoteSubstituteRe_,"$1").replace(goog.i18n.bidi.singleQuoteSubstituteRe_,"$1")},goog.i18n.bidi.wordSeparatorRe_=/\s+/,goog.i18n.bidi.hasNumeralsRe_=/[\d\u06f0-\u06f9]/,goog.i18n.bidi.rtlDetectionThreshold_=.4,goog.i18n.bidi.estimateDirection=function(e,t){var n=0,r=0,i=!1;for(e=goog.i18n.bidi.stripHtmlIfNeeded_(e,t).split(goog.i18n.bidi.wordSeparatorRe_),t=0;t<e.length;t++){var o=e[t];goog.i18n.bidi.startsWithRtl(o)?(n++,r++):goog.i18n.bidi.isRequiredLtrRe_.test(o)?i=!0:goog.i18n.bidi.hasAnyLtr(o)?r++:goog.i18n.bidi.hasNumeralsRe_.test(o)&&(i=!0)}return 0==r?i?goog.i18n.bidi.Dir.LTR:goog.i18n.bidi.Dir.NEUTRAL:n/r>goog.i18n.bidi.rtlDetectionThreshold_?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR},goog.i18n.bidi.detectRtlDirectionality=function(e,t){return goog.i18n.bidi.estimateDirection(e,t)==goog.i18n.bidi.Dir.RTL},goog.i18n.bidi.setElementDirAndAlign=function(e,t){e&&(t=goog.i18n.bidi.toDir(t))&&(e.style.textAlign=t==goog.i18n.bidi.Dir.RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT,e.dir=t==goog.i18n.bidi.Dir.RTL?"rtl":"ltr")},goog.i18n.bidi.setElementDirByTextDirectionality=function(e,t){switch(goog.i18n.bidi.estimateDirection(t)){case goog.i18n.bidi.Dir.LTR:e.dir="ltr";break;case goog.i18n.bidi.Dir.RTL:e.dir="rtl";break;default:e.removeAttribute("dir")}},goog.i18n.bidi.DirectionalString=function(){},goog.html.TrustedResourceUrl=function(e,t){this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_=e===goog.html.TrustedResourceUrl.CONSTRUCTOR_TOKEN_PRIVATE_&&t||"",this.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.TrustedResourceUrl.prototype.implementsGoogStringTypedString=!0,goog.html.TrustedResourceUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_.toString()},goog.html.TrustedResourceUrl.prototype.implementsGoogI18nBidiDirectionalString=!0,goog.html.TrustedResourceUrl.prototype.getDirection=function(){return goog.i18n.bidi.Dir.LTR},goog.html.TrustedResourceUrl.prototype.cloneWithParams=function(e,t){var n=goog.html.TrustedResourceUrl.unwrap(this),r=(n=goog.html.TrustedResourceUrl.URL_PARAM_PARSER_.exec(n))[3]||"";return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(n[1]+goog.html.TrustedResourceUrl.stringifyParams_("?",n[2]||"",e)+goog.html.TrustedResourceUrl.stringifyParams_("#",r,t))},goog.DEBUG&&(goog.html.TrustedResourceUrl.prototype.toString=function(){return"TrustedResourceUrl{"+this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_+"}"}),goog.html.TrustedResourceUrl.unwrap=function(e){return goog.html.TrustedResourceUrl.unwrapTrustedScriptURL(e).toString()},goog.html.TrustedResourceUrl.unwrapTrustedScriptURL=function(e){return e instanceof goog.html.TrustedResourceUrl&&e.constructor===goog.html.TrustedResourceUrl&&e.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?e.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_:(goog.asserts.fail("expected object of type TrustedResourceUrl, got '"+e+"' of type "+goog.typeOf(e)),"type_error:TrustedResourceUrl")},goog.html.TrustedResourceUrl.format=function(e,t){var n=goog.string.Const.unwrap(e);if(!goog.html.TrustedResourceUrl.BASE_URL_.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return e=n.replace(goog.html.TrustedResourceUrl.FORMAT_MARKER_,(function(e,r){if(!Object.prototype.hasOwnProperty.call(t,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(t));return(e=t[r])instanceof goog.string.Const?goog.string.Const.unwrap(e):encodeURIComponent(String(e))})),goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(e)},goog.html.TrustedResourceUrl.FORMAT_MARKER_=/%{(\w+)}/g,goog.html.TrustedResourceUrl.BASE_URL_=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,goog.html.TrustedResourceUrl.URL_PARAM_PARSER_=/^([^?#]*)(\?[^#]*)?(#[\s\S]*)?/,goog.html.TrustedResourceUrl.formatWithParams=function(e,t,n,r){return goog.html.TrustedResourceUrl.format(e,t).cloneWithParams(n,r)},goog.html.TrustedResourceUrl.fromConstant=function(e){return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(e))},goog.html.TrustedResourceUrl.fromConstants=function(e){for(var t="",n=0;n<e.length;n++)t+=goog.string.Const.unwrap(e[n]);return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(t)},goog.html.TrustedResourceUrl.fromSafeScript=function(e){return e=goog.fs.blob.getBlobWithProperties([goog.html.SafeScript.unwrap(e)],"text/javascript"),e=goog.fs.url.createObjectUrl(e),goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(e)},goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse=function(e){return e=goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY?goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY.createScriptURL(e):e,new goog.html.TrustedResourceUrl(goog.html.TrustedResourceUrl.CONSTRUCTOR_TOKEN_PRIVATE_,e)},goog.html.TrustedResourceUrl.stringifyParams_=function(e,t,n){if(null==n)return t;if("string"==typeof n)return n?e+encodeURIComponent(n):"";for(var r in n){var i=n[r];i=Array.isArray(i)?i:[i];for(var o=0;o<i.length;o++){var a=i[o];null!=a&&(t||(t=e),t+=(t.length>e.length?"&":"")+encodeURIComponent(r)+"="+encodeURIComponent(String(a)))}}return t},goog.html.TrustedResourceUrl.CONSTRUCTOR_TOKEN_PRIVATE_={},goog.string.internal={},goog.string.internal.startsWith=function(e,t){return 0==e.lastIndexOf(t,0)},goog.string.internal.endsWith=function(e,t){var n=e.length-t.length;return 0<=n&&e.indexOf(t,n)==n},goog.string.internal.caseInsensitiveStartsWith=function(e,t){return 0==goog.string.internal.caseInsensitiveCompare(t,e.substr(0,t.length))},goog.string.internal.caseInsensitiveEndsWith=function(e,t){return 0==goog.string.internal.caseInsensitiveCompare(t,e.substr(e.length-t.length,t.length))},goog.string.internal.caseInsensitiveEquals=function(e,t){return e.toLowerCase()==t.toLowerCase()},goog.string.internal.isEmptyOrWhitespace=function(e){return/^[\s\xa0]*$/.test(e)},goog.string.internal.trim=goog.TRUSTED_SITE&&String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]},goog.string.internal.caseInsensitiveCompare=function(e,t){return(e=String(e).toLowerCase())<(t=String(t).toLowerCase())?-1:e==t?0:1},goog.string.internal.newLineToBr=function(e,t){return e.replace(/(\r\n|\r|\n)/g,t?"<br />":"<br>")},goog.string.internal.htmlEscape=function(e,t){if(t)e=e.replace(goog.string.internal.AMP_RE_,"&amp;").replace(goog.string.internal.LT_RE_,"&lt;").replace(goog.string.internal.GT_RE_,"&gt;").replace(goog.string.internal.QUOT_RE_,"&quot;").replace(goog.string.internal.SINGLE_QUOTE_RE_,"&#39;").replace(goog.string.internal.NULL_RE_,"&#0;");else{if(!goog.string.internal.ALL_RE_.test(e))return e;-1!=e.indexOf("&")&&(e=e.replace(goog.string.internal.AMP_RE_,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace(goog.string.internal.LT_RE_,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace(goog.string.internal.GT_RE_,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace(goog.string.internal.QUOT_RE_,"&quot;")),-1!=e.indexOf("'")&&(e=e.replace(goog.string.internal.SINGLE_QUOTE_RE_,"&#39;")),-1!=e.indexOf("\0")&&(e=e.replace(goog.string.internal.NULL_RE_,"&#0;"))}return e},goog.string.internal.AMP_RE_=/&/g,goog.string.internal.LT_RE_=/</g,goog.string.internal.GT_RE_=/>/g,goog.string.internal.QUOT_RE_=/"/g,goog.string.internal.SINGLE_QUOTE_RE_=/'/g,goog.string.internal.NULL_RE_=/\x00/g,goog.string.internal.ALL_RE_=/[\x00&<>"']/,goog.string.internal.whitespaceEscape=function(e,t){return goog.string.internal.newLineToBr(e.replace(/  /g," &#160;"),t)},goog.string.internal.contains=function(e,t){return-1!=e.indexOf(t)},goog.string.internal.caseInsensitiveContains=function(e,t){return goog.string.internal.contains(e.toLowerCase(),t.toLowerCase())},goog.string.internal.compareVersions=function(e,t){var n=0;e=goog.string.internal.trim(String(e)).split("."),t=goog.string.internal.trim(String(t)).split(".");for(var r=Math.max(e.length,t.length),i=0;0==n&&i<r;i++){var o=e[i]||"",a=t[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==o[0].length&&0==a[0].length)break;n=0==o[1].length?0:parseInt(o[1],10);var s=0==a[1].length?0:parseInt(a[1],10);n=goog.string.internal.compareElements_(n,s)||goog.string.internal.compareElements_(0==o[2].length,0==a[2].length)||goog.string.internal.compareElements_(o[2],a[2]),o=o[3],a=a[3]}while(0==n)}return n},goog.string.internal.compareElements_=function(e,t){return e<t?-1:e>t?1:0},goog.html.SafeUrl=function(e,t){this.privateDoNotAccessOrElseSafeUrlWrappedValue_=e===goog.html.SafeUrl.CONSTRUCTOR_TOKEN_PRIVATE_&&t||"",this.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.SafeUrl.INNOCUOUS_STRING="about:invalid#zClosurez",goog.html.SafeUrl.prototype.implementsGoogStringTypedString=!0,goog.html.SafeUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeUrlWrappedValue_.toString()},goog.html.SafeUrl.prototype.implementsGoogI18nBidiDirectionalString=!0,goog.html.SafeUrl.prototype.getDirection=function(){return goog.i18n.bidi.Dir.LTR},goog.DEBUG&&(goog.html.SafeUrl.prototype.toString=function(){return"SafeUrl{"+this.privateDoNotAccessOrElseSafeUrlWrappedValue_+"}"}),goog.html.SafeUrl.unwrap=function(e){return e instanceof goog.html.SafeUrl&&e.constructor===goog.html.SafeUrl&&e.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?e.privateDoNotAccessOrElseSafeUrlWrappedValue_:(goog.asserts.fail("expected object of type SafeUrl, got '"+e+"' of type "+goog.typeOf(e)),"type_error:SafeUrl")},goog.html.SafeUrl.fromConstant=function(e){return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(e))},goog.html.SAFE_MIME_TYPE_PATTERN_=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,goog.html.SafeUrl.isSafeMimeType=function(e){return goog.html.SAFE_MIME_TYPE_PATTERN_.test(e)},goog.html.SafeUrl.fromBlob=function(e){return e=goog.html.SafeUrl.isSafeMimeType(e.type)?goog.fs.url.createObjectUrl(e):goog.html.SafeUrl.INNOCUOUS_STRING,goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e)},goog.html.SafeUrl.fromMediaSource=function(e){return goog.asserts.assert("MediaSource"in goog.global,"No support for MediaSource"),e=e instanceof MediaSource?goog.fs.url.createObjectUrl(e):goog.html.SafeUrl.INNOCUOUS_STRING,goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e)},goog.html.DATA_URL_PATTERN_=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,goog.html.SafeUrl.fromDataUrl=function(e){var t=(e=e.replace(/(%0A|%0D)/g,"")).match(goog.html.DATA_URL_PATTERN_);return t=t&&goog.html.SafeUrl.isSafeMimeType(t[1]),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(t?e:goog.html.SafeUrl.INNOCUOUS_STRING)},goog.html.SafeUrl.fromTelUrl=function(e){return goog.string.internal.caseInsensitiveStartsWith(e,"tel:")||(e=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e)},goog.html.SIP_URL_PATTERN_=/^sip[s]?:[+a-z0-9_.!$%&'*\/=^`{|}~-]+@([a-z0-9-]+\.)+[a-z0-9]{2,63}$/i,goog.html.SafeUrl.fromSipUrl=function(e){return goog.html.SIP_URL_PATTERN_.test(decodeURIComponent(e))||(e=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e)},goog.html.SafeUrl.fromFacebookMessengerUrl=function(e){return goog.string.internal.caseInsensitiveStartsWith(e,"fb-messenger://share")||(e=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e)},goog.html.SafeUrl.fromWhatsAppUrl=function(e){return goog.string.internal.caseInsensitiveStartsWith(e,"whatsapp://send")||(e=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e)},goog.html.SafeUrl.fromSmsUrl=function(e){return goog.string.internal.caseInsensitiveStartsWith(e,"sms:")&&goog.html.SafeUrl.isSmsUrlBodyValid_(e)||(e=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e)},goog.html.SafeUrl.isSmsUrlBodyValid_=function(e){var t=e.indexOf("#");if(0<t&&(e=e.substring(0,t)),!(t=e.match(/[?&]body=/gi)))return!0;if(1<t.length)return!1;if(!(e=e.match(/[?&]body=([^&]*)/)[1]))return!0;try{decodeURIComponent(e)}catch(e){return!1}return/^(?:[a-z0-9\-_.~]|%[0-9a-f]{2})+$/i.test(e)},goog.html.SafeUrl.fromSshUrl=function(e){return goog.string.internal.caseInsensitiveStartsWith(e,"ssh://")||(e=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e)},goog.html.SafeUrl.sanitizeChromeExtensionUrl=function(e,t){return goog.html.SafeUrl.sanitizeExtensionUrl_(/^chrome-extension:\/\/([^\/]+)\//,e,t)},goog.html.SafeUrl.sanitizeFirefoxExtensionUrl=function(e,t){return goog.html.SafeUrl.sanitizeExtensionUrl_(/^moz-extension:\/\/([^\/]+)\//,e,t)},goog.html.SafeUrl.sanitizeEdgeExtensionUrl=function(e,t){return goog.html.SafeUrl.sanitizeExtensionUrl_(/^ms-browser-extension:\/\/([^\/]+)\//,e,t)},goog.html.SafeUrl.sanitizeExtensionUrl_=function(e,t,n){return(e=e.exec(t))?(e=e[1],-1==(n instanceof goog.string.Const?[goog.string.Const.unwrap(n)]:n.map((function(e){return goog.string.Const.unwrap(e)}))).indexOf(e)&&(t=goog.html.SafeUrl.INNOCUOUS_STRING)):t=goog.html.SafeUrl.INNOCUOUS_STRING,goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(t)},goog.html.SafeUrl.fromTrustedResourceUrl=function(e){return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.html.TrustedResourceUrl.unwrap(e))},goog.html.SAFE_URL_PATTERN_=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i,goog.html.SafeUrl.SAFE_URL_PATTERN=goog.html.SAFE_URL_PATTERN_,goog.html.SafeUrl.sanitize=function(e){return e instanceof goog.html.SafeUrl?e:(e="object"==typeof e&&e.implementsGoogStringTypedString?e.getTypedStringValue():String(e),goog.html.SAFE_URL_PATTERN_.test(e)||(e=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e))},goog.html.SafeUrl.sanitizeAssertUnchanged=function(e,t){return e instanceof goog.html.SafeUrl?e:(e="object"==typeof e&&e.implementsGoogStringTypedString?e.getTypedStringValue():String(e),t&&/^data:/i.test(e)&&(t=goog.html.SafeUrl.fromDataUrl(e)).getTypedStringValue()==e?t:(goog.asserts.assert(goog.html.SAFE_URL_PATTERN_.test(e),"%s does not match the safe URL pattern",e)||(e=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e)))},goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse=function(e){return new goog.html.SafeUrl(goog.html.SafeUrl.CONSTRUCTOR_TOKEN_PRIVATE_,e)},goog.html.SafeUrl.ABOUT_BLANK=goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse("about:blank"),goog.html.SafeUrl.CONSTRUCTOR_TOKEN_PRIVATE_={},goog.html.SafeStyle=function(){this.privateDoNotAccessOrElseSafeStyleWrappedValue_="",this.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.SafeStyle.prototype.implementsGoogStringTypedString=!0,goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeStyle.fromConstant=function(e){return 0===(e=goog.string.Const.unwrap(e)).length?goog.html.SafeStyle.EMPTY:(goog.asserts.assert(goog.string.internal.endsWith(e,";"),"Last character of style string is not ';': "+e),goog.asserts.assert(goog.string.internal.contains(e,":"),"Style string must contain at least one ':', to specify a \"name: value\" pair: "+e),goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(e))},goog.html.SafeStyle.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeStyleWrappedValue_},goog.DEBUG&&(goog.html.SafeStyle.prototype.toString=function(){return"SafeStyle{"+this.privateDoNotAccessOrElseSafeStyleWrappedValue_+"}"}),goog.html.SafeStyle.unwrap=function(e){return e instanceof goog.html.SafeStyle&&e.constructor===goog.html.SafeStyle&&e.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?e.privateDoNotAccessOrElseSafeStyleWrappedValue_:(goog.asserts.fail("expected object of type SafeStyle, got '"+e+"' of type "+goog.typeOf(e)),"type_error:SafeStyle")},goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse=function(e){return(new goog.html.SafeStyle).initSecurityPrivateDoNotAccessOrElse_(e)},goog.html.SafeStyle.prototype.initSecurityPrivateDoNotAccessOrElse_=function(e){return this.privateDoNotAccessOrElseSafeStyleWrappedValue_=e,this},goog.html.SafeStyle.EMPTY=goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(""),goog.html.SafeStyle.INNOCUOUS_STRING="zClosurez",goog.html.SafeStyle.create=function(e){var t,n="";for(t in e){if(!/^[-_a-zA-Z0-9]+$/.test(t))throw Error("Name allows only [-_a-zA-Z0-9], got: "+t);var r=e[t];null!=r&&(n+=t+":"+(r=Array.isArray(r)?goog.array.map(r,goog.html.SafeStyle.sanitizePropertyValue_).join(" "):goog.html.SafeStyle.sanitizePropertyValue_(r))+";")}return n?goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(n):goog.html.SafeStyle.EMPTY},goog.html.SafeStyle.sanitizePropertyValue_=function(e){if(e instanceof goog.html.SafeUrl)return'url("'+goog.html.SafeUrl.unwrap(e).replace(/</g,"%3c").replace(/[\\"]/g,"\\$&")+'")';if(e=e instanceof goog.string.Const?goog.string.Const.unwrap(e):goog.html.SafeStyle.sanitizePropertyValueString_(String(e)),/[{;}]/.test(e))throw new goog.asserts.AssertionError("Value does not allow [{;}], got: %s.",[e]);return e},goog.html.SafeStyle.sanitizePropertyValueString_=function(e){var t=e.replace(goog.html.SafeStyle.FUNCTIONS_RE_,"$1").replace(goog.html.SafeStyle.FUNCTIONS_RE_,"$1").replace(goog.html.SafeStyle.URL_RE_,"url");return goog.html.SafeStyle.VALUE_RE_.test(t)?goog.html.SafeStyle.COMMENT_RE_.test(e)?(goog.asserts.fail("String value disallows comments, got: "+e),goog.html.SafeStyle.INNOCUOUS_STRING):goog.html.SafeStyle.hasBalancedQuotes_(e)?goog.html.SafeStyle.hasBalancedSquareBrackets_(e)?goog.html.SafeStyle.sanitizeUrl_(e):(goog.asserts.fail("String value requires balanced square brackets and one identifier per pair of brackets, got: "+e),goog.html.SafeStyle.INNOCUOUS_STRING):(goog.asserts.fail("String value requires balanced quotes, got: "+e),goog.html.SafeStyle.INNOCUOUS_STRING):(goog.asserts.fail("String value allows only "+goog.html.SafeStyle.VALUE_ALLOWED_CHARS_+" and simple functions, got: "+e),goog.html.SafeStyle.INNOCUOUS_STRING)},goog.html.SafeStyle.hasBalancedQuotes_=function(e){for(var t=!0,n=!0,r=0;r<e.length;r++){var i=e.charAt(r);"'"==i&&n?t=!t:'"'==i&&t&&(n=!n)}return t&&n},goog.html.SafeStyle.hasBalancedSquareBrackets_=function(e){for(var t=!0,n=/^[-_a-zA-Z0-9]$/,r=0;r<e.length;r++){var i=e.charAt(r);if("]"==i){if(t)return!1;t=!0}else if("["==i){if(!t)return!1;t=!1}else if(!t&&!n.test(i))return!1}return t},goog.html.SafeStyle.VALUE_ALLOWED_CHARS_="[-,.\"'%_!# a-zA-Z0-9\\[\\]]",goog.html.SafeStyle.VALUE_RE_=new RegExp("^"+goog.html.SafeStyle.VALUE_ALLOWED_CHARS_+"+$"),goog.html.SafeStyle.URL_RE_=/\b(url\([ \t\n]*)('[ -&(-\[\]-~]*'|"[ !#-\[\]-~]*"|[!#-&*-\[\]-~]*)([ \t\n]*\))/g,goog.html.SafeStyle.ALLOWED_FUNCTIONS_="calc cubic-bezier fit-content hsl hsla linear-gradient matrix minmax repeat rgb rgba (rotate|scale|translate)(X|Y|Z|3d)?".split(" "),goog.html.SafeStyle.FUNCTIONS_RE_=new RegExp("\\b("+goog.html.SafeStyle.ALLOWED_FUNCTIONS_.join("|")+")\\([-+*/0-9a-z.%\\[\\], ]+\\)","g"),goog.html.SafeStyle.COMMENT_RE_=/\/\*/,goog.html.SafeStyle.sanitizeUrl_=function(e){return e.replace(goog.html.SafeStyle.URL_RE_,(function(e,t,n,r){var i="";return n=n.replace(/^(['"])(.*)\1$/,(function(e,t,n){return i=t,n})),e=goog.html.SafeUrl.sanitize(n).getTypedStringValue(),t+i+e+i+r}))},goog.html.SafeStyle.concat=function(e){var t="",n=function(e){Array.isArray(e)?goog.array.forEach(e,n):t+=goog.html.SafeStyle.unwrap(e)};return goog.array.forEach(arguments,n),t?goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(t):goog.html.SafeStyle.EMPTY},goog.html.SafeStyleSheet=function(){this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_="",this.SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.SafeStyleSheet.prototype.implementsGoogStringTypedString=!0,goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeStyleSheet.createRule=function(e,t){if(goog.string.internal.contains(e,"<"))throw Error("Selector does not allow '<', got: "+e);var n=e.replace(/('|")((?!\1)[^\r\n\f\\]|\\[\s\S])*\1/g,"");if(!/^[-_a-zA-Z0-9#.:* ,>+~[\]()=^$|]+$/.test(n))throw Error("Selector allows only [-_a-zA-Z0-9#.:* ,>+~[\\]()=^$|] and strings, got: "+e);if(!goog.html.SafeStyleSheet.hasBalancedBrackets_(n))throw Error("() and [] in selector must be balanced, got: "+e);return t instanceof goog.html.SafeStyle||(t=goog.html.SafeStyle.create(t)),e=e+"{"+goog.html.SafeStyle.unwrap(t).replace(/</g,"\\3C ")+"}",goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(e)},goog.html.SafeStyleSheet.hasBalancedBrackets_=function(e){for(var t={"(":")","[":"]"},n=[],r=0;r<e.length;r++){var i=e[r];if(t[i])n.push(t[i]);else if(goog.object.contains(t,i)&&n.pop()!=i)return!1}return 0==n.length},goog.html.SafeStyleSheet.concat=function(e){var t="",n=function(e){Array.isArray(e)?goog.array.forEach(e,n):t+=goog.html.SafeStyleSheet.unwrap(e)};return goog.array.forEach(arguments,n),goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(t)},goog.html.SafeStyleSheet.fromConstant=function(e){return 0===(e=goog.string.Const.unwrap(e)).length?goog.html.SafeStyleSheet.EMPTY:(goog.asserts.assert(!goog.string.internal.contains(e,"<"),"Forbidden '<' character in style sheet string: "+e),goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(e))},goog.html.SafeStyleSheet.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_},goog.DEBUG&&(goog.html.SafeStyleSheet.prototype.toString=function(){return"SafeStyleSheet{"+this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_+"}"}),goog.html.SafeStyleSheet.unwrap=function(e){return e instanceof goog.html.SafeStyleSheet&&e.constructor===goog.html.SafeStyleSheet&&e.SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?e.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_:(goog.asserts.fail("expected object of type SafeStyleSheet, got '"+e+"' of type "+goog.typeOf(e)),"type_error:SafeStyleSheet")},goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse=function(e){return(new goog.html.SafeStyleSheet).initSecurityPrivateDoNotAccessOrElse_(e)},goog.html.SafeStyleSheet.prototype.initSecurityPrivateDoNotAccessOrElse_=function(e){return this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_=e,this},goog.html.SafeStyleSheet.EMPTY=goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(""),goog.labs={},goog.labs.userAgent={},goog.labs.userAgent.util={},goog.labs.userAgent.util.getNativeUserAgentString_=function(){var e=goog.labs.userAgent.util.getNavigator_();return e&&(e=e.userAgent)?e:""},goog.labs.userAgent.util.getNavigator_=function(){return goog.global.navigator},goog.labs.userAgent.util.userAgent_=goog.labs.userAgent.util.getNativeUserAgentString_(),goog.labs.userAgent.util.setUserAgent=function(e){goog.labs.userAgent.util.userAgent_=e||goog.labs.userAgent.util.getNativeUserAgentString_()},goog.labs.userAgent.util.getUserAgent=function(){return goog.labs.userAgent.util.userAgent_},goog.labs.userAgent.util.matchUserAgent=function(e){var t=goog.labs.userAgent.util.getUserAgent();return goog.string.internal.contains(t,e)},goog.labs.userAgent.util.matchUserAgentIgnoreCase=function(e){var t=goog.labs.userAgent.util.getUserAgent();return goog.string.internal.caseInsensitiveContains(t,e)},goog.labs.userAgent.util.extractVersionTuples=function(e){for(var t,n=/(\w[\w ]+)\/([^\s]+)\s*(?:\((.*?)\))?/g,r=[];t=n.exec(e);)r.push([t[1],t[2],t[3]||void 0]);return r},goog.labs.userAgent.browser={},goog.labs.userAgent.browser.matchOpera_=function(){return goog.labs.userAgent.util.matchUserAgent("Opera")},goog.labs.userAgent.browser.matchIE_=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")},goog.labs.userAgent.browser.matchEdgeHtml_=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")},goog.labs.userAgent.browser.matchEdgeChromium_=function(){return goog.labs.userAgent.util.matchUserAgent("Edg/")},goog.labs.userAgent.browser.matchOperaChromium_=function(){return goog.labs.userAgent.util.matchUserAgent("OPR")},goog.labs.userAgent.browser.matchFirefox_=function(){return goog.labs.userAgent.util.matchUserAgent("Firefox")||goog.labs.userAgent.util.matchUserAgent("FxiOS")},goog.labs.userAgent.browser.matchSafari_=function(){return goog.labs.userAgent.util.matchUserAgent("Safari")&&!(goog.labs.userAgent.browser.matchChrome_()||goog.labs.userAgent.browser.matchCoast_()||goog.labs.userAgent.browser.matchOpera_()||goog.labs.userAgent.browser.matchEdgeHtml_()||goog.labs.userAgent.browser.matchEdgeChromium_()||goog.labs.userAgent.browser.matchOperaChromium_()||goog.labs.userAgent.browser.matchFirefox_()||goog.labs.userAgent.browser.isSilk()||goog.labs.userAgent.util.matchUserAgent("Android"))},goog.labs.userAgent.browser.matchCoast_=function(){return goog.labs.userAgent.util.matchUserAgent("Coast")},goog.labs.userAgent.browser.matchIosWebview_=function(){return(goog.labs.userAgent.util.matchUserAgent("iPad")||goog.labs.userAgent.util.matchUserAgent("iPhone"))&&!goog.labs.userAgent.browser.matchSafari_()&&!goog.labs.userAgent.browser.matchChrome_()&&!goog.labs.userAgent.browser.matchCoast_()&&!goog.labs.userAgent.browser.matchFirefox_()&&goog.labs.userAgent.util.matchUserAgent("AppleWebKit")},goog.labs.userAgent.browser.matchChrome_=function(){return(goog.labs.userAgent.util.matchUserAgent("Chrome")||goog.labs.userAgent.util.matchUserAgent("CriOS"))&&!goog.labs.userAgent.browser.matchEdgeHtml_()},goog.labs.userAgent.browser.matchAndroidBrowser_=function(){return goog.labs.userAgent.util.matchUserAgent("Android")&&!(goog.labs.userAgent.browser.isChrome()||goog.labs.userAgent.browser.isFirefox()||goog.labs.userAgent.browser.isOpera()||goog.labs.userAgent.browser.isSilk())},goog.labs.userAgent.browser.isOpera=goog.labs.userAgent.browser.matchOpera_,goog.labs.userAgent.browser.isIE=goog.labs.userAgent.browser.matchIE_,goog.labs.userAgent.browser.isEdge=goog.labs.userAgent.browser.matchEdgeHtml_,goog.labs.userAgent.browser.isEdgeChromium=goog.labs.userAgent.browser.matchEdgeChromium_,goog.labs.userAgent.browser.isOperaChromium=goog.labs.userAgent.browser.matchOperaChromium_,goog.labs.userAgent.browser.isFirefox=goog.labs.userAgent.browser.matchFirefox_,goog.labs.userAgent.browser.isSafari=goog.labs.userAgent.browser.matchSafari_,goog.labs.userAgent.browser.isCoast=goog.labs.userAgent.browser.matchCoast_,goog.labs.userAgent.browser.isIosWebview=goog.labs.userAgent.browser.matchIosWebview_,goog.labs.userAgent.browser.isChrome=goog.labs.userAgent.browser.matchChrome_,goog.labs.userAgent.browser.isAndroidBrowser=goog.labs.userAgent.browser.matchAndroidBrowser_,goog.labs.userAgent.browser.isSilk=function(){return goog.labs.userAgent.util.matchUserAgent("Silk")},goog.labs.userAgent.browser.getVersion=function(){function e(e){return e=goog.array.find(e,r),n[e]||""}var t=goog.labs.userAgent.util.getUserAgent();if(goog.labs.userAgent.browser.isIE())return goog.labs.userAgent.browser.getIEVersion_(t);t=goog.labs.userAgent.util.extractVersionTuples(t);var n={};goog.array.forEach(t,(function(e){n[e[0]]=e[1]}));var r=goog.partial(goog.object.containsKey,n);return goog.labs.userAgent.browser.isOpera()?e(["Version","Opera"]):goog.labs.userAgent.browser.isEdge()?e(["Edge"]):goog.labs.userAgent.browser.isEdgeChromium()?e(["Edg"]):goog.labs.userAgent.browser.isChrome()?e(["Chrome","CriOS","HeadlessChrome"]):(t=t[2])&&t[1]||""},goog.labs.userAgent.browser.isVersionOrHigher=function(e){return 0<=goog.string.internal.compareVersions(goog.labs.userAgent.browser.getVersion(),e)},goog.labs.userAgent.browser.getIEVersion_=function(e){var t=/rv: *([\d\.]*)/.exec(e);if(t&&t[1])return t[1];t="";var n=/MSIE +([\d\.]+)/.exec(e);if(n&&n[1])if(e=/Trident\/(\d.\d)/.exec(e),"7.0"==n[1])if(e&&e[1])switch(e[1]){case"4.0":t="8.0";break;case"5.0":t="9.0";break;case"6.0":t="10.0";break;case"7.0":t="11.0"}else t="7.0";else t=n[1];return t},goog.html.SafeHtml=function(){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_="",this.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_,this.dir_=null},goog.html.SafeHtml.ENABLE_ERROR_MESSAGES=goog.DEBUG,goog.html.SafeHtml.SUPPORT_STYLE_ATTRIBUTE=!0,goog.html.SafeHtml.prototype.implementsGoogI18nBidiDirectionalString=!0,goog.html.SafeHtml.prototype.getDirection=function(){return this.dir_},goog.html.SafeHtml.prototype.implementsGoogStringTypedString=!0,goog.html.SafeHtml.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_.toString()},goog.DEBUG&&(goog.html.SafeHtml.prototype.toString=function(){return"SafeHtml{"+this.privateDoNotAccessOrElseSafeHtmlWrappedValue_+"}"}),goog.html.SafeHtml.unwrap=function(e){return goog.html.SafeHtml.unwrapTrustedHTML(e).toString()},goog.html.SafeHtml.unwrapTrustedHTML=function(e){return e instanceof goog.html.SafeHtml&&e.constructor===goog.html.SafeHtml&&e.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?e.privateDoNotAccessOrElseSafeHtmlWrappedValue_:(goog.asserts.fail("expected object of type SafeHtml, got '"+e+"' of type "+goog.typeOf(e)),"type_error:SafeHtml")},goog.html.SafeHtml.htmlEscape=function(e){if(e instanceof goog.html.SafeHtml)return e;var t="object"==typeof e,n=null;return t&&e.implementsGoogI18nBidiDirectionalString&&(n=e.getDirection()),e=t&&e.implementsGoogStringTypedString?e.getTypedStringValue():String(e),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.internal.htmlEscape(e),n)},goog.html.SafeHtml.htmlEscapePreservingNewlines=function(e){return e instanceof goog.html.SafeHtml?e:(e=goog.html.SafeHtml.htmlEscape(e),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.internal.newLineToBr(goog.html.SafeHtml.unwrap(e)),e.getDirection()))},goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces=function(e){return e instanceof goog.html.SafeHtml?e:(e=goog.html.SafeHtml.htmlEscape(e),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.internal.whitespaceEscape(goog.html.SafeHtml.unwrap(e)),e.getDirection()))},goog.html.SafeHtml.from=goog.html.SafeHtml.htmlEscape,goog.html.SafeHtml.comment=function(e){return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("\x3c!--"+goog.string.internal.htmlEscape(e)+"--\x3e",null)},goog.html.SafeHtml.VALID_NAMES_IN_TAG_=/^[a-zA-Z0-9-]+$/,goog.html.SafeHtml.URL_ATTRIBUTES_={action:!0,cite:!0,data:!0,formaction:!0,href:!0,manifest:!0,poster:!0,src:!0},goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_={APPLET:!0,BASE:!0,EMBED:!0,IFRAME:!0,LINK:!0,MATH:!0,META:!0,OBJECT:!0,SCRIPT:!0,STYLE:!0,SVG:!0,TEMPLATE:!0},goog.html.SafeHtml.create=function(e,t,n){return goog.html.SafeHtml.verifyTagName(String(e)),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(String(e),t,n)},goog.html.SafeHtml.verifyTagName=function(e){if(!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(e))throw Error(goog.html.SafeHtml.ENABLE_ERROR_MESSAGES?"Invalid tag name <"+e+">.":"");if(e.toUpperCase()in goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_)throw Error(goog.html.SafeHtml.ENABLE_ERROR_MESSAGES?"Tag name <"+e+"> is not allowed for SafeHtml.":"")},goog.html.SafeHtml.createIframe=function(e,t,n,r){e&&goog.html.TrustedResourceUrl.unwrap(e);var i={};return i.src=e||null,i.srcdoc=t&&goog.html.SafeHtml.unwrap(t),e=goog.html.SafeHtml.combineAttributes(i,{sandbox:""},n),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",e,r)},goog.html.SafeHtml.createSandboxIframe=function(e,t,n,r){if(!goog.html.SafeHtml.canUseSandboxIframe())throw Error(goog.html.SafeHtml.ENABLE_ERROR_MESSAGES?"The browser does not support sandboxed iframes.":"");var i={};return i.src=e?goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(e)):null,i.srcdoc=t||null,i.sandbox="",e=goog.html.SafeHtml.combineAttributes(i,{},n),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",e,r)},goog.html.SafeHtml.canUseSandboxIframe=function(){return goog.global.HTMLIFrameElement&&"sandbox"in goog.global.HTMLIFrameElement.prototype},goog.html.SafeHtml.createScriptSrc=function(e,t){return goog.html.TrustedResourceUrl.unwrap(e),e=goog.html.SafeHtml.combineAttributes({src:e},{},t),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("script",e)},goog.html.SafeHtml.createScript=function(e,t){for(var n in t){var r=n.toLowerCase();if("language"==r||"src"==r||"text"==r||"type"==r)throw Error(goog.html.SafeHtml.ENABLE_ERROR_MESSAGES?'Cannot set "'+r+'" attribute':"")}for(n="",e=goog.array.concat(e),r=0;r<e.length;r++)n+=goog.html.SafeScript.unwrap(e[r]);return e=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(n,goog.i18n.bidi.Dir.NEUTRAL),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("script",t,e)},goog.html.SafeHtml.createStyle=function(e,t){t=goog.html.SafeHtml.combineAttributes({type:"text/css"},{},t);var n="";e=goog.array.concat(e);for(var r=0;r<e.length;r++)n+=goog.html.SafeStyleSheet.unwrap(e[r]);return e=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(n,goog.i18n.bidi.Dir.NEUTRAL),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("style",t,e)},goog.html.SafeHtml.createMetaRefresh=function(e,t){return e=goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(e)),(goog.labs.userAgent.browser.isIE()||goog.labs.userAgent.browser.isEdge())&&goog.string.internal.contains(e,";")&&(e="'"+e.replace(/'/g,"%27")+"'"),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("meta",{"http-equiv":"refresh",content:(t||0)+"; url="+e})},goog.html.SafeHtml.getAttrNameAndValue_=function(e,t,n){if(n instanceof goog.string.Const)n=goog.string.Const.unwrap(n);else if("style"==t.toLowerCase()){if(!goog.html.SafeHtml.SUPPORT_STYLE_ATTRIBUTE)throw Error(goog.html.SafeHtml.ENABLE_ERROR_MESSAGES?'Attribute "style" not supported.':"");n=goog.html.SafeHtml.getStyleValue_(n)}else{if(/^on/i.test(t))throw Error(goog.html.SafeHtml.ENABLE_ERROR_MESSAGES?'Attribute "'+t+'" requires goog.string.Const value, "'+n+'" given.':"");if(t.toLowerCase()in goog.html.SafeHtml.URL_ATTRIBUTES_)if(n instanceof goog.html.TrustedResourceUrl)n=goog.html.TrustedResourceUrl.unwrap(n);else if(n instanceof goog.html.SafeUrl)n=goog.html.SafeUrl.unwrap(n);else{if("string"!=typeof n)throw Error(goog.html.SafeHtml.ENABLE_ERROR_MESSAGES?'Attribute "'+t+'" on tag "'+e+'" requires goog.html.SafeUrl, goog.string.Const, or string, value "'+n+'" given.':"");n=goog.html.SafeUrl.sanitize(n).getTypedStringValue()}}return n.implementsGoogStringTypedString&&(n=n.getTypedStringValue()),goog.asserts.assert("string"==typeof n||"number"==typeof n,"String or number value expected, got "+typeof n+" with value: "+n),t+'="'+goog.string.internal.htmlEscape(String(n))+'"'},goog.html.SafeHtml.getStyleValue_=function(e){if(!goog.isObject(e))throw Error(goog.html.SafeHtml.ENABLE_ERROR_MESSAGES?'The "style" attribute requires goog.html.SafeStyle or map of style properties, '+typeof e+" given: "+e:"");return e instanceof goog.html.SafeStyle||(e=goog.html.SafeStyle.create(e)),goog.html.SafeStyle.unwrap(e)},goog.html.SafeHtml.createWithDir=function(e,t,n,r){return(t=goog.html.SafeHtml.create(t,n,r)).dir_=e,t},goog.html.SafeHtml.join=function(e,t){var n=(e=goog.html.SafeHtml.htmlEscape(e)).getDirection(),r=[],i=function(e){Array.isArray(e)?goog.array.forEach(e,i):(e=goog.html.SafeHtml.htmlEscape(e),r.push(goog.html.SafeHtml.unwrap(e)),e=e.getDirection(),n==goog.i18n.bidi.Dir.NEUTRAL?n=e:e!=goog.i18n.bidi.Dir.NEUTRAL&&n!=e&&(n=null))};return goog.array.forEach(t,i),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(r.join(goog.html.SafeHtml.unwrap(e)),n)},goog.html.SafeHtml.concat=function(e){return goog.html.SafeHtml.join(goog.html.SafeHtml.EMPTY,Array.prototype.slice.call(arguments))},goog.html.SafeHtml.concatWithDir=function(e,t){var n=goog.html.SafeHtml.concat(goog.array.slice(arguments,1));return n.dir_=e,n},goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse=function(e,t){return(new goog.html.SafeHtml).initSecurityPrivateDoNotAccessOrElse_(e,t)},goog.html.SafeHtml.prototype.initSecurityPrivateDoNotAccessOrElse_=function(e,t){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_=goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY?goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY.createHTML(e):e,this.dir_=t,this},goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse=function(e,t,n){var r=null,i="<"+e+goog.html.SafeHtml.stringifyAttributes(e,t);return null==n?n=[]:Array.isArray(n)||(n=[n]),goog.dom.tags.isVoidTag(e.toLowerCase())?(goog.asserts.assert(!n.length,"Void tag <"+e+"> does not allow content."),i+=">"):(r=goog.html.SafeHtml.concat(n),i+=">"+goog.html.SafeHtml.unwrap(r)+"</"+e+">",r=r.getDirection()),(e=t&&t.dir)&&(r=/^(ltr|rtl|auto)$/i.test(e)?goog.i18n.bidi.Dir.NEUTRAL:null),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(i,r)},goog.html.SafeHtml.stringifyAttributes=function(e,t){var n="";if(t)for(var r in t){if(!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(r))throw Error(goog.html.SafeHtml.ENABLE_ERROR_MESSAGES?'Invalid attribute name "'+r+'".':"");var i=t[r];null!=i&&(n+=" "+goog.html.SafeHtml.getAttrNameAndValue_(e,r,i))}return n},goog.html.SafeHtml.combineAttributes=function(e,t,n){var r,i={};for(r in e)goog.asserts.assert(r.toLowerCase()==r,"Must be lower case"),i[r]=e[r];for(r in t)goog.asserts.assert(r.toLowerCase()==r,"Must be lower case"),i[r]=t[r];if(n)for(r in n){var o=r.toLowerCase();if(o in e)throw Error(goog.html.SafeHtml.ENABLE_ERROR_MESSAGES?'Cannot override "'+o+'" attribute, got "'+r+'" with value "'+n[r]+'"':"");o in t&&delete i[o],i[r]=n[r]}return i},goog.html.SafeHtml.DOCTYPE_HTML=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<!DOCTYPE html>",goog.i18n.bidi.Dir.NEUTRAL),goog.html.SafeHtml.EMPTY=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("",goog.i18n.bidi.Dir.NEUTRAL),goog.html.SafeHtml.BR=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<br>",goog.i18n.bidi.Dir.NEUTRAL),goog.html.uncheckedconversions={},goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract=function(e,t,n){return goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification"),goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification"),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(t,n||null)},goog.html.uncheckedconversions.safeScriptFromStringKnownToSatisfyTypeContract=function(e,t){return goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification"),goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification"),goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(t)},goog.html.uncheckedconversions.safeStyleFromStringKnownToSatisfyTypeContract=function(e,t){return goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification"),goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification"),goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(t)},goog.html.uncheckedconversions.safeStyleSheetFromStringKnownToSatisfyTypeContract=function(e,t){return goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification"),goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification"),goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(t)},goog.html.uncheckedconversions.safeUrlFromStringKnownToSatisfyTypeContract=function(e,t){return goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification"),goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification"),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(t)},goog.html.uncheckedconversions.trustedResourceUrlFromStringKnownToSatisfyTypeContract=function(e,t){return goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification"),goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification"),goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(t)},goog.dom.safe={},goog.dom.safe.InsertAdjacentHtmlPosition={AFTERBEGIN:"afterbegin",AFTEREND:"afterend",BEFOREBEGIN:"beforebegin",BEFOREEND:"beforeend"},goog.dom.safe.insertAdjacentHtml=function(e,t,n){e.insertAdjacentHTML(t,goog.html.SafeHtml.unwrapTrustedHTML(n))},goog.dom.safe.SET_INNER_HTML_DISALLOWED_TAGS_={MATH:!0,SCRIPT:!0,STYLE:!0,SVG:!0,TEMPLATE:!0},goog.dom.safe.isInnerHtmlCleanupRecursive_=goog.functions.cacheReturnValue((function(){if(goog.DEBUG&&"undefined"==typeof document)return!1;var e=document.createElement("div"),t=document.createElement("div");return t.appendChild(document.createElement("div")),e.appendChild(t),!(goog.DEBUG&&!e.firstChild||(t=e.firstChild.firstChild,e.innerHTML=goog.html.SafeHtml.unwrapTrustedHTML(goog.html.SafeHtml.EMPTY),t.parentElement))})),goog.dom.safe.unsafeSetInnerHtmlDoNotUseOrElse=function(e,t){if(goog.dom.safe.isInnerHtmlCleanupRecursive_())for(;e.lastChild;)e.removeChild(e.lastChild);e.innerHTML=goog.html.SafeHtml.unwrapTrustedHTML(t)},goog.dom.safe.setInnerHtml=function(e,t){if(goog.asserts.ENABLE_ASSERTS){var n=e.tagName.toUpperCase();if(goog.dom.safe.SET_INNER_HTML_DISALLOWED_TAGS_[n])throw Error("goog.dom.safe.setInnerHtml cannot be used to set content of "+e.tagName+".")}goog.dom.safe.unsafeSetInnerHtmlDoNotUseOrElse(e,t)},goog.dom.safe.setOuterHtml=function(e,t){e.outerHTML=goog.html.SafeHtml.unwrapTrustedHTML(t)},goog.dom.safe.setFormElementAction=function(e,t){t=t instanceof goog.html.SafeUrl?t:goog.html.SafeUrl.sanitizeAssertUnchanged(t),goog.dom.asserts.assertIsHTMLFormElement(e).action=goog.html.SafeUrl.unwrap(t)},goog.dom.safe.setButtonFormAction=function(e,t){t=t instanceof goog.html.SafeUrl?t:goog.html.SafeUrl.sanitizeAssertUnchanged(t),goog.dom.asserts.assertIsHTMLButtonElement(e).formAction=goog.html.SafeUrl.unwrap(t)},goog.dom.safe.setInputFormAction=function(e,t){t=t instanceof goog.html.SafeUrl?t:goog.html.SafeUrl.sanitizeAssertUnchanged(t),goog.dom.asserts.assertIsHTMLInputElement(e).formAction=goog.html.SafeUrl.unwrap(t)},goog.dom.safe.setStyle=function(e,t){e.style.cssText=goog.html.SafeStyle.unwrap(t)},goog.dom.safe.documentWrite=function(e,t){e.write(goog.html.SafeHtml.unwrapTrustedHTML(t))},goog.dom.safe.setAnchorHref=function(e,t){goog.dom.asserts.assertIsHTMLAnchorElement(e),t=t instanceof goog.html.SafeUrl?t:goog.html.SafeUrl.sanitizeAssertUnchanged(t),e.href=goog.html.SafeUrl.unwrap(t)},goog.dom.safe.setImageSrc=function(e,t){if(goog.dom.asserts.assertIsHTMLImageElement(e),!(t instanceof goog.html.SafeUrl)){var n=/^data:image\//i.test(t);t=goog.html.SafeUrl.sanitizeAssertUnchanged(t,n)}e.src=goog.html.SafeUrl.unwrap(t)},goog.dom.safe.setAudioSrc=function(e,t){if(goog.dom.asserts.assertIsHTMLAudioElement(e),!(t instanceof goog.html.SafeUrl)){var n=/^data:audio\//i.test(t);t=goog.html.SafeUrl.sanitizeAssertUnchanged(t,n)}e.src=goog.html.SafeUrl.unwrap(t)},goog.dom.safe.setVideoSrc=function(e,t){if(goog.dom.asserts.assertIsHTMLVideoElement(e),!(t instanceof goog.html.SafeUrl)){var n=/^data:video\//i.test(t);t=goog.html.SafeUrl.sanitizeAssertUnchanged(t,n)}e.src=goog.html.SafeUrl.unwrap(t)},goog.dom.safe.setEmbedSrc=function(e,t){goog.dom.asserts.assertIsHTMLEmbedElement(e),e.src=goog.html.TrustedResourceUrl.unwrapTrustedScriptURL(t)},goog.dom.safe.setFrameSrc=function(e,t){goog.dom.asserts.assertIsHTMLFrameElement(e),e.src=goog.html.TrustedResourceUrl.unwrap(t)},goog.dom.safe.setIframeSrc=function(e,t){goog.dom.asserts.assertIsHTMLIFrameElement(e),e.src=goog.html.TrustedResourceUrl.unwrap(t)},goog.dom.safe.setIframeSrcdoc=function(e,t){goog.dom.asserts.assertIsHTMLIFrameElement(e),e.srcdoc=goog.html.SafeHtml.unwrapTrustedHTML(t)},goog.dom.safe.setLinkHrefAndRel=function(e,t,n){goog.dom.asserts.assertIsHTMLLinkElement(e),e.rel=n,goog.string.internal.caseInsensitiveContains(n,"stylesheet")?(goog.asserts.assert(t instanceof goog.html.TrustedResourceUrl,'URL must be TrustedResourceUrl because "rel" contains "stylesheet"'),e.href=goog.html.TrustedResourceUrl.unwrap(t)):e.href=t instanceof goog.html.TrustedResourceUrl?goog.html.TrustedResourceUrl.unwrap(t):t instanceof goog.html.SafeUrl?goog.html.SafeUrl.unwrap(t):goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitizeAssertUnchanged(t))},goog.dom.safe.setObjectData=function(e,t){goog.dom.asserts.assertIsHTMLObjectElement(e),e.data=goog.html.TrustedResourceUrl.unwrapTrustedScriptURL(t)},goog.dom.safe.setScriptSrc=function(e,t){goog.dom.asserts.assertIsHTMLScriptElement(e),e.src=goog.html.TrustedResourceUrl.unwrapTrustedScriptURL(t),(t=goog.getScriptNonce())&&e.setAttribute("nonce",t)},goog.dom.safe.setScriptContent=function(e,t){goog.dom.asserts.assertIsHTMLScriptElement(e),e.text=goog.html.SafeScript.unwrapTrustedScript(t),(t=goog.getScriptNonce())&&e.setAttribute("nonce",t)},goog.dom.safe.setLocationHref=function(e,t){goog.dom.asserts.assertIsLocation(e),t=t instanceof goog.html.SafeUrl?t:goog.html.SafeUrl.sanitizeAssertUnchanged(t),e.href=goog.html.SafeUrl.unwrap(t)},goog.dom.safe.assignLocation=function(e,t){goog.dom.asserts.assertIsLocation(e),t=t instanceof goog.html.SafeUrl?t:goog.html.SafeUrl.sanitizeAssertUnchanged(t),e.assign(goog.html.SafeUrl.unwrap(t))},goog.dom.safe.replaceLocation=function(e,t){t=t instanceof goog.html.SafeUrl?t:goog.html.SafeUrl.sanitizeAssertUnchanged(t),e.replace(goog.html.SafeUrl.unwrap(t))},goog.dom.safe.openInWindow=function(e,t,n,r,i){return e=e instanceof goog.html.SafeUrl?e:goog.html.SafeUrl.sanitizeAssertUnchanged(e),t=t||goog.global,n=n instanceof goog.string.Const?goog.string.Const.unwrap(n):n||"",t.open(goog.html.SafeUrl.unwrap(e),n,r,i)},goog.dom.safe.parseFromStringHtml=function(e,t){return goog.dom.safe.parseFromString(e,t,"text/html")},goog.dom.safe.parseFromString=function(e,t,n){return e.parseFromString(goog.html.SafeHtml.unwrapTrustedHTML(t),n)},goog.dom.safe.createImageFromBlob=function(e){if(!/^image\/.*/g.test(e.type))throw Error("goog.dom.safe.createImageFromBlob only accepts MIME type image/.*.");var t=goog.global.URL.createObjectURL(e);return(e=new goog.global.Image).onload=function(){goog.global.URL.revokeObjectURL(t)},goog.dom.safe.setImageSrc(e,goog.html.uncheckedconversions.safeUrlFromStringKnownToSatisfyTypeContract(goog.string.Const.from("Image blob URL."),t)),e},goog.string.DETECT_DOUBLE_ESCAPING=!1,goog.string.FORCE_NON_DOM_HTML_UNESCAPING=!1,goog.string.Unicode={NBSP:""},goog.string.startsWith=goog.string.internal.startsWith,goog.string.endsWith=goog.string.internal.endsWith,goog.string.caseInsensitiveStartsWith=goog.string.internal.caseInsensitiveStartsWith,goog.string.caseInsensitiveEndsWith=goog.string.internal.caseInsensitiveEndsWith,goog.string.caseInsensitiveEquals=goog.string.internal.caseInsensitiveEquals,goog.string.subs=function(e,t){for(var n=e.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")},goog.string.collapseWhitespace=function(e){return e.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")},goog.string.isEmptyOrWhitespace=goog.string.internal.isEmptyOrWhitespace,goog.string.isEmptyString=function(e){return 0==e.length},goog.string.isEmpty=goog.string.isEmptyOrWhitespace,goog.string.isEmptyOrWhitespaceSafe=function(e){return goog.string.isEmptyOrWhitespace(goog.string.makeSafe(e))},goog.string.isEmptySafe=goog.string.isEmptyOrWhitespaceSafe,goog.string.isBreakingWhitespace=function(e){return!/[^\t\n\r ]/.test(e)},goog.string.isAlpha=function(e){return!/[^a-zA-Z]/.test(e)},goog.string.isNumeric=function(e){return!/[^0-9]/.test(e)},goog.string.isAlphaNumeric=function(e){return!/[^a-zA-Z0-9]/.test(e)},goog.string.isSpace=function(e){return" "==e},goog.string.isUnicodeChar=function(e){return 1==e.length&&" "<=e&&"~">=e||""<=e&&"">=e},goog.string.stripNewlines=function(e){return e.replace(/(\r\n|\r|\n)+/g," ")},goog.string.canonicalizeNewlines=function(e){return e.replace(/(\r\n|\r|\n)/g,"\n")},goog.string.normalizeWhitespace=function(e){return e.replace(/\xa0|\s/g," ")},goog.string.normalizeSpaces=function(e){return e.replace(/\xa0|[ \t]+/g," ")},goog.string.collapseBreakingSpaces=function(e){return e.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")},goog.string.trim=goog.string.internal.trim,goog.string.trimLeft=function(e){return e.replace(/^[\s\xa0]+/,"")},goog.string.trimRight=function(e){return e.replace(/[\s\xa0]+$/,"")},goog.string.caseInsensitiveCompare=goog.string.internal.caseInsensitiveCompare,goog.string.numberAwareCompare_=function(e,t,n){if(e==t)return 0;if(!e)return-1;if(!t)return 1;for(var r=e.toLowerCase().match(n),i=t.toLowerCase().match(n),o=Math.min(r.length,i.length),a=0;a<o;a++){n=r[a];var s=i[a];if(n!=s)return e=parseInt(n,10),!isNaN(e)&&(t=parseInt(s,10),!isNaN(t)&&e-t)?e-t:n<s?-1:1}return r.length!=i.length?r.length-i.length:e<t?-1:1},goog.string.intAwareCompare=function(e,t){return goog.string.numberAwareCompare_(e,t,/\d+|\D+/g)},goog.string.floatAwareCompare=function(e,t){return goog.string.numberAwareCompare_(e,t,/\d+|\.\d+|\D+/g)},goog.string.numerateCompare=goog.string.floatAwareCompare,goog.string.urlEncode=function(e){return encodeURIComponent(String(e))},goog.string.urlDecode=function(e){return decodeURIComponent(e.replace(/\+/g," "))},goog.string.newLineToBr=goog.string.internal.newLineToBr,goog.string.htmlEscape=function(e,t){return e=goog.string.internal.htmlEscape(e,t),goog.string.DETECT_DOUBLE_ESCAPING&&(e=e.replace(goog.string.E_RE_,"&#101;")),e},goog.string.E_RE_=/e/g,goog.string.unescapeEntities=function(e){return goog.string.contains(e,"&")?!goog.string.FORCE_NON_DOM_HTML_UNESCAPING&&"document"in goog.global?goog.string.unescapeEntitiesUsingDom_(e):goog.string.unescapePureXmlEntities_(e):e},goog.string.unescapeEntitiesWithDocument=function(e,t){return goog.string.contains(e,"&")?goog.string.unescapeEntitiesUsingDom_(e,t):e},goog.string.unescapeEntitiesUsingDom_=function(e,t){var n={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'},r=t?t.createElement("div"):goog.global.document.createElement("div");return e.replace(goog.string.HTML_ENTITY_PATTERN_,(function(e,t){var i=n[e];return i||("#"==t.charAt(0)&&(t=Number("0"+t.substr(1)),isNaN(t)||(i=String.fromCharCode(t))),i||(goog.dom.safe.setInnerHtml(r,goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract(goog.string.Const.from("Single HTML entity."),e+" ")),i=r.firstChild.nodeValue.slice(0,-1)),n[e]=i)}))},goog.string.unescapePureXmlEntities_=function(e){return e.replace(/&([^;]+);/g,(function(e,t){switch(t){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';default:return"#"!=t.charAt(0)||(t=Number("0"+t.substr(1)),isNaN(t))?e:String.fromCharCode(t)}}))},goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g,goog.string.whitespaceEscape=function(e,t){return goog.string.newLineToBr(e.replace(/  /g," &#160;"),t)},goog.string.preserveSpaces=function(e){return e.replace(/(^|[\n ]) /g,"$1"+goog.string.Unicode.NBSP)},goog.string.stripQuotes=function(e,t){for(var n=t.length,r=0;r<n;r++){var i=1==n?t:t.charAt(r);if(e.charAt(0)==i&&e.charAt(e.length-1)==i)return e.substring(1,e.length-1)}return e},goog.string.truncate=function(e,t,n){return n&&(e=goog.string.unescapeEntities(e)),e.length>t&&(e=e.substring(0,t-3)+"..."),n&&(e=goog.string.htmlEscape(e)),e},goog.string.truncateMiddle=function(e,t,n,r){if(n&&(e=goog.string.unescapeEntities(e)),r&&e.length>t){r>t&&(r=t);var i=e.length-r;e=e.substring(0,t-r)+"..."+e.substring(i)}else e.length>t&&(r=Math.floor(t/2),i=e.length-r,e=e.substring(0,r+t%2)+"..."+e.substring(i));return n&&(e=goog.string.htmlEscape(e)),e},goog.string.specialEscapeChars_={"\0":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\x0B",'"':'\\"',"\\":"\\\\","<":"\\u003C"},goog.string.jsEscapeCache_={"'":"\\'"},goog.string.quote=function(e){e=String(e);for(var t=['"'],n=0;n<e.length;n++){var r=e.charAt(n),i=r.charCodeAt(0);t[n+1]=goog.string.specialEscapeChars_[r]||(31<i&&127>i?r:goog.string.escapeChar(r))}return t.push('"'),t.join("")},goog.string.escapeString=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=goog.string.escapeChar(e.charAt(n));return t.join("")},goog.string.escapeChar=function(e){if(e in goog.string.jsEscapeCache_)return goog.string.jsEscapeCache_[e];if(e in goog.string.specialEscapeChars_)return goog.string.jsEscapeCache_[e]=goog.string.specialEscapeChars_[e];var t=e.charCodeAt(0);if(31<t&&127>t)var n=e;else 256>t?(n="\\x",(16>t||256<t)&&(n+="0")):(n="\\u",4096>t&&(n+="0")),n+=t.toString(16).toUpperCase();return goog.string.jsEscapeCache_[e]=n},goog.string.contains=goog.string.internal.contains,goog.string.caseInsensitiveContains=goog.string.internal.caseInsensitiveContains,goog.string.countOf=function(e,t){return e&&t?e.split(t).length-1:0},goog.string.removeAt=function(e,t,n){var r=e;return 0<=t&&t<e.length&&0<n&&(r=e.substr(0,t)+e.substr(t+n,e.length-t-n)),r},goog.string.remove=function(e,t){return e.replace(t,"")},goog.string.removeAll=function(e,t){return t=new RegExp(goog.string.regExpEscape(t),"g"),e.replace(t,"")},goog.string.replaceAll=function(e,t,n){return t=new RegExp(goog.string.regExpEscape(t),"g"),e.replace(t,n.replace(/\$/g,"$$$$"))},goog.string.regExpEscape=function(e){return String(e).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},goog.string.repeat=String.prototype.repeat?function(e,t){return e.repeat(t)}:function(e,t){return Array(t+1).join(e)},goog.string.padNumber=function(e,t,n){return-1==(n=(e=void 0!==n?e.toFixed(n):String(e)).indexOf("."))&&(n=e.length),goog.string.repeat("0",Math.max(0,t-n))+e},goog.string.makeSafe=function(e){return null==e?"":String(e)},goog.string.buildString=function(e){return Array.prototype.join.call(arguments,"")},goog.string.getRandomString=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^goog.now()).toString(36)},goog.string.compareVersions=goog.string.internal.compareVersions,goog.string.hashCode=function(e){for(var t=0,n=0;n<e.length;++n)t=31*t+e.charCodeAt(n)>>>0;return t},goog.string.uniqueStringCounter_=2147483648*Math.random()|0,goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++},goog.string.toNumber=function(e){var t=Number(e);return 0==t&&goog.string.isEmptyOrWhitespace(e)?NaN:t},goog.string.isLowerCamelCase=function(e){return/^[a-z]+([A-Z][a-z]*)*$/.test(e)},goog.string.isUpperCamelCase=function(e){return/^([A-Z][a-z]*)+$/.test(e)},goog.string.toCamelCase=function(e){return String(e).replace(/\-([a-z])/g,(function(e,t){return t.toUpperCase()}))},goog.string.toSelectorCase=function(e){return String(e).replace(/([A-Z])/g,"-$1").toLowerCase()},goog.string.toTitleCase=function(e,t){return t="string"==typeof t?goog.string.regExpEscape(t):"\\s",e.replace(new RegExp("(^"+(t?"|["+t+"]+":"")+")([a-z])","g"),(function(e,t,n){return t+n.toUpperCase()}))},goog.string.capitalize=function(e){return String(e.charAt(0)).toUpperCase()+String(e.substr(1)).toLowerCase()},goog.string.parseInt=function(e){return isFinite(e)&&(e=String(e)),"string"==typeof e?/^\s*-?0x/i.test(e)?parseInt(e,16):parseInt(e,10):NaN},goog.string.splitLimit=function(e,t,n){e=e.split(t);for(var r=[];0<n&&e.length;)r.push(e.shift()),n--;return e.length&&r.push(e.join(t)),r},goog.string.lastComponent=function(e,t){if(!t)return e;"string"==typeof t&&(t=[t]);for(var n=-1,r=0;r<t.length;r++)if(""!=t[r]){var i=e.lastIndexOf(t[r]);i>n&&(n=i)}return-1==n?e:e.slice(n+1)},goog.string.editDistance=function(e,t){var n=[],r=[];if(e==t)return 0;if(!e.length||!t.length)return Math.max(e.length,t.length);for(var i=0;i<t.length+1;i++)n[i]=i;for(i=0;i<e.length;i++){r[0]=i+1;for(var o=0;o<t.length;o++)r[o+1]=Math.min(r[o]+1,n[o+1]+1,n[o]+Number(e[i]!=t[o]));for(o=0;o<n.length;o++)n[o]=r[o]}return r[t.length]},goog.labs.userAgent.engine={},goog.labs.userAgent.engine.isPresto=function(){return goog.labs.userAgent.util.matchUserAgent("Presto")},goog.labs.userAgent.engine.isTrident=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")},goog.labs.userAgent.engine.isEdge=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")},goog.labs.userAgent.engine.isWebKit=function(){return goog.labs.userAgent.util.matchUserAgentIgnoreCase("WebKit")&&!goog.labs.userAgent.engine.isEdge()},goog.labs.userAgent.engine.isGecko=function(){return goog.labs.userAgent.util.matchUserAgent("Gecko")&&!goog.labs.userAgent.engine.isWebKit()&&!goog.labs.userAgent.engine.isTrident()&&!goog.labs.userAgent.engine.isEdge()},goog.labs.userAgent.engine.getVersion=function(){var e=goog.labs.userAgent.util.getUserAgent();if(e){e=goog.labs.userAgent.util.extractVersionTuples(e);var t,n=goog.labs.userAgent.engine.getEngineTuple_(e);if(n)return"Gecko"==n[0]?goog.labs.userAgent.engine.getVersionForKey_(e,"Firefox"):n[1];if((e=e[0])&&(t=e[2])&&(t=/Trident\/([^\s;]+)/.exec(t)))return t[1]}return""},goog.labs.userAgent.engine.getEngineTuple_=function(e){if(!goog.labs.userAgent.engine.isEdge())return e[1];for(var t=0;t<e.length;t++){var n=e[t];if("Edge"==n[0])return n}},goog.labs.userAgent.engine.isVersionOrHigher=function(e){return 0<=goog.string.compareVersions(goog.labs.userAgent.engine.getVersion(),e)},goog.labs.userAgent.engine.getVersionForKey_=function(e,t){return(e=goog.array.find(e,(function(e){return t==e[0]})))&&e[1]||""},goog.labs.userAgent.platform={},goog.labs.userAgent.platform.isAndroid=function(){return goog.labs.userAgent.util.matchUserAgent("Android")},goog.labs.userAgent.platform.isIpod=function(){return goog.labs.userAgent.util.matchUserAgent("iPod")},goog.labs.userAgent.platform.isIphone=function(){return goog.labs.userAgent.util.matchUserAgent("iPhone")&&!goog.labs.userAgent.util.matchUserAgent("iPod")&&!goog.labs.userAgent.util.matchUserAgent("iPad")},goog.labs.userAgent.platform.isIpad=function(){return goog.labs.userAgent.util.matchUserAgent("iPad")},goog.labs.userAgent.platform.isIos=function(){return goog.labs.userAgent.platform.isIphone()||goog.labs.userAgent.platform.isIpad()||goog.labs.userAgent.platform.isIpod()},goog.labs.userAgent.platform.isMacintosh=function(){return goog.labs.userAgent.util.matchUserAgent("Macintosh")},goog.labs.userAgent.platform.isLinux=function(){return goog.labs.userAgent.util.matchUserAgent("Linux")},goog.labs.userAgent.platform.isWindows=function(){return goog.labs.userAgent.util.matchUserAgent("Windows")},goog.labs.userAgent.platform.isChromeOS=function(){return goog.labs.userAgent.util.matchUserAgent("CrOS")},goog.labs.userAgent.platform.isChromecast=function(){return goog.labs.userAgent.util.matchUserAgent("CrKey")},goog.labs.userAgent.platform.isKaiOS=function(){return goog.labs.userAgent.util.matchUserAgentIgnoreCase("KaiOS")},goog.labs.userAgent.platform.getVersion=function(){var e=goog.labs.userAgent.util.getUserAgent(),t="";return goog.labs.userAgent.platform.isWindows()?t=(e=(t=/Windows (?:NT|Phone) ([0-9.]+)/).exec(e))?e[1]:"0.0":goog.labs.userAgent.platform.isIos()?t=(e=(t=/(?:iPhone|iPod|iPad|CPU)\s+OS\s+(\S+)/).exec(e))&&e[1].replace(/_/g,"."):goog.labs.userAgent.platform.isMacintosh()?t=(e=(t=/Mac OS X ([0-9_.]+)/).exec(e))?e[1].replace(/_/g,"."):"10":goog.labs.userAgent.platform.isKaiOS()?t=(e=(t=/(?:KaiOS)\/(\S+)/i).exec(e))&&e[1]:goog.labs.userAgent.platform.isAndroid()?t=(e=(t=/Android\s+([^\);]+)(\)|;)/).exec(e))&&e[1]:goog.labs.userAgent.platform.isChromeOS()&&(t=(e=(t=/(?:CrOS\s+(?:i686|x86_64)\s+([0-9.]+))/).exec(e))&&e[1]),t||""},goog.labs.userAgent.platform.isVersionOrHigher=function(e){return 0<=goog.string.compareVersions(goog.labs.userAgent.platform.getVersion(),e)},goog.reflect={},goog.reflect.object=function(e,t){return t},goog.reflect.objectProperty=function(e,t){return e},goog.reflect.sinkValue=function(e){return goog.reflect.sinkValue[" "](e),e},goog.reflect.sinkValue[" "]=goog.nullFunction,goog.reflect.canAccessProperty=function(e,t){try{return goog.reflect.sinkValue(e[t]),!0}catch(e){}return!1},goog.reflect.cache=function(e,t,n,r){return r=r?r(t):t,Object.prototype.hasOwnProperty.call(e,r)?e[r]:e[r]=n(t)},goog.userAgent={},goog.userAgent.ASSUME_IE=!1,goog.userAgent.ASSUME_EDGE=!1,goog.userAgent.ASSUME_GECKO=!1,goog.userAgent.ASSUME_WEBKIT=!1,goog.userAgent.ASSUME_MOBILE_WEBKIT=!1,goog.userAgent.ASSUME_OPERA=!1,goog.userAgent.ASSUME_ANY_VERSION=!1,goog.userAgent.BROWSER_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_EDGE||goog.userAgent.ASSUME_GECKO||goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_OPERA,goog.userAgent.getUserAgentString=function(){return goog.labs.userAgent.util.getUserAgent()},goog.userAgent.getNavigatorTyped=function(){return goog.global.navigator||null},goog.userAgent.getNavigator=function(){return goog.userAgent.getNavigatorTyped()},goog.userAgent.OPERA=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_OPERA:goog.labs.userAgent.browser.isOpera(),goog.userAgent.IE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_IE:goog.labs.userAgent.browser.isIE(),goog.userAgent.EDGE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_EDGE:goog.labs.userAgent.engine.isEdge(),goog.userAgent.EDGE_OR_IE=goog.userAgent.EDGE||goog.userAgent.IE,goog.userAgent.GECKO=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_GECKO:goog.labs.userAgent.engine.isGecko(),goog.userAgent.WEBKIT=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_MOBILE_WEBKIT:goog.labs.userAgent.engine.isWebKit(),goog.userAgent.isMobile_=function(){return goog.userAgent.WEBKIT&&goog.labs.userAgent.util.matchUserAgent("Mobile")},goog.userAgent.MOBILE=goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.isMobile_(),goog.userAgent.SAFARI=goog.userAgent.WEBKIT,goog.userAgent.determinePlatform_=function(){var e=goog.userAgent.getNavigatorTyped();return e&&e.platform||""},goog.userAgent.PLATFORM=goog.userAgent.determinePlatform_(),goog.userAgent.ASSUME_MAC=!1,goog.userAgent.ASSUME_WINDOWS=!1,goog.userAgent.ASSUME_LINUX=!1,goog.userAgent.ASSUME_X11=!1,goog.userAgent.ASSUME_ANDROID=!1,goog.userAgent.ASSUME_IPHONE=!1,goog.userAgent.ASSUME_IPAD=!1,goog.userAgent.ASSUME_IPOD=!1,goog.userAgent.ASSUME_KAIOS=!1,goog.userAgent.PLATFORM_KNOWN_=goog.userAgent.ASSUME_MAC||goog.userAgent.ASSUME_WINDOWS||goog.userAgent.ASSUME_LINUX||goog.userAgent.ASSUME_X11||goog.userAgent.ASSUME_ANDROID||goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD||goog.userAgent.ASSUME_IPOD,goog.userAgent.MAC=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_MAC:goog.labs.userAgent.platform.isMacintosh();goog.userAgent.WINDOWS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_WINDOWS:goog.labs.userAgent.platform.isWindows(),goog.userAgent.isLegacyLinux_=function(){return goog.labs.userAgent.platform.isLinux()||goog.labs.userAgent.platform.isChromeOS()},goog.userAgent.LINUX=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_LINUX:goog.userAgent.isLegacyLinux_(),goog.userAgent.isX11_=function(){var e=goog.userAgent.getNavigatorTyped();return!!e&&goog.string.contains(e.appVersion||"","X11")},goog.userAgent.X11=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_X11:goog.userAgent.isX11_(),goog.userAgent.ANDROID=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_ANDROID:goog.labs.userAgent.platform.isAndroid(),goog.userAgent.IPHONE=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE:goog.labs.userAgent.platform.isIphone(),goog.userAgent.IPAD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPAD:goog.labs.userAgent.platform.isIpad(),goog.userAgent.IPOD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPOD:goog.labs.userAgent.platform.isIpod(),goog.userAgent.IOS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD||goog.userAgent.ASSUME_IPOD:goog.labs.userAgent.platform.isIos(),goog.userAgent.KAIOS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_KAIOS:goog.labs.userAgent.platform.isKaiOS(),goog.userAgent.determineVersion_=function(){var e="",t=goog.userAgent.getVersionRegexResult_();return t&&(e=t?t[1]:""),goog.userAgent.IE&&null!=(t=goog.userAgent.getDocumentMode_())&&t>parseFloat(e)?String(t):e},goog.userAgent.getVersionRegexResult_=function(){var e=goog.userAgent.getUserAgentString();return goog.userAgent.GECKO?/rv:([^\);]+)(\)|;)/.exec(e):goog.userAgent.EDGE?/Edge\/([\d\.]+)/.exec(e):goog.userAgent.IE?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):goog.userAgent.WEBKIT?/WebKit\/(\S+)/.exec(e):goog.userAgent.OPERA?/(?:Version)[ \/]?(\S+)/.exec(e):void 0},goog.userAgent.getDocumentMode_=function(){var e=goog.global.document;return e?e.documentMode:void 0},goog.userAgent.VERSION=goog.userAgent.determineVersion_(),goog.userAgent.compare=function(e,t){return goog.string.compareVersions(e,t)},goog.userAgent.isVersionOrHigherCache_={},goog.userAgent.isVersionOrHigher=function(e){return goog.userAgent.ASSUME_ANY_VERSION||goog.reflect.cache(goog.userAgent.isVersionOrHigherCache_,e,(function(){return 0<=goog.string.compareVersions(goog.userAgent.VERSION,e)}))},goog.userAgent.isVersion=goog.userAgent.isVersionOrHigher,goog.userAgent.isDocumentModeOrHigher=function(e){return Number(goog.userAgent.DOCUMENT_MODE)>=e},goog.userAgent.isDocumentMode=goog.userAgent.isDocumentModeOrHigher,goog.userAgent.DOCUMENT_MODE=function(){if(goog.global.document&&goog.userAgent.IE)return goog.userAgent.getDocumentMode_()||parseInt(goog.userAgent.VERSION,10)||void 0}(),goog.userAgent.product={},goog.userAgent.product.ASSUME_FIREFOX=!1,goog.userAgent.product.ASSUME_IPHONE=!1,goog.userAgent.product.ASSUME_IPAD=!1,goog.userAgent.product.ASSUME_ANDROID=!1,goog.userAgent.product.ASSUME_CHROME=!1,goog.userAgent.product.ASSUME_SAFARI=!1,goog.userAgent.product.PRODUCT_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_EDGE||goog.userAgent.ASSUME_OPERA||goog.userAgent.product.ASSUME_FIREFOX||goog.userAgent.product.ASSUME_IPHONE||goog.userAgent.product.ASSUME_IPAD||goog.userAgent.product.ASSUME_ANDROID||goog.userAgent.product.ASSUME_CHROME||goog.userAgent.product.ASSUME_SAFARI,goog.userAgent.product.OPERA=goog.userAgent.OPERA,goog.userAgent.product.IE=goog.userAgent.IE,goog.userAgent.product.EDGE=goog.userAgent.EDGE,goog.userAgent.product.FIREFOX=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_FIREFOX:goog.labs.userAgent.browser.isFirefox(),goog.userAgent.product.isIphoneOrIpod_=function(){return goog.labs.userAgent.platform.isIphone()||goog.labs.userAgent.platform.isIpod()},goog.userAgent.product.IPHONE=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_IPHONE:goog.userAgent.product.isIphoneOrIpod_(),goog.userAgent.product.IPAD=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_IPAD:goog.labs.userAgent.platform.isIpad(),goog.userAgent.product.ANDROID=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_ANDROID:goog.labs.userAgent.browser.isAndroidBrowser(),goog.userAgent.product.CHROME=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_CHROME:goog.labs.userAgent.browser.isChrome(),goog.userAgent.product.isSafariDesktop_=function(){return goog.labs.userAgent.browser.isSafari()&&!goog.labs.userAgent.platform.isIos()},goog.userAgent.product.SAFARI=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_SAFARI:goog.userAgent.product.isSafariDesktop_(),goog.crypt.base64={},goog.crypt.base64.DEFAULT_ALPHABET_COMMON_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",goog.crypt.base64.ENCODED_VALS=goog.crypt.base64.DEFAULT_ALPHABET_COMMON_+"+/=",goog.crypt.base64.ENCODED_VALS_WEBSAFE=goog.crypt.base64.DEFAULT_ALPHABET_COMMON_+"-_.",goog.crypt.base64.Alphabet={DEFAULT:0,NO_PADDING:1,WEBSAFE:2,WEBSAFE_DOT_PADDING:3,WEBSAFE_NO_PADDING:4},goog.crypt.base64.paddingChars_="=.",goog.crypt.base64.isPadding_=function(e){return goog.string.contains(goog.crypt.base64.paddingChars_,e)},goog.crypt.base64.byteToCharMaps_={},goog.crypt.base64.charToByteMap_=null,goog.crypt.base64.ASSUME_NATIVE_SUPPORT_=goog.userAgent.GECKO||goog.userAgent.WEBKIT&&!goog.userAgent.product.SAFARI||goog.userAgent.OPERA,goog.crypt.base64.HAS_NATIVE_ENCODE_=goog.crypt.base64.ASSUME_NATIVE_SUPPORT_||"function"==typeof goog.global.btoa,goog.crypt.base64.HAS_NATIVE_DECODE_=goog.crypt.base64.ASSUME_NATIVE_SUPPORT_||!goog.userAgent.product.SAFARI&&!goog.userAgent.IE&&"function"==typeof goog.global.atob,goog.crypt.base64.encodeByteArray=function(e,t){goog.asserts.assert(goog.isArrayLike(e),"encodeByteArray takes an array as a parameter"),void 0===t&&(t=goog.crypt.base64.Alphabet.DEFAULT),goog.crypt.base64.init_(),t=goog.crypt.base64.byteToCharMaps_[t];for(var n=[],r=0;r<e.length;r+=3){var i=e[r],o=r+1<e.length,a=o?e[r+1]:0,s=r+2<e.length,u=s?e[r+2]:0,l=i>>2;i=(3&i)<<4|a>>4,a=(15&a)<<2|u>>6,u&=63,s||(u=64,o||(a=64)),n.push(t[l],t[i],t[a]||"",t[u]||"")}return n.join("")},goog.crypt.base64.encodeString=function(e,t){return goog.crypt.base64.HAS_NATIVE_ENCODE_&&!t?goog.global.btoa(e):goog.crypt.base64.encodeByteArray(goog.crypt.stringToByteArray(e),t)},goog.crypt.base64.decodeString=function(e,t){if(goog.crypt.base64.HAS_NATIVE_DECODE_&&!t)return goog.global.atob(e);var n="";return goog.crypt.base64.decodeStringInternal_(e,(function(e){n+=String.fromCharCode(e)})),n},goog.crypt.base64.decodeStringToByteArray=function(e,t){var n=[];return goog.crypt.base64.decodeStringInternal_(e,(function(e){n.push(e)})),n},goog.crypt.base64.decodeStringToUint8Array=function(e){goog.asserts.assert(!goog.userAgent.IE||goog.userAgent.isVersionOrHigher("10"),"Browser does not support typed arrays");var t=e.length,n=3*t/4;n%3?n=Math.floor(n):goog.crypt.base64.isPadding_(e[t-1])&&(n=goog.crypt.base64.isPadding_(e[t-2])?n-2:n-1);var r=new Uint8Array(n),i=0;return goog.crypt.base64.decodeStringInternal_(e,(function(e){r[i++]=e})),r.subarray(0,i)},goog.crypt.base64.decodeStringInternal_=function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=goog.crypt.base64.charToByteMap_[n];if(null!=i)return i;if(!goog.string.isEmptyOrWhitespace(n))throw Error("Unknown base64 encoding at char: "+n)}return t}goog.crypt.base64.init_();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;t(i<<2|o>>4),64!=a&&(t(o<<4&240|a>>2),64!=s&&t(a<<6&192|s))}},goog.crypt.base64.init_=function(){if(!goog.crypt.base64.charToByteMap_){goog.crypt.base64.charToByteMap_={};for(var e=goog.crypt.base64.DEFAULT_ALPHABET_COMMON_.split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=e.concat(t[n].split(""));goog.crypt.base64.byteToCharMaps_[n]=r;for(var i=0;i<r.length;i++){var o=r[i],a=goog.crypt.base64.charToByteMap_[o];void 0===a?goog.crypt.base64.charToByteMap_[o]=i:goog.asserts.assert(a===i)}}}},jspb.utils={},jspb.utils.split64Low=0,jspb.utils.split64High=0,jspb.utils.splitUint64=function(e){var t=e>>>0;e=Math.floor((e-t)/jspb.BinaryConstants.TWO_TO_32)>>>0,jspb.utils.split64Low=t,jspb.utils.split64High=e},jspb.utils.splitInt64=function(e){var t=0>e,n=(e=Math.abs(e))>>>0;e=Math.floor((e-n)/jspb.BinaryConstants.TWO_TO_32),e>>>=0,t&&(e=~e>>>0,4294967295<(n=1+(~n>>>0))&&(n=0,4294967295<++e&&(e=0))),jspb.utils.split64Low=n,jspb.utils.split64High=e},jspb.utils.splitZigzag64=function(e){var t=0>e;e=2*Math.abs(e),jspb.utils.splitUint64(e),e=jspb.utils.split64Low;var n=jspb.utils.split64High;t&&(0==e?0==n?n=e=4294967295:(n--,e=4294967295):e--),jspb.utils.split64Low=e,jspb.utils.split64High=n},jspb.utils.splitFloat32=function(e){var t=0>e?1:0;if(0===(e=t?-e:e))0<1/e?(jspb.utils.split64High=0,jspb.utils.split64Low=0):(jspb.utils.split64High=0,jspb.utils.split64Low=2147483648);else if(isNaN(e))jspb.utils.split64High=0,jspb.utils.split64Low=2147483647;else if(e>jspb.BinaryConstants.FLOAT32_MAX)jspb.utils.split64High=0,jspb.utils.split64Low=(t<<31|2139095040)>>>0;else if(e<jspb.BinaryConstants.FLOAT32_MIN)e=Math.round(e/Math.pow(2,-149)),jspb.utils.split64High=0,jspb.utils.split64Low=(t<<31|e)>>>0;else{var n=Math.floor(Math.log(e)/Math.LN2);e*=Math.pow(2,-n),16777216<=(e=Math.round(e*jspb.BinaryConstants.TWO_TO_23))&&++n,jspb.utils.split64High=0,jspb.utils.split64Low=(t<<31|n+127<<23|8388607&e)>>>0}},jspb.utils.splitFloat64=function(e){var t=0>e?1:0;if(0===(e=t?-e:e))jspb.utils.split64High=0<1/e?0:2147483648,jspb.utils.split64Low=0;else if(isNaN(e))jspb.utils.split64High=2147483647,jspb.utils.split64Low=4294967295;else if(e>jspb.BinaryConstants.FLOAT64_MAX)jspb.utils.split64High=(t<<31|2146435072)>>>0,jspb.utils.split64Low=0;else if(e<jspb.BinaryConstants.FLOAT64_MIN){var n=e/Math.pow(2,-1074);e=n/jspb.BinaryConstants.TWO_TO_32,jspb.utils.split64High=(t<<31|e)>>>0,jspb.utils.split64Low=n>>>0}else{var r=0;if(2<=(n=e))for(;2<=n&&1023>r;)r++,n/=2;else for(;1>n&&-1022<r;)n*=2,r--;e=(n=e*Math.pow(2,-r))*jspb.BinaryConstants.TWO_TO_20&1048575,n=n*jspb.BinaryConstants.TWO_TO_52>>>0,jspb.utils.split64High=(t<<31|r+1023<<20|e)>>>0,jspb.utils.split64Low=n}},jspb.utils.splitHash64=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),o=e.charCodeAt(4),a=e.charCodeAt(5),s=e.charCodeAt(6);e=e.charCodeAt(7),jspb.utils.split64Low=t+(n<<8)+(r<<16)+(i<<24)>>>0,jspb.utils.split64High=o+(a<<8)+(s<<16)+(e<<24)>>>0},jspb.utils.joinUint64=function(e,t){return t*jspb.BinaryConstants.TWO_TO_32+(e>>>0)},jspb.utils.joinInt64=function(e,t){var n=2147483648&t;return n&&(t=~t>>>0,0==(e=1+~e>>>0)&&(t=t+1>>>0)),e=jspb.utils.joinUint64(e,t),n?-e:e},jspb.utils.toZigzag64=function(e,t,n){var r=t>>31;return n(e<<1^r,(t<<1|e>>>31)^r)},jspb.utils.joinZigzag64=function(e,t){return jspb.utils.fromZigzag64(e,t,jspb.utils.joinInt64)},jspb.utils.fromZigzag64=function(e,t,n){var r=-(1&e);return n((e>>>1|t<<31)^r,t>>>1^r)},jspb.utils.joinFloat32=function(e,t){t=2*(e>>31)+1;var n=e>>>23&255;return e&=8388607,255==n?e?NaN:1/0*t:0==n?t*Math.pow(2,-149)*e:t*Math.pow(2,n-150)*(e+Math.pow(2,23))},jspb.utils.joinFloat64=function(e,t){var n=2*(t>>31)+1,r=t>>>20&2047;return e=jspb.BinaryConstants.TWO_TO_32*(1048575&t)+e,2047==r?e?NaN:1/0*n:0==r?n*Math.pow(2,-1074)*e:n*Math.pow(2,r-1075)*(e+jspb.BinaryConstants.TWO_TO_52)},jspb.utils.joinHash64=function(e,t){return String.fromCharCode(e>>>0&255,e>>>8&255,e>>>16&255,e>>>24&255,t>>>0&255,t>>>8&255,t>>>16&255,t>>>24&255)},jspb.utils.DIGITS="0123456789abcdef".split(""),jspb.utils.ZERO_CHAR_CODE_=48,jspb.utils.A_CHAR_CODE_=97,jspb.utils.joinUnsignedDecimalString=function(e,t){function n(e,t){return e=e?String(e):"",t?"0000000".slice(e.length)+e:e}if(2097151>=t)return""+jspb.utils.joinUint64(e,t);var r=(e>>>24|t<<8)>>>0&16777215;return e=(16777215&e)+6777216*r+6710656*(t=t>>16&65535),r+=8147497*t,t*=2,1e7<=e&&(r+=Math.floor(e/1e7),e%=1e7),1e7<=r&&(t+=Math.floor(r/1e7),r%=1e7),n(t,0)+n(r,t)+n(e,1)},jspb.utils.joinSignedDecimalString=function(e,t){var n=2147483648&t;return n&&(t=~t+(0==(e=1+~e>>>0)?1:0)>>>0),e=jspb.utils.joinUnsignedDecimalString(e,t),n?"-"+e:e},jspb.utils.hash64ToDecimalString=function(e,t){jspb.utils.splitHash64(e),e=jspb.utils.split64Low;var n=jspb.utils.split64High;return t?jspb.utils.joinSignedDecimalString(e,n):jspb.utils.joinUnsignedDecimalString(e,n)},jspb.utils.hash64ArrayToDecimalStrings=function(e,t){for(var n=Array(e.length),r=0;r<e.length;r++)n[r]=jspb.utils.hash64ToDecimalString(e[r],t);return n},jspb.utils.decimalStringToHash64=function(e){function t(e,t){for(var n=0;8>n&&(1!==e||0<t);n++)t=e*r[n]+t,r[n]=255&t,t>>>=8}jspb.asserts.assert(0<e.length);var n=!1;"-"===e[0]&&(n=!0,e=e.slice(1));for(var r=[0,0,0,0,0,0,0,0],i=0;i<e.length;i++)t(10,e.charCodeAt(i)-jspb.utils.ZERO_CHAR_CODE_);return n&&(function(){for(var e=0;8>e;e++)r[e]=255&~r[e]}(),t(1,1)),goog.crypt.byteArrayToString(r)},jspb.utils.splitDecimalString=function(e){jspb.utils.splitHash64(jspb.utils.decimalStringToHash64(e))},jspb.utils.toHexDigit_=function(e){return String.fromCharCode(10>e?jspb.utils.ZERO_CHAR_CODE_+e:jspb.utils.A_CHAR_CODE_-10+e)},jspb.utils.fromHexCharCode_=function(e){return e>=jspb.utils.A_CHAR_CODE_?e-jspb.utils.A_CHAR_CODE_+10:e-jspb.utils.ZERO_CHAR_CODE_},jspb.utils.hash64ToHexString=function(e){var t=Array(18);t[0]="0",t[1]="x";for(var n=0;8>n;n++){var r=e.charCodeAt(7-n);t[2*n+2]=jspb.utils.toHexDigit_(r>>4),t[2*n+3]=jspb.utils.toHexDigit_(15&r)}return t.join("")},jspb.utils.hexStringToHash64=function(e){e=e.toLowerCase(),jspb.asserts.assert(18==e.length),jspb.asserts.assert("0"==e[0]),jspb.asserts.assert("x"==e[1]);for(var t="",n=0;8>n;n++){var r=jspb.utils.fromHexCharCode_(e.charCodeAt(2*n+2)),i=jspb.utils.fromHexCharCode_(e.charCodeAt(2*n+3));t=String.fromCharCode(16*r+i)+t}return t},jspb.utils.hash64ToNumber=function(e,t){jspb.utils.splitHash64(e),e=jspb.utils.split64Low;var n=jspb.utils.split64High;return t?jspb.utils.joinInt64(e,n):jspb.utils.joinUint64(e,n)},jspb.utils.numberToHash64=function(e){return jspb.utils.splitInt64(e),jspb.utils.joinHash64(jspb.utils.split64Low,jspb.utils.split64High)},jspb.utils.countVarints=function(e,t,n){for(var r=0,i=t;i<n;i++)r+=e[i]>>7;return n-t-r},jspb.utils.countVarintFields=function(e,t,n,r){var i=0;if(128>(r=8*r+jspb.BinaryConstants.WireType.VARINT))for(;t<n&&e[t++]==r;)for(i++;;){var o=e[t++];if(0==(128&o))break}else for(;t<n;){for(o=r;128<o;){if(e[t]!=(127&o|128))return i;t++,o>>=7}if(e[t++]!=o)break;for(i++;0!=(128&(o=e[t++])););}return i},jspb.utils.countFixedFields_=function(e,t,n,r,i){var o=0;if(128>r)for(;t<n&&e[t++]==r;)o++,t+=i;else for(;t<n;){for(var a=r;128<a;){if(e[t++]!=(127&a|128))return o;a>>=7}if(e[t++]!=a)break;o++,t+=i}return o},jspb.utils.countFixed32Fields=function(e,t,n,r){return jspb.utils.countFixedFields_(e,t,n,8*r+jspb.BinaryConstants.WireType.FIXED32,4)},jspb.utils.countFixed64Fields=function(e,t,n,r){return jspb.utils.countFixedFields_(e,t,n,8*r+jspb.BinaryConstants.WireType.FIXED64,8)},jspb.utils.countDelimitedFields=function(e,t,n,r){var i=0;for(r=8*r+jspb.BinaryConstants.WireType.DELIMITED;t<n;){for(var o=r;128<o;){if(e[t++]!=(127&o|128))return i;o>>=7}if(e[t++]!=o)break;i++;for(var a=0,s=1;a+=(127&(o=e[t++]))*s,s*=128,0!=(128&o););t+=a}return i},jspb.utils.debugBytesToTextFormat=function(e){var t='"';if(e){e=jspb.utils.byteSourceToUint8Array(e);for(var n=0;n<e.length;n++)t+="\\x",16>e[n]&&(t+="0"),t+=e[n].toString(16)}return t+'"'},jspb.utils.debugScalarToTextFormat=function(e){return"string"==typeof e?goog.string.quote(e):e.toString()},jspb.utils.stringToByteArray=function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++){var r=e.charCodeAt(n);if(255<r)throw Error("Conversion error: string contains codepoint outside of byte range");t[n]=r}return t},jspb.utils.byteSourceToUint8Array=function(e){return e.constructor===Uint8Array?e:e.constructor===ArrayBuffer||e.constructor===Array?new Uint8Array(e):e.constructor===String?goog.crypt.base64.decodeStringToUint8Array(e):e instanceof Uint8Array?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):(jspb.asserts.fail("Type not convertible to Uint8Array."),new Uint8Array(0))},jspb.BinaryDecoder=function(e,t,n){this.bytes_=null,this.cursor_=this.end_=this.start_=0,this.error_=!1,e&&this.setBlock(e,t,n)},jspb.BinaryDecoder.instanceCache_=[],jspb.BinaryDecoder.alloc=function(e,t,n){if(jspb.BinaryDecoder.instanceCache_.length){var r=jspb.BinaryDecoder.instanceCache_.pop();return e&&r.setBlock(e,t,n),r}return new jspb.BinaryDecoder(e,t,n)},jspb.BinaryDecoder.prototype.free=function(){this.clear(),100>jspb.BinaryDecoder.instanceCache_.length&&jspb.BinaryDecoder.instanceCache_.push(this)},jspb.BinaryDecoder.prototype.clone=function(){return jspb.BinaryDecoder.alloc(this.bytes_,this.start_,this.end_-this.start_)},jspb.BinaryDecoder.prototype.clear=function(){this.bytes_=null,this.cursor_=this.end_=this.start_=0,this.error_=!1},jspb.BinaryDecoder.prototype.getBuffer=function(){return this.bytes_},jspb.BinaryDecoder.prototype.setBlock=function(e,t,n){this.bytes_=jspb.utils.byteSourceToUint8Array(e),this.start_=void 0!==t?t:0,this.end_=void 0!==n?this.start_+n:this.bytes_.length,this.cursor_=this.start_},jspb.BinaryDecoder.prototype.getEnd=function(){return this.end_},jspb.BinaryDecoder.prototype.setEnd=function(e){this.end_=e},jspb.BinaryDecoder.prototype.reset=function(){this.cursor_=this.start_},jspb.BinaryDecoder.prototype.getCursor=function(){return this.cursor_},jspb.BinaryDecoder.prototype.setCursor=function(e){this.cursor_=e},jspb.BinaryDecoder.prototype.advance=function(e){this.cursor_+=e,jspb.asserts.assert(this.cursor_<=this.end_)},jspb.BinaryDecoder.prototype.atEnd=function(){return this.cursor_==this.end_},jspb.BinaryDecoder.prototype.pastEnd=function(){return this.cursor_>this.end_},jspb.BinaryDecoder.prototype.getError=function(){return this.error_||0>this.cursor_||this.cursor_>this.end_},jspb.BinaryDecoder.prototype.readSplitVarint64=function(e){for(var t=128,n=0,r=0,i=0;4>i&&128<=t;i++)n|=(127&(t=this.bytes_[this.cursor_++]))<<7*i;if(128<=t&&(n|=(127&(t=this.bytes_[this.cursor_++]))<<28,r|=(127&t)>>4),128<=t)for(i=0;5>i&&128<=t;i++)r|=(127&(t=this.bytes_[this.cursor_++]))<<7*i+3;if(128>t)return e(n>>>0,r>>>0);jspb.asserts.fail("Failed to read varint, encoding is invalid."),this.error_=!0},jspb.BinaryDecoder.prototype.readSplitZigzagVarint64=function(e){return this.readSplitVarint64((function(t,n){return jspb.utils.fromZigzag64(t,n,e)}))},jspb.BinaryDecoder.prototype.readSplitFixed64=function(e){var t=this.bytes_,n=this.cursor_;this.cursor_+=8;for(var r=0,i=0,o=n+7;o>=n;o--)r=r<<8|t[o],i=i<<8|t[o+4];return e(r,i)},jspb.BinaryDecoder.prototype.skipVarint=function(){for(;128&this.bytes_[this.cursor_];)this.cursor_++;this.cursor_++},jspb.BinaryDecoder.prototype.unskipVarint=function(e){for(;128<e;)this.cursor_--,e>>>=7;this.cursor_--},jspb.BinaryDecoder.prototype.readUnsignedVarint32=function(){var e=this.bytes_,t=e[this.cursor_+0],n=127&t;return 128>t?(this.cursor_+=1,jspb.asserts.assert(this.cursor_<=this.end_),n):(n|=(127&(t=e[this.cursor_+1]))<<7,128>t?(this.cursor_+=2,jspb.asserts.assert(this.cursor_<=this.end_),n):(n|=(127&(t=e[this.cursor_+2]))<<14,128>t?(this.cursor_+=3,jspb.asserts.assert(this.cursor_<=this.end_),n):(n|=(127&(t=e[this.cursor_+3]))<<21,128>t?(this.cursor_+=4,jspb.asserts.assert(this.cursor_<=this.end_),n):(n|=(15&(t=e[this.cursor_+4]))<<28,128>t?(this.cursor_+=5,jspb.asserts.assert(this.cursor_<=this.end_),n>>>0):(this.cursor_+=5,128<=e[this.cursor_++]&&128<=e[this.cursor_++]&&128<=e[this.cursor_++]&&128<=e[this.cursor_++]&&128<=e[this.cursor_++]&&jspb.asserts.assert(!1),jspb.asserts.assert(this.cursor_<=this.end_),n)))))},jspb.BinaryDecoder.prototype.readSignedVarint32=function(){return~~this.readUnsignedVarint32()},jspb.BinaryDecoder.prototype.readUnsignedVarint32String=function(){return this.readUnsignedVarint32().toString()},jspb.BinaryDecoder.prototype.readSignedVarint32String=function(){return this.readSignedVarint32().toString()},jspb.BinaryDecoder.prototype.readZigzagVarint32=function(){var e=this.readUnsignedVarint32();return e>>>1^-(1&e)},jspb.BinaryDecoder.prototype.readUnsignedVarint64=function(){return this.readSplitVarint64(jspb.utils.joinUint64)},jspb.BinaryDecoder.prototype.readUnsignedVarint64String=function(){return this.readSplitVarint64(jspb.utils.joinUnsignedDecimalString)},jspb.BinaryDecoder.prototype.readSignedVarint64=function(){return this.readSplitVarint64(jspb.utils.joinInt64)},jspb.BinaryDecoder.prototype.readSignedVarint64String=function(){return this.readSplitVarint64(jspb.utils.joinSignedDecimalString)},jspb.BinaryDecoder.prototype.readZigzagVarint64=function(){return this.readSplitVarint64(jspb.utils.joinZigzag64)},jspb.BinaryDecoder.prototype.readZigzagVarintHash64=function(){return this.readSplitZigzagVarint64(jspb.utils.joinHash64)},jspb.BinaryDecoder.prototype.readZigzagVarint64String=function(){return this.readSplitZigzagVarint64(jspb.utils.joinSignedDecimalString)},jspb.BinaryDecoder.prototype.readUint8=function(){var e=this.bytes_[this.cursor_+0];return this.cursor_+=1,jspb.asserts.assert(this.cursor_<=this.end_),e},jspb.BinaryDecoder.prototype.readUint16=function(){var e=this.bytes_[this.cursor_+0],t=this.bytes_[this.cursor_+1];return this.cursor_+=2,jspb.asserts.assert(this.cursor_<=this.end_),e<<0|t<<8},jspb.BinaryDecoder.prototype.readUint32=function(){var e=this.bytes_[this.cursor_+0],t=this.bytes_[this.cursor_+1],n=this.bytes_[this.cursor_+2],r=this.bytes_[this.cursor_+3];return this.cursor_+=4,jspb.asserts.assert(this.cursor_<=this.end_),(e<<0|t<<8|n<<16|r<<24)>>>0},jspb.BinaryDecoder.prototype.readUint64=function(){var e=this.readUint32(),t=this.readUint32();return jspb.utils.joinUint64(e,t)},jspb.BinaryDecoder.prototype.readUint64String=function(){var e=this.readUint32(),t=this.readUint32();return jspb.utils.joinUnsignedDecimalString(e,t)},jspb.BinaryDecoder.prototype.readInt8=function(){var e=this.bytes_[this.cursor_+0];return this.cursor_+=1,jspb.asserts.assert(this.cursor_<=this.end_),e<<24>>24},jspb.BinaryDecoder.prototype.readInt16=function(){var e=this.bytes_[this.cursor_+0],t=this.bytes_[this.cursor_+1];return this.cursor_+=2,jspb.asserts.assert(this.cursor_<=this.end_),(e<<0|t<<8)<<16>>16},jspb.BinaryDecoder.prototype.readInt32=function(){var e=this.bytes_[this.cursor_+0],t=this.bytes_[this.cursor_+1],n=this.bytes_[this.cursor_+2],r=this.bytes_[this.cursor_+3];return this.cursor_+=4,jspb.asserts.assert(this.cursor_<=this.end_),e<<0|t<<8|n<<16|r<<24},jspb.BinaryDecoder.prototype.readInt64=function(){var e=this.readUint32(),t=this.readUint32();return jspb.utils.joinInt64(e,t)},jspb.BinaryDecoder.prototype.readInt64String=function(){var e=this.readUint32(),t=this.readUint32();return jspb.utils.joinSignedDecimalString(e,t)},jspb.BinaryDecoder.prototype.readFloat=function(){var e=this.readUint32();return jspb.utils.joinFloat32(e,0)},jspb.BinaryDecoder.prototype.readDouble=function(){var e=this.readUint32(),t=this.readUint32();return jspb.utils.joinFloat64(e,t)},jspb.BinaryDecoder.prototype.readBool=function(){return!!this.bytes_[this.cursor_++]},jspb.BinaryDecoder.prototype.readEnum=function(){return this.readSignedVarint32()},jspb.BinaryDecoder.prototype.readString=function(e){var t=this.bytes_,n=this.cursor_;e=n+e;for(var r=[],i="";n<e;){var o=t[n++];if(128>o)r.push(o);else{if(192>o)continue;if(224>o){var a=t[n++];r.push((31&o)<<6|63&a)}else if(240>o){a=t[n++];var s=t[n++];r.push((15&o)<<12|(63&a)<<6|63&s)}else 248>o&&(o=(7&o)<<18|(63&(a=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++],o-=65536,r.push(55296+(o>>10&1023),56320+(1023&o)))}8192<=r.length&&(i+=String.fromCharCode.apply(null,r),r.length=0)}return i+=goog.crypt.byteArrayToString(r),this.cursor_=n,i},jspb.BinaryDecoder.prototype.readStringWithLength=function(){var e=this.readUnsignedVarint32();return this.readString(e)},jspb.BinaryDecoder.prototype.readBytes=function(e){if(0>e||this.cursor_+e>this.bytes_.length)return this.error_=!0,jspb.asserts.fail("Invalid byte length!"),new Uint8Array(0);var t=this.bytes_.subarray(this.cursor_,this.cursor_+e);return this.cursor_+=e,jspb.asserts.assert(this.cursor_<=this.end_),t},jspb.BinaryDecoder.prototype.readVarintHash64=function(){return this.readSplitVarint64(jspb.utils.joinHash64)},jspb.BinaryDecoder.prototype.readFixedHash64=function(){var e=this.bytes_,t=this.cursor_,n=e[t+0],r=e[t+1],i=e[t+2],o=e[t+3],a=e[t+4],s=e[t+5],u=e[t+6];return e=e[t+7],this.cursor_+=8,String.fromCharCode(n,r,i,o,a,s,u,e)},jspb.BinaryReader=function(e,t,n){this.decoder_=jspb.BinaryDecoder.alloc(e,t,n),this.fieldCursor_=this.decoder_.getCursor(),this.nextField_=jspb.BinaryConstants.INVALID_FIELD_NUMBER,this.nextWireType_=jspb.BinaryConstants.WireType.INVALID,this.error_=!1,this.readCallbacks_=null},jspb.BinaryReader.instanceCache_=[],jspb.BinaryReader.alloc=function(e,t,n){if(jspb.BinaryReader.instanceCache_.length){var r=jspb.BinaryReader.instanceCache_.pop();return e&&r.decoder_.setBlock(e,t,n),r}return new jspb.BinaryReader(e,t,n)},jspb.BinaryReader.prototype.alloc=jspb.BinaryReader.alloc,jspb.BinaryReader.prototype.free=function(){this.decoder_.clear(),this.nextField_=jspb.BinaryConstants.INVALID_FIELD_NUMBER,this.nextWireType_=jspb.BinaryConstants.WireType.INVALID,this.error_=!1,this.readCallbacks_=null,100>jspb.BinaryReader.instanceCache_.length&&jspb.BinaryReader.instanceCache_.push(this)},jspb.BinaryReader.prototype.getFieldCursor=function(){return this.fieldCursor_},jspb.BinaryReader.prototype.getCursor=function(){return this.decoder_.getCursor()},jspb.BinaryReader.prototype.getBuffer=function(){return this.decoder_.getBuffer()},jspb.BinaryReader.prototype.getFieldNumber=function(){return this.nextField_},goog.exportProperty(jspb.BinaryReader.prototype,"getFieldNumber",jspb.BinaryReader.prototype.getFieldNumber),jspb.BinaryReader.prototype.getWireType=function(){return this.nextWireType_},jspb.BinaryReader.prototype.isDelimited=function(){return this.nextWireType_==jspb.BinaryConstants.WireType.DELIMITED},goog.exportProperty(jspb.BinaryReader.prototype,"isDelimited",jspb.BinaryReader.prototype.isDelimited),jspb.BinaryReader.prototype.isEndGroup=function(){return this.nextWireType_==jspb.BinaryConstants.WireType.END_GROUP},goog.exportProperty(jspb.BinaryReader.prototype,"isEndGroup",jspb.BinaryReader.prototype.isEndGroup),jspb.BinaryReader.prototype.getError=function(){return this.error_||this.decoder_.getError()},jspb.BinaryReader.prototype.setBlock=function(e,t,n){this.decoder_.setBlock(e,t,n),this.nextField_=jspb.BinaryConstants.INVALID_FIELD_NUMBER,this.nextWireType_=jspb.BinaryConstants.WireType.INVALID},jspb.BinaryReader.prototype.reset=function(){this.decoder_.reset(),this.nextField_=jspb.BinaryConstants.INVALID_FIELD_NUMBER,this.nextWireType_=jspb.BinaryConstants.WireType.INVALID},jspb.BinaryReader.prototype.advance=function(e){this.decoder_.advance(e)},jspb.BinaryReader.prototype.nextField=function(){if(this.decoder_.atEnd())return!1;if(this.getError())return jspb.asserts.fail("Decoder hit an error"),!1;this.fieldCursor_=this.decoder_.getCursor();var e=this.decoder_.readUnsignedVarint32(),t=e>>>3;return(e&=7)!=jspb.BinaryConstants.WireType.VARINT&&e!=jspb.BinaryConstants.WireType.FIXED32&&e!=jspb.BinaryConstants.WireType.FIXED64&&e!=jspb.BinaryConstants.WireType.DELIMITED&&e!=jspb.BinaryConstants.WireType.START_GROUP&&e!=jspb.BinaryConstants.WireType.END_GROUP?(jspb.asserts.fail("Invalid wire type: %s (at position %s)",e,this.fieldCursor_),this.error_=!0,!1):(this.nextField_=t,this.nextWireType_=e,!0)},goog.exportProperty(jspb.BinaryReader.prototype,"nextField",jspb.BinaryReader.prototype.nextField),jspb.BinaryReader.prototype.unskipHeader=function(){this.decoder_.unskipVarint(this.nextField_<<3|this.nextWireType_)},jspb.BinaryReader.prototype.skipMatchingFields=function(){var e=this.nextField_;for(this.unskipHeader();this.nextField()&&this.getFieldNumber()==e;)this.skipField();this.decoder_.atEnd()||this.unskipHeader()},jspb.BinaryReader.prototype.skipVarintField=function(){this.nextWireType_!=jspb.BinaryConstants.WireType.VARINT?(jspb.asserts.fail("Invalid wire type for skipVarintField"),this.skipField()):this.decoder_.skipVarint()},jspb.BinaryReader.prototype.skipDelimitedField=function(){if(this.nextWireType_!=jspb.BinaryConstants.WireType.DELIMITED)jspb.asserts.fail("Invalid wire type for skipDelimitedField"),this.skipField();else{var e=this.decoder_.readUnsignedVarint32();this.decoder_.advance(e)}},jspb.BinaryReader.prototype.skipFixed32Field=function(){this.nextWireType_!=jspb.BinaryConstants.WireType.FIXED32?(jspb.asserts.fail("Invalid wire type for skipFixed32Field"),this.skipField()):this.decoder_.advance(4)},jspb.BinaryReader.prototype.skipFixed64Field=function(){this.nextWireType_!=jspb.BinaryConstants.WireType.FIXED64?(jspb.asserts.fail("Invalid wire type for skipFixed64Field"),this.skipField()):this.decoder_.advance(8)},jspb.BinaryReader.prototype.skipGroup=function(){for(var e=this.nextField_;;){if(!this.nextField()){jspb.asserts.fail("Unmatched start-group tag: stream EOF"),this.error_=!0;break}if(this.nextWireType_==jspb.BinaryConstants.WireType.END_GROUP){this.nextField_!=e&&(jspb.asserts.fail("Unmatched end-group tag"),this.error_=!0);break}this.skipField()}},jspb.BinaryReader.prototype.skipField=function(){switch(this.nextWireType_){case jspb.BinaryConstants.WireType.VARINT:this.skipVarintField();break;case jspb.BinaryConstants.WireType.FIXED64:this.skipFixed64Field();break;case jspb.BinaryConstants.WireType.DELIMITED:this.skipDelimitedField();break;case jspb.BinaryConstants.WireType.FIXED32:this.skipFixed32Field();break;case jspb.BinaryConstants.WireType.START_GROUP:this.skipGroup();break;default:jspb.asserts.fail("Invalid wire encoding for field.")}},jspb.BinaryReader.prototype.registerReadCallback=function(e,t){null===this.readCallbacks_&&(this.readCallbacks_={}),jspb.asserts.assert(!this.readCallbacks_[e]),this.readCallbacks_[e]=t},jspb.BinaryReader.prototype.runReadCallback=function(e){return jspb.asserts.assert(null!==this.readCallbacks_),e=this.readCallbacks_[e],jspb.asserts.assert(e),e(this)},jspb.BinaryReader.prototype.readAny=function(e){this.nextWireType_=jspb.BinaryConstants.FieldTypeToWireType(e);var t=jspb.BinaryConstants.FieldType;switch(e){case t.DOUBLE:return this.readDouble();case t.FLOAT:return this.readFloat();case t.INT64:return this.readInt64();case t.UINT64:return this.readUint64();case t.INT32:return this.readInt32();case t.FIXED64:return this.readFixed64();case t.FIXED32:return this.readFixed32();case t.BOOL:return this.readBool();case t.STRING:return this.readString();case t.GROUP:jspb.asserts.fail("Group field type not supported in readAny()");case t.MESSAGE:jspb.asserts.fail("Message field type not supported in readAny()");case t.BYTES:return this.readBytes();case t.UINT32:return this.readUint32();case t.ENUM:return this.readEnum();case t.SFIXED32:return this.readSfixed32();case t.SFIXED64:return this.readSfixed64();case t.SINT32:return this.readSint32();case t.SINT64:return this.readSint64();case t.FHASH64:return this.readFixedHash64();case t.VHASH64:return this.readVarintHash64();default:jspb.asserts.fail("Invalid field type in readAny()")}return 0},jspb.BinaryReader.prototype.readMessage=function(e,t){jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.DELIMITED);var n=this.decoder_.getEnd(),r=this.decoder_.readUnsignedVarint32();r=this.decoder_.getCursor()+r,this.decoder_.setEnd(r),t(e,this),this.decoder_.setCursor(r),this.decoder_.setEnd(n)},goog.exportProperty(jspb.BinaryReader.prototype,"readMessage",jspb.BinaryReader.prototype.readMessage),jspb.BinaryReader.prototype.readGroup=function(e,t,n){jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.START_GROUP),jspb.asserts.assert(this.nextField_==e),n(t,this),this.error_||this.nextWireType_==jspb.BinaryConstants.WireType.END_GROUP||(jspb.asserts.fail("Group submessage did not end with an END_GROUP tag"),this.error_=!0)},goog.exportProperty(jspb.BinaryReader.prototype,"readGroup",jspb.BinaryReader.prototype.readGroup),jspb.BinaryReader.prototype.getFieldDecoder=function(){jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.DELIMITED);var e=this.decoder_.readUnsignedVarint32(),t=this.decoder_.getCursor(),n=t+e;return e=jspb.BinaryDecoder.alloc(this.decoder_.getBuffer(),t,e),this.decoder_.setCursor(n),e},jspb.BinaryReader.prototype.readInt32=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readSignedVarint32()},goog.exportProperty(jspb.BinaryReader.prototype,"readInt32",jspb.BinaryReader.prototype.readInt32),jspb.BinaryReader.prototype.readInt32String=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readSignedVarint32String()},jspb.BinaryReader.prototype.readInt64=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readSignedVarint64()},goog.exportProperty(jspb.BinaryReader.prototype,"readInt64",jspb.BinaryReader.prototype.readInt64),jspb.BinaryReader.prototype.readInt64String=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readSignedVarint64String()},jspb.BinaryReader.prototype.readUint32=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readUnsignedVarint32()},goog.exportProperty(jspb.BinaryReader.prototype,"readUint32",jspb.BinaryReader.prototype.readUint32),jspb.BinaryReader.prototype.readUint32String=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readUnsignedVarint32String()},jspb.BinaryReader.prototype.readUint64=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readUnsignedVarint64()},goog.exportProperty(jspb.BinaryReader.prototype,"readUint64",jspb.BinaryReader.prototype.readUint64),jspb.BinaryReader.prototype.readUint64String=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readUnsignedVarint64String()},jspb.BinaryReader.prototype.readSint32=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readZigzagVarint32()},goog.exportProperty(jspb.BinaryReader.prototype,"readSint32",jspb.BinaryReader.prototype.readSint32),jspb.BinaryReader.prototype.readSint64=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readZigzagVarint64()},goog.exportProperty(jspb.BinaryReader.prototype,"readSint64",jspb.BinaryReader.prototype.readSint64),jspb.BinaryReader.prototype.readSint64String=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readZigzagVarint64String()},jspb.BinaryReader.prototype.readFixed32=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED32),this.decoder_.readUint32()},goog.exportProperty(jspb.BinaryReader.prototype,"readFixed32",jspb.BinaryReader.prototype.readFixed32),jspb.BinaryReader.prototype.readFixed64=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED64),this.decoder_.readUint64()},goog.exportProperty(jspb.BinaryReader.prototype,"readFixed64",jspb.BinaryReader.prototype.readFixed64),jspb.BinaryReader.prototype.readFixed64String=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED64),this.decoder_.readUint64String()},jspb.BinaryReader.prototype.readSfixed32=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED32),this.decoder_.readInt32()},goog.exportProperty(jspb.BinaryReader.prototype,"readSfixed32",jspb.BinaryReader.prototype.readSfixed32),jspb.BinaryReader.prototype.readSfixed32String=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED32),this.decoder_.readInt32().toString()},jspb.BinaryReader.prototype.readSfixed64=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED64),this.decoder_.readInt64()},goog.exportProperty(jspb.BinaryReader.prototype,"readSfixed64",jspb.BinaryReader.prototype.readSfixed64),jspb.BinaryReader.prototype.readSfixed64String=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED64),this.decoder_.readInt64String()},jspb.BinaryReader.prototype.readFloat=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED32),this.decoder_.readFloat()},goog.exportProperty(jspb.BinaryReader.prototype,"readFloat",jspb.BinaryReader.prototype.readFloat),jspb.BinaryReader.prototype.readDouble=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED64),this.decoder_.readDouble()},goog.exportProperty(jspb.BinaryReader.prototype,"readDouble",jspb.BinaryReader.prototype.readDouble),jspb.BinaryReader.prototype.readBool=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),!!this.decoder_.readUnsignedVarint32()},goog.exportProperty(jspb.BinaryReader.prototype,"readBool",jspb.BinaryReader.prototype.readBool),jspb.BinaryReader.prototype.readEnum=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readSignedVarint64()},goog.exportProperty(jspb.BinaryReader.prototype,"readEnum",jspb.BinaryReader.prototype.readEnum),jspb.BinaryReader.prototype.readString=function(){jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.DELIMITED);var e=this.decoder_.readUnsignedVarint32();return this.decoder_.readString(e)},goog.exportProperty(jspb.BinaryReader.prototype,"readString",jspb.BinaryReader.prototype.readString),jspb.BinaryReader.prototype.readBytes=function(){jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.DELIMITED);var e=this.decoder_.readUnsignedVarint32();return this.decoder_.readBytes(e)},goog.exportProperty(jspb.BinaryReader.prototype,"readBytes",jspb.BinaryReader.prototype.readBytes),jspb.BinaryReader.prototype.readVarintHash64=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readVarintHash64()},jspb.BinaryReader.prototype.readSintHash64=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readZigzagVarintHash64()},jspb.BinaryReader.prototype.readSplitVarint64=function(e){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readSplitVarint64(e)},jspb.BinaryReader.prototype.readSplitZigzagVarint64=function(e){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readSplitVarint64((function(t,n){return jspb.utils.fromZigzag64(t,n,e)}))},jspb.BinaryReader.prototype.readFixedHash64=function(){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED64),this.decoder_.readFixedHash64()},jspb.BinaryReader.prototype.readSplitFixed64=function(e){return jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED64),this.decoder_.readSplitFixed64(e)},jspb.BinaryReader.prototype.readPackedField_=function(e){jspb.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.DELIMITED);var t=this.decoder_.readUnsignedVarint32();t=this.decoder_.getCursor()+t;for(var n=[];this.decoder_.getCursor()<t;)n.push(e.call(this.decoder_));return n},jspb.BinaryReader.prototype.readPackedInt32=function(){return this.readPackedField_(this.decoder_.readSignedVarint32)},goog.exportProperty(jspb.BinaryReader.prototype,"readPackedInt32",jspb.BinaryReader.prototype.readPackedInt32),jspb.BinaryReader.prototype.readPackedInt32String=function(){return this.readPackedField_(this.decoder_.readSignedVarint32String)},jspb.BinaryReader.prototype.readPackedInt64=function(){return this.readPackedField_(this.decoder_.readSignedVarint64)},goog.exportProperty(jspb.BinaryReader.prototype,"readPackedInt64",jspb.BinaryReader.prototype.readPackedInt64),jspb.BinaryReader.prototype.readPackedInt64String=function(){return this.readPackedField_(this.decoder_.readSignedVarint64String)},jspb.BinaryReader.prototype.readPackedUint32=function(){return this.readPackedField_(this.decoder_.readUnsignedVarint32)},goog.exportProperty(jspb.BinaryReader.prototype,"readPackedUint32",jspb.BinaryReader.prototype.readPackedUint32),jspb.BinaryReader.prototype.readPackedUint32String=function(){return this.readPackedField_(this.decoder_.readUnsignedVarint32String)},jspb.BinaryReader.prototype.readPackedUint64=function(){return this.readPackedField_(this.decoder_.readUnsignedVarint64)},goog.exportProperty(jspb.BinaryReader.prototype,"readPackedUint64",jspb.BinaryReader.prototype.readPackedUint64),jspb.BinaryReader.prototype.readPackedUint64String=function(){return this.readPackedField_(this.decoder_.readUnsignedVarint64String)},jspb.BinaryReader.prototype.readPackedSint32=function(){return this.readPackedField_(this.decoder_.readZigzagVarint32)},goog.exportProperty(jspb.BinaryReader.prototype,"readPackedSint32",jspb.BinaryReader.prototype.readPackedSint32),jspb.BinaryReader.prototype.readPackedSint64=function(){return this.readPackedField_(this.decoder_.readZigzagVarint64)},goog.exportProperty(jspb.BinaryReader.prototype,"readPackedSint64",jspb.BinaryReader.prototype.readPackedSint64),jspb.BinaryReader.prototype.readPackedSint64String=function(){return this.readPackedField_(this.decoder_.readZigzagVarint64String)},jspb.BinaryReader.prototype.readPackedFixed32=function(){return this.readPackedField_(this.decoder_.readUint32)},goog.exportProperty(jspb.BinaryReader.prototype,"readPackedFixed32",jspb.BinaryReader.prototype.readPackedFixed32),jspb.BinaryReader.prototype.readPackedFixed64=function(){return this.readPackedField_(this.decoder_.readUint64)},goog.exportProperty(jspb.BinaryReader.prototype,"readPackedFixed64",jspb.BinaryReader.prototype.readPackedFixed64),jspb.BinaryReader.prototype.readPackedFixed64String=function(){return this.readPackedField_(this.decoder_.readUint64String)},jspb.BinaryReader.prototype.readPackedSfixed32=function(){return this.readPackedField_(this.decoder_.readInt32)},goog.exportProperty(jspb.BinaryReader.prototype,"readPackedSfixed32",jspb.BinaryReader.prototype.readPackedSfixed32),jspb.BinaryReader.prototype.readPackedSfixed64=function(){return this.readPackedField_(this.decoder_.readInt64)},goog.exportProperty(jspb.BinaryReader.prototype,"readPackedSfixed64",jspb.BinaryReader.prototype.readPackedSfixed64),jspb.BinaryReader.prototype.readPackedSfixed64String=function(){return this.readPackedField_(this.decoder_.readInt64String)},jspb.BinaryReader.prototype.readPackedFloat=function(){return this.readPackedField_(this.decoder_.readFloat)},goog.exportProperty(jspb.BinaryReader.prototype,"readPackedFloat",jspb.BinaryReader.prototype.readPackedFloat),jspb.BinaryReader.prototype.readPackedDouble=function(){return this.readPackedField_(this.decoder_.readDouble)},goog.exportProperty(jspb.BinaryReader.prototype,"readPackedDouble",jspb.BinaryReader.prototype.readPackedDouble),jspb.BinaryReader.prototype.readPackedBool=function(){return this.readPackedField_(this.decoder_.readBool)},goog.exportProperty(jspb.BinaryReader.prototype,"readPackedBool",jspb.BinaryReader.prototype.readPackedBool),jspb.BinaryReader.prototype.readPackedEnum=function(){return this.readPackedField_(this.decoder_.readEnum)},goog.exportProperty(jspb.BinaryReader.prototype,"readPackedEnum",jspb.BinaryReader.prototype.readPackedEnum),jspb.BinaryReader.prototype.readPackedVarintHash64=function(){return this.readPackedField_(this.decoder_.readVarintHash64)},jspb.BinaryReader.prototype.readPackedFixedHash64=function(){return this.readPackedField_(this.decoder_.readFixedHash64)},jspb.BinaryEncoder=function(){this.buffer_=[]},jspb.BinaryEncoder.prototype.length=function(){return this.buffer_.length},jspb.BinaryEncoder.prototype.end=function(){var e=this.buffer_;return this.buffer_=[],e},jspb.BinaryEncoder.prototype.writeSplitVarint64=function(e,t){for(jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(t==Math.floor(t)),jspb.asserts.assert(0<=e&&e<jspb.BinaryConstants.TWO_TO_32),jspb.asserts.assert(0<=t&&t<jspb.BinaryConstants.TWO_TO_32);0<t||127<e;)this.buffer_.push(127&e|128),e=(e>>>7|t<<25)>>>0,t>>>=7;this.buffer_.push(e)},jspb.BinaryEncoder.prototype.writeSplitFixed64=function(e,t){jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(t==Math.floor(t)),jspb.asserts.assert(0<=e&&e<jspb.BinaryConstants.TWO_TO_32),jspb.asserts.assert(0<=t&&t<jspb.BinaryConstants.TWO_TO_32),this.writeUint32(e),this.writeUint32(t)},jspb.BinaryEncoder.prototype.writeUnsignedVarint32=function(e){for(jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(0<=e&&e<jspb.BinaryConstants.TWO_TO_32);127<e;)this.buffer_.push(127&e|128),e>>>=7;this.buffer_.push(e)},jspb.BinaryEncoder.prototype.writeSignedVarint32=function(e){if(jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(e>=-jspb.BinaryConstants.TWO_TO_31&&e<jspb.BinaryConstants.TWO_TO_31),0<=e)this.writeUnsignedVarint32(e);else{for(var t=0;9>t;t++)this.buffer_.push(127&e|128),e>>=7;this.buffer_.push(1)}},jspb.BinaryEncoder.prototype.writeUnsignedVarint64=function(e){jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(0<=e&&e<jspb.BinaryConstants.TWO_TO_64),jspb.utils.splitInt64(e),this.writeSplitVarint64(jspb.utils.split64Low,jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeSignedVarint64=function(e){jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(e>=-jspb.BinaryConstants.TWO_TO_63&&e<jspb.BinaryConstants.TWO_TO_63),jspb.utils.splitInt64(e),this.writeSplitVarint64(jspb.utils.split64Low,jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeZigzagVarint32=function(e){jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(e>=-jspb.BinaryConstants.TWO_TO_31&&e<jspb.BinaryConstants.TWO_TO_31),this.writeUnsignedVarint32((e<<1^e>>31)>>>0)},jspb.BinaryEncoder.prototype.writeZigzagVarint64=function(e){jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(e>=-jspb.BinaryConstants.TWO_TO_63&&e<jspb.BinaryConstants.TWO_TO_63),jspb.utils.splitZigzag64(e),this.writeSplitVarint64(jspb.utils.split64Low,jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeZigzagVarint64String=function(e){this.writeZigzagVarintHash64(jspb.utils.decimalStringToHash64(e))},jspb.BinaryEncoder.prototype.writeZigzagVarintHash64=function(e){var t=this;jspb.utils.splitHash64(e),jspb.utils.toZigzag64(jspb.utils.split64Low,jspb.utils.split64High,(function(e,n){t.writeSplitVarint64(e>>>0,n>>>0)}))},jspb.BinaryEncoder.prototype.writeUint8=function(e){jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(0<=e&&256>e),this.buffer_.push(e>>>0&255)},jspb.BinaryEncoder.prototype.writeUint16=function(e){jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(0<=e&&65536>e),this.buffer_.push(e>>>0&255),this.buffer_.push(e>>>8&255)},jspb.BinaryEncoder.prototype.writeUint32=function(e){jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(0<=e&&e<jspb.BinaryConstants.TWO_TO_32),this.buffer_.push(e>>>0&255),this.buffer_.push(e>>>8&255),this.buffer_.push(e>>>16&255),this.buffer_.push(e>>>24&255)},jspb.BinaryEncoder.prototype.writeUint64=function(e){jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(0<=e&&e<jspb.BinaryConstants.TWO_TO_64),jspb.utils.splitUint64(e),this.writeUint32(jspb.utils.split64Low),this.writeUint32(jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeInt8=function(e){jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(-128<=e&&128>e),this.buffer_.push(e>>>0&255)},jspb.BinaryEncoder.prototype.writeInt16=function(e){jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(-32768<=e&&32768>e),this.buffer_.push(e>>>0&255),this.buffer_.push(e>>>8&255)},jspb.BinaryEncoder.prototype.writeInt32=function(e){jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(e>=-jspb.BinaryConstants.TWO_TO_31&&e<jspb.BinaryConstants.TWO_TO_31),this.buffer_.push(e>>>0&255),this.buffer_.push(e>>>8&255),this.buffer_.push(e>>>16&255),this.buffer_.push(e>>>24&255)},jspb.BinaryEncoder.prototype.writeInt64=function(e){jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(e>=-jspb.BinaryConstants.TWO_TO_63&&e<jspb.BinaryConstants.TWO_TO_63),jspb.utils.splitInt64(e),this.writeSplitFixed64(jspb.utils.split64Low,jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeInt64String=function(e){jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(+e>=-jspb.BinaryConstants.TWO_TO_63&&+e<jspb.BinaryConstants.TWO_TO_63),jspb.utils.splitHash64(jspb.utils.decimalStringToHash64(e)),this.writeSplitFixed64(jspb.utils.split64Low,jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeFloat=function(e){jspb.asserts.assert(1/0===e||-1/0===e||isNaN(e)||e>=-jspb.BinaryConstants.FLOAT32_MAX&&e<=jspb.BinaryConstants.FLOAT32_MAX),jspb.utils.splitFloat32(e),this.writeUint32(jspb.utils.split64Low)},jspb.BinaryEncoder.prototype.writeDouble=function(e){jspb.asserts.assert(1/0===e||-1/0===e||isNaN(e)||e>=-jspb.BinaryConstants.FLOAT64_MAX&&e<=jspb.BinaryConstants.FLOAT64_MAX),jspb.utils.splitFloat64(e),this.writeUint32(jspb.utils.split64Low),this.writeUint32(jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeBool=function(e){jspb.asserts.assert("boolean"==typeof e||"number"==typeof e),this.buffer_.push(e?1:0)},jspb.BinaryEncoder.prototype.writeEnum=function(e){jspb.asserts.assert(e==Math.floor(e)),jspb.asserts.assert(e>=-jspb.BinaryConstants.TWO_TO_31&&e<jspb.BinaryConstants.TWO_TO_31),this.writeSignedVarint32(e)},jspb.BinaryEncoder.prototype.writeBytes=function(e){this.buffer_.push.apply(this.buffer_,e)},jspb.BinaryEncoder.prototype.writeVarintHash64=function(e){jspb.utils.splitHash64(e),this.writeSplitVarint64(jspb.utils.split64Low,jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeFixedHash64=function(e){jspb.utils.splitHash64(e),this.writeUint32(jspb.utils.split64Low),this.writeUint32(jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeString=function(e){var t=this.buffer_.length;jspb.asserts.assertString(e);for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(128>r)this.buffer_.push(r);else if(2048>r)this.buffer_.push(r>>6|192),this.buffer_.push(63&r|128);else if(65536>r)if(55296<=r&&56319>=r&&n+1<e.length){var i=e.charCodeAt(n+1);56320<=i&&57343>=i&&(r=1024*(r-55296)+i-56320+65536,this.buffer_.push(r>>18|240),this.buffer_.push(r>>12&63|128),this.buffer_.push(r>>6&63|128),this.buffer_.push(63&r|128),n++)}else this.buffer_.push(r>>12|224),this.buffer_.push(r>>6&63|128),this.buffer_.push(63&r|128)}return this.buffer_.length-t},jspb.arith={},jspb.arith.UInt64=function(e,t){this.lo=e,this.hi=t},jspb.arith.UInt64.prototype.cmp=function(e){return this.hi<e.hi||this.hi==e.hi&&this.lo<e.lo?-1:this.hi==e.hi&&this.lo==e.lo?0:1},jspb.arith.UInt64.prototype.rightShift=function(){return new jspb.arith.UInt64((this.lo>>>1|(1&this.hi)<<31)>>>0,this.hi>>>1>>>0)},jspb.arith.UInt64.prototype.leftShift=function(){return new jspb.arith.UInt64(this.lo<<1>>>0,(this.hi<<1|this.lo>>>31)>>>0)},jspb.arith.UInt64.prototype.msb=function(){return!!(2147483648&this.hi)},jspb.arith.UInt64.prototype.lsb=function(){return!!(1&this.lo)},jspb.arith.UInt64.prototype.zero=function(){return 0==this.lo&&0==this.hi},jspb.arith.UInt64.prototype.add=function(e){return new jspb.arith.UInt64((this.lo+e.lo&4294967295)>>>0>>>0,((this.hi+e.hi&4294967295)>>>0)+(4294967296<=this.lo+e.lo?1:0)>>>0)},jspb.arith.UInt64.prototype.sub=function(e){return new jspb.arith.UInt64((this.lo-e.lo&4294967295)>>>0>>>0,((this.hi-e.hi&4294967295)>>>0)-(0>this.lo-e.lo?1:0)>>>0)},jspb.arith.UInt64.mul32x32=function(e,t){var n=65535&e,r=65535&t,i=t>>>16;for(t=n*r+65536*(n*i&65535)+65536*((e>>>=16)*r&65535),n=e*i+(n*i>>>16)+(e*r>>>16);4294967296<=t;)t-=4294967296,n+=1;return new jspb.arith.UInt64(t>>>0,n>>>0)},jspb.arith.UInt64.prototype.mul=function(e){var t=jspb.arith.UInt64.mul32x32(this.lo,e);return(e=jspb.arith.UInt64.mul32x32(this.hi,e)).hi=e.lo,e.lo=0,t.add(e)},jspb.arith.UInt64.prototype.div=function(e){if(0==e)return[];var t=new jspb.arith.UInt64(0,0),n=new jspb.arith.UInt64(this.lo,this.hi);e=new jspb.arith.UInt64(e,0);for(var r=new jspb.arith.UInt64(1,0);!e.msb();)e=e.leftShift(),r=r.leftShift();for(;!r.zero();)0>=e.cmp(n)&&(t=t.add(r),n=n.sub(e)),e=e.rightShift(),r=r.rightShift();return[t,n]},jspb.arith.UInt64.prototype.toString=function(){for(var e="",t=this;!t.zero();){var n=(t=t.div(10))[0];e=t[1].lo+e,t=n}return""==e&&(e="0"),e},jspb.arith.UInt64.fromString=function(e){for(var t=new jspb.arith.UInt64(0,0),n=new jspb.arith.UInt64(0,0),r=0;r<e.length;r++){if("0">e[r]||"9"<e[r])return null;var i=parseInt(e[r],10);n.lo=i,t=t.mul(10).add(n)}return t},jspb.arith.UInt64.prototype.clone=function(){return new jspb.arith.UInt64(this.lo,this.hi)},jspb.arith.Int64=function(e,t){this.lo=e,this.hi=t},jspb.arith.Int64.prototype.add=function(e){return new jspb.arith.Int64((this.lo+e.lo&4294967295)>>>0>>>0,((this.hi+e.hi&4294967295)>>>0)+(4294967296<=this.lo+e.lo?1:0)>>>0)},jspb.arith.Int64.prototype.sub=function(e){return new jspb.arith.Int64((this.lo-e.lo&4294967295)>>>0>>>0,((this.hi-e.hi&4294967295)>>>0)-(0>this.lo-e.lo?1:0)>>>0)},jspb.arith.Int64.prototype.clone=function(){return new jspb.arith.Int64(this.lo,this.hi)},jspb.arith.Int64.prototype.toString=function(){var e=0!=(2147483648&this.hi),t=new jspb.arith.UInt64(this.lo,this.hi);return e&&(t=new jspb.arith.UInt64(0,0).sub(t)),(e?"-":"")+t.toString()},jspb.arith.Int64.fromString=function(e){var t=0<e.length&&"-"==e[0];return t&&(e=e.substring(1)),null===(e=jspb.arith.UInt64.fromString(e))?null:(t&&(e=new jspb.arith.UInt64(0,0).sub(e)),new jspb.arith.Int64(e.lo,e.hi))},jspb.BinaryWriter=function(){this.blocks_=[],this.totalLength_=0,this.encoder_=new jspb.BinaryEncoder,this.bookmarks_=[]},jspb.BinaryWriter.prototype.appendUint8Array_=function(e){var t=this.encoder_.end();this.blocks_.push(t),this.blocks_.push(e),this.totalLength_+=t.length+e.length},jspb.BinaryWriter.prototype.beginDelimited_=function(e){return this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.DELIMITED),e=this.encoder_.end(),this.blocks_.push(e),this.totalLength_+=e.length,e.push(this.totalLength_),e},jspb.BinaryWriter.prototype.endDelimited_=function(e){var t=e.pop();for(t=this.totalLength_+this.encoder_.length()-t,jspb.asserts.assert(0<=t);127<t;)e.push(127&t|128),t>>>=7,this.totalLength_++;e.push(t),this.totalLength_++},jspb.BinaryWriter.prototype.writeSerializedMessage=function(e,t,n){this.appendUint8Array_(e.subarray(t,n))},jspb.BinaryWriter.prototype.maybeWriteSerializedMessage=function(e,t,n){null!=e&&null!=t&&null!=n&&this.writeSerializedMessage(e,t,n)},jspb.BinaryWriter.prototype.reset=function(){this.blocks_=[],this.encoder_.end(),this.totalLength_=0,this.bookmarks_=[]},jspb.BinaryWriter.prototype.getResultBuffer=function(){jspb.asserts.assert(0==this.bookmarks_.length);for(var e=new Uint8Array(this.totalLength_+this.encoder_.length()),t=this.blocks_,n=t.length,r=0,i=0;i<n;i++){var o=t[i];e.set(o,r),r+=o.length}return t=this.encoder_.end(),e.set(t,r),r+=t.length,jspb.asserts.assert(r==e.length),this.blocks_=[e],e},goog.exportProperty(jspb.BinaryWriter.prototype,"getResultBuffer",jspb.BinaryWriter.prototype.getResultBuffer),jspb.BinaryWriter.prototype.getResultBase64String=function(e){return goog.crypt.base64.encodeByteArray(this.getResultBuffer(),e)},jspb.BinaryWriter.prototype.beginSubMessage=function(e){this.bookmarks_.push(this.beginDelimited_(e))},jspb.BinaryWriter.prototype.endSubMessage=function(){jspb.asserts.assert(0<=this.bookmarks_.length),this.endDelimited_(this.bookmarks_.pop())},jspb.BinaryWriter.prototype.writeFieldHeader_=function(e,t){jspb.asserts.assert(1<=e&&e==Math.floor(e)),this.encoder_.writeUnsignedVarint32(8*e+t)},jspb.BinaryWriter.prototype.writeAny=function(e,t,n){var r=jspb.BinaryConstants.FieldType;switch(e){case r.DOUBLE:this.writeDouble(t,n);break;case r.FLOAT:this.writeFloat(t,n);break;case r.INT64:this.writeInt64(t,n);break;case r.UINT64:this.writeUint64(t,n);break;case r.INT32:this.writeInt32(t,n);break;case r.FIXED64:this.writeFixed64(t,n);break;case r.FIXED32:this.writeFixed32(t,n);break;case r.BOOL:this.writeBool(t,n);break;case r.STRING:this.writeString(t,n);break;case r.GROUP:jspb.asserts.fail("Group field type not supported in writeAny()");break;case r.MESSAGE:jspb.asserts.fail("Message field type not supported in writeAny()");break;case r.BYTES:this.writeBytes(t,n);break;case r.UINT32:this.writeUint32(t,n);break;case r.ENUM:this.writeEnum(t,n);break;case r.SFIXED32:this.writeSfixed32(t,n);break;case r.SFIXED64:this.writeSfixed64(t,n);break;case r.SINT32:this.writeSint32(t,n);break;case r.SINT64:this.writeSint64(t,n);break;case r.FHASH64:this.writeFixedHash64(t,n);break;case r.VHASH64:this.writeVarintHash64(t,n);break;default:jspb.asserts.fail("Invalid field type in writeAny()")}},jspb.BinaryWriter.prototype.writeUnsignedVarint32_=function(e,t){null!=t&&(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeUnsignedVarint32(t))},jspb.BinaryWriter.prototype.writeSignedVarint32_=function(e,t){null!=t&&(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeSignedVarint32(t))},jspb.BinaryWriter.prototype.writeUnsignedVarint64_=function(e,t){null!=t&&(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeUnsignedVarint64(t))},jspb.BinaryWriter.prototype.writeSignedVarint64_=function(e,t){null!=t&&(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeSignedVarint64(t))},jspb.BinaryWriter.prototype.writeZigzagVarint32_=function(e,t){null!=t&&(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeZigzagVarint32(t))},jspb.BinaryWriter.prototype.writeZigzagVarint64_=function(e,t){null!=t&&(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeZigzagVarint64(t))},jspb.BinaryWriter.prototype.writeZigzagVarint64String_=function(e,t){null!=t&&(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeZigzagVarint64String(t))},jspb.BinaryWriter.prototype.writeZigzagVarintHash64_=function(e,t){null!=t&&(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeZigzagVarintHash64(t))},jspb.BinaryWriter.prototype.writeInt32=function(e,t){null!=t&&(jspb.asserts.assert(t>=-jspb.BinaryConstants.TWO_TO_31&&t<jspb.BinaryConstants.TWO_TO_31),this.writeSignedVarint32_(e,t))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeInt32",jspb.BinaryWriter.prototype.writeInt32),jspb.BinaryWriter.prototype.writeInt32String=function(e,t){null!=t&&(t=parseInt(t,10),jspb.asserts.assert(t>=-jspb.BinaryConstants.TWO_TO_31&&t<jspb.BinaryConstants.TWO_TO_31),this.writeSignedVarint32_(e,t))},jspb.BinaryWriter.prototype.writeInt64=function(e,t){null!=t&&(jspb.asserts.assert(t>=-jspb.BinaryConstants.TWO_TO_63&&t<jspb.BinaryConstants.TWO_TO_63),this.writeSignedVarint64_(e,t))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeInt64",jspb.BinaryWriter.prototype.writeInt64),jspb.BinaryWriter.prototype.writeInt64String=function(e,t){null!=t&&(t=jspb.arith.Int64.fromString(t),this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeSplitVarint64(t.lo,t.hi))},jspb.BinaryWriter.prototype.writeUint32=function(e,t){null!=t&&(jspb.asserts.assert(0<=t&&t<jspb.BinaryConstants.TWO_TO_32),this.writeUnsignedVarint32_(e,t))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeUint32",jspb.BinaryWriter.prototype.writeUint32),jspb.BinaryWriter.prototype.writeUint32String=function(e,t){null!=t&&(t=parseInt(t,10),jspb.asserts.assert(0<=t&&t<jspb.BinaryConstants.TWO_TO_32),this.writeUnsignedVarint32_(e,t))},jspb.BinaryWriter.prototype.writeUint64=function(e,t){null!=t&&(jspb.asserts.assert(0<=t&&t<jspb.BinaryConstants.TWO_TO_64),this.writeUnsignedVarint64_(e,t))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeUint64",jspb.BinaryWriter.prototype.writeUint64),jspb.BinaryWriter.prototype.writeUint64String=function(e,t){null!=t&&(t=jspb.arith.UInt64.fromString(t),this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeSplitVarint64(t.lo,t.hi))},jspb.BinaryWriter.prototype.writeSint32=function(e,t){null!=t&&(jspb.asserts.assert(t>=-jspb.BinaryConstants.TWO_TO_31&&t<jspb.BinaryConstants.TWO_TO_31),this.writeZigzagVarint32_(e,t))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeSint32",jspb.BinaryWriter.prototype.writeSint32),jspb.BinaryWriter.prototype.writeSint64=function(e,t){null!=t&&(jspb.asserts.assert(t>=-jspb.BinaryConstants.TWO_TO_63&&t<jspb.BinaryConstants.TWO_TO_63),this.writeZigzagVarint64_(e,t))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeSint64",jspb.BinaryWriter.prototype.writeSint64),jspb.BinaryWriter.prototype.writeSintHash64=function(e,t){null!=t&&this.writeZigzagVarintHash64_(e,t)},jspb.BinaryWriter.prototype.writeSint64String=function(e,t){null!=t&&this.writeZigzagVarint64String_(e,t)},jspb.BinaryWriter.prototype.writeFixed32=function(e,t){null!=t&&(jspb.asserts.assert(0<=t&&t<jspb.BinaryConstants.TWO_TO_32),this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.FIXED32),this.encoder_.writeUint32(t))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeFixed32",jspb.BinaryWriter.prototype.writeFixed32),jspb.BinaryWriter.prototype.writeFixed64=function(e,t){null!=t&&(jspb.asserts.assert(0<=t&&t<jspb.BinaryConstants.TWO_TO_64),this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.FIXED64),this.encoder_.writeUint64(t))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeFixed64",jspb.BinaryWriter.prototype.writeFixed64),jspb.BinaryWriter.prototype.writeFixed64String=function(e,t){null!=t&&(t=jspb.arith.UInt64.fromString(t),this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.FIXED64),this.encoder_.writeSplitFixed64(t.lo,t.hi))},jspb.BinaryWriter.prototype.writeSfixed32=function(e,t){null!=t&&(jspb.asserts.assert(t>=-jspb.BinaryConstants.TWO_TO_31&&t<jspb.BinaryConstants.TWO_TO_31),this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.FIXED32),this.encoder_.writeInt32(t))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeSfixed32",jspb.BinaryWriter.prototype.writeSfixed32),jspb.BinaryWriter.prototype.writeSfixed64=function(e,t){null!=t&&(jspb.asserts.assert(t>=-jspb.BinaryConstants.TWO_TO_63&&t<jspb.BinaryConstants.TWO_TO_63),this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.FIXED64),this.encoder_.writeInt64(t))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeSfixed64",jspb.BinaryWriter.prototype.writeSfixed64),jspb.BinaryWriter.prototype.writeSfixed64String=function(e,t){null!=t&&(t=jspb.arith.Int64.fromString(t),this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.FIXED64),this.encoder_.writeSplitFixed64(t.lo,t.hi))},jspb.BinaryWriter.prototype.writeFloat=function(e,t){null!=t&&(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.FIXED32),this.encoder_.writeFloat(t))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeFloat",jspb.BinaryWriter.prototype.writeFloat),jspb.BinaryWriter.prototype.writeDouble=function(e,t){null!=t&&(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.FIXED64),this.encoder_.writeDouble(t))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeDouble",jspb.BinaryWriter.prototype.writeDouble),jspb.BinaryWriter.prototype.writeBool=function(e,t){null!=t&&(jspb.asserts.assert("boolean"==typeof t||"number"==typeof t),this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeBool(t))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeBool",jspb.BinaryWriter.prototype.writeBool),jspb.BinaryWriter.prototype.writeEnum=function(e,t){null!=t&&(jspb.asserts.assert(t>=-jspb.BinaryConstants.TWO_TO_31&&t<jspb.BinaryConstants.TWO_TO_31),this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeSignedVarint32(t))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeEnum",jspb.BinaryWriter.prototype.writeEnum),jspb.BinaryWriter.prototype.writeString=function(e,t){null!=t&&(e=this.beginDelimited_(e),this.encoder_.writeString(t),this.endDelimited_(e))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeString",jspb.BinaryWriter.prototype.writeString),jspb.BinaryWriter.prototype.writeBytes=function(e,t){null!=t&&(t=jspb.utils.byteSourceToUint8Array(t),this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(t.length),this.appendUint8Array_(t))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeBytes",jspb.BinaryWriter.prototype.writeBytes),jspb.BinaryWriter.prototype.writeMessage=function(e,t,n){null!=t&&(e=this.beginDelimited_(e),n(t,this),this.endDelimited_(e))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeMessage",jspb.BinaryWriter.prototype.writeMessage),jspb.BinaryWriter.prototype.writeMessageSet=function(e,t,n){null!=t&&(this.writeFieldHeader_(1,jspb.BinaryConstants.WireType.START_GROUP),this.writeFieldHeader_(2,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeSignedVarint32(e),e=this.beginDelimited_(3),n(t,this),this.endDelimited_(e),this.writeFieldHeader_(1,jspb.BinaryConstants.WireType.END_GROUP))},jspb.BinaryWriter.prototype.writeGroup=function(e,t,n){null!=t&&(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.START_GROUP),n(t,this),this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.END_GROUP))},goog.exportProperty(jspb.BinaryWriter.prototype,"writeGroup",jspb.BinaryWriter.prototype.writeGroup),jspb.BinaryWriter.prototype.writeFixedHash64=function(e,t){null!=t&&(jspb.asserts.assert(8==t.length),this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.FIXED64),this.encoder_.writeFixedHash64(t))},jspb.BinaryWriter.prototype.writeVarintHash64=function(e,t){null!=t&&(jspb.asserts.assert(8==t.length),this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeVarintHash64(t))},jspb.BinaryWriter.prototype.writeSplitFixed64=function(e,t,n){this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.FIXED64),this.encoder_.writeSplitFixed64(t,n)},jspb.BinaryWriter.prototype.writeSplitVarint64=function(e,t,n){this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeSplitVarint64(t,n)},jspb.BinaryWriter.prototype.writeSplitZigzagVarint64=function(e,t,n){this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.VARINT);var r=this.encoder_;jspb.utils.toZigzag64(t,n,(function(e,t){r.writeSplitVarint64(e>>>0,t>>>0)}))},jspb.BinaryWriter.prototype.writeRepeatedInt32=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeSignedVarint32_(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedInt32",jspb.BinaryWriter.prototype.writeRepeatedInt32),jspb.BinaryWriter.prototype.writeRepeatedInt32String=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeInt32String(e,t[n])},jspb.BinaryWriter.prototype.writeRepeatedInt64=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeSignedVarint64_(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedInt64",jspb.BinaryWriter.prototype.writeRepeatedInt64),jspb.BinaryWriter.prototype.writeRepeatedSplitFixed64=function(e,t,n,r){if(null!=t)for(var i=0;i<t.length;i++)this.writeSplitFixed64(e,n(t[i]),r(t[i]))},jspb.BinaryWriter.prototype.writeRepeatedSplitVarint64=function(e,t,n,r){if(null!=t)for(var i=0;i<t.length;i++)this.writeSplitVarint64(e,n(t[i]),r(t[i]))},jspb.BinaryWriter.prototype.writeRepeatedSplitZigzagVarint64=function(e,t,n,r){if(null!=t)for(var i=0;i<t.length;i++)this.writeSplitZigzagVarint64(e,n(t[i]),r(t[i]))},jspb.BinaryWriter.prototype.writeRepeatedInt64String=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeInt64String(e,t[n])},jspb.BinaryWriter.prototype.writeRepeatedUint32=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeUnsignedVarint32_(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedUint32",jspb.BinaryWriter.prototype.writeRepeatedUint32),jspb.BinaryWriter.prototype.writeRepeatedUint32String=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeUint32String(e,t[n])},jspb.BinaryWriter.prototype.writeRepeatedUint64=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeUnsignedVarint64_(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedUint64",jspb.BinaryWriter.prototype.writeRepeatedUint64),jspb.BinaryWriter.prototype.writeRepeatedUint64String=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeUint64String(e,t[n])},jspb.BinaryWriter.prototype.writeRepeatedSint32=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeZigzagVarint32_(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedSint32",jspb.BinaryWriter.prototype.writeRepeatedSint32),jspb.BinaryWriter.prototype.writeRepeatedSint64=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeZigzagVarint64_(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedSint64",jspb.BinaryWriter.prototype.writeRepeatedSint64),jspb.BinaryWriter.prototype.writeRepeatedSint64String=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeZigzagVarint64String_(e,t[n])},jspb.BinaryWriter.prototype.writeRepeatedSintHash64=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeZigzagVarintHash64_(e,t[n])},jspb.BinaryWriter.prototype.writeRepeatedFixed32=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeFixed32(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedFixed32",jspb.BinaryWriter.prototype.writeRepeatedFixed32),jspb.BinaryWriter.prototype.writeRepeatedFixed64=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeFixed64(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedFixed64",jspb.BinaryWriter.prototype.writeRepeatedFixed64),jspb.BinaryWriter.prototype.writeRepeatedFixed64String=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeFixed64String(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedFixed64String",jspb.BinaryWriter.prototype.writeRepeatedFixed64String),jspb.BinaryWriter.prototype.writeRepeatedSfixed32=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeSfixed32(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedSfixed32",jspb.BinaryWriter.prototype.writeRepeatedSfixed32),jspb.BinaryWriter.prototype.writeRepeatedSfixed64=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeSfixed64(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedSfixed64",jspb.BinaryWriter.prototype.writeRepeatedSfixed64),jspb.BinaryWriter.prototype.writeRepeatedSfixed64String=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeSfixed64String(e,t[n])},jspb.BinaryWriter.prototype.writeRepeatedFloat=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeFloat(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedFloat",jspb.BinaryWriter.prototype.writeRepeatedFloat),jspb.BinaryWriter.prototype.writeRepeatedDouble=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeDouble(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedDouble",jspb.BinaryWriter.prototype.writeRepeatedDouble),jspb.BinaryWriter.prototype.writeRepeatedBool=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeBool(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedBool",jspb.BinaryWriter.prototype.writeRepeatedBool),jspb.BinaryWriter.prototype.writeRepeatedEnum=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeEnum(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedEnum",jspb.BinaryWriter.prototype.writeRepeatedEnum),jspb.BinaryWriter.prototype.writeRepeatedString=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeString(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedString",jspb.BinaryWriter.prototype.writeRepeatedString),jspb.BinaryWriter.prototype.writeRepeatedBytes=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeBytes(e,t[n])},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedBytes",jspb.BinaryWriter.prototype.writeRepeatedBytes),jspb.BinaryWriter.prototype.writeRepeatedMessage=function(e,t,n){if(null!=t)for(var r=0;r<t.length;r++){var i=this.beginDelimited_(e);n(t[r],this),this.endDelimited_(i)}},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedMessage",jspb.BinaryWriter.prototype.writeRepeatedMessage),jspb.BinaryWriter.prototype.writeRepeatedGroup=function(e,t,n){if(null!=t)for(var r=0;r<t.length;r++)this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.START_GROUP),n(t[r],this),this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.END_GROUP)},goog.exportProperty(jspb.BinaryWriter.prototype,"writeRepeatedGroup",jspb.BinaryWriter.prototype.writeRepeatedGroup),jspb.BinaryWriter.prototype.writeRepeatedFixedHash64=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeFixedHash64(e,t[n])},jspb.BinaryWriter.prototype.writeRepeatedVarintHash64=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)this.writeVarintHash64(e,t[n])},jspb.BinaryWriter.prototype.writePackedInt32=function(e,t){if(null!=t&&t.length){e=this.beginDelimited_(e);for(var n=0;n<t.length;n++)this.encoder_.writeSignedVarint32(t[n]);this.endDelimited_(e)}},goog.exportProperty(jspb.BinaryWriter.prototype,"writePackedInt32",jspb.BinaryWriter.prototype.writePackedInt32),jspb.BinaryWriter.prototype.writePackedInt32String=function(e,t){if(null!=t&&t.length){e=this.beginDelimited_(e);for(var n=0;n<t.length;n++)this.encoder_.writeSignedVarint32(parseInt(t[n],10));this.endDelimited_(e)}},jspb.BinaryWriter.prototype.writePackedInt64=function(e,t){if(null!=t&&t.length){e=this.beginDelimited_(e);for(var n=0;n<t.length;n++)this.encoder_.writeSignedVarint64(t[n]);this.endDelimited_(e)}},goog.exportProperty(jspb.BinaryWriter.prototype,"writePackedInt64",jspb.BinaryWriter.prototype.writePackedInt64),jspb.BinaryWriter.prototype.writePackedSplitFixed64=function(e,t,n,r){if(null!=t){e=this.beginDelimited_(e);for(var i=0;i<t.length;i++)this.encoder_.writeSplitFixed64(n(t[i]),r(t[i]));this.endDelimited_(e)}},jspb.BinaryWriter.prototype.writePackedSplitVarint64=function(e,t,n,r){if(null!=t){e=this.beginDelimited_(e);for(var i=0;i<t.length;i++)this.encoder_.writeSplitVarint64(n(t[i]),r(t[i]));this.endDelimited_(e)}},jspb.BinaryWriter.prototype.writePackedSplitZigzagVarint64=function(e,t,n,r){if(null!=t){e=this.beginDelimited_(e);for(var i=this.encoder_,o=0;o<t.length;o++)jspb.utils.toZigzag64(n(t[o]),r(t[o]),(function(e,t){i.writeSplitVarint64(e>>>0,t>>>0)}));this.endDelimited_(e)}},jspb.BinaryWriter.prototype.writePackedInt64String=function(e,t){if(null!=t&&t.length){e=this.beginDelimited_(e);for(var n=0;n<t.length;n++){var r=jspb.arith.Int64.fromString(t[n]);this.encoder_.writeSplitVarint64(r.lo,r.hi)}this.endDelimited_(e)}},jspb.BinaryWriter.prototype.writePackedUint32=function(e,t){if(null!=t&&t.length){e=this.beginDelimited_(e);for(var n=0;n<t.length;n++)this.encoder_.writeUnsignedVarint32(t[n]);this.endDelimited_(e)}},goog.exportProperty(jspb.BinaryWriter.prototype,"writePackedUint32",jspb.BinaryWriter.prototype.writePackedUint32),jspb.BinaryWriter.prototype.writePackedUint32String=function(e,t){if(null!=t&&t.length){e=this.beginDelimited_(e);for(var n=0;n<t.length;n++)this.encoder_.writeUnsignedVarint32(parseInt(t[n],10));this.endDelimited_(e)}},jspb.BinaryWriter.prototype.writePackedUint64=function(e,t){if(null!=t&&t.length){e=this.beginDelimited_(e);for(var n=0;n<t.length;n++)this.encoder_.writeUnsignedVarint64(t[n]);this.endDelimited_(e)}},goog.exportProperty(jspb.BinaryWriter.prototype,"writePackedUint64",jspb.BinaryWriter.prototype.writePackedUint64),jspb.BinaryWriter.prototype.writePackedUint64String=function(e,t){if(null!=t&&t.length){e=this.beginDelimited_(e);for(var n=0;n<t.length;n++){var r=jspb.arith.UInt64.fromString(t[n]);this.encoder_.writeSplitVarint64(r.lo,r.hi)}this.endDelimited_(e)}},jspb.BinaryWriter.prototype.writePackedSint32=function(e,t){if(null!=t&&t.length){e=this.beginDelimited_(e);for(var n=0;n<t.length;n++)this.encoder_.writeZigzagVarint32(t[n]);this.endDelimited_(e)}},goog.exportProperty(jspb.BinaryWriter.prototype,"writePackedSint32",jspb.BinaryWriter.prototype.writePackedSint32),jspb.BinaryWriter.prototype.writePackedSint64=function(e,t){if(null!=t&&t.length){e=this.beginDelimited_(e);for(var n=0;n<t.length;n++)this.encoder_.writeZigzagVarint64(t[n]);this.endDelimited_(e)}},goog.exportProperty(jspb.BinaryWriter.prototype,"writePackedSint64",jspb.BinaryWriter.prototype.writePackedSint64),jspb.BinaryWriter.prototype.writePackedSint64String=function(e,t){if(null!=t&&t.length){e=this.beginDelimited_(e);for(var n=0;n<t.length;n++)this.encoder_.writeZigzagVarintHash64(jspb.utils.decimalStringToHash64(t[n]));this.endDelimited_(e)}},jspb.BinaryWriter.prototype.writePackedSintHash64=function(e,t){if(null!=t&&t.length){e=this.beginDelimited_(e);for(var n=0;n<t.length;n++)this.encoder_.writeZigzagVarintHash64(t[n]);this.endDelimited_(e)}},jspb.BinaryWriter.prototype.writePackedFixed32=function(e,t){if(null!=t&&t.length)for(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(4*t.length),e=0;e<t.length;e++)this.encoder_.writeUint32(t[e])},goog.exportProperty(jspb.BinaryWriter.prototype,"writePackedFixed32",jspb.BinaryWriter.prototype.writePackedFixed32),jspb.BinaryWriter.prototype.writePackedFixed64=function(e,t){if(null!=t&&t.length)for(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(8*t.length),e=0;e<t.length;e++)this.encoder_.writeUint64(t[e])},goog.exportProperty(jspb.BinaryWriter.prototype,"writePackedFixed64",jspb.BinaryWriter.prototype.writePackedFixed64),jspb.BinaryWriter.prototype.writePackedFixed64String=function(e,t){if(null!=t&&t.length)for(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(8*t.length),e=0;e<t.length;e++){var n=jspb.arith.UInt64.fromString(t[e]);this.encoder_.writeSplitFixed64(n.lo,n.hi)}},jspb.BinaryWriter.prototype.writePackedSfixed32=function(e,t){if(null!=t&&t.length)for(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(4*t.length),e=0;e<t.length;e++)this.encoder_.writeInt32(t[e])},goog.exportProperty(jspb.BinaryWriter.prototype,"writePackedSfixed32",jspb.BinaryWriter.prototype.writePackedSfixed32),jspb.BinaryWriter.prototype.writePackedSfixed64=function(e,t){if(null!=t&&t.length)for(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(8*t.length),e=0;e<t.length;e++)this.encoder_.writeInt64(t[e])},goog.exportProperty(jspb.BinaryWriter.prototype,"writePackedSfixed64",jspb.BinaryWriter.prototype.writePackedSfixed64),jspb.BinaryWriter.prototype.writePackedSfixed64String=function(e,t){if(null!=t&&t.length)for(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(8*t.length),e=0;e<t.length;e++)this.encoder_.writeInt64String(t[e])},jspb.BinaryWriter.prototype.writePackedFloat=function(e,t){if(null!=t&&t.length)for(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(4*t.length),e=0;e<t.length;e++)this.encoder_.writeFloat(t[e])},goog.exportProperty(jspb.BinaryWriter.prototype,"writePackedFloat",jspb.BinaryWriter.prototype.writePackedFloat),jspb.BinaryWriter.prototype.writePackedDouble=function(e,t){if(null!=t&&t.length)for(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(8*t.length),e=0;e<t.length;e++)this.encoder_.writeDouble(t[e])},goog.exportProperty(jspb.BinaryWriter.prototype,"writePackedDouble",jspb.BinaryWriter.prototype.writePackedDouble),jspb.BinaryWriter.prototype.writePackedBool=function(e,t){if(null!=t&&t.length)for(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(t.length),e=0;e<t.length;e++)this.encoder_.writeBool(t[e])},goog.exportProperty(jspb.BinaryWriter.prototype,"writePackedBool",jspb.BinaryWriter.prototype.writePackedBool),jspb.BinaryWriter.prototype.writePackedEnum=function(e,t){if(null!=t&&t.length){e=this.beginDelimited_(e);for(var n=0;n<t.length;n++)this.encoder_.writeEnum(t[n]);this.endDelimited_(e)}},goog.exportProperty(jspb.BinaryWriter.prototype,"writePackedEnum",jspb.BinaryWriter.prototype.writePackedEnum),jspb.BinaryWriter.prototype.writePackedFixedHash64=function(e,t){if(null!=t&&t.length)for(this.writeFieldHeader_(e,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(8*t.length),e=0;e<t.length;e++)this.encoder_.writeFixedHash64(t[e])},jspb.BinaryWriter.prototype.writePackedVarintHash64=function(e,t){if(null!=t&&t.length){e=this.beginDelimited_(e);for(var n=0;n<t.length;n++)this.encoder_.writeVarintHash64(t[n]);this.endDelimited_(e)}},jspb.Map=function(e,t){this.arr_=e,this.valueCtor_=t,this.map_={},this.arrClean=!0,0<this.arr_.length&&this.loadFromArray_()},goog.exportSymbol("jspb.Map",jspb.Map),jspb.Map.prototype.loadFromArray_=function(){for(var e=0;e<this.arr_.length;e++){var t=this.arr_[e],n=t[0];this.map_[n.toString()]=new jspb.Map.Entry_(n,t[1])}this.arrClean=!0},jspb.Map.prototype.toArray=function(){if(this.arrClean){if(this.valueCtor_){var e,t=this.map_;for(e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var n=t[e].valueWrapper;n&&n.toArray()}}}else{for(this.arr_.length=0,(t=this.stringKeys_()).sort(),e=0;e<t.length;e++){var r=this.map_[t[e]];(n=r.valueWrapper)&&n.toArray(),this.arr_.push([r.key,r.value])}this.arrClean=!0}return this.arr_},goog.exportProperty(jspb.Map.prototype,"toArray",jspb.Map.prototype.toArray),jspb.Map.prototype.toObject=function(e,t){for(var n=this.toArray(),r=[],i=0;i<n.length;i++){var o=this.map_[n[i][0].toString()];this.wrapEntry_(o);var a=o.valueWrapper;a?(jspb.asserts.assert(t),r.push([o.key,t(e,a)])):r.push([o.key,o.value])}return r},goog.exportProperty(jspb.Map.prototype,"toObject",jspb.Map.prototype.toObject),jspb.Map.fromObject=function(e,t,n){t=new jspb.Map([],t);for(var r=0;r<e.length;r++){var i=e[r][0],o=n(e[r][1]);t.set(i,o)}return t},goog.exportProperty(jspb.Map,"fromObject",jspb.Map.fromObject),jspb.Map.ArrayIteratorIterable_=function(e){this.idx_=0,this.arr_=e},jspb.Map.ArrayIteratorIterable_.prototype.next=function(){return this.idx_<this.arr_.length?{done:!1,value:this.arr_[this.idx_++]}:{done:!0,value:void 0}},"undefined"!=typeof Symbol&&(jspb.Map.ArrayIteratorIterable_.prototype[Symbol.iterator]=function(){return this}),jspb.Map.prototype.getLength=function(){return this.stringKeys_().length},goog.exportProperty(jspb.Map.prototype,"getLength",jspb.Map.prototype.getLength),jspb.Map.prototype.clear=function(){this.map_={},this.arrClean=!1},goog.exportProperty(jspb.Map.prototype,"clear",jspb.Map.prototype.clear),jspb.Map.prototype.del=function(e){e=e.toString();var t=this.map_.hasOwnProperty(e);return delete this.map_[e],this.arrClean=!1,t},goog.exportProperty(jspb.Map.prototype,"del",jspb.Map.prototype.del),jspb.Map.prototype.getEntryList=function(){var e=[],t=this.stringKeys_();t.sort();for(var n=0;n<t.length;n++){var r=this.map_[t[n]];e.push([r.key,r.value])}return e},goog.exportProperty(jspb.Map.prototype,"getEntryList",jspb.Map.prototype.getEntryList),jspb.Map.prototype.entries=function(){var e=[],t=this.stringKeys_();t.sort();for(var n=0;n<t.length;n++){var r=this.map_[t[n]];e.push([r.key,this.wrapEntry_(r)])}return new jspb.Map.ArrayIteratorIterable_(e)},goog.exportProperty(jspb.Map.prototype,"entries",jspb.Map.prototype.entries),jspb.Map.prototype.keys=function(){var e=[],t=this.stringKeys_();t.sort();for(var n=0;n<t.length;n++)e.push(this.map_[t[n]].key);return new jspb.Map.ArrayIteratorIterable_(e)},goog.exportProperty(jspb.Map.prototype,"keys",jspb.Map.prototype.keys),jspb.Map.prototype.values=function(){var e=[],t=this.stringKeys_();t.sort();for(var n=0;n<t.length;n++)e.push(this.wrapEntry_(this.map_[t[n]]));return new jspb.Map.ArrayIteratorIterable_(e)},goog.exportProperty(jspb.Map.prototype,"values",jspb.Map.prototype.values),jspb.Map.prototype.forEach=function(e,t){var n=this.stringKeys_();n.sort();for(var r=0;r<n.length;r++){var i=this.map_[n[r]];e.call(t,this.wrapEntry_(i),i.key,this)}},goog.exportProperty(jspb.Map.prototype,"forEach",jspb.Map.prototype.forEach),jspb.Map.prototype.set=function(e,t){var n=new jspb.Map.Entry_(e);return this.valueCtor_?(n.valueWrapper=t,n.value=t.toArray()):n.value=t,this.map_[e.toString()]=n,this.arrClean=!1,this},goog.exportProperty(jspb.Map.prototype,"set",jspb.Map.prototype.set),jspb.Map.prototype.wrapEntry_=function(e){return this.valueCtor_?(e.valueWrapper||(e.valueWrapper=new this.valueCtor_(e.value)),e.valueWrapper):e.value},jspb.Map.prototype.get=function(e){if(e=this.map_[e.toString()])return this.wrapEntry_(e)},goog.exportProperty(jspb.Map.prototype,"get",jspb.Map.prototype.get),jspb.Map.prototype.has=function(e){return e.toString()in this.map_},goog.exportProperty(jspb.Map.prototype,"has",jspb.Map.prototype.has),jspb.Map.prototype.serializeBinary=function(e,t,n,r,i){var o=this.stringKeys_();o.sort();for(var a=0;a<o.length;a++){var s=this.map_[o[a]];t.beginSubMessage(e),n.call(t,1,s.key),this.valueCtor_?r.call(t,2,this.wrapEntry_(s),i):r.call(t,2,s.value),t.endSubMessage()}},goog.exportProperty(jspb.Map.prototype,"serializeBinary",jspb.Map.prototype.serializeBinary),jspb.Map.deserializeBinary=function(e,t,n,r,i,o,a){for(;t.nextField()&&!t.isEndGroup();){var s=t.getFieldNumber();1==s?o=n.call(t):2==s&&(e.valueCtor_?(jspb.asserts.assert(i),a||(a=new e.valueCtor_),r.call(t,a,i)):a=r.call(t))}jspb.asserts.assert(null!=o),jspb.asserts.assert(null!=a),e.set(o,a)},goog.exportProperty(jspb.Map,"deserializeBinary",jspb.Map.deserializeBinary),jspb.Map.prototype.stringKeys_=function(){var e,t=this.map_,n=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push(e);return n},jspb.Map.Entry_=function(e,t){this.key=e,this.value=t,this.valueWrapper=void 0},jspb.ExtensionFieldInfo=function(e,t,n,r,i){this.fieldIndex=e,this.fieldName=t,this.ctor=n,this.toObjectFn=r,this.isRepeated=i},goog.exportSymbol("jspb.ExtensionFieldInfo",jspb.ExtensionFieldInfo),jspb.ExtensionFieldBinaryInfo=function(e,t,n,r,i,o){this.fieldInfo=e,this.binaryReaderFn=t,this.binaryWriterFn=n,this.binaryMessageSerializeFn=r,this.binaryMessageDeserializeFn=i,this.isPacked=o},goog.exportSymbol("jspb.ExtensionFieldBinaryInfo",jspb.ExtensionFieldBinaryInfo),jspb.ExtensionFieldInfo.prototype.isMessageType=function(){return!!this.ctor},goog.exportProperty(jspb.ExtensionFieldInfo.prototype,"isMessageType",jspb.ExtensionFieldInfo.prototype.isMessageType),jspb.Message=function(){},goog.exportSymbol("jspb.Message",jspb.Message),jspb.Message.GENERATE_TO_OBJECT=!0,goog.exportProperty(jspb.Message,"GENERATE_TO_OBJECT",jspb.Message.GENERATE_TO_OBJECT),jspb.Message.GENERATE_FROM_OBJECT=!goog.DISALLOW_TEST_ONLY_CODE,goog.exportProperty(jspb.Message,"GENERATE_FROM_OBJECT",jspb.Message.GENERATE_FROM_OBJECT),jspb.Message.GENERATE_TO_STRING=!0,jspb.Message.ASSUME_LOCAL_ARRAYS=!1,jspb.Message.SERIALIZE_EMPTY_TRAILING_FIELDS=!0,jspb.Message.SUPPORTS_UINT8ARRAY_="function"==typeof Uint8Array,jspb.Message.prototype.getJsPbMessageId=function(){return this.messageId_},goog.exportProperty(jspb.Message.prototype,"getJsPbMessageId",jspb.Message.prototype.getJsPbMessageId),jspb.Message.getIndex_=function(e,t){return t+e.arrayIndexOffset_},jspb.Message.hiddenES6Property_=function(){},jspb.Message.getFieldNumber_=function(e,t){return t-e.arrayIndexOffset_},jspb.Message.initialize=function(e,t,n,r,i,o){if(e.wrappers_=null,t||(t=n?[n]:[]),e.messageId_=n?String(n):void 0,e.arrayIndexOffset_=0===n?-1:0,e.array=t,jspb.Message.initPivotAndExtensionObject_(e,r),e.convertedPrimitiveFields_={},jspb.Message.SERIALIZE_EMPTY_TRAILING_FIELDS||(e.repeatedFields=i),i)for(t=0;t<i.length;t++)(n=i[t])<e.pivot_?(n=jspb.Message.getIndex_(e,n),e.array[n]=e.array[n]||jspb.Message.EMPTY_LIST_SENTINEL_):(jspb.Message.maybeInitEmptyExtensionObject_(e),e.extensionObject_[n]=e.extensionObject_[n]||jspb.Message.EMPTY_LIST_SENTINEL_);if(o&&o.length)for(t=0;t<o.length;t++)jspb.Message.computeOneofCase(e,o[t])},goog.exportProperty(jspb.Message,"initialize",jspb.Message.initialize),jspb.Message.EMPTY_LIST_SENTINEL_=goog.DEBUG&&Object.freeze?Object.freeze([]):[],jspb.Message.isArray_=function(e){return jspb.Message.ASSUME_LOCAL_ARRAYS?e instanceof Array:Array.isArray(e)},jspb.Message.isExtensionObject_=function(e){return!(null===e||"object"!=typeof e||jspb.Message.isArray_(e)||jspb.Message.SUPPORTS_UINT8ARRAY_&&e instanceof Uint8Array)},jspb.Message.initPivotAndExtensionObject_=function(e,t){var n=e.array.length,r=-1;if(n&&(r=n-1,n=e.array[r],jspb.Message.isExtensionObject_(n)))return e.pivot_=jspb.Message.getFieldNumber_(e,r),void(e.extensionObject_=n);-1<t?(e.pivot_=Math.max(t,jspb.Message.getFieldNumber_(e,r+1)),e.extensionObject_=null):e.pivot_=Number.MAX_VALUE},jspb.Message.maybeInitEmptyExtensionObject_=function(e){var t=jspb.Message.getIndex_(e,e.pivot_);e.array[t]||(e.extensionObject_=e.array[t]={})},jspb.Message.toObjectList=function(e,t,n){for(var r=[],i=0;i<e.length;i++)r[i]=t.call(e[i],n,e[i]);return r},goog.exportProperty(jspb.Message,"toObjectList",jspb.Message.toObjectList),jspb.Message.toObjectExtension=function(e,t,n,r,i){for(var o in n){var a=n[o],s=r.call(e,a);if(null!=s){for(var u in a.fieldName)if(a.fieldName.hasOwnProperty(u))break;t[u]=a.toObjectFn?a.isRepeated?jspb.Message.toObjectList(s,a.toObjectFn,i):a.toObjectFn(i,s):s}}},goog.exportProperty(jspb.Message,"toObjectExtension",jspb.Message.toObjectExtension),jspb.Message.serializeBinaryExtensions=function(e,t,n,r){for(var i in n){var o=n[i],a=o.fieldInfo;if(!o.binaryWriterFn)throw Error("Message extension present that was generated without binary serialization support");var s=r.call(e,a);if(null!=s)if(a.isMessageType()){if(!o.binaryMessageSerializeFn)throw Error("Message extension present holding submessage without binary support enabled, and message is being serialized to binary format");o.binaryWriterFn.call(t,a.fieldIndex,s,o.binaryMessageSerializeFn)}else o.binaryWriterFn.call(t,a.fieldIndex,s)}},goog.exportProperty(jspb.Message,"serializeBinaryExtensions",jspb.Message.serializeBinaryExtensions),jspb.Message.readBinaryExtension=function(e,t,n,r,i){var o=n[t.getFieldNumber()];if(o){if(n=o.fieldInfo,!o.binaryReaderFn)throw Error("Deserializing extension whose generated code does not support binary format");if(n.isMessageType()){var a=new n.ctor;o.binaryReaderFn.call(t,a,o.binaryMessageDeserializeFn)}else a=o.binaryReaderFn.call(t);n.isRepeated&&!o.isPacked?(t=r.call(e,n))?t.push(a):i.call(e,n,[a]):i.call(e,n,a)}else t.skipField()},goog.exportProperty(jspb.Message,"readBinaryExtension",jspb.Message.readBinaryExtension),jspb.Message.getField=function(e,t){if(t<e.pivot_){t=jspb.Message.getIndex_(e,t);var n=e.array[t];return n===jspb.Message.EMPTY_LIST_SENTINEL_?e.array[t]=[]:n}if(e.extensionObject_)return(n=e.extensionObject_[t])===jspb.Message.EMPTY_LIST_SENTINEL_?e.extensionObject_[t]=[]:n},goog.exportProperty(jspb.Message,"getField",jspb.Message.getField),jspb.Message.getRepeatedField=function(e,t){return jspb.Message.getField(e,t)},goog.exportProperty(jspb.Message,"getRepeatedField",jspb.Message.getRepeatedField),jspb.Message.getOptionalFloatingPointField=function(e,t){return null==(e=jspb.Message.getField(e,t))?e:+e},goog.exportProperty(jspb.Message,"getOptionalFloatingPointField",jspb.Message.getOptionalFloatingPointField),jspb.Message.getBooleanField=function(e,t){return null==(e=jspb.Message.getField(e,t))?e:!!e},goog.exportProperty(jspb.Message,"getBooleanField",jspb.Message.getBooleanField),jspb.Message.getRepeatedFloatingPointField=function(e,t){var n=jspb.Message.getRepeatedField(e,t);if(e.convertedPrimitiveFields_||(e.convertedPrimitiveFields_={}),!e.convertedPrimitiveFields_[t]){for(var r=0;r<n.length;r++)n[r]=+n[r];e.convertedPrimitiveFields_[t]=!0}return n},goog.exportProperty(jspb.Message,"getRepeatedFloatingPointField",jspb.Message.getRepeatedFloatingPointField),jspb.Message.getRepeatedBooleanField=function(e,t){var n=jspb.Message.getRepeatedField(e,t);if(e.convertedPrimitiveFields_||(e.convertedPrimitiveFields_={}),!e.convertedPrimitiveFields_[t]){for(var r=0;r<n.length;r++)n[r]=!!n[r];e.convertedPrimitiveFields_[t]=!0}return n},goog.exportProperty(jspb.Message,"getRepeatedBooleanField",jspb.Message.getRepeatedBooleanField),jspb.Message.bytesAsB64=function(e){return null==e||"string"==typeof e?e:jspb.Message.SUPPORTS_UINT8ARRAY_&&e instanceof Uint8Array?goog.crypt.base64.encodeByteArray(e):(jspb.asserts.fail("Cannot coerce to b64 string: "+goog.typeOf(e)),null)},goog.exportProperty(jspb.Message,"bytesAsB64",jspb.Message.bytesAsB64),jspb.Message.bytesAsU8=function(e){return null==e||e instanceof Uint8Array?e:"string"==typeof e?goog.crypt.base64.decodeStringToUint8Array(e):(jspb.asserts.fail("Cannot coerce to Uint8Array: "+goog.typeOf(e)),null)},goog.exportProperty(jspb.Message,"bytesAsU8",jspb.Message.bytesAsU8),jspb.Message.bytesListAsB64=function(e){return jspb.Message.assertConsistentTypes_(e),e.length&&"string"!=typeof e[0]?goog.array.map(e,jspb.Message.bytesAsB64):e},goog.exportProperty(jspb.Message,"bytesListAsB64",jspb.Message.bytesListAsB64),jspb.Message.bytesListAsU8=function(e){return jspb.Message.assertConsistentTypes_(e),!e.length||e[0]instanceof Uint8Array?e:goog.array.map(e,jspb.Message.bytesAsU8)},goog.exportProperty(jspb.Message,"bytesListAsU8",jspb.Message.bytesListAsU8),jspb.Message.assertConsistentTypes_=function(e){if(goog.DEBUG&&e&&1<e.length){var t=goog.typeOf(e[0]);goog.array.forEach(e,(function(e){goog.typeOf(e)!=t&&jspb.asserts.fail("Inconsistent type in JSPB repeated field array. Got "+goog.typeOf(e)+" expected "+t)}))}},jspb.Message.getFieldWithDefault=function(e,t,n){return null==(e=jspb.Message.getField(e,t))?n:e},goog.exportProperty(jspb.Message,"getFieldWithDefault",jspb.Message.getFieldWithDefault),jspb.Message.getBooleanFieldWithDefault=function(e,t,n){return null==(e=jspb.Message.getBooleanField(e,t))?n:e},goog.exportProperty(jspb.Message,"getBooleanFieldWithDefault",jspb.Message.getBooleanFieldWithDefault),jspb.Message.getFloatingPointFieldWithDefault=function(e,t,n){return null==(e=jspb.Message.getOptionalFloatingPointField(e,t))?n:e},goog.exportProperty(jspb.Message,"getFloatingPointFieldWithDefault",jspb.Message.getFloatingPointFieldWithDefault),jspb.Message.getFieldProto3=jspb.Message.getFieldWithDefault,goog.exportProperty(jspb.Message,"getFieldProto3",jspb.Message.getFieldProto3),jspb.Message.getMapField=function(e,t,n,r){if(e.wrappers_||(e.wrappers_={}),t in e.wrappers_)return e.wrappers_[t];var i=jspb.Message.getField(e,t);if(!i){if(n)return;i=[],jspb.Message.setField(e,t,i)}return e.wrappers_[t]=new jspb.Map(i,r)},goog.exportProperty(jspb.Message,"getMapField",jspb.Message.getMapField),jspb.Message.setField=function(e,t,n){return jspb.asserts.assertInstanceof(e,jspb.Message),t<e.pivot_?e.array[jspb.Message.getIndex_(e,t)]=n:(jspb.Message.maybeInitEmptyExtensionObject_(e),e.extensionObject_[t]=n),e},goog.exportProperty(jspb.Message,"setField",jspb.Message.setField),jspb.Message.setProto3IntField=function(e,t,n){return jspb.Message.setFieldIgnoringDefault_(e,t,n,0)},goog.exportProperty(jspb.Message,"setProto3IntField",jspb.Message.setProto3IntField),jspb.Message.setProto3FloatField=function(e,t,n){return jspb.Message.setFieldIgnoringDefault_(e,t,n,0)},goog.exportProperty(jspb.Message,"setProto3FloatField",jspb.Message.setProto3FloatField),jspb.Message.setProto3BooleanField=function(e,t,n){return jspb.Message.setFieldIgnoringDefault_(e,t,n,!1)},goog.exportProperty(jspb.Message,"setProto3BooleanField",jspb.Message.setProto3BooleanField),jspb.Message.setProto3StringField=function(e,t,n){return jspb.Message.setFieldIgnoringDefault_(e,t,n,"")},goog.exportProperty(jspb.Message,"setProto3StringField",jspb.Message.setProto3StringField),jspb.Message.setProto3BytesField=function(e,t,n){return jspb.Message.setFieldIgnoringDefault_(e,t,n,"")},goog.exportProperty(jspb.Message,"setProto3BytesField",jspb.Message.setProto3BytesField),jspb.Message.setProto3EnumField=function(e,t,n){return jspb.Message.setFieldIgnoringDefault_(e,t,n,0)},goog.exportProperty(jspb.Message,"setProto3EnumField",jspb.Message.setProto3EnumField),jspb.Message.setProto3StringIntField=function(e,t,n){return jspb.Message.setFieldIgnoringDefault_(e,t,n,"0")},goog.exportProperty(jspb.Message,"setProto3StringIntField",jspb.Message.setProto3StringIntField),jspb.Message.setFieldIgnoringDefault_=function(e,t,n,r){return jspb.asserts.assertInstanceof(e,jspb.Message),n!==r?jspb.Message.setField(e,t,n):t<e.pivot_?e.array[jspb.Message.getIndex_(e,t)]=null:(jspb.Message.maybeInitEmptyExtensionObject_(e),delete e.extensionObject_[t]),e},jspb.Message.addToRepeatedField=function(e,t,n,r){return jspb.asserts.assertInstanceof(e,jspb.Message),t=jspb.Message.getRepeatedField(e,t),null!=r?t.splice(r,0,n):t.push(n),e},goog.exportProperty(jspb.Message,"addToRepeatedField",jspb.Message.addToRepeatedField),jspb.Message.setOneofField=function(e,t,n,r){return jspb.asserts.assertInstanceof(e,jspb.Message),(n=jspb.Message.computeOneofCase(e,n))&&n!==t&&void 0!==r&&(e.wrappers_&&n in e.wrappers_&&(e.wrappers_[n]=void 0),jspb.Message.setField(e,n,void 0)),jspb.Message.setField(e,t,r)},goog.exportProperty(jspb.Message,"setOneofField",jspb.Message.setOneofField),jspb.Message.computeOneofCase=function(e,t){for(var n,r,i=0;i<t.length;i++){var o=t[i],a=jspb.Message.getField(e,o);null!=a&&(n=o,r=a,jspb.Message.setField(e,o,void 0))}return n?(jspb.Message.setField(e,n,r),n):0},goog.exportProperty(jspb.Message,"computeOneofCase",jspb.Message.computeOneofCase),jspb.Message.getWrapperField=function(e,t,n,r){if(e.wrappers_||(e.wrappers_={}),!e.wrappers_[n]){var i=jspb.Message.getField(e,n);(r||i)&&(e.wrappers_[n]=new t(i))}return e.wrappers_[n]},goog.exportProperty(jspb.Message,"getWrapperField",jspb.Message.getWrapperField),jspb.Message.getRepeatedWrapperField=function(e,t,n){return jspb.Message.wrapRepeatedField_(e,t,n),(t=e.wrappers_[n])==jspb.Message.EMPTY_LIST_SENTINEL_&&(t=e.wrappers_[n]=[]),t},goog.exportProperty(jspb.Message,"getRepeatedWrapperField",jspb.Message.getRepeatedWrapperField),jspb.Message.wrapRepeatedField_=function(e,t,n){if(e.wrappers_||(e.wrappers_={}),!e.wrappers_[n]){for(var r=jspb.Message.getRepeatedField(e,n),i=[],o=0;o<r.length;o++)i[o]=new t(r[o]);e.wrappers_[n]=i}},jspb.Message.setWrapperField=function(e,t,n){jspb.asserts.assertInstanceof(e,jspb.Message),e.wrappers_||(e.wrappers_={});var r=n?n.toArray():n;return e.wrappers_[t]=n,jspb.Message.setField(e,t,r)},goog.exportProperty(jspb.Message,"setWrapperField",jspb.Message.setWrapperField),jspb.Message.setOneofWrapperField=function(e,t,n,r){jspb.asserts.assertInstanceof(e,jspb.Message),e.wrappers_||(e.wrappers_={});var i=r?r.toArray():r;return e.wrappers_[t]=r,jspb.Message.setOneofField(e,t,n,i)},goog.exportProperty(jspb.Message,"setOneofWrapperField",jspb.Message.setOneofWrapperField),jspb.Message.setRepeatedWrapperField=function(e,t,n){jspb.asserts.assertInstanceof(e,jspb.Message),e.wrappers_||(e.wrappers_={}),n=n||[];for(var r=[],i=0;i<n.length;i++)r[i]=n[i].toArray();return e.wrappers_[t]=n,jspb.Message.setField(e,t,r)},goog.exportProperty(jspb.Message,"setRepeatedWrapperField",jspb.Message.setRepeatedWrapperField),jspb.Message.addToRepeatedWrapperField=function(e,t,n,r,i){jspb.Message.wrapRepeatedField_(e,r,t);var o=e.wrappers_[t];return o||(o=e.wrappers_[t]=[]),n=n||new r,e=jspb.Message.getRepeatedField(e,t),null!=i?(o.splice(i,0,n),e.splice(i,0,n.toArray())):(o.push(n),e.push(n.toArray())),n},goog.exportProperty(jspb.Message,"addToRepeatedWrapperField",jspb.Message.addToRepeatedWrapperField),jspb.Message.toMap=function(e,t,n,r){for(var i={},o=0;o<e.length;o++)i[t.call(e[o])]=n?n.call(e[o],r,e[o]):e[o];return i},goog.exportProperty(jspb.Message,"toMap",jspb.Message.toMap),jspb.Message.prototype.syncMapFields_=function(){if(this.wrappers_)for(var e in this.wrappers_){var t=this.wrappers_[e];if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n]&&t[n].toArray();else t&&t.toArray()}},jspb.Message.prototype.toArray=function(){return this.syncMapFields_(),this.array},goog.exportProperty(jspb.Message.prototype,"toArray",jspb.Message.prototype.toArray),jspb.Message.GENERATE_TO_STRING&&(jspb.Message.prototype.toString=function(){return this.syncMapFields_(),this.array.toString()}),jspb.Message.prototype.getExtension=function(e){if(this.extensionObject_){this.wrappers_||(this.wrappers_={});var t=e.fieldIndex;if(e.isRepeated){if(e.isMessageType())return this.wrappers_[t]||(this.wrappers_[t]=goog.array.map(this.extensionObject_[t]||[],(function(t){return new e.ctor(t)}))),this.wrappers_[t]}else if(e.isMessageType())return!this.wrappers_[t]&&this.extensionObject_[t]&&(this.wrappers_[t]=new e.ctor(this.extensionObject_[t])),this.wrappers_[t];return this.extensionObject_[t]}},goog.exportProperty(jspb.Message.prototype,"getExtension",jspb.Message.prototype.getExtension),jspb.Message.prototype.setExtension=function(e,t){this.wrappers_||(this.wrappers_={}),jspb.Message.maybeInitEmptyExtensionObject_(this);var n=e.fieldIndex;return e.isRepeated?(t=t||[],e.isMessageType()?(this.wrappers_[n]=t,this.extensionObject_[n]=goog.array.map(t,(function(e){return e.toArray()}))):this.extensionObject_[n]=t):e.isMessageType()?(this.wrappers_[n]=t,this.extensionObject_[n]=t?t.toArray():t):this.extensionObject_[n]=t,this},goog.exportProperty(jspb.Message.prototype,"setExtension",jspb.Message.prototype.setExtension),jspb.Message.difference=function(e,t){if(!(e instanceof t.constructor))throw Error("Messages have different types.");var n=e.toArray();t=t.toArray();var r=[],i=0,o=n.length>t.length?n.length:t.length;for(e.getJsPbMessageId()&&(r[0]=e.getJsPbMessageId(),i=1);i<o;i++)jspb.Message.compareFields(n[i],t[i])||(r[i]=t[i]);return new e.constructor(r)},goog.exportProperty(jspb.Message,"difference",jspb.Message.difference),jspb.Message.equals=function(e,t){return e==t||!(!e||!t)&&e instanceof t.constructor&&jspb.Message.compareFields(e.toArray(),t.toArray())},goog.exportProperty(jspb.Message,"equals",jspb.Message.equals),jspb.Message.compareExtensions=function(e,t){e=e||{},t=t||{};var n,r={};for(n in e)r[n]=0;for(n in t)r[n]=0;for(n in r)if(!jspb.Message.compareFields(e[n],t[n]))return!1;return!0},goog.exportProperty(jspb.Message,"compareExtensions",jspb.Message.compareExtensions),jspb.Message.compareFields=function(e,t){if(e==t)return!0;if(!goog.isObject(e)||!goog.isObject(t))return!!("number"==typeof e&&isNaN(e)||"number"==typeof t&&isNaN(t))&&String(e)==String(t);if(e.constructor!=t.constructor)return!1;if(jspb.Message.SUPPORTS_UINT8ARRAY_&&e.constructor===Uint8Array){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}if(e.constructor===Array){var r=void 0,i=void 0,o=Math.max(e.length,t.length);for(n=0;n<o;n++){var a=e[n],s=t[n];if(a&&a.constructor==Object&&(jspb.asserts.assert(void 0===r),jspb.asserts.assert(n===e.length-1),r=a,a=void 0),s&&s.constructor==Object&&(jspb.asserts.assert(void 0===i),jspb.asserts.assert(n===t.length-1),i=s,s=void 0),!jspb.Message.compareFields(a,s))return!1}return!r&&!i||(r=r||{},i=i||{},jspb.Message.compareExtensions(r,i))}if(e.constructor===Object)return jspb.Message.compareExtensions(e,t);throw Error("Invalid type in JSPB array")},goog.exportProperty(jspb.Message,"compareFields",jspb.Message.compareFields),jspb.Message.prototype.cloneMessage=function(){return jspb.Message.cloneMessage(this)},goog.exportProperty(jspb.Message.prototype,"cloneMessage",jspb.Message.prototype.cloneMessage),jspb.Message.prototype.clone=function(){return jspb.Message.cloneMessage(this)},goog.exportProperty(jspb.Message.prototype,"clone",jspb.Message.prototype.clone),jspb.Message.clone=function(e){return jspb.Message.cloneMessage(e)},goog.exportProperty(jspb.Message,"clone",jspb.Message.clone),jspb.Message.cloneMessage=function(e){return new e.constructor(jspb.Message.clone_(e.toArray()))},jspb.Message.copyInto=function(e,t){jspb.asserts.assertInstanceof(e,jspb.Message),jspb.asserts.assertInstanceof(t,jspb.Message),jspb.asserts.assert(e.constructor==t.constructor,"Copy source and target message should have the same type."),e=jspb.Message.clone(e);for(var n=t.toArray(),r=e.toArray(),i=n.length=0;i<r.length;i++)n[i]=r[i];t.wrappers_=e.wrappers_,t.extensionObject_=e.extensionObject_},goog.exportProperty(jspb.Message,"copyInto",jspb.Message.copyInto),jspb.Message.clone_=function(e){if(Array.isArray(e)){for(var t=Array(e.length),n=0;n<e.length;n++){var r=e[n];null!=r&&(t[n]="object"==typeof r?jspb.Message.clone_(jspb.asserts.assert(r)):r)}return t}if(jspb.Message.SUPPORTS_UINT8ARRAY_&&e instanceof Uint8Array)return new Uint8Array(e);for(n in t={},e)null!=(r=e[n])&&(t[n]="object"==typeof r?jspb.Message.clone_(jspb.asserts.assert(r)):r);return t},jspb.Message.registerMessageType=function(e,t){t.messageId=e},goog.exportProperty(jspb.Message,"registerMessageType",jspb.Message.registerMessageType),jspb.Message.messageSetExtensions={},jspb.Message.messageSetExtensionsBinary={},jspb.Export={},exports.Map=jspb.Map,exports.Message=jspb.Message,exports.BinaryReader=jspb.BinaryReader,exports.BinaryWriter=jspb.BinaryWriter,exports.ExtensionFieldInfo=jspb.ExtensionFieldInfo,exports.ExtensionFieldBinaryInfo=jspb.ExtensionFieldBinaryInfo,exports.exportSymbol=goog.exportSymbol,exports.inherits=goog.inherits,exports.object={extend:goog.object.extend},exports.typeOf=goog.typeOf})(googleProtobuf);var calculator_options_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.CalculatorOptions",null,r),proto.mediapipe.CalculatorOptions=function(e){t.Message.initialize(this,e,0,2,null,null)},n.inherits(proto.mediapipe.CalculatorOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.CalculatorOptions.displayName="proto.mediapipe.CalculatorOptions"),proto.mediapipe.CalculatorOptions.extensions={},proto.mediapipe.CalculatorOptions.extensionsBinary={},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.CalculatorOptions.prototype.toObject=function(e){return proto.mediapipe.CalculatorOptions.toObject(e,this)},proto.mediapipe.CalculatorOptions.toObject=function(e,n){var r,i={mergeFields:null==(r=t.Message.getBooleanField(n,1))?void 0:r};return t.Message.toObjectExtension(n,i,proto.mediapipe.CalculatorOptions.extensions,proto.mediapipe.CalculatorOptions.prototype.getExtension,e),e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.CalculatorOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.CalculatorOptions;return proto.mediapipe.CalculatorOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.CalculatorOptions.deserializeBinaryFromReader=function(e,n){for(;n.nextField()&&!n.isEndGroup();)if(1===n.getFieldNumber()){var r=n.readBool();e.setMergeFields(r)}else t.Message.readBinaryExtension(e,n,proto.mediapipe.CalculatorOptions.extensionsBinary,proto.mediapipe.CalculatorOptions.prototype.getExtension,proto.mediapipe.CalculatorOptions.prototype.setExtension);return e},proto.mediapipe.CalculatorOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.CalculatorOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.CalculatorOptions.serializeBinaryToWriter=function(e,n){var r;null!=(r=t.Message.getField(e,1))&&n.writeBool(1,r),t.Message.serializeBinaryExtensions(e,n,proto.mediapipe.CalculatorOptions.extensionsBinary,proto.mediapipe.CalculatorOptions.prototype.getExtension)},proto.mediapipe.CalculatorOptions.prototype.getMergeFields=function(){return t.Message.getBooleanFieldWithDefault(this,1,!1)},proto.mediapipe.CalculatorOptions.prototype.setMergeFields=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.CalculatorOptions.prototype.clearMergeFields=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.CalculatorOptions.prototype.hasMergeFields=function(){return null!=t.Message.getField(this,1)},n.object.extend(e,proto.mediapipe)}(calculator_options_pb);var any_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.google.protobuf.Any",null,r),proto.google.protobuf.Any=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.google.protobuf.Any,t.Message),n.DEBUG&&!COMPILED&&(proto.google.protobuf.Any.displayName="proto.google.protobuf.Any"),t.Message.GENERATE_TO_OBJECT&&(proto.google.protobuf.Any.prototype.toObject=function(e){return proto.google.protobuf.Any.toObject(e,this)},proto.google.protobuf.Any.toObject=function(e,n){var r={typeUrl:t.Message.getFieldWithDefault(n,1,""),value:n.getValue_asB64()};return e&&(r.$jspbMessageInstance=n),r}),proto.google.protobuf.Any.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.google.protobuf.Any;return proto.google.protobuf.Any.deserializeBinaryFromReader(r,n)},proto.google.protobuf.Any.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.setTypeUrl(n);break;case 2:n=t.readBytes(),e.setValue(n);break;default:t.skipField()}return e},proto.google.protobuf.Any.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.google.protobuf.Any.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.google.protobuf.Any.serializeBinaryToWriter=function(e,t){var n=void 0;(n=e.getTypeUrl()).length>0&&t.writeString(1,n),(n=e.getValue_asU8()).length>0&&t.writeBytes(2,n)},proto.google.protobuf.Any.prototype.getTypeUrl=function(){return t.Message.getFieldWithDefault(this,1,"")},proto.google.protobuf.Any.prototype.setTypeUrl=function(e){return t.Message.setProto3StringField(this,1,e)},proto.google.protobuf.Any.prototype.getValue=function(){return t.Message.getFieldWithDefault(this,2,"")},proto.google.protobuf.Any.prototype.getValue_asB64=function(){return t.Message.bytesAsB64(this.getValue())},proto.google.protobuf.Any.prototype.getValue_asU8=function(){return t.Message.bytesAsU8(this.getValue())},proto.google.protobuf.Any.prototype.setValue=function(e){return t.Message.setProto3BytesField(this,2,e)},n.object.extend(e,proto.google.protobuf),proto.google.protobuf.Any.prototype.getTypeName=function(){return this.getTypeUrl().split("/").pop()},proto.google.protobuf.Any.prototype.pack=function(e,t,n){n||(n="type.googleapis.com/"),"/"!=n.substr(-1)?this.setTypeUrl(n+"/"+t):this.setTypeUrl(n+t),this.setValue(e)},proto.google.protobuf.Any.prototype.unpack=function(e,t){return this.getTypeName()==t?e(this.getValue_asU8()):null}}(any_pb);var mediapipe_options_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.MediaPipeOptions",null,r),proto.mediapipe.MediaPipeOptions=function(e){t.Message.initialize(this,e,0,1,null,null)},n.inherits(proto.mediapipe.MediaPipeOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.MediaPipeOptions.displayName="proto.mediapipe.MediaPipeOptions"),proto.mediapipe.MediaPipeOptions.extensions={},proto.mediapipe.MediaPipeOptions.extensionsBinary={},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.MediaPipeOptions.prototype.toObject=function(e){return proto.mediapipe.MediaPipeOptions.toObject(e,this)},proto.mediapipe.MediaPipeOptions.toObject=function(e,n){var r={};return t.Message.toObjectExtension(n,r,proto.mediapipe.MediaPipeOptions.extensions,proto.mediapipe.MediaPipeOptions.prototype.getExtension,e),e&&(r.$jspbMessageInstance=n),r}),proto.mediapipe.MediaPipeOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.MediaPipeOptions;return proto.mediapipe.MediaPipeOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.MediaPipeOptions.deserializeBinaryFromReader=function(e,n){for(;n.nextField()&&!n.isEndGroup();)n.getFieldNumber(),t.Message.readBinaryExtension(e,n,proto.mediapipe.MediaPipeOptions.extensionsBinary,proto.mediapipe.MediaPipeOptions.prototype.getExtension,proto.mediapipe.MediaPipeOptions.prototype.setExtension);return e},proto.mediapipe.MediaPipeOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.MediaPipeOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.MediaPipeOptions.serializeBinaryToWriter=function(e,n){t.Message.serializeBinaryExtensions(e,n,proto.mediapipe.MediaPipeOptions.extensionsBinary,proto.mediapipe.MediaPipeOptions.prototype.getExtension)},n.object.extend(e,proto.mediapipe)}(mediapipe_options_pb);var packet_factory_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.PacketFactoryConfig",null,r),n.exportSymbol("proto.mediapipe.PacketFactoryOptions",null,r),n.exportSymbol("proto.mediapipe.PacketManagerConfig",null,r),proto.mediapipe.PacketFactoryOptions=function(e){t.Message.initialize(this,e,0,1,null,null)},n.inherits(proto.mediapipe.PacketFactoryOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.PacketFactoryOptions.displayName="proto.mediapipe.PacketFactoryOptions"),proto.mediapipe.PacketFactoryOptions.extensions={},proto.mediapipe.PacketFactoryOptions.extensionsBinary={},proto.mediapipe.PacketFactoryConfig=function(e){t.Message.initialize(this,e,0,500,null,null)},n.inherits(proto.mediapipe.PacketFactoryConfig,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.PacketFactoryConfig.displayName="proto.mediapipe.PacketFactoryConfig"),proto.mediapipe.PacketManagerConfig=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.PacketManagerConfig.repeatedFields_,null)},n.inherits(proto.mediapipe.PacketManagerConfig,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.PacketManagerConfig.displayName="proto.mediapipe.PacketManagerConfig"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.PacketFactoryOptions.prototype.toObject=function(e){return proto.mediapipe.PacketFactoryOptions.toObject(e,this)},proto.mediapipe.PacketFactoryOptions.toObject=function(e,n){var r={};return t.Message.toObjectExtension(n,r,proto.mediapipe.PacketFactoryOptions.extensions,proto.mediapipe.PacketFactoryOptions.prototype.getExtension,e),e&&(r.$jspbMessageInstance=n),r}),proto.mediapipe.PacketFactoryOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.PacketFactoryOptions;return proto.mediapipe.PacketFactoryOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.PacketFactoryOptions.deserializeBinaryFromReader=function(e,n){for(;n.nextField()&&!n.isEndGroup();)n.getFieldNumber(),t.Message.readBinaryExtension(e,n,proto.mediapipe.PacketFactoryOptions.extensionsBinary,proto.mediapipe.PacketFactoryOptions.prototype.getExtension,proto.mediapipe.PacketFactoryOptions.prototype.setExtension);return e},proto.mediapipe.PacketFactoryOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.PacketFactoryOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.PacketFactoryOptions.serializeBinaryToWriter=function(e,n){t.Message.serializeBinaryExtensions(e,n,proto.mediapipe.PacketFactoryOptions.extensionsBinary,proto.mediapipe.PacketFactoryOptions.prototype.getExtension)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.PacketFactoryConfig.prototype.toObject=function(e){return proto.mediapipe.PacketFactoryConfig.toObject(e,this)},proto.mediapipe.PacketFactoryConfig.toObject=function(e,n){var r,i={packetFactory:null==(r=t.Message.getField(n,1))?void 0:r,outputSidePacket:null==(r=t.Message.getField(n,2))?void 0:r,externalOutput:null==(r=t.Message.getField(n,1002))?void 0:r,options:(r=n.getOptions())&&proto.mediapipe.PacketFactoryOptions.toObject(e,r)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.PacketFactoryConfig.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.PacketFactoryConfig;return proto.mediapipe.PacketFactoryConfig.deserializeBinaryFromReader(r,n)},proto.mediapipe.PacketFactoryConfig.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.setPacketFactory(n);break;case 2:n=t.readString(),e.setOutputSidePacket(n);break;case 1002:n=t.readString(),e.setExternalOutput(n);break;case 3:n=new proto.mediapipe.PacketFactoryOptions,t.readMessage(n,proto.mediapipe.PacketFactoryOptions.deserializeBinaryFromReader),e.setOptions(n);break;default:t.skipField()}return e},proto.mediapipe.PacketFactoryConfig.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.PacketFactoryConfig.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.PacketFactoryConfig.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeString(1,r),null!=(r=t.Message.getField(e,2))&&n.writeString(2,r),null!=(r=t.Message.getField(e,1002))&&n.writeString(1002,r),null!=(r=e.getOptions())&&n.writeMessage(3,r,proto.mediapipe.PacketFactoryOptions.serializeBinaryToWriter)},proto.mediapipe.PacketFactoryConfig.prototype.getPacketFactory=function(){return t.Message.getFieldWithDefault(this,1,"")},proto.mediapipe.PacketFactoryConfig.prototype.setPacketFactory=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.PacketFactoryConfig.prototype.clearPacketFactory=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.PacketFactoryConfig.prototype.hasPacketFactory=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.PacketFactoryConfig.prototype.getOutputSidePacket=function(){return t.Message.getFieldWithDefault(this,2,"")},proto.mediapipe.PacketFactoryConfig.prototype.setOutputSidePacket=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.PacketFactoryConfig.prototype.clearOutputSidePacket=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.PacketFactoryConfig.prototype.hasOutputSidePacket=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.PacketFactoryConfig.prototype.getExternalOutput=function(){return t.Message.getFieldWithDefault(this,1002,"")},proto.mediapipe.PacketFactoryConfig.prototype.setExternalOutput=function(e){return t.Message.setField(this,1002,e)},proto.mediapipe.PacketFactoryConfig.prototype.clearExternalOutput=function(){return t.Message.setField(this,1002,void 0)},proto.mediapipe.PacketFactoryConfig.prototype.hasExternalOutput=function(){return null!=t.Message.getField(this,1002)},proto.mediapipe.PacketFactoryConfig.prototype.getOptions=function(){return t.Message.getWrapperField(this,proto.mediapipe.PacketFactoryOptions,3)},proto.mediapipe.PacketFactoryConfig.prototype.setOptions=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.PacketFactoryConfig.prototype.clearOptions=function(){return this.setOptions(void 0)},proto.mediapipe.PacketFactoryConfig.prototype.hasOptions=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.PacketManagerConfig.repeatedFields_=[1],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.PacketManagerConfig.prototype.toObject=function(e){return proto.mediapipe.PacketManagerConfig.toObject(e,this)},proto.mediapipe.PacketManagerConfig.toObject=function(e,n){var r={packetList:t.Message.toObjectList(n.getPacketList(),proto.mediapipe.PacketFactoryConfig.toObject,e)};return e&&(r.$jspbMessageInstance=n),r}),proto.mediapipe.PacketManagerConfig.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.PacketManagerConfig;return proto.mediapipe.PacketManagerConfig.deserializeBinaryFromReader(r,n)},proto.mediapipe.PacketManagerConfig.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=new proto.mediapipe.PacketFactoryConfig;t.readMessage(n,proto.mediapipe.PacketFactoryConfig.deserializeBinaryFromReader),e.addPacket(n)}else t.skipField();return e},proto.mediapipe.PacketManagerConfig.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.PacketManagerConfig.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.PacketManagerConfig.serializeBinaryToWriter=function(e,t){var n;(n=e.getPacketList()).length>0&&t.writeRepeatedMessage(1,n,proto.mediapipe.PacketFactoryConfig.serializeBinaryToWriter)},proto.mediapipe.PacketManagerConfig.prototype.getPacketList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.PacketFactoryConfig,1)},proto.mediapipe.PacketManagerConfig.prototype.setPacketList=function(e){return t.Message.setRepeatedWrapperField(this,1,e)},proto.mediapipe.PacketManagerConfig.prototype.addPacket=function(e,n){return t.Message.addToRepeatedWrapperField(this,1,e,proto.mediapipe.PacketFactoryConfig,n)},proto.mediapipe.PacketManagerConfig.prototype.clearPacketList=function(){return this.setPacketList([])},n.object.extend(e,proto.mediapipe)}(packet_factory_pb);var packet_generator_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.PacketGeneratorConfig",null,r),n.exportSymbol("proto.mediapipe.PacketGeneratorOptions",null,r),proto.mediapipe.PacketGeneratorOptions=function(e){t.Message.initialize(this,e,0,2,null,null)},n.inherits(proto.mediapipe.PacketGeneratorOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.PacketGeneratorOptions.displayName="proto.mediapipe.PacketGeneratorOptions"),proto.mediapipe.PacketGeneratorOptions.extensions={},proto.mediapipe.PacketGeneratorOptions.extensionsBinary={},proto.mediapipe.PacketGeneratorConfig=function(e){t.Message.initialize(this,e,0,500,proto.mediapipe.PacketGeneratorConfig.repeatedFields_,null)},n.inherits(proto.mediapipe.PacketGeneratorConfig,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.PacketGeneratorConfig.displayName="proto.mediapipe.PacketGeneratorConfig"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.PacketGeneratorOptions.prototype.toObject=function(e){return proto.mediapipe.PacketGeneratorOptions.toObject(e,this)},proto.mediapipe.PacketGeneratorOptions.toObject=function(e,n){var r={mergeFields:t.Message.getBooleanFieldWithDefault(n,1,!0)};return t.Message.toObjectExtension(n,r,proto.mediapipe.PacketGeneratorOptions.extensions,proto.mediapipe.PacketGeneratorOptions.prototype.getExtension,e),e&&(r.$jspbMessageInstance=n),r}),proto.mediapipe.PacketGeneratorOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.PacketGeneratorOptions;return proto.mediapipe.PacketGeneratorOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.PacketGeneratorOptions.deserializeBinaryFromReader=function(e,n){for(;n.nextField()&&!n.isEndGroup();)if(1===n.getFieldNumber()){var r=n.readBool();e.setMergeFields(r)}else t.Message.readBinaryExtension(e,n,proto.mediapipe.PacketGeneratorOptions.extensionsBinary,proto.mediapipe.PacketGeneratorOptions.prototype.getExtension,proto.mediapipe.PacketGeneratorOptions.prototype.setExtension);return e},proto.mediapipe.PacketGeneratorOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.PacketGeneratorOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.PacketGeneratorOptions.serializeBinaryToWriter=function(e,n){var r;null!=(r=t.Message.getField(e,1))&&n.writeBool(1,r),t.Message.serializeBinaryExtensions(e,n,proto.mediapipe.PacketGeneratorOptions.extensionsBinary,proto.mediapipe.PacketGeneratorOptions.prototype.getExtension)},proto.mediapipe.PacketGeneratorOptions.prototype.getMergeFields=function(){return t.Message.getBooleanFieldWithDefault(this,1,!0)},proto.mediapipe.PacketGeneratorOptions.prototype.setMergeFields=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.PacketGeneratorOptions.prototype.clearMergeFields=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.PacketGeneratorOptions.prototype.hasMergeFields=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.PacketGeneratorConfig.repeatedFields_=[2,1002,3,1003],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.PacketGeneratorConfig.prototype.toObject=function(e){return proto.mediapipe.PacketGeneratorConfig.toObject(e,this)},proto.mediapipe.PacketGeneratorConfig.toObject=function(e,n){var r,i={packetGenerator:null==(r=t.Message.getField(n,1))?void 0:r,inputSidePacketList:null==(r=t.Message.getRepeatedField(n,2))?void 0:r,externalInputList:null==(r=t.Message.getRepeatedField(n,1002))?void 0:r,outputSidePacketList:null==(r=t.Message.getRepeatedField(n,3))?void 0:r,externalOutputList:null==(r=t.Message.getRepeatedField(n,1003))?void 0:r,options:(r=n.getOptions())&&proto.mediapipe.PacketGeneratorOptions.toObject(e,r)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.PacketGeneratorConfig.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.PacketGeneratorConfig;return proto.mediapipe.PacketGeneratorConfig.deserializeBinaryFromReader(r,n)},proto.mediapipe.PacketGeneratorConfig.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.setPacketGenerator(n);break;case 2:n=t.readString(),e.addInputSidePacket(n);break;case 1002:n=t.readString(),e.addExternalInput(n);break;case 3:n=t.readString(),e.addOutputSidePacket(n);break;case 1003:n=t.readString(),e.addExternalOutput(n);break;case 4:n=new proto.mediapipe.PacketGeneratorOptions,t.readMessage(n,proto.mediapipe.PacketGeneratorOptions.deserializeBinaryFromReader),e.setOptions(n);break;default:t.skipField()}return e},proto.mediapipe.PacketGeneratorConfig.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.PacketGeneratorConfig.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.PacketGeneratorConfig.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeString(1,r),(r=e.getInputSidePacketList()).length>0&&n.writeRepeatedString(2,r),(r=e.getExternalInputList()).length>0&&n.writeRepeatedString(1002,r),(r=e.getOutputSidePacketList()).length>0&&n.writeRepeatedString(3,r),(r=e.getExternalOutputList()).length>0&&n.writeRepeatedString(1003,r),null!=(r=e.getOptions())&&n.writeMessage(4,r,proto.mediapipe.PacketGeneratorOptions.serializeBinaryToWriter)},proto.mediapipe.PacketGeneratorConfig.prototype.getPacketGenerator=function(){return t.Message.getFieldWithDefault(this,1,"")},proto.mediapipe.PacketGeneratorConfig.prototype.setPacketGenerator=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.PacketGeneratorConfig.prototype.clearPacketGenerator=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.PacketGeneratorConfig.prototype.hasPacketGenerator=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.PacketGeneratorConfig.prototype.getInputSidePacketList=function(){return t.Message.getRepeatedField(this,2)},proto.mediapipe.PacketGeneratorConfig.prototype.setInputSidePacketList=function(e){return t.Message.setField(this,2,e||[])},proto.mediapipe.PacketGeneratorConfig.prototype.addInputSidePacket=function(e,n){return t.Message.addToRepeatedField(this,2,e,n)},proto.mediapipe.PacketGeneratorConfig.prototype.clearInputSidePacketList=function(){return this.setInputSidePacketList([])},proto.mediapipe.PacketGeneratorConfig.prototype.getExternalInputList=function(){return t.Message.getRepeatedField(this,1002)},proto.mediapipe.PacketGeneratorConfig.prototype.setExternalInputList=function(e){return t.Message.setField(this,1002,e||[])},proto.mediapipe.PacketGeneratorConfig.prototype.addExternalInput=function(e,n){return t.Message.addToRepeatedField(this,1002,e,n)},proto.mediapipe.PacketGeneratorConfig.prototype.clearExternalInputList=function(){return this.setExternalInputList([])},proto.mediapipe.PacketGeneratorConfig.prototype.getOutputSidePacketList=function(){return t.Message.getRepeatedField(this,3)},proto.mediapipe.PacketGeneratorConfig.prototype.setOutputSidePacketList=function(e){return t.Message.setField(this,3,e||[])},proto.mediapipe.PacketGeneratorConfig.prototype.addOutputSidePacket=function(e,n){return t.Message.addToRepeatedField(this,3,e,n)},proto.mediapipe.PacketGeneratorConfig.prototype.clearOutputSidePacketList=function(){return this.setOutputSidePacketList([])},proto.mediapipe.PacketGeneratorConfig.prototype.getExternalOutputList=function(){return t.Message.getRepeatedField(this,1003)},proto.mediapipe.PacketGeneratorConfig.prototype.setExternalOutputList=function(e){return t.Message.setField(this,1003,e||[])},proto.mediapipe.PacketGeneratorConfig.prototype.addExternalOutput=function(e,n){return t.Message.addToRepeatedField(this,1003,e,n)},proto.mediapipe.PacketGeneratorConfig.prototype.clearExternalOutputList=function(){return this.setExternalOutputList([])},proto.mediapipe.PacketGeneratorConfig.prototype.getOptions=function(){return t.Message.getWrapperField(this,proto.mediapipe.PacketGeneratorOptions,4)},proto.mediapipe.PacketGeneratorConfig.prototype.setOptions=function(e){return t.Message.setWrapperField(this,4,e)},proto.mediapipe.PacketGeneratorConfig.prototype.clearOptions=function(){return this.setOptions(void 0)},proto.mediapipe.PacketGeneratorConfig.prototype.hasOptions=function(){return null!=t.Message.getField(this,4)},n.object.extend(e,proto.mediapipe)}(packet_generator_pb);var status_handler_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=mediapipe_options_pb;n.object.extend(proto,i),n.exportSymbol("proto.mediapipe.StatusHandlerConfig",null,r),proto.mediapipe.StatusHandlerConfig=function(e){t.Message.initialize(this,e,0,500,proto.mediapipe.StatusHandlerConfig.repeatedFields_,null)},n.inherits(proto.mediapipe.StatusHandlerConfig,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.StatusHandlerConfig.displayName="proto.mediapipe.StatusHandlerConfig"),proto.mediapipe.StatusHandlerConfig.repeatedFields_=[2,1002],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.StatusHandlerConfig.prototype.toObject=function(e){return proto.mediapipe.StatusHandlerConfig.toObject(e,this)},proto.mediapipe.StatusHandlerConfig.toObject=function(e,n){var r,o={statusHandler:null==(r=t.Message.getField(n,1))?void 0:r,inputSidePacketList:null==(r=t.Message.getRepeatedField(n,2))?void 0:r,externalInputList:null==(r=t.Message.getRepeatedField(n,1002))?void 0:r,options:(r=n.getOptions())&&i.MediaPipeOptions.toObject(e,r)};return e&&(o.$jspbMessageInstance=n),o}),proto.mediapipe.StatusHandlerConfig.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.StatusHandlerConfig;return proto.mediapipe.StatusHandlerConfig.deserializeBinaryFromReader(r,n)},proto.mediapipe.StatusHandlerConfig.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.setStatusHandler(n);break;case 2:n=t.readString(),e.addInputSidePacket(n);break;case 1002:n=t.readString(),e.addExternalInput(n);break;case 3:n=new i.MediaPipeOptions,t.readMessage(n,i.MediaPipeOptions.deserializeBinaryFromReader),e.setOptions(n);break;default:t.skipField()}return e},proto.mediapipe.StatusHandlerConfig.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.StatusHandlerConfig.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.StatusHandlerConfig.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeString(1,r),(r=e.getInputSidePacketList()).length>0&&n.writeRepeatedString(2,r),(r=e.getExternalInputList()).length>0&&n.writeRepeatedString(1002,r),null!=(r=e.getOptions())&&n.writeMessage(3,r,i.MediaPipeOptions.serializeBinaryToWriter)},proto.mediapipe.StatusHandlerConfig.prototype.getStatusHandler=function(){return t.Message.getFieldWithDefault(this,1,"")},proto.mediapipe.StatusHandlerConfig.prototype.setStatusHandler=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.StatusHandlerConfig.prototype.clearStatusHandler=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.StatusHandlerConfig.prototype.hasStatusHandler=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.StatusHandlerConfig.prototype.getInputSidePacketList=function(){return t.Message.getRepeatedField(this,2)},proto.mediapipe.StatusHandlerConfig.prototype.setInputSidePacketList=function(e){return t.Message.setField(this,2,e||[])},proto.mediapipe.StatusHandlerConfig.prototype.addInputSidePacket=function(e,n){return t.Message.addToRepeatedField(this,2,e,n)},proto.mediapipe.StatusHandlerConfig.prototype.clearInputSidePacketList=function(){return this.setInputSidePacketList([])},proto.mediapipe.StatusHandlerConfig.prototype.getExternalInputList=function(){return t.Message.getRepeatedField(this,1002)},proto.mediapipe.StatusHandlerConfig.prototype.setExternalInputList=function(e){return t.Message.setField(this,1002,e||[])},proto.mediapipe.StatusHandlerConfig.prototype.addExternalInput=function(e,n){return t.Message.addToRepeatedField(this,1002,e,n)},proto.mediapipe.StatusHandlerConfig.prototype.clearExternalInputList=function(){return this.setExternalInputList([])},proto.mediapipe.StatusHandlerConfig.prototype.getOptions=function(){return t.Message.getWrapperField(this,i.MediaPipeOptions,3)},proto.mediapipe.StatusHandlerConfig.prototype.setOptions=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.StatusHandlerConfig.prototype.clearOptions=function(){return this.setOptions(void 0)},proto.mediapipe.StatusHandlerConfig.prototype.hasOptions=function(){return null!=t.Message.getField(this,3)},n.object.extend(e,proto.mediapipe)}(status_handler_pb);var stream_handler_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=mediapipe_options_pb;n.object.extend(proto,i),n.exportSymbol("proto.mediapipe.InputStreamHandlerConfig",null,r),n.exportSymbol("proto.mediapipe.OutputStreamHandlerConfig",null,r),proto.mediapipe.InputStreamHandlerConfig=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.InputStreamHandlerConfig,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.InputStreamHandlerConfig.displayName="proto.mediapipe.InputStreamHandlerConfig"),proto.mediapipe.OutputStreamHandlerConfig=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.OutputStreamHandlerConfig.repeatedFields_,null)},n.inherits(proto.mediapipe.OutputStreamHandlerConfig,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.OutputStreamHandlerConfig.displayName="proto.mediapipe.OutputStreamHandlerConfig"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.InputStreamHandlerConfig.prototype.toObject=function(e){return proto.mediapipe.InputStreamHandlerConfig.toObject(e,this)},proto.mediapipe.InputStreamHandlerConfig.toObject=function(e,n){var r,o={inputStreamHandler:t.Message.getFieldWithDefault(n,1,"DefaultInputStreamHandler"),options:(r=n.getOptions())&&i.MediaPipeOptions.toObject(e,r)};return e&&(o.$jspbMessageInstance=n),o}),proto.mediapipe.InputStreamHandlerConfig.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.InputStreamHandlerConfig;return proto.mediapipe.InputStreamHandlerConfig.deserializeBinaryFromReader(r,n)},proto.mediapipe.InputStreamHandlerConfig.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.setInputStreamHandler(n);break;case 3:n=new i.MediaPipeOptions,t.readMessage(n,i.MediaPipeOptions.deserializeBinaryFromReader),e.setOptions(n);break;default:t.skipField()}return e},proto.mediapipe.InputStreamHandlerConfig.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.InputStreamHandlerConfig.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.InputStreamHandlerConfig.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeString(1,r),null!=(r=e.getOptions())&&n.writeMessage(3,r,i.MediaPipeOptions.serializeBinaryToWriter)},proto.mediapipe.InputStreamHandlerConfig.prototype.getInputStreamHandler=function(){return t.Message.getFieldWithDefault(this,1,"DefaultInputStreamHandler")},proto.mediapipe.InputStreamHandlerConfig.prototype.setInputStreamHandler=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.InputStreamHandlerConfig.prototype.clearInputStreamHandler=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.InputStreamHandlerConfig.prototype.hasInputStreamHandler=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.InputStreamHandlerConfig.prototype.getOptions=function(){return t.Message.getWrapperField(this,i.MediaPipeOptions,3)},proto.mediapipe.InputStreamHandlerConfig.prototype.setOptions=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.InputStreamHandlerConfig.prototype.clearOptions=function(){return this.setOptions(void 0)},proto.mediapipe.InputStreamHandlerConfig.prototype.hasOptions=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.OutputStreamHandlerConfig.repeatedFields_=[2],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.OutputStreamHandlerConfig.prototype.toObject=function(e){return proto.mediapipe.OutputStreamHandlerConfig.toObject(e,this)},proto.mediapipe.OutputStreamHandlerConfig.toObject=function(e,n){var r,o={outputStreamHandler:t.Message.getFieldWithDefault(n,1,"InOrderOutputStreamHandler"),inputSidePacketList:null==(r=t.Message.getRepeatedField(n,2))?void 0:r,options:(r=n.getOptions())&&i.MediaPipeOptions.toObject(e,r)};return e&&(o.$jspbMessageInstance=n),o}),proto.mediapipe.OutputStreamHandlerConfig.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.OutputStreamHandlerConfig;return proto.mediapipe.OutputStreamHandlerConfig.deserializeBinaryFromReader(r,n)},proto.mediapipe.OutputStreamHandlerConfig.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.setOutputStreamHandler(n);break;case 2:n=t.readString(),e.addInputSidePacket(n);break;case 3:n=new i.MediaPipeOptions,t.readMessage(n,i.MediaPipeOptions.deserializeBinaryFromReader),e.setOptions(n);break;default:t.skipField()}return e},proto.mediapipe.OutputStreamHandlerConfig.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.OutputStreamHandlerConfig.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.OutputStreamHandlerConfig.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeString(1,r),(r=e.getInputSidePacketList()).length>0&&n.writeRepeatedString(2,r),null!=(r=e.getOptions())&&n.writeMessage(3,r,i.MediaPipeOptions.serializeBinaryToWriter)},proto.mediapipe.OutputStreamHandlerConfig.prototype.getOutputStreamHandler=function(){return t.Message.getFieldWithDefault(this,1,"InOrderOutputStreamHandler")},proto.mediapipe.OutputStreamHandlerConfig.prototype.setOutputStreamHandler=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.OutputStreamHandlerConfig.prototype.clearOutputStreamHandler=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.OutputStreamHandlerConfig.prototype.hasOutputStreamHandler=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.OutputStreamHandlerConfig.prototype.getInputSidePacketList=function(){return t.Message.getRepeatedField(this,2)},proto.mediapipe.OutputStreamHandlerConfig.prototype.setInputSidePacketList=function(e){return t.Message.setField(this,2,e||[])},proto.mediapipe.OutputStreamHandlerConfig.prototype.addInputSidePacket=function(e,n){return t.Message.addToRepeatedField(this,2,e,n)},proto.mediapipe.OutputStreamHandlerConfig.prototype.clearInputSidePacketList=function(){return this.setInputSidePacketList([])},proto.mediapipe.OutputStreamHandlerConfig.prototype.getOptions=function(){return t.Message.getWrapperField(this,i.MediaPipeOptions,3)},proto.mediapipe.OutputStreamHandlerConfig.prototype.setOptions=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.OutputStreamHandlerConfig.prototype.clearOptions=function(){return this.setOptions(void 0)},proto.mediapipe.OutputStreamHandlerConfig.prototype.hasOptions=function(){return null!=t.Message.getField(this,3)},n.object.extend(e,proto.mediapipe)}(stream_handler_pb),function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_options_pb;n.object.extend(proto,i);var o=any_pb;n.object.extend(proto,o);var a=mediapipe_options_pb;n.object.extend(proto,a);var s=packet_factory_pb;n.object.extend(proto,s);var u=packet_generator_pb;n.object.extend(proto,u);var l=status_handler_pb;n.object.extend(proto,l);var c=stream_handler_pb;n.object.extend(proto,c),n.exportSymbol("proto.mediapipe.CalculatorGraphConfig",null,r),n.exportSymbol("proto.mediapipe.CalculatorGraphConfig.Node",null,r),n.exportSymbol("proto.mediapipe.ExecutorConfig",null,r),n.exportSymbol("proto.mediapipe.InputCollection",null,r),n.exportSymbol("proto.mediapipe.InputCollection.InputType",null,r),n.exportSymbol("proto.mediapipe.InputCollectionSet",null,r),n.exportSymbol("proto.mediapipe.InputStreamInfo",null,r),n.exportSymbol("proto.mediapipe.ProfilerConfig",null,r),proto.mediapipe.ExecutorConfig=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.ExecutorConfig,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.ExecutorConfig.displayName="proto.mediapipe.ExecutorConfig"),proto.mediapipe.InputCollection=function(e){t.Message.initialize(this,e,0,500,proto.mediapipe.InputCollection.repeatedFields_,null)},n.inherits(proto.mediapipe.InputCollection,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.InputCollection.displayName="proto.mediapipe.InputCollection"),proto.mediapipe.InputCollectionSet=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.InputCollectionSet.repeatedFields_,null)},n.inherits(proto.mediapipe.InputCollectionSet,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.InputCollectionSet.displayName="proto.mediapipe.InputCollectionSet"),proto.mediapipe.InputStreamInfo=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.InputStreamInfo,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.InputStreamInfo.displayName="proto.mediapipe.InputStreamInfo"),proto.mediapipe.ProfilerConfig=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.ProfilerConfig.repeatedFields_,null)},n.inherits(proto.mediapipe.ProfilerConfig,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.ProfilerConfig.displayName="proto.mediapipe.ProfilerConfig"),proto.mediapipe.CalculatorGraphConfig=function(e){t.Message.initialize(this,e,0,500,proto.mediapipe.CalculatorGraphConfig.repeatedFields_,null)},n.inherits(proto.mediapipe.CalculatorGraphConfig,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.CalculatorGraphConfig.displayName="proto.mediapipe.CalculatorGraphConfig"),proto.mediapipe.CalculatorGraphConfig.Node=function(e){t.Message.initialize(this,e,0,500,proto.mediapipe.CalculatorGraphConfig.Node.repeatedFields_,null)},n.inherits(proto.mediapipe.CalculatorGraphConfig.Node,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.CalculatorGraphConfig.Node.displayName="proto.mediapipe.CalculatorGraphConfig.Node"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.ExecutorConfig.prototype.toObject=function(e){return proto.mediapipe.ExecutorConfig.toObject(e,this)},proto.mediapipe.ExecutorConfig.toObject=function(e,n){var r,i={name:t.Message.getFieldWithDefault(n,1,""),type:t.Message.getFieldWithDefault(n,2,""),options:(r=n.getOptions())&&a.MediaPipeOptions.toObject(e,r)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.ExecutorConfig.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.ExecutorConfig;return proto.mediapipe.ExecutorConfig.deserializeBinaryFromReader(r,n)},proto.mediapipe.ExecutorConfig.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.setName(n);break;case 2:n=t.readString(),e.setType(n);break;case 3:n=new a.MediaPipeOptions,t.readMessage(n,a.MediaPipeOptions.deserializeBinaryFromReader),e.setOptions(n);break;default:t.skipField()}return e},proto.mediapipe.ExecutorConfig.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.ExecutorConfig.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.ExecutorConfig.serializeBinaryToWriter=function(e,t){var n=void 0;(n=e.getName()).length>0&&t.writeString(1,n),(n=e.getType()).length>0&&t.writeString(2,n),null!=(n=e.getOptions())&&t.writeMessage(3,n,a.MediaPipeOptions.serializeBinaryToWriter)},proto.mediapipe.ExecutorConfig.prototype.getName=function(){return t.Message.getFieldWithDefault(this,1,"")},proto.mediapipe.ExecutorConfig.prototype.setName=function(e){return t.Message.setProto3StringField(this,1,e)},proto.mediapipe.ExecutorConfig.prototype.getType=function(){return t.Message.getFieldWithDefault(this,2,"")},proto.mediapipe.ExecutorConfig.prototype.setType=function(e){return t.Message.setProto3StringField(this,2,e)},proto.mediapipe.ExecutorConfig.prototype.getOptions=function(){return t.Message.getWrapperField(this,a.MediaPipeOptions,3)},proto.mediapipe.ExecutorConfig.prototype.setOptions=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.ExecutorConfig.prototype.clearOptions=function(){return this.setOptions(void 0)},proto.mediapipe.ExecutorConfig.prototype.hasOptions=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.InputCollection.repeatedFields_=[2,1002],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.InputCollection.prototype.toObject=function(e){return proto.mediapipe.InputCollection.toObject(e,this)},proto.mediapipe.InputCollection.toObject=function(e,n){var r,i={name:t.Message.getFieldWithDefault(n,1,""),sidePacketNameList:null==(r=t.Message.getRepeatedField(n,2))?void 0:r,externalInputNameList:null==(r=t.Message.getRepeatedField(n,1002))?void 0:r,inputType:t.Message.getFieldWithDefault(n,3,0),fileName:t.Message.getFieldWithDefault(n,4,"")};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.InputCollection.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.InputCollection;return proto.mediapipe.InputCollection.deserializeBinaryFromReader(r,n)},proto.mediapipe.InputCollection.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.setName(n);break;case 2:n=t.readString(),e.addSidePacketName(n);break;case 1002:n=t.readString(),e.addExternalInputName(n);break;case 3:n=t.readEnum(),e.setInputType(n);break;case 4:n=t.readString(),e.setFileName(n);break;default:t.skipField()}return e},proto.mediapipe.InputCollection.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.InputCollection.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.InputCollection.serializeBinaryToWriter=function(e,t){var n=void 0;(n=e.getName()).length>0&&t.writeString(1,n),(n=e.getSidePacketNameList()).length>0&&t.writeRepeatedString(2,n),(n=e.getExternalInputNameList()).length>0&&t.writeRepeatedString(1002,n),0!==(n=e.getInputType())&&t.writeEnum(3,n),(n=e.getFileName()).length>0&&t.writeString(4,n)},proto.mediapipe.InputCollection.InputType={UNKNOWN:0,RECORDIO:1,FOREIGN_RECORDIO:2,FOREIGN_CSV_TEXT:3,INVALID_UPPER_BOUND:4},proto.mediapipe.InputCollection.prototype.getName=function(){return t.Message.getFieldWithDefault(this,1,"")},proto.mediapipe.InputCollection.prototype.setName=function(e){return t.Message.setProto3StringField(this,1,e)},proto.mediapipe.InputCollection.prototype.getSidePacketNameList=function(){return t.Message.getRepeatedField(this,2)},proto.mediapipe.InputCollection.prototype.setSidePacketNameList=function(e){return t.Message.setField(this,2,e||[])},proto.mediapipe.InputCollection.prototype.addSidePacketName=function(e,n){return t.Message.addToRepeatedField(this,2,e,n)},proto.mediapipe.InputCollection.prototype.clearSidePacketNameList=function(){return this.setSidePacketNameList([])},proto.mediapipe.InputCollection.prototype.getExternalInputNameList=function(){return t.Message.getRepeatedField(this,1002)},proto.mediapipe.InputCollection.prototype.setExternalInputNameList=function(e){return t.Message.setField(this,1002,e||[])},proto.mediapipe.InputCollection.prototype.addExternalInputName=function(e,n){return t.Message.addToRepeatedField(this,1002,e,n)},proto.mediapipe.InputCollection.prototype.clearExternalInputNameList=function(){return this.setExternalInputNameList([])},proto.mediapipe.InputCollection.prototype.getInputType=function(){return t.Message.getFieldWithDefault(this,3,0)},proto.mediapipe.InputCollection.prototype.setInputType=function(e){return t.Message.setProto3EnumField(this,3,e)},proto.mediapipe.InputCollection.prototype.getFileName=function(){return t.Message.getFieldWithDefault(this,4,"")},proto.mediapipe.InputCollection.prototype.setFileName=function(e){return t.Message.setProto3StringField(this,4,e)},proto.mediapipe.InputCollectionSet.repeatedFields_=[1],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.InputCollectionSet.prototype.toObject=function(e){return proto.mediapipe.InputCollectionSet.toObject(e,this)},proto.mediapipe.InputCollectionSet.toObject=function(e,n){var r={inputCollectionList:t.Message.toObjectList(n.getInputCollectionList(),proto.mediapipe.InputCollection.toObject,e)};return e&&(r.$jspbMessageInstance=n),r}),proto.mediapipe.InputCollectionSet.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.InputCollectionSet;return proto.mediapipe.InputCollectionSet.deserializeBinaryFromReader(r,n)},proto.mediapipe.InputCollectionSet.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=new proto.mediapipe.InputCollection;t.readMessage(n,proto.mediapipe.InputCollection.deserializeBinaryFromReader),e.addInputCollection(n)}else t.skipField();return e},proto.mediapipe.InputCollectionSet.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.InputCollectionSet.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.InputCollectionSet.serializeBinaryToWriter=function(e,t){var n;(n=e.getInputCollectionList()).length>0&&t.writeRepeatedMessage(1,n,proto.mediapipe.InputCollection.serializeBinaryToWriter)},proto.mediapipe.InputCollectionSet.prototype.getInputCollectionList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.InputCollection,1)},proto.mediapipe.InputCollectionSet.prototype.setInputCollectionList=function(e){return t.Message.setRepeatedWrapperField(this,1,e)},proto.mediapipe.InputCollectionSet.prototype.addInputCollection=function(e,n){return t.Message.addToRepeatedWrapperField(this,1,e,proto.mediapipe.InputCollection,n)},proto.mediapipe.InputCollectionSet.prototype.clearInputCollectionList=function(){return this.setInputCollectionList([])},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.InputStreamInfo.prototype.toObject=function(e){return proto.mediapipe.InputStreamInfo.toObject(e,this)},proto.mediapipe.InputStreamInfo.toObject=function(e,n){var r={tagIndex:t.Message.getFieldWithDefault(n,1,""),backEdge:t.Message.getBooleanFieldWithDefault(n,2,!1)};return e&&(r.$jspbMessageInstance=n),r}),proto.mediapipe.InputStreamInfo.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.InputStreamInfo;return proto.mediapipe.InputStreamInfo.deserializeBinaryFromReader(r,n)},proto.mediapipe.InputStreamInfo.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.setTagIndex(n);break;case 2:n=t.readBool(),e.setBackEdge(n);break;default:t.skipField()}return e},proto.mediapipe.InputStreamInfo.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.InputStreamInfo.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.InputStreamInfo.serializeBinaryToWriter=function(e,t){var n=void 0;(n=e.getTagIndex()).length>0&&t.writeString(1,n),(n=e.getBackEdge())&&t.writeBool(2,n)},proto.mediapipe.InputStreamInfo.prototype.getTagIndex=function(){return t.Message.getFieldWithDefault(this,1,"")},proto.mediapipe.InputStreamInfo.prototype.setTagIndex=function(e){return t.Message.setProto3StringField(this,1,e)},proto.mediapipe.InputStreamInfo.prototype.getBackEdge=function(){return t.Message.getBooleanFieldWithDefault(this,2,!1)},proto.mediapipe.InputStreamInfo.prototype.setBackEdge=function(e){return t.Message.setProto3BooleanField(this,2,e)},proto.mediapipe.ProfilerConfig.repeatedFields_=[8],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.ProfilerConfig.prototype.toObject=function(e){return proto.mediapipe.ProfilerConfig.toObject(e,this)},proto.mediapipe.ProfilerConfig.toObject=function(e,n){var r,i={histogramIntervalSizeUsec:t.Message.getFieldWithDefault(n,1,0),numHistogramIntervals:t.Message.getFieldWithDefault(n,2,0),enableInputOutputLatency:t.Message.getBooleanFieldWithDefault(n,3,!1),enableProfiler:t.Message.getBooleanFieldWithDefault(n,4,!1),enableStreamLatency:t.Message.getBooleanFieldWithDefault(n,5,!1),usePacketTimestampForAddedPacket:t.Message.getBooleanFieldWithDefault(n,6,!1),traceLogCapacity:t.Message.getFieldWithDefault(n,7,0),traceEventTypesDisabledList:null==(r=t.Message.getRepeatedField(n,8))?void 0:r,traceLogPath:t.Message.getFieldWithDefault(n,9,""),traceLogCount:t.Message.getFieldWithDefault(n,10,0),traceLogIntervalUsec:t.Message.getFieldWithDefault(n,11,0),traceLogMarginUsec:t.Message.getFieldWithDefault(n,12,0),traceLogDurationEvents:t.Message.getBooleanFieldWithDefault(n,13,!1),traceLogIntervalCount:t.Message.getFieldWithDefault(n,14,0),traceLogDisabled:t.Message.getBooleanFieldWithDefault(n,15,!1),traceEnabled:t.Message.getBooleanFieldWithDefault(n,16,!1),traceLogInstantEvents:t.Message.getBooleanFieldWithDefault(n,17,!1),calculatorFilter:t.Message.getFieldWithDefault(n,18,"")};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.ProfilerConfig.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.ProfilerConfig;return proto.mediapipe.ProfilerConfig.deserializeBinaryFromReader(r,n)},proto.mediapipe.ProfilerConfig.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readInt64();e.setHistogramIntervalSizeUsec(n);break;case 2:n=t.readInt64(),e.setNumHistogramIntervals(n);break;case 3:n=t.readBool(),e.setEnableInputOutputLatency(n);break;case 4:n=t.readBool(),e.setEnableProfiler(n);break;case 5:n=t.readBool(),e.setEnableStreamLatency(n);break;case 6:n=t.readBool(),e.setUsePacketTimestampForAddedPacket(n);break;case 7:n=t.readInt64(),e.setTraceLogCapacity(n);break;case 8:for(var r=t.isDelimited()?t.readPackedInt32():[t.readInt32()],i=0;i<r.length;i++)e.addTraceEventTypesDisabled(r[i]);break;case 9:n=t.readString(),e.setTraceLogPath(n);break;case 10:n=t.readInt32(),e.setTraceLogCount(n);break;case 11:n=t.readInt64(),e.setTraceLogIntervalUsec(n);break;case 12:n=t.readInt64(),e.setTraceLogMarginUsec(n);break;case 13:n=t.readBool(),e.setTraceLogDurationEvents(n);break;case 14:n=t.readInt32(),e.setTraceLogIntervalCount(n);break;case 15:n=t.readBool(),e.setTraceLogDisabled(n);break;case 16:n=t.readBool(),e.setTraceEnabled(n);break;case 17:n=t.readBool(),e.setTraceLogInstantEvents(n);break;case 18:n=t.readString(),e.setCalculatorFilter(n);break;default:t.skipField()}return e},proto.mediapipe.ProfilerConfig.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.ProfilerConfig.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.ProfilerConfig.serializeBinaryToWriter=function(e,t){var n=void 0;0!==(n=e.getHistogramIntervalSizeUsec())&&t.writeInt64(1,n),0!==(n=e.getNumHistogramIntervals())&&t.writeInt64(2,n),(n=e.getEnableInputOutputLatency())&&t.writeBool(3,n),(n=e.getEnableProfiler())&&t.writeBool(4,n),(n=e.getEnableStreamLatency())&&t.writeBool(5,n),(n=e.getUsePacketTimestampForAddedPacket())&&t.writeBool(6,n),0!==(n=e.getTraceLogCapacity())&&t.writeInt64(7,n),(n=e.getTraceEventTypesDisabledList()).length>0&&t.writePackedInt32(8,n),(n=e.getTraceLogPath()).length>0&&t.writeString(9,n),0!==(n=e.getTraceLogCount())&&t.writeInt32(10,n),0!==(n=e.getTraceLogIntervalUsec())&&t.writeInt64(11,n),0!==(n=e.getTraceLogMarginUsec())&&t.writeInt64(12,n),(n=e.getTraceLogDurationEvents())&&t.writeBool(13,n),0!==(n=e.getTraceLogIntervalCount())&&t.writeInt32(14,n),(n=e.getTraceLogDisabled())&&t.writeBool(15,n),(n=e.getTraceEnabled())&&t.writeBool(16,n),(n=e.getTraceLogInstantEvents())&&t.writeBool(17,n),(n=e.getCalculatorFilter()).length>0&&t.writeString(18,n)},proto.mediapipe.ProfilerConfig.prototype.getHistogramIntervalSizeUsec=function(){return t.Message.getFieldWithDefault(this,1,0)},proto.mediapipe.ProfilerConfig.prototype.setHistogramIntervalSizeUsec=function(e){return t.Message.setProto3IntField(this,1,e)},proto.mediapipe.ProfilerConfig.prototype.getNumHistogramIntervals=function(){return t.Message.getFieldWithDefault(this,2,0)},proto.mediapipe.ProfilerConfig.prototype.setNumHistogramIntervals=function(e){return t.Message.setProto3IntField(this,2,e)},proto.mediapipe.ProfilerConfig.prototype.getEnableInputOutputLatency=function(){return t.Message.getBooleanFieldWithDefault(this,3,!1)},proto.mediapipe.ProfilerConfig.prototype.setEnableInputOutputLatency=function(e){return t.Message.setProto3BooleanField(this,3,e)},proto.mediapipe.ProfilerConfig.prototype.getEnableProfiler=function(){return t.Message.getBooleanFieldWithDefault(this,4,!1)},proto.mediapipe.ProfilerConfig.prototype.setEnableProfiler=function(e){return t.Message.setProto3BooleanField(this,4,e)},proto.mediapipe.ProfilerConfig.prototype.getEnableStreamLatency=function(){return t.Message.getBooleanFieldWithDefault(this,5,!1)},proto.mediapipe.ProfilerConfig.prototype.setEnableStreamLatency=function(e){return t.Message.setProto3BooleanField(this,5,e)},proto.mediapipe.ProfilerConfig.prototype.getUsePacketTimestampForAddedPacket=function(){return t.Message.getBooleanFieldWithDefault(this,6,!1)},proto.mediapipe.ProfilerConfig.prototype.setUsePacketTimestampForAddedPacket=function(e){return t.Message.setProto3BooleanField(this,6,e)},proto.mediapipe.ProfilerConfig.prototype.getTraceLogCapacity=function(){return t.Message.getFieldWithDefault(this,7,0)},proto.mediapipe.ProfilerConfig.prototype.setTraceLogCapacity=function(e){return t.Message.setProto3IntField(this,7,e)},proto.mediapipe.ProfilerConfig.prototype.getTraceEventTypesDisabledList=function(){return t.Message.getRepeatedField(this,8)},proto.mediapipe.ProfilerConfig.prototype.setTraceEventTypesDisabledList=function(e){return t.Message.setField(this,8,e||[])},proto.mediapipe.ProfilerConfig.prototype.addTraceEventTypesDisabled=function(e,n){return t.Message.addToRepeatedField(this,8,e,n)},proto.mediapipe.ProfilerConfig.prototype.clearTraceEventTypesDisabledList=function(){return this.setTraceEventTypesDisabledList([])},proto.mediapipe.ProfilerConfig.prototype.getTraceLogPath=function(){return t.Message.getFieldWithDefault(this,9,"")},proto.mediapipe.ProfilerConfig.prototype.setTraceLogPath=function(e){return t.Message.setProto3StringField(this,9,e)},proto.mediapipe.ProfilerConfig.prototype.getTraceLogCount=function(){return t.Message.getFieldWithDefault(this,10,0)},proto.mediapipe.ProfilerConfig.prototype.setTraceLogCount=function(e){return t.Message.setProto3IntField(this,10,e)},proto.mediapipe.ProfilerConfig.prototype.getTraceLogIntervalUsec=function(){return t.Message.getFieldWithDefault(this,11,0)},proto.mediapipe.ProfilerConfig.prototype.setTraceLogIntervalUsec=function(e){return t.Message.setProto3IntField(this,11,e)},proto.mediapipe.ProfilerConfig.prototype.getTraceLogMarginUsec=function(){return t.Message.getFieldWithDefault(this,12,0)},proto.mediapipe.ProfilerConfig.prototype.setTraceLogMarginUsec=function(e){return t.Message.setProto3IntField(this,12,e)},proto.mediapipe.ProfilerConfig.prototype.getTraceLogDurationEvents=function(){return t.Message.getBooleanFieldWithDefault(this,13,!1)},proto.mediapipe.ProfilerConfig.prototype.setTraceLogDurationEvents=function(e){return t.Message.setProto3BooleanField(this,13,e)},proto.mediapipe.ProfilerConfig.prototype.getTraceLogIntervalCount=function(){return t.Message.getFieldWithDefault(this,14,0)},proto.mediapipe.ProfilerConfig.prototype.setTraceLogIntervalCount=function(e){return t.Message.setProto3IntField(this,14,e)},proto.mediapipe.ProfilerConfig.prototype.getTraceLogDisabled=function(){return t.Message.getBooleanFieldWithDefault(this,15,!1)},proto.mediapipe.ProfilerConfig.prototype.setTraceLogDisabled=function(e){return t.Message.setProto3BooleanField(this,15,e)},proto.mediapipe.ProfilerConfig.prototype.getTraceEnabled=function(){return t.Message.getBooleanFieldWithDefault(this,16,!1)},proto.mediapipe.ProfilerConfig.prototype.setTraceEnabled=function(e){return t.Message.setProto3BooleanField(this,16,e)},proto.mediapipe.ProfilerConfig.prototype.getTraceLogInstantEvents=function(){return t.Message.getBooleanFieldWithDefault(this,17,!1)},proto.mediapipe.ProfilerConfig.prototype.setTraceLogInstantEvents=function(e){return t.Message.setProto3BooleanField(this,17,e)},proto.mediapipe.ProfilerConfig.prototype.getCalculatorFilter=function(){return t.Message.getFieldWithDefault(this,18,"")},proto.mediapipe.ProfilerConfig.prototype.setCalculatorFilter=function(e){return t.Message.setProto3StringField(this,18,e)},proto.mediapipe.CalculatorGraphConfig.repeatedFields_=[1,6,7,9,10,15,16,17,14,1002],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.CalculatorGraphConfig.prototype.toObject=function(e){return proto.mediapipe.CalculatorGraphConfig.toObject(e,this)},proto.mediapipe.CalculatorGraphConfig.toObject=function(e,n){var r,i={nodeList:t.Message.toObjectList(n.getNodeList(),proto.mediapipe.CalculatorGraphConfig.Node.toObject,e),packetFactoryList:t.Message.toObjectList(n.getPacketFactoryList(),s.PacketFactoryConfig.toObject,e),packetGeneratorList:t.Message.toObjectList(n.getPacketGeneratorList(),u.PacketGeneratorConfig.toObject,e),numThreads:t.Message.getFieldWithDefault(n,8,0),statusHandlerList:t.Message.toObjectList(n.getStatusHandlerList(),l.StatusHandlerConfig.toObject,e),inputStreamList:null==(r=t.Message.getRepeatedField(n,10))?void 0:r,outputStreamList:null==(r=t.Message.getRepeatedField(n,15))?void 0:r,inputSidePacketList:null==(r=t.Message.getRepeatedField(n,16))?void 0:r,outputSidePacketList:null==(r=t.Message.getRepeatedField(n,17))?void 0:r,maxQueueSize:t.Message.getFieldWithDefault(n,11,0),reportDeadlock:t.Message.getBooleanFieldWithDefault(n,21,!1),inputStreamHandler:(r=n.getInputStreamHandler())&&c.InputStreamHandlerConfig.toObject(e,r),outputStreamHandler:(r=n.getOutputStreamHandler())&&c.OutputStreamHandlerConfig.toObject(e,r),executorList:t.Message.toObjectList(n.getExecutorList(),proto.mediapipe.ExecutorConfig.toObject,e),profilerConfig:(r=n.getProfilerConfig())&&proto.mediapipe.ProfilerConfig.toObject(e,r),pb_package:t.Message.getFieldWithDefault(n,19,""),type:t.Message.getFieldWithDefault(n,20,""),options:(r=n.getOptions())&&a.MediaPipeOptions.toObject(e,r),graphOptionsList:t.Message.toObjectList(n.getGraphOptionsList(),o.Any.toObject,e)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.CalculatorGraphConfig.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.CalculatorGraphConfig;return proto.mediapipe.CalculatorGraphConfig.deserializeBinaryFromReader(r,n)},proto.mediapipe.CalculatorGraphConfig.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new proto.mediapipe.CalculatorGraphConfig.Node;t.readMessage(n,proto.mediapipe.CalculatorGraphConfig.Node.deserializeBinaryFromReader),e.addNode(n);break;case 6:n=new s.PacketFactoryConfig,t.readMessage(n,s.PacketFactoryConfig.deserializeBinaryFromReader),e.addPacketFactory(n);break;case 7:n=new u.PacketGeneratorConfig,t.readMessage(n,u.PacketGeneratorConfig.deserializeBinaryFromReader),e.addPacketGenerator(n);break;case 8:n=t.readInt32(),e.setNumThreads(n);break;case 9:n=new l.StatusHandlerConfig,t.readMessage(n,l.StatusHandlerConfig.deserializeBinaryFromReader),e.addStatusHandler(n);break;case 10:n=t.readString(),e.addInputStream(n);break;case 15:n=t.readString(),e.addOutputStream(n);break;case 16:n=t.readString(),e.addInputSidePacket(n);break;case 17:n=t.readString(),e.addOutputSidePacket(n);break;case 11:n=t.readInt32(),e.setMaxQueueSize(n);break;case 21:n=t.readBool(),e.setReportDeadlock(n);break;case 12:n=new c.InputStreamHandlerConfig,t.readMessage(n,c.InputStreamHandlerConfig.deserializeBinaryFromReader),e.setInputStreamHandler(n);break;case 13:n=new c.OutputStreamHandlerConfig,t.readMessage(n,c.OutputStreamHandlerConfig.deserializeBinaryFromReader),e.setOutputStreamHandler(n);break;case 14:n=new proto.mediapipe.ExecutorConfig,t.readMessage(n,proto.mediapipe.ExecutorConfig.deserializeBinaryFromReader),e.addExecutor(n);break;case 18:n=new proto.mediapipe.ProfilerConfig,t.readMessage(n,proto.mediapipe.ProfilerConfig.deserializeBinaryFromReader),e.setProfilerConfig(n);break;case 19:n=t.readString(),e.setPackage(n);break;case 20:n=t.readString(),e.setType(n);break;case 1001:n=new a.MediaPipeOptions,t.readMessage(n,a.MediaPipeOptions.deserializeBinaryFromReader),e.setOptions(n);break;case 1002:n=new o.Any,t.readMessage(n,o.Any.deserializeBinaryFromReader),e.addGraphOptions(n);break;default:t.skipField()}return e},proto.mediapipe.CalculatorGraphConfig.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.CalculatorGraphConfig.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.CalculatorGraphConfig.serializeBinaryToWriter=function(e,t){var n=void 0;(n=e.getNodeList()).length>0&&t.writeRepeatedMessage(1,n,proto.mediapipe.CalculatorGraphConfig.Node.serializeBinaryToWriter),(n=e.getPacketFactoryList()).length>0&&t.writeRepeatedMessage(6,n,s.PacketFactoryConfig.serializeBinaryToWriter),(n=e.getPacketGeneratorList()).length>0&&t.writeRepeatedMessage(7,n,u.PacketGeneratorConfig.serializeBinaryToWriter),0!==(n=e.getNumThreads())&&t.writeInt32(8,n),(n=e.getStatusHandlerList()).length>0&&t.writeRepeatedMessage(9,n,l.StatusHandlerConfig.serializeBinaryToWriter),(n=e.getInputStreamList()).length>0&&t.writeRepeatedString(10,n),(n=e.getOutputStreamList()).length>0&&t.writeRepeatedString(15,n),(n=e.getInputSidePacketList()).length>0&&t.writeRepeatedString(16,n),(n=e.getOutputSidePacketList()).length>0&&t.writeRepeatedString(17,n),0!==(n=e.getMaxQueueSize())&&t.writeInt32(11,n),(n=e.getReportDeadlock())&&t.writeBool(21,n),null!=(n=e.getInputStreamHandler())&&t.writeMessage(12,n,c.InputStreamHandlerConfig.serializeBinaryToWriter),null!=(n=e.getOutputStreamHandler())&&t.writeMessage(13,n,c.OutputStreamHandlerConfig.serializeBinaryToWriter),(n=e.getExecutorList()).length>0&&t.writeRepeatedMessage(14,n,proto.mediapipe.ExecutorConfig.serializeBinaryToWriter),null!=(n=e.getProfilerConfig())&&t.writeMessage(18,n,proto.mediapipe.ProfilerConfig.serializeBinaryToWriter),(n=e.getPackage()).length>0&&t.writeString(19,n),(n=e.getType()).length>0&&t.writeString(20,n),null!=(n=e.getOptions())&&t.writeMessage(1001,n,a.MediaPipeOptions.serializeBinaryToWriter),(n=e.getGraphOptionsList()).length>0&&t.writeRepeatedMessage(1002,n,o.Any.serializeBinaryToWriter)},proto.mediapipe.CalculatorGraphConfig.Node.repeatedFields_=[3,4,5,6,8,13,17,1005],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.CalculatorGraphConfig.Node.prototype.toObject=function(e){return proto.mediapipe.CalculatorGraphConfig.Node.toObject(e,this)},proto.mediapipe.CalculatorGraphConfig.Node.toObject=function(e,n){var r,a={name:t.Message.getFieldWithDefault(n,1,""),calculator:t.Message.getFieldWithDefault(n,2,""),inputStreamList:null==(r=t.Message.getRepeatedField(n,3))?void 0:r,outputStreamList:null==(r=t.Message.getRepeatedField(n,4))?void 0:r,inputSidePacketList:null==(r=t.Message.getRepeatedField(n,5))?void 0:r,outputSidePacketList:null==(r=t.Message.getRepeatedField(n,6))?void 0:r,options:(r=n.getOptions())&&i.CalculatorOptions.toObject(e,r),nodeOptionsList:t.Message.toObjectList(n.getNodeOptionsList(),o.Any.toObject,e),sourceLayer:t.Message.getFieldWithDefault(n,9,0),bufferSizeHint:t.Message.getFieldWithDefault(n,10,0),inputStreamHandler:(r=n.getInputStreamHandler())&&c.InputStreamHandlerConfig.toObject(e,r),outputStreamHandler:(r=n.getOutputStreamHandler())&&c.OutputStreamHandlerConfig.toObject(e,r),inputStreamInfoList:t.Message.toObjectList(n.getInputStreamInfoList(),proto.mediapipe.InputStreamInfo.toObject,e),executor:t.Message.getFieldWithDefault(n,14,""),profilerConfig:(r=n.getProfilerConfig())&&proto.mediapipe.ProfilerConfig.toObject(e,r),maxInFlight:t.Message.getFieldWithDefault(n,16,0),optionValueList:null==(r=t.Message.getRepeatedField(n,17))?void 0:r,externalInputList:null==(r=t.Message.getRepeatedField(n,1005))?void 0:r};return e&&(a.$jspbMessageInstance=n),a}),proto.mediapipe.CalculatorGraphConfig.Node.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.CalculatorGraphConfig.Node;return proto.mediapipe.CalculatorGraphConfig.Node.deserializeBinaryFromReader(r,n)},proto.mediapipe.CalculatorGraphConfig.Node.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.setName(n);break;case 2:n=t.readString(),e.setCalculator(n);break;case 3:n=t.readString(),e.addInputStream(n);break;case 4:n=t.readString(),e.addOutputStream(n);break;case 5:n=t.readString(),e.addInputSidePacket(n);break;case 6:n=t.readString(),e.addOutputSidePacket(n);break;case 7:n=new i.CalculatorOptions,t.readMessage(n,i.CalculatorOptions.deserializeBinaryFromReader),e.setOptions(n);break;case 8:n=new o.Any,t.readMessage(n,o.Any.deserializeBinaryFromReader),e.addNodeOptions(n);break;case 9:n=t.readInt32(),e.setSourceLayer(n);break;case 10:n=t.readInt32(),e.setBufferSizeHint(n);break;case 11:n=new c.InputStreamHandlerConfig,t.readMessage(n,c.InputStreamHandlerConfig.deserializeBinaryFromReader),e.setInputStreamHandler(n);break;case 12:n=new c.OutputStreamHandlerConfig,t.readMessage(n,c.OutputStreamHandlerConfig.deserializeBinaryFromReader),e.setOutputStreamHandler(n);break;case 13:n=new proto.mediapipe.InputStreamInfo,t.readMessage(n,proto.mediapipe.InputStreamInfo.deserializeBinaryFromReader),e.addInputStreamInfo(n);break;case 14:n=t.readString(),e.setExecutor(n);break;case 15:n=new proto.mediapipe.ProfilerConfig,t.readMessage(n,proto.mediapipe.ProfilerConfig.deserializeBinaryFromReader),e.setProfilerConfig(n);break;case 16:n=t.readInt32(),e.setMaxInFlight(n);break;case 17:n=t.readString(),e.addOptionValue(n);break;case 1005:n=t.readString(),e.addExternalInput(n);break;default:t.skipField()}return e},proto.mediapipe.CalculatorGraphConfig.Node.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.CalculatorGraphConfig.Node.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.CalculatorGraphConfig.Node.serializeBinaryToWriter=function(e,t){var n=void 0;(n=e.getName()).length>0&&t.writeString(1,n),(n=e.getCalculator()).length>0&&t.writeString(2,n),(n=e.getInputStreamList()).length>0&&t.writeRepeatedString(3,n),(n=e.getOutputStreamList()).length>0&&t.writeRepeatedString(4,n),(n=e.getInputSidePacketList()).length>0&&t.writeRepeatedString(5,n),(n=e.getOutputSidePacketList()).length>0&&t.writeRepeatedString(6,n),null!=(n=e.getOptions())&&t.writeMessage(7,n,i.CalculatorOptions.serializeBinaryToWriter),(n=e.getNodeOptionsList()).length>0&&t.writeRepeatedMessage(8,n,o.Any.serializeBinaryToWriter),0!==(n=e.getSourceLayer())&&t.writeInt32(9,n),0!==(n=e.getBufferSizeHint())&&t.writeInt32(10,n),null!=(n=e.getInputStreamHandler())&&t.writeMessage(11,n,c.InputStreamHandlerConfig.serializeBinaryToWriter),null!=(n=e.getOutputStreamHandler())&&t.writeMessage(12,n,c.OutputStreamHandlerConfig.serializeBinaryToWriter),(n=e.getInputStreamInfoList()).length>0&&t.writeRepeatedMessage(13,n,proto.mediapipe.InputStreamInfo.serializeBinaryToWriter),(n=e.getExecutor()).length>0&&t.writeString(14,n),null!=(n=e.getProfilerConfig())&&t.writeMessage(15,n,proto.mediapipe.ProfilerConfig.serializeBinaryToWriter),0!==(n=e.getMaxInFlight())&&t.writeInt32(16,n),(n=e.getOptionValueList()).length>0&&t.writeRepeatedString(17,n),(n=e.getExternalInputList()).length>0&&t.writeRepeatedString(1005,n)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getName=function(){return t.Message.getFieldWithDefault(this,1,"")},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setName=function(e){return t.Message.setProto3StringField(this,1,e)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getCalculator=function(){return t.Message.getFieldWithDefault(this,2,"")},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setCalculator=function(e){return t.Message.setProto3StringField(this,2,e)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getInputStreamList=function(){return t.Message.getRepeatedField(this,3)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setInputStreamList=function(e){return t.Message.setField(this,3,e||[])},proto.mediapipe.CalculatorGraphConfig.Node.prototype.addInputStream=function(e,n){return t.Message.addToRepeatedField(this,3,e,n)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.clearInputStreamList=function(){return this.setInputStreamList([])},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getOutputStreamList=function(){return t.Message.getRepeatedField(this,4)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setOutputStreamList=function(e){return t.Message.setField(this,4,e||[])},proto.mediapipe.CalculatorGraphConfig.Node.prototype.addOutputStream=function(e,n){return t.Message.addToRepeatedField(this,4,e,n)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.clearOutputStreamList=function(){return this.setOutputStreamList([])},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getInputSidePacketList=function(){return t.Message.getRepeatedField(this,5)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setInputSidePacketList=function(e){return t.Message.setField(this,5,e||[])},proto.mediapipe.CalculatorGraphConfig.Node.prototype.addInputSidePacket=function(e,n){return t.Message.addToRepeatedField(this,5,e,n)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.clearInputSidePacketList=function(){return this.setInputSidePacketList([])},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getOutputSidePacketList=function(){return t.Message.getRepeatedField(this,6)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setOutputSidePacketList=function(e){return t.Message.setField(this,6,e||[])},proto.mediapipe.CalculatorGraphConfig.Node.prototype.addOutputSidePacket=function(e,n){return t.Message.addToRepeatedField(this,6,e,n)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.clearOutputSidePacketList=function(){return this.setOutputSidePacketList([])},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getOptions=function(){return t.Message.getWrapperField(this,i.CalculatorOptions,7)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setOptions=function(e){return t.Message.setWrapperField(this,7,e)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.clearOptions=function(){return this.setOptions(void 0)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.hasOptions=function(){return null!=t.Message.getField(this,7)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getNodeOptionsList=function(){return t.Message.getRepeatedWrapperField(this,o.Any,8)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setNodeOptionsList=function(e){return t.Message.setRepeatedWrapperField(this,8,e)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.addNodeOptions=function(e,n){return t.Message.addToRepeatedWrapperField(this,8,e,proto.google.protobuf.Any,n)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.clearNodeOptionsList=function(){return this.setNodeOptionsList([])},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getSourceLayer=function(){return t.Message.getFieldWithDefault(this,9,0)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setSourceLayer=function(e){return t.Message.setProto3IntField(this,9,e)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getBufferSizeHint=function(){return t.Message.getFieldWithDefault(this,10,0)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setBufferSizeHint=function(e){return t.Message.setProto3IntField(this,10,e)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getInputStreamHandler=function(){return t.Message.getWrapperField(this,c.InputStreamHandlerConfig,11)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setInputStreamHandler=function(e){return t.Message.setWrapperField(this,11,e)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.clearInputStreamHandler=function(){return this.setInputStreamHandler(void 0)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.hasInputStreamHandler=function(){return null!=t.Message.getField(this,11)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getOutputStreamHandler=function(){return t.Message.getWrapperField(this,c.OutputStreamHandlerConfig,12)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setOutputStreamHandler=function(e){return t.Message.setWrapperField(this,12,e)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.clearOutputStreamHandler=function(){return this.setOutputStreamHandler(void 0)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.hasOutputStreamHandler=function(){return null!=t.Message.getField(this,12)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getInputStreamInfoList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.InputStreamInfo,13)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setInputStreamInfoList=function(e){return t.Message.setRepeatedWrapperField(this,13,e)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.addInputStreamInfo=function(e,n){return t.Message.addToRepeatedWrapperField(this,13,e,proto.mediapipe.InputStreamInfo,n)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.clearInputStreamInfoList=function(){return this.setInputStreamInfoList([])},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getExecutor=function(){return t.Message.getFieldWithDefault(this,14,"")},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setExecutor=function(e){return t.Message.setProto3StringField(this,14,e)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getProfilerConfig=function(){return t.Message.getWrapperField(this,proto.mediapipe.ProfilerConfig,15)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setProfilerConfig=function(e){return t.Message.setWrapperField(this,15,e)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.clearProfilerConfig=function(){return this.setProfilerConfig(void 0)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.hasProfilerConfig=function(){return null!=t.Message.getField(this,15)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getMaxInFlight=function(){return t.Message.getFieldWithDefault(this,16,0)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setMaxInFlight=function(e){return t.Message.setProto3IntField(this,16,e)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getOptionValueList=function(){return t.Message.getRepeatedField(this,17)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setOptionValueList=function(e){return t.Message.setField(this,17,e||[])},proto.mediapipe.CalculatorGraphConfig.Node.prototype.addOptionValue=function(e,n){return t.Message.addToRepeatedField(this,17,e,n)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.clearOptionValueList=function(){return this.setOptionValueList([])},proto.mediapipe.CalculatorGraphConfig.Node.prototype.getExternalInputList=function(){return t.Message.getRepeatedField(this,1005)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.setExternalInputList=function(e){return t.Message.setField(this,1005,e||[])},proto.mediapipe.CalculatorGraphConfig.Node.prototype.addExternalInput=function(e,n){return t.Message.addToRepeatedField(this,1005,e,n)},proto.mediapipe.CalculatorGraphConfig.Node.prototype.clearExternalInputList=function(){return this.setExternalInputList([])},proto.mediapipe.CalculatorGraphConfig.prototype.getNodeList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.CalculatorGraphConfig.Node,1)},proto.mediapipe.CalculatorGraphConfig.prototype.setNodeList=function(e){return t.Message.setRepeatedWrapperField(this,1,e)},proto.mediapipe.CalculatorGraphConfig.prototype.addNode=function(e,n){return t.Message.addToRepeatedWrapperField(this,1,e,proto.mediapipe.CalculatorGraphConfig.Node,n)},proto.mediapipe.CalculatorGraphConfig.prototype.clearNodeList=function(){return this.setNodeList([])},proto.mediapipe.CalculatorGraphConfig.prototype.getPacketFactoryList=function(){return t.Message.getRepeatedWrapperField(this,s.PacketFactoryConfig,6)},proto.mediapipe.CalculatorGraphConfig.prototype.setPacketFactoryList=function(e){return t.Message.setRepeatedWrapperField(this,6,e)},proto.mediapipe.CalculatorGraphConfig.prototype.addPacketFactory=function(e,n){return t.Message.addToRepeatedWrapperField(this,6,e,proto.mediapipe.PacketFactoryConfig,n)},proto.mediapipe.CalculatorGraphConfig.prototype.clearPacketFactoryList=function(){return this.setPacketFactoryList([])},proto.mediapipe.CalculatorGraphConfig.prototype.getPacketGeneratorList=function(){return t.Message.getRepeatedWrapperField(this,u.PacketGeneratorConfig,7)},proto.mediapipe.CalculatorGraphConfig.prototype.setPacketGeneratorList=function(e){return t.Message.setRepeatedWrapperField(this,7,e)},proto.mediapipe.CalculatorGraphConfig.prototype.addPacketGenerator=function(e,n){return t.Message.addToRepeatedWrapperField(this,7,e,proto.mediapipe.PacketGeneratorConfig,n)},proto.mediapipe.CalculatorGraphConfig.prototype.clearPacketGeneratorList=function(){return this.setPacketGeneratorList([])},proto.mediapipe.CalculatorGraphConfig.prototype.getNumThreads=function(){return t.Message.getFieldWithDefault(this,8,0)},proto.mediapipe.CalculatorGraphConfig.prototype.setNumThreads=function(e){return t.Message.setProto3IntField(this,8,e)},proto.mediapipe.CalculatorGraphConfig.prototype.getStatusHandlerList=function(){return t.Message.getRepeatedWrapperField(this,l.StatusHandlerConfig,9)},proto.mediapipe.CalculatorGraphConfig.prototype.setStatusHandlerList=function(e){return t.Message.setRepeatedWrapperField(this,9,e)},proto.mediapipe.CalculatorGraphConfig.prototype.addStatusHandler=function(e,n){return t.Message.addToRepeatedWrapperField(this,9,e,proto.mediapipe.StatusHandlerConfig,n)},proto.mediapipe.CalculatorGraphConfig.prototype.clearStatusHandlerList=function(){return this.setStatusHandlerList([])},proto.mediapipe.CalculatorGraphConfig.prototype.getInputStreamList=function(){return t.Message.getRepeatedField(this,10)},proto.mediapipe.CalculatorGraphConfig.prototype.setInputStreamList=function(e){return t.Message.setField(this,10,e||[])},proto.mediapipe.CalculatorGraphConfig.prototype.addInputStream=function(e,n){return t.Message.addToRepeatedField(this,10,e,n)},proto.mediapipe.CalculatorGraphConfig.prototype.clearInputStreamList=function(){return this.setInputStreamList([])},proto.mediapipe.CalculatorGraphConfig.prototype.getOutputStreamList=function(){return t.Message.getRepeatedField(this,15)},proto.mediapipe.CalculatorGraphConfig.prototype.setOutputStreamList=function(e){return t.Message.setField(this,15,e||[])},proto.mediapipe.CalculatorGraphConfig.prototype.addOutputStream=function(e,n){return t.Message.addToRepeatedField(this,15,e,n)},proto.mediapipe.CalculatorGraphConfig.prototype.clearOutputStreamList=function(){return this.setOutputStreamList([])},proto.mediapipe.CalculatorGraphConfig.prototype.getInputSidePacketList=function(){return t.Message.getRepeatedField(this,16)},proto.mediapipe.CalculatorGraphConfig.prototype.setInputSidePacketList=function(e){return t.Message.setField(this,16,e||[])},proto.mediapipe.CalculatorGraphConfig.prototype.addInputSidePacket=function(e,n){return t.Message.addToRepeatedField(this,16,e,n)},proto.mediapipe.CalculatorGraphConfig.prototype.clearInputSidePacketList=function(){return this.setInputSidePacketList([])},proto.mediapipe.CalculatorGraphConfig.prototype.getOutputSidePacketList=function(){return t.Message.getRepeatedField(this,17)},proto.mediapipe.CalculatorGraphConfig.prototype.setOutputSidePacketList=function(e){return t.Message.setField(this,17,e||[])},proto.mediapipe.CalculatorGraphConfig.prototype.addOutputSidePacket=function(e,n){return t.Message.addToRepeatedField(this,17,e,n)},proto.mediapipe.CalculatorGraphConfig.prototype.clearOutputSidePacketList=function(){return this.setOutputSidePacketList([])},proto.mediapipe.CalculatorGraphConfig.prototype.getMaxQueueSize=function(){return t.Message.getFieldWithDefault(this,11,0)},proto.mediapipe.CalculatorGraphConfig.prototype.setMaxQueueSize=function(e){return t.Message.setProto3IntField(this,11,e)},proto.mediapipe.CalculatorGraphConfig.prototype.getReportDeadlock=function(){return t.Message.getBooleanFieldWithDefault(this,21,!1)},proto.mediapipe.CalculatorGraphConfig.prototype.setReportDeadlock=function(e){return t.Message.setProto3BooleanField(this,21,e)},proto.mediapipe.CalculatorGraphConfig.prototype.getInputStreamHandler=function(){return t.Message.getWrapperField(this,c.InputStreamHandlerConfig,12)},proto.mediapipe.CalculatorGraphConfig.prototype.setInputStreamHandler=function(e){return t.Message.setWrapperField(this,12,e)},proto.mediapipe.CalculatorGraphConfig.prototype.clearInputStreamHandler=function(){return this.setInputStreamHandler(void 0)},proto.mediapipe.CalculatorGraphConfig.prototype.hasInputStreamHandler=function(){return null!=t.Message.getField(this,12)},proto.mediapipe.CalculatorGraphConfig.prototype.getOutputStreamHandler=function(){return t.Message.getWrapperField(this,c.OutputStreamHandlerConfig,13)},proto.mediapipe.CalculatorGraphConfig.prototype.setOutputStreamHandler=function(e){return t.Message.setWrapperField(this,13,e)},proto.mediapipe.CalculatorGraphConfig.prototype.clearOutputStreamHandler=function(){return this.setOutputStreamHandler(void 0)},proto.mediapipe.CalculatorGraphConfig.prototype.hasOutputStreamHandler=function(){return null!=t.Message.getField(this,13)},proto.mediapipe.CalculatorGraphConfig.prototype.getExecutorList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.ExecutorConfig,14)},proto.mediapipe.CalculatorGraphConfig.prototype.setExecutorList=function(e){return t.Message.setRepeatedWrapperField(this,14,e)},proto.mediapipe.CalculatorGraphConfig.prototype.addExecutor=function(e,n){return t.Message.addToRepeatedWrapperField(this,14,e,proto.mediapipe.ExecutorConfig,n)},proto.mediapipe.CalculatorGraphConfig.prototype.clearExecutorList=function(){return this.setExecutorList([])},proto.mediapipe.CalculatorGraphConfig.prototype.getProfilerConfig=function(){return t.Message.getWrapperField(this,proto.mediapipe.ProfilerConfig,18)},proto.mediapipe.CalculatorGraphConfig.prototype.setProfilerConfig=function(e){return t.Message.setWrapperField(this,18,e)},proto.mediapipe.CalculatorGraphConfig.prototype.clearProfilerConfig=function(){return this.setProfilerConfig(void 0)},proto.mediapipe.CalculatorGraphConfig.prototype.hasProfilerConfig=function(){return null!=t.Message.getField(this,18)},proto.mediapipe.CalculatorGraphConfig.prototype.getPackage=function(){return t.Message.getFieldWithDefault(this,19,"")},proto.mediapipe.CalculatorGraphConfig.prototype.setPackage=function(e){return t.Message.setProto3StringField(this,19,e)},proto.mediapipe.CalculatorGraphConfig.prototype.getType=function(){return t.Message.getFieldWithDefault(this,20,"")},proto.mediapipe.CalculatorGraphConfig.prototype.setType=function(e){return t.Message.setProto3StringField(this,20,e)},proto.mediapipe.CalculatorGraphConfig.prototype.getOptions=function(){return t.Message.getWrapperField(this,a.MediaPipeOptions,1001)},proto.mediapipe.CalculatorGraphConfig.prototype.setOptions=function(e){return t.Message.setWrapperField(this,1001,e)},proto.mediapipe.CalculatorGraphConfig.prototype.clearOptions=function(){return this.setOptions(void 0)},proto.mediapipe.CalculatorGraphConfig.prototype.hasOptions=function(){return null!=t.Message.getField(this,1001)},proto.mediapipe.CalculatorGraphConfig.prototype.getGraphOptionsList=function(){return t.Message.getRepeatedWrapperField(this,o.Any,1002)},proto.mediapipe.CalculatorGraphConfig.prototype.setGraphOptionsList=function(e){return t.Message.setRepeatedWrapperField(this,1002,e)},proto.mediapipe.CalculatorGraphConfig.prototype.addGraphOptions=function(e,n){return t.Message.addToRepeatedWrapperField(this,1002,e,proto.google.protobuf.Any,n)},proto.mediapipe.CalculatorGraphConfig.prototype.clearGraphOptionsList=function(){return this.setGraphOptionsList([])},n.object.extend(e,proto.mediapipe)}(calculator_pb);var detection_pb={},location_data_pb={},rasterization_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.Rasterization",null,r),n.exportSymbol("proto.mediapipe.Rasterization.Interval",null,r),proto.mediapipe.Rasterization=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.Rasterization.repeatedFields_,null)},n.inherits(proto.mediapipe.Rasterization,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.Rasterization.displayName="proto.mediapipe.Rasterization"),proto.mediapipe.Rasterization.Interval=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.Rasterization.Interval,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.Rasterization.Interval.displayName="proto.mediapipe.Rasterization.Interval"),proto.mediapipe.Rasterization.repeatedFields_=[1],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.Rasterization.prototype.toObject=function(e){return proto.mediapipe.Rasterization.toObject(e,this)},proto.mediapipe.Rasterization.toObject=function(e,n){var r={intervalList:t.Message.toObjectList(n.getIntervalList(),proto.mediapipe.Rasterization.Interval.toObject,e)};return e&&(r.$jspbMessageInstance=n),r}),proto.mediapipe.Rasterization.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.Rasterization;return proto.mediapipe.Rasterization.deserializeBinaryFromReader(r,n)},proto.mediapipe.Rasterization.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=new proto.mediapipe.Rasterization.Interval;t.readMessage(n,proto.mediapipe.Rasterization.Interval.deserializeBinaryFromReader),e.addInterval(n)}else t.skipField();return e},proto.mediapipe.Rasterization.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.Rasterization.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.Rasterization.serializeBinaryToWriter=function(e,t){var n;(n=e.getIntervalList()).length>0&&t.writeRepeatedMessage(1,n,proto.mediapipe.Rasterization.Interval.serializeBinaryToWriter)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.Rasterization.Interval.prototype.toObject=function(e){return proto.mediapipe.Rasterization.Interval.toObject(e,this)},proto.mediapipe.Rasterization.Interval.toObject=function(e,n){var r,i={y:null==(r=t.Message.getField(n,1))?void 0:r,leftX:null==(r=t.Message.getField(n,2))?void 0:r,rightX:null==(r=t.Message.getField(n,3))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.Rasterization.Interval.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.Rasterization.Interval;return proto.mediapipe.Rasterization.Interval.deserializeBinaryFromReader(r,n)},proto.mediapipe.Rasterization.Interval.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readInt32();e.setY(n);break;case 2:n=t.readInt32(),e.setLeftX(n);break;case 3:n=t.readInt32(),e.setRightX(n);break;default:t.skipField()}return e},proto.mediapipe.Rasterization.Interval.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.Rasterization.Interval.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.Rasterization.Interval.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeInt32(1,r),null!=(r=t.Message.getField(e,2))&&n.writeInt32(2,r),null!=(r=t.Message.getField(e,3))&&n.writeInt32(3,r)},proto.mediapipe.Rasterization.Interval.prototype.getY=function(){return t.Message.getFieldWithDefault(this,1,0)},proto.mediapipe.Rasterization.Interval.prototype.setY=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.Rasterization.Interval.prototype.clearY=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.Rasterization.Interval.prototype.hasY=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.Rasterization.Interval.prototype.getLeftX=function(){return t.Message.getFieldWithDefault(this,2,0)},proto.mediapipe.Rasterization.Interval.prototype.setLeftX=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.Rasterization.Interval.prototype.clearLeftX=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.Rasterization.Interval.prototype.hasLeftX=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.Rasterization.Interval.prototype.getRightX=function(){return t.Message.getFieldWithDefault(this,3,0)},proto.mediapipe.Rasterization.Interval.prototype.setRightX=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.Rasterization.Interval.prototype.clearRightX=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.Rasterization.Interval.prototype.hasRightX=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.Rasterization.prototype.getIntervalList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.Rasterization.Interval,1)},proto.mediapipe.Rasterization.prototype.setIntervalList=function(e){return t.Message.setRepeatedWrapperField(this,1,e)},proto.mediapipe.Rasterization.prototype.addInterval=function(e,n){return t.Message.addToRepeatedWrapperField(this,1,e,proto.mediapipe.Rasterization.Interval,n)},proto.mediapipe.Rasterization.prototype.clearIntervalList=function(){return this.setIntervalList([])},n.object.extend(e,proto.mediapipe)}(rasterization_pb),function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=rasterization_pb;n.object.extend(proto,i),n.exportSymbol("proto.mediapipe.LocationData",null,r),n.exportSymbol("proto.mediapipe.LocationData.BinaryMask",null,r),n.exportSymbol("proto.mediapipe.LocationData.BoundingBox",null,r),n.exportSymbol("proto.mediapipe.LocationData.Format",null,r),n.exportSymbol("proto.mediapipe.LocationData.RelativeBoundingBox",null,r),n.exportSymbol("proto.mediapipe.LocationData.RelativeKeypoint",null,r),proto.mediapipe.LocationData=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.LocationData.repeatedFields_,null)},n.inherits(proto.mediapipe.LocationData,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.LocationData.displayName="proto.mediapipe.LocationData"),proto.mediapipe.LocationData.BoundingBox=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.LocationData.BoundingBox,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.LocationData.BoundingBox.displayName="proto.mediapipe.LocationData.BoundingBox"),proto.mediapipe.LocationData.RelativeBoundingBox=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.LocationData.RelativeBoundingBox,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.LocationData.RelativeBoundingBox.displayName="proto.mediapipe.LocationData.RelativeBoundingBox"),proto.mediapipe.LocationData.BinaryMask=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.LocationData.BinaryMask,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.LocationData.BinaryMask.displayName="proto.mediapipe.LocationData.BinaryMask"),proto.mediapipe.LocationData.RelativeKeypoint=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.LocationData.RelativeKeypoint,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.LocationData.RelativeKeypoint.displayName="proto.mediapipe.LocationData.RelativeKeypoint"),proto.mediapipe.LocationData.repeatedFields_=[5],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.LocationData.prototype.toObject=function(e){return proto.mediapipe.LocationData.toObject(e,this)},proto.mediapipe.LocationData.toObject=function(e,n){var r,i={format:null==(r=t.Message.getField(n,1))?void 0:r,boundingBox:(r=n.getBoundingBox())&&proto.mediapipe.LocationData.BoundingBox.toObject(e,r),relativeBoundingBox:(r=n.getRelativeBoundingBox())&&proto.mediapipe.LocationData.RelativeBoundingBox.toObject(e,r),mask:(r=n.getMask())&&proto.mediapipe.LocationData.BinaryMask.toObject(e,r),relativeKeypointsList:t.Message.toObjectList(n.getRelativeKeypointsList(),proto.mediapipe.LocationData.RelativeKeypoint.toObject,e)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.LocationData.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.LocationData;return proto.mediapipe.LocationData.deserializeBinaryFromReader(r,n)},proto.mediapipe.LocationData.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readEnum();e.setFormat(n);break;case 2:n=new proto.mediapipe.LocationData.BoundingBox,t.readMessage(n,proto.mediapipe.LocationData.BoundingBox.deserializeBinaryFromReader),e.setBoundingBox(n);break;case 3:n=new proto.mediapipe.LocationData.RelativeBoundingBox,t.readMessage(n,proto.mediapipe.LocationData.RelativeBoundingBox.deserializeBinaryFromReader),e.setRelativeBoundingBox(n);break;case 4:n=new proto.mediapipe.LocationData.BinaryMask,t.readMessage(n,proto.mediapipe.LocationData.BinaryMask.deserializeBinaryFromReader),e.setMask(n);break;case 5:n=new proto.mediapipe.LocationData.RelativeKeypoint,t.readMessage(n,proto.mediapipe.LocationData.RelativeKeypoint.deserializeBinaryFromReader),e.addRelativeKeypoints(n);break;default:t.skipField()}return e},proto.mediapipe.LocationData.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.LocationData.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.LocationData.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeEnum(1,r),null!=(r=e.getBoundingBox())&&n.writeMessage(2,r,proto.mediapipe.LocationData.BoundingBox.serializeBinaryToWriter),null!=(r=e.getRelativeBoundingBox())&&n.writeMessage(3,r,proto.mediapipe.LocationData.RelativeBoundingBox.serializeBinaryToWriter),null!=(r=e.getMask())&&n.writeMessage(4,r,proto.mediapipe.LocationData.BinaryMask.serializeBinaryToWriter),(r=e.getRelativeKeypointsList()).length>0&&n.writeRepeatedMessage(5,r,proto.mediapipe.LocationData.RelativeKeypoint.serializeBinaryToWriter)},proto.mediapipe.LocationData.Format={GLOBAL:0,BOUNDING_BOX:1,RELATIVE_BOUNDING_BOX:2,MASK:3},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.LocationData.BoundingBox.prototype.toObject=function(e){return proto.mediapipe.LocationData.BoundingBox.toObject(e,this)},proto.mediapipe.LocationData.BoundingBox.toObject=function(e,n){var r,i={xmin:null==(r=t.Message.getField(n,1))?void 0:r,ymin:null==(r=t.Message.getField(n,2))?void 0:r,width:null==(r=t.Message.getField(n,3))?void 0:r,height:null==(r=t.Message.getField(n,4))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.LocationData.BoundingBox.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.LocationData.BoundingBox;return proto.mediapipe.LocationData.BoundingBox.deserializeBinaryFromReader(r,n)},proto.mediapipe.LocationData.BoundingBox.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readInt32();e.setXmin(n);break;case 2:n=t.readInt32(),e.setYmin(n);break;case 3:n=t.readInt32(),e.setWidth(n);break;case 4:n=t.readInt32(),e.setHeight(n);break;default:t.skipField()}return e},proto.mediapipe.LocationData.BoundingBox.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.LocationData.BoundingBox.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.LocationData.BoundingBox.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeInt32(1,r),null!=(r=t.Message.getField(e,2))&&n.writeInt32(2,r),null!=(r=t.Message.getField(e,3))&&n.writeInt32(3,r),null!=(r=t.Message.getField(e,4))&&n.writeInt32(4,r)},proto.mediapipe.LocationData.BoundingBox.prototype.getXmin=function(){return t.Message.getFieldWithDefault(this,1,0)},proto.mediapipe.LocationData.BoundingBox.prototype.setXmin=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.LocationData.BoundingBox.prototype.clearXmin=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.LocationData.BoundingBox.prototype.hasXmin=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.LocationData.BoundingBox.prototype.getYmin=function(){return t.Message.getFieldWithDefault(this,2,0)},proto.mediapipe.LocationData.BoundingBox.prototype.setYmin=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.LocationData.BoundingBox.prototype.clearYmin=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.LocationData.BoundingBox.prototype.hasYmin=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.LocationData.BoundingBox.prototype.getWidth=function(){return t.Message.getFieldWithDefault(this,3,0)},proto.mediapipe.LocationData.BoundingBox.prototype.setWidth=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.LocationData.BoundingBox.prototype.clearWidth=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.LocationData.BoundingBox.prototype.hasWidth=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.LocationData.BoundingBox.prototype.getHeight=function(){return t.Message.getFieldWithDefault(this,4,0)},proto.mediapipe.LocationData.BoundingBox.prototype.setHeight=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.LocationData.BoundingBox.prototype.clearHeight=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.LocationData.BoundingBox.prototype.hasHeight=function(){return null!=t.Message.getField(this,4)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.LocationData.RelativeBoundingBox.prototype.toObject=function(e){return proto.mediapipe.LocationData.RelativeBoundingBox.toObject(e,this)},proto.mediapipe.LocationData.RelativeBoundingBox.toObject=function(e,n){var r,i={xmin:null==(r=t.Message.getOptionalFloatingPointField(n,1))?void 0:r,ymin:null==(r=t.Message.getOptionalFloatingPointField(n,2))?void 0:r,width:null==(r=t.Message.getOptionalFloatingPointField(n,3))?void 0:r,height:null==(r=t.Message.getOptionalFloatingPointField(n,4))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.LocationData.RelativeBoundingBox.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.LocationData.RelativeBoundingBox;return proto.mediapipe.LocationData.RelativeBoundingBox.deserializeBinaryFromReader(r,n)},proto.mediapipe.LocationData.RelativeBoundingBox.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readFloat();e.setXmin(n);break;case 2:n=t.readFloat(),e.setYmin(n);break;case 3:n=t.readFloat(),e.setWidth(n);break;case 4:n=t.readFloat(),e.setHeight(n);break;default:t.skipField()}return e},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.LocationData.RelativeBoundingBox.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.LocationData.RelativeBoundingBox.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeFloat(1,r),null!=(r=t.Message.getField(e,2))&&n.writeFloat(2,r),null!=(r=t.Message.getField(e,3))&&n.writeFloat(3,r),null!=(r=t.Message.getField(e,4))&&n.writeFloat(4,r)},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.getXmin=function(){return t.Message.getFloatingPointFieldWithDefault(this,1,0)},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.setXmin=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.clearXmin=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.hasXmin=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.getYmin=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,0)},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.setYmin=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.clearYmin=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.hasYmin=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.getWidth=function(){return t.Message.getFloatingPointFieldWithDefault(this,3,0)},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.setWidth=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.clearWidth=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.hasWidth=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.getHeight=function(){return t.Message.getFloatingPointFieldWithDefault(this,4,0)},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.setHeight=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.clearHeight=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.LocationData.RelativeBoundingBox.prototype.hasHeight=function(){return null!=t.Message.getField(this,4)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.LocationData.BinaryMask.prototype.toObject=function(e){return proto.mediapipe.LocationData.BinaryMask.toObject(e,this)},proto.mediapipe.LocationData.BinaryMask.toObject=function(e,n){var r,o={width:null==(r=t.Message.getField(n,1))?void 0:r,height:null==(r=t.Message.getField(n,2))?void 0:r,rasterization:(r=n.getRasterization())&&i.Rasterization.toObject(e,r)};return e&&(o.$jspbMessageInstance=n),o}),proto.mediapipe.LocationData.BinaryMask.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.LocationData.BinaryMask;return proto.mediapipe.LocationData.BinaryMask.deserializeBinaryFromReader(r,n)},proto.mediapipe.LocationData.BinaryMask.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readInt32();e.setWidth(n);break;case 2:n=t.readInt32(),e.setHeight(n);break;case 3:n=new i.Rasterization,t.readMessage(n,i.Rasterization.deserializeBinaryFromReader),e.setRasterization(n);break;default:t.skipField()}return e},proto.mediapipe.LocationData.BinaryMask.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.LocationData.BinaryMask.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.LocationData.BinaryMask.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeInt32(1,r),null!=(r=t.Message.getField(e,2))&&n.writeInt32(2,r),null!=(r=e.getRasterization())&&n.writeMessage(3,r,i.Rasterization.serializeBinaryToWriter)},proto.mediapipe.LocationData.BinaryMask.prototype.getWidth=function(){return t.Message.getFieldWithDefault(this,1,0)},proto.mediapipe.LocationData.BinaryMask.prototype.setWidth=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.LocationData.BinaryMask.prototype.clearWidth=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.LocationData.BinaryMask.prototype.hasWidth=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.LocationData.BinaryMask.prototype.getHeight=function(){return t.Message.getFieldWithDefault(this,2,0)},proto.mediapipe.LocationData.BinaryMask.prototype.setHeight=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.LocationData.BinaryMask.prototype.clearHeight=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.LocationData.BinaryMask.prototype.hasHeight=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.LocationData.BinaryMask.prototype.getRasterization=function(){return t.Message.getWrapperField(this,i.Rasterization,3)},proto.mediapipe.LocationData.BinaryMask.prototype.setRasterization=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.LocationData.BinaryMask.prototype.clearRasterization=function(){return this.setRasterization(void 0)},proto.mediapipe.LocationData.BinaryMask.prototype.hasRasterization=function(){return null!=t.Message.getField(this,3)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.LocationData.RelativeKeypoint.prototype.toObject=function(e){return proto.mediapipe.LocationData.RelativeKeypoint.toObject(e,this)},proto.mediapipe.LocationData.RelativeKeypoint.toObject=function(e,n){var r,i={x:null==(r=t.Message.getOptionalFloatingPointField(n,1))?void 0:r,y:null==(r=t.Message.getOptionalFloatingPointField(n,2))?void 0:r,keypointLabel:null==(r=t.Message.getField(n,3))?void 0:r,score:null==(r=t.Message.getOptionalFloatingPointField(n,4))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.LocationData.RelativeKeypoint.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.LocationData.RelativeKeypoint;return proto.mediapipe.LocationData.RelativeKeypoint.deserializeBinaryFromReader(r,n)},proto.mediapipe.LocationData.RelativeKeypoint.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readFloat();e.setX(n);break;case 2:n=t.readFloat(),e.setY(n);break;case 3:n=t.readString(),e.setKeypointLabel(n);break;case 4:n=t.readFloat(),e.setScore(n);break;default:t.skipField()}return e},proto.mediapipe.LocationData.RelativeKeypoint.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.LocationData.RelativeKeypoint.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.LocationData.RelativeKeypoint.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeFloat(1,r),null!=(r=t.Message.getField(e,2))&&n.writeFloat(2,r),null!=(r=t.Message.getField(e,3))&&n.writeString(3,r),null!=(r=t.Message.getField(e,4))&&n.writeFloat(4,r)},proto.mediapipe.LocationData.RelativeKeypoint.prototype.getX=function(){return t.Message.getFloatingPointFieldWithDefault(this,1,0)},proto.mediapipe.LocationData.RelativeKeypoint.prototype.setX=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.LocationData.RelativeKeypoint.prototype.clearX=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.LocationData.RelativeKeypoint.prototype.hasX=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.LocationData.RelativeKeypoint.prototype.getY=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,0)},proto.mediapipe.LocationData.RelativeKeypoint.prototype.setY=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.LocationData.RelativeKeypoint.prototype.clearY=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.LocationData.RelativeKeypoint.prototype.hasY=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.LocationData.RelativeKeypoint.prototype.getKeypointLabel=function(){return t.Message.getFieldWithDefault(this,3,"")},proto.mediapipe.LocationData.RelativeKeypoint.prototype.setKeypointLabel=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.LocationData.RelativeKeypoint.prototype.clearKeypointLabel=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.LocationData.RelativeKeypoint.prototype.hasKeypointLabel=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.LocationData.RelativeKeypoint.prototype.getScore=function(){return t.Message.getFloatingPointFieldWithDefault(this,4,0)},proto.mediapipe.LocationData.RelativeKeypoint.prototype.setScore=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.LocationData.RelativeKeypoint.prototype.clearScore=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.LocationData.RelativeKeypoint.prototype.hasScore=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.LocationData.prototype.getFormat=function(){return t.Message.getFieldWithDefault(this,1,0)},proto.mediapipe.LocationData.prototype.setFormat=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.LocationData.prototype.clearFormat=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.LocationData.prototype.hasFormat=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.LocationData.prototype.getBoundingBox=function(){return t.Message.getWrapperField(this,proto.mediapipe.LocationData.BoundingBox,2)},proto.mediapipe.LocationData.prototype.setBoundingBox=function(e){return t.Message.setWrapperField(this,2,e)},proto.mediapipe.LocationData.prototype.clearBoundingBox=function(){return this.setBoundingBox(void 0)},proto.mediapipe.LocationData.prototype.hasBoundingBox=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.LocationData.prototype.getRelativeBoundingBox=function(){return t.Message.getWrapperField(this,proto.mediapipe.LocationData.RelativeBoundingBox,3)},proto.mediapipe.LocationData.prototype.setRelativeBoundingBox=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.LocationData.prototype.clearRelativeBoundingBox=function(){return this.setRelativeBoundingBox(void 0)},proto.mediapipe.LocationData.prototype.hasRelativeBoundingBox=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.LocationData.prototype.getMask=function(){return t.Message.getWrapperField(this,proto.mediapipe.LocationData.BinaryMask,4)},proto.mediapipe.LocationData.prototype.setMask=function(e){return t.Message.setWrapperField(this,4,e)},proto.mediapipe.LocationData.prototype.clearMask=function(){return this.setMask(void 0)},proto.mediapipe.LocationData.prototype.hasMask=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.LocationData.prototype.getRelativeKeypointsList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.LocationData.RelativeKeypoint,5)},proto.mediapipe.LocationData.prototype.setRelativeKeypointsList=function(e){return t.Message.setRepeatedWrapperField(this,5,e)},proto.mediapipe.LocationData.prototype.addRelativeKeypoints=function(e,n){return t.Message.addToRepeatedWrapperField(this,5,e,proto.mediapipe.LocationData.RelativeKeypoint,n)},proto.mediapipe.LocationData.prototype.clearRelativeKeypointsList=function(){return this.setRelativeKeypointsList([])},n.object.extend(e,proto.mediapipe)}(location_data_pb),function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=location_data_pb;n.object.extend(proto,i),n.exportSymbol("proto.mediapipe.Detection",null,r),n.exportSymbol("proto.mediapipe.Detection.AssociatedDetection",null,r),n.exportSymbol("proto.mediapipe.DetectionList",null,r),proto.mediapipe.Detection=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.Detection.repeatedFields_,null)},n.inherits(proto.mediapipe.Detection,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.Detection.displayName="proto.mediapipe.Detection"),proto.mediapipe.Detection.AssociatedDetection=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.Detection.AssociatedDetection,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.Detection.AssociatedDetection.displayName="proto.mediapipe.Detection.AssociatedDetection"),proto.mediapipe.DetectionList=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.DetectionList.repeatedFields_,null)},n.inherits(proto.mediapipe.DetectionList,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.DetectionList.displayName="proto.mediapipe.DetectionList"),proto.mediapipe.Detection.repeatedFields_=[1,2,3,8,9],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.Detection.prototype.toObject=function(e){return proto.mediapipe.Detection.toObject(e,this)},proto.mediapipe.Detection.toObject=function(e,n){var r,o={labelList:null==(r=t.Message.getRepeatedField(n,1))?void 0:r,labelIdList:null==(r=t.Message.getRepeatedField(n,2))?void 0:r,scoreList:null==(r=t.Message.getRepeatedFloatingPointField(n,3))?void 0:r,locationData:(r=n.getLocationData())&&i.LocationData.toObject(e,r),featureTag:null==(r=t.Message.getField(n,5))?void 0:r,trackId:null==(r=t.Message.getField(n,6))?void 0:r,detectionId:null==(r=t.Message.getField(n,7))?void 0:r,associatedDetectionsList:t.Message.toObjectList(n.getAssociatedDetectionsList(),proto.mediapipe.Detection.AssociatedDetection.toObject,e),displayNameList:null==(r=t.Message.getRepeatedField(n,9))?void 0:r,timestampUsec:null==(r=t.Message.getField(n,10))?void 0:r};return e&&(o.$jspbMessageInstance=n),o}),proto.mediapipe.Detection.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.Detection;return proto.mediapipe.Detection.deserializeBinaryFromReader(r,n)},proto.mediapipe.Detection.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.addLabel(n);break;case 2:for(var r=t.isDelimited()?t.readPackedInt32():[t.readInt32()],o=0;o<r.length;o++)e.addLabelId(r[o]);break;case 3:for(r=t.isDelimited()?t.readPackedFloat():[t.readFloat()],o=0;o<r.length;o++)e.addScore(r[o]);break;case 4:n=new i.LocationData,t.readMessage(n,i.LocationData.deserializeBinaryFromReader),e.setLocationData(n);break;case 5:n=t.readString(),e.setFeatureTag(n);break;case 6:n=t.readString(),e.setTrackId(n);break;case 7:n=t.readInt64(),e.setDetectionId(n);break;case 8:n=new proto.mediapipe.Detection.AssociatedDetection,t.readMessage(n,proto.mediapipe.Detection.AssociatedDetection.deserializeBinaryFromReader),e.addAssociatedDetections(n);break;case 9:n=t.readString(),e.addDisplayName(n);break;case 10:n=t.readInt64(),e.setTimestampUsec(n);break;default:t.skipField()}return e},proto.mediapipe.Detection.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.Detection.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.Detection.serializeBinaryToWriter=function(e,n){var r=void 0;(r=e.getLabelList()).length>0&&n.writeRepeatedString(1,r),(r=e.getLabelIdList()).length>0&&n.writePackedInt32(2,r),(r=e.getScoreList()).length>0&&n.writePackedFloat(3,r),null!=(r=e.getLocationData())&&n.writeMessage(4,r,i.LocationData.serializeBinaryToWriter),null!=(r=t.Message.getField(e,5))&&n.writeString(5,r),null!=(r=t.Message.getField(e,6))&&n.writeString(6,r),null!=(r=t.Message.getField(e,7))&&n.writeInt64(7,r),(r=e.getAssociatedDetectionsList()).length>0&&n.writeRepeatedMessage(8,r,proto.mediapipe.Detection.AssociatedDetection.serializeBinaryToWriter),(r=e.getDisplayNameList()).length>0&&n.writeRepeatedString(9,r),null!=(r=t.Message.getField(e,10))&&n.writeInt64(10,r)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.Detection.AssociatedDetection.prototype.toObject=function(e){return proto.mediapipe.Detection.AssociatedDetection.toObject(e,this)},proto.mediapipe.Detection.AssociatedDetection.toObject=function(e,n){var r,i={id:null==(r=t.Message.getField(n,1))?void 0:r,confidence:null==(r=t.Message.getOptionalFloatingPointField(n,2))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.Detection.AssociatedDetection.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.Detection.AssociatedDetection;return proto.mediapipe.Detection.AssociatedDetection.deserializeBinaryFromReader(r,n)},proto.mediapipe.Detection.AssociatedDetection.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readInt32();e.setId(n);break;case 2:n=t.readFloat(),e.setConfidence(n);break;default:t.skipField()}return e},proto.mediapipe.Detection.AssociatedDetection.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.Detection.AssociatedDetection.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.Detection.AssociatedDetection.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeInt32(1,r),null!=(r=t.Message.getField(e,2))&&n.writeFloat(2,r)},proto.mediapipe.Detection.AssociatedDetection.prototype.getId=function(){return t.Message.getFieldWithDefault(this,1,0)},proto.mediapipe.Detection.AssociatedDetection.prototype.setId=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.Detection.AssociatedDetection.prototype.clearId=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.Detection.AssociatedDetection.prototype.hasId=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.Detection.AssociatedDetection.prototype.getConfidence=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,0)},proto.mediapipe.Detection.AssociatedDetection.prototype.setConfidence=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.Detection.AssociatedDetection.prototype.clearConfidence=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.Detection.AssociatedDetection.prototype.hasConfidence=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.Detection.prototype.getLabelList=function(){return t.Message.getRepeatedField(this,1)},proto.mediapipe.Detection.prototype.setLabelList=function(e){return t.Message.setField(this,1,e||[])},proto.mediapipe.Detection.prototype.addLabel=function(e,n){return t.Message.addToRepeatedField(this,1,e,n)},proto.mediapipe.Detection.prototype.clearLabelList=function(){return this.setLabelList([])},proto.mediapipe.Detection.prototype.getLabelIdList=function(){return t.Message.getRepeatedField(this,2)},proto.mediapipe.Detection.prototype.setLabelIdList=function(e){return t.Message.setField(this,2,e||[])},proto.mediapipe.Detection.prototype.addLabelId=function(e,n){return t.Message.addToRepeatedField(this,2,e,n)},proto.mediapipe.Detection.prototype.clearLabelIdList=function(){return this.setLabelIdList([])},proto.mediapipe.Detection.prototype.getScoreList=function(){return t.Message.getRepeatedFloatingPointField(this,3)},proto.mediapipe.Detection.prototype.setScoreList=function(e){return t.Message.setField(this,3,e||[])},proto.mediapipe.Detection.prototype.addScore=function(e,n){return t.Message.addToRepeatedField(this,3,e,n)},proto.mediapipe.Detection.prototype.clearScoreList=function(){return this.setScoreList([])},proto.mediapipe.Detection.prototype.getLocationData=function(){return t.Message.getWrapperField(this,i.LocationData,4)},proto.mediapipe.Detection.prototype.setLocationData=function(e){return t.Message.setWrapperField(this,4,e)},proto.mediapipe.Detection.prototype.clearLocationData=function(){return this.setLocationData(void 0)},proto.mediapipe.Detection.prototype.hasLocationData=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.Detection.prototype.getFeatureTag=function(){return t.Message.getFieldWithDefault(this,5,"")},proto.mediapipe.Detection.prototype.setFeatureTag=function(e){return t.Message.setField(this,5,e)},proto.mediapipe.Detection.prototype.clearFeatureTag=function(){return t.Message.setField(this,5,void 0)},proto.mediapipe.Detection.prototype.hasFeatureTag=function(){return null!=t.Message.getField(this,5)},proto.mediapipe.Detection.prototype.getTrackId=function(){return t.Message.getFieldWithDefault(this,6,"")},proto.mediapipe.Detection.prototype.setTrackId=function(e){return t.Message.setField(this,6,e)},proto.mediapipe.Detection.prototype.clearTrackId=function(){return t.Message.setField(this,6,void 0)},proto.mediapipe.Detection.prototype.hasTrackId=function(){return null!=t.Message.getField(this,6)},proto.mediapipe.Detection.prototype.getDetectionId=function(){return t.Message.getFieldWithDefault(this,7,0)},proto.mediapipe.Detection.prototype.setDetectionId=function(e){return t.Message.setField(this,7,e)},proto.mediapipe.Detection.prototype.clearDetectionId=function(){return t.Message.setField(this,7,void 0)},proto.mediapipe.Detection.prototype.hasDetectionId=function(){return null!=t.Message.getField(this,7)},proto.mediapipe.Detection.prototype.getAssociatedDetectionsList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.Detection.AssociatedDetection,8)},proto.mediapipe.Detection.prototype.setAssociatedDetectionsList=function(e){return t.Message.setRepeatedWrapperField(this,8,e)},proto.mediapipe.Detection.prototype.addAssociatedDetections=function(e,n){return t.Message.addToRepeatedWrapperField(this,8,e,proto.mediapipe.Detection.AssociatedDetection,n)},proto.mediapipe.Detection.prototype.clearAssociatedDetectionsList=function(){return this.setAssociatedDetectionsList([])},proto.mediapipe.Detection.prototype.getDisplayNameList=function(){return t.Message.getRepeatedField(this,9)},proto.mediapipe.Detection.prototype.setDisplayNameList=function(e){return t.Message.setField(this,9,e||[])},proto.mediapipe.Detection.prototype.addDisplayName=function(e,n){return t.Message.addToRepeatedField(this,9,e,n)},proto.mediapipe.Detection.prototype.clearDisplayNameList=function(){return this.setDisplayNameList([])},proto.mediapipe.Detection.prototype.getTimestampUsec=function(){return t.Message.getFieldWithDefault(this,10,0)},proto.mediapipe.Detection.prototype.setTimestampUsec=function(e){return t.Message.setField(this,10,e)},proto.mediapipe.Detection.prototype.clearTimestampUsec=function(){return t.Message.setField(this,10,void 0)},proto.mediapipe.Detection.prototype.hasTimestampUsec=function(){return null!=t.Message.getField(this,10)},proto.mediapipe.DetectionList.repeatedFields_=[1],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.DetectionList.prototype.toObject=function(e){return proto.mediapipe.DetectionList.toObject(e,this)},proto.mediapipe.DetectionList.toObject=function(e,n){var r={detectionList:t.Message.toObjectList(n.getDetectionList(),proto.mediapipe.Detection.toObject,e)};return e&&(r.$jspbMessageInstance=n),r}),proto.mediapipe.DetectionList.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.DetectionList;return proto.mediapipe.DetectionList.deserializeBinaryFromReader(r,n)},proto.mediapipe.DetectionList.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=new proto.mediapipe.Detection;t.readMessage(n,proto.mediapipe.Detection.deserializeBinaryFromReader),e.addDetection(n)}else t.skipField();return e},proto.mediapipe.DetectionList.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.DetectionList.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.DetectionList.serializeBinaryToWriter=function(e,t){var n;(n=e.getDetectionList()).length>0&&t.writeRepeatedMessage(1,n,proto.mediapipe.Detection.serializeBinaryToWriter)},proto.mediapipe.DetectionList.prototype.getDetectionList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.Detection,1)},proto.mediapipe.DetectionList.prototype.setDetectionList=function(e){return t.Message.setRepeatedWrapperField(this,1,e)},proto.mediapipe.DetectionList.prototype.addDetection=function(e,n){return t.Message.addToRepeatedWrapperField(this,1,e,proto.mediapipe.Detection,n)},proto.mediapipe.DetectionList.prototype.clearDetectionList=function(){return this.setDetectionList([])},n.object.extend(e,proto.mediapipe)}(detection_pb);var base_options_pb={},acceleration_pb={},inference_calculator_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o),n.exportSymbol("proto.mediapipe.InferenceCalculatorOptions",null,r),n.exportSymbol("proto.mediapipe.InferenceCalculatorOptions.Delegate",null,r),n.exportSymbol("proto.mediapipe.InferenceCalculatorOptions.Delegate.DelegateCase",null,r),n.exportSymbol("proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu",null,r),n.exportSymbol("proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.Api",null,r),n.exportSymbol("proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.InferenceUsage",null,r),n.exportSymbol("proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi",null,r),n.exportSymbol("proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite",null,r),n.exportSymbol("proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack",null,r),proto.mediapipe.InferenceCalculatorOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.InferenceCalculatorOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.InferenceCalculatorOptions.displayName="proto.mediapipe.InferenceCalculatorOptions"),proto.mediapipe.InferenceCalculatorOptions.Delegate=function(e){t.Message.initialize(this,e,0,-1,null,proto.mediapipe.InferenceCalculatorOptions.Delegate.oneofGroups_)},n.inherits(proto.mediapipe.InferenceCalculatorOptions.Delegate,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.InferenceCalculatorOptions.Delegate.displayName="proto.mediapipe.InferenceCalculatorOptions.Delegate"),proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite.displayName="proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite"),proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.displayName="proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu"),proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.displayName="proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi"),proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.displayName="proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.InferenceCalculatorOptions.prototype.toObject=function(e){return proto.mediapipe.InferenceCalculatorOptions.toObject(e,this)},proto.mediapipe.InferenceCalculatorOptions.toObject=function(e,n){var r,i={modelPath:null==(r=t.Message.getField(n,1))?void 0:r,useGpu:t.Message.getBooleanFieldWithDefault(n,2,!1),useNnapi:t.Message.getBooleanFieldWithDefault(n,3,!1),cpuNumThread:t.Message.getFieldWithDefault(n,4,-1),delegate:(r=n.getDelegate())&&proto.mediapipe.InferenceCalculatorOptions.Delegate.toObject(e,r)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.InferenceCalculatorOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.InferenceCalculatorOptions;return proto.mediapipe.InferenceCalculatorOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.InferenceCalculatorOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.setModelPath(n);break;case 2:n=t.readBool(),e.setUseGpu(n);break;case 3:n=t.readBool(),e.setUseNnapi(n);break;case 4:n=t.readInt32(),e.setCpuNumThread(n);break;case 5:n=new proto.mediapipe.InferenceCalculatorOptions.Delegate,t.readMessage(n,proto.mediapipe.InferenceCalculatorOptions.Delegate.deserializeBinaryFromReader),e.setDelegate(n);break;default:t.skipField()}return e},proto.mediapipe.InferenceCalculatorOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.InferenceCalculatorOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.InferenceCalculatorOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeString(1,r),null!=(r=t.Message.getField(e,2))&&n.writeBool(2,r),null!=(r=t.Message.getField(e,3))&&n.writeBool(3,r),null!=(r=t.Message.getField(e,4))&&n.writeInt32(4,r),null!=(r=e.getDelegate())&&n.writeMessage(5,r,proto.mediapipe.InferenceCalculatorOptions.Delegate.serializeBinaryToWriter)},proto.mediapipe.InferenceCalculatorOptions.Delegate.oneofGroups_=[[1,2,3,4]],proto.mediapipe.InferenceCalculatorOptions.Delegate.DelegateCase={DELEGATE_NOT_SET:0,TFLITE:1,GPU:2,NNAPI:3,XNNPACK:4},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.getDelegateCase=function(){return t.Message.computeOneofCase(this,proto.mediapipe.InferenceCalculatorOptions.Delegate.oneofGroups_[0])},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.toObject=function(e){return proto.mediapipe.InferenceCalculatorOptions.Delegate.toObject(e,this)},proto.mediapipe.InferenceCalculatorOptions.Delegate.toObject=function(e,t){var n,r={tflite:(n=t.getTflite())&&proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite.toObject(e,n),gpu:(n=t.getGpu())&&proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.toObject(e,n),nnapi:(n=t.getNnapi())&&proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.toObject(e,n),xnnpack:(n=t.getXnnpack())&&proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.toObject(e,n)};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.InferenceCalculatorOptions.Delegate.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.InferenceCalculatorOptions.Delegate;return proto.mediapipe.InferenceCalculatorOptions.Delegate.deserializeBinaryFromReader(r,n)},proto.mediapipe.InferenceCalculatorOptions.Delegate.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite;t.readMessage(n,proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite.deserializeBinaryFromReader),e.setTflite(n);break;case 2:n=new proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu,t.readMessage(n,proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.deserializeBinaryFromReader),e.setGpu(n);break;case 3:n=new proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi,t.readMessage(n,proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.deserializeBinaryFromReader),e.setNnapi(n);break;case 4:n=new proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack,t.readMessage(n,proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.deserializeBinaryFromReader),e.setXnnpack(n);break;default:t.skipField()}return e},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.InferenceCalculatorOptions.Delegate.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.InferenceCalculatorOptions.Delegate.serializeBinaryToWriter=function(e,t){var n=void 0;null!=(n=e.getTflite())&&t.writeMessage(1,n,proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite.serializeBinaryToWriter),null!=(n=e.getGpu())&&t.writeMessage(2,n,proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.serializeBinaryToWriter),null!=(n=e.getNnapi())&&t.writeMessage(3,n,proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.serializeBinaryToWriter),null!=(n=e.getXnnpack())&&t.writeMessage(4,n,proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.serializeBinaryToWriter)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite.prototype.toObject=function(e){return proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite.toObject(e,this)},proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite.toObject=function(e,t){var n={};return e&&(n.$jspbMessageInstance=t),n}),proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite;return proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite.deserializeBinaryFromReader(r,n)},proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)t.getFieldNumber(),t.skipField();return e},proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite.serializeBinaryToWriter=function(e,t){},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.toObject=function(e){return proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.toObject(e,this)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.toObject=function(e,n){var r,i={useAdvancedGpuApi:t.Message.getBooleanFieldWithDefault(n,1,!1),api:t.Message.getFieldWithDefault(n,4,0),allowPrecisionLoss:t.Message.getBooleanFieldWithDefault(n,3,!0),cachedKernelPath:null==(r=t.Message.getField(n,2))?void 0:r,serializedModelDir:null==(r=t.Message.getField(n,7))?void 0:r,modelToken:null==(r=t.Message.getField(n,8))?void 0:r,usage:t.Message.getFieldWithDefault(n,5,2)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu;return proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.deserializeBinaryFromReader(r,n)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readBool();e.setUseAdvancedGpuApi(n);break;case 4:n=t.readEnum(),e.setApi(n);break;case 3:n=t.readBool(),e.setAllowPrecisionLoss(n);break;case 2:n=t.readString(),e.setCachedKernelPath(n);break;case 7:n=t.readString(),e.setSerializedModelDir(n);break;case 8:n=t.readString(),e.setModelToken(n);break;case 5:n=t.readEnum(),e.setUsage(n);break;default:t.skipField()}return e},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeBool(1,r),null!=(r=t.Message.getField(e,4))&&n.writeEnum(4,r),null!=(r=t.Message.getField(e,3))&&n.writeBool(3,r),null!=(r=t.Message.getField(e,2))&&n.writeString(2,r),null!=(r=t.Message.getField(e,7))&&n.writeString(7,r),null!=(r=t.Message.getField(e,8))&&n.writeString(8,r),null!=(r=t.Message.getField(e,5))&&n.writeEnum(5,r)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.Api={ANY:0,OPENGL:1,OPENCL:2},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.InferenceUsage={UNSPECIFIED:0,FAST_SINGLE_ANSWER:1,SUSTAINED_SPEED:2},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.getUseAdvancedGpuApi=function(){return t.Message.getBooleanFieldWithDefault(this,1,!1)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.setUseAdvancedGpuApi=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.clearUseAdvancedGpuApi=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.hasUseAdvancedGpuApi=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.getApi=function(){return t.Message.getFieldWithDefault(this,4,0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.setApi=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.clearApi=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.hasApi=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.getAllowPrecisionLoss=function(){return t.Message.getBooleanFieldWithDefault(this,3,!0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.setAllowPrecisionLoss=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.clearAllowPrecisionLoss=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.hasAllowPrecisionLoss=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.getCachedKernelPath=function(){return t.Message.getFieldWithDefault(this,2,"")},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.setCachedKernelPath=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.clearCachedKernelPath=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.hasCachedKernelPath=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.getSerializedModelDir=function(){return t.Message.getFieldWithDefault(this,7,"")},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.setSerializedModelDir=function(e){return t.Message.setField(this,7,e)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.clearSerializedModelDir=function(){return t.Message.setField(this,7,void 0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.hasSerializedModelDir=function(){return null!=t.Message.getField(this,7)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.getModelToken=function(){return t.Message.getFieldWithDefault(this,8,"")},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.setModelToken=function(e){return t.Message.setField(this,8,e)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.clearModelToken=function(){return t.Message.setField(this,8,void 0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.hasModelToken=function(){return null!=t.Message.getField(this,8)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.getUsage=function(){return t.Message.getFieldWithDefault(this,5,2)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.setUsage=function(e){return t.Message.setField(this,5,e)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.clearUsage=function(){return t.Message.setField(this,5,void 0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu.prototype.hasUsage=function(){return null!=t.Message.getField(this,5)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.prototype.toObject=function(e){return proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.toObject(e,this)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.toObject=function(e,n){var r,i={cacheDir:null==(r=t.Message.getField(n,1))?void 0:r,modelToken:null==(r=t.Message.getField(n,2))?void 0:r,acceleratorName:null==(r=t.Message.getField(n,3))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi;return proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.deserializeBinaryFromReader(r,n)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.setCacheDir(n);break;case 2:n=t.readString(),e.setModelToken(n);break;case 3:n=t.readString(),e.setAcceleratorName(n);break;default:t.skipField()}return e},proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeString(1,r),null!=(r=t.Message.getField(e,2))&&n.writeString(2,r),null!=(r=t.Message.getField(e,3))&&n.writeString(3,r)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.prototype.getCacheDir=function(){return t.Message.getFieldWithDefault(this,1,"")},proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.prototype.setCacheDir=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.prototype.clearCacheDir=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.prototype.hasCacheDir=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.prototype.getModelToken=function(){return t.Message.getFieldWithDefault(this,2,"")},proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.prototype.setModelToken=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.prototype.clearModelToken=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.prototype.hasModelToken=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.prototype.getAcceleratorName=function(){return t.Message.getFieldWithDefault(this,3,"")},proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.prototype.setAcceleratorName=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.prototype.clearAcceleratorName=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi.prototype.hasAcceleratorName=function(){return null!=t.Message.getField(this,3)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.prototype.toObject=function(e){return proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.toObject(e,this)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.toObject=function(e,n){var r={numThreads:t.Message.getFieldWithDefault(n,1,-1)};return e&&(r.$jspbMessageInstance=n),r}),proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack;return proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.deserializeBinaryFromReader(r,n)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=t.readInt32();e.setNumThreads(n)}else t.skipField();return e},proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.serializeBinaryToWriter=function(e,n){var r;null!=(r=t.Message.getField(e,1))&&n.writeInt32(1,r)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.prototype.getNumThreads=function(){return t.Message.getFieldWithDefault(this,1,-1)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.prototype.setNumThreads=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.prototype.clearNumThreads=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack.prototype.hasNumThreads=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.getTflite=function(){return t.Message.getWrapperField(this,proto.mediapipe.InferenceCalculatorOptions.Delegate.TfLite,1)},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.setTflite=function(e){return t.Message.setOneofWrapperField(this,1,proto.mediapipe.InferenceCalculatorOptions.Delegate.oneofGroups_[0],e)},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.clearTflite=function(){return this.setTflite(void 0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.hasTflite=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.getGpu=function(){return t.Message.getWrapperField(this,proto.mediapipe.InferenceCalculatorOptions.Delegate.Gpu,2)},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.setGpu=function(e){return t.Message.setOneofWrapperField(this,2,proto.mediapipe.InferenceCalculatorOptions.Delegate.oneofGroups_[0],e)},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.clearGpu=function(){return this.setGpu(void 0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.hasGpu=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.getNnapi=function(){return t.Message.getWrapperField(this,proto.mediapipe.InferenceCalculatorOptions.Delegate.Nnapi,3)},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.setNnapi=function(e){return t.Message.setOneofWrapperField(this,3,proto.mediapipe.InferenceCalculatorOptions.Delegate.oneofGroups_[0],e)},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.clearNnapi=function(){return this.setNnapi(void 0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.hasNnapi=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.getXnnpack=function(){return t.Message.getWrapperField(this,proto.mediapipe.InferenceCalculatorOptions.Delegate.Xnnpack,4)},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.setXnnpack=function(e){return t.Message.setOneofWrapperField(this,4,proto.mediapipe.InferenceCalculatorOptions.Delegate.oneofGroups_[0],e)},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.clearXnnpack=function(){return this.setXnnpack(void 0)},proto.mediapipe.InferenceCalculatorOptions.Delegate.prototype.hasXnnpack=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.InferenceCalculatorOptions.ext=new t.ExtensionFieldInfo(336783863,{ext:0},proto.mediapipe.InferenceCalculatorOptions,proto.mediapipe.InferenceCalculatorOptions.toObject,0),o.CalculatorOptions.extensionsBinary[336783863]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.InferenceCalculatorOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.InferenceCalculatorOptions.serializeBinaryToWriter,proto.mediapipe.InferenceCalculatorOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[336783863]=proto.mediapipe.InferenceCalculatorOptions.ext,proto.mediapipe.InferenceCalculatorOptions.prototype.getModelPath=function(){return t.Message.getFieldWithDefault(this,1,"")},proto.mediapipe.InferenceCalculatorOptions.prototype.setModelPath=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.InferenceCalculatorOptions.prototype.clearModelPath=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.InferenceCalculatorOptions.prototype.hasModelPath=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.InferenceCalculatorOptions.prototype.getUseGpu=function(){return t.Message.getBooleanFieldWithDefault(this,2,!1)},proto.mediapipe.InferenceCalculatorOptions.prototype.setUseGpu=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.InferenceCalculatorOptions.prototype.clearUseGpu=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.InferenceCalculatorOptions.prototype.hasUseGpu=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.InferenceCalculatorOptions.prototype.getUseNnapi=function(){return t.Message.getBooleanFieldWithDefault(this,3,!1)},proto.mediapipe.InferenceCalculatorOptions.prototype.setUseNnapi=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.InferenceCalculatorOptions.prototype.clearUseNnapi=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.InferenceCalculatorOptions.prototype.hasUseNnapi=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.InferenceCalculatorOptions.prototype.getCpuNumThread=function(){return t.Message.getFieldWithDefault(this,4,-1)},proto.mediapipe.InferenceCalculatorOptions.prototype.setCpuNumThread=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.InferenceCalculatorOptions.prototype.clearCpuNumThread=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.InferenceCalculatorOptions.prototype.hasCpuNumThread=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.InferenceCalculatorOptions.prototype.getDelegate=function(){return t.Message.getWrapperField(this,proto.mediapipe.InferenceCalculatorOptions.Delegate,5)},proto.mediapipe.InferenceCalculatorOptions.prototype.setDelegate=function(e){return t.Message.setWrapperField(this,5,e)},proto.mediapipe.InferenceCalculatorOptions.prototype.clearDelegate=function(){return this.setDelegate(void 0)},proto.mediapipe.InferenceCalculatorOptions.prototype.hasDelegate=function(){return null!=t.Message.getField(this,5)},proto.mediapipe.InferenceCalculatorOptions.ext=new t.ExtensionFieldInfo(336783863,{ext:0},proto.mediapipe.InferenceCalculatorOptions,proto.mediapipe.InferenceCalculatorOptions.toObject,0),o.CalculatorOptions.extensionsBinary[336783863]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.InferenceCalculatorOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.InferenceCalculatorOptions.serializeBinaryToWriter,proto.mediapipe.InferenceCalculatorOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[336783863]=proto.mediapipe.InferenceCalculatorOptions.ext,n.object.extend(e,proto.mediapipe)}(inference_calculator_pb),function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=inference_calculator_pb;n.object.extend(proto,i),n.exportSymbol("proto.mediapipe.tasks.core.proto.Acceleration",null,r),n.exportSymbol("proto.mediapipe.tasks.core.proto.Acceleration.DelegateCase",null,r),proto.mediapipe.tasks.core.proto.Acceleration=function(e){t.Message.initialize(this,e,0,-1,null,proto.mediapipe.tasks.core.proto.Acceleration.oneofGroups_)},n.inherits(proto.mediapipe.tasks.core.proto.Acceleration,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.core.proto.Acceleration.displayName="proto.mediapipe.tasks.core.proto.Acceleration"),proto.mediapipe.tasks.core.proto.Acceleration.oneofGroups_=[[1,2,4,5]],proto.mediapipe.tasks.core.proto.Acceleration.DelegateCase={DELEGATE_NOT_SET:0,XNNPACK:1,GPU:2,TFLITE:4,NNAPI:5},proto.mediapipe.tasks.core.proto.Acceleration.prototype.getDelegateCase=function(){return t.Message.computeOneofCase(this,proto.mediapipe.tasks.core.proto.Acceleration.oneofGroups_[0])},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.core.proto.Acceleration.prototype.toObject=function(e){return proto.mediapipe.tasks.core.proto.Acceleration.toObject(e,this)},proto.mediapipe.tasks.core.proto.Acceleration.toObject=function(e,t){var n,r={xnnpack:(n=t.getXnnpack())&&i.InferenceCalculatorOptions.Delegate.Xnnpack.toObject(e,n),gpu:(n=t.getGpu())&&i.InferenceCalculatorOptions.Delegate.Gpu.toObject(e,n),tflite:(n=t.getTflite())&&i.InferenceCalculatorOptions.Delegate.TfLite.toObject(e,n),nnapi:(n=t.getNnapi())&&i.InferenceCalculatorOptions.Delegate.Nnapi.toObject(e,n)};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.tasks.core.proto.Acceleration.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.core.proto.Acceleration;return proto.mediapipe.tasks.core.proto.Acceleration.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.core.proto.Acceleration.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new i.InferenceCalculatorOptions.Delegate.Xnnpack;t.readMessage(n,i.InferenceCalculatorOptions.Delegate.Xnnpack.deserializeBinaryFromReader),e.setXnnpack(n);break;case 2:n=new i.InferenceCalculatorOptions.Delegate.Gpu,t.readMessage(n,i.InferenceCalculatorOptions.Delegate.Gpu.deserializeBinaryFromReader),e.setGpu(n);break;case 4:n=new i.InferenceCalculatorOptions.Delegate.TfLite,t.readMessage(n,i.InferenceCalculatorOptions.Delegate.TfLite.deserializeBinaryFromReader),e.setTflite(n);break;case 5:n=new i.InferenceCalculatorOptions.Delegate.Nnapi,t.readMessage(n,i.InferenceCalculatorOptions.Delegate.Nnapi.deserializeBinaryFromReader),e.setNnapi(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.core.proto.Acceleration.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.core.proto.Acceleration.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.core.proto.Acceleration.serializeBinaryToWriter=function(e,t){var n=void 0;null!=(n=e.getXnnpack())&&t.writeMessage(1,n,i.InferenceCalculatorOptions.Delegate.Xnnpack.serializeBinaryToWriter),null!=(n=e.getGpu())&&t.writeMessage(2,n,i.InferenceCalculatorOptions.Delegate.Gpu.serializeBinaryToWriter),null!=(n=e.getTflite())&&t.writeMessage(4,n,i.InferenceCalculatorOptions.Delegate.TfLite.serializeBinaryToWriter),null!=(n=e.getNnapi())&&t.writeMessage(5,n,i.InferenceCalculatorOptions.Delegate.Nnapi.serializeBinaryToWriter)},proto.mediapipe.tasks.core.proto.Acceleration.prototype.getXnnpack=function(){return t.Message.getWrapperField(this,i.InferenceCalculatorOptions.Delegate.Xnnpack,1)},proto.mediapipe.tasks.core.proto.Acceleration.prototype.setXnnpack=function(e){return t.Message.setOneofWrapperField(this,1,proto.mediapipe.tasks.core.proto.Acceleration.oneofGroups_[0],e)},proto.mediapipe.tasks.core.proto.Acceleration.prototype.clearXnnpack=function(){return this.setXnnpack(void 0)},proto.mediapipe.tasks.core.proto.Acceleration.prototype.hasXnnpack=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.core.proto.Acceleration.prototype.getGpu=function(){return t.Message.getWrapperField(this,i.InferenceCalculatorOptions.Delegate.Gpu,2)},proto.mediapipe.tasks.core.proto.Acceleration.prototype.setGpu=function(e){return t.Message.setOneofWrapperField(this,2,proto.mediapipe.tasks.core.proto.Acceleration.oneofGroups_[0],e)},proto.mediapipe.tasks.core.proto.Acceleration.prototype.clearGpu=function(){return this.setGpu(void 0)},proto.mediapipe.tasks.core.proto.Acceleration.prototype.hasGpu=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.core.proto.Acceleration.prototype.getTflite=function(){return t.Message.getWrapperField(this,i.InferenceCalculatorOptions.Delegate.TfLite,4)},proto.mediapipe.tasks.core.proto.Acceleration.prototype.setTflite=function(e){return t.Message.setOneofWrapperField(this,4,proto.mediapipe.tasks.core.proto.Acceleration.oneofGroups_[0],e)},proto.mediapipe.tasks.core.proto.Acceleration.prototype.clearTflite=function(){return this.setTflite(void 0)},proto.mediapipe.tasks.core.proto.Acceleration.prototype.hasTflite=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.tasks.core.proto.Acceleration.prototype.getNnapi=function(){return t.Message.getWrapperField(this,i.InferenceCalculatorOptions.Delegate.Nnapi,5)},proto.mediapipe.tasks.core.proto.Acceleration.prototype.setNnapi=function(e){return t.Message.setOneofWrapperField(this,5,proto.mediapipe.tasks.core.proto.Acceleration.oneofGroups_[0],e)},proto.mediapipe.tasks.core.proto.Acceleration.prototype.clearNnapi=function(){return this.setNnapi(void 0)},proto.mediapipe.tasks.core.proto.Acceleration.prototype.hasNnapi=function(){return null!=t.Message.getField(this,5)},n.object.extend(e,proto.mediapipe.tasks.core.proto)}(acceleration_pb);var external_file_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.tasks.core.proto.ExternalFile",null,r),n.exportSymbol("proto.mediapipe.tasks.core.proto.FileDescriptorMeta",null,r),n.exportSymbol("proto.mediapipe.tasks.core.proto.FilePointerMeta",null,r),proto.mediapipe.tasks.core.proto.ExternalFile=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.core.proto.ExternalFile,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.core.proto.ExternalFile.displayName="proto.mediapipe.tasks.core.proto.ExternalFile"),proto.mediapipe.tasks.core.proto.FileDescriptorMeta=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.core.proto.FileDescriptorMeta,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.core.proto.FileDescriptorMeta.displayName="proto.mediapipe.tasks.core.proto.FileDescriptorMeta"),proto.mediapipe.tasks.core.proto.FilePointerMeta=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.core.proto.FilePointerMeta,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.core.proto.FilePointerMeta.displayName="proto.mediapipe.tasks.core.proto.FilePointerMeta"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.core.proto.ExternalFile.prototype.toObject=function(e){return proto.mediapipe.tasks.core.proto.ExternalFile.toObject(e,this)},proto.mediapipe.tasks.core.proto.ExternalFile.toObject=function(e,n){var r,i={fileContent:n.getFileContent_asB64(),fileName:null==(r=t.Message.getField(n,2))?void 0:r,fileDescriptorMeta:(r=n.getFileDescriptorMeta())&&proto.mediapipe.tasks.core.proto.FileDescriptorMeta.toObject(e,r),filePointerMeta:(r=n.getFilePointerMeta())&&proto.mediapipe.tasks.core.proto.FilePointerMeta.toObject(e,r)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.core.proto.ExternalFile.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.core.proto.ExternalFile;return proto.mediapipe.tasks.core.proto.ExternalFile.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.core.proto.ExternalFile.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readBytes();e.setFileContent(n);break;case 2:n=t.readString(),e.setFileName(n);break;case 3:n=new proto.mediapipe.tasks.core.proto.FileDescriptorMeta,t.readMessage(n,proto.mediapipe.tasks.core.proto.FileDescriptorMeta.deserializeBinaryFromReader),e.setFileDescriptorMeta(n);break;case 4:n=new proto.mediapipe.tasks.core.proto.FilePointerMeta,t.readMessage(n,proto.mediapipe.tasks.core.proto.FilePointerMeta.deserializeBinaryFromReader),e.setFilePointerMeta(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.core.proto.ExternalFile.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.core.proto.ExternalFile.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeBytes(1,r),null!=(r=t.Message.getField(e,2))&&n.writeString(2,r),null!=(r=e.getFileDescriptorMeta())&&n.writeMessage(3,r,proto.mediapipe.tasks.core.proto.FileDescriptorMeta.serializeBinaryToWriter),null!=(r=e.getFilePointerMeta())&&n.writeMessage(4,r,proto.mediapipe.tasks.core.proto.FilePointerMeta.serializeBinaryToWriter)},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.getFileContent=function(){return t.Message.getFieldWithDefault(this,1,"")},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.getFileContent_asB64=function(){return t.Message.bytesAsB64(this.getFileContent())},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.getFileContent_asU8=function(){return t.Message.bytesAsU8(this.getFileContent())},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.setFileContent=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.clearFileContent=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.hasFileContent=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.getFileName=function(){return t.Message.getFieldWithDefault(this,2,"")},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.setFileName=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.clearFileName=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.hasFileName=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.getFileDescriptorMeta=function(){return t.Message.getWrapperField(this,proto.mediapipe.tasks.core.proto.FileDescriptorMeta,3)},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.setFileDescriptorMeta=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.clearFileDescriptorMeta=function(){return this.setFileDescriptorMeta(void 0)},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.hasFileDescriptorMeta=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.getFilePointerMeta=function(){return t.Message.getWrapperField(this,proto.mediapipe.tasks.core.proto.FilePointerMeta,4)},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.setFilePointerMeta=function(e){return t.Message.setWrapperField(this,4,e)},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.clearFilePointerMeta=function(){return this.setFilePointerMeta(void 0)},proto.mediapipe.tasks.core.proto.ExternalFile.prototype.hasFilePointerMeta=function(){return null!=t.Message.getField(this,4)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.core.proto.FileDescriptorMeta.prototype.toObject=function(e){return proto.mediapipe.tasks.core.proto.FileDescriptorMeta.toObject(e,this)},proto.mediapipe.tasks.core.proto.FileDescriptorMeta.toObject=function(e,n){var r,i={fd:null==(r=t.Message.getField(n,1))?void 0:r,length:null==(r=t.Message.getField(n,2))?void 0:r,offset:null==(r=t.Message.getField(n,3))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.core.proto.FileDescriptorMeta.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.core.proto.FileDescriptorMeta;return proto.mediapipe.tasks.core.proto.FileDescriptorMeta.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.core.proto.FileDescriptorMeta.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readInt32();e.setFd(n);break;case 2:n=t.readInt64(),e.setLength(n);break;case 3:n=t.readInt64(),e.setOffset(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.core.proto.FileDescriptorMeta.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.core.proto.FileDescriptorMeta.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.core.proto.FileDescriptorMeta.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeInt32(1,r),null!=(r=t.Message.getField(e,2))&&n.writeInt64(2,r),null!=(r=t.Message.getField(e,3))&&n.writeInt64(3,r)},proto.mediapipe.tasks.core.proto.FileDescriptorMeta.prototype.getFd=function(){return t.Message.getFieldWithDefault(this,1,0)},proto.mediapipe.tasks.core.proto.FileDescriptorMeta.prototype.setFd=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.tasks.core.proto.FileDescriptorMeta.prototype.clearFd=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.tasks.core.proto.FileDescriptorMeta.prototype.hasFd=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.core.proto.FileDescriptorMeta.prototype.getLength=function(){return t.Message.getFieldWithDefault(this,2,0)},proto.mediapipe.tasks.core.proto.FileDescriptorMeta.prototype.setLength=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.core.proto.FileDescriptorMeta.prototype.clearLength=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.core.proto.FileDescriptorMeta.prototype.hasLength=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.core.proto.FileDescriptorMeta.prototype.getOffset=function(){return t.Message.getFieldWithDefault(this,3,0)},proto.mediapipe.tasks.core.proto.FileDescriptorMeta.prototype.setOffset=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.tasks.core.proto.FileDescriptorMeta.prototype.clearOffset=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.tasks.core.proto.FileDescriptorMeta.prototype.hasOffset=function(){return null!=t.Message.getField(this,3)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.core.proto.FilePointerMeta.prototype.toObject=function(e){return proto.mediapipe.tasks.core.proto.FilePointerMeta.toObject(e,this)},proto.mediapipe.tasks.core.proto.FilePointerMeta.toObject=function(e,n){var r,i={pointer:null==(r=t.Message.getField(n,1))?void 0:r,length:null==(r=t.Message.getField(n,2))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.core.proto.FilePointerMeta.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.core.proto.FilePointerMeta;return proto.mediapipe.tasks.core.proto.FilePointerMeta.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.core.proto.FilePointerMeta.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readUint64();e.setPointer(n);break;case 2:n=t.readInt64(),e.setLength(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.core.proto.FilePointerMeta.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.core.proto.FilePointerMeta.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.core.proto.FilePointerMeta.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeUint64(1,r),null!=(r=t.Message.getField(e,2))&&n.writeInt64(2,r)},proto.mediapipe.tasks.core.proto.FilePointerMeta.prototype.getPointer=function(){return t.Message.getFieldWithDefault(this,1,0)},proto.mediapipe.tasks.core.proto.FilePointerMeta.prototype.setPointer=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.tasks.core.proto.FilePointerMeta.prototype.clearPointer=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.tasks.core.proto.FilePointerMeta.prototype.hasPointer=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.core.proto.FilePointerMeta.prototype.getLength=function(){return t.Message.getFieldWithDefault(this,2,0)},proto.mediapipe.tasks.core.proto.FilePointerMeta.prototype.setLength=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.core.proto.FilePointerMeta.prototype.clearLength=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.core.proto.FilePointerMeta.prototype.hasLength=function(){return null!=t.Message.getField(this,2)},n.object.extend(e,proto.mediapipe.tasks.core.proto)}(external_file_pb),function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=acceleration_pb;n.object.extend(proto,i);var o=external_file_pb;n.object.extend(proto,o),n.exportSymbol("proto.mediapipe.tasks.core.proto.BaseOptions",null,r),proto.mediapipe.tasks.core.proto.BaseOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.core.proto.BaseOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.core.proto.BaseOptions.displayName="proto.mediapipe.tasks.core.proto.BaseOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.core.proto.BaseOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.core.proto.BaseOptions.toObject(e,this)},proto.mediapipe.tasks.core.proto.BaseOptions.toObject=function(e,n){var r,a={modelAsset:(r=n.getModelAsset())&&o.ExternalFile.toObject(e,r),useStreamMode:t.Message.getBooleanFieldWithDefault(n,2,!1),acceleration:(r=n.getAcceleration())&&i.Acceleration.toObject(e,r)};return e&&(a.$jspbMessageInstance=n),a}),proto.mediapipe.tasks.core.proto.BaseOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.core.proto.BaseOptions;return proto.mediapipe.tasks.core.proto.BaseOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.core.proto.BaseOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new o.ExternalFile;t.readMessage(n,o.ExternalFile.deserializeBinaryFromReader),e.setModelAsset(n);break;case 2:n=t.readBool(),e.setUseStreamMode(n);break;case 3:n=new i.Acceleration,t.readMessage(n,i.Acceleration.deserializeBinaryFromReader),e.setAcceleration(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.core.proto.BaseOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.core.proto.BaseOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.core.proto.BaseOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getModelAsset())&&n.writeMessage(1,r,o.ExternalFile.serializeBinaryToWriter),null!=(r=t.Message.getField(e,2))&&n.writeBool(2,r),null!=(r=e.getAcceleration())&&n.writeMessage(3,r,i.Acceleration.serializeBinaryToWriter)},proto.mediapipe.tasks.core.proto.BaseOptions.prototype.getModelAsset=function(){return t.Message.getWrapperField(this,o.ExternalFile,1)},proto.mediapipe.tasks.core.proto.BaseOptions.prototype.setModelAsset=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.core.proto.BaseOptions.prototype.clearModelAsset=function(){return this.setModelAsset(void 0)},proto.mediapipe.tasks.core.proto.BaseOptions.prototype.hasModelAsset=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.core.proto.BaseOptions.prototype.getUseStreamMode=function(){return t.Message.getBooleanFieldWithDefault(this,2,!1)},proto.mediapipe.tasks.core.proto.BaseOptions.prototype.setUseStreamMode=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.core.proto.BaseOptions.prototype.clearUseStreamMode=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.core.proto.BaseOptions.prototype.hasUseStreamMode=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.core.proto.BaseOptions.prototype.getAcceleration=function(){return t.Message.getWrapperField(this,i.Acceleration,3)},proto.mediapipe.tasks.core.proto.BaseOptions.prototype.setAcceleration=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.tasks.core.proto.BaseOptions.prototype.clearAcceleration=function(){return this.setAcceleration(void 0)},proto.mediapipe.tasks.core.proto.BaseOptions.prototype.hasAcceleration=function(){return null!=t.Message.getField(this,3)},n.object.extend(e,proto.mediapipe.tasks.core.proto)}(base_options_pb);var face_detector_graph_options_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=base_options_pb;n.object.extend(proto,a),n.exportSymbol("proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions",null,r),proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.displayName="proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.toObject=function(e,n){var r,i={baseOptions:(r=n.getBaseOptions())&&a.BaseOptions.toObject(e,r),minDetectionConfidence:t.Message.getFloatingPointFieldWithDefault(n,2,.5),minSuppressionThreshold:t.Message.getFloatingPointFieldWithDefault(n,3,.5),numFaces:null==(r=t.Message.getField(n,4))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions;return proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new a.BaseOptions;t.readMessage(n,a.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=t.readFloat(),e.setMinDetectionConfidence(n);break;case 3:n=t.readFloat(),e.setMinSuppressionThreshold(n);break;case 4:n=t.readInt32(),e.setNumFaces(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getBaseOptions())&&n.writeMessage(1,r,a.BaseOptions.serializeBinaryToWriter),null!=(r=t.Message.getField(e,2))&&n.writeFloat(2,r),null!=(r=t.Message.getField(e,3))&&n.writeFloat(3,r),null!=(r=t.Message.getField(e,4))&&n.writeInt32(4,r)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.ext=new t.ExtensionFieldInfo(502141897,{ext:0},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions,proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[502141897]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[502141897]=proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.ext,proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,a.BaseOptions,1)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.getMinDetectionConfidence=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,.5)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.setMinDetectionConfidence=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.clearMinDetectionConfidence=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.hasMinDetectionConfidence=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.getMinSuppressionThreshold=function(){return t.Message.getFloatingPointFieldWithDefault(this,3,.5)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.setMinSuppressionThreshold=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.clearMinSuppressionThreshold=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.hasMinSuppressionThreshold=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.getNumFaces=function(){return t.Message.getFieldWithDefault(this,4,0)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.setNumFaces=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.clearNumFaces=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.prototype.hasNumFaces=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.ext=new t.ExtensionFieldInfo(502141897,{ext:0},proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions,proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[502141897]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[502141897]=proto.mediapipe.tasks.vision.face_detector.proto.FaceDetectorGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.face_detector.proto)}(face_detector_graph_options_pb);var detection_result={};Object.defineProperty(detection_result,"__esModule",{value:!0}),detection_result.convertFromDetectionProto=void 0;const DEFAULT_CATEGORY_INDEX=-1;function convertFromDetectionProto(e){var t,n,r,i,o,a,s,u,l,c,p,d,h;const f=e.getScoreList(),g=e.getLabelIdList(),m=e.getLabelList(),y=e.getDisplayNameList(),b={categories:[],keypoints:[]};for(let e=0;e<f.length;e++)b.categories.push({score:f[e],index:null!==(t=g[e])&&void 0!==t?t:DEFAULT_CATEGORY_INDEX,categoryName:null!==(n=m[e])&&void 0!==n?n:"",displayName:null!==(r=y[e])&&void 0!==r?r:""});const v=null===(i=e.getLocationData())||void 0===i?void 0:i.getBoundingBox();if(v&&(b.boundingBox={originX:null!==(o=v.getXmin())&&void 0!==o?o:0,originY:null!==(a=v.getYmin())&&void 0!==a?a:0,width:null!==(s=v.getWidth())&&void 0!==s?s:0,height:null!==(u=v.getHeight())&&void 0!==u?u:0,angle:0}),null===(l=e.getLocationData())||void 0===l?void 0:l.getRelativeKeypointsList().length)for(const t of e.getLocationData().getRelativeKeypointsList())b.keypoints.push({x:null!==(c=t.getX())&&void 0!==c?c:0,y:null!==(p=t.getY())&&void 0!==p?p:0,score:null!==(d=t.getScore())&&void 0!==d?d:0,label:null!==(h=t.getKeypointLabel())&&void 0!==h?h:""});return b}detection_result.convertFromDetectionProto=convertFromDetectionProto;var vision_task_runner={},rect_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.NormalizedRect",null,r),n.exportSymbol("proto.mediapipe.Rect",null,r),proto.mediapipe.Rect=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.Rect,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.Rect.displayName="proto.mediapipe.Rect"),proto.mediapipe.NormalizedRect=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.NormalizedRect,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.NormalizedRect.displayName="proto.mediapipe.NormalizedRect"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.Rect.prototype.toObject=function(e){return proto.mediapipe.Rect.toObject(e,this)},proto.mediapipe.Rect.toObject=function(e,n){var r,i={xCenter:null==(r=t.Message.getField(n,1))?void 0:r,yCenter:null==(r=t.Message.getField(n,2))?void 0:r,height:null==(r=t.Message.getField(n,3))?void 0:r,width:null==(r=t.Message.getField(n,4))?void 0:r,rotation:t.Message.getFloatingPointFieldWithDefault(n,5,0),rectId:null==(r=t.Message.getField(n,6))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.Rect.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.Rect;return proto.mediapipe.Rect.deserializeBinaryFromReader(r,n)},proto.mediapipe.Rect.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readInt32();e.setXCenter(n);break;case 2:n=t.readInt32(),e.setYCenter(n);break;case 3:n=t.readInt32(),e.setHeight(n);break;case 4:n=t.readInt32(),e.setWidth(n);break;case 5:n=t.readFloat(),e.setRotation(n);break;case 6:n=t.readInt64(),e.setRectId(n);break;default:t.skipField()}return e},proto.mediapipe.Rect.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.Rect.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.Rect.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeInt32(1,r),null!=(r=t.Message.getField(e,2))&&n.writeInt32(2,r),null!=(r=t.Message.getField(e,3))&&n.writeInt32(3,r),null!=(r=t.Message.getField(e,4))&&n.writeInt32(4,r),null!=(r=t.Message.getField(e,5))&&n.writeFloat(5,r),null!=(r=t.Message.getField(e,6))&&n.writeInt64(6,r)},proto.mediapipe.Rect.prototype.getXCenter=function(){return t.Message.getFieldWithDefault(this,1,0)},proto.mediapipe.Rect.prototype.setXCenter=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.Rect.prototype.clearXCenter=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.Rect.prototype.hasXCenter=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.Rect.prototype.getYCenter=function(){return t.Message.getFieldWithDefault(this,2,0)},proto.mediapipe.Rect.prototype.setYCenter=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.Rect.prototype.clearYCenter=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.Rect.prototype.hasYCenter=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.Rect.prototype.getHeight=function(){return t.Message.getFieldWithDefault(this,3,0)},proto.mediapipe.Rect.prototype.setHeight=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.Rect.prototype.clearHeight=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.Rect.prototype.hasHeight=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.Rect.prototype.getWidth=function(){return t.Message.getFieldWithDefault(this,4,0)},proto.mediapipe.Rect.prototype.setWidth=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.Rect.prototype.clearWidth=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.Rect.prototype.hasWidth=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.Rect.prototype.getRotation=function(){return t.Message.getFloatingPointFieldWithDefault(this,5,0)},proto.mediapipe.Rect.prototype.setRotation=function(e){return t.Message.setField(this,5,e)},proto.mediapipe.Rect.prototype.clearRotation=function(){return t.Message.setField(this,5,void 0)},proto.mediapipe.Rect.prototype.hasRotation=function(){return null!=t.Message.getField(this,5)},proto.mediapipe.Rect.prototype.getRectId=function(){return t.Message.getFieldWithDefault(this,6,0)},proto.mediapipe.Rect.prototype.setRectId=function(e){return t.Message.setField(this,6,e)},proto.mediapipe.Rect.prototype.clearRectId=function(){return t.Message.setField(this,6,void 0)},proto.mediapipe.Rect.prototype.hasRectId=function(){return null!=t.Message.getField(this,6)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.NormalizedRect.prototype.toObject=function(e){return proto.mediapipe.NormalizedRect.toObject(e,this)},proto.mediapipe.NormalizedRect.toObject=function(e,n){var r,i={xCenter:null==(r=t.Message.getOptionalFloatingPointField(n,1))?void 0:r,yCenter:null==(r=t.Message.getOptionalFloatingPointField(n,2))?void 0:r,height:null==(r=t.Message.getOptionalFloatingPointField(n,3))?void 0:r,width:null==(r=t.Message.getOptionalFloatingPointField(n,4))?void 0:r,rotation:t.Message.getFloatingPointFieldWithDefault(n,5,0),rectId:null==(r=t.Message.getField(n,6))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.NormalizedRect.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.NormalizedRect;return proto.mediapipe.NormalizedRect.deserializeBinaryFromReader(r,n)},proto.mediapipe.NormalizedRect.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readFloat();e.setXCenter(n);break;case 2:n=t.readFloat(),e.setYCenter(n);break;case 3:n=t.readFloat(),e.setHeight(n);break;case 4:n=t.readFloat(),e.setWidth(n);break;case 5:n=t.readFloat(),e.setRotation(n);break;case 6:n=t.readInt64(),e.setRectId(n);break;default:t.skipField()}return e},proto.mediapipe.NormalizedRect.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.NormalizedRect.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.NormalizedRect.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeFloat(1,r),null!=(r=t.Message.getField(e,2))&&n.writeFloat(2,r),null!=(r=t.Message.getField(e,3))&&n.writeFloat(3,r),null!=(r=t.Message.getField(e,4))&&n.writeFloat(4,r),null!=(r=t.Message.getField(e,5))&&n.writeFloat(5,r),null!=(r=t.Message.getField(e,6))&&n.writeInt64(6,r)},proto.mediapipe.NormalizedRect.prototype.getXCenter=function(){return t.Message.getFloatingPointFieldWithDefault(this,1,0)},proto.mediapipe.NormalizedRect.prototype.setXCenter=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.NormalizedRect.prototype.clearXCenter=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.NormalizedRect.prototype.hasXCenter=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.NormalizedRect.prototype.getYCenter=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,0)},proto.mediapipe.NormalizedRect.prototype.setYCenter=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.NormalizedRect.prototype.clearYCenter=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.NormalizedRect.prototype.hasYCenter=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.NormalizedRect.prototype.getHeight=function(){return t.Message.getFloatingPointFieldWithDefault(this,3,0)},proto.mediapipe.NormalizedRect.prototype.setHeight=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.NormalizedRect.prototype.clearHeight=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.NormalizedRect.prototype.hasHeight=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.NormalizedRect.prototype.getWidth=function(){return t.Message.getFloatingPointFieldWithDefault(this,4,0)},proto.mediapipe.NormalizedRect.prototype.setWidth=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.NormalizedRect.prototype.clearWidth=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.NormalizedRect.prototype.hasWidth=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.NormalizedRect.prototype.getRotation=function(){return t.Message.getFloatingPointFieldWithDefault(this,5,0)},proto.mediapipe.NormalizedRect.prototype.setRotation=function(e){return t.Message.setField(this,5,e)},proto.mediapipe.NormalizedRect.prototype.clearRotation=function(){return t.Message.setField(this,5,void 0)},proto.mediapipe.NormalizedRect.prototype.hasRotation=function(){return null!=t.Message.getField(this,5)},proto.mediapipe.NormalizedRect.prototype.getRectId=function(){return t.Message.getFieldWithDefault(this,6,0)},proto.mediapipe.NormalizedRect.prototype.setRectId=function(e){return t.Message.setField(this,6,e)},proto.mediapipe.NormalizedRect.prototype.clearRectId=function(){return t.Message.setField(this,6,void 0)},proto.mediapipe.NormalizedRect.prototype.hasRectId=function(){return null!=t.Message.getField(this,6)},n.object.extend(e,proto.mediapipe)}(rect_pb);var task_runner={},graph_runner={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createGraphRunner=e.createMediaPipeLib=e.GraphRunner=e.CALCULATOR_GRAPH_CONFIG_LISTENER_NAME=void 0;const t=platform_utils;e.CALCULATOR_GRAPH_CONFIG_LISTENER_NAME="__graph_config__";class n{constructor(e,n){this.autoResizeCanvas=!0,this.wasmModule=e,this.audioPtr=null,this.audioSize=0,this.hasMultiStreamSupport="function"==typeof this.wasmModule._addIntToInputStream,void 0!==n?this.wasmModule.canvas=n:"undefined"==typeof OffscreenCanvas||(0,t.isWebKit)()?(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.wasmModule.canvas=document.createElement("canvas")):this.wasmModule.canvas=new OffscreenCanvas(1,1)}async initializeGraph(e){const t=await fetch(e),n=await t.arrayBuffer(),r=!(e.endsWith(".pbtxt")||e.endsWith(".textproto"));this.setGraph(new Uint8Array(n),r)}setGraphFromString(e){this.setGraph((new TextEncoder).encode(e),!1)}setGraph(e,t){const n=e.length,r=this.wasmModule._malloc(n);this.wasmModule.HEAPU8.set(e,r),t?this.wasmModule._changeBinaryGraph(n,r):this.wasmModule._changeTextGraph(n,r),this.wasmModule._free(r)}configureAudio(e,t,n,r,i){this.wasmModule._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),r=r||"input_audio",this.wrapStringPtr(r,(r=>{i=i||"audio_header",this.wrapStringPtr(i,(i=>{this.wasmModule._configureAudio(r,i,e,t,n)}))}))}setAutoResizeCanvas(e){this.autoResizeCanvas=e}setAutoRenderToScreen(e){this.wasmModule._setAutoRenderToScreen(e)}bindTextureToStream(e,t){if(!this.wasmModule.canvas)throw new Error("No OpenGL canvas configured.");t?this.wasmModule._bindTextureToStream(t):console.assert(this.wasmModule._bindTextureToCanvas());const n=this.wasmModule.canvas.getContext("webgl2")||this.wasmModule.canvas.getContext("webgl");if(!n)throw new Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");let r,i;return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e),e.videoWidth?(r=e.videoWidth,i=e.videoHeight):e.naturalWidth?(r=e.naturalWidth,i=e.naturalHeight):(r=e.width,i=e.height),!this.autoResizeCanvas||r===this.wasmModule.canvas.width&&i===this.wasmModule.canvas.height||(this.wasmModule.canvas.width=r,this.wasmModule.canvas.height=i),[r,i]}processGl(e,t){const[n,r]=this.bindTextureToStream(e),i=this.wasmModule._malloc(16);this.wasmModule.HEAPU32[i/4]=n,this.wasmModule.HEAPU32[i/4+1]=r,this.wasmModule.HEAPF64[i/8+1]=t,this.wasmModule._processGl(i),this.wasmModule._free(i)}wrapStringPtr(e,t){this.hasMultiStreamSupport||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const n=this.wasmModule.stringToNewUTF8(e);t(n),this.wasmModule._free(n)}wrapStringPtrPtr(e,t){this.hasMultiStreamSupport||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const n=new Uint32Array(e.length);for(let t=0;t<e.length;t++)n[t]=this.wasmModule.stringToNewUTF8(e[t]);const r=this.wasmModule._malloc(4*n.length);this.wasmModule.HEAPU32.set(n,r>>2),t(r);for(const e of n)this.wasmModule._free(e);this.wasmModule._free(r)}getCalculatorGraphConfig(t,n){const r=e.CALCULATOR_GRAPH_CONFIG_LISTENER_NAME;this.setListener(r,(e=>{t(e)})),this.wrapStringPtr(r,(e=>{this.wasmModule._getGraphConfig(e,n)})),delete this.wasmModule.simpleListeners[r]}setListener(e,t){this.wasmModule.simpleListeners=this.wasmModule.simpleListeners||{},this.wasmModule.simpleListeners[e]=t}setVectorListener(e,t){let n=[];this.wasmModule.simpleListeners=this.wasmModule.simpleListeners||{},this.wasmModule.simpleListeners[e]=(e,r,i)=>{r?(t(n,i),n=[]):n.push(e)}}attachErrorListener(e){this.wasmModule.errorListener=e}attachEmptyPacketListener(e,t){this.wasmModule.emptyPacketListeners=this.wasmModule.emptyPacketListeners||{},this.wasmModule.emptyPacketListeners[e]=t}addAudioToStream(e,t,n){this.addAudioToStreamWithShape(e,0,0,t,n)}addAudioToStreamWithShape(e,t,n,r,i){const o=4*e.length;this.audioSize!==o&&(this.audioPtr&&this.wasmModule._free(this.audioPtr),this.audioPtr=this.wasmModule._malloc(o),this.audioSize=o),this.wasmModule.HEAPF32.set(e,this.audioPtr/4),this.wrapStringPtr(r,(e=>{this.wasmModule._addAudioToInputStream(this.audioPtr,t,n,e,i)}))}addGpuBufferToStream(e,t,n){this.wrapStringPtr(t,(t=>{const[r,i]=this.bindTextureToStream(e,t);this.wasmModule._addBoundTextureToStream(t,r,i,n)}))}addBoolToStream(e,t,n){this.wrapStringPtr(t,(t=>{this.wasmModule._addBoolToInputStream(e,t,n)}))}addDoubleToStream(e,t,n){this.wrapStringPtr(t,(t=>{this.wasmModule._addDoubleToInputStream(e,t,n)}))}addFloatToStream(e,t,n){this.wrapStringPtr(t,(t=>{this.wasmModule._addFloatToInputStream(e,t,n)}))}addIntToStream(e,t,n){this.wrapStringPtr(t,(t=>{this.wasmModule._addIntToInputStream(e,t,n)}))}addStringToStream(e,t,n){this.wrapStringPtr(t,(t=>{this.wrapStringPtr(e,(e=>{this.wasmModule._addStringToInputStream(e,t,n)}))}))}addStringRecordToStream(e,t,n){this.wrapStringPtr(t,(t=>{this.wrapStringPtrPtr(Object.keys(e),(r=>{this.wrapStringPtrPtr(Object.values(e),(i=>{this.wasmModule._addFlatHashMapToInputStream(r,i,Object.keys(e).length,t,n)}))}))}))}addProtoToStream(e,t,n,r){this.wrapStringPtr(n,(n=>{this.wrapStringPtr(t,(t=>{const i=this.wasmModule._malloc(e.length);this.wasmModule.HEAPU8.set(e,i),this.wasmModule._addProtoToInputStream(i,e.length,t,n,r),this.wasmModule._free(i)}))}))}addEmptyPacketToStream(e,t){this.wrapStringPtr(e,(e=>{this.wasmModule._addEmptyPacketToInputStream(e,t)}))}addBoolToInputSidePacket(e,t){this.wrapStringPtr(t,(t=>{this.wasmModule._addBoolToInputSidePacket(e,t)}))}addDoubleToInputSidePacket(e,t){this.wrapStringPtr(t,(t=>{this.wasmModule._addDoubleToInputSidePacket(e,t)}))}addFloatToInputSidePacket(e,t){this.wrapStringPtr(t,(t=>{this.wasmModule._addFloatToInputSidePacket(e,t)}))}addIntToInputSidePacket(e,t){this.wrapStringPtr(t,(t=>{this.wasmModule._addIntToInputSidePacket(e,t)}))}addStringToInputSidePacket(e,t){this.wrapStringPtr(t,(t=>{this.wrapStringPtr(e,(e=>{this.wasmModule._addStringToInputSidePacket(e,t)}))}))}addProtoToInputSidePacket(e,t,n){this.wrapStringPtr(n,(n=>{this.wrapStringPtr(t,(t=>{const r=this.wasmModule._malloc(e.length);this.wasmModule.HEAPU8.set(e,r),this.wasmModule._addProtoToInputSidePacket(r,e.length,t,n),this.wasmModule._free(r)}))}))}attachBoolListener(e,t){this.setListener(e,t),this.wrapStringPtr(e,(e=>{this.wasmModule._attachBoolListener(e)}))}attachBoolVectorListener(e,t){this.setVectorListener(e,t),this.wrapStringPtr(e,(e=>{this.wasmModule._attachBoolVectorListener(e)}))}attachIntListener(e,t){this.setListener(e,t),this.wrapStringPtr(e,(e=>{this.wasmModule._attachIntListener(e)}))}attachIntVectorListener(e,t){this.setVectorListener(e,t),this.wrapStringPtr(e,(e=>{this.wasmModule._attachIntVectorListener(e)}))}attachDoubleListener(e,t){this.setListener(e,t),this.wrapStringPtr(e,(e=>{this.wasmModule._attachDoubleListener(e)}))}attachDoubleVectorListener(e,t){this.setVectorListener(e,t),this.wrapStringPtr(e,(e=>{this.wasmModule._attachDoubleVectorListener(e)}))}attachFloatListener(e,t){this.setListener(e,t),this.wrapStringPtr(e,(e=>{this.wasmModule._attachFloatListener(e)}))}attachFloatVectorListener(e,t){this.setVectorListener(e,t),this.wrapStringPtr(e,(e=>{this.wasmModule._attachFloatVectorListener(e)}))}attachStringListener(e,t){this.setListener(e,t),this.wrapStringPtr(e,(e=>{this.wasmModule._attachStringListener(e)}))}attachStringVectorListener(e,t){this.setVectorListener(e,t),this.wrapStringPtr(e,(e=>{this.wasmModule._attachStringVectorListener(e)}))}attachProtoListener(e,t,n){this.setListener(e,t),this.wrapStringPtr(e,(e=>{this.wasmModule._attachProtoListener(e,n||!1)}))}attachProtoVectorListener(e,t,n){this.setVectorListener(e,t),this.wrapStringPtr(e,(e=>{this.wasmModule._attachProtoVectorListener(e,n||!1)}))}attachAudioListener(e,t,n){this.wasmModule._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),this.setListener(e,((e,n)=>{const r=new Float32Array(e.buffer,e.byteOffset,e.length/4);t(r,n)})),this.wrapStringPtr(e,(e=>{this.wasmModule._attachAudioListener(e,n||!1)}))}finishProcessing(){this.wasmModule._waitUntilIdle()}closeGraph(){this.wasmModule._closeGraph(),this.wasmModule.simpleListeners=void 0,this.wasmModule.emptyPacketListeners=void 0}}async function r(e){if("function"!=typeof importScripts){const t=document.createElement("script");return t.setAttribute("src",e),t.setAttribute("crossorigin","anonymous"),new Promise((e=>{t.addEventListener("load",(()=>{e()}),!1),t.addEventListener("error",(()=>{e()}),!1),document.body.appendChild(t)}))}importScripts(e.toString())}async function i(e,t,n,i,o){const a=[];if(t&&a.push(t),n&&a.push(n),a.length&&await Promise.all(a.map(r)),!self.ModuleFactory)throw new Error("ModuleFactory not set.");if(self.Module&&o){const e=self.Module;e.locateFile=o.locateFile,o.mainScriptUrlOrBlob&&(e.mainScriptUrlOrBlob=o.mainScriptUrlOrBlob)}const s=await self.ModuleFactory(self.Module||o);return self.ModuleFactory=self.Module=void 0,new e(s,i)}e.GraphRunner=n,e.createMediaPipeLib=i,e.createGraphRunner=async function(e,t,r,o){return i(n,e,t,r,o)}}(graph_runner);var register_model_resources_graph_service={};function SupportModelResourcesGraphService(e){return class extends e{registerModelResourcesGraphService(){this.wasmModule._registerModelResourcesGraphService()}}}Object.defineProperty(register_model_resources_graph_service,"__esModule",{value:!0}),register_model_resources_graph_service.SupportModelResourcesGraphService=void 0,register_model_resources_graph_service.SupportModelResourcesGraphService=SupportModelResourcesGraphService,Object.defineProperty(task_runner,"__esModule",{value:!0}),task_runner.TaskRunner=task_runner.createTaskRunner=task_runner.CachedGraphRunner=void 0;const inference_calculator_pb_1=inference_calculator_pb,calculator_pb_1=calculator_pb,acceleration_pb_1=acceleration_pb,external_file_pb_1=external_file_pb,graph_runner_1$1=graph_runner,register_model_resources_graph_service_1$1=register_model_resources_graph_service,FREE_MEMORY_STREAM="free_memory",UNUSED_STREAM_SUFFIX="_unused_out",CachedGraphRunnerType=(0,register_model_resources_graph_service_1$1.SupportModelResourcesGraphService)(graph_runner_1$1.GraphRunner);class CachedGraphRunner extends CachedGraphRunnerType{}async function createTaskRunner(e,t,n,r){const i={locateFile:()=>n.wasmBinaryPath.toString()},o=await(0,graph_runner_1$1.createMediaPipeLib)(e,n.wasmLoaderPath,n.assetLoaderPath,t,i);return await o.setOptions(r),o}task_runner.CachedGraphRunner=CachedGraphRunner,task_runner.createTaskRunner=createTaskRunner;class TaskRunner{static async createInstance(e,t,n,r){return createTaskRunner(e,t,n,r)}constructor(e){this.graphRunner=e,this.processingErrors=[],this.latestOutputTimestamp=0,this.graphRunner.setAutoRenderToScreen(!1)}applyOptions(e,t=!0){var n,r,i,o,a,s;if(t){const t=e.baseOptions||{};if((null===(n=e.baseOptions)||void 0===n?void 0:n.modelAssetBuffer)&&(null===(r=e.baseOptions)||void 0===r?void 0:r.modelAssetPath))throw new Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!((null===(i=this.baseOptions.getModelAsset())||void 0===i?void 0:i.hasFileContent())||(null===(o=this.baseOptions.getModelAsset())||void 0===o?void 0:o.hasFileName())||(null===(a=e.baseOptions)||void 0===a?void 0:a.modelAssetBuffer)||(null===(s=e.baseOptions)||void 0===s?void 0:s.modelAssetPath)))throw new Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(this.setAcceleration(t),t.modelAssetPath)return fetch(t.modelAssetPath.toString()).then((e=>{if(e.ok)return e.arrayBuffer();throw new Error(`Failed to fetch model: ${t.modelAssetPath} (${e.status})`)})).then((e=>{try{this.graphRunner.wasmModule.FS_unlink("/model.dat")}catch(e){}this.graphRunner.wasmModule.FS_createDataFile("/","model.dat",new Uint8Array(e),!0,!1,!1),this.setExternalFile("/model.dat"),this.refreshGraph(),this.onGraphRefreshed()}));this.setExternalFile(t.modelAssetBuffer)}return this.refreshGraph(),this.onGraphRefreshed(),Promise.resolve()}onGraphRefreshed(){}getCalculatorGraphConfig(){let e;if(this.graphRunner.getCalculatorGraphConfig((t=>{e=calculator_pb_1.CalculatorGraphConfig.deserializeBinary(t)})),!e)throw new Error("Failed to retrieve CalculatorGraphConfig");return e}setGraph(e,t){this.graphRunner.attachErrorListener(((e,t)=>{this.processingErrors.push(new Error(t))})),this.graphRunner.registerModelResourcesGraphService(),this.graphRunner.setGraph(e,t),this.keepaliveNode=void 0,this.handleErrors()}finishProcessing(){this.graphRunner.finishProcessing(),this.handleErrors()}setLatestOutputTimestamp(e){this.latestOutputTimestamp=Math.max(this.latestOutputTimestamp,e)}getSynctheticTimestamp(){return this.latestOutputTimestamp+1}handleErrors(){try{const e=this.processingErrors.length;if(1===e)throw new Error(this.processingErrors[0].message);if(e>1)throw new Error("Encountered multiple errors: "+this.processingErrors.map((e=>e.message)).join(", "))}finally{this.processingErrors=[]}}setExternalFile(e){const t=this.baseOptions.getModelAsset()||new external_file_pb_1.ExternalFile;"string"==typeof e?(t.setFileName(e),t.clearFileContent()):e instanceof Uint8Array&&(t.setFileContent(e),t.clearFileName()),this.baseOptions.setModelAsset(t)}setAcceleration(e){let t=this.baseOptions.getAcceleration();t||(t=new acceleration_pb_1.Acceleration,t.setTflite(new inference_calculator_pb_1.InferenceCalculatorOptions.Delegate.TfLite)),"delegate"in e&&("GPU"===e.delegate?t.setGpu(new inference_calculator_pb_1.InferenceCalculatorOptions.Delegate.Gpu):t.setTflite(new inference_calculator_pb_1.InferenceCalculatorOptions.Delegate.TfLite)),this.baseOptions.setAcceleration(t)}addKeepaliveNode(e){this.keepaliveNode=new calculator_pb_1.CalculatorGraphConfig.Node,this.keepaliveNode.setCalculator("PassThroughCalculator"),this.keepaliveNode.addInputStream(FREE_MEMORY_STREAM),this.keepaliveNode.addOutputStream(FREE_MEMORY_STREAM+UNUSED_STREAM_SUFFIX),e.addInputStream(FREE_MEMORY_STREAM),e.addNode(this.keepaliveNode)}keepStreamAlive(e){this.keepaliveNode.addInputStream(e),this.keepaliveNode.addOutputStream(e+UNUSED_STREAM_SUFFIX)}freeKeepaliveStreams(){this.graphRunner.addBoolToStream(!0,FREE_MEMORY_STREAM,this.latestOutputTimestamp)}close(){this.keepaliveNode=void 0,this.graphRunner.closeGraph()}}task_runner.TaskRunner=TaskRunner;var graph_runner_image_lib={};function SupportImage(e){return class extends e{get wasmImageModule(){return this.wasmModule}addGpuBufferAsImageToStream(e,t,n){this.wrapStringPtr(t,(t=>{const[r,i]=this.bindTextureToStream(e,t);this.wasmImageModule._addBoundTextureAsImageToStream(t,r,i,n)}))}attachImageListener(e,t){this.setListener(e,t),this.wrapStringPtr(e,(e=>{this.wasmImageModule._attachImageListener(e)}))}attachImageVectorListener(e,t){this.setVectorListener(e,t),this.wrapStringPtr(e,(e=>{this.wasmImageModule._attachImageVectorListener(e)}))}}}Object.defineProperty(graph_runner_image_lib,"__esModule",{value:!0}),graph_runner_image_lib.SupportImage=void 0,graph_runner_image_lib.SupportImage=SupportImage,Object.defineProperty(vision_task_runner,"__esModule",{value:!0}),vision_task_runner.VisionTaskRunner=vision_task_runner.VisionGraphRunner=void 0;const rect_pb_1=rect_pb,task_runner_1=task_runner,image_1$1=image,image_shader_context_1=image_shader_context,mask_1$1=mask,graph_runner_1=graph_runner,graph_runner_image_lib_1=graph_runner_image_lib,platform_utils_1=platform_utils,register_model_resources_graph_service_1=register_model_resources_graph_service,GraphRunnerVisionType=(0,register_model_resources_graph_service_1.SupportModelResourcesGraphService)((0,graph_runner_image_lib_1.SupportImage)(graph_runner_1.GraphRunner));class VisionGraphRunner extends GraphRunnerVisionType{}function createCanvas(){return"undefined"==typeof OffscreenCanvas||(0,platform_utils_1.isWebKit)()?document.createElement("canvas"):void 0}vision_task_runner.VisionGraphRunner=VisionGraphRunner;class VisionTaskRunner extends task_runner_1.TaskRunner{static async createVisionInstance(e,t,n){var r;const i=null!==(r=n.canvas)&&void 0!==r?r:createCanvas();return task_runner_1.TaskRunner.createInstance(e,i,t,n)}constructor(e,t,n,r){super(e),this.graphRunner=e,this.imageStreamName=t,this.normRectStreamName=n,this.roiAllowed=r,this.shaderContext=new image_shader_context_1.MPImageShaderContext}applyOptions(e,t=!0){if("runningMode"in e){const t=!!e.runningMode&&"IMAGE"!==e.runningMode;this.baseOptions.setUseStreamMode(t)}if(void 0!==e.canvas&&this.graphRunner.wasmModule.canvas!==e.canvas)throw new Error("You must create a new task to reset the canvas.");return super.applyOptions(e,t)}processImageData(e,t){var n;if(null===(n=this.baseOptions)||void 0===n?void 0:n.getUseStreamMode())throw new Error("Task is not initialized with image mode. 'runningMode' must be set to 'IMAGE'.");this.process(e,t,this.getSynctheticTimestamp())}processVideoData(e,t,n){var r;if(!(null===(r=this.baseOptions)||void 0===r?void 0:r.getUseStreamMode()))throw new Error("Task is not initialized with video mode. 'runningMode' must be set to 'VIDEO'.");this.process(e,t,n)}getImageSourceSize(e){return void 0!==e.videoWidth?[e.videoWidth,e.videoHeight]:void 0!==e.naturalWidth?[e.naturalWidth,e.naturalHeight]:[e.width,e.height]}convertToNormalizedRect(e,t){const n=new rect_pb_1.NormalizedRect;if(null==t?void 0:t.regionOfInterest){if(!this.roiAllowed)throw new Error("This task doesn't support region-of-interest.");const e=t.regionOfInterest;if(e.left>=e.right||e.top>=e.bottom)throw new Error("Expected RectF with left < right and top < bottom.");if(e.left<0||e.top<0||e.right>1||e.bottom>1)throw new Error("Expected RectF values to be in [0,1].");n.setXCenter((e.left+e.right)/2),n.setYCenter((e.top+e.bottom)/2),n.setWidth(e.right-e.left),n.setHeight(e.bottom-e.top)}else n.setXCenter(.5),n.setYCenter(.5),n.setWidth(1),n.setHeight(1);if(null==t?void 0:t.rotationDegrees){if((null==t?void 0:t.rotationDegrees)%90!=0)throw new Error("Expected rotation to be a multiple of 90.");if(n.setRotation(-Math.PI*t.rotationDegrees/180),(null==t?void 0:t.rotationDegrees)%180!=0){const[t,r]=this.getImageSourceSize(e),i=n.getHeight()*r/t,o=n.getWidth()*t/r;n.setWidth(i),n.setHeight(o)}}return n}process(e,t,n){if(this.normRectStreamName){const r=this.convertToNormalizedRect(e,t);this.graphRunner.addProtoToStream(r.serializeBinary(),"mediapipe.NormalizedRect",this.normRectStreamName,n)}this.graphRunner.addGpuBufferAsImageToStream(e,this.imageStreamName,null!=n?n:performance.now()),this.finishProcessing()}convertToMPImage(e,t){const{data:n,width:r,height:i}=e,o=r*i;let a;if(n instanceof Uint8Array)if(n.length===3*o){const e=new Uint8ClampedArray(4*o);for(let t=0;t<o;++t)e[4*t]=n[3*t],e[4*t+1]=n[3*t+1],e[4*t+2]=n[3*t+2],e[4*t+3]=255;a=new ImageData(e,r,i)}else{if(n.length!==4*o)throw new Error("Unsupported channel count: "+n.length/o);a=new ImageData(new Uint8ClampedArray(n.buffer,n.byteOffset,n.length),r,i)}else{if(!(n instanceof WebGLTexture))throw new Error(`Unsupported format: ${n.constructor.name}`);a=n}const s=new image_1$1.MPImage([a],!1,!1,this.graphRunner.wasmModule.canvas,this.shaderContext,r,i);return t?s.clone():s}convertToMPMask(e,t){const{data:n,width:r,height:i}=e,o=r*i;let a;if(n instanceof Uint8Array||n instanceof Float32Array){if(n.length!==o)throw new Error("Unsupported channel count: "+n.length/o);a=n}else a=n;const s=new mask_1$1.MPMask([a],!1,this.graphRunner.wasmModule.canvas,this.shaderContext,r,i);return t?s.clone():s}close(){this.shaderContext.close(),super.close()}}vision_task_runner.VisionTaskRunner=VisionTaskRunner;var face_detector_options={};Object.defineProperty(face_detector_options,"__esModule",{value:!0});var face_detector_result={};Object.defineProperty(face_detector_result,"__esModule",{value:!0}),function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.FaceDetector=void 0;const r=calculator_pb,i=calculator_options_pb,o=detection_pb,a=base_options_pb,s=face_detector_graph_options_pb,u=detection_result,l=vision_task_runner,c="image_in",p="norm_rect_in",d="detections";n(face_detector_options,e),n(face_detector_result,e);class h extends l.VisionTaskRunner{static createFromOptions(e,t){return l.VisionTaskRunner.createVisionInstance(h,e,t)}static createFromModelBuffer(e,t){return l.VisionTaskRunner.createVisionInstance(h,e,{baseOptions:{modelAssetBuffer:t}})}static async createFromModelPath(e,t){return l.VisionTaskRunner.createVisionInstance(h,e,{baseOptions:{modelAssetPath:t}})}constructor(e,t){super(new l.VisionGraphRunner(e,t),c,p,!1),this.result={detections:[]},this.options=new s.FaceDetectorGraphOptions,this.options.setBaseOptions(new a.BaseOptions),this.options.setMinDetectionConfidence(.5),this.options.setMinSuppressionThreshold(.3)}get baseOptions(){return this.options.getBaseOptions()}set baseOptions(e){this.options.setBaseOptions(e)}setOptions(e){var t,n;return"minDetectionConfidence"in e&&this.options.setMinDetectionConfidence(null!==(t=e.minDetectionConfidence)&&void 0!==t?t:.5),"minSuppressionThreshold"in e&&this.options.setMinSuppressionThreshold(null!==(n=e.minSuppressionThreshold)&&void 0!==n?n:.3),this.applyOptions(e)}detect(e,t){return this.result={detections:[]},this.processImageData(e,t),this.result}detectForVideo(e,t,n){return this.result={detections:[]},this.processVideoData(e,n,t),this.result}addJsFaceDetections(e){for(const t of e){const e=o.Detection.deserializeBinary(t);this.result.detections.push((0,u.convertFromDetectionProto)(e))}}refreshGraph(){const e=new r.CalculatorGraphConfig;e.addInputStream(c),e.addInputStream(p),e.addOutputStream(d);const t=new i.CalculatorOptions;t.setExtension(s.FaceDetectorGraphOptions.ext,this.options);const n=new r.CalculatorGraphConfig.Node;n.setCalculator("mediapipe.tasks.vision.face_detector.FaceDetectorGraph"),n.addInputStream("IMAGE:"+c),n.addInputStream("NORM_RECT:"+p),n.addOutputStream("DETECTIONS:"+d),n.setOptions(t),e.addNode(n),this.graphRunner.attachProtoVectorListener(d,((e,t)=>{this.addJsFaceDetections(e),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(d,(e=>{this.setLatestOutputTimestamp(e)}));const o=e.serializeBinary();this.setGraph(new Uint8Array(o),!0)}}e.FaceDetector=h}(face_detector);var face_landmarker={},classification_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.Classification",null,r),n.exportSymbol("proto.mediapipe.ClassificationList",null,r),n.exportSymbol("proto.mediapipe.ClassificationListCollection",null,r),proto.mediapipe.Classification=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.Classification,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.Classification.displayName="proto.mediapipe.Classification"),proto.mediapipe.ClassificationList=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.ClassificationList.repeatedFields_,null)},n.inherits(proto.mediapipe.ClassificationList,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.ClassificationList.displayName="proto.mediapipe.ClassificationList"),proto.mediapipe.ClassificationListCollection=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.ClassificationListCollection.repeatedFields_,null)},n.inherits(proto.mediapipe.ClassificationListCollection,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.ClassificationListCollection.displayName="proto.mediapipe.ClassificationListCollection"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.Classification.prototype.toObject=function(e){return proto.mediapipe.Classification.toObject(e,this)},proto.mediapipe.Classification.toObject=function(e,n){var r,i={index:null==(r=t.Message.getField(n,1))?void 0:r,score:null==(r=t.Message.getOptionalFloatingPointField(n,2))?void 0:r,label:null==(r=t.Message.getField(n,3))?void 0:r,displayName:null==(r=t.Message.getField(n,4))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.Classification.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.Classification;return proto.mediapipe.Classification.deserializeBinaryFromReader(r,n)},proto.mediapipe.Classification.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readInt32();e.setIndex(n);break;case 2:n=t.readFloat(),e.setScore(n);break;case 3:n=t.readString(),e.setLabel(n);break;case 4:n=t.readString(),e.setDisplayName(n);break;default:t.skipField()}return e},proto.mediapipe.Classification.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.Classification.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.Classification.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeInt32(1,r),null!=(r=t.Message.getField(e,2))&&n.writeFloat(2,r),null!=(r=t.Message.getField(e,3))&&n.writeString(3,r),null!=(r=t.Message.getField(e,4))&&n.writeString(4,r)},proto.mediapipe.Classification.prototype.getIndex=function(){return t.Message.getFieldWithDefault(this,1,0)},proto.mediapipe.Classification.prototype.setIndex=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.Classification.prototype.clearIndex=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.Classification.prototype.hasIndex=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.Classification.prototype.getScore=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,0)},proto.mediapipe.Classification.prototype.setScore=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.Classification.prototype.clearScore=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.Classification.prototype.hasScore=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.Classification.prototype.getLabel=function(){return t.Message.getFieldWithDefault(this,3,"")},proto.mediapipe.Classification.prototype.setLabel=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.Classification.prototype.clearLabel=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.Classification.prototype.hasLabel=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.Classification.prototype.getDisplayName=function(){return t.Message.getFieldWithDefault(this,4,"")},proto.mediapipe.Classification.prototype.setDisplayName=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.Classification.prototype.clearDisplayName=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.Classification.prototype.hasDisplayName=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.ClassificationList.repeatedFields_=[1],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.ClassificationList.prototype.toObject=function(e){return proto.mediapipe.ClassificationList.toObject(e,this)},proto.mediapipe.ClassificationList.toObject=function(e,n){var r={classificationList:t.Message.toObjectList(n.getClassificationList(),proto.mediapipe.Classification.toObject,e)};return e&&(r.$jspbMessageInstance=n),r}),proto.mediapipe.ClassificationList.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.ClassificationList;return proto.mediapipe.ClassificationList.deserializeBinaryFromReader(r,n)},proto.mediapipe.ClassificationList.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=new proto.mediapipe.Classification;t.readMessage(n,proto.mediapipe.Classification.deserializeBinaryFromReader),e.addClassification(n)}else t.skipField();return e},proto.mediapipe.ClassificationList.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.ClassificationList.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.ClassificationList.serializeBinaryToWriter=function(e,t){var n;(n=e.getClassificationList()).length>0&&t.writeRepeatedMessage(1,n,proto.mediapipe.Classification.serializeBinaryToWriter)},proto.mediapipe.ClassificationList.prototype.getClassificationList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.Classification,1)},proto.mediapipe.ClassificationList.prototype.setClassificationList=function(e){return t.Message.setRepeatedWrapperField(this,1,e)},proto.mediapipe.ClassificationList.prototype.addClassification=function(e,n){return t.Message.addToRepeatedWrapperField(this,1,e,proto.mediapipe.Classification,n)},proto.mediapipe.ClassificationList.prototype.clearClassificationList=function(){return this.setClassificationList([])},proto.mediapipe.ClassificationListCollection.repeatedFields_=[1],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.ClassificationListCollection.prototype.toObject=function(e){return proto.mediapipe.ClassificationListCollection.toObject(e,this)},proto.mediapipe.ClassificationListCollection.toObject=function(e,n){var r={classificationListList:t.Message.toObjectList(n.getClassificationListList(),proto.mediapipe.ClassificationList.toObject,e)};return e&&(r.$jspbMessageInstance=n),r}),proto.mediapipe.ClassificationListCollection.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.ClassificationListCollection;return proto.mediapipe.ClassificationListCollection.deserializeBinaryFromReader(r,n)},proto.mediapipe.ClassificationListCollection.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=new proto.mediapipe.ClassificationList;t.readMessage(n,proto.mediapipe.ClassificationList.deserializeBinaryFromReader),e.addClassificationList(n)}else t.skipField();return e},proto.mediapipe.ClassificationListCollection.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.ClassificationListCollection.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.ClassificationListCollection.serializeBinaryToWriter=function(e,t){var n;(n=e.getClassificationListList()).length>0&&t.writeRepeatedMessage(1,n,proto.mediapipe.ClassificationList.serializeBinaryToWriter)},proto.mediapipe.ClassificationListCollection.prototype.getClassificationListList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.ClassificationList,1)},proto.mediapipe.ClassificationListCollection.prototype.setClassificationListList=function(e){return t.Message.setRepeatedWrapperField(this,1,e)},proto.mediapipe.ClassificationListCollection.prototype.addClassificationList=function(e,n){return t.Message.addToRepeatedWrapperField(this,1,e,proto.mediapipe.ClassificationList,n)},proto.mediapipe.ClassificationListCollection.prototype.clearClassificationListList=function(){return this.setClassificationListList([])},n.object.extend(e,proto.mediapipe)}(classification_pb);var landmark_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.Landmark",null,r),n.exportSymbol("proto.mediapipe.LandmarkList",null,r),n.exportSymbol("proto.mediapipe.LandmarkListCollection",null,r),n.exportSymbol("proto.mediapipe.NormalizedLandmark",null,r),n.exportSymbol("proto.mediapipe.NormalizedLandmarkList",null,r),n.exportSymbol("proto.mediapipe.NormalizedLandmarkListCollection",null,r),proto.mediapipe.Landmark=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.Landmark,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.Landmark.displayName="proto.mediapipe.Landmark"),proto.mediapipe.LandmarkList=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.LandmarkList.repeatedFields_,null)},n.inherits(proto.mediapipe.LandmarkList,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.LandmarkList.displayName="proto.mediapipe.LandmarkList"),proto.mediapipe.LandmarkListCollection=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.LandmarkListCollection.repeatedFields_,null)},n.inherits(proto.mediapipe.LandmarkListCollection,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.LandmarkListCollection.displayName="proto.mediapipe.LandmarkListCollection"),proto.mediapipe.NormalizedLandmark=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.NormalizedLandmark,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.NormalizedLandmark.displayName="proto.mediapipe.NormalizedLandmark"),proto.mediapipe.NormalizedLandmarkList=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.NormalizedLandmarkList.repeatedFields_,null)},n.inherits(proto.mediapipe.NormalizedLandmarkList,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.NormalizedLandmarkList.displayName="proto.mediapipe.NormalizedLandmarkList"),proto.mediapipe.NormalizedLandmarkListCollection=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.NormalizedLandmarkListCollection.repeatedFields_,null)},n.inherits(proto.mediapipe.NormalizedLandmarkListCollection,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.NormalizedLandmarkListCollection.displayName="proto.mediapipe.NormalizedLandmarkListCollection"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.Landmark.prototype.toObject=function(e){return proto.mediapipe.Landmark.toObject(e,this)},proto.mediapipe.Landmark.toObject=function(e,n){var r,i={x:null==(r=t.Message.getOptionalFloatingPointField(n,1))?void 0:r,y:null==(r=t.Message.getOptionalFloatingPointField(n,2))?void 0:r,z:null==(r=t.Message.getOptionalFloatingPointField(n,3))?void 0:r,visibility:null==(r=t.Message.getOptionalFloatingPointField(n,4))?void 0:r,presence:null==(r=t.Message.getOptionalFloatingPointField(n,5))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.Landmark.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.Landmark;return proto.mediapipe.Landmark.deserializeBinaryFromReader(r,n)},proto.mediapipe.Landmark.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readFloat();e.setX(n);break;case 2:n=t.readFloat(),e.setY(n);break;case 3:n=t.readFloat(),e.setZ(n);break;case 4:n=t.readFloat(),e.setVisibility(n);break;case 5:n=t.readFloat(),e.setPresence(n);break;default:t.skipField()}return e},proto.mediapipe.Landmark.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.Landmark.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.Landmark.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeFloat(1,r),null!=(r=t.Message.getField(e,2))&&n.writeFloat(2,r),null!=(r=t.Message.getField(e,3))&&n.writeFloat(3,r),null!=(r=t.Message.getField(e,4))&&n.writeFloat(4,r),null!=(r=t.Message.getField(e,5))&&n.writeFloat(5,r)},proto.mediapipe.Landmark.prototype.getX=function(){return t.Message.getFloatingPointFieldWithDefault(this,1,0)},proto.mediapipe.Landmark.prototype.setX=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.Landmark.prototype.clearX=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.Landmark.prototype.hasX=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.Landmark.prototype.getY=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,0)},proto.mediapipe.Landmark.prototype.setY=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.Landmark.prototype.clearY=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.Landmark.prototype.hasY=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.Landmark.prototype.getZ=function(){return t.Message.getFloatingPointFieldWithDefault(this,3,0)},proto.mediapipe.Landmark.prototype.setZ=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.Landmark.prototype.clearZ=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.Landmark.prototype.hasZ=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.Landmark.prototype.getVisibility=function(){return t.Message.getFloatingPointFieldWithDefault(this,4,0)},proto.mediapipe.Landmark.prototype.setVisibility=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.Landmark.prototype.clearVisibility=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.Landmark.prototype.hasVisibility=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.Landmark.prototype.getPresence=function(){return t.Message.getFloatingPointFieldWithDefault(this,5,0)},proto.mediapipe.Landmark.prototype.setPresence=function(e){return t.Message.setField(this,5,e)},proto.mediapipe.Landmark.prototype.clearPresence=function(){return t.Message.setField(this,5,void 0)},proto.mediapipe.Landmark.prototype.hasPresence=function(){return null!=t.Message.getField(this,5)},proto.mediapipe.LandmarkList.repeatedFields_=[1],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.LandmarkList.prototype.toObject=function(e){return proto.mediapipe.LandmarkList.toObject(e,this)},proto.mediapipe.LandmarkList.toObject=function(e,n){var r={landmarkList:t.Message.toObjectList(n.getLandmarkList(),proto.mediapipe.Landmark.toObject,e)};return e&&(r.$jspbMessageInstance=n),r}),proto.mediapipe.LandmarkList.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.LandmarkList;return proto.mediapipe.LandmarkList.deserializeBinaryFromReader(r,n)},proto.mediapipe.LandmarkList.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=new proto.mediapipe.Landmark;t.readMessage(n,proto.mediapipe.Landmark.deserializeBinaryFromReader),e.addLandmark(n)}else t.skipField();return e},proto.mediapipe.LandmarkList.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.LandmarkList.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.LandmarkList.serializeBinaryToWriter=function(e,t){var n;(n=e.getLandmarkList()).length>0&&t.writeRepeatedMessage(1,n,proto.mediapipe.Landmark.serializeBinaryToWriter)},proto.mediapipe.LandmarkList.prototype.getLandmarkList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.Landmark,1)},proto.mediapipe.LandmarkList.prototype.setLandmarkList=function(e){return t.Message.setRepeatedWrapperField(this,1,e)},proto.mediapipe.LandmarkList.prototype.addLandmark=function(e,n){return t.Message.addToRepeatedWrapperField(this,1,e,proto.mediapipe.Landmark,n)},proto.mediapipe.LandmarkList.prototype.clearLandmarkList=function(){return this.setLandmarkList([])},proto.mediapipe.LandmarkListCollection.repeatedFields_=[1],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.LandmarkListCollection.prototype.toObject=function(e){return proto.mediapipe.LandmarkListCollection.toObject(e,this)},proto.mediapipe.LandmarkListCollection.toObject=function(e,n){var r={landmarkListList:t.Message.toObjectList(n.getLandmarkListList(),proto.mediapipe.LandmarkList.toObject,e)};return e&&(r.$jspbMessageInstance=n),r}),proto.mediapipe.LandmarkListCollection.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.LandmarkListCollection;return proto.mediapipe.LandmarkListCollection.deserializeBinaryFromReader(r,n)},proto.mediapipe.LandmarkListCollection.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=new proto.mediapipe.LandmarkList;t.readMessage(n,proto.mediapipe.LandmarkList.deserializeBinaryFromReader),e.addLandmarkList(n)}else t.skipField();return e},proto.mediapipe.LandmarkListCollection.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.LandmarkListCollection.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.LandmarkListCollection.serializeBinaryToWriter=function(e,t){var n;(n=e.getLandmarkListList()).length>0&&t.writeRepeatedMessage(1,n,proto.mediapipe.LandmarkList.serializeBinaryToWriter)},proto.mediapipe.LandmarkListCollection.prototype.getLandmarkListList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.LandmarkList,1)},proto.mediapipe.LandmarkListCollection.prototype.setLandmarkListList=function(e){return t.Message.setRepeatedWrapperField(this,1,e)},proto.mediapipe.LandmarkListCollection.prototype.addLandmarkList=function(e,n){return t.Message.addToRepeatedWrapperField(this,1,e,proto.mediapipe.LandmarkList,n)},proto.mediapipe.LandmarkListCollection.prototype.clearLandmarkListList=function(){return this.setLandmarkListList([])},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.NormalizedLandmark.prototype.toObject=function(e){return proto.mediapipe.NormalizedLandmark.toObject(e,this)},proto.mediapipe.NormalizedLandmark.toObject=function(e,n){var r,i={x:null==(r=t.Message.getOptionalFloatingPointField(n,1))?void 0:r,y:null==(r=t.Message.getOptionalFloatingPointField(n,2))?void 0:r,z:null==(r=t.Message.getOptionalFloatingPointField(n,3))?void 0:r,visibility:null==(r=t.Message.getOptionalFloatingPointField(n,4))?void 0:r,presence:null==(r=t.Message.getOptionalFloatingPointField(n,5))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.NormalizedLandmark.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.NormalizedLandmark;return proto.mediapipe.NormalizedLandmark.deserializeBinaryFromReader(r,n)},proto.mediapipe.NormalizedLandmark.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readFloat();e.setX(n);break;case 2:n=t.readFloat(),e.setY(n);break;case 3:n=t.readFloat(),e.setZ(n);break;case 4:n=t.readFloat(),e.setVisibility(n);break;case 5:n=t.readFloat(),e.setPresence(n);break;default:t.skipField()}return e},proto.mediapipe.NormalizedLandmark.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.NormalizedLandmark.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.NormalizedLandmark.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeFloat(1,r),null!=(r=t.Message.getField(e,2))&&n.writeFloat(2,r),null!=(r=t.Message.getField(e,3))&&n.writeFloat(3,r),null!=(r=t.Message.getField(e,4))&&n.writeFloat(4,r),null!=(r=t.Message.getField(e,5))&&n.writeFloat(5,r)},proto.mediapipe.NormalizedLandmark.prototype.getX=function(){return t.Message.getFloatingPointFieldWithDefault(this,1,0)},proto.mediapipe.NormalizedLandmark.prototype.setX=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.NormalizedLandmark.prototype.clearX=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.NormalizedLandmark.prototype.hasX=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.NormalizedLandmark.prototype.getY=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,0)},proto.mediapipe.NormalizedLandmark.prototype.setY=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.NormalizedLandmark.prototype.clearY=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.NormalizedLandmark.prototype.hasY=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.NormalizedLandmark.prototype.getZ=function(){return t.Message.getFloatingPointFieldWithDefault(this,3,0)},proto.mediapipe.NormalizedLandmark.prototype.setZ=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.NormalizedLandmark.prototype.clearZ=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.NormalizedLandmark.prototype.hasZ=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.NormalizedLandmark.prototype.getVisibility=function(){return t.Message.getFloatingPointFieldWithDefault(this,4,0)},proto.mediapipe.NormalizedLandmark.prototype.setVisibility=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.NormalizedLandmark.prototype.clearVisibility=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.NormalizedLandmark.prototype.hasVisibility=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.NormalizedLandmark.prototype.getPresence=function(){return t.Message.getFloatingPointFieldWithDefault(this,5,0)},proto.mediapipe.NormalizedLandmark.prototype.setPresence=function(e){return t.Message.setField(this,5,e)},proto.mediapipe.NormalizedLandmark.prototype.clearPresence=function(){return t.Message.setField(this,5,void 0)},proto.mediapipe.NormalizedLandmark.prototype.hasPresence=function(){return null!=t.Message.getField(this,5)},proto.mediapipe.NormalizedLandmarkList.repeatedFields_=[1],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.NormalizedLandmarkList.prototype.toObject=function(e){return proto.mediapipe.NormalizedLandmarkList.toObject(e,this)},proto.mediapipe.NormalizedLandmarkList.toObject=function(e,n){var r={landmarkList:t.Message.toObjectList(n.getLandmarkList(),proto.mediapipe.NormalizedLandmark.toObject,e)};return e&&(r.$jspbMessageInstance=n),r}),proto.mediapipe.NormalizedLandmarkList.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.NormalizedLandmarkList;return proto.mediapipe.NormalizedLandmarkList.deserializeBinaryFromReader(r,n)},proto.mediapipe.NormalizedLandmarkList.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=new proto.mediapipe.NormalizedLandmark;t.readMessage(n,proto.mediapipe.NormalizedLandmark.deserializeBinaryFromReader),e.addLandmark(n)}else t.skipField();return e},proto.mediapipe.NormalizedLandmarkList.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.NormalizedLandmarkList.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.NormalizedLandmarkList.serializeBinaryToWriter=function(e,t){var n;(n=e.getLandmarkList()).length>0&&t.writeRepeatedMessage(1,n,proto.mediapipe.NormalizedLandmark.serializeBinaryToWriter)},proto.mediapipe.NormalizedLandmarkList.prototype.getLandmarkList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.NormalizedLandmark,1)},proto.mediapipe.NormalizedLandmarkList.prototype.setLandmarkList=function(e){return t.Message.setRepeatedWrapperField(this,1,e)},proto.mediapipe.NormalizedLandmarkList.prototype.addLandmark=function(e,n){return t.Message.addToRepeatedWrapperField(this,1,e,proto.mediapipe.NormalizedLandmark,n)},proto.mediapipe.NormalizedLandmarkList.prototype.clearLandmarkList=function(){return this.setLandmarkList([])},proto.mediapipe.NormalizedLandmarkListCollection.repeatedFields_=[1],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.NormalizedLandmarkListCollection.prototype.toObject=function(e){return proto.mediapipe.NormalizedLandmarkListCollection.toObject(e,this)},proto.mediapipe.NormalizedLandmarkListCollection.toObject=function(e,n){var r={landmarkListList:t.Message.toObjectList(n.getLandmarkListList(),proto.mediapipe.NormalizedLandmarkList.toObject,e)};return e&&(r.$jspbMessageInstance=n),r}),proto.mediapipe.NormalizedLandmarkListCollection.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.NormalizedLandmarkListCollection;return proto.mediapipe.NormalizedLandmarkListCollection.deserializeBinaryFromReader(r,n)},proto.mediapipe.NormalizedLandmarkListCollection.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=new proto.mediapipe.NormalizedLandmarkList;t.readMessage(n,proto.mediapipe.NormalizedLandmarkList.deserializeBinaryFromReader),e.addLandmarkList(n)}else t.skipField();return e},proto.mediapipe.NormalizedLandmarkListCollection.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.NormalizedLandmarkListCollection.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.NormalizedLandmarkListCollection.serializeBinaryToWriter=function(e,t){var n;(n=e.getLandmarkListList()).length>0&&t.writeRepeatedMessage(1,n,proto.mediapipe.NormalizedLandmarkList.serializeBinaryToWriter)},proto.mediapipe.NormalizedLandmarkListCollection.prototype.getLandmarkListList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.NormalizedLandmarkList,1)},proto.mediapipe.NormalizedLandmarkListCollection.prototype.setLandmarkListList=function(e){return t.Message.setRepeatedWrapperField(this,1,e)},proto.mediapipe.NormalizedLandmarkListCollection.prototype.addLandmarkList=function(e,n){return t.Message.addToRepeatedWrapperField(this,1,e,proto.mediapipe.NormalizedLandmarkList,n)},proto.mediapipe.NormalizedLandmarkListCollection.prototype.clearLandmarkListList=function(){return this.setLandmarkListList([])},n.object.extend(e,proto.mediapipe)}(landmark_pb);var face_geometry_pb={},matrix_data_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.MatrixData",null,r),n.exportSymbol("proto.mediapipe.MatrixData.Layout",null,r),proto.mediapipe.MatrixData=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.MatrixData.repeatedFields_,null)},n.inherits(proto.mediapipe.MatrixData,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.MatrixData.displayName="proto.mediapipe.MatrixData"),proto.mediapipe.MatrixData.repeatedFields_=[3],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.MatrixData.prototype.toObject=function(e){return proto.mediapipe.MatrixData.toObject(e,this)},proto.mediapipe.MatrixData.toObject=function(e,n){var r,i={rows:null==(r=t.Message.getField(n,1))?void 0:r,cols:null==(r=t.Message.getField(n,2))?void 0:r,packedDataList:null==(r=t.Message.getRepeatedFloatingPointField(n,3))?void 0:r,layout:t.Message.getFieldWithDefault(n,4,0)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.MatrixData.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.MatrixData;return proto.mediapipe.MatrixData.deserializeBinaryFromReader(r,n)},proto.mediapipe.MatrixData.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readInt32();e.setRows(n);break;case 2:n=t.readInt32(),e.setCols(n);break;case 3:for(var r=t.isDelimited()?t.readPackedFloat():[t.readFloat()],i=0;i<r.length;i++)e.addPackedData(r[i]);break;case 4:n=t.readEnum(),e.setLayout(n);break;default:t.skipField()}return e},proto.mediapipe.MatrixData.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.MatrixData.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.MatrixData.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeInt32(1,r),null!=(r=t.Message.getField(e,2))&&n.writeInt32(2,r),(r=e.getPackedDataList()).length>0&&n.writePackedFloat(3,r),null!=(r=t.Message.getField(e,4))&&n.writeEnum(4,r)},proto.mediapipe.MatrixData.Layout={COLUMN_MAJOR:0,ROW_MAJOR:1},proto.mediapipe.MatrixData.prototype.getRows=function(){return t.Message.getFieldWithDefault(this,1,0)},proto.mediapipe.MatrixData.prototype.setRows=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.MatrixData.prototype.clearRows=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.MatrixData.prototype.hasRows=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.MatrixData.prototype.getCols=function(){return t.Message.getFieldWithDefault(this,2,0)},proto.mediapipe.MatrixData.prototype.setCols=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.MatrixData.prototype.clearCols=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.MatrixData.prototype.hasCols=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.MatrixData.prototype.getPackedDataList=function(){return t.Message.getRepeatedFloatingPointField(this,3)},proto.mediapipe.MatrixData.prototype.setPackedDataList=function(e){return t.Message.setField(this,3,e||[])},proto.mediapipe.MatrixData.prototype.addPackedData=function(e,n){return t.Message.addToRepeatedField(this,3,e,n)},proto.mediapipe.MatrixData.prototype.clearPackedDataList=function(){return this.setPackedDataList([])},proto.mediapipe.MatrixData.prototype.getLayout=function(){return t.Message.getFieldWithDefault(this,4,0)},proto.mediapipe.MatrixData.prototype.setLayout=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.MatrixData.prototype.clearLayout=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.MatrixData.prototype.hasLayout=function(){return null!=t.Message.getField(this,4)},n.object.extend(e,proto.mediapipe)}(matrix_data_pb);var mesh_3d_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d",null,r),n.exportSymbol("proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.PrimitiveType",null,r),n.exportSymbol("proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.VertexType",null,r),proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.repeatedFields_,null)},n.inherits(proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.displayName="proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d"),proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.repeatedFields_=[3,4],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.toObject(e,this)},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.toObject=function(e,n){var r,i={vertexType:null==(r=t.Message.getField(n,1))?void 0:r,primitiveType:null==(r=t.Message.getField(n,2))?void 0:r,vertexBufferList:null==(r=t.Message.getRepeatedFloatingPointField(n,3))?void 0:r,indexBufferList:null==(r=t.Message.getRepeatedField(n,4))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d;return proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readEnum();e.setVertexType(n);break;case 2:n=t.readEnum(),e.setPrimitiveType(n);break;case 3:for(var r=t.isDelimited()?t.readPackedFloat():[t.readFloat()],i=0;i<r.length;i++)e.addVertexBuffer(r[i]);break;case 4:for(r=t.isDelimited()?t.readPackedUint32():[t.readUint32()],i=0;i<r.length;i++)e.addIndexBuffer(r[i]);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeEnum(1,r),null!=(r=t.Message.getField(e,2))&&n.writeEnum(2,r),(r=e.getVertexBufferList()).length>0&&n.writeRepeatedFloat(3,r),(r=e.getIndexBufferList()).length>0&&n.writeRepeatedUint32(4,r)},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.VertexType={VERTEX_PT:0},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.PrimitiveType={TRIANGLE:0},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.getVertexType=function(){return t.Message.getFieldWithDefault(this,1,0)},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.setVertexType=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.clearVertexType=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.hasVertexType=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.getPrimitiveType=function(){return t.Message.getFieldWithDefault(this,2,0)},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.setPrimitiveType=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.clearPrimitiveType=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.hasPrimitiveType=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.getVertexBufferList=function(){return t.Message.getRepeatedFloatingPointField(this,3)},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.setVertexBufferList=function(e){return t.Message.setField(this,3,e||[])},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.addVertexBuffer=function(e,n){return t.Message.addToRepeatedField(this,3,e,n)},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.clearVertexBufferList=function(){return this.setVertexBufferList([])},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.getIndexBufferList=function(){return t.Message.getRepeatedField(this,4)},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.setIndexBufferList=function(e){return t.Message.setField(this,4,e||[])},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.addIndexBuffer=function(e,n){return t.Message.addToRepeatedField(this,4,e,n)},proto.mediapipe.tasks.vision.face_geometry.proto.Mesh3d.prototype.clearIndexBufferList=function(){return this.setIndexBufferList([])},n.object.extend(e,proto.mediapipe.tasks.vision.face_geometry.proto)}(mesh_3d_pb),function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=matrix_data_pb;n.object.extend(proto,i);var o=mesh_3d_pb;n.object.extend(proto,o),n.exportSymbol("proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry",null,r),proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.displayName="proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.toObject(e,this)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.toObject=function(e,t){var n,r={mesh:(n=t.getMesh())&&o.Mesh3d.toObject(e,n),poseTransformMatrix:(n=t.getPoseTransformMatrix())&&i.MatrixData.toObject(e,n)};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry;return proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new o.Mesh3d;t.readMessage(n,o.Mesh3d.deserializeBinaryFromReader),e.setMesh(n);break;case 2:n=new i.MatrixData,t.readMessage(n,i.MatrixData.deserializeBinaryFromReader),e.setPoseTransformMatrix(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.serializeBinaryToWriter=function(e,t){var n=void 0;null!=(n=e.getMesh())&&t.writeMessage(1,n,o.Mesh3d.serializeBinaryToWriter),null!=(n=e.getPoseTransformMatrix())&&t.writeMessage(2,n,i.MatrixData.serializeBinaryToWriter)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.prototype.getMesh=function(){return t.Message.getWrapperField(this,o.Mesh3d,1)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.prototype.setMesh=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.prototype.clearMesh=function(){return this.setMesh(void 0)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.prototype.hasMesh=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.prototype.getPoseTransformMatrix=function(){return t.Message.getWrapperField(this,i.MatrixData,2)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.prototype.setPoseTransformMatrix=function(e){return t.Message.setWrapperField(this,2,e)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.prototype.clearPoseTransformMatrix=function(){return this.setPoseTransformMatrix(void 0)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometry.prototype.hasPoseTransformMatrix=function(){return null!=t.Message.getField(this,2)},n.object.extend(e,proto.mediapipe.tasks.vision.face_geometry.proto)}(face_geometry_pb);var face_landmarker_graph_options_pb={},face_geometry_graph_options_pb={},geometry_pipeline_calculator_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_options_pb;n.object.extend(proto,i);var o=external_file_pb;n.object.extend(proto,o),n.exportSymbol("proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions",null,r),proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.displayName="proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.toObject(e,this)},proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.toObject=function(e,t){var n,r={metadataFile:(n=t.getMetadataFile())&&o.ExternalFile.toObject(e,n)};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions;return proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=new o.ExternalFile;t.readMessage(n,o.ExternalFile.deserializeBinaryFromReader),e.setMetadataFile(n)}else t.skipField();return e},proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.serializeBinaryToWriter=function(e,t){var n;null!=(n=e.getMetadataFile())&&t.writeMessage(1,n,o.ExternalFile.serializeBinaryToWriter)},proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.ext=new t.ExtensionFieldInfo(512499200,{ext:0},proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions,proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.toObject,0),i.CalculatorOptions.extensionsBinary[512499200]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.deserializeBinaryFromReader,!1),i.CalculatorOptions.extensions[512499200]=proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.ext,proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.prototype.getMetadataFile=function(){return t.Message.getWrapperField(this,o.ExternalFile,1)},proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.prototype.setMetadataFile=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.prototype.clearMetadataFile=function(){return this.setMetadataFile(void 0)},proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.prototype.hasMetadataFile=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.ext=new t.ExtensionFieldInfo(512499200,{ext:0},proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions,proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.toObject,0),i.CalculatorOptions.extensionsBinary[512499200]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.deserializeBinaryFromReader,!1),i.CalculatorOptions.extensions[512499200]=proto.mediapipe.tasks.vision.face_geometry.FaceGeometryPipelineCalculatorOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.face_geometry)}(geometry_pipeline_calculator_pb),function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_options_pb;n.object.extend(proto,i);var o=geometry_pipeline_calculator_pb;n.object.extend(proto,o),n.exportSymbol("proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions",null,r),proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.displayName="proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.toObject=function(e,t){var n,r={geometryPipelineOptions:(n=t.getGeometryPipelineOptions())&&o.FaceGeometryPipelineCalculatorOptions.toObject(e,n)};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions;return proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=new o.FaceGeometryPipelineCalculatorOptions;t.readMessage(n,o.FaceGeometryPipelineCalculatorOptions.deserializeBinaryFromReader),e.setGeometryPipelineOptions(n)}else t.skipField();return e},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.serializeBinaryToWriter=function(e,t){var n;null!=(n=e.getGeometryPipelineOptions())&&t.writeMessage(1,n,o.FaceGeometryPipelineCalculatorOptions.serializeBinaryToWriter)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.ext=new t.ExtensionFieldInfo(515723506,{ext:0},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions,proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.toObject,0),i.CalculatorOptions.extensionsBinary[515723506]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.deserializeBinaryFromReader,!1),i.CalculatorOptions.extensions[515723506]=proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.ext,proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.prototype.getGeometryPipelineOptions=function(){return t.Message.getWrapperField(this,o.FaceGeometryPipelineCalculatorOptions,1)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.prototype.setGeometryPipelineOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.prototype.clearGeometryPipelineOptions=function(){return this.setGeometryPipelineOptions(void 0)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.prototype.hasGeometryPipelineOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.ext=new t.ExtensionFieldInfo(515723506,{ext:0},proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions,proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.toObject,0),i.CalculatorOptions.extensionsBinary[515723506]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.deserializeBinaryFromReader,!1),i.CalculatorOptions.extensions[515723506]=proto.mediapipe.tasks.vision.face_geometry.proto.FaceGeometryGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.face_geometry.proto)}(face_geometry_graph_options_pb);var face_landmarks_detector_graph_options_pb={},face_blendshapes_graph_options_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=base_options_pb;n.object.extend(proto,a),n.exportSymbol("proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions",null,r),proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.displayName="proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.toObject=function(e,t){var n,r={baseOptions:(n=t.getBaseOptions())&&a.BaseOptions.toObject(e,n)};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions;return proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=new a.BaseOptions;t.readMessage(n,a.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n)}else t.skipField();return e},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.serializeBinaryToWriter=function(e,t){var n;null!=(n=e.getBaseOptions())&&t.writeMessage(1,n,a.BaseOptions.serializeBinaryToWriter)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.ext=new t.ExtensionFieldInfo(508981768,{ext:0},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[508981768]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[508981768]=proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.ext,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,a.BaseOptions,1)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.ext=new t.ExtensionFieldInfo(508981768,{ext:0},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[508981768]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[508981768]=proto.mediapipe.tasks.vision.face_landmarker.proto.FaceBlendshapesGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.face_landmarker.proto)}(face_blendshapes_graph_options_pb),function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=base_options_pb;n.object.extend(proto,a);var s=face_blendshapes_graph_options_pb;n.object.extend(proto,s),n.exportSymbol("proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions",null,r),proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.displayName="proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.toObject=function(e,n){var r,i={baseOptions:(r=n.getBaseOptions())&&a.BaseOptions.toObject(e,r),minDetectionConfidence:t.Message.getFloatingPointFieldWithDefault(n,2,.5),smoothLandmarks:null==(r=t.Message.getBooleanField(n,4))?void 0:r,faceBlendshapesGraphOptions:(r=n.getFaceBlendshapesGraphOptions())&&s.FaceBlendshapesGraphOptions.toObject(e,r)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions;return proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new a.BaseOptions;t.readMessage(n,a.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=t.readFloat(),e.setMinDetectionConfidence(n);break;case 4:n=t.readBool(),e.setSmoothLandmarks(n);break;case 3:n=new s.FaceBlendshapesGraphOptions,t.readMessage(n,s.FaceBlendshapesGraphOptions.deserializeBinaryFromReader),e.setFaceBlendshapesGraphOptions(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getBaseOptions())&&n.writeMessage(1,r,a.BaseOptions.serializeBinaryToWriter),null!=(r=t.Message.getField(e,2))&&n.writeFloat(2,r),null!=(r=t.Message.getField(e,4))&&n.writeBool(4,r),null!=(r=e.getFaceBlendshapesGraphOptions())&&n.writeMessage(3,r,s.FaceBlendshapesGraphOptions.serializeBinaryToWriter)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.ext=new t.ExtensionFieldInfo(508968149,{ext:0},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[508968149]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[508968149]=proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.ext,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,a.BaseOptions,1)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.getMinDetectionConfidence=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,.5)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.setMinDetectionConfidence=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.clearMinDetectionConfidence=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.hasMinDetectionConfidence=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.getSmoothLandmarks=function(){return t.Message.getBooleanFieldWithDefault(this,4,!1)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.setSmoothLandmarks=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.clearSmoothLandmarks=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.hasSmoothLandmarks=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.getFaceBlendshapesGraphOptions=function(){return t.Message.getWrapperField(this,s.FaceBlendshapesGraphOptions,3)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.setFaceBlendshapesGraphOptions=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.clearFaceBlendshapesGraphOptions=function(){return this.setFaceBlendshapesGraphOptions(void 0)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.prototype.hasFaceBlendshapesGraphOptions=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.ext=new t.ExtensionFieldInfo(508968149,{ext:0},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[508968149]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[508968149]=proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarksDetectorGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.face_landmarker.proto)}(face_landmarks_detector_graph_options_pb),function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=base_options_pb;n.object.extend(proto,a);var s=face_detector_graph_options_pb;n.object.extend(proto,s);var u=face_geometry_graph_options_pb;n.object.extend(proto,u);var l=face_landmarks_detector_graph_options_pb;n.object.extend(proto,l),n.exportSymbol("proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions",null,r),proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.displayName="proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.toObject=function(e,n){var r,i={baseOptions:(r=n.getBaseOptions())&&a.BaseOptions.toObject(e,r),faceDetectorGraphOptions:(r=n.getFaceDetectorGraphOptions())&&s.FaceDetectorGraphOptions.toObject(e,r),faceLandmarksDetectorGraphOptions:(r=n.getFaceLandmarksDetectorGraphOptions())&&l.FaceLandmarksDetectorGraphOptions.toObject(e,r),minTrackingConfidence:t.Message.getFloatingPointFieldWithDefault(n,4,.5),faceGeometryGraphOptions:(r=n.getFaceGeometryGraphOptions())&&u.FaceGeometryGraphOptions.toObject(e,r)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions;return proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new a.BaseOptions;t.readMessage(n,a.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=new s.FaceDetectorGraphOptions,t.readMessage(n,s.FaceDetectorGraphOptions.deserializeBinaryFromReader),e.setFaceDetectorGraphOptions(n);break;case 3:n=new l.FaceLandmarksDetectorGraphOptions,t.readMessage(n,l.FaceLandmarksDetectorGraphOptions.deserializeBinaryFromReader),e.setFaceLandmarksDetectorGraphOptions(n);break;case 4:n=t.readFloat(),e.setMinTrackingConfidence(n);break;case 5:n=new u.FaceGeometryGraphOptions,t.readMessage(n,u.FaceGeometryGraphOptions.deserializeBinaryFromReader),e.setFaceGeometryGraphOptions(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getBaseOptions())&&n.writeMessage(1,r,a.BaseOptions.serializeBinaryToWriter),null!=(r=e.getFaceDetectorGraphOptions())&&n.writeMessage(2,r,s.FaceDetectorGraphOptions.serializeBinaryToWriter),null!=(r=e.getFaceLandmarksDetectorGraphOptions())&&n.writeMessage(3,r,l.FaceLandmarksDetectorGraphOptions.serializeBinaryToWriter),null!=(r=t.Message.getField(e,4))&&n.writeFloat(4,r),null!=(r=e.getFaceGeometryGraphOptions())&&n.writeMessage(5,r,u.FaceGeometryGraphOptions.serializeBinaryToWriter)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.ext=new t.ExtensionFieldInfo(508968150,{ext:0},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[508968150]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[508968150]=proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.ext,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,a.BaseOptions,1)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.getFaceDetectorGraphOptions=function(){return t.Message.getWrapperField(this,s.FaceDetectorGraphOptions,2)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.setFaceDetectorGraphOptions=function(e){return t.Message.setWrapperField(this,2,e)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.clearFaceDetectorGraphOptions=function(){return this.setFaceDetectorGraphOptions(void 0)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.hasFaceDetectorGraphOptions=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.getFaceLandmarksDetectorGraphOptions=function(){return t.Message.getWrapperField(this,l.FaceLandmarksDetectorGraphOptions,3)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.setFaceLandmarksDetectorGraphOptions=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.clearFaceLandmarksDetectorGraphOptions=function(){return this.setFaceLandmarksDetectorGraphOptions(void 0)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.hasFaceLandmarksDetectorGraphOptions=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.getMinTrackingConfidence=function(){return t.Message.getFloatingPointFieldWithDefault(this,4,.5)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.setMinTrackingConfidence=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.clearMinTrackingConfidence=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.hasMinTrackingConfidence=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.getFaceGeometryGraphOptions=function(){return t.Message.getWrapperField(this,u.FaceGeometryGraphOptions,5)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.setFaceGeometryGraphOptions=function(e){return t.Message.setWrapperField(this,5,e)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.clearFaceGeometryGraphOptions=function(){return this.setFaceGeometryGraphOptions(void 0)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.prototype.hasFaceGeometryGraphOptions=function(){return null!=t.Message.getField(this,5)},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.ext=new t.ExtensionFieldInfo(508968150,{ext:0},proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[508968150]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[508968150]=proto.mediapipe.tasks.vision.face_landmarker.proto.FaceLandmarkerGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.face_landmarker.proto)}(face_landmarker_graph_options_pb);var classifier_result={};Object.defineProperty(classifier_result,"__esModule",{value:!0}),classifier_result.convertFromClassificationResultProto=classifier_result.convertFromClassifications=void 0;const DEFAULT_INDEX$1=-1,DEFAULT_SCORE=0;function convertFromClassifications(e,t=DEFAULT_INDEX$1,n=""){return{categories:e.map((e=>{var t,n,r,i;return{index:null!==(t=e.getIndex())&&void 0!==t?t:DEFAULT_INDEX$1,score:null!==(n=e.getScore())&&void 0!==n?n:DEFAULT_SCORE,categoryName:null!==(r=e.getLabel())&&void 0!==r?r:"",displayName:null!==(i=e.getDisplayName())&&void 0!==i?i:""}})),headIndex:t,headName:n}}function convertFromClassificationsProto(e){var t,n;return convertFromClassifications(null!==(n=null===(t=e.getClassificationList())||void 0===t?void 0:t.getClassificationList())&&void 0!==n?n:[],e.getHeadIndex(),e.getHeadName())}function convertFromClassificationResultProto(e){const t={classifications:e.getClassificationsList().map((e=>convertFromClassificationsProto(e)))};return e.hasTimestampMs()&&(t.timestampMs=e.getTimestampMs()),t}classifier_result.convertFromClassifications=convertFromClassifications,classifier_result.convertFromClassificationResultProto=convertFromClassificationResultProto;var landmark_result={};function convertToLandmarks(e){var t,n,r;const i=[];for(const o of e.getLandmarkList())i.push({x:null!==(t=o.getX())&&void 0!==t?t:0,y:null!==(n=o.getY())&&void 0!==n?n:0,z:null!==(r=o.getZ())&&void 0!==r?r:0});return i}function convertToWorldLandmarks(e){var t,n,r;const i=[];for(const o of e.getLandmarkList())i.push({x:null!==(t=o.getX())&&void 0!==t?t:0,y:null!==(n=o.getY())&&void 0!==n?n:0,z:null!==(r=o.getZ())&&void 0!==r?r:0});return i}Object.defineProperty(landmark_result,"__esModule",{value:!0}),landmark_result.convertToWorldLandmarks=landmark_result.convertToLandmarks=void 0,landmark_result.convertToLandmarks=convertToLandmarks,landmark_result.convertToWorldLandmarks=convertToWorldLandmarks;var face_landmarks_connections={},exports;exports=face_landmarks_connections,Object.defineProperty(exports,"__esModule",{value:!0}),exports.FACE_LANDMARKS_TESSELATION=exports.FACE_LANDMARKS_CONTOURS=exports.FACE_LANDMARKS_FACE_OVAL=exports.FACE_LANDMARKS_RIGHT_IRIS=exports.FACE_LANDMARKS_RIGHT_EYEBROW=exports.FACE_LANDMARKS_RIGHT_EYE=exports.FACE_LANDMARKS_LEFT_IRIS=exports.FACE_LANDMARKS_LEFT_EYEBROW=exports.FACE_LANDMARKS_LEFT_EYE=exports.FACE_LANDMARKS_LIPS=void 0,exports.FACE_LANDMARKS_LIPS=[{start:61,end:146},{start:146,end:91},{start:91,end:181},{start:181,end:84},{start:84,end:17},{start:17,end:314},{start:314,end:405},{start:405,end:321},{start:321,end:375},{start:375,end:291},{start:61,end:185},{start:185,end:40},{start:40,end:39},{start:39,end:37},{start:37,end:0},{start:0,end:267},{start:267,end:269},{start:269,end:270},{start:270,end:409},{start:409,end:291},{start:78,end:95},{start:95,end:88},{start:88,end:178},{start:178,end:87},{start:87,end:14},{start:14,end:317},{start:317,end:402},{start:402,end:318},{start:318,end:324},{start:324,end:308},{start:78,end:191},{start:191,end:80},{start:80,end:81},{start:81,end:82},{start:82,end:13},{start:13,end:312},{start:312,end:311},{start:311,end:310},{start:310,end:415},{start:415,end:308}],exports.FACE_LANDMARKS_LEFT_EYE=[{start:263,end:249},{start:249,end:390},{start:390,end:373},{start:373,end:374},{start:374,end:380},{start:380,end:381},{start:381,end:382},{start:382,end:362},{start:263,end:466},{start:466,end:388},{start:388,end:387},{start:387,end:386},{start:386,end:385},{start:385,end:384},{start:384,end:398},{start:398,end:362}],exports.FACE_LANDMARKS_LEFT_EYEBROW=[{start:276,end:283},{start:283,end:282},{start:282,end:295},{start:295,end:285},{start:300,end:293},{start:293,end:334},{start:334,end:296},{start:296,end:336}],exports.FACE_LANDMARKS_LEFT_IRIS=[{start:474,end:475},{start:475,end:476},{start:476,end:477},{start:477,end:474}],exports.FACE_LANDMARKS_RIGHT_EYE=[{start:33,end:7},{start:7,end:163},{start:163,end:144},{start:144,end:145},{start:145,end:153},{start:153,end:154},{start:154,end:155},{start:155,end:133},{start:33,end:246},{start:246,end:161},{start:161,end:160},{start:160,end:159},{start:159,end:158},{start:158,end:157},{start:157,end:173},{start:173,end:133}],exports.FACE_LANDMARKS_RIGHT_EYEBROW=[{start:46,end:53},{start:53,end:52},{start:52,end:65},{start:65,end:55},{start:70,end:63},{start:63,end:105},{start:105,end:66},{start:66,end:107}],exports.FACE_LANDMARKS_RIGHT_IRIS=[{start:469,end:470},{start:470,end:471},{start:471,end:472},{start:472,end:469}],exports.FACE_LANDMARKS_FACE_OVAL=[{start:10,end:338},{start:338,end:297},{start:297,end:332},{start:332,end:284},{start:284,end:251},{start:251,end:389},{start:389,end:356},{start:356,end:454},{start:454,end:323},{start:323,end:361},{start:361,end:288},{start:288,end:397},{start:397,end:365},{start:365,end:379},{start:379,end:378},{start:378,end:400},{start:400,end:377},{start:377,end:152},{start:152,end:148},{start:148,end:176},{start:176,end:149},{start:149,end:150},{start:150,end:136},{start:136,end:172},{start:172,end:58},{start:58,end:132},{start:132,end:93},{start:93,end:234},{start:234,end:127},{start:127,end:162},{start:162,end:21},{start:21,end:54},{start:54,end:103},{start:103,end:67},{start:67,end:109},{start:109,end:10}],exports.FACE_LANDMARKS_CONTOURS=[...exports.FACE_LANDMARKS_LIPS,...exports.FACE_LANDMARKS_LEFT_EYE,...exports.FACE_LANDMARKS_LEFT_EYEBROW,...exports.FACE_LANDMARKS_RIGHT_EYE,...exports.FACE_LANDMARKS_RIGHT_EYEBROW,...exports.FACE_LANDMARKS_FACE_OVAL],exports.FACE_LANDMARKS_TESSELATION=[{start:127,end:34},{start:34,end:139},{start:139,end:127},{start:11,end:0},{start:0,end:37},{start:37,end:11},{start:232,end:231},{start:231,end:120},{start:120,end:232},{start:72,end:37},{start:37,end:39},{start:39,end:72},{start:128,end:121},{start:121,end:47},{start:47,end:128},{start:232,end:121},{start:121,end:128},{start:128,end:232},{start:104,end:69},{start:69,end:67},{start:67,end:104},{start:175,end:171},{start:171,end:148},{start:148,end:175},{start:118,end:50},{start:50,end:101},{start:101,end:118},{start:73,end:39},{start:39,end:40},{start:40,end:73},{start:9,end:151},{start:151,end:108},{start:108,end:9},{start:48,end:115},{start:115,end:131},{start:131,end:48},{start:194,end:204},{start:204,end:211},{start:211,end:194},{start:74,end:40},{start:40,end:185},{start:185,end:74},{start:80,end:42},{start:42,end:183},{start:183,end:80},{start:40,end:92},{start:92,end:186},{start:186,end:40},{start:230,end:229},{start:229,end:118},{start:118,end:230},{start:202,end:212},{start:212,end:214},{start:214,end:202},{start:83,end:18},{start:18,end:17},{start:17,end:83},{start:76,end:61},{start:61,end:146},{start:146,end:76},{start:160,end:29},{start:29,end:30},{start:30,end:160},{start:56,end:157},{start:157,end:173},{start:173,end:56},{start:106,end:204},{start:204,end:194},{start:194,end:106},{start:135,end:214},{start:214,end:192},{start:192,end:135},{start:203,end:165},{start:165,end:98},{start:98,end:203},{start:21,end:71},{start:71,end:68},{start:68,end:21},{start:51,end:45},{start:45,end:4},{start:4,end:51},{start:144,end:24},{start:24,end:23},{start:23,end:144},{start:77,end:146},{start:146,end:91},{start:91,end:77},{start:205,end:50},{start:50,end:187},{start:187,end:205},{start:201,end:200},{start:200,end:18},{start:18,end:201},{start:91,end:106},{start:106,end:182},{start:182,end:91},{start:90,end:91},{start:91,end:181},{start:181,end:90},{start:85,end:84},{start:84,end:17},{start:17,end:85},{start:206,end:203},{start:203,end:36},{start:36,end:206},{start:148,end:171},{start:171,end:140},{start:140,end:148},{start:92,end:40},{start:40,end:39},{start:39,end:92},{start:193,end:189},{start:189,end:244},{start:244,end:193},{start:159,end:158},{start:158,end:28},{start:28,end:159},{start:247,end:246},{start:246,end:161},{start:161,end:247},{start:236,end:3},{start:3,end:196},{start:196,end:236},{start:54,end:68},{start:68,end:104},{start:104,end:54},{start:193,end:168},{start:168,end:8},{start:8,end:193},{start:117,end:228},{start:228,end:31},{start:31,end:117},{start:189,end:193},{start:193,end:55},{start:55,end:189},{start:98,end:97},{start:97,end:99},{start:99,end:98},{start:126,end:47},{start:47,end:100},{start:100,end:126},{start:166,end:79},{start:79,end:218},{start:218,end:166},{start:155,end:154},{start:154,end:26},{start:26,end:155},{start:209,end:49},{start:49,end:131},{start:131,end:209},{start:135,end:136},{start:136,end:150},{start:150,end:135},{start:47,end:126},{start:126,end:217},{start:217,end:47},{start:223,end:52},{start:52,end:53},{start:53,end:223},{start:45,end:51},{start:51,end:134},{start:134,end:45},{start:211,end:170},{start:170,end:140},{start:140,end:211},{start:67,end:69},{start:69,end:108},{start:108,end:67},{start:43,end:106},{start:106,end:91},{start:91,end:43},{start:230,end:119},{start:119,end:120},{start:120,end:230},{start:226,end:130},{start:130,end:247},{start:247,end:226},{start:63,end:53},{start:53,end:52},{start:52,end:63},{start:238,end:20},{start:20,end:242},{start:242,end:238},{start:46,end:70},{start:70,end:156},{start:156,end:46},{start:78,end:62},{start:62,end:96},{start:96,end:78},{start:46,end:53},{start:53,end:63},{start:63,end:46},{start:143,end:34},{start:34,end:227},{start:227,end:143},{start:123,end:117},{start:117,end:111},{start:111,end:123},{start:44,end:125},{start:125,end:19},{start:19,end:44},{start:236,end:134},{start:134,end:51},{start:51,end:236},{start:216,end:206},{start:206,end:205},{start:205,end:216},{start:154,end:153},{start:153,end:22},{start:22,end:154},{start:39,end:37},{start:37,end:167},{start:167,end:39},{start:200,end:201},{start:201,end:208},{start:208,end:200},{start:36,end:142},{start:142,end:100},{start:100,end:36},{start:57,end:212},{start:212,end:202},{start:202,end:57},{start:20,end:60},{start:60,end:99},{start:99,end:20},{start:28,end:158},{start:158,end:157},{start:157,end:28},{start:35,end:226},{start:226,end:113},{start:113,end:35},{start:160,end:159},{start:159,end:27},{start:27,end:160},{start:204,end:202},{start:202,end:210},{start:210,end:204},{start:113,end:225},{start:225,end:46},{start:46,end:113},{start:43,end:202},{start:202,end:204},{start:204,end:43},{start:62,end:76},{start:76,end:77},{start:77,end:62},{start:137,end:123},{start:123,end:116},{start:116,end:137},{start:41,end:38},{start:38,end:72},{start:72,end:41},{start:203,end:129},{start:129,end:142},{start:142,end:203},{start:64,end:98},{start:98,end:240},{start:240,end:64},{start:49,end:102},{start:102,end:64},{start:64,end:49},{start:41,end:73},{start:73,end:74},{start:74,end:41},{start:212,end:216},{start:216,end:207},{start:207,end:212},{start:42,end:74},{start:74,end:184},{start:184,end:42},{start:169,end:170},{start:170,end:211},{start:211,end:169},{start:170,end:149},{start:149,end:176},{start:176,end:170},{start:105,end:66},{start:66,end:69},{start:69,end:105},{start:122,end:6},{start:6,end:168},{start:168,end:122},{start:123,end:147},{start:147,end:187},{start:187,end:123},{start:96,end:77},{start:77,end:90},{start:90,end:96},{start:65,end:55},{start:55,end:107},{start:107,end:65},{start:89,end:90},{start:90,end:180},{start:180,end:89},{start:101,end:100},{start:100,end:120},{start:120,end:101},{start:63,end:105},{start:105,end:104},{start:104,end:63},{start:93,end:137},{start:137,end:227},{start:227,end:93},{start:15,end:86},{start:86,end:85},{start:85,end:15},{start:129,end:102},{start:102,end:49},{start:49,end:129},{start:14,end:87},{start:87,end:86},{start:86,end:14},{start:55,end:8},{start:8,end:9},{start:9,end:55},{start:100,end:47},{start:47,end:121},{start:121,end:100},{start:145,end:23},{start:23,end:22},{start:22,end:145},{start:88,end:89},{start:89,end:179},{start:179,end:88},{start:6,end:122},{start:122,end:196},{start:196,end:6},{start:88,end:95},{start:95,end:96},{start:96,end:88},{start:138,end:172},{start:172,end:136},{start:136,end:138},{start:215,end:58},{start:58,end:172},{start:172,end:215},{start:115,end:48},{start:48,end:219},{start:219,end:115},{start:42,end:80},{start:80,end:81},{start:81,end:42},{start:195,end:3},{start:3,end:51},{start:51,end:195},{start:43,end:146},{start:146,end:61},{start:61,end:43},{start:171,end:175},{start:175,end:199},{start:199,end:171},{start:81,end:82},{start:82,end:38},{start:38,end:81},{start:53,end:46},{start:46,end:225},{start:225,end:53},{start:144,end:163},{start:163,end:110},{start:110,end:144},{start:52,end:65},{start:65,end:66},{start:66,end:52},{start:229,end:228},{start:228,end:117},{start:117,end:229},{start:34,end:127},{start:127,end:234},{start:234,end:34},{start:107,end:108},{start:108,end:69},{start:69,end:107},{start:109,end:108},{start:108,end:151},{start:151,end:109},{start:48,end:64},{start:64,end:235},{start:235,end:48},{start:62,end:78},{start:78,end:191},{start:191,end:62},{start:129,end:209},{start:209,end:126},{start:126,end:129},{start:111,end:35},{start:35,end:143},{start:143,end:111},{start:117,end:123},{start:123,end:50},{start:50,end:117},{start:222,end:65},{start:65,end:52},{start:52,end:222},{start:19,end:125},{start:125,end:141},{start:141,end:19},{start:221,end:55},{start:55,end:65},{start:65,end:221},{start:3,end:195},{start:195,end:197},{start:197,end:3},{start:25,end:7},{start:7,end:33},{start:33,end:25},{start:220,end:237},{start:237,end:44},{start:44,end:220},{start:70,end:71},{start:71,end:139},{start:139,end:70},{start:122,end:193},{start:193,end:245},{start:245,end:122},{start:247,end:130},{start:130,end:33},{start:33,end:247},{start:71,end:21},{start:21,end:162},{start:162,end:71},{start:170,end:169},{start:169,end:150},{start:150,end:170},{start:188,end:174},{start:174,end:196},{start:196,end:188},{start:216,end:186},{start:186,end:92},{start:92,end:216},{start:2,end:97},{start:97,end:167},{start:167,end:2},{start:141,end:125},{start:125,end:241},{start:241,end:141},{start:164,end:167},{start:167,end:37},{start:37,end:164},{start:72,end:38},{start:38,end:12},{start:12,end:72},{start:38,end:82},{start:82,end:13},{start:13,end:38},{start:63,end:68},{start:68,end:71},{start:71,end:63},{start:226,end:35},{start:35,end:111},{start:111,end:226},{start:101,end:50},{start:50,end:205},{start:205,end:101},{start:206,end:92},{start:92,end:165},{start:165,end:206},{start:209,end:198},{start:198,end:217},{start:217,end:209},{start:165,end:167},{start:167,end:97},{start:97,end:165},{start:220,end:115},{start:115,end:218},{start:218,end:220},{start:133,end:112},{start:112,end:243},{start:243,end:133},{start:239,end:238},{start:238,end:241},{start:241,end:239},{start:214,end:135},{start:135,end:169},{start:169,end:214},{start:190,end:173},{start:173,end:133},{start:133,end:190},{start:171,end:208},{start:208,end:32},{start:32,end:171},{start:125,end:44},{start:44,end:237},{start:237,end:125},{start:86,end:87},{start:87,end:178},{start:178,end:86},{start:85,end:86},{start:86,end:179},{start:179,end:85},{start:84,end:85},{start:85,end:180},{start:180,end:84},{start:83,end:84},{start:84,end:181},{start:181,end:83},{start:201,end:83},{start:83,end:182},{start:182,end:201},{start:137,end:93},{start:93,end:132},{start:132,end:137},{start:76,end:62},{start:62,end:183},{start:183,end:76},{start:61,end:76},{start:76,end:184},{start:184,end:61},{start:57,end:61},{start:61,end:185},{start:185,end:57},{start:212,end:57},{start:57,end:186},{start:186,end:212},{start:214,end:207},{start:207,end:187},{start:187,end:214},{start:34,end:143},{start:143,end:156},{start:156,end:34},{start:79,end:239},{start:239,end:237},{start:237,end:79},{start:123,end:137},{start:137,end:177},{start:177,end:123},{start:44,end:1},{start:1,end:4},{start:4,end:44},{start:201,end:194},{start:194,end:32},{start:32,end:201},{start:64,end:102},{start:102,end:129},{start:129,end:64},{start:213,end:215},{start:215,end:138},{start:138,end:213},{start:59,end:166},{start:166,end:219},{start:219,end:59},{start:242,end:99},{start:99,end:97},{start:97,end:242},{start:2,end:94},{start:94,end:141},{start:141,end:2},{start:75,end:59},{start:59,end:235},{start:235,end:75},{start:24,end:110},{start:110,end:228},{start:228,end:24},{start:25,end:130},{start:130,end:226},{start:226,end:25},{start:23,end:24},{start:24,end:229},{start:229,end:23},{start:22,end:23},{start:23,end:230},{start:230,end:22},{start:26,end:22},{start:22,end:231},{start:231,end:26},{start:112,end:26},{start:26,end:232},{start:232,end:112},{start:189,end:190},{start:190,end:243},{start:243,end:189},{start:221,end:56},{start:56,end:190},{start:190,end:221},{start:28,end:56},{start:56,end:221},{start:221,end:28},{start:27,end:28},{start:28,end:222},{start:222,end:27},{start:29,end:27},{start:27,end:223},{start:223,end:29},{start:30,end:29},{start:29,end:224},{start:224,end:30},{start:247,end:30},{start:30,end:225},{start:225,end:247},{start:238,end:79},{start:79,end:20},{start:20,end:238},{start:166,end:59},{start:59,end:75},{start:75,end:166},{start:60,end:75},{start:75,end:240},{start:240,end:60},{start:147,end:177},{start:177,end:215},{start:215,end:147},{start:20,end:79},{start:79,end:166},{start:166,end:20},{start:187,end:147},{start:147,end:213},{start:213,end:187},{start:112,end:233},{start:233,end:244},{start:244,end:112},{start:233,end:128},{start:128,end:245},{start:245,end:233},{start:128,end:114},{start:114,end:188},{start:188,end:128},{start:114,end:217},{start:217,end:174},{start:174,end:114},{start:131,end:115},{start:115,end:220},{start:220,end:131},{start:217,end:198},{start:198,end:236},{start:236,end:217},{start:198,end:131},{start:131,end:134},{start:134,end:198},{start:177,end:132},{start:132,end:58},{start:58,end:177},{start:143,end:35},{start:35,end:124},{start:124,end:143},{start:110,end:163},{start:163,end:7},{start:7,end:110},{start:228,end:110},{start:110,end:25},{start:25,end:228},{start:356,end:389},{start:389,end:368},{start:368,end:356},{start:11,end:302},{start:302,end:267},{start:267,end:11},{start:452,end:350},{start:350,end:349},{start:349,end:452},{start:302,end:303},{start:303,end:269},{start:269,end:302},{start:357,end:343},{start:343,end:277},{start:277,end:357},{start:452,end:453},{start:453,end:357},{start:357,end:452},{start:333,end:332},{start:332,end:297},{start:297,end:333},{start:175,end:152},{start:152,end:377},{start:377,end:175},{start:347,end:348},{start:348,end:330},{start:330,end:347},{start:303,end:304},{start:304,end:270},{start:270,end:303},{start:9,end:336},{start:336,end:337},{start:337,end:9},{start:278,end:279},{start:279,end:360},{start:360,end:278},{start:418,end:262},{start:262,end:431},{start:431,end:418},{start:304,end:408},{start:408,end:409},{start:409,end:304},{start:310,end:415},{start:415,end:407},{start:407,end:310},{start:270,end:409},{start:409,end:410},{start:410,end:270},{start:450,end:348},{start:348,end:347},{start:347,end:450},{start:422,end:430},{start:430,end:434},{start:434,end:422},{start:313,end:314},{start:314,end:17},{start:17,end:313},{start:306,end:307},{start:307,end:375},{start:375,end:306},{start:387,end:388},{start:388,end:260},{start:260,end:387},{start:286,end:414},{start:414,end:398},{start:398,end:286},{start:335,end:406},{start:406,end:418},{start:418,end:335},{start:364,end:367},{start:367,end:416},{start:416,end:364},{start:423,end:358},{start:358,end:327},{start:327,end:423},{start:251,end:284},{start:284,end:298},{start:298,end:251},{start:281,end:5},{start:5,end:4},{start:4,end:281},{start:373,end:374},{start:374,end:253},{start:253,end:373},{start:307,end:320},{start:320,end:321},{start:321,end:307},{start:425,end:427},{start:427,end:411},{start:411,end:425},{start:421,end:313},{start:313,end:18},{start:18,end:421},{start:321,end:405},{start:405,end:406},{start:406,end:321},{start:320,end:404},{start:404,end:405},{start:405,end:320},{start:315,end:16},{start:16,end:17},{start:17,end:315},{start:426,end:425},{start:425,end:266},{start:266,end:426},{start:377,end:400},{start:400,end:369},{start:369,end:377},{start:322,end:391},{start:391,end:269},{start:269,end:322},{start:417,end:465},{start:465,end:464},{start:464,end:417},{start:386,end:257},{start:257,end:258},{start:258,end:386},{start:466,end:260},{start:260,end:388},{start:388,end:466},{start:456,end:399},{start:399,end:419},{start:419,end:456},{start:284,end:332},{start:332,end:333},{start:333,end:284},{start:417,end:285},{start:285,end:8},{start:8,end:417},{start:346,end:340},{start:340,end:261},{start:261,end:346},{start:413,end:441},{start:441,end:285},{start:285,end:413},{start:327,end:460},{start:460,end:328},{start:328,end:327},{start:355,end:371},{start:371,end:329},{start:329,end:355},{start:392,end:439},{start:439,end:438},{start:438,end:392},{start:382,end:341},{start:341,end:256},{start:256,end:382},{start:429,end:420},{start:420,end:360},{start:360,end:429},{start:364,end:394},{start:394,end:379},{start:379,end:364},{start:277,end:343},{start:343,end:437},{start:437,end:277},{start:443,end:444},{start:444,end:283},{start:283,end:443},{start:275,end:440},{start:440,end:363},{start:363,end:275},{start:431,end:262},{start:262,end:369},{start:369,end:431},{start:297,end:338},{start:338,end:337},{start:337,end:297},{start:273,end:375},{start:375,end:321},{start:321,end:273},{start:450,end:451},{start:451,end:349},{start:349,end:450},{start:446,end:342},{start:342,end:467},{start:467,end:446},{start:293,end:334},{start:334,end:282},{start:282,end:293},{start:458,end:461},{start:461,end:462},{start:462,end:458},{start:276,end:353},{start:353,end:383},{start:383,end:276},{start:308,end:324},{start:324,end:325},{start:325,end:308},{start:276,end:300},{start:300,end:293},{start:293,end:276},{start:372,end:345},{start:345,end:447},{start:447,end:372},{start:352,end:345},{start:345,end:340},{start:340,end:352},{start:274,end:1},{start:1,end:19},{start:19,end:274},{start:456,end:248},{start:248,end:281},{start:281,end:456},{start:436,end:427},{start:427,end:425},{start:425,end:436},{start:381,end:256},{start:256,end:252},{start:252,end:381},{start:269,end:391},{start:391,end:393},{start:393,end:269},{start:200,end:199},{start:199,end:428},{start:428,end:200},{start:266,end:330},{start:330,end:329},{start:329,end:266},{start:287,end:273},{start:273,end:422},{start:422,end:287},{start:250,end:462},{start:462,end:328},{start:328,end:250},{start:258,end:286},{start:286,end:384},{start:384,end:258},{start:265,end:353},{start:353,end:342},{start:342,end:265},{start:387,end:259},{start:259,end:257},{start:257,end:387},{start:424,end:431},{start:431,end:430},{start:430,end:424},{start:342,end:353},{start:353,end:276},{start:276,end:342},{start:273,end:335},{start:335,end:424},{start:424,end:273},{start:292,end:325},{start:325,end:307},{start:307,end:292},{start:366,end:447},{start:447,end:345},{start:345,end:366},{start:271,end:303},{start:303,end:302},{start:302,end:271},{start:423,end:266},{start:266,end:371},{start:371,end:423},{start:294,end:455},{start:455,end:460},{start:460,end:294},{start:279,end:278},{start:278,end:294},{start:294,end:279},{start:271,end:272},{start:272,end:304},{start:304,end:271},{start:432,end:434},{start:434,end:427},{start:427,end:432},{start:272,end:407},{start:407,end:408},{start:408,end:272},{start:394,end:430},{start:430,end:431},{start:431,end:394},{start:395,end:369},{start:369,end:400},{start:400,end:395},{start:334,end:333},{start:333,end:299},{start:299,end:334},{start:351,end:417},{start:417,end:168},{start:168,end:351},{start:352,end:280},{start:280,end:411},{start:411,end:352},{start:325,end:319},{start:319,end:320},{start:320,end:325},{start:295,end:296},{start:296,end:336},{start:336,end:295},{start:319,end:403},{start:403,end:404},{start:404,end:319},{start:330,end:348},{start:348,end:349},{start:349,end:330},{start:293,end:298},{start:298,end:333},{start:333,end:293},{start:323,end:454},{start:454,end:447},{start:447,end:323},{start:15,end:16},{start:16,end:315},{start:315,end:15},{start:358,end:429},{start:429,end:279},{start:279,end:358},{start:14,end:15},{start:15,end:316},{start:316,end:14},{start:285,end:336},{start:336,end:9},{start:9,end:285},{start:329,end:349},{start:349,end:350},{start:350,end:329},{start:374,end:380},{start:380,end:252},{start:252,end:374},{start:318,end:402},{start:402,end:403},{start:403,end:318},{start:6,end:197},{start:197,end:419},{start:419,end:6},{start:318,end:319},{start:319,end:325},{start:325,end:318},{start:367,end:364},{start:364,end:365},{start:365,end:367},{start:435,end:367},{start:367,end:397},{start:397,end:435},{start:344,end:438},{start:438,end:439},{start:439,end:344},{start:272,end:271},{start:271,end:311},{start:311,end:272},{start:195,end:5},{start:5,end:281},{start:281,end:195},{start:273,end:287},{start:287,end:291},{start:291,end:273},{start:396,end:428},{start:428,end:199},{start:199,end:396},{start:311,end:271},{start:271,end:268},{start:268,end:311},{start:283,end:444},{start:444,end:445},{start:445,end:283},{start:373,end:254},{start:254,end:339},{start:339,end:373},{start:282,end:334},{start:334,end:296},{start:296,end:282},{start:449,end:347},{start:347,end:346},{start:346,end:449},{start:264,end:447},{start:447,end:454},{start:454,end:264},{start:336,end:296},{start:296,end:299},{start:299,end:336},{start:338,end:10},{start:10,end:151},{start:151,end:338},{start:278,end:439},{start:439,end:455},{start:455,end:278},{start:292,end:407},{start:407,end:415},{start:415,end:292},{start:358,end:371},{start:371,end:355},{start:355,end:358},{start:340,end:345},{start:345,end:372},{start:372,end:340},{start:346,end:347},{start:347,end:280},{start:280,end:346},{start:442,end:443},{start:443,end:282},{start:282,end:442},{start:19,end:94},{start:94,end:370},{start:370,end:19},{start:441,end:442},{start:442,end:295},{start:295,end:441},{start:248,end:419},{start:419,end:197},{start:197,end:248},{start:263,end:255},{start:255,end:359},{start:359,end:263},{start:440,end:275},{start:275,end:274},{start:274,end:440},{start:300,end:383},{start:383,end:368},{start:368,end:300},{start:351,end:412},{start:412,end:465},{start:465,end:351},{start:263,end:467},{start:467,end:466},{start:466,end:263},{start:301,end:368},{start:368,end:389},{start:389,end:301},{start:395,end:378},{start:378,end:379},{start:379,end:395},{start:412,end:351},{start:351,end:419},{start:419,end:412},{start:436,end:426},{start:426,end:322},{start:322,end:436},{start:2,end:164},{start:164,end:393},{start:393,end:2},{start:370,end:462},{start:462,end:461},{start:461,end:370},{start:164,end:0},{start:0,end:267},{start:267,end:164},{start:302,end:11},{start:11,end:12},{start:12,end:302},{start:268,end:12},{start:12,end:13},{start:13,end:268},{start:293,end:300},{start:300,end:301},{start:301,end:293},{start:446,end:261},{start:261,end:340},{start:340,end:446},{start:330,end:266},{start:266,end:425},{start:425,end:330},{start:426,end:423},{start:423,end:391},{start:391,end:426},{start:429,end:355},{start:355,end:437},{start:437,end:429},{start:391,end:327},{start:327,end:326},{start:326,end:391},{start:440,end:457},{start:457,end:438},{start:438,end:440},{start:341,end:382},{start:382,end:362},{start:362,end:341},{start:459,end:457},{start:457,end:461},{start:461,end:459},{start:434,end:430},{start:430,end:394},{start:394,end:434},{start:414,end:463},{start:463,end:362},{start:362,end:414},{start:396,end:369},{start:369,end:262},{start:262,end:396},{start:354,end:461},{start:461,end:457},{start:457,end:354},{start:316,end:403},{start:403,end:402},{start:402,end:316},{start:315,end:404},{start:404,end:403},{start:403,end:315},{start:314,end:405},{start:405,end:404},{start:404,end:314},{start:313,end:406},{start:406,end:405},{start:405,end:313},{start:421,end:418},{start:418,end:406},{start:406,end:421},{start:366,end:401},{start:401,end:361},{start:361,end:366},{start:306,end:408},{start:408,end:407},{start:407,end:306},{start:291,end:409},{start:409,end:408},{start:408,end:291},{start:287,end:410},{start:410,end:409},{start:409,end:287},{start:432,end:436},{start:436,end:410},{start:410,end:432},{start:434,end:416},{start:416,end:411},{start:411,end:434},{start:264,end:368},{start:368,end:383},{start:383,end:264},{start:309,end:438},{start:438,end:457},{start:457,end:309},{start:352,end:376},{start:376,end:401},{start:401,end:352},{start:274,end:275},{start:275,end:4},{start:4,end:274},{start:421,end:428},{start:428,end:262},{start:262,end:421},{start:294,end:327},{start:327,end:358},{start:358,end:294},{start:433,end:416},{start:416,end:367},{start:367,end:433},{start:289,end:455},{start:455,end:439},{start:439,end:289},{start:462,end:370},{start:370,end:326},{start:326,end:462},{start:2,end:326},{start:326,end:370},{start:370,end:2},{start:305,end:460},{start:460,end:455},{start:455,end:305},{start:254,end:449},{start:449,end:448},{start:448,end:254},{start:255,end:261},{start:261,end:446},{start:446,end:255},{start:253,end:450},{start:450,end:449},{start:449,end:253},{start:252,end:451},{start:451,end:450},{start:450,end:252},{start:256,end:452},{start:452,end:451},{start:451,end:256},{start:341,end:453},{start:453,end:452},{start:452,end:341},{start:413,end:464},{start:464,end:463},{start:463,end:413},{start:441,end:413},{start:413,end:414},{start:414,end:441},{start:258,end:442},{start:442,end:441},{start:441,end:258},{start:257,end:443},{start:443,end:442},{start:442,end:257},{start:259,end:444},{start:444,end:443},{start:443,end:259},{start:260,end:445},{start:445,end:444},{start:444,end:260},{start:467,end:342},{start:342,end:445},{start:445,end:467},{start:459,end:458},{start:458,end:250},{start:250,end:459},{start:289,end:392},{start:392,end:290},{start:290,end:289},{start:290,end:328},{start:328,end:460},{start:460,end:290},{start:376,end:433},{start:433,end:435},{start:435,end:376},{start:250,end:290},{start:290,end:392},{start:392,end:250},{start:411,end:416},{start:416,end:433},{start:433,end:411},{start:341,end:463},{start:463,end:464},{start:464,end:341},{start:453,end:464},{start:464,end:465},{start:465,end:453},{start:357,end:465},{start:465,end:412},{start:412,end:357},{start:343,end:412},{start:412,end:399},{start:399,end:343},{start:360,end:363},{start:363,end:440},{start:440,end:360},{start:437,end:399},{start:399,end:456},{start:456,end:437},{start:420,end:456},{start:456,end:363},{start:363,end:420},{start:401,end:435},{start:435,end:288},{start:288,end:401},{start:372,end:383},{start:383,end:353},{start:353,end:372},{start:339,end:255},{start:255,end:249},{start:249,end:339},{start:448,end:261},{start:261,end:255},{start:255,end:448},{start:133,end:243},{start:243,end:190},{start:190,end:133},{start:133,end:155},{start:155,end:112},{start:112,end:133},{start:33,end:246},{start:246,end:247},{start:247,end:33},{start:33,end:130},{start:130,end:25},{start:25,end:33},{start:398,end:384},{start:384,end:286},{start:286,end:398},{start:362,end:398},{start:398,end:414},{start:414,end:362},{start:362,end:463},{start:463,end:341},{start:341,end:362},{start:263,end:359},{start:359,end:467},{start:467,end:263},{start:263,end:249},{start:249,end:255},{start:255,end:263},{start:466,end:467},{start:467,end:260},{start:260,end:466},{start:75,end:60},{start:60,end:166},{start:166,end:75},{start:238,end:239},{start:239,end:79},{start:79,end:238},{start:162,end:127},{start:127,end:139},{start:139,end:162},{start:72,end:11},{start:11,end:37},{start:37,end:72},{start:121,end:232},{start:232,end:120},{start:120,end:121},{start:73,end:72},{start:72,end:39},{start:39,end:73},{start:114,end:128},{start:128,end:47},{start:47,end:114},{start:233,end:232},{start:232,end:128},{start:128,end:233},{start:103,end:104},{start:104,end:67},{start:67,end:103},{start:152,end:175},{start:175,end:148},{start:148,end:152},{start:119,end:118},{start:118,end:101},{start:101,end:119},{start:74,end:73},{start:73,end:40},{start:40,end:74},{start:107,end:9},{start:9,end:108},{start:108,end:107},{start:49,end:48},{start:48,end:131},{start:131,end:49},{start:32,end:194},{start:194,end:211},{start:211,end:32},{start:184,end:74},{start:74,end:185},{start:185,end:184},{start:191,end:80},{start:80,end:183},{start:183,end:191},{start:185,end:40},{start:40,end:186},{start:186,end:185},{start:119,end:230},{start:230,end:118},{start:118,end:119},{start:210,end:202},{start:202,end:214},{start:214,end:210},{start:84,end:83},{start:83,end:17},{start:17,end:84},{start:77,end:76},{start:76,end:146},{start:146,end:77},{start:161,end:160},{start:160,end:30},{start:30,end:161},{start:190,end:56},{start:56,end:173},{start:173,end:190},{start:182,end:106},{start:106,end:194},{start:194,end:182},{start:138,end:135},{start:135,end:192},{start:192,end:138},{start:129,end:203},{start:203,end:98},{start:98,end:129},{start:54,end:21},{start:21,end:68},{start:68,end:54},{start:5,end:51},{start:51,end:4},{start:4,end:5},{start:145,end:144},{start:144,end:23},{start:23,end:145},{start:90,end:77},{start:77,end:91},{start:91,end:90},{start:207,end:205},{start:205,end:187},{start:187,end:207},{start:83,end:201},{start:201,end:18},{start:18,end:83},{start:181,end:91},{start:91,end:182},{start:182,end:181},{start:180,end:90},{start:90,end:181},{start:181,end:180},{start:16,end:85},{start:85,end:17},{start:17,end:16},{start:205,end:206},{start:206,end:36},{start:36,end:205},{start:176,end:148},{start:148,end:140},{start:140,end:176},{start:165,end:92},{start:92,end:39},{start:39,end:165},{start:245,end:193},{start:193,end:244},{start:244,end:245},{start:27,end:159},{start:159,end:28},{start:28,end:27},{start:30,end:247},{start:247,end:161},{start:161,end:30},{start:174,end:236},{start:236,end:196},{start:196,end:174},{start:103,end:54},{start:54,end:104},{start:104,end:103},{start:55,end:193},{start:193,end:8},{start:8,end:55},{start:111,end:117},{start:117,end:31},{start:31,end:111},{start:221,end:189},{start:189,end:55},{start:55,end:221},{start:240,end:98},{start:98,end:99},{start:99,end:240},{start:142,end:126},{start:126,end:100},{start:100,end:142},{start:219,end:166},{start:166,end:218},{start:218,end:219},{start:112,end:155},{start:155,end:26},{start:26,end:112},{start:198,end:209},{start:209,end:131},{start:131,end:198},{start:169,end:135},{start:135,end:150},{start:150,end:169},{start:114,end:47},{start:47,end:217},{start:217,end:114},{start:224,end:223},{start:223,end:53},{start:53,end:224},{start:220,end:45},{start:45,end:134},{start:134,end:220},{start:32,end:211},{start:211,end:140},{start:140,end:32},{start:109,end:67},{start:67,end:108},{start:108,end:109},{start:146,end:43},{start:43,end:91},{start:91,end:146},{start:231,end:230},{start:230,end:120},{start:120,end:231},{start:113,end:226},{start:226,end:247},{start:247,end:113},{start:105,end:63},{start:63,end:52},{start:52,end:105},{start:241,end:238},{start:238,end:242},{start:242,end:241},{start:124,end:46},{start:46,end:156},{start:156,end:124},{start:95,end:78},{start:78,end:96},{start:96,end:95},{start:70,end:46},{start:46,end:63},{start:63,end:70},{start:116,end:143},{start:143,end:227},{start:227,end:116},{start:116,end:123},{start:123,end:111},{start:111,end:116},{start:1,end:44},{start:44,end:19},{start:19,end:1},{start:3,end:236},{start:236,end:51},{start:51,end:3},{start:207,end:216},{start:216,end:205},{start:205,end:207},{start:26,end:154},{start:154,end:22},{start:22,end:26},{start:165,end:39},{start:39,end:167},{start:167,end:165},{start:199,end:200},{start:200,end:208},{start:208,end:199},{start:101,end:36},{start:36,end:100},{start:100,end:101},{start:43,end:57},{start:57,end:202},{start:202,end:43},{start:242,end:20},{start:20,end:99},{start:99,end:242},{start:56,end:28},{start:28,end:157},{start:157,end:56},{start:124,end:35},{start:35,end:113},{start:113,end:124},{start:29,end:160},{start:160,end:27},{start:27,end:29},{start:211,end:204},{start:204,end:210},{start:210,end:211},{start:124,end:113},{start:113,end:46},{start:46,end:124},{start:106,end:43},{start:43,end:204},{start:204,end:106},{start:96,end:62},{start:62,end:77},{start:77,end:96},{start:227,end:137},{start:137,end:116},{start:116,end:227},{start:73,end:41},{start:41,end:72},{start:72,end:73},{start:36,end:203},{start:203,end:142},{start:142,end:36},{start:235,end:64},{start:64,end:240},{start:240,end:235},{start:48,end:49},{start:49,end:64},{start:64,end:48},{start:42,end:41},{start:41,end:74},{start:74,end:42},{start:214,end:212},{start:212,end:207},{start:207,end:214},{start:183,end:42},{start:42,end:184},{start:184,end:183},{start:210,end:169},{start:169,end:211},{start:211,end:210},{start:140,end:170},{start:170,end:176},{start:176,end:140},{start:104,end:105},{start:105,end:69},{start:69,end:104},{start:193,end:122},{start:122,end:168},{start:168,end:193},{start:50,end:123},{start:123,end:187},{start:187,end:50},{start:89,end:96},{start:96,end:90},{start:90,end:89},{start:66,end:65},{start:65,end:107},{start:107,end:66},{start:179,end:89},{start:89,end:180},{start:180,end:179},{start:119,end:101},{start:101,end:120},{start:120,end:119},{start:68,end:63},{start:63,end:104},{start:104,end:68},{start:234,end:93},{start:93,end:227},{start:227,end:234},{start:16,end:15},{start:15,end:85},{start:85,end:16},{start:209,end:129},{start:129,end:49},{start:49,end:209},{start:15,end:14},{start:14,end:86},{start:86,end:15},{start:107,end:55},{start:55,end:9},{start:9,end:107},{start:120,end:100},{start:100,end:121},{start:121,end:120},{start:153,end:145},{start:145,end:22},{start:22,end:153},{start:178,end:88},{start:88,end:179},{start:179,end:178},{start:197,end:6},{start:6,end:196},{start:196,end:197},{start:89,end:88},{start:88,end:96},{start:96,end:89},{start:135,end:138},{start:138,end:136},{start:136,end:135},{start:138,end:215},{start:215,end:172},{start:172,end:138},{start:218,end:115},{start:115,end:219},{start:219,end:218},{start:41,end:42},{start:42,end:81},{start:81,end:41},{start:5,end:195},{start:195,end:51},{start:51,end:5},{start:57,end:43},{start:43,end:61},{start:61,end:57},{start:208,end:171},{start:171,end:199},{start:199,end:208},{start:41,end:81},{start:81,end:38},{start:38,end:41},{start:224,end:53},{start:53,end:225},{start:225,end:224},{start:24,end:144},{start:144,end:110},{start:110,end:24},{start:105,end:52},{start:52,end:66},{start:66,end:105},{start:118,end:229},{start:229,end:117},{start:117,end:118},{start:227,end:34},{start:34,end:234},{start:234,end:227},{start:66,end:107},{start:107,end:69},{start:69,end:66},{start:10,end:109},{start:109,end:151},{start:151,end:10},{start:219,end:48},{start:48,end:235},{start:235,end:219},{start:183,end:62},{start:62,end:191},{start:191,end:183},{start:142,end:129},{start:129,end:126},{start:126,end:142},{start:116,end:111},{start:111,end:143},{start:143,end:116},{start:118,end:117},{start:117,end:50},{start:50,end:118},{start:223,end:222},{start:222,end:52},{start:52,end:223},{start:94,end:19},{start:19,end:141},{start:141,end:94},{start:222,end:221},{start:221,end:65},{start:65,end:222},{start:196,end:3},{start:3,end:197},{start:197,end:196},{start:45,end:220},{start:220,end:44},{start:44,end:45},{start:156,end:70},{start:70,end:139},{start:139,end:156},{start:188,end:122},{start:122,end:245},{start:245,end:188},{start:139,end:71},{start:71,end:162},{start:162,end:139},{start:149,end:170},{start:170,end:150},{start:150,end:149},{start:122,end:188},{start:188,end:196},{start:196,end:122},{start:206,end:216},{start:216,end:92},{start:92,end:206},{start:164,end:2},{start:2,end:167},{start:167,end:164},{start:242,end:141},{start:141,end:241},{start:241,end:242},{start:0,end:164},{start:164,end:37},{start:37,end:0},{start:11,end:72},{start:72,end:12},{start:12,end:11},{start:12,end:38},{start:38,end:13},{start:13,end:12},{start:70,end:63},{start:63,end:71},{start:71,end:70},{start:31,end:226},{start:226,end:111},{start:111,end:31},{start:36,end:101},{start:101,end:205},{start:205,end:36},{start:203,end:206},{start:206,end:165},{start:165,end:203},{start:126,end:209},{start:209,end:217},{start:217,end:126},{start:98,end:165},{start:165,end:97},{start:97,end:98},{start:237,end:220},{start:220,end:218},{start:218,end:237},{start:237,end:239},{start:239,end:241},{start:241,end:237},{start:210,end:214},{start:214,end:169},{start:169,end:210},{start:140,end:171},{start:171,end:32},{start:32,end:140},{start:241,end:125},{start:125,end:237},{start:237,end:241},{start:179,end:86},{start:86,end:178},{start:178,end:179},{start:180,end:85},{start:85,end:179},{start:179,end:180},{start:181,end:84},{start:84,end:180},{start:180,end:181},{start:182,end:83},{start:83,end:181},{start:181,end:182},{start:194,end:201},{start:201,end:182},{start:182,end:194},{start:177,end:137},{start:137,end:132},{start:132,end:177},{start:184,end:76},{start:76,end:183},{start:183,end:184},{start:185,end:61},{start:61,end:184},{start:184,end:185},{start:186,end:57},{start:57,end:185},{start:185,end:186},{start:216,end:212},{start:212,end:186},{start:186,end:216},{start:192,end:214},{start:214,end:187},{start:187,end:192},{start:139,end:34},{start:34,end:156},{start:156,end:139},{start:218,end:79},{start:79,end:237},{start:237,end:218},{start:147,end:123},{start:123,end:177},{start:177,end:147},{start:45,end:44},{start:44,end:4},{start:4,end:45},{start:208,end:201},{start:201,end:32},{start:32,end:208},{start:98,end:64},{start:64,end:129},{start:129,end:98},{start:192,end:213},{start:213,end:138},{start:138,end:192},{start:235,end:59},{start:59,end:219},{start:219,end:235},{start:141,end:242},{start:242,end:97},{start:97,end:141},{start:97,end:2},{start:2,end:141},{start:141,end:97},{start:240,end:75},{start:75,end:235},{start:235,end:240},{start:229,end:24},{start:24,end:228},{start:228,end:229},{start:31,end:25},{start:25,end:226},{start:226,end:31},{start:230,end:23},{start:23,end:229},{start:229,end:230},{start:231,end:22},{start:22,end:230},{start:230,end:231},{start:232,end:26},{start:26,end:231},{start:231,end:232},{start:233,end:112},{start:112,end:232},{start:232,end:233},{start:244,end:189},{start:189,end:243},{start:243,end:244},{start:189,end:221},{start:221,end:190},{start:190,end:189},{start:222,end:28},{start:28,end:221},{start:221,end:222},{start:223,end:27},{start:27,end:222},{start:222,end:223},{start:224,end:29},{start:29,end:223},{start:223,end:224},{start:225,end:30},{start:30,end:224},{start:224,end:225},{start:113,end:247},{start:247,end:225},{start:225,end:113},{start:99,end:60},{start:60,end:240},{start:240,end:99},{start:213,end:147},{start:147,end:215},{start:215,end:213},{start:60,end:20},{start:20,end:166},{start:166,end:60},{start:192,end:187},{start:187,end:213},{start:213,end:192},{start:243,end:112},{start:112,end:244},{start:244,end:243},{start:244,end:233},{start:233,end:245},{start:245,end:244},{start:245,end:128},{start:128,end:188},{start:188,end:245},{start:188,end:114},{start:114,end:174},{start:174,end:188},{start:134,end:131},{start:131,end:220},{start:220,end:134},{start:174,end:217},{start:217,end:236},{start:236,end:174},{start:236,end:198},{start:198,end:134},{start:134,end:236},{start:215,end:177},{start:177,end:58},{start:58,end:215},{start:156,end:143},{start:143,end:124},{start:124,end:156},{start:25,end:110},{start:110,end:7},{start:7,end:25},{start:31,end:228},{start:228,end:25},{start:25,end:31},{start:264,end:356},{start:356,end:368},{start:368,end:264},{start:0,end:11},{start:11,end:267},{start:267,end:0},{start:451,end:452},{start:452,end:349},{start:349,end:451},{start:267,end:302},{start:302,end:269},{start:269,end:267},{start:350,end:357},{start:357,end:277},{start:277,end:350},{start:350,end:452},{start:452,end:357},{start:357,end:350},{start:299,end:333},{start:333,end:297},{start:297,end:299},{start:396,end:175},{start:175,end:377},{start:377,end:396},{start:280,end:347},{start:347,end:330},{start:330,end:280},{start:269,end:303},{start:303,end:270},{start:270,end:269},{start:151,end:9},{start:9,end:337},{start:337,end:151},{start:344,end:278},{start:278,end:360},{start:360,end:344},{start:424,end:418},{start:418,end:431},{start:431,end:424},{start:270,end:304},{start:304,end:409},{start:409,end:270},{start:272,end:310},{start:310,end:407},{start:407,end:272},{start:322,end:270},{start:270,end:410},{start:410,end:322},{start:449,end:450},{start:450,end:347},{start:347,end:449},{start:432,end:422},{start:422,end:434},{start:434,end:432},{start:18,end:313},{start:313,end:17},{start:17,end:18},{start:291,end:306},{start:306,end:375},{start:375,end:291},{start:259,end:387},{start:387,end:260},{start:260,end:259},{start:424,end:335},{start:335,end:418},{start:418,end:424},{start:434,end:364},{start:364,end:416},{start:416,end:434},{start:391,end:423},{start:423,end:327},{start:327,end:391},{start:301,end:251},{start:251,end:298},{start:298,end:301},{start:275,end:281},{start:281,end:4},{start:4,end:275},{start:254,end:373},{start:373,end:253},{start:253,end:254},{start:375,end:307},{start:307,end:321},{start:321,end:375},{start:280,end:425},{start:425,end:411},{start:411,end:280},{start:200,end:421},{start:421,end:18},{start:18,end:200},{start:335,end:321},{start:321,end:406},{start:406,end:335},{start:321,end:320},{start:320,end:405},{start:405,end:321},{start:314,end:315},{start:315,end:17},{start:17,end:314},{start:423,end:426},{start:426,end:266},{start:266,end:423},{start:396,end:377},{start:377,end:369},{start:369,end:396},{start:270,end:322},{start:322,end:269},{start:269,end:270},{start:413,end:417},{start:417,end:464},{start:464,end:413},{start:385,end:386},{start:386,end:258},{start:258,end:385},{start:248,end:456},{start:456,end:419},{start:419,end:248},{start:298,end:284},{start:284,end:333},{start:333,end:298},{start:168,end:417},{start:417,end:8},{start:8,end:168},{start:448,end:346},{start:346,end:261},{start:261,end:448},{start:417,end:413},{start:413,end:285},{start:285,end:417},{start:326,end:327},{start:327,end:328},{start:328,end:326},{start:277,end:355},{start:355,end:329},{start:329,end:277},{start:309,end:392},{start:392,end:438},{start:438,end:309},{start:381,end:382},{start:382,end:256},{start:256,end:381},{start:279,end:429},{start:429,end:360},{start:360,end:279},{start:365,end:364},{start:364,end:379},{start:379,end:365},{start:355,end:277},{start:277,end:437},{start:437,end:355},{start:282,end:443},{start:443,end:283},{start:283,end:282},{start:281,end:275},{start:275,end:363},{start:363,end:281},{start:395,end:431},{start:431,end:369},{start:369,end:395},{start:299,end:297},{start:297,end:337},{start:337,end:299},{start:335,end:273},{start:273,end:321},{start:321,end:335},{start:348,end:450},{start:450,end:349},{start:349,end:348},{start:359,end:446},{start:446,end:467},{start:467,end:359},{start:283,end:293},{start:293,end:282},{start:282,end:283},{start:250,end:458},{start:458,end:462},{start:462,end:250},{start:300,end:276},{start:276,end:383},{start:383,end:300},{start:292,end:308},{start:308,end:325},{start:325,end:292},{start:283,end:276},{start:276,end:293},{start:293,end:283},{start:264,end:372},{start:372,end:447},{start:447,end:264},{start:346,end:352},{start:352,end:340},{start:340,end:346},{start:354,end:274},{start:274,end:19},{start:19,end:354},{start:363,end:456},{start:456,end:281},{start:281,end:363},{start:426,end:436},{start:436,end:425},{start:425,end:426},{start:380,end:381},{start:381,end:252},{start:252,end:380},{start:267,end:269},{start:269,end:393},{start:393,end:267},{start:421,end:200},{start:200,end:428},{start:428,end:421},{start:371,end:266},{start:266,end:329},{start:329,end:371},{start:432,end:287},{start:287,end:422},{start:422,end:432},{start:290,end:250},{start:250,end:328},{start:328,end:290},{start:385,end:258},{start:258,end:384},{start:384,end:385},{start:446,end:265},{start:265,end:342},{start:342,end:446},{start:386,end:387},{start:387,end:257},{start:257,end:386},{start:422,end:424},{start:424,end:430},{start:430,end:422},{start:445,end:342},{start:342,end:276},{start:276,end:445},{start:422,end:273},{start:273,end:424},{start:424,end:422},{start:306,end:292},{start:292,end:307},{start:307,end:306},{start:352,end:366},{start:366,end:345},{start:345,end:352},{start:268,end:271},{start:271,end:302},{start:302,end:268},{start:358,end:423},{start:423,end:371},{start:371,end:358},{start:327,end:294},{start:294,end:460},{start:460,end:327},{start:331,end:279},{start:279,end:294},{start:294,end:331},{start:303,end:271},{start:271,end:304},{start:304,end:303},{start:436,end:432},{start:432,end:427},{start:427,end:436},{start:304,end:272},{start:272,end:408},{start:408,end:304},{start:395,end:394},{start:394,end:431},{start:431,end:395},{start:378,end:395},{start:395,end:400},{start:400,end:378},{start:296,end:334},{start:334,end:299},{start:299,end:296},{start:6,end:351},{start:351,end:168},{start:168,end:6},{start:376,end:352},{start:352,end:411},{start:411,end:376},{start:307,end:325},{start:325,end:320},{start:320,end:307},{start:285,end:295},{start:295,end:336},{start:336,end:285},{start:320,end:319},{start:319,end:404},{start:404,end:320},{start:329,end:330},{start:330,end:349},{start:349,end:329},{start:334,end:293},{start:293,end:333},{start:333,end:334},{start:366,end:323},{start:323,end:447},{start:447,end:366},{start:316,end:15},{start:15,end:315},{start:315,end:316},{start:331,end:358},{start:358,end:279},{start:279,end:331},{start:317,end:14},{start:14,end:316},{start:316,end:317},{start:8,end:285},{start:285,end:9},{start:9,end:8},{start:277,end:329},{start:329,end:350},{start:350,end:277},{start:253,end:374},{start:374,end:252},{start:252,end:253},{start:319,end:318},{start:318,end:403},{start:403,end:319},{start:351,end:6},{start:6,end:419},{start:419,end:351},{start:324,end:318},{start:318,end:325},{start:325,end:324},{start:397,end:367},{start:367,end:365},{start:365,end:397},{start:288,end:435},{start:435,end:397},{start:397,end:288},{start:278,end:344},{start:344,end:439},{start:439,end:278},{start:310,end:272},{start:272,end:311},{start:311,end:310},{start:248,end:195},{start:195,end:281},{start:281,end:248},{start:375,end:273},{start:273,end:291},{start:291,end:375},{start:175,end:396},{start:396,end:199},{start:199,end:175},{start:312,end:311},{start:311,end:268},{start:268,end:312},{start:276,end:283},{start:283,end:445},{start:445,end:276},{start:390,end:373},{start:373,end:339},{start:339,end:390},{start:295,end:282},{start:282,end:296},{start:296,end:295},{start:448,end:449},{start:449,end:346},{start:346,end:448},{start:356,end:264},{start:264,end:454},{start:454,end:356},{start:337,end:336},{start:336,end:299},{start:299,end:337},{start:337,end:338},{start:338,end:151},{start:151,end:337},{start:294,end:278},{start:278,end:455},{start:455,end:294},{start:308,end:292},{start:292,end:415},{start:415,end:308},{start:429,end:358},{start:358,end:355},{start:355,end:429},{start:265,end:340},{start:340,end:372},{start:372,end:265},{start:352,end:346},{start:346,end:280},{start:280,end:352},{start:295,end:442},{start:442,end:282},{start:282,end:295},{start:354,end:19},{start:19,end:370},{start:370,end:354},{start:285,end:441},{start:441,end:295},{start:295,end:285},{start:195,end:248},{start:248,end:197},{start:197,end:195},{start:457,end:440},{start:440,end:274},{start:274,end:457},{start:301,end:300},{start:300,end:368},{start:368,end:301},{start:417,end:351},{start:351,end:465},{start:465,end:417},{start:251,end:301},{start:301,end:389},{start:389,end:251},{start:394,end:395},{start:395,end:379},{start:379,end:394},{start:399,end:412},{start:412,end:419},{start:419,end:399},{start:410,end:436},{start:436,end:322},{start:322,end:410},{start:326,end:2},{start:2,end:393},{start:393,end:326},{start:354,end:370},{start:370,end:461},{start:461,end:354},{start:393,end:164},{start:164,end:267},{start:267,end:393},{start:268,end:302},{start:302,end:12},{start:12,end:268},{start:312,end:268},{start:268,end:13},{start:13,end:312},{start:298,end:293},{start:293,end:301},{start:301,end:298},{start:265,end:446},{start:446,end:340},{start:340,end:265},{start:280,end:330},{start:330,end:425},{start:425,end:280},{start:322,end:426},{start:426,end:391},{start:391,end:322},{start:420,end:429},{start:429,end:437},{start:437,end:420},{start:393,end:391},{start:391,end:326},{start:326,end:393},{start:344,end:440},{start:440,end:438},{start:438,end:344},{start:458,end:459},{start:459,end:461},{start:461,end:458},{start:364,end:434},{start:434,end:394},{start:394,end:364},{start:428,end:396},{start:396,end:262},{start:262,end:428},{start:274,end:354},{start:354,end:457},{start:457,end:274},{start:317,end:316},{start:316,end:402},{start:402,end:317},{start:316,end:315},{start:315,end:403},{start:403,end:316},{start:315,end:314},{start:314,end:404},{start:404,end:315},{start:314,end:313},{start:313,end:405},{start:405,end:314},{start:313,end:421},{start:421,end:406},{start:406,end:313},{start:323,end:366},{start:366,end:361},{start:361,end:323},{start:292,end:306},{start:306,end:407},{start:407,end:292},{start:306,end:291},{start:291,end:408},{start:408,end:306},{start:291,end:287},{start:287,end:409},{start:409,end:291},{start:287,end:432},{start:432,end:410},{start:410,end:287},{start:427,end:434},{start:434,end:411},{start:411,end:427},{start:372,end:264},{start:264,end:383},{start:383,end:372},{start:459,end:309},{start:309,end:457},{start:457,end:459},{start:366,end:352},{start:352,end:401},{start:401,end:366},{start:1,end:274},{start:274,end:4},{start:4,end:1},{start:418,end:421},{start:421,end:262},{start:262,end:418},{start:331,end:294},{start:294,end:358},{start:358,end:331},{start:435,end:433},{start:433,end:367},{start:367,end:435},{start:392,end:289},{start:289,end:439},{start:439,end:392},{start:328,end:462},{start:462,end:326},{start:326,end:328},{start:94,end:2},{start:2,end:370},{start:370,end:94},{start:289,end:305},{start:305,end:455},{start:455,end:289},{start:339,end:254},{start:254,end:448},{start:448,end:339},{start:359,end:255},{start:255,end:446},{start:446,end:359},{start:254,end:253},{start:253,end:449},{start:449,end:254},{start:253,end:252},{start:252,end:450},{start:450,end:253},{start:252,end:256},{start:256,end:451},{start:451,end:252},{start:256,end:341},{start:341,end:452},{start:452,end:256},{start:414,end:413},{start:413,end:463},{start:463,end:414},{start:286,end:441},{start:441,end:414},{start:414,end:286},{start:286,end:258},{start:258,end:441},{start:441,end:286},{start:258,end:257},{start:257,end:442},{start:442,end:258},{start:257,end:259},{start:259,end:443},{start:443,end:257},{start:259,end:260},{start:260,end:444},{start:444,end:259},{start:260,end:467},{start:467,end:445},{start:445,end:260},{start:309,end:459},{start:459,end:250},{start:250,end:309},{start:305,end:289},{start:289,end:290},{start:290,end:305},{start:305,end:290},{start:290,end:460},{start:460,end:305},{start:401,end:376},{start:376,end:435},{start:435,end:401},{start:309,end:250},{start:250,end:392},{start:392,end:309},{start:376,end:411},{start:411,end:433},{start:433,end:376},{start:453,end:341},{start:341,end:464},{start:464,end:453},{start:357,end:453},{start:453,end:465},{start:465,end:357},{start:343,end:357},{start:357,end:412},{start:412,end:343},{start:437,end:343},{start:343,end:399},{start:399,end:437},{start:344,end:360},{start:360,end:440},{start:440,end:344},{start:420,end:437},{start:437,end:456},{start:456,end:420},{start:360,end:420},{start:420,end:363},{start:363,end:360},{start:361,end:401},{start:401,end:288},{start:288,end:361},{start:265,end:372},{start:372,end:353},{start:353,end:265},{start:390,end:339},{start:339,end:249},{start:249,end:390},{start:339,end:448},{start:448,end:255},{start:255,end:339}];var face_landmarker_options={};Object.defineProperty(face_landmarker_options,"__esModule",{value:!0});var face_landmarker_result={};Object.defineProperty(face_landmarker_result,"__esModule",{value:!0}),function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.FaceLandmarker=void 0;const r=calculator_pb,i=calculator_options_pb,o=classification_pb,a=landmark_pb,s=base_options_pb,u=face_detector_graph_options_pb,l=face_geometry_pb,c=face_landmarker_graph_options_pb,p=face_landmarks_detector_graph_options_pb,d=classifier_result,h=landmark_result,f=vision_task_runner,g=face_landmarks_connections;n(face_landmarker_options,e),n(face_landmarker_result,e);const m="image_in",y="norm_rect",b="face_landmarks",v="blendshapes",x="face_geometry",_=.5;class w extends f.VisionTaskRunner{static createFromOptions(e,t){return f.VisionTaskRunner.createVisionInstance(w,e,t)}static createFromModelBuffer(e,t){return f.VisionTaskRunner.createVisionInstance(w,e,{baseOptions:{modelAssetBuffer:t}})}static createFromModelPath(e,t){return f.VisionTaskRunner.createVisionInstance(w,e,{baseOptions:{modelAssetPath:t}})}constructor(e,t){super(new f.VisionGraphRunner(e,t),m,y,!1),this.result={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]},this.outputFaceBlendshapes=!1,this.outputFacialTransformationMatrixes=!1,this.options=new c.FaceLandmarkerGraphOptions,this.options.setBaseOptions(new s.BaseOptions),this.faceLandmarksDetectorGraphOptions=new p.FaceLandmarksDetectorGraphOptions,this.options.setFaceLandmarksDetectorGraphOptions(this.faceLandmarksDetectorGraphOptions),this.faceDetectorGraphOptions=new u.FaceDetectorGraphOptions,this.options.setFaceDetectorGraphOptions(this.faceDetectorGraphOptions),this.initDefaults()}get baseOptions(){return this.options.getBaseOptions()}set baseOptions(e){this.options.setBaseOptions(e)}setOptions(e){var t,n,r,i;return"numFaces"in e&&this.faceDetectorGraphOptions.setNumFaces(null!==(t=e.numFaces)&&void 0!==t?t:1),"minFaceDetectionConfidence"in e&&this.faceDetectorGraphOptions.setMinDetectionConfidence(null!==(n=e.minFaceDetectionConfidence)&&void 0!==n?n:_),"minTrackingConfidence"in e&&this.options.setMinTrackingConfidence(null!==(r=e.minTrackingConfidence)&&void 0!==r?r:_),"minFacePresenceConfidence"in e&&this.faceLandmarksDetectorGraphOptions.setMinDetectionConfidence(null!==(i=e.minFacePresenceConfidence)&&void 0!==i?i:_),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"outputFacialTransformationMatrixes"in e&&(this.outputFacialTransformationMatrixes=!!e.outputFacialTransformationMatrixes),this.applyOptions(e)}detect(e,t){return this.resetResults(),this.processImageData(e,t),this.result}detectForVideo(e,t,n){return this.resetResults(),this.processVideoData(e,n,t),this.result}resetResults(){this.result={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]}}initDefaults(){this.faceDetectorGraphOptions.setNumFaces(1),this.faceDetectorGraphOptions.setMinDetectionConfidence(_),this.faceLandmarksDetectorGraphOptions.setMinDetectionConfidence(_),this.options.setMinTrackingConfidence(_)}addJsLandmarks(e){for(const t of e){const e=a.NormalizedLandmarkList.deserializeBinary(t);this.result.faceLandmarks.push((0,h.convertToLandmarks)(e))}}addBlenshape(e){var t;if(this.outputFaceBlendshapes)for(const n of e){const e=o.ClassificationList.deserializeBinary(n);this.result.faceBlendshapes.push((0,d.convertFromClassifications)(null!==(t=e.getClassificationList())&&void 0!==t?t:[]))}}addFacialTransformationMatrixes(e){var t,n,r;if(this.outputFacialTransformationMatrixes)for(const i of e){const e=l.FaceGeometry.deserializeBinary(i).getPoseTransformMatrix();e&&this.result.facialTransformationMatrixes.push({rows:null!==(t=e.getRows())&&void 0!==t?t:0,columns:null!==(n=e.getCols())&&void 0!==n?n:0,data:null!==(r=e.getPackedDataList())&&void 0!==r?r:[]})}}refreshGraph(){const e=new r.CalculatorGraphConfig;e.addInputStream(m),e.addInputStream(y),e.addOutputStream(b);const t=new i.CalculatorOptions;t.setExtension(c.FaceLandmarkerGraphOptions.ext,this.options);const n=new r.CalculatorGraphConfig.Node;n.setCalculator("mediapipe.tasks.vision.face_landmarker.FaceLandmarkerGraph"),n.addInputStream("IMAGE:"+m),n.addInputStream("NORM_RECT:"+y),n.addOutputStream("NORM_LANDMARKS:"+b),n.setOptions(t),e.addNode(n),this.graphRunner.attachProtoVectorListener(b,((e,t)=>{this.addJsLandmarks(e),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(b,(e=>{this.setLatestOutputTimestamp(e)})),this.outputFaceBlendshapes&&(e.addOutputStream(v),n.addOutputStream("BLENDSHAPES:"+v),this.graphRunner.attachProtoVectorListener(v,((e,t)=>{this.addBlenshape(e),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(v,(e=>{this.setLatestOutputTimestamp(e)}))),this.outputFacialTransformationMatrixes&&(e.addOutputStream(x),n.addOutputStream("FACE_GEOMETRY:"+x),this.graphRunner.attachProtoVectorListener(x,((e,t)=>{this.addFacialTransformationMatrixes(e),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(x,(e=>{this.setLatestOutputTimestamp(e)})));const o=e.serializeBinary();this.setGraph(new Uint8Array(o),!0)}}e.FaceLandmarker=w,w.FACE_LANDMARKS_LIPS=g.FACE_LANDMARKS_LIPS,w.FACE_LANDMARKS_LEFT_EYE=g.FACE_LANDMARKS_LEFT_EYE,w.FACE_LANDMARKS_LEFT_EYEBROW=g.FACE_LANDMARKS_LEFT_EYEBROW,w.FACE_LANDMARKS_LEFT_IRIS=g.FACE_LANDMARKS_LEFT_IRIS,w.FACE_LANDMARKS_RIGHT_EYE=g.FACE_LANDMARKS_RIGHT_EYE,w.FACE_LANDMARKS_RIGHT_EYEBROW=g.FACE_LANDMARKS_RIGHT_EYEBROW,w.FACE_LANDMARKS_RIGHT_IRIS=g.FACE_LANDMARKS_RIGHT_IRIS,w.FACE_LANDMARKS_FACE_OVAL=g.FACE_LANDMARKS_FACE_OVAL,w.FACE_LANDMARKS_CONTOURS=g.FACE_LANDMARKS_CONTOURS,w.FACE_LANDMARKS_TESSELATION=g.FACE_LANDMARKS_TESSELATION}(face_landmarker);var face_stylizer={},face_stylizer_graph_options_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=base_options_pb;n.object.extend(proto,a);var s=face_landmarker_graph_options_pb;n.object.extend(proto,s),n.exportSymbol("proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions",null,r),proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.displayName="proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.toObject=function(e,n){var r,i={baseOptions:(r=n.getBaseOptions())&&a.BaseOptions.toObject(e,r),faceLandmarkerGraphOptions:(r=n.getFaceLandmarkerGraphOptions())&&s.FaceLandmarkerGraphOptions.toObject(e,r),faceAlignmentSize:t.Message.getFieldWithDefault(n,3,256)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions;return proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new a.BaseOptions;t.readMessage(n,a.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=new s.FaceLandmarkerGraphOptions,t.readMessage(n,s.FaceLandmarkerGraphOptions.deserializeBinaryFromReader),e.setFaceLandmarkerGraphOptions(n);break;case 3:n=t.readInt32(),e.setFaceAlignmentSize(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getBaseOptions())&&n.writeMessage(1,r,a.BaseOptions.serializeBinaryToWriter),null!=(r=e.getFaceLandmarkerGraphOptions())&&n.writeMessage(2,r,s.FaceLandmarkerGraphOptions.serializeBinaryToWriter),null!=(r=t.Message.getField(e,3))&&n.writeInt32(3,r)},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.ext=new t.ExtensionFieldInfo(513916220,{ext:0},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions,proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[513916220]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[513916220]=proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.ext,proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,a.BaseOptions,1)},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.prototype.getFaceLandmarkerGraphOptions=function(){return t.Message.getWrapperField(this,s.FaceLandmarkerGraphOptions,2)},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.prototype.setFaceLandmarkerGraphOptions=function(e){return t.Message.setWrapperField(this,2,e)},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.prototype.clearFaceLandmarkerGraphOptions=function(){return this.setFaceLandmarkerGraphOptions(void 0)},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.prototype.hasFaceLandmarkerGraphOptions=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.prototype.getFaceAlignmentSize=function(){return t.Message.getFieldWithDefault(this,3,256)},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.prototype.setFaceAlignmentSize=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.prototype.clearFaceAlignmentSize=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.prototype.hasFaceAlignmentSize=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.ext=new t.ExtensionFieldInfo(513916220,{ext:0},proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions,proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[513916220]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[513916220]=proto.mediapipe.tasks.vision.face_stylizer.proto.FaceStylizerGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.face_stylizer.proto)}(face_stylizer_graph_options_pb);var face_stylizer_options={};Object.defineProperty(face_stylizer_options,"__esModule",{value:!0}),function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.FaceStylizer=void 0;const r=calculator_pb,i=calculator_options_pb,o=base_options_pb,a=face_stylizer_graph_options_pb,s=vision_task_runner;n(face_stylizer_options,e);const u="image_in",l="norm_rect",c="stylized_image";class p extends s.VisionTaskRunner{static createFromOptions(e,t){return s.VisionTaskRunner.createVisionInstance(p,e,t)}static createFromModelBuffer(e,t){return s.VisionTaskRunner.createVisionInstance(p,e,{baseOptions:{modelAssetBuffer:t}})}static createFromModelPath(e,t){return s.VisionTaskRunner.createVisionInstance(p,e,{baseOptions:{modelAssetPath:t}})}constructor(e,t){super(new s.VisionGraphRunner(e,t),u,l,!0),this.options=new a.FaceStylizerGraphOptions,this.options.setBaseOptions(new o.BaseOptions)}get baseOptions(){return this.options.getBaseOptions()}set baseOptions(e){this.options.setBaseOptions(e)}setOptions(e){return super.applyOptions(e)}stylize(e,t,n){const r="function"!=typeof t?t:{};if(this.userCallback="function"==typeof t?t:n,this.processImageData(e,null!=r?r:{}),!this.userCallback)return this.result}stylizeForVideo(e,t,n,r){const i="function"!=typeof n?n:{};if(this.userCallback="function"==typeof n?n:r,this.processVideoData(e,i,t),this.userCallback=void 0,!this.userCallback)return this.result}refreshGraph(){const e=new r.CalculatorGraphConfig;e.addInputStream(u),e.addInputStream(l),e.addOutputStream(c);const t=new i.CalculatorOptions;t.setExtension(a.FaceStylizerGraphOptions.ext,this.options);const n=new r.CalculatorGraphConfig.Node;n.setCalculator("mediapipe.tasks.vision.face_stylizer.FaceStylizerGraph"),n.addInputStream("IMAGE:"+u),n.addInputStream("NORM_RECT:"+l),n.addOutputStream("STYLIZED_IMAGE:"+c),n.setOptions(t),e.addNode(n),this.graphRunner.attachImageListener(c,((e,t)=>{const n=this.convertToMPImage(e,!this.userCallback);this.result=n,this.userCallback&&this.userCallback(n),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(c,(e=>{this.result=null,this.userCallback&&this.userCallback(null),this.setLatestOutputTimestamp(e)}));const o=e.serializeBinary();this.setGraph(new Uint8Array(o),!0)}}e.FaceStylizer=p}(face_stylizer);var gesture_recognizer={},gesture_classifier_graph_options_pb={},classifier_options_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.tasks.components.processors.proto.ClassifierOptions",null,r),proto.mediapipe.tasks.components.processors.proto.ClassifierOptions=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.repeatedFields_,null)},n.inherits(proto.mediapipe.tasks.components.processors.proto.ClassifierOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.displayName="proto.mediapipe.tasks.components.processors.proto.ClassifierOptions"),proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.repeatedFields_=[4,5],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.toObject(e,this)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.toObject=function(e,n){var r,i={displayNamesLocale:t.Message.getFieldWithDefault(n,1,"en"),maxResults:t.Message.getFieldWithDefault(n,2,-1),scoreThreshold:null==(r=t.Message.getOptionalFloatingPointField(n,3))?void 0:r,categoryAllowlistList:null==(r=t.Message.getRepeatedField(n,4))?void 0:r,categoryDenylistList:null==(r=t.Message.getRepeatedField(n,5))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.components.processors.proto.ClassifierOptions;return proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.setDisplayNamesLocale(n);break;case 2:n=t.readInt32(),e.setMaxResults(n);break;case 3:n=t.readFloat(),e.setScoreThreshold(n);break;case 4:n=t.readString(),e.addCategoryAllowlist(n);break;case 5:n=t.readString(),e.addCategoryDenylist(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeString(1,r),null!=(r=t.Message.getField(e,2))&&n.writeInt32(2,r),null!=(r=t.Message.getField(e,3))&&n.writeFloat(3,r),(r=e.getCategoryAllowlistList()).length>0&&n.writeRepeatedString(4,r),(r=e.getCategoryDenylistList()).length>0&&n.writeRepeatedString(5,r)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.getDisplayNamesLocale=function(){return t.Message.getFieldWithDefault(this,1,"en")},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.setDisplayNamesLocale=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.clearDisplayNamesLocale=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.hasDisplayNamesLocale=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.getMaxResults=function(){return t.Message.getFieldWithDefault(this,2,-1)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.setMaxResults=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.clearMaxResults=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.hasMaxResults=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.getScoreThreshold=function(){return t.Message.getFloatingPointFieldWithDefault(this,3,0)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.setScoreThreshold=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.clearScoreThreshold=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.hasScoreThreshold=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.getCategoryAllowlistList=function(){return t.Message.getRepeatedField(this,4)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.setCategoryAllowlistList=function(e){return t.Message.setField(this,4,e||[])},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.addCategoryAllowlist=function(e,n){return t.Message.addToRepeatedField(this,4,e,n)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.clearCategoryAllowlistList=function(){return this.setCategoryAllowlistList([])},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.getCategoryDenylistList=function(){return t.Message.getRepeatedField(this,5)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.setCategoryDenylistList=function(e){return t.Message.setField(this,5,e||[])},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.addCategoryDenylist=function(e,n){return t.Message.addToRepeatedField(this,5,e,n)},proto.mediapipe.tasks.components.processors.proto.ClassifierOptions.prototype.clearCategoryDenylistList=function(){return this.setCategoryDenylistList([])},n.object.extend(e,proto.mediapipe.tasks.components.processors.proto)}(classifier_options_pb),function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=classifier_options_pb;n.object.extend(proto,a);var s=base_options_pb;n.object.extend(proto,s),n.exportSymbol("proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions",null,r),proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.displayName="proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.toObject=function(e,t){var n,r={baseOptions:(n=t.getBaseOptions())&&s.BaseOptions.toObject(e,n),classifierOptions:(n=t.getClassifierOptions())&&a.ClassifierOptions.toObject(e,n)};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions;return proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new s.BaseOptions;t.readMessage(n,s.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=new a.ClassifierOptions,t.readMessage(n,a.ClassifierOptions.deserializeBinaryFromReader),e.setClassifierOptions(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.serializeBinaryToWriter=function(e,t){var n=void 0;null!=(n=e.getBaseOptions())&&t.writeMessage(1,n,s.BaseOptions.serializeBinaryToWriter),null!=(n=e.getClassifierOptions())&&t.writeMessage(2,n,a.ClassifierOptions.serializeBinaryToWriter)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.ext=new t.ExtensionFieldInfo(478825465,{ext:0},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[478825465]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[478825465]=proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.ext,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,s.BaseOptions,1)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.prototype.getClassifierOptions=function(){return t.Message.getWrapperField(this,a.ClassifierOptions,2)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.prototype.setClassifierOptions=function(e){return t.Message.setWrapperField(this,2,e)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.prototype.clearClassifierOptions=function(){return this.setClassifierOptions(void 0)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.prototype.hasClassifierOptions=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.ext=new t.ExtensionFieldInfo(478825465,{ext:0},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[478825465]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[478825465]=proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureClassifierGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.gesture_recognizer.proto)}(gesture_classifier_graph_options_pb);var gesture_recognizer_graph_options_pb={},hand_gesture_recognizer_graph_options_pb={},gesture_embedder_graph_options_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=base_options_pb;n.object.extend(proto,a),n.exportSymbol("proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions",null,r),proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.displayName="proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.toObject=function(e,t){var n,r={baseOptions:(n=t.getBaseOptions())&&a.BaseOptions.toObject(e,n)};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions;return proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=new a.BaseOptions;t.readMessage(n,a.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n)}else t.skipField();return e},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.serializeBinaryToWriter=function(e,t){var n;null!=(n=e.getBaseOptions())&&t.writeMessage(1,n,a.BaseOptions.serializeBinaryToWriter)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.ext=new t.ExtensionFieldInfo(478825422,{ext:0},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[478825422]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[478825422]=proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.ext,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,a.BaseOptions,1)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.ext=new t.ExtensionFieldInfo(478825422,{ext:0},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[478825422]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[478825422]=proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureEmbedderGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.gesture_recognizer.proto)}(gesture_embedder_graph_options_pb),function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=base_options_pb;n.object.extend(proto,a);var s=gesture_classifier_graph_options_pb;n.object.extend(proto,s);var u=gesture_embedder_graph_options_pb;n.object.extend(proto,u),n.exportSymbol("proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions",null,r),proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.displayName="proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.toObject=function(e,t){var n,r={baseOptions:(n=t.getBaseOptions())&&a.BaseOptions.toObject(e,n),gestureEmbedderGraphOptions:(n=t.getGestureEmbedderGraphOptions())&&u.GestureEmbedderGraphOptions.toObject(e,n),cannedGestureClassifierGraphOptions:(n=t.getCannedGestureClassifierGraphOptions())&&s.GestureClassifierGraphOptions.toObject(e,n),customGestureClassifierGraphOptions:(n=t.getCustomGestureClassifierGraphOptions())&&s.GestureClassifierGraphOptions.toObject(e,n)};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions;return proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new a.BaseOptions;t.readMessage(n,a.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=new u.GestureEmbedderGraphOptions,t.readMessage(n,u.GestureEmbedderGraphOptions.deserializeBinaryFromReader),e.setGestureEmbedderGraphOptions(n);break;case 3:n=new s.GestureClassifierGraphOptions,t.readMessage(n,s.GestureClassifierGraphOptions.deserializeBinaryFromReader),e.setCannedGestureClassifierGraphOptions(n);break;case 4:n=new s.GestureClassifierGraphOptions,t.readMessage(n,s.GestureClassifierGraphOptions.deserializeBinaryFromReader),e.setCustomGestureClassifierGraphOptions(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.serializeBinaryToWriter=function(e,t){var n=void 0;null!=(n=e.getBaseOptions())&&t.writeMessage(1,n,a.BaseOptions.serializeBinaryToWriter),null!=(n=e.getGestureEmbedderGraphOptions())&&t.writeMessage(2,n,u.GestureEmbedderGraphOptions.serializeBinaryToWriter),null!=(n=e.getCannedGestureClassifierGraphOptions())&&t.writeMessage(3,n,s.GestureClassifierGraphOptions.serializeBinaryToWriter),null!=(n=e.getCustomGestureClassifierGraphOptions())&&t.writeMessage(4,n,s.GestureClassifierGraphOptions.serializeBinaryToWriter)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.ext=new t.ExtensionFieldInfo(463370452,{ext:0},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions,proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[463370452]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[463370452]=proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.ext,proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,a.BaseOptions,1)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.getGestureEmbedderGraphOptions=function(){return t.Message.getWrapperField(this,u.GestureEmbedderGraphOptions,2)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.setGestureEmbedderGraphOptions=function(e){return t.Message.setWrapperField(this,2,e)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.clearGestureEmbedderGraphOptions=function(){return this.setGestureEmbedderGraphOptions(void 0)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.hasGestureEmbedderGraphOptions=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.getCannedGestureClassifierGraphOptions=function(){return t.Message.getWrapperField(this,s.GestureClassifierGraphOptions,3)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.setCannedGestureClassifierGraphOptions=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.clearCannedGestureClassifierGraphOptions=function(){return this.setCannedGestureClassifierGraphOptions(void 0)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.hasCannedGestureClassifierGraphOptions=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.getCustomGestureClassifierGraphOptions=function(){return t.Message.getWrapperField(this,s.GestureClassifierGraphOptions,4)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.setCustomGestureClassifierGraphOptions=function(e){return t.Message.setWrapperField(this,4,e)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.clearCustomGestureClassifierGraphOptions=function(){return this.setCustomGestureClassifierGraphOptions(void 0)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.prototype.hasCustomGestureClassifierGraphOptions=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.ext=new t.ExtensionFieldInfo(463370452,{ext:0},proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions,proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[463370452]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[463370452]=proto.mediapipe.tasks.vision.gesture_recognizer.proto.HandGestureRecognizerGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.gesture_recognizer.proto)}(hand_gesture_recognizer_graph_options_pb);var hand_landmarker_graph_options_pb={},hand_detector_graph_options_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=base_options_pb;n.object.extend(proto,a),n.exportSymbol("proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions",null,r),proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.displayName="proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.toObject=function(e,n){var r,i={baseOptions:(r=n.getBaseOptions())&&a.BaseOptions.toObject(e,r),minDetectionConfidence:t.Message.getFloatingPointFieldWithDefault(n,2,.5),numHands:null==(r=t.Message.getField(n,3))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions;return proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new a.BaseOptions;t.readMessage(n,a.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=t.readFloat(),e.setMinDetectionConfidence(n);break;case 3:n=t.readInt32(),e.setNumHands(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getBaseOptions())&&n.writeMessage(1,r,a.BaseOptions.serializeBinaryToWriter),null!=(r=t.Message.getField(e,2))&&n.writeFloat(2,r),null!=(r=t.Message.getField(e,3))&&n.writeInt32(3,r)},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.ext=new t.ExtensionFieldInfo(464864288,{ext:0},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions,proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[464864288]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[464864288]=proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.ext,proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,a.BaseOptions,1)},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.prototype.getMinDetectionConfidence=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,.5)},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.prototype.setMinDetectionConfidence=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.prototype.clearMinDetectionConfidence=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.prototype.hasMinDetectionConfidence=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.prototype.getNumHands=function(){return t.Message.getFieldWithDefault(this,3,0)},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.prototype.setNumHands=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.prototype.clearNumHands=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.prototype.hasNumHands=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.ext=new t.ExtensionFieldInfo(464864288,{ext:0},proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions,proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[464864288]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[464864288]=proto.mediapipe.tasks.vision.hand_detector.proto.HandDetectorGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.hand_detector.proto)}(hand_detector_graph_options_pb);var hand_landmarks_detector_graph_options_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=base_options_pb;n.object.extend(proto,a),n.exportSymbol("proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions",null,r),proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.displayName="proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.toObject=function(e,n){var r,i={baseOptions:(r=n.getBaseOptions())&&a.BaseOptions.toObject(e,r),minDetectionConfidence:t.Message.getFloatingPointFieldWithDefault(n,2,.5)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions;return proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new a.BaseOptions;t.readMessage(n,a.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=t.readFloat(),e.setMinDetectionConfidence(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getBaseOptions())&&n.writeMessage(1,r,a.BaseOptions.serializeBinaryToWriter),null!=(r=t.Message.getField(e,2))&&n.writeFloat(2,r)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.ext=new t.ExtensionFieldInfo(474472470,{ext:0},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions,proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[474472470]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[474472470]=proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.ext,proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,a.BaseOptions,1)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.prototype.getMinDetectionConfidence=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,.5)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.prototype.setMinDetectionConfidence=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.prototype.clearMinDetectionConfidence=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.prototype.hasMinDetectionConfidence=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.ext=new t.ExtensionFieldInfo(474472470,{ext:0},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions,proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[474472470]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[474472470]=proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarksDetectorGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.hand_landmarker.proto)}(hand_landmarks_detector_graph_options_pb),function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=base_options_pb;n.object.extend(proto,a);var s=hand_detector_graph_options_pb;n.object.extend(proto,s);var u=hand_landmarks_detector_graph_options_pb;n.object.extend(proto,u),n.exportSymbol("proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions",null,r),proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.displayName="proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.toObject=function(e,n){var r,i={baseOptions:(r=n.getBaseOptions())&&a.BaseOptions.toObject(e,r),handDetectorGraphOptions:(r=n.getHandDetectorGraphOptions())&&s.HandDetectorGraphOptions.toObject(e,r),handLandmarksDetectorGraphOptions:(r=n.getHandLandmarksDetectorGraphOptions())&&u.HandLandmarksDetectorGraphOptions.toObject(e,r),minTrackingConfidence:t.Message.getFloatingPointFieldWithDefault(n,4,.5)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions;return proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new a.BaseOptions;t.readMessage(n,a.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=new s.HandDetectorGraphOptions,t.readMessage(n,s.HandDetectorGraphOptions.deserializeBinaryFromReader),e.setHandDetectorGraphOptions(n);break;case 3:n=new u.HandLandmarksDetectorGraphOptions,t.readMessage(n,u.HandLandmarksDetectorGraphOptions.deserializeBinaryFromReader),e.setHandLandmarksDetectorGraphOptions(n);break;case 4:n=t.readFloat(),e.setMinTrackingConfidence(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getBaseOptions())&&n.writeMessage(1,r,a.BaseOptions.serializeBinaryToWriter),null!=(r=e.getHandDetectorGraphOptions())&&n.writeMessage(2,r,s.HandDetectorGraphOptions.serializeBinaryToWriter),null!=(r=e.getHandLandmarksDetectorGraphOptions())&&n.writeMessage(3,r,u.HandLandmarksDetectorGraphOptions.serializeBinaryToWriter),null!=(r=t.Message.getField(e,4))&&n.writeFloat(4,r)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.ext=new t.ExtensionFieldInfo(462713202,{ext:0},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions,proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[462713202]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[462713202]=proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.ext,proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,a.BaseOptions,1)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.getHandDetectorGraphOptions=function(){return t.Message.getWrapperField(this,s.HandDetectorGraphOptions,2)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.setHandDetectorGraphOptions=function(e){return t.Message.setWrapperField(this,2,e)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.clearHandDetectorGraphOptions=function(){return this.setHandDetectorGraphOptions(void 0)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.hasHandDetectorGraphOptions=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.getHandLandmarksDetectorGraphOptions=function(){return t.Message.getWrapperField(this,u.HandLandmarksDetectorGraphOptions,3)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.setHandLandmarksDetectorGraphOptions=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.clearHandLandmarksDetectorGraphOptions=function(){return this.setHandLandmarksDetectorGraphOptions(void 0)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.hasHandLandmarksDetectorGraphOptions=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.getMinTrackingConfidence=function(){return t.Message.getFloatingPointFieldWithDefault(this,4,.5)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.setMinTrackingConfidence=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.clearMinTrackingConfidence=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.prototype.hasMinTrackingConfidence=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.ext=new t.ExtensionFieldInfo(462713202,{ext:0},proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions,proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[462713202]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[462713202]=proto.mediapipe.tasks.vision.hand_landmarker.proto.HandLandmarkerGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.hand_landmarker.proto)}(hand_landmarker_graph_options_pb),function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=base_options_pb;n.object.extend(proto,a);var s=hand_gesture_recognizer_graph_options_pb;n.object.extend(proto,s);var u=hand_landmarker_graph_options_pb;n.object.extend(proto,u),n.exportSymbol("proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions",null,r),proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.displayName="proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.toObject=function(e,t){var n,r={baseOptions:(n=t.getBaseOptions())&&a.BaseOptions.toObject(e,n),handLandmarkerGraphOptions:(n=t.getHandLandmarkerGraphOptions())&&u.HandLandmarkerGraphOptions.toObject(e,n),handGestureRecognizerGraphOptions:(n=t.getHandGestureRecognizerGraphOptions())&&s.HandGestureRecognizerGraphOptions.toObject(e,n)};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions;return proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new a.BaseOptions;t.readMessage(n,a.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=new u.HandLandmarkerGraphOptions,t.readMessage(n,u.HandLandmarkerGraphOptions.deserializeBinaryFromReader),e.setHandLandmarkerGraphOptions(n);break;case 3:n=new s.HandGestureRecognizerGraphOptions,t.readMessage(n,s.HandGestureRecognizerGraphOptions.deserializeBinaryFromReader),e.setHandGestureRecognizerGraphOptions(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.serializeBinaryToWriter=function(e,t){var n=void 0;null!=(n=e.getBaseOptions())&&t.writeMessage(1,n,a.BaseOptions.serializeBinaryToWriter),null!=(n=e.getHandLandmarkerGraphOptions())&&t.writeMessage(2,n,u.HandLandmarkerGraphOptions.serializeBinaryToWriter),null!=(n=e.getHandGestureRecognizerGraphOptions())&&t.writeMessage(3,n,s.HandGestureRecognizerGraphOptions.serializeBinaryToWriter)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.ext=new t.ExtensionFieldInfo(479097054,{ext:0},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[479097054]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[479097054]=proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.ext,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,a.BaseOptions,1)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.prototype.getHandLandmarkerGraphOptions=function(){return t.Message.getWrapperField(this,u.HandLandmarkerGraphOptions,2)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.prototype.setHandLandmarkerGraphOptions=function(e){return t.Message.setWrapperField(this,2,e)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.prototype.clearHandLandmarkerGraphOptions=function(){return this.setHandLandmarkerGraphOptions(void 0)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.prototype.hasHandLandmarkerGraphOptions=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.prototype.getHandGestureRecognizerGraphOptions=function(){return t.Message.getWrapperField(this,s.HandGestureRecognizerGraphOptions,3)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.prototype.setHandGestureRecognizerGraphOptions=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.prototype.clearHandGestureRecognizerGraphOptions=function(){return this.setHandGestureRecognizerGraphOptions(void 0)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.prototype.hasHandGestureRecognizerGraphOptions=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.ext=new t.ExtensionFieldInfo(479097054,{ext:0},proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[479097054]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[479097054]=proto.mediapipe.tasks.vision.gesture_recognizer.proto.GestureRecognizerGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.gesture_recognizer.proto)}(gesture_recognizer_graph_options_pb);var classifier_options={};Object.defineProperty(classifier_options,"__esModule",{value:!0}),classifier_options.convertClassifierOptionsToProto=void 0;const classifier_options_pb_1=classifier_options_pb;function convertClassifierOptionsToProto(e,t){const n=t?t.clone():new classifier_options_pb_1.ClassifierOptions;return void 0!==e.displayNamesLocale?n.setDisplayNamesLocale(e.displayNamesLocale):void 0===e.displayNamesLocale&&n.clearDisplayNamesLocale(),void 0!==e.maxResults?n.setMaxResults(e.maxResults):"maxResults"in e&&n.clearMaxResults(),void 0!==e.scoreThreshold?n.setScoreThreshold(e.scoreThreshold):"scoreThreshold"in e&&n.clearScoreThreshold(),void 0!==e.categoryAllowlist?n.setCategoryAllowlistList(e.categoryAllowlist):"categoryAllowlist"in e&&n.clearCategoryAllowlistList(),void 0!==e.categoryDenylist?n.setCategoryDenylistList(e.categoryDenylist):"categoryDenylist"in e&&n.clearCategoryDenylistList(),n}classifier_options.convertClassifierOptionsToProto=convertClassifierOptionsToProto;var hand_landmarks_connections={};Object.defineProperty(hand_landmarks_connections,"__esModule",{value:!0}),hand_landmarks_connections.HAND_CONNECTIONS=void 0,hand_landmarks_connections.HAND_CONNECTIONS=[{start:0,end:1},{start:1,end:2},{start:2,end:3},{start:3,end:4},{start:0,end:5},{start:5,end:6},{start:6,end:7},{start:7,end:8},{start:5,end:9},{start:9,end:10},{start:10,end:11},{start:11,end:12},{start:9,end:13},{start:13,end:14},{start:14,end:15},{start:15,end:16},{start:13,end:17},{start:0,end:17},{start:17,end:18},{start:18,end:19},{start:19,end:20}];var gesture_recognizer_options={};Object.defineProperty(gesture_recognizer_options,"__esModule",{value:!0});var gesture_recognizer_result={};Object.defineProperty(gesture_recognizer_result,"__esModule",{value:!0}),function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.GestureRecognizer=void 0;const r=calculator_pb,i=calculator_options_pb,o=classification_pb,a=landmark_pb,s=base_options_pb,u=gesture_classifier_graph_options_pb,l=gesture_recognizer_graph_options_pb,c=hand_gesture_recognizer_graph_options_pb,p=hand_detector_graph_options_pb,d=hand_landmarker_graph_options_pb,h=hand_landmarks_detector_graph_options_pb,f=classifier_options,g=vision_task_runner,m=hand_landmarks_connections;n(gesture_recognizer_options,e),n(gesture_recognizer_result,e);const y="image_in",b="norm_rect",v="hand_gestures",x="hand_landmarks",_="world_hand_landmarks",w="handedness",k=.5;class S extends g.VisionTaskRunner{static createFromOptions(e,t){return g.VisionTaskRunner.createVisionInstance(S,e,t)}static createFromModelBuffer(e,t){return g.VisionTaskRunner.createVisionInstance(S,e,{baseOptions:{modelAssetBuffer:t}})}static createFromModelPath(e,t){return g.VisionTaskRunner.createVisionInstance(S,e,{baseOptions:{modelAssetPath:t}})}constructor(e,t){super(new g.VisionGraphRunner(e,t),y,b,!1),this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handednesses=[],this.options=new l.GestureRecognizerGraphOptions,this.options.setBaseOptions(new s.BaseOptions),this.handLandmarkerGraphOptions=new d.HandLandmarkerGraphOptions,this.options.setHandLandmarkerGraphOptions(this.handLandmarkerGraphOptions),this.handLandmarksDetectorGraphOptions=new h.HandLandmarksDetectorGraphOptions,this.handLandmarkerGraphOptions.setHandLandmarksDetectorGraphOptions(this.handLandmarksDetectorGraphOptions),this.handDetectorGraphOptions=new p.HandDetectorGraphOptions,this.handLandmarkerGraphOptions.setHandDetectorGraphOptions(this.handDetectorGraphOptions),this.handGestureRecognizerGraphOptions=new c.HandGestureRecognizerGraphOptions,this.options.setHandGestureRecognizerGraphOptions(this.handGestureRecognizerGraphOptions),this.handDetectorGraphOptions.setMinDetectionConfidence(k),this.handLandmarkerGraphOptions.setMinTrackingConfidence(k),this.handLandmarksDetectorGraphOptions.setMinDetectionConfidence(k)}get baseOptions(){return this.options.getBaseOptions()}set baseOptions(e){this.options.setBaseOptions(e)}setOptions(e){var t,n,r,i,o,a,s,l;if(this.handDetectorGraphOptions.setNumHands(null!==(t=e.numHands)&&void 0!==t?t:1),"minHandDetectionConfidence"in e&&this.handDetectorGraphOptions.setMinDetectionConfidence(null!==(n=e.minHandDetectionConfidence)&&void 0!==n?n:k),"minTrackingConfidence"in e&&this.handLandmarkerGraphOptions.setMinTrackingConfidence(null!==(r=e.minTrackingConfidence)&&void 0!==r?r:k),"minHandPresenceConfidence"in e&&this.handLandmarksDetectorGraphOptions.setMinDetectionConfidence(null!==(i=e.minHandPresenceConfidence)&&void 0!==i?i:k),e.cannedGesturesClassifierOptions){const t=new u.GestureClassifierGraphOptions;t.setClassifierOptions((0,f.convertClassifierOptionsToProto)(e.cannedGesturesClassifierOptions,null===(o=this.handGestureRecognizerGraphOptions.getCannedGestureClassifierGraphOptions())||void 0===o?void 0:o.getClassifierOptions())),this.handGestureRecognizerGraphOptions.setCannedGestureClassifierGraphOptions(t)}else void 0===e.cannedGesturesClassifierOptions&&(null===(a=this.handGestureRecognizerGraphOptions.getCannedGestureClassifierGraphOptions())||void 0===a||a.clearClassifierOptions());if(e.customGesturesClassifierOptions){const t=new u.GestureClassifierGraphOptions;t.setClassifierOptions((0,f.convertClassifierOptionsToProto)(e.customGesturesClassifierOptions,null===(s=this.handGestureRecognizerGraphOptions.getCustomGestureClassifierGraphOptions())||void 0===s?void 0:s.getClassifierOptions())),this.handGestureRecognizerGraphOptions.setCustomGestureClassifierGraphOptions(t)}else void 0===e.customGesturesClassifierOptions&&(null===(l=this.handGestureRecognizerGraphOptions.getCustomGestureClassifierGraphOptions())||void 0===l||l.clearClassifierOptions());return this.applyOptions(e)}recognize(e,t){return this.resetResults(),this.processImageData(e,t),this.processResults()}recognizeForVideo(e,t,n){return this.resetResults(),this.processVideoData(e,n,t),this.processResults()}resetResults(){this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handednesses=[]}processResults(){return 0===this.gestures.length?{gestures:[],landmarks:[],worldLandmarks:[],handednesses:[]}:{gestures:this.gestures,landmarks:this.landmarks,worldLandmarks:this.worldLandmarks,handednesses:this.handednesses}}toJsCategories(e,t=!0){var n,r,i;const a=[];for(const s of e){const e=o.ClassificationList.deserializeBinary(s),u=[];for(const o of e.getClassificationList()){const e=t&&o.hasIndex()?o.getIndex():-1;u.push({score:null!==(n=o.getScore())&&void 0!==n?n:0,index:e,categoryName:null!==(r=o.getLabel())&&void 0!==r?r:"",displayName:null!==(i=o.getDisplayName())&&void 0!==i?i:""})}a.push(u)}return a}addJsLandmarks(e){var t,n,r;for(const i of e){const e=a.NormalizedLandmarkList.deserializeBinary(i),o=[];for(const i of e.getLandmarkList())o.push({x:null!==(t=i.getX())&&void 0!==t?t:0,y:null!==(n=i.getY())&&void 0!==n?n:0,z:null!==(r=i.getZ())&&void 0!==r?r:0});this.landmarks.push(o)}}adddJsWorldLandmarks(e){var t,n,r;for(const i of e){const e=a.LandmarkList.deserializeBinary(i),o=[];for(const i of e.getLandmarkList())o.push({x:null!==(t=i.getX())&&void 0!==t?t:0,y:null!==(n=i.getY())&&void 0!==n?n:0,z:null!==(r=i.getZ())&&void 0!==r?r:0});this.worldLandmarks.push(o)}}refreshGraph(){const e=new r.CalculatorGraphConfig;e.addInputStream(y),e.addInputStream(b),e.addOutputStream(v),e.addOutputStream(x),e.addOutputStream(_),e.addOutputStream(w);const t=new i.CalculatorOptions;t.setExtension(l.GestureRecognizerGraphOptions.ext,this.options);const n=new r.CalculatorGraphConfig.Node;n.setCalculator("mediapipe.tasks.vision.gesture_recognizer.GestureRecognizerGraph"),n.addInputStream("IMAGE:"+y),n.addInputStream("NORM_RECT:"+b),n.addOutputStream("HAND_GESTURES:"+v),n.addOutputStream("LANDMARKS:"+x),n.addOutputStream("WORLD_LANDMARKS:"+_),n.addOutputStream("HANDEDNESS:"+w),n.setOptions(t),e.addNode(n),this.graphRunner.attachProtoVectorListener(x,((e,t)=>{this.addJsLandmarks(e),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(x,(e=>{this.setLatestOutputTimestamp(e)})),this.graphRunner.attachProtoVectorListener(_,((e,t)=>{this.adddJsWorldLandmarks(e),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(_,(e=>{this.setLatestOutputTimestamp(e)})),this.graphRunner.attachProtoVectorListener(v,((e,t)=>{this.gestures.push(...this.toJsCategories(e,!1)),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(v,(e=>{this.setLatestOutputTimestamp(e)})),this.graphRunner.attachProtoVectorListener(w,((e,t)=>{this.handednesses.push(...this.toJsCategories(e)),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(w,(e=>{this.setLatestOutputTimestamp(e)}));const o=e.serializeBinary();this.setGraph(new Uint8Array(o),!0)}}e.GestureRecognizer=S,S.HAND_CONNECTIONS=m.HAND_CONNECTIONS}(gesture_recognizer);var hand_landmarker={},hand_landmarker_options={};Object.defineProperty(hand_landmarker_options,"__esModule",{value:!0});var hand_landmarker_result={};Object.defineProperty(hand_landmarker_result,"__esModule",{value:!0}),function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.HandLandmarker=void 0;const r=calculator_pb,i=calculator_options_pb,o=classification_pb,a=landmark_pb,s=base_options_pb,u=hand_detector_graph_options_pb,l=hand_landmarker_graph_options_pb,c=hand_landmarks_detector_graph_options_pb,p=landmark_result,d=vision_task_runner,h=hand_landmarks_connections;n(hand_landmarker_options,e),n(hand_landmarker_result,e);const f="image_in",g="norm_rect",m="hand_landmarks",y="world_hand_landmarks",b="handedness",v=.5;class x extends d.VisionTaskRunner{static createFromOptions(e,t){return d.VisionTaskRunner.createVisionInstance(x,e,t)}static createFromModelBuffer(e,t){return d.VisionTaskRunner.createVisionInstance(x,e,{baseOptions:{modelAssetBuffer:t}})}static createFromModelPath(e,t){return d.VisionTaskRunner.createVisionInstance(x,e,{baseOptions:{modelAssetPath:t}})}constructor(e,t){super(new d.VisionGraphRunner(e,t),f,g,!1),this.landmarks=[],this.worldLandmarks=[],this.handednesses=[],this.options=new l.HandLandmarkerGraphOptions,this.options.setBaseOptions(new s.BaseOptions),this.handLandmarksDetectorGraphOptions=new c.HandLandmarksDetectorGraphOptions,this.options.setHandLandmarksDetectorGraphOptions(this.handLandmarksDetectorGraphOptions),this.handDetectorGraphOptions=new u.HandDetectorGraphOptions,this.options.setHandDetectorGraphOptions(this.handDetectorGraphOptions),this.initDefaults()}get baseOptions(){return this.options.getBaseOptions()}set baseOptions(e){this.options.setBaseOptions(e)}setOptions(e){var t,n,r,i;return"numHands"in e&&this.handDetectorGraphOptions.setNumHands(null!==(t=e.numHands)&&void 0!==t?t:1),"minHandDetectionConfidence"in e&&this.handDetectorGraphOptions.setMinDetectionConfidence(null!==(n=e.minHandDetectionConfidence)&&void 0!==n?n:v),"minTrackingConfidence"in e&&this.options.setMinTrackingConfidence(null!==(r=e.minTrackingConfidence)&&void 0!==r?r:v),"minHandPresenceConfidence"in e&&this.handLandmarksDetectorGraphOptions.setMinDetectionConfidence(null!==(i=e.minHandPresenceConfidence)&&void 0!==i?i:v),this.applyOptions(e)}detect(e,t){return this.resetResults(),this.processImageData(e,t),this.processResults()}detectForVideo(e,t,n){return this.resetResults(),this.processVideoData(e,n,t),this.processResults()}resetResults(){this.landmarks=[],this.worldLandmarks=[],this.handednesses=[]}processResults(){return{landmarks:this.landmarks,worldLandmarks:this.worldLandmarks,handednesses:this.handednesses}}initDefaults(){this.handDetectorGraphOptions.setNumHands(1),this.handDetectorGraphOptions.setMinDetectionConfidence(v),this.handLandmarksDetectorGraphOptions.setMinDetectionConfidence(v),this.options.setMinTrackingConfidence(v)}toJsCategories(e){var t,n,r,i;const a=[];for(const s of e){const e=o.ClassificationList.deserializeBinary(s),u=[];for(const o of e.getClassificationList())u.push({score:null!==(t=o.getScore())&&void 0!==t?t:0,index:null!==(n=o.getIndex())&&void 0!==n?n:-1,categoryName:null!==(r=o.getLabel())&&void 0!==r?r:"",displayName:null!==(i=o.getDisplayName())&&void 0!==i?i:""});a.push(u)}return a}addJsLandmarks(e){for(const t of e){const e=a.NormalizedLandmarkList.deserializeBinary(t);this.landmarks.push((0,p.convertToLandmarks)(e))}}adddJsWorldLandmarks(e){for(const t of e){const e=a.LandmarkList.deserializeBinary(t);this.worldLandmarks.push((0,p.convertToWorldLandmarks)(e))}}refreshGraph(){const e=new r.CalculatorGraphConfig;e.addInputStream(f),e.addInputStream(g),e.addOutputStream(m),e.addOutputStream(y),e.addOutputStream(b);const t=new i.CalculatorOptions;t.setExtension(l.HandLandmarkerGraphOptions.ext,this.options);const n=new r.CalculatorGraphConfig.Node;n.setCalculator("mediapipe.tasks.vision.hand_landmarker.HandLandmarkerGraph"),n.addInputStream("IMAGE:"+f),n.addInputStream("NORM_RECT:"+g),n.addOutputStream("LANDMARKS:"+m),n.addOutputStream("WORLD_LANDMARKS:"+y),n.addOutputStream("HANDEDNESS:"+b),n.setOptions(t),e.addNode(n),this.graphRunner.attachProtoVectorListener(m,((e,t)=>{this.addJsLandmarks(e),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(m,(e=>{this.setLatestOutputTimestamp(e)})),this.graphRunner.attachProtoVectorListener(y,((e,t)=>{this.adddJsWorldLandmarks(e),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(y,(e=>{this.setLatestOutputTimestamp(e)})),this.graphRunner.attachProtoVectorListener(b,((e,t)=>{this.handednesses.push(...this.toJsCategories(e)),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(b,(e=>{this.setLatestOutputTimestamp(e)}));const o=e.serializeBinary();this.setGraph(new Uint8Array(o),!0)}}e.HandLandmarker=x,x.HAND_CONNECTIONS=h.HAND_CONNECTIONS}(hand_landmarker);var image_classifier={},classifications_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=classification_pb;n.object.extend(proto,i),n.exportSymbol("proto.mediapipe.tasks.components.containers.proto.ClassificationResult",null,r),n.exportSymbol("proto.mediapipe.tasks.components.containers.proto.Classifications",null,r),proto.mediapipe.tasks.components.containers.proto.Classifications=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.components.containers.proto.Classifications,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.components.containers.proto.Classifications.displayName="proto.mediapipe.tasks.components.containers.proto.Classifications"),proto.mediapipe.tasks.components.containers.proto.ClassificationResult=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.tasks.components.containers.proto.ClassificationResult.repeatedFields_,null)},n.inherits(proto.mediapipe.tasks.components.containers.proto.ClassificationResult,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.components.containers.proto.ClassificationResult.displayName="proto.mediapipe.tasks.components.containers.proto.ClassificationResult"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.components.containers.proto.Classifications.prototype.toObject=function(e){return proto.mediapipe.tasks.components.containers.proto.Classifications.toObject(e,this)},proto.mediapipe.tasks.components.containers.proto.Classifications.toObject=function(e,n){var r,o={classificationList:(r=n.getClassificationList())&&i.ClassificationList.toObject(e,r),headIndex:null==(r=t.Message.getField(n,2))?void 0:r,headName:null==(r=t.Message.getField(n,3))?void 0:r};return e&&(o.$jspbMessageInstance=n),o}),proto.mediapipe.tasks.components.containers.proto.Classifications.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.components.containers.proto.Classifications;return proto.mediapipe.tasks.components.containers.proto.Classifications.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.components.containers.proto.Classifications.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 4:var n=new i.ClassificationList;t.readMessage(n,i.ClassificationList.deserializeBinaryFromReader),e.setClassificationList(n);break;case 2:n=t.readInt32(),e.setHeadIndex(n);break;case 3:n=t.readString(),e.setHeadName(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.components.containers.proto.Classifications.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.components.containers.proto.Classifications.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.components.containers.proto.Classifications.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getClassificationList())&&n.writeMessage(4,r,i.ClassificationList.serializeBinaryToWriter),null!=(r=t.Message.getField(e,2))&&n.writeInt32(2,r),null!=(r=t.Message.getField(e,3))&&n.writeString(3,r)},proto.mediapipe.tasks.components.containers.proto.Classifications.prototype.getClassificationList=function(){return t.Message.getWrapperField(this,i.ClassificationList,4)},proto.mediapipe.tasks.components.containers.proto.Classifications.prototype.setClassificationList=function(e){return t.Message.setWrapperField(this,4,e)},proto.mediapipe.tasks.components.containers.proto.Classifications.prototype.clearClassificationList=function(){return this.setClassificationList(void 0)},proto.mediapipe.tasks.components.containers.proto.Classifications.prototype.hasClassificationList=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.tasks.components.containers.proto.Classifications.prototype.getHeadIndex=function(){return t.Message.getFieldWithDefault(this,2,0)},proto.mediapipe.tasks.components.containers.proto.Classifications.prototype.setHeadIndex=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.components.containers.proto.Classifications.prototype.clearHeadIndex=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.components.containers.proto.Classifications.prototype.hasHeadIndex=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.components.containers.proto.Classifications.prototype.getHeadName=function(){return t.Message.getFieldWithDefault(this,3,"")},proto.mediapipe.tasks.components.containers.proto.Classifications.prototype.setHeadName=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.tasks.components.containers.proto.Classifications.prototype.clearHeadName=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.tasks.components.containers.proto.Classifications.prototype.hasHeadName=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.tasks.components.containers.proto.ClassificationResult.repeatedFields_=[1],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.components.containers.proto.ClassificationResult.prototype.toObject=function(e){return proto.mediapipe.tasks.components.containers.proto.ClassificationResult.toObject(e,this)},proto.mediapipe.tasks.components.containers.proto.ClassificationResult.toObject=function(e,n){var r,i={classificationsList:t.Message.toObjectList(n.getClassificationsList(),proto.mediapipe.tasks.components.containers.proto.Classifications.toObject,e),timestampMs:null==(r=t.Message.getField(n,2))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.components.containers.proto.ClassificationResult.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.components.containers.proto.ClassificationResult;return proto.mediapipe.tasks.components.containers.proto.ClassificationResult.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.components.containers.proto.ClassificationResult.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new proto.mediapipe.tasks.components.containers.proto.Classifications;t.readMessage(n,proto.mediapipe.tasks.components.containers.proto.Classifications.deserializeBinaryFromReader),e.addClassifications(n);break;case 2:n=t.readInt64(),e.setTimestampMs(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.components.containers.proto.ClassificationResult.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.components.containers.proto.ClassificationResult.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.components.containers.proto.ClassificationResult.serializeBinaryToWriter=function(e,n){var r=void 0;(r=e.getClassificationsList()).length>0&&n.writeRepeatedMessage(1,r,proto.mediapipe.tasks.components.containers.proto.Classifications.serializeBinaryToWriter),null!=(r=t.Message.getField(e,2))&&n.writeInt64(2,r)},proto.mediapipe.tasks.components.containers.proto.ClassificationResult.prototype.getClassificationsList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.tasks.components.containers.proto.Classifications,1)},proto.mediapipe.tasks.components.containers.proto.ClassificationResult.prototype.setClassificationsList=function(e){return t.Message.setRepeatedWrapperField(this,1,e)},proto.mediapipe.tasks.components.containers.proto.ClassificationResult.prototype.addClassifications=function(e,n){return t.Message.addToRepeatedWrapperField(this,1,e,proto.mediapipe.tasks.components.containers.proto.Classifications,n)},proto.mediapipe.tasks.components.containers.proto.ClassificationResult.prototype.clearClassificationsList=function(){return this.setClassificationsList([])},proto.mediapipe.tasks.components.containers.proto.ClassificationResult.prototype.getTimestampMs=function(){return t.Message.getFieldWithDefault(this,2,0)},proto.mediapipe.tasks.components.containers.proto.ClassificationResult.prototype.setTimestampMs=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.components.containers.proto.ClassificationResult.prototype.clearTimestampMs=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.components.containers.proto.ClassificationResult.prototype.hasTimestampMs=function(){return null!=t.Message.getField(this,2)},n.object.extend(e,proto.mediapipe.tasks.components.containers.proto)}(classifications_pb);var image_classifier_graph_options_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=classifier_options_pb;n.object.extend(proto,a);var s=base_options_pb;n.object.extend(proto,s),n.exportSymbol("proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions",null,r),proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.displayName="proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.toObject=function(e,t){var n,r={baseOptions:(n=t.getBaseOptions())&&s.BaseOptions.toObject(e,n),classifierOptions:(n=t.getClassifierOptions())&&a.ClassifierOptions.toObject(e,n)};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions;return proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new s.BaseOptions;t.readMessage(n,s.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=new a.ClassifierOptions,t.readMessage(n,a.ClassifierOptions.deserializeBinaryFromReader),e.setClassifierOptions(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.serializeBinaryToWriter=function(e,t){var n=void 0;null!=(n=e.getBaseOptions())&&t.writeMessage(1,n,s.BaseOptions.serializeBinaryToWriter),null!=(n=e.getClassifierOptions())&&t.writeMessage(2,n,a.ClassifierOptions.serializeBinaryToWriter)},proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.ext=new t.ExtensionFieldInfo(456383383,{ext:0},proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions,proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[456383383]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[456383383]=proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.ext,proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,s.BaseOptions,1)},proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.prototype.getClassifierOptions=function(){return t.Message.getWrapperField(this,a.ClassifierOptions,2)},proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.prototype.setClassifierOptions=function(e){return t.Message.setWrapperField(this,2,e)},proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.prototype.clearClassifierOptions=function(){return this.setClassifierOptions(void 0)},proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.prototype.hasClassifierOptions=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.ext=new t.ExtensionFieldInfo(456383383,{ext:0},proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions,proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[456383383]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[456383383]=proto.mediapipe.tasks.vision.image_classifier.proto.ImageClassifierGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.image_classifier.proto)}(image_classifier_graph_options_pb);var image_classifier_options={};Object.defineProperty(image_classifier_options,"__esModule",{value:!0});var image_classifier_result={};Object.defineProperty(image_classifier_result,"__esModule",{value:!0}),function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.ImageClassifier=void 0;const r=calculator_pb,i=calculator_options_pb,o=classifications_pb,a=base_options_pb,s=image_classifier_graph_options_pb,u=classifier_options,l=classifier_result,c=vision_task_runner,p="input_image",d="norm_rect",h="classifications";n(image_classifier_options,e),n(image_classifier_result,e);class f extends c.VisionTaskRunner{static createFromOptions(e,t){return c.VisionTaskRunner.createVisionInstance(f,e,t)}static createFromModelBuffer(e,t){return c.VisionTaskRunner.createVisionInstance(f,e,{baseOptions:{modelAssetBuffer:t}})}static createFromModelPath(e,t){return c.VisionTaskRunner.createVisionInstance(f,e,{baseOptions:{modelAssetPath:t}})}constructor(e,t){super(new c.VisionGraphRunner(e,t),p,d,!0),this.classificationResult={classifications:[]},this.options=new s.ImageClassifierGraphOptions,this.options.setBaseOptions(new a.BaseOptions)}get baseOptions(){return this.options.getBaseOptions()}set baseOptions(e){this.options.setBaseOptions(e)}setOptions(e){return this.options.setClassifierOptions((0,u.convertClassifierOptionsToProto)(e,this.options.getClassifierOptions())),this.applyOptions(e)}classify(e,t){return this.classificationResult={classifications:[]},this.processImageData(e,t),this.classificationResult}classifyForVideo(e,t,n){return this.classificationResult={classifications:[]},this.processVideoData(e,n,t),this.classificationResult}refreshGraph(){const e=new r.CalculatorGraphConfig;e.addInputStream(p),e.addInputStream(d),e.addOutputStream(h);const t=new i.CalculatorOptions;t.setExtension(s.ImageClassifierGraphOptions.ext,this.options);const n=new r.CalculatorGraphConfig.Node;n.setCalculator("mediapipe.tasks.vision.image_classifier.ImageClassifierGraph"),n.addInputStream("IMAGE:"+p),n.addInputStream("NORM_RECT:"+d),n.addOutputStream("CLASSIFICATIONS:"+h),n.setOptions(t),e.addNode(n),this.graphRunner.attachProtoListener(h,((e,t)=>{this.classificationResult=(0,l.convertFromClassificationResultProto)(o.ClassificationResult.deserializeBinary(e)),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(h,(e=>{this.setLatestOutputTimestamp(e)}));const a=e.serializeBinary();this.setGraph(new Uint8Array(a),!0)}}e.ImageClassifier=f}(image_classifier);var image_embedder={},embeddings_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.tasks.components.containers.proto.Embedding",null,r),n.exportSymbol("proto.mediapipe.tasks.components.containers.proto.Embedding.EmbeddingCase",null,r),n.exportSymbol("proto.mediapipe.tasks.components.containers.proto.EmbeddingResult",null,r),n.exportSymbol("proto.mediapipe.tasks.components.containers.proto.FloatEmbedding",null,r),n.exportSymbol("proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding",null,r),proto.mediapipe.tasks.components.containers.proto.FloatEmbedding=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.repeatedFields_,null)},n.inherits(proto.mediapipe.tasks.components.containers.proto.FloatEmbedding,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.displayName="proto.mediapipe.tasks.components.containers.proto.FloatEmbedding"),proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.displayName="proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding"),proto.mediapipe.tasks.components.containers.proto.Embedding=function(e){t.Message.initialize(this,e,0,-1,null,proto.mediapipe.tasks.components.containers.proto.Embedding.oneofGroups_)},n.inherits(proto.mediapipe.tasks.components.containers.proto.Embedding,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.components.containers.proto.Embedding.displayName="proto.mediapipe.tasks.components.containers.proto.Embedding"),proto.mediapipe.tasks.components.containers.proto.EmbeddingResult=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.repeatedFields_,null)},n.inherits(proto.mediapipe.tasks.components.containers.proto.EmbeddingResult,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.displayName="proto.mediapipe.tasks.components.containers.proto.EmbeddingResult"),proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.repeatedFields_=[1],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.prototype.toObject=function(e){return proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.toObject(e,this)},proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.toObject=function(e,n){var r,i={valuesList:null==(r=t.Message.getRepeatedFloatingPointField(n,1))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.components.containers.proto.FloatEmbedding;return proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber())for(var n=t.isDelimited()?t.readPackedFloat():[t.readFloat()],r=0;r<n.length;r++)e.addValues(n[r]);else t.skipField();return e},proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.serializeBinaryToWriter=function(e,t){var n;(n=e.getValuesList()).length>0&&t.writePackedFloat(1,n)},proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.prototype.getValuesList=function(){return t.Message.getRepeatedFloatingPointField(this,1)},proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.prototype.setValuesList=function(e){return t.Message.setField(this,1,e||[])},proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.prototype.addValues=function(e,n){return t.Message.addToRepeatedField(this,1,e,n)},proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.prototype.clearValuesList=function(){return this.setValuesList([])},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.prototype.toObject=function(e){return proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.toObject(e,this)},proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.toObject=function(e,t){var n={values:t.getValues_asB64()};return e&&(n.$jspbMessageInstance=t),n}),proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding;return proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=t.readBytes();e.setValues(n)}else t.skipField();return e},proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.serializeBinaryToWriter=function(e,n){var r;null!=(r=t.Message.getField(e,1))&&n.writeBytes(1,r)},proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.prototype.getValues=function(){return t.Message.getFieldWithDefault(this,1,"")},proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.prototype.getValues_asB64=function(){return t.Message.bytesAsB64(this.getValues())},proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.prototype.getValues_asU8=function(){return t.Message.bytesAsU8(this.getValues())},proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.prototype.setValues=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.prototype.clearValues=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.prototype.hasValues=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.components.containers.proto.Embedding.oneofGroups_=[[1,2]],proto.mediapipe.tasks.components.containers.proto.Embedding.EmbeddingCase={EMBEDDING_NOT_SET:0,FLOAT_EMBEDDING:1,QUANTIZED_EMBEDDING:2},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.getEmbeddingCase=function(){return t.Message.computeOneofCase(this,proto.mediapipe.tasks.components.containers.proto.Embedding.oneofGroups_[0])},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.toObject=function(e){return proto.mediapipe.tasks.components.containers.proto.Embedding.toObject(e,this)},proto.mediapipe.tasks.components.containers.proto.Embedding.toObject=function(e,n){var r,i={floatEmbedding:(r=n.getFloatEmbedding())&&proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.toObject(e,r),quantizedEmbedding:(r=n.getQuantizedEmbedding())&&proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.toObject(e,r),headIndex:null==(r=t.Message.getField(n,3))?void 0:r,headName:null==(r=t.Message.getField(n,4))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.components.containers.proto.Embedding.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.components.containers.proto.Embedding;return proto.mediapipe.tasks.components.containers.proto.Embedding.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.components.containers.proto.Embedding.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new proto.mediapipe.tasks.components.containers.proto.FloatEmbedding;t.readMessage(n,proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.deserializeBinaryFromReader),e.setFloatEmbedding(n);break;case 2:n=new proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding,t.readMessage(n,proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.deserializeBinaryFromReader),e.setQuantizedEmbedding(n);break;case 3:n=t.readInt32(),e.setHeadIndex(n);break;case 4:n=t.readString(),e.setHeadName(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.components.containers.proto.Embedding.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.components.containers.proto.Embedding.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getFloatEmbedding())&&n.writeMessage(1,r,proto.mediapipe.tasks.components.containers.proto.FloatEmbedding.serializeBinaryToWriter),null!=(r=e.getQuantizedEmbedding())&&n.writeMessage(2,r,proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding.serializeBinaryToWriter),null!=(r=t.Message.getField(e,3))&&n.writeInt32(3,r),null!=(r=t.Message.getField(e,4))&&n.writeString(4,r)},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.getFloatEmbedding=function(){return t.Message.getWrapperField(this,proto.mediapipe.tasks.components.containers.proto.FloatEmbedding,1)},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.setFloatEmbedding=function(e){return t.Message.setOneofWrapperField(this,1,proto.mediapipe.tasks.components.containers.proto.Embedding.oneofGroups_[0],e)},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.clearFloatEmbedding=function(){return this.setFloatEmbedding(void 0)},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.hasFloatEmbedding=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.getQuantizedEmbedding=function(){return t.Message.getWrapperField(this,proto.mediapipe.tasks.components.containers.proto.QuantizedEmbedding,2)},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.setQuantizedEmbedding=function(e){return t.Message.setOneofWrapperField(this,2,proto.mediapipe.tasks.components.containers.proto.Embedding.oneofGroups_[0],e)},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.clearQuantizedEmbedding=function(){return this.setQuantizedEmbedding(void 0)},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.hasQuantizedEmbedding=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.getHeadIndex=function(){return t.Message.getFieldWithDefault(this,3,0)},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.setHeadIndex=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.clearHeadIndex=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.hasHeadIndex=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.getHeadName=function(){return t.Message.getFieldWithDefault(this,4,"")},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.setHeadName=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.clearHeadName=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.tasks.components.containers.proto.Embedding.prototype.hasHeadName=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.repeatedFields_=[1],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.prototype.toObject=function(e){return proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.toObject(e,this)},proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.toObject=function(e,n){var r,i={embeddingsList:t.Message.toObjectList(n.getEmbeddingsList(),proto.mediapipe.tasks.components.containers.proto.Embedding.toObject,e),timestampMs:null==(r=t.Message.getField(n,2))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.components.containers.proto.EmbeddingResult;return proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new proto.mediapipe.tasks.components.containers.proto.Embedding;t.readMessage(n,proto.mediapipe.tasks.components.containers.proto.Embedding.deserializeBinaryFromReader),e.addEmbeddings(n);break;case 2:n=t.readInt64(),e.setTimestampMs(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.serializeBinaryToWriter=function(e,n){var r=void 0;(r=e.getEmbeddingsList()).length>0&&n.writeRepeatedMessage(1,r,proto.mediapipe.tasks.components.containers.proto.Embedding.serializeBinaryToWriter),null!=(r=t.Message.getField(e,2))&&n.writeInt64(2,r)},proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.prototype.getEmbeddingsList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.tasks.components.containers.proto.Embedding,1)},proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.prototype.setEmbeddingsList=function(e){return t.Message.setRepeatedWrapperField(this,1,e)},proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.prototype.addEmbeddings=function(e,n){return t.Message.addToRepeatedWrapperField(this,1,e,proto.mediapipe.tasks.components.containers.proto.Embedding,n)},proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.prototype.clearEmbeddingsList=function(){return this.setEmbeddingsList([])},proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.prototype.getTimestampMs=function(){return t.Message.getFieldWithDefault(this,2,0)},proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.prototype.setTimestampMs=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.prototype.clearTimestampMs=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.components.containers.proto.EmbeddingResult.prototype.hasTimestampMs=function(){return null!=t.Message.getField(this,2)},n.object.extend(e,proto.mediapipe.tasks.components.containers.proto)}(embeddings_pb);var image_embedder_graph_options_pb={},embedder_options_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.tasks.components.processors.proto.EmbedderOptions",null,r),proto.mediapipe.tasks.components.processors.proto.EmbedderOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.components.processors.proto.EmbedderOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.displayName="proto.mediapipe.tasks.components.processors.proto.EmbedderOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.toObject(e,this)},proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.toObject=function(e,n){var r,i={l2Normalize:null==(r=t.Message.getBooleanField(n,1))?void 0:r,quantize:null==(r=t.Message.getBooleanField(n,2))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.components.processors.proto.EmbedderOptions;return proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readBool();e.setL2Normalize(n);break;case 2:n=t.readBool(),e.setQuantize(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeBool(1,r),null!=(r=t.Message.getField(e,2))&&n.writeBool(2,r)},proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.prototype.getL2Normalize=function(){return t.Message.getBooleanFieldWithDefault(this,1,!1)},proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.prototype.setL2Normalize=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.prototype.clearL2Normalize=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.prototype.hasL2Normalize=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.prototype.getQuantize=function(){return t.Message.getBooleanFieldWithDefault(this,2,!1)},proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.prototype.setQuantize=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.prototype.clearQuantize=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.components.processors.proto.EmbedderOptions.prototype.hasQuantize=function(){return null!=t.Message.getField(this,2)},n.object.extend(e,proto.mediapipe.tasks.components.processors.proto)}(embedder_options_pb),function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=embedder_options_pb;n.object.extend(proto,a);var s=base_options_pb;n.object.extend(proto,s),n.exportSymbol("proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions",null,r),proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.displayName="proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.toObject=function(e,t){var n,r={baseOptions:(n=t.getBaseOptions())&&s.BaseOptions.toObject(e,n),embedderOptions:(n=t.getEmbedderOptions())&&a.EmbedderOptions.toObject(e,n)};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions;return proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new s.BaseOptions;t.readMessage(n,s.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=new a.EmbedderOptions,t.readMessage(n,a.EmbedderOptions.deserializeBinaryFromReader),e.setEmbedderOptions(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.serializeBinaryToWriter=function(e,t){var n=void 0;null!=(n=e.getBaseOptions())&&t.writeMessage(1,n,s.BaseOptions.serializeBinaryToWriter),null!=(n=e.getEmbedderOptions())&&t.writeMessage(2,n,a.EmbedderOptions.serializeBinaryToWriter)},proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.ext=new t.ExtensionFieldInfo(476348187,{ext:0},proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions,proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[476348187]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[476348187]=proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.ext,proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,s.BaseOptions,1)},proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.prototype.getEmbedderOptions=function(){return t.Message.getWrapperField(this,a.EmbedderOptions,2)},proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.prototype.setEmbedderOptions=function(e){return t.Message.setWrapperField(this,2,e)},proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.prototype.clearEmbedderOptions=function(){return this.setEmbedderOptions(void 0)},proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.prototype.hasEmbedderOptions=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.ext=new t.ExtensionFieldInfo(476348187,{ext:0},proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions,proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[476348187]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[476348187]=proto.mediapipe.tasks.vision.image_embedder.proto.ImageEmbedderGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.image_embedder.proto)}(image_embedder_graph_options_pb);var embedder_options={};Object.defineProperty(embedder_options,"__esModule",{value:!0}),embedder_options.convertEmbedderOptionsToProto=void 0;const embedder_options_pb_1=embedder_options_pb;function convertEmbedderOptionsToProto(e,t){const n=t?t.clone():new embedder_options_pb_1.EmbedderOptions;return void 0!==e.l2Normalize?n.setL2Normalize(e.l2Normalize):"l2Normalize"in e&&n.clearL2Normalize(),void 0!==e.quantize?n.setQuantize(e.quantize):"quantize"in e&&n.clearQuantize(),n}embedder_options.convertEmbedderOptionsToProto=convertEmbedderOptionsToProto;var embedder_result={};Object.defineProperty(embedder_result,"__esModule",{value:!0}),embedder_result.convertFromEmbeddingResultProto=void 0;const DEFAULT_INDEX=-1;function convertFromEmbeddingsProto(e){var t,n,r,i;const o={headIndex:null!==(t=e.getHeadIndex())&&void 0!==t?t:DEFAULT_INDEX,headName:null!==(n=e.getHeadName())&&void 0!==n?n:""};if(e.hasFloatEmbedding())o.floatEmbedding=e.getFloatEmbedding().getValuesList();else{const t=null!==(i=null===(r=e.getQuantizedEmbedding())||void 0===r?void 0:r.getValues())&&void 0!==i?i:"";o.quantizedEmbedding="string"==typeof t?Uint8Array.from(atob(t),(e=>e.charCodeAt(0))):t}return o}function convertFromEmbeddingResultProto(e){return{embeddings:e.getEmbeddingsList().map((e=>convertFromEmbeddingsProto(e))),timestampMs:e.getTimestampMs()}}embedder_result.convertFromEmbeddingResultProto=convertFromEmbeddingResultProto;var cosine_similarity={};function computeCosineSimilarity(e,t){if(e.floatEmbedding&&t.floatEmbedding)return compute(e.floatEmbedding,t.floatEmbedding);if(e.quantizedEmbedding&&t.quantizedEmbedding)return compute(convertToBytes(e.quantizedEmbedding),convertToBytes(t.quantizedEmbedding));throw new Error("Cannot compute cosine similarity between quantized and float embeddings.")}function convertToBytes(e){return Array.from(e,(e=>e>127?e-256:e))}function compute(e,t){if(e.length!==t.length)throw new Error(`Cannot compute cosine similarity between embeddings of different sizes (${e.length} vs. ${t.length}).`);let n=0,r=0,i=0;for(let o=0;o<e.length;o++)n+=e[o]*t[o],r+=e[o]*e[o],i+=t[o]*t[o];if(r<=0||i<=0)throw new Error("Cannot compute cosine similarity on embedding with 0 norm.");return n/Math.sqrt(r*i)}Object.defineProperty(cosine_similarity,"__esModule",{value:!0}),cosine_similarity.computeCosineSimilarity=void 0,cosine_similarity.computeCosineSimilarity=computeCosineSimilarity;var image_embedder_options={};Object.defineProperty(image_embedder_options,"__esModule",{value:!0});var image_embedder_result={};Object.defineProperty(image_embedder_result,"__esModule",{value:!0}),function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.ImageEmbedder=void 0;const r=calculator_pb,i=calculator_options_pb,o=embeddings_pb,a=base_options_pb,s=image_embedder_graph_options_pb,u=embedder_options,l=embedder_result,c=cosine_similarity,p=vision_task_runner,d="image_in",h="norm_rect",f="embeddings_out";n(image_embedder_options,e),n(image_embedder_result,e);class g extends p.VisionTaskRunner{static createFromOptions(e,t){return p.VisionTaskRunner.createVisionInstance(g,e,t)}static createFromModelBuffer(e,t){return p.VisionTaskRunner.createVisionInstance(g,e,{baseOptions:{modelAssetBuffer:t}})}static createFromModelPath(e,t){return p.VisionTaskRunner.createVisionInstance(g,e,{baseOptions:{modelAssetPath:t}})}constructor(e,t){super(new p.VisionGraphRunner(e,t),d,h,!0),this.options=new s.ImageEmbedderGraphOptions,this.embeddings={embeddings:[]},this.options.setBaseOptions(new a.BaseOptions)}get baseOptions(){return this.options.getBaseOptions()}set baseOptions(e){this.options.setBaseOptions(e)}setOptions(e){return this.options.setEmbedderOptions((0,u.convertEmbedderOptionsToProto)(e,this.options.getEmbedderOptions())),this.applyOptions(e)}embed(e,t){return this.processImageData(e,t),this.embeddings}embedForVideo(e,t,n){return this.processVideoData(e,n,t),this.embeddings}static cosineSimilarity(e,t){return(0,c.computeCosineSimilarity)(e,t)}addJsImageEmdedding(e){const t=o.EmbeddingResult.deserializeBinary(e);this.embeddings=(0,l.convertFromEmbeddingResultProto)(t)}refreshGraph(){const e=new r.CalculatorGraphConfig;e.addInputStream(d),e.addInputStream(h),e.addOutputStream(f);const t=new i.CalculatorOptions;t.setExtension(s.ImageEmbedderGraphOptions.ext,this.options);const n=new r.CalculatorGraphConfig.Node;n.setCalculator("mediapipe.tasks.vision.image_embedder.ImageEmbedderGraph"),n.addInputStream("IMAGE:"+d),n.addInputStream("NORM_RECT:"+h),n.addOutputStream("EMBEDDINGS:"+f),n.setOptions(t),e.addNode(n),this.graphRunner.attachProtoListener(f,((e,t)=>{this.addJsImageEmdedding(e),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(f,(e=>{this.setLatestOutputTimestamp(e)}));const o=e.serializeBinary();this.setGraph(new Uint8Array(o),!0)}}e.ImageEmbedder=g}(image_embedder);var image_segmenter={},tensors_to_segmentation_calculator_pb={},segmenter_options_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions",null,r),n.exportSymbol("proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.Activation",null,r),n.exportSymbol("proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.OutputType",null,r),proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.displayName="proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.toObject(e,this)},proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.toObject=function(e,n){var r,i={outputType:null==(r=t.Message.getField(n,1))?void 0:r,activation:t.Message.getFieldWithDefault(n,2,0)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions;return proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readEnum();e.setOutputType(n);break;case 2:n=t.readEnum(),e.setActivation(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeEnum(1,r),null!=(r=t.Message.getField(e,2))&&n.writeEnum(2,r)},proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.OutputType={UNSPECIFIED:0,CATEGORY_MASK:1,CONFIDENCE_MASK:2},proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.Activation={NONE:0,SIGMOID:1,SOFTMAX:2},proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.prototype.getOutputType=function(){return t.Message.getFieldWithDefault(this,1,0)},proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.prototype.setOutputType=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.prototype.clearOutputType=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.prototype.hasOutputType=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.prototype.getActivation=function(){return t.Message.getFieldWithDefault(this,2,0)},proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.prototype.setActivation=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.prototype.clearActivation=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.vision.image_segmenter.proto.SegmenterOptions.prototype.hasActivation=function(){return null!=t.Message.getField(this,2)},n.object.extend(e,proto.mediapipe.tasks.vision.image_segmenter.proto)}(segmenter_options_pb);var label_map_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.LabelMapItem",null,r),proto.mediapipe.LabelMapItem=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.LabelMapItem.repeatedFields_,null)},n.inherits(proto.mediapipe.LabelMapItem,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.LabelMapItem.displayName="proto.mediapipe.LabelMapItem"),proto.mediapipe.LabelMapItem.repeatedFields_=[3],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.LabelMapItem.prototype.toObject=function(e){return proto.mediapipe.LabelMapItem.toObject(e,this)},proto.mediapipe.LabelMapItem.toObject=function(e,n){var r,i={name:null==(r=t.Message.getField(n,1))?void 0:r,displayName:null==(r=t.Message.getField(n,2))?void 0:r,childNameList:null==(r=t.Message.getRepeatedField(n,3))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.LabelMapItem.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.LabelMapItem;return proto.mediapipe.LabelMapItem.deserializeBinaryFromReader(r,n)},proto.mediapipe.LabelMapItem.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.setName(n);break;case 2:n=t.readString(),e.setDisplayName(n);break;case 3:n=t.readString(),e.addChildName(n);break;default:t.skipField()}return e},proto.mediapipe.LabelMapItem.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.LabelMapItem.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.LabelMapItem.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeString(1,r),null!=(r=t.Message.getField(e,2))&&n.writeString(2,r),(r=e.getChildNameList()).length>0&&n.writeRepeatedString(3,r)},proto.mediapipe.LabelMapItem.prototype.getName=function(){return t.Message.getFieldWithDefault(this,1,"")},proto.mediapipe.LabelMapItem.prototype.setName=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.LabelMapItem.prototype.clearName=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.LabelMapItem.prototype.hasName=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.LabelMapItem.prototype.getDisplayName=function(){return t.Message.getFieldWithDefault(this,2,"")},proto.mediapipe.LabelMapItem.prototype.setDisplayName=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.LabelMapItem.prototype.clearDisplayName=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.LabelMapItem.prototype.hasDisplayName=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.LabelMapItem.prototype.getChildNameList=function(){return t.Message.getRepeatedField(this,3)},proto.mediapipe.LabelMapItem.prototype.setChildNameList=function(e){return t.Message.setField(this,3,e||[])},proto.mediapipe.LabelMapItem.prototype.addChildName=function(e,n){return t.Message.addToRepeatedField(this,3,e,n)},proto.mediapipe.LabelMapItem.prototype.clearChildNameList=function(){return this.setChildNameList([])},n.object.extend(e,proto.mediapipe)}(label_map_pb),function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_options_pb;n.object.extend(proto,i);var o=segmenter_options_pb;n.object.extend(proto,o);var a=label_map_pb;n.object.extend(proto,a),n.exportSymbol("proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions",null,r),proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.displayName="proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.toObject(e,this)},proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.toObject=function(e,t){var n,r={segmenterOptions:(n=t.getSegmenterOptions())&&o.SegmenterOptions.toObject(e,n),labelItemsMap:(n=t.getLabelItemsMap())?n.toObject(e,proto.mediapipe.LabelMapItem.toObject):[]};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions;return proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.deserializeBinaryFromReader=function(e,n){for(;n.nextField()&&!n.isEndGroup();)switch(n.getFieldNumber()){case 1:var r=new o.SegmenterOptions;n.readMessage(r,o.SegmenterOptions.deserializeBinaryFromReader),e.setSegmenterOptions(r);break;case 2:r=e.getLabelItemsMap(),n.readMessage(r,(function(e,n){t.Map.deserializeBinary(e,n,t.BinaryReader.prototype.readInt64,t.BinaryReader.prototype.readMessage,proto.mediapipe.LabelMapItem.deserializeBinaryFromReader,0,new proto.mediapipe.LabelMapItem)}));break;default:n.skipField()}return e},proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getSegmenterOptions())&&n.writeMessage(1,r,o.SegmenterOptions.serializeBinaryToWriter),(r=e.getLabelItemsMap(!0))&&r.getLength()>0&&r.serializeBinary(2,n,t.BinaryWriter.prototype.writeInt64,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.LabelMapItem.serializeBinaryToWriter)},proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.ext=new t.ExtensionFieldInfo(458105876,{ext:0},proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions,proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.toObject,0),i.CalculatorOptions.extensionsBinary[458105876]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.serializeBinaryToWriter,proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.deserializeBinaryFromReader,!1),i.CalculatorOptions.extensions[458105876]=proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.ext,proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.prototype.getSegmenterOptions=function(){return t.Message.getWrapperField(this,o.SegmenterOptions,1)},proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.prototype.setSegmenterOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.prototype.clearSegmenterOptions=function(){return this.setSegmenterOptions(void 0)},proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.prototype.hasSegmenterOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.prototype.getLabelItemsMap=function(e){return t.Message.getMapField(this,2,e,proto.mediapipe.LabelMapItem)},proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.prototype.clearLabelItemsMap=function(){return this.getLabelItemsMap().clear(),this},proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.ext=new t.ExtensionFieldInfo(458105876,{ext:0},proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions,proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.toObject,0),i.CalculatorOptions.extensionsBinary[458105876]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.serializeBinaryToWriter,proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.deserializeBinaryFromReader,!1),i.CalculatorOptions.extensions[458105876]=proto.mediapipe.tasks.TensorsToSegmentationCalculatorOptions.ext,n.object.extend(e,proto.mediapipe.tasks)}(tensors_to_segmentation_calculator_pb);var image_segmenter_graph_options_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=base_options_pb;n.object.extend(proto,a);var s=segmenter_options_pb;n.object.extend(proto,s),n.exportSymbol("proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions",null,r),proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.displayName="proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.toObject=function(e,n){var r,i={baseOptions:(r=n.getBaseOptions())&&a.BaseOptions.toObject(e,r),displayNamesLocale:t.Message.getFieldWithDefault(n,2,"en"),segmenterOptions:(r=n.getSegmenterOptions())&&s.SegmenterOptions.toObject(e,r)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions;return proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new a.BaseOptions;t.readMessage(n,a.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=t.readString(),e.setDisplayNamesLocale(n);break;case 3:n=new s.SegmenterOptions,t.readMessage(n,s.SegmenterOptions.deserializeBinaryFromReader),e.setSegmenterOptions(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getBaseOptions())&&n.writeMessage(1,r,a.BaseOptions.serializeBinaryToWriter),null!=(r=t.Message.getField(e,2))&&n.writeString(2,r),null!=(r=e.getSegmenterOptions())&&n.writeMessage(3,r,s.SegmenterOptions.serializeBinaryToWriter)},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.ext=new t.ExtensionFieldInfo(458105758,{ext:0},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions,proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[458105758]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[458105758]=proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.ext,proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,a.BaseOptions,1)},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.prototype.getDisplayNamesLocale=function(){return t.Message.getFieldWithDefault(this,2,"en")},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.prototype.setDisplayNamesLocale=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.prototype.clearDisplayNamesLocale=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.prototype.hasDisplayNamesLocale=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.prototype.getSegmenterOptions=function(){return t.Message.getWrapperField(this,s.SegmenterOptions,3)},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.prototype.setSegmenterOptions=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.prototype.clearSegmenterOptions=function(){return this.setSegmenterOptions(void 0)},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.prototype.hasSegmenterOptions=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.ext=new t.ExtensionFieldInfo(458105758,{ext:0},proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions,proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[458105758]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[458105758]=proto.mediapipe.tasks.vision.image_segmenter.proto.ImageSegmenterGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.image_segmenter.proto)}(image_segmenter_graph_options_pb);var image_segmenter_result={};Object.defineProperty(image_segmenter_result,"__esModule",{value:!0}),image_segmenter_result.ImageSegmenterResult=void 0;class ImageSegmenterResult{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;null===(e=this.confidenceMasks)||void 0===e||e.forEach((e=>{e.close()})),null===(t=this.categoryMask)||void 0===t||t.close()}}image_segmenter_result.ImageSegmenterResult=ImageSegmenterResult;var image_segmenter_options={};Object.defineProperty(image_segmenter_options,"__esModule",{value:!0}),function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.ImageSegmenter=void 0;const r=calculator_pb,i=calculator_options_pb,o=base_options_pb,a=tensors_to_segmentation_calculator_pb,s=image_segmenter_graph_options_pb,u=segmenter_options_pb,l=vision_task_runner,c=image_segmenter_result;n(image_segmenter_options,e),n(image_segmenter_result,e);const p="image_in",d="norm_rect",h="confidence_masks",f="category_mask",g="quality_scores",m="mediapipe.tasks.TensorsToSegmentationCalculator";class y extends l.VisionTaskRunner{static createFromOptions(e,t){return l.VisionTaskRunner.createVisionInstance(y,e,t)}static createFromModelBuffer(e,t){return l.VisionTaskRunner.createVisionInstance(y,e,{baseOptions:{modelAssetBuffer:t}})}static createFromModelPath(e,t){return l.VisionTaskRunner.createVisionInstance(y,e,{baseOptions:{modelAssetPath:t}})}constructor(e,t){super(new l.VisionGraphRunner(e,t),p,d,!1),this.labels=[],this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.options=new s.ImageSegmenterGraphOptions,this.segmenterOptions=new u.SegmenterOptions,this.options.setSegmenterOptions(this.segmenterOptions),this.options.setBaseOptions(new o.BaseOptions)}get baseOptions(){return this.options.getBaseOptions()}set baseOptions(e){this.options.setBaseOptions(e)}setOptions(e){var t,n;return void 0!==e.displayNamesLocale?this.options.setDisplayNamesLocale(e.displayNamesLocale):"displayNamesLocale"in e&&this.options.clearDisplayNamesLocale(),"outputCategoryMask"in e&&(this.outputCategoryMask=null!==(t=e.outputCategoryMask)&&void 0!==t&&t),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=null===(n=e.outputConfidenceMasks)||void 0===n||n),super.applyOptions(e)}onGraphRefreshed(){this.populateLabels()}populateLabels(){var e,t,n;const r=this.getCalculatorGraphConfig().getNodeList().filter((e=>e.getName().includes(m)));if(this.labels=[],r.length>1)throw new Error(`The graph has more than one ${m}.`);1===r.length&&(null!==(n=null===(t=null===(e=r[0].getOptions())||void 0===e?void 0:e.getExtension(a.TensorsToSegmentationCalculatorOptions.ext))||void 0===t?void 0:t.getLabelItemsMap())&&void 0!==n?n:new Map).forEach(((e,t)=>{this.labels[Number(t)]=e.getName()}))}segment(e,t,n){const r="function"!=typeof t?t:{};return this.userCallback="function"==typeof t?t:n,this.reset(),this.processImageData(e,r),this.processResults()}segmentForVideo(e,t,n,r){const i="function"!=typeof n?n:{};return this.userCallback="function"==typeof n?n:r,this.reset(),this.processVideoData(e,i,t),this.processResults()}getLabels(){return this.labels}reset(){this.categoryMask=void 0,this.confidenceMasks=void 0,this.qualityScores=void 0}processResults(){try{const e=new c.ImageSegmenterResult(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.userCallback)return e;this.userCallback(e)}finally{this.freeKeepaliveStreams()}}refreshGraph(){const e=new r.CalculatorGraphConfig;e.addInputStream(p),e.addInputStream(d);const t=new i.CalculatorOptions;t.setExtension(s.ImageSegmenterGraphOptions.ext,this.options);const n=new r.CalculatorGraphConfig.Node;n.setCalculator("mediapipe.tasks.vision.image_segmenter.ImageSegmenterGraph"),n.addInputStream("IMAGE:"+p),n.addInputStream("NORM_RECT:"+d),n.setOptions(t),e.addNode(n),this.addKeepaliveNode(e),this.outputConfidenceMasks&&(e.addOutputStream(h),n.addOutputStream("CONFIDENCE_MASKS:"+h),this.keepStreamAlive(h),this.graphRunner.attachImageVectorListener(h,((e,t)=>{this.confidenceMasks=e.map((e=>this.convertToMPMask(e,!this.userCallback))),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(h,(e=>{this.confidenceMasks=[],this.setLatestOutputTimestamp(e)}))),this.outputCategoryMask&&(e.addOutputStream(f),n.addOutputStream("CATEGORY_MASK:"+f),this.keepStreamAlive(f),this.graphRunner.attachImageListener(f,((e,t)=>{this.categoryMask=this.convertToMPMask(e,!this.userCallback),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(f,(e=>{this.categoryMask=void 0,this.setLatestOutputTimestamp(e)}))),e.addOutputStream(g),n.addOutputStream("QUALITY_SCORES:"+g),this.graphRunner.attachFloatVectorListener(g,((e,t)=>{this.qualityScores=e,this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(g,(e=>{this.categoryMask=void 0,this.setLatestOutputTimestamp(e)}));const o=e.serializeBinary();this.setGraph(new Uint8Array(o),!0)}}e.ImageSegmenter=y}(image_segmenter);var interactive_segmenter={},color_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();n.exportSymbol("proto.mediapipe.Color",null,r),n.exportSymbol("proto.mediapipe.ColorMap",null,r),proto.mediapipe.Color=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.Color,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.Color.displayName="proto.mediapipe.Color"),proto.mediapipe.ColorMap=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.ColorMap,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.ColorMap.displayName="proto.mediapipe.ColorMap"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.Color.prototype.toObject=function(e){return proto.mediapipe.Color.toObject(e,this)},proto.mediapipe.Color.toObject=function(e,n){var r,i={r:null==(r=t.Message.getField(n,1))?void 0:r,g:null==(r=t.Message.getField(n,2))?void 0:r,b:null==(r=t.Message.getField(n,3))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.Color.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.Color;return proto.mediapipe.Color.deserializeBinaryFromReader(r,n)},proto.mediapipe.Color.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readInt32();e.setR(n);break;case 2:n=t.readInt32(),e.setG(n);break;case 3:n=t.readInt32(),e.setB(n);break;default:t.skipField()}return e},proto.mediapipe.Color.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.Color.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.Color.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeInt32(1,r),null!=(r=t.Message.getField(e,2))&&n.writeInt32(2,r),null!=(r=t.Message.getField(e,3))&&n.writeInt32(3,r)},proto.mediapipe.Color.prototype.getR=function(){return t.Message.getFieldWithDefault(this,1,0)},proto.mediapipe.Color.prototype.setR=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.Color.prototype.clearR=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.Color.prototype.hasR=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.Color.prototype.getG=function(){return t.Message.getFieldWithDefault(this,2,0)},proto.mediapipe.Color.prototype.setG=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.Color.prototype.clearG=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.Color.prototype.hasG=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.Color.prototype.getB=function(){return t.Message.getFieldWithDefault(this,3,0)},proto.mediapipe.Color.prototype.setB=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.Color.prototype.clearB=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.Color.prototype.hasB=function(){return null!=t.Message.getField(this,3)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.ColorMap.prototype.toObject=function(e){return proto.mediapipe.ColorMap.toObject(e,this)},proto.mediapipe.ColorMap.toObject=function(e,t){var n,r={labelToColorMap:(n=t.getLabelToColorMap())?n.toObject(e,proto.mediapipe.Color.toObject):[]};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.ColorMap.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.ColorMap;return proto.mediapipe.ColorMap.deserializeBinaryFromReader(r,n)},proto.mediapipe.ColorMap.deserializeBinaryFromReader=function(e,n){for(;n.nextField()&&!n.isEndGroup();)if(1===n.getFieldNumber()){var r=e.getLabelToColorMap();n.readMessage(r,(function(e,n){t.Map.deserializeBinary(e,n,t.BinaryReader.prototype.readString,t.BinaryReader.prototype.readMessage,proto.mediapipe.Color.deserializeBinaryFromReader,"",new proto.mediapipe.Color)}))}else n.skipField();return e},proto.mediapipe.ColorMap.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.ColorMap.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.ColorMap.serializeBinaryToWriter=function(e,n){var r=void 0;(r=e.getLabelToColorMap(!0))&&r.getLength()>0&&r.serializeBinary(1,n,t.BinaryWriter.prototype.writeString,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.Color.serializeBinaryToWriter)},proto.mediapipe.ColorMap.prototype.getLabelToColorMap=function(e){return t.Message.getMapField(this,1,e,proto.mediapipe.Color)},proto.mediapipe.ColorMap.prototype.clearLabelToColorMap=function(){return this.getLabelToColorMap().clear(),this},n.object.extend(e,proto.mediapipe)}(color_pb);var render_data_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=color_pb;n.object.extend(proto,i),n.exportSymbol("proto.mediapipe.RenderAnnotation",null,r),n.exportSymbol("proto.mediapipe.RenderAnnotation.Arrow",null,r),n.exportSymbol("proto.mediapipe.RenderAnnotation.DataCase",null,r),n.exportSymbol("proto.mediapipe.RenderAnnotation.FilledOval",null,r),n.exportSymbol("proto.mediapipe.RenderAnnotation.FilledRectangle",null,r),n.exportSymbol("proto.mediapipe.RenderAnnotation.FilledRoundedRectangle",null,r),n.exportSymbol("proto.mediapipe.RenderAnnotation.GradientLine",null,r),n.exportSymbol("proto.mediapipe.RenderAnnotation.Line",null,r),n.exportSymbol("proto.mediapipe.RenderAnnotation.Line.LineType",null,r),n.exportSymbol("proto.mediapipe.RenderAnnotation.Oval",null,r),n.exportSymbol("proto.mediapipe.RenderAnnotation.Point",null,r),n.exportSymbol("proto.mediapipe.RenderAnnotation.Rectangle",null,r),n.exportSymbol("proto.mediapipe.RenderAnnotation.RoundedRectangle",null,r),n.exportSymbol("proto.mediapipe.RenderAnnotation.Scribble",null,r),n.exportSymbol("proto.mediapipe.RenderAnnotation.Text",null,r),n.exportSymbol("proto.mediapipe.RenderData",null,r),n.exportSymbol("proto.mediapipe.RenderViewport",null,r),proto.mediapipe.RenderData=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.RenderData.repeatedFields_,null)},n.inherits(proto.mediapipe.RenderData,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.RenderData.displayName="proto.mediapipe.RenderData"),proto.mediapipe.RenderAnnotation=function(e){t.Message.initialize(this,e,0,-1,null,proto.mediapipe.RenderAnnotation.oneofGroups_)},n.inherits(proto.mediapipe.RenderAnnotation,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.RenderAnnotation.displayName="proto.mediapipe.RenderAnnotation"),proto.mediapipe.RenderAnnotation.Rectangle=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.RenderAnnotation.Rectangle,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.RenderAnnotation.Rectangle.displayName="proto.mediapipe.RenderAnnotation.Rectangle"),proto.mediapipe.RenderAnnotation.FilledRectangle=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.RenderAnnotation.FilledRectangle,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.RenderAnnotation.FilledRectangle.displayName="proto.mediapipe.RenderAnnotation.FilledRectangle"),proto.mediapipe.RenderAnnotation.RoundedRectangle=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.RenderAnnotation.RoundedRectangle,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.RenderAnnotation.RoundedRectangle.displayName="proto.mediapipe.RenderAnnotation.RoundedRectangle"),proto.mediapipe.RenderAnnotation.FilledRoundedRectangle=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.RenderAnnotation.FilledRoundedRectangle,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.displayName="proto.mediapipe.RenderAnnotation.FilledRoundedRectangle"),proto.mediapipe.RenderAnnotation.Oval=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.RenderAnnotation.Oval,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.RenderAnnotation.Oval.displayName="proto.mediapipe.RenderAnnotation.Oval"),proto.mediapipe.RenderAnnotation.FilledOval=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.RenderAnnotation.FilledOval,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.RenderAnnotation.FilledOval.displayName="proto.mediapipe.RenderAnnotation.FilledOval"),proto.mediapipe.RenderAnnotation.Point=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.RenderAnnotation.Point,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.RenderAnnotation.Point.displayName="proto.mediapipe.RenderAnnotation.Point"),proto.mediapipe.RenderAnnotation.Line=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.RenderAnnotation.Line,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.RenderAnnotation.Line.displayName="proto.mediapipe.RenderAnnotation.Line"),proto.mediapipe.RenderAnnotation.GradientLine=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.RenderAnnotation.GradientLine,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.RenderAnnotation.GradientLine.displayName="proto.mediapipe.RenderAnnotation.GradientLine"),proto.mediapipe.RenderAnnotation.Scribble=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.RenderAnnotation.Scribble.repeatedFields_,null)},n.inherits(proto.mediapipe.RenderAnnotation.Scribble,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.RenderAnnotation.Scribble.displayName="proto.mediapipe.RenderAnnotation.Scribble"),proto.mediapipe.RenderAnnotation.Arrow=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.RenderAnnotation.Arrow,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.RenderAnnotation.Arrow.displayName="proto.mediapipe.RenderAnnotation.Arrow"),proto.mediapipe.RenderAnnotation.Text=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.RenderAnnotation.Text,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.RenderAnnotation.Text.displayName="proto.mediapipe.RenderAnnotation.Text"),proto.mediapipe.RenderViewport=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.RenderViewport,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.RenderViewport.displayName="proto.mediapipe.RenderViewport"),proto.mediapipe.RenderData.repeatedFields_=[1],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.RenderData.prototype.toObject=function(e){return proto.mediapipe.RenderData.toObject(e,this)},proto.mediapipe.RenderData.toObject=function(e,n){var r,i={renderAnnotationsList:t.Message.toObjectList(n.getRenderAnnotationsList(),proto.mediapipe.RenderAnnotation.toObject,e),sceneClass:null==(r=t.Message.getField(n,2))?void 0:r,sceneViewport:(r=n.getSceneViewport())&&proto.mediapipe.RenderViewport.toObject(e,r)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.RenderData.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.RenderData;return proto.mediapipe.RenderData.deserializeBinaryFromReader(r,n)},proto.mediapipe.RenderData.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new proto.mediapipe.RenderAnnotation;t.readMessage(n,proto.mediapipe.RenderAnnotation.deserializeBinaryFromReader),e.addRenderAnnotations(n);break;case 2:n=t.readString(),e.setSceneClass(n);break;case 3:n=new proto.mediapipe.RenderViewport,t.readMessage(n,proto.mediapipe.RenderViewport.deserializeBinaryFromReader),e.setSceneViewport(n);break;default:t.skipField()}return e},proto.mediapipe.RenderData.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.RenderData.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.RenderData.serializeBinaryToWriter=function(e,n){var r=void 0;(r=e.getRenderAnnotationsList()).length>0&&n.writeRepeatedMessage(1,r,proto.mediapipe.RenderAnnotation.serializeBinaryToWriter),null!=(r=t.Message.getField(e,2))&&n.writeString(2,r),null!=(r=e.getSceneViewport())&&n.writeMessage(3,r,proto.mediapipe.RenderViewport.serializeBinaryToWriter)},proto.mediapipe.RenderData.prototype.getRenderAnnotationsList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.RenderAnnotation,1)},proto.mediapipe.RenderData.prototype.setRenderAnnotationsList=function(e){return t.Message.setRepeatedWrapperField(this,1,e)},proto.mediapipe.RenderData.prototype.addRenderAnnotations=function(e,n){return t.Message.addToRepeatedWrapperField(this,1,e,proto.mediapipe.RenderAnnotation,n)},proto.mediapipe.RenderData.prototype.clearRenderAnnotationsList=function(){return this.setRenderAnnotationsList([])},proto.mediapipe.RenderData.prototype.getSceneClass=function(){return t.Message.getFieldWithDefault(this,2,"")},proto.mediapipe.RenderData.prototype.setSceneClass=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.RenderData.prototype.clearSceneClass=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.RenderData.prototype.hasSceneClass=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.RenderData.prototype.getSceneViewport=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderViewport,3)},proto.mediapipe.RenderData.prototype.setSceneViewport=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.RenderData.prototype.clearSceneViewport=function(){return this.setSceneViewport(void 0)},proto.mediapipe.RenderData.prototype.hasSceneViewport=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.RenderAnnotation.oneofGroups_=[[1,2,3,4,5,6,7,8,9,10,14,15]],proto.mediapipe.RenderAnnotation.DataCase={DATA_NOT_SET:0,RECTANGLE:1,FILLED_RECTANGLE:2,OVAL:3,FILLED_OVAL:4,POINT:5,LINE:6,ARROW:7,TEXT:8,ROUNDED_RECTANGLE:9,FILLED_ROUNDED_RECTANGLE:10,GRADIENT_LINE:14,SCRIBBLE:15},proto.mediapipe.RenderAnnotation.prototype.getDataCase=function(){return t.Message.computeOneofCase(this,proto.mediapipe.RenderAnnotation.oneofGroups_[0])},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.RenderAnnotation.prototype.toObject=function(e){return proto.mediapipe.RenderAnnotation.toObject(e,this)},proto.mediapipe.RenderAnnotation.toObject=function(e,n){var r,o={rectangle:(r=n.getRectangle())&&proto.mediapipe.RenderAnnotation.Rectangle.toObject(e,r),filledRectangle:(r=n.getFilledRectangle())&&proto.mediapipe.RenderAnnotation.FilledRectangle.toObject(e,r),oval:(r=n.getOval())&&proto.mediapipe.RenderAnnotation.Oval.toObject(e,r),filledOval:(r=n.getFilledOval())&&proto.mediapipe.RenderAnnotation.FilledOval.toObject(e,r),point:(r=n.getPoint())&&proto.mediapipe.RenderAnnotation.Point.toObject(e,r),line:(r=n.getLine())&&proto.mediapipe.RenderAnnotation.Line.toObject(e,r),arrow:(r=n.getArrow())&&proto.mediapipe.RenderAnnotation.Arrow.toObject(e,r),text:(r=n.getText())&&proto.mediapipe.RenderAnnotation.Text.toObject(e,r),roundedRectangle:(r=n.getRoundedRectangle())&&proto.mediapipe.RenderAnnotation.RoundedRectangle.toObject(e,r),filledRoundedRectangle:(r=n.getFilledRoundedRectangle())&&proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.toObject(e,r),gradientLine:(r=n.getGradientLine())&&proto.mediapipe.RenderAnnotation.GradientLine.toObject(e,r),scribble:(r=n.getScribble())&&proto.mediapipe.RenderAnnotation.Scribble.toObject(e,r),thickness:t.Message.getFloatingPointFieldWithDefault(n,11,1),color:(r=n.getColor())&&i.Color.toObject(e,r),sceneTag:null==(r=t.Message.getField(n,13))?void 0:r};return e&&(o.$jspbMessageInstance=n),o}),proto.mediapipe.RenderAnnotation.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.RenderAnnotation;return proto.mediapipe.RenderAnnotation.deserializeBinaryFromReader(r,n)},proto.mediapipe.RenderAnnotation.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new proto.mediapipe.RenderAnnotation.Rectangle;t.readMessage(n,proto.mediapipe.RenderAnnotation.Rectangle.deserializeBinaryFromReader),e.setRectangle(n);break;case 2:n=new proto.mediapipe.RenderAnnotation.FilledRectangle,t.readMessage(n,proto.mediapipe.RenderAnnotation.FilledRectangle.deserializeBinaryFromReader),e.setFilledRectangle(n);break;case 3:n=new proto.mediapipe.RenderAnnotation.Oval,t.readMessage(n,proto.mediapipe.RenderAnnotation.Oval.deserializeBinaryFromReader),e.setOval(n);break;case 4:n=new proto.mediapipe.RenderAnnotation.FilledOval,t.readMessage(n,proto.mediapipe.RenderAnnotation.FilledOval.deserializeBinaryFromReader),e.setFilledOval(n);break;case 5:n=new proto.mediapipe.RenderAnnotation.Point,t.readMessage(n,proto.mediapipe.RenderAnnotation.Point.deserializeBinaryFromReader),e.setPoint(n);break;case 6:n=new proto.mediapipe.RenderAnnotation.Line,t.readMessage(n,proto.mediapipe.RenderAnnotation.Line.deserializeBinaryFromReader),e.setLine(n);break;case 7:n=new proto.mediapipe.RenderAnnotation.Arrow,t.readMessage(n,proto.mediapipe.RenderAnnotation.Arrow.deserializeBinaryFromReader),e.setArrow(n);break;case 8:n=new proto.mediapipe.RenderAnnotation.Text,t.readMessage(n,proto.mediapipe.RenderAnnotation.Text.deserializeBinaryFromReader),e.setText(n);break;case 9:n=new proto.mediapipe.RenderAnnotation.RoundedRectangle,t.readMessage(n,proto.mediapipe.RenderAnnotation.RoundedRectangle.deserializeBinaryFromReader),e.setRoundedRectangle(n);break;case 10:n=new proto.mediapipe.RenderAnnotation.FilledRoundedRectangle,t.readMessage(n,proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.deserializeBinaryFromReader),e.setFilledRoundedRectangle(n);break;case 14:n=new proto.mediapipe.RenderAnnotation.GradientLine,t.readMessage(n,proto.mediapipe.RenderAnnotation.GradientLine.deserializeBinaryFromReader),e.setGradientLine(n);break;case 15:n=new proto.mediapipe.RenderAnnotation.Scribble,t.readMessage(n,proto.mediapipe.RenderAnnotation.Scribble.deserializeBinaryFromReader),e.setScribble(n);break;case 11:n=t.readDouble(),e.setThickness(n);break;case 12:n=new i.Color,t.readMessage(n,i.Color.deserializeBinaryFromReader),e.setColor(n);break;case 13:n=t.readString(),e.setSceneTag(n);break;default:t.skipField()}return e},proto.mediapipe.RenderAnnotation.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.RenderAnnotation.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.RenderAnnotation.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getRectangle())&&n.writeMessage(1,r,proto.mediapipe.RenderAnnotation.Rectangle.serializeBinaryToWriter),null!=(r=e.getFilledRectangle())&&n.writeMessage(2,r,proto.mediapipe.RenderAnnotation.FilledRectangle.serializeBinaryToWriter),null!=(r=e.getOval())&&n.writeMessage(3,r,proto.mediapipe.RenderAnnotation.Oval.serializeBinaryToWriter),null!=(r=e.getFilledOval())&&n.writeMessage(4,r,proto.mediapipe.RenderAnnotation.FilledOval.serializeBinaryToWriter),null!=(r=e.getPoint())&&n.writeMessage(5,r,proto.mediapipe.RenderAnnotation.Point.serializeBinaryToWriter),null!=(r=e.getLine())&&n.writeMessage(6,r,proto.mediapipe.RenderAnnotation.Line.serializeBinaryToWriter),null!=(r=e.getArrow())&&n.writeMessage(7,r,proto.mediapipe.RenderAnnotation.Arrow.serializeBinaryToWriter),null!=(r=e.getText())&&n.writeMessage(8,r,proto.mediapipe.RenderAnnotation.Text.serializeBinaryToWriter),null!=(r=e.getRoundedRectangle())&&n.writeMessage(9,r,proto.mediapipe.RenderAnnotation.RoundedRectangle.serializeBinaryToWriter),null!=(r=e.getFilledRoundedRectangle())&&n.writeMessage(10,r,proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.serializeBinaryToWriter),null!=(r=e.getGradientLine())&&n.writeMessage(14,r,proto.mediapipe.RenderAnnotation.GradientLine.serializeBinaryToWriter),null!=(r=e.getScribble())&&n.writeMessage(15,r,proto.mediapipe.RenderAnnotation.Scribble.serializeBinaryToWriter),null!=(r=t.Message.getField(e,11))&&n.writeDouble(11,r),null!=(r=e.getColor())&&n.writeMessage(12,r,i.Color.serializeBinaryToWriter),null!=(r=t.Message.getField(e,13))&&n.writeString(13,r)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.RenderAnnotation.Rectangle.prototype.toObject=function(e){return proto.mediapipe.RenderAnnotation.Rectangle.toObject(e,this)},proto.mediapipe.RenderAnnotation.Rectangle.toObject=function(e,n){var r,i={left:null==(r=t.Message.getOptionalFloatingPointField(n,1))?void 0:r,top:null==(r=t.Message.getOptionalFloatingPointField(n,2))?void 0:r,right:null==(r=t.Message.getOptionalFloatingPointField(n,3))?void 0:r,bottom:null==(r=t.Message.getOptionalFloatingPointField(n,4))?void 0:r,normalized:t.Message.getBooleanFieldWithDefault(n,5,!1),rotation:null==(r=t.Message.getOptionalFloatingPointField(n,6))?void 0:r,topLeftThickness:null==(r=t.Message.getOptionalFloatingPointField(n,7))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.RenderAnnotation.Rectangle.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.RenderAnnotation.Rectangle;return proto.mediapipe.RenderAnnotation.Rectangle.deserializeBinaryFromReader(r,n)},proto.mediapipe.RenderAnnotation.Rectangle.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readDouble();e.setLeft(n);break;case 2:n=t.readDouble(),e.setTop(n);break;case 3:n=t.readDouble(),e.setRight(n);break;case 4:n=t.readDouble(),e.setBottom(n);break;case 5:n=t.readBool(),e.setNormalized(n);break;case 6:n=t.readDouble(),e.setRotation(n);break;case 7:n=t.readDouble(),e.setTopLeftThickness(n);break;default:t.skipField()}return e},proto.mediapipe.RenderAnnotation.Rectangle.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.RenderAnnotation.Rectangle.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.RenderAnnotation.Rectangle.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeDouble(1,r),null!=(r=t.Message.getField(e,2))&&n.writeDouble(2,r),null!=(r=t.Message.getField(e,3))&&n.writeDouble(3,r),null!=(r=t.Message.getField(e,4))&&n.writeDouble(4,r),null!=(r=t.Message.getField(e,5))&&n.writeBool(5,r),null!=(r=t.Message.getField(e,6))&&n.writeDouble(6,r),null!=(r=t.Message.getField(e,7))&&n.writeDouble(7,r)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.getLeft=function(){return t.Message.getFloatingPointFieldWithDefault(this,1,0)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.setLeft=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.clearLeft=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.hasLeft=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.getTop=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,0)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.setTop=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.clearTop=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.hasTop=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.getRight=function(){return t.Message.getFloatingPointFieldWithDefault(this,3,0)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.setRight=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.clearRight=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.hasRight=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.getBottom=function(){return t.Message.getFloatingPointFieldWithDefault(this,4,0)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.setBottom=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.clearBottom=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.hasBottom=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.getNormalized=function(){return t.Message.getBooleanFieldWithDefault(this,5,!1)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.setNormalized=function(e){return t.Message.setField(this,5,e)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.clearNormalized=function(){return t.Message.setField(this,5,void 0)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.hasNormalized=function(){return null!=t.Message.getField(this,5)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.getRotation=function(){return t.Message.getFloatingPointFieldWithDefault(this,6,0)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.setRotation=function(e){return t.Message.setField(this,6,e)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.clearRotation=function(){return t.Message.setField(this,6,void 0)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.hasRotation=function(){return null!=t.Message.getField(this,6)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.getTopLeftThickness=function(){return t.Message.getFloatingPointFieldWithDefault(this,7,0)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.setTopLeftThickness=function(e){return t.Message.setField(this,7,e)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.clearTopLeftThickness=function(){return t.Message.setField(this,7,void 0)},proto.mediapipe.RenderAnnotation.Rectangle.prototype.hasTopLeftThickness=function(){return null!=t.Message.getField(this,7)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.RenderAnnotation.FilledRectangle.prototype.toObject=function(e){return proto.mediapipe.RenderAnnotation.FilledRectangle.toObject(e,this)},proto.mediapipe.RenderAnnotation.FilledRectangle.toObject=function(e,t){var n,r={rectangle:(n=t.getRectangle())&&proto.mediapipe.RenderAnnotation.Rectangle.toObject(e,n),fillColor:(n=t.getFillColor())&&i.Color.toObject(e,n)};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.RenderAnnotation.FilledRectangle.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.RenderAnnotation.FilledRectangle;return proto.mediapipe.RenderAnnotation.FilledRectangle.deserializeBinaryFromReader(r,n)},proto.mediapipe.RenderAnnotation.FilledRectangle.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new proto.mediapipe.RenderAnnotation.Rectangle;t.readMessage(n,proto.mediapipe.RenderAnnotation.Rectangle.deserializeBinaryFromReader),e.setRectangle(n);break;case 2:n=new i.Color,t.readMessage(n,i.Color.deserializeBinaryFromReader),e.setFillColor(n);break;default:t.skipField()}return e},proto.mediapipe.RenderAnnotation.FilledRectangle.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.RenderAnnotation.FilledRectangle.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.RenderAnnotation.FilledRectangle.serializeBinaryToWriter=function(e,t){var n=void 0;null!=(n=e.getRectangle())&&t.writeMessage(1,n,proto.mediapipe.RenderAnnotation.Rectangle.serializeBinaryToWriter),null!=(n=e.getFillColor())&&t.writeMessage(2,n,i.Color.serializeBinaryToWriter)},proto.mediapipe.RenderAnnotation.FilledRectangle.prototype.getRectangle=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.Rectangle,1)},proto.mediapipe.RenderAnnotation.FilledRectangle.prototype.setRectangle=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.RenderAnnotation.FilledRectangle.prototype.clearRectangle=function(){return this.setRectangle(void 0)},proto.mediapipe.RenderAnnotation.FilledRectangle.prototype.hasRectangle=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.RenderAnnotation.FilledRectangle.prototype.getFillColor=function(){return t.Message.getWrapperField(this,i.Color,2)},proto.mediapipe.RenderAnnotation.FilledRectangle.prototype.setFillColor=function(e){return t.Message.setWrapperField(this,2,e)},proto.mediapipe.RenderAnnotation.FilledRectangle.prototype.clearFillColor=function(){return this.setFillColor(void 0)},proto.mediapipe.RenderAnnotation.FilledRectangle.prototype.hasFillColor=function(){return null!=t.Message.getField(this,2)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.RenderAnnotation.RoundedRectangle.prototype.toObject=function(e){return proto.mediapipe.RenderAnnotation.RoundedRectangle.toObject(e,this)},proto.mediapipe.RenderAnnotation.RoundedRectangle.toObject=function(e,n){var r,i={rectangle:(r=n.getRectangle())&&proto.mediapipe.RenderAnnotation.Rectangle.toObject(e,r),cornerRadius:t.Message.getFieldWithDefault(n,2,0),lineType:t.Message.getFieldWithDefault(n,3,4)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.RenderAnnotation.RoundedRectangle.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.RenderAnnotation.RoundedRectangle;return proto.mediapipe.RenderAnnotation.RoundedRectangle.deserializeBinaryFromReader(r,n)},proto.mediapipe.RenderAnnotation.RoundedRectangle.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new proto.mediapipe.RenderAnnotation.Rectangle;t.readMessage(n,proto.mediapipe.RenderAnnotation.Rectangle.deserializeBinaryFromReader),e.setRectangle(n);break;case 2:n=t.readInt32(),e.setCornerRadius(n);break;case 3:n=t.readInt32(),e.setLineType(n);break;default:t.skipField()}return e},proto.mediapipe.RenderAnnotation.RoundedRectangle.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.RenderAnnotation.RoundedRectangle.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.RenderAnnotation.RoundedRectangle.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getRectangle())&&n.writeMessage(1,r,proto.mediapipe.RenderAnnotation.Rectangle.serializeBinaryToWriter),null!=(r=t.Message.getField(e,2))&&n.writeInt32(2,r),null!=(r=t.Message.getField(e,3))&&n.writeInt32(3,r)},proto.mediapipe.RenderAnnotation.RoundedRectangle.prototype.getRectangle=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.Rectangle,1)},proto.mediapipe.RenderAnnotation.RoundedRectangle.prototype.setRectangle=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.RenderAnnotation.RoundedRectangle.prototype.clearRectangle=function(){return this.setRectangle(void 0)},proto.mediapipe.RenderAnnotation.RoundedRectangle.prototype.hasRectangle=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.RenderAnnotation.RoundedRectangle.prototype.getCornerRadius=function(){return t.Message.getFieldWithDefault(this,2,0)},proto.mediapipe.RenderAnnotation.RoundedRectangle.prototype.setCornerRadius=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.RenderAnnotation.RoundedRectangle.prototype.clearCornerRadius=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.RenderAnnotation.RoundedRectangle.prototype.hasCornerRadius=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.RenderAnnotation.RoundedRectangle.prototype.getLineType=function(){return t.Message.getFieldWithDefault(this,3,4)},proto.mediapipe.RenderAnnotation.RoundedRectangle.prototype.setLineType=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.RenderAnnotation.RoundedRectangle.prototype.clearLineType=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.RenderAnnotation.RoundedRectangle.prototype.hasLineType=function(){return null!=t.Message.getField(this,3)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.prototype.toObject=function(e){return proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.toObject(e,this)},proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.toObject=function(e,t){var n,r={roundedRectangle:(n=t.getRoundedRectangle())&&proto.mediapipe.RenderAnnotation.RoundedRectangle.toObject(e,n),fillColor:(n=t.getFillColor())&&i.Color.toObject(e,n)};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.RenderAnnotation.FilledRoundedRectangle;return proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.deserializeBinaryFromReader(r,n)},proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new proto.mediapipe.RenderAnnotation.RoundedRectangle;t.readMessage(n,proto.mediapipe.RenderAnnotation.RoundedRectangle.deserializeBinaryFromReader),e.setRoundedRectangle(n);break;case 2:n=new i.Color,t.readMessage(n,i.Color.deserializeBinaryFromReader),e.setFillColor(n);break;default:t.skipField()}return e},proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.serializeBinaryToWriter=function(e,t){var n=void 0;null!=(n=e.getRoundedRectangle())&&t.writeMessage(1,n,proto.mediapipe.RenderAnnotation.RoundedRectangle.serializeBinaryToWriter),null!=(n=e.getFillColor())&&t.writeMessage(2,n,i.Color.serializeBinaryToWriter)},proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.prototype.getRoundedRectangle=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.RoundedRectangle,1)},proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.prototype.setRoundedRectangle=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.prototype.clearRoundedRectangle=function(){return this.setRoundedRectangle(void 0)},proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.prototype.hasRoundedRectangle=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.prototype.getFillColor=function(){return t.Message.getWrapperField(this,i.Color,2)},proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.prototype.setFillColor=function(e){return t.Message.setWrapperField(this,2,e)},proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.prototype.clearFillColor=function(){return this.setFillColor(void 0)},proto.mediapipe.RenderAnnotation.FilledRoundedRectangle.prototype.hasFillColor=function(){return null!=t.Message.getField(this,2)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.RenderAnnotation.Oval.prototype.toObject=function(e){return proto.mediapipe.RenderAnnotation.Oval.toObject(e,this)},proto.mediapipe.RenderAnnotation.Oval.toObject=function(e,t){var n,r={rectangle:(n=t.getRectangle())&&proto.mediapipe.RenderAnnotation.Rectangle.toObject(e,n)};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.RenderAnnotation.Oval.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.RenderAnnotation.Oval;return proto.mediapipe.RenderAnnotation.Oval.deserializeBinaryFromReader(r,n)},proto.mediapipe.RenderAnnotation.Oval.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=new proto.mediapipe.RenderAnnotation.Rectangle;t.readMessage(n,proto.mediapipe.RenderAnnotation.Rectangle.deserializeBinaryFromReader),e.setRectangle(n)}else t.skipField();return e},proto.mediapipe.RenderAnnotation.Oval.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.RenderAnnotation.Oval.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.RenderAnnotation.Oval.serializeBinaryToWriter=function(e,t){var n;null!=(n=e.getRectangle())&&t.writeMessage(1,n,proto.mediapipe.RenderAnnotation.Rectangle.serializeBinaryToWriter)},proto.mediapipe.RenderAnnotation.Oval.prototype.getRectangle=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.Rectangle,1)},proto.mediapipe.RenderAnnotation.Oval.prototype.setRectangle=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.RenderAnnotation.Oval.prototype.clearRectangle=function(){return this.setRectangle(void 0)},proto.mediapipe.RenderAnnotation.Oval.prototype.hasRectangle=function(){return null!=t.Message.getField(this,1)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.RenderAnnotation.FilledOval.prototype.toObject=function(e){return proto.mediapipe.RenderAnnotation.FilledOval.toObject(e,this)},proto.mediapipe.RenderAnnotation.FilledOval.toObject=function(e,t){var n,r={oval:(n=t.getOval())&&proto.mediapipe.RenderAnnotation.Oval.toObject(e,n),fillColor:(n=t.getFillColor())&&i.Color.toObject(e,n)};return e&&(r.$jspbMessageInstance=t),r}),proto.mediapipe.RenderAnnotation.FilledOval.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.RenderAnnotation.FilledOval;return proto.mediapipe.RenderAnnotation.FilledOval.deserializeBinaryFromReader(r,n)},proto.mediapipe.RenderAnnotation.FilledOval.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new proto.mediapipe.RenderAnnotation.Oval;t.readMessage(n,proto.mediapipe.RenderAnnotation.Oval.deserializeBinaryFromReader),e.setOval(n);break;case 2:n=new i.Color,t.readMessage(n,i.Color.deserializeBinaryFromReader),e.setFillColor(n);break;default:t.skipField()}return e},proto.mediapipe.RenderAnnotation.FilledOval.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.RenderAnnotation.FilledOval.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.RenderAnnotation.FilledOval.serializeBinaryToWriter=function(e,t){var n=void 0;null!=(n=e.getOval())&&t.writeMessage(1,n,proto.mediapipe.RenderAnnotation.Oval.serializeBinaryToWriter),null!=(n=e.getFillColor())&&t.writeMessage(2,n,i.Color.serializeBinaryToWriter)},proto.mediapipe.RenderAnnotation.FilledOval.prototype.getOval=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.Oval,1)},proto.mediapipe.RenderAnnotation.FilledOval.prototype.setOval=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.RenderAnnotation.FilledOval.prototype.clearOval=function(){return this.setOval(void 0)},proto.mediapipe.RenderAnnotation.FilledOval.prototype.hasOval=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.RenderAnnotation.FilledOval.prototype.getFillColor=function(){return t.Message.getWrapperField(this,i.Color,2)},proto.mediapipe.RenderAnnotation.FilledOval.prototype.setFillColor=function(e){return t.Message.setWrapperField(this,2,e)},proto.mediapipe.RenderAnnotation.FilledOval.prototype.clearFillColor=function(){return this.setFillColor(void 0)},proto.mediapipe.RenderAnnotation.FilledOval.prototype.hasFillColor=function(){return null!=t.Message.getField(this,2)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.RenderAnnotation.Point.prototype.toObject=function(e){return proto.mediapipe.RenderAnnotation.Point.toObject(e,this)},proto.mediapipe.RenderAnnotation.Point.toObject=function(e,n){var r,i={x:null==(r=t.Message.getOptionalFloatingPointField(n,1))?void 0:r,y:null==(r=t.Message.getOptionalFloatingPointField(n,2))?void 0:r,normalized:t.Message.getBooleanFieldWithDefault(n,3,!1)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.RenderAnnotation.Point.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.RenderAnnotation.Point;return proto.mediapipe.RenderAnnotation.Point.deserializeBinaryFromReader(r,n)},proto.mediapipe.RenderAnnotation.Point.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readDouble();e.setX(n);break;case 2:n=t.readDouble(),e.setY(n);break;case 3:n=t.readBool(),e.setNormalized(n);break;default:t.skipField()}return e},proto.mediapipe.RenderAnnotation.Point.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.RenderAnnotation.Point.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.RenderAnnotation.Point.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeDouble(1,r),null!=(r=t.Message.getField(e,2))&&n.writeDouble(2,r),null!=(r=t.Message.getField(e,3))&&n.writeBool(3,r)},proto.mediapipe.RenderAnnotation.Point.prototype.getX=function(){return t.Message.getFloatingPointFieldWithDefault(this,1,0)},proto.mediapipe.RenderAnnotation.Point.prototype.setX=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.RenderAnnotation.Point.prototype.clearX=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.RenderAnnotation.Point.prototype.hasX=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.RenderAnnotation.Point.prototype.getY=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,0)},proto.mediapipe.RenderAnnotation.Point.prototype.setY=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.RenderAnnotation.Point.prototype.clearY=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.RenderAnnotation.Point.prototype.hasY=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.RenderAnnotation.Point.prototype.getNormalized=function(){return t.Message.getBooleanFieldWithDefault(this,3,!1)},proto.mediapipe.RenderAnnotation.Point.prototype.setNormalized=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.RenderAnnotation.Point.prototype.clearNormalized=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.RenderAnnotation.Point.prototype.hasNormalized=function(){return null!=t.Message.getField(this,3)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.RenderAnnotation.Line.prototype.toObject=function(e){return proto.mediapipe.RenderAnnotation.Line.toObject(e,this)},proto.mediapipe.RenderAnnotation.Line.toObject=function(e,n){var r,i={xStart:null==(r=t.Message.getOptionalFloatingPointField(n,1))?void 0:r,yStart:null==(r=t.Message.getOptionalFloatingPointField(n,2))?void 0:r,xEnd:null==(r=t.Message.getOptionalFloatingPointField(n,3))?void 0:r,yEnd:null==(r=t.Message.getOptionalFloatingPointField(n,4))?void 0:r,normalized:t.Message.getBooleanFieldWithDefault(n,5,!1),lineType:t.Message.getFieldWithDefault(n,6,1)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.RenderAnnotation.Line.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.RenderAnnotation.Line;return proto.mediapipe.RenderAnnotation.Line.deserializeBinaryFromReader(r,n)},proto.mediapipe.RenderAnnotation.Line.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readDouble();e.setXStart(n);break;case 2:n=t.readDouble(),e.setYStart(n);break;case 3:n=t.readDouble(),e.setXEnd(n);break;case 4:n=t.readDouble(),e.setYEnd(n);break;case 5:n=t.readBool(),e.setNormalized(n);break;case 6:n=t.readEnum(),e.setLineType(n);break;default:t.skipField()}return e},proto.mediapipe.RenderAnnotation.Line.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.RenderAnnotation.Line.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.RenderAnnotation.Line.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeDouble(1,r),null!=(r=t.Message.getField(e,2))&&n.writeDouble(2,r),null!=(r=t.Message.getField(e,3))&&n.writeDouble(3,r),null!=(r=t.Message.getField(e,4))&&n.writeDouble(4,r),null!=(r=t.Message.getField(e,5))&&n.writeBool(5,r),null!=(r=t.Message.getField(e,6))&&n.writeEnum(6,r)},proto.mediapipe.RenderAnnotation.Line.LineType={UNKNOWN:0,SOLID:1,DASHED:2},proto.mediapipe.RenderAnnotation.Line.prototype.getXStart=function(){return t.Message.getFloatingPointFieldWithDefault(this,1,0)},proto.mediapipe.RenderAnnotation.Line.prototype.setXStart=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.RenderAnnotation.Line.prototype.clearXStart=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.RenderAnnotation.Line.prototype.hasXStart=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.RenderAnnotation.Line.prototype.getYStart=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,0)},proto.mediapipe.RenderAnnotation.Line.prototype.setYStart=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.RenderAnnotation.Line.prototype.clearYStart=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.RenderAnnotation.Line.prototype.hasYStart=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.RenderAnnotation.Line.prototype.getXEnd=function(){return t.Message.getFloatingPointFieldWithDefault(this,3,0)},proto.mediapipe.RenderAnnotation.Line.prototype.setXEnd=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.RenderAnnotation.Line.prototype.clearXEnd=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.RenderAnnotation.Line.prototype.hasXEnd=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.RenderAnnotation.Line.prototype.getYEnd=function(){return t.Message.getFloatingPointFieldWithDefault(this,4,0)},proto.mediapipe.RenderAnnotation.Line.prototype.setYEnd=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.RenderAnnotation.Line.prototype.clearYEnd=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.RenderAnnotation.Line.prototype.hasYEnd=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.RenderAnnotation.Line.prototype.getNormalized=function(){return t.Message.getBooleanFieldWithDefault(this,5,!1)},proto.mediapipe.RenderAnnotation.Line.prototype.setNormalized=function(e){return t.Message.setField(this,5,e)},proto.mediapipe.RenderAnnotation.Line.prototype.clearNormalized=function(){return t.Message.setField(this,5,void 0)},proto.mediapipe.RenderAnnotation.Line.prototype.hasNormalized=function(){return null!=t.Message.getField(this,5)},proto.mediapipe.RenderAnnotation.Line.prototype.getLineType=function(){return t.Message.getFieldWithDefault(this,6,1)},proto.mediapipe.RenderAnnotation.Line.prototype.setLineType=function(e){return t.Message.setField(this,6,e)},proto.mediapipe.RenderAnnotation.Line.prototype.clearLineType=function(){return t.Message.setField(this,6,void 0)},proto.mediapipe.RenderAnnotation.Line.prototype.hasLineType=function(){return null!=t.Message.getField(this,6)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.RenderAnnotation.GradientLine.prototype.toObject=function(e){return proto.mediapipe.RenderAnnotation.GradientLine.toObject(e,this)},proto.mediapipe.RenderAnnotation.GradientLine.toObject=function(e,n){var r,o={xStart:null==(r=t.Message.getOptionalFloatingPointField(n,1))?void 0:r,yStart:null==(r=t.Message.getOptionalFloatingPointField(n,2))?void 0:r,xEnd:null==(r=t.Message.getOptionalFloatingPointField(n,3))?void 0:r,yEnd:null==(r=t.Message.getOptionalFloatingPointField(n,4))?void 0:r,normalized:t.Message.getBooleanFieldWithDefault(n,5,!1),color1:(r=n.getColor1())&&i.Color.toObject(e,r),color2:(r=n.getColor2())&&i.Color.toObject(e,r)};return e&&(o.$jspbMessageInstance=n),o}),proto.mediapipe.RenderAnnotation.GradientLine.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.RenderAnnotation.GradientLine;return proto.mediapipe.RenderAnnotation.GradientLine.deserializeBinaryFromReader(r,n)},proto.mediapipe.RenderAnnotation.GradientLine.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readDouble();e.setXStart(n);break;case 2:n=t.readDouble(),e.setYStart(n);break;case 3:n=t.readDouble(),e.setXEnd(n);break;case 4:n=t.readDouble(),e.setYEnd(n);break;case 5:n=t.readBool(),e.setNormalized(n);break;case 6:n=new i.Color,t.readMessage(n,i.Color.deserializeBinaryFromReader),e.setColor1(n);break;case 7:n=new i.Color,t.readMessage(n,i.Color.deserializeBinaryFromReader),e.setColor2(n);break;default:t.skipField()}return e},proto.mediapipe.RenderAnnotation.GradientLine.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.RenderAnnotation.GradientLine.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.RenderAnnotation.GradientLine.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeDouble(1,r),null!=(r=t.Message.getField(e,2))&&n.writeDouble(2,r),null!=(r=t.Message.getField(e,3))&&n.writeDouble(3,r),null!=(r=t.Message.getField(e,4))&&n.writeDouble(4,r),null!=(r=t.Message.getField(e,5))&&n.writeBool(5,r),null!=(r=e.getColor1())&&n.writeMessage(6,r,i.Color.serializeBinaryToWriter),null!=(r=e.getColor2())&&n.writeMessage(7,r,i.Color.serializeBinaryToWriter)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.getXStart=function(){return t.Message.getFloatingPointFieldWithDefault(this,1,0)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.setXStart=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.clearXStart=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.hasXStart=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.getYStart=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,0)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.setYStart=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.clearYStart=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.hasYStart=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.getXEnd=function(){return t.Message.getFloatingPointFieldWithDefault(this,3,0)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.setXEnd=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.clearXEnd=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.hasXEnd=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.getYEnd=function(){return t.Message.getFloatingPointFieldWithDefault(this,4,0)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.setYEnd=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.clearYEnd=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.hasYEnd=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.getNormalized=function(){return t.Message.getBooleanFieldWithDefault(this,5,!1)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.setNormalized=function(e){return t.Message.setField(this,5,e)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.clearNormalized=function(){return t.Message.setField(this,5,void 0)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.hasNormalized=function(){return null!=t.Message.getField(this,5)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.getColor1=function(){return t.Message.getWrapperField(this,i.Color,6)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.setColor1=function(e){return t.Message.setWrapperField(this,6,e)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.clearColor1=function(){return this.setColor1(void 0)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.hasColor1=function(){return null!=t.Message.getField(this,6)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.getColor2=function(){return t.Message.getWrapperField(this,i.Color,7)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.setColor2=function(e){return t.Message.setWrapperField(this,7,e)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.clearColor2=function(){return this.setColor2(void 0)},proto.mediapipe.RenderAnnotation.GradientLine.prototype.hasColor2=function(){return null!=t.Message.getField(this,7)},proto.mediapipe.RenderAnnotation.Scribble.repeatedFields_=[1],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.RenderAnnotation.Scribble.prototype.toObject=function(e){return proto.mediapipe.RenderAnnotation.Scribble.toObject(e,this)},proto.mediapipe.RenderAnnotation.Scribble.toObject=function(e,n){var r={pointList:t.Message.toObjectList(n.getPointList(),proto.mediapipe.RenderAnnotation.Point.toObject,e)};return e&&(r.$jspbMessageInstance=n),r}),proto.mediapipe.RenderAnnotation.Scribble.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.RenderAnnotation.Scribble;return proto.mediapipe.RenderAnnotation.Scribble.deserializeBinaryFromReader(r,n)},proto.mediapipe.RenderAnnotation.Scribble.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)if(1===t.getFieldNumber()){var n=new proto.mediapipe.RenderAnnotation.Point;t.readMessage(n,proto.mediapipe.RenderAnnotation.Point.deserializeBinaryFromReader),e.addPoint(n)}else t.skipField();return e},proto.mediapipe.RenderAnnotation.Scribble.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.RenderAnnotation.Scribble.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.RenderAnnotation.Scribble.serializeBinaryToWriter=function(e,t){var n;(n=e.getPointList()).length>0&&t.writeRepeatedMessage(1,n,proto.mediapipe.RenderAnnotation.Point.serializeBinaryToWriter)},proto.mediapipe.RenderAnnotation.Scribble.prototype.getPointList=function(){return t.Message.getRepeatedWrapperField(this,proto.mediapipe.RenderAnnotation.Point,1)},proto.mediapipe.RenderAnnotation.Scribble.prototype.setPointList=function(e){return t.Message.setRepeatedWrapperField(this,1,e)},proto.mediapipe.RenderAnnotation.Scribble.prototype.addPoint=function(e,n){return t.Message.addToRepeatedWrapperField(this,1,e,proto.mediapipe.RenderAnnotation.Point,n)},proto.mediapipe.RenderAnnotation.Scribble.prototype.clearPointList=function(){return this.setPointList([])},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.RenderAnnotation.Arrow.prototype.toObject=function(e){return proto.mediapipe.RenderAnnotation.Arrow.toObject(e,this)},proto.mediapipe.RenderAnnotation.Arrow.toObject=function(e,n){var r,i={xStart:null==(r=t.Message.getOptionalFloatingPointField(n,1))?void 0:r,yStart:null==(r=t.Message.getOptionalFloatingPointField(n,2))?void 0:r,xEnd:null==(r=t.Message.getOptionalFloatingPointField(n,3))?void 0:r,yEnd:null==(r=t.Message.getOptionalFloatingPointField(n,4))?void 0:r,normalized:t.Message.getBooleanFieldWithDefault(n,5,!1)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.RenderAnnotation.Arrow.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.RenderAnnotation.Arrow;return proto.mediapipe.RenderAnnotation.Arrow.deserializeBinaryFromReader(r,n)},proto.mediapipe.RenderAnnotation.Arrow.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readDouble();e.setXStart(n);break;case 2:n=t.readDouble(),e.setYStart(n);break;case 3:n=t.readDouble(),e.setXEnd(n);break;case 4:n=t.readDouble(),e.setYEnd(n);break;case 5:n=t.readBool(),e.setNormalized(n);break;default:t.skipField()}return e},proto.mediapipe.RenderAnnotation.Arrow.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.RenderAnnotation.Arrow.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.RenderAnnotation.Arrow.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeDouble(1,r),null!=(r=t.Message.getField(e,2))&&n.writeDouble(2,r),null!=(r=t.Message.getField(e,3))&&n.writeDouble(3,r),null!=(r=t.Message.getField(e,4))&&n.writeDouble(4,r),null!=(r=t.Message.getField(e,5))&&n.writeBool(5,r)},proto.mediapipe.RenderAnnotation.Arrow.prototype.getXStart=function(){return t.Message.getFloatingPointFieldWithDefault(this,1,0)},proto.mediapipe.RenderAnnotation.Arrow.prototype.setXStart=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.RenderAnnotation.Arrow.prototype.clearXStart=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.RenderAnnotation.Arrow.prototype.hasXStart=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.RenderAnnotation.Arrow.prototype.getYStart=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,0)},proto.mediapipe.RenderAnnotation.Arrow.prototype.setYStart=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.RenderAnnotation.Arrow.prototype.clearYStart=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.RenderAnnotation.Arrow.prototype.hasYStart=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.RenderAnnotation.Arrow.prototype.getXEnd=function(){return t.Message.getFloatingPointFieldWithDefault(this,3,0)},proto.mediapipe.RenderAnnotation.Arrow.prototype.setXEnd=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.RenderAnnotation.Arrow.prototype.clearXEnd=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.RenderAnnotation.Arrow.prototype.hasXEnd=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.RenderAnnotation.Arrow.prototype.getYEnd=function(){return t.Message.getFloatingPointFieldWithDefault(this,4,0)},proto.mediapipe.RenderAnnotation.Arrow.prototype.setYEnd=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.RenderAnnotation.Arrow.prototype.clearYEnd=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.RenderAnnotation.Arrow.prototype.hasYEnd=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.RenderAnnotation.Arrow.prototype.getNormalized=function(){return t.Message.getBooleanFieldWithDefault(this,5,!1)},proto.mediapipe.RenderAnnotation.Arrow.prototype.setNormalized=function(e){return t.Message.setField(this,5,e)},proto.mediapipe.RenderAnnotation.Arrow.prototype.clearNormalized=function(){return t.Message.setField(this,5,void 0)},proto.mediapipe.RenderAnnotation.Arrow.prototype.hasNormalized=function(){return null!=t.Message.getField(this,5)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.RenderAnnotation.Text.prototype.toObject=function(e){return proto.mediapipe.RenderAnnotation.Text.toObject(e,this)},proto.mediapipe.RenderAnnotation.Text.toObject=function(e,n){var r,o={displayText:null==(r=t.Message.getField(n,1))?void 0:r,left:null==(r=t.Message.getOptionalFloatingPointField(n,2))?void 0:r,baseline:null==(r=t.Message.getOptionalFloatingPointField(n,3))?void 0:r,fontHeight:t.Message.getFloatingPointFieldWithDefault(n,4,8),normalized:t.Message.getBooleanFieldWithDefault(n,5,!1),fontFace:t.Message.getFieldWithDefault(n,6,0),centerHorizontally:t.Message.getBooleanFieldWithDefault(n,7,!1),centerVertically:t.Message.getBooleanFieldWithDefault(n,8,!1),outlineThickness:t.Message.getFloatingPointFieldWithDefault(n,11,0),outlineColor:(r=n.getOutlineColor())&&i.Color.toObject(e,r)};return e&&(o.$jspbMessageInstance=n),o}),proto.mediapipe.RenderAnnotation.Text.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.RenderAnnotation.Text;return proto.mediapipe.RenderAnnotation.Text.deserializeBinaryFromReader(r,n)},proto.mediapipe.RenderAnnotation.Text.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.setDisplayText(n);break;case 2:n=t.readDouble(),e.setLeft(n);break;case 3:n=t.readDouble(),e.setBaseline(n);break;case 4:n=t.readDouble(),e.setFontHeight(n);break;case 5:n=t.readBool(),e.setNormalized(n);break;case 6:n=t.readInt32(),e.setFontFace(n);break;case 7:n=t.readBool(),e.setCenterHorizontally(n);break;case 8:n=t.readBool(),e.setCenterVertically(n);break;case 11:n=t.readDouble(),e.setOutlineThickness(n);break;case 12:n=new i.Color,t.readMessage(n,i.Color.deserializeBinaryFromReader),e.setOutlineColor(n);break;default:t.skipField()}return e},proto.mediapipe.RenderAnnotation.Text.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.RenderAnnotation.Text.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.RenderAnnotation.Text.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeString(1,r),null!=(r=t.Message.getField(e,2))&&n.writeDouble(2,r),null!=(r=t.Message.getField(e,3))&&n.writeDouble(3,r),null!=(r=t.Message.getField(e,4))&&n.writeDouble(4,r),null!=(r=t.Message.getField(e,5))&&n.writeBool(5,r),null!=(r=t.Message.getField(e,6))&&n.writeInt32(6,r),null!=(r=t.Message.getField(e,7))&&n.writeBool(7,r),null!=(r=t.Message.getField(e,8))&&n.writeBool(8,r),null!=(r=t.Message.getField(e,11))&&n.writeDouble(11,r),null!=(r=e.getOutlineColor())&&n.writeMessage(12,r,i.Color.serializeBinaryToWriter)},proto.mediapipe.RenderAnnotation.Text.prototype.getDisplayText=function(){return t.Message.getFieldWithDefault(this,1,"")},proto.mediapipe.RenderAnnotation.Text.prototype.setDisplayText=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.RenderAnnotation.Text.prototype.clearDisplayText=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.RenderAnnotation.Text.prototype.hasDisplayText=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.RenderAnnotation.Text.prototype.getLeft=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,0)},proto.mediapipe.RenderAnnotation.Text.prototype.setLeft=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.RenderAnnotation.Text.prototype.clearLeft=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.RenderAnnotation.Text.prototype.hasLeft=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.RenderAnnotation.Text.prototype.getBaseline=function(){return t.Message.getFloatingPointFieldWithDefault(this,3,0)},proto.mediapipe.RenderAnnotation.Text.prototype.setBaseline=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.RenderAnnotation.Text.prototype.clearBaseline=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.RenderAnnotation.Text.prototype.hasBaseline=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.RenderAnnotation.Text.prototype.getFontHeight=function(){return t.Message.getFloatingPointFieldWithDefault(this,4,8)},proto.mediapipe.RenderAnnotation.Text.prototype.setFontHeight=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.RenderAnnotation.Text.prototype.clearFontHeight=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.RenderAnnotation.Text.prototype.hasFontHeight=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.RenderAnnotation.Text.prototype.getNormalized=function(){return t.Message.getBooleanFieldWithDefault(this,5,!1)},proto.mediapipe.RenderAnnotation.Text.prototype.setNormalized=function(e){return t.Message.setField(this,5,e)},proto.mediapipe.RenderAnnotation.Text.prototype.clearNormalized=function(){return t.Message.setField(this,5,void 0)},proto.mediapipe.RenderAnnotation.Text.prototype.hasNormalized=function(){return null!=t.Message.getField(this,5)},proto.mediapipe.RenderAnnotation.Text.prototype.getFontFace=function(){return t.Message.getFieldWithDefault(this,6,0)},proto.mediapipe.RenderAnnotation.Text.prototype.setFontFace=function(e){return t.Message.setField(this,6,e)},proto.mediapipe.RenderAnnotation.Text.prototype.clearFontFace=function(){return t.Message.setField(this,6,void 0)},proto.mediapipe.RenderAnnotation.Text.prototype.hasFontFace=function(){return null!=t.Message.getField(this,6)},proto.mediapipe.RenderAnnotation.Text.prototype.getCenterHorizontally=function(){return t.Message.getBooleanFieldWithDefault(this,7,!1)},proto.mediapipe.RenderAnnotation.Text.prototype.setCenterHorizontally=function(e){return t.Message.setField(this,7,e)},proto.mediapipe.RenderAnnotation.Text.prototype.clearCenterHorizontally=function(){return t.Message.setField(this,7,void 0)},proto.mediapipe.RenderAnnotation.Text.prototype.hasCenterHorizontally=function(){return null!=t.Message.getField(this,7)},proto.mediapipe.RenderAnnotation.Text.prototype.getCenterVertically=function(){return t.Message.getBooleanFieldWithDefault(this,8,!1)},proto.mediapipe.RenderAnnotation.Text.prototype.setCenterVertically=function(e){return t.Message.setField(this,8,e)},proto.mediapipe.RenderAnnotation.Text.prototype.clearCenterVertically=function(){return t.Message.setField(this,8,void 0)},proto.mediapipe.RenderAnnotation.Text.prototype.hasCenterVertically=function(){return null!=t.Message.getField(this,8)},proto.mediapipe.RenderAnnotation.Text.prototype.getOutlineThickness=function(){return t.Message.getFloatingPointFieldWithDefault(this,11,0)},proto.mediapipe.RenderAnnotation.Text.prototype.setOutlineThickness=function(e){return t.Message.setField(this,11,e)},proto.mediapipe.RenderAnnotation.Text.prototype.clearOutlineThickness=function(){return t.Message.setField(this,11,void 0)},proto.mediapipe.RenderAnnotation.Text.prototype.hasOutlineThickness=function(){return null!=t.Message.getField(this,11)},proto.mediapipe.RenderAnnotation.Text.prototype.getOutlineColor=function(){return t.Message.getWrapperField(this,i.Color,12)},proto.mediapipe.RenderAnnotation.Text.prototype.setOutlineColor=function(e){return t.Message.setWrapperField(this,12,e)},proto.mediapipe.RenderAnnotation.Text.prototype.clearOutlineColor=function(){return this.setOutlineColor(void 0)},proto.mediapipe.RenderAnnotation.Text.prototype.hasOutlineColor=function(){return null!=t.Message.getField(this,12)},proto.mediapipe.RenderAnnotation.prototype.getRectangle=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.Rectangle,1)},proto.mediapipe.RenderAnnotation.prototype.setRectangle=function(e){return t.Message.setOneofWrapperField(this,1,proto.mediapipe.RenderAnnotation.oneofGroups_[0],e)},proto.mediapipe.RenderAnnotation.prototype.clearRectangle=function(){return this.setRectangle(void 0)},proto.mediapipe.RenderAnnotation.prototype.hasRectangle=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.RenderAnnotation.prototype.getFilledRectangle=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.FilledRectangle,2)},proto.mediapipe.RenderAnnotation.prototype.setFilledRectangle=function(e){return t.Message.setOneofWrapperField(this,2,proto.mediapipe.RenderAnnotation.oneofGroups_[0],e)},proto.mediapipe.RenderAnnotation.prototype.clearFilledRectangle=function(){return this.setFilledRectangle(void 0)},proto.mediapipe.RenderAnnotation.prototype.hasFilledRectangle=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.RenderAnnotation.prototype.getOval=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.Oval,3)},proto.mediapipe.RenderAnnotation.prototype.setOval=function(e){return t.Message.setOneofWrapperField(this,3,proto.mediapipe.RenderAnnotation.oneofGroups_[0],e)},proto.mediapipe.RenderAnnotation.prototype.clearOval=function(){return this.setOval(void 0)},proto.mediapipe.RenderAnnotation.prototype.hasOval=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.RenderAnnotation.prototype.getFilledOval=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.FilledOval,4)},proto.mediapipe.RenderAnnotation.prototype.setFilledOval=function(e){return t.Message.setOneofWrapperField(this,4,proto.mediapipe.RenderAnnotation.oneofGroups_[0],e)},proto.mediapipe.RenderAnnotation.prototype.clearFilledOval=function(){return this.setFilledOval(void 0)},proto.mediapipe.RenderAnnotation.prototype.hasFilledOval=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.RenderAnnotation.prototype.getPoint=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.Point,5)},proto.mediapipe.RenderAnnotation.prototype.setPoint=function(e){return t.Message.setOneofWrapperField(this,5,proto.mediapipe.RenderAnnotation.oneofGroups_[0],e)},proto.mediapipe.RenderAnnotation.prototype.clearPoint=function(){return this.setPoint(void 0)},proto.mediapipe.RenderAnnotation.prototype.hasPoint=function(){return null!=t.Message.getField(this,5)},proto.mediapipe.RenderAnnotation.prototype.getLine=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.Line,6)},proto.mediapipe.RenderAnnotation.prototype.setLine=function(e){return t.Message.setOneofWrapperField(this,6,proto.mediapipe.RenderAnnotation.oneofGroups_[0],e)},proto.mediapipe.RenderAnnotation.prototype.clearLine=function(){return this.setLine(void 0)},proto.mediapipe.RenderAnnotation.prototype.hasLine=function(){return null!=t.Message.getField(this,6)},proto.mediapipe.RenderAnnotation.prototype.getArrow=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.Arrow,7)},proto.mediapipe.RenderAnnotation.prototype.setArrow=function(e){return t.Message.setOneofWrapperField(this,7,proto.mediapipe.RenderAnnotation.oneofGroups_[0],e)},proto.mediapipe.RenderAnnotation.prototype.clearArrow=function(){return this.setArrow(void 0)},proto.mediapipe.RenderAnnotation.prototype.hasArrow=function(){return null!=t.Message.getField(this,7)},proto.mediapipe.RenderAnnotation.prototype.getText=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.Text,8)},proto.mediapipe.RenderAnnotation.prototype.setText=function(e){return t.Message.setOneofWrapperField(this,8,proto.mediapipe.RenderAnnotation.oneofGroups_[0],e)},proto.mediapipe.RenderAnnotation.prototype.clearText=function(){return this.setText(void 0)},proto.mediapipe.RenderAnnotation.prototype.hasText=function(){return null!=t.Message.getField(this,8)},proto.mediapipe.RenderAnnotation.prototype.getRoundedRectangle=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.RoundedRectangle,9)},proto.mediapipe.RenderAnnotation.prototype.setRoundedRectangle=function(e){return t.Message.setOneofWrapperField(this,9,proto.mediapipe.RenderAnnotation.oneofGroups_[0],e)},proto.mediapipe.RenderAnnotation.prototype.clearRoundedRectangle=function(){return this.setRoundedRectangle(void 0)},proto.mediapipe.RenderAnnotation.prototype.hasRoundedRectangle=function(){return null!=t.Message.getField(this,9)},proto.mediapipe.RenderAnnotation.prototype.getFilledRoundedRectangle=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.FilledRoundedRectangle,10)},proto.mediapipe.RenderAnnotation.prototype.setFilledRoundedRectangle=function(e){return t.Message.setOneofWrapperField(this,10,proto.mediapipe.RenderAnnotation.oneofGroups_[0],e)},proto.mediapipe.RenderAnnotation.prototype.clearFilledRoundedRectangle=function(){return this.setFilledRoundedRectangle(void 0)},proto.mediapipe.RenderAnnotation.prototype.hasFilledRoundedRectangle=function(){return null!=t.Message.getField(this,10)},proto.mediapipe.RenderAnnotation.prototype.getGradientLine=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.GradientLine,14)},proto.mediapipe.RenderAnnotation.prototype.setGradientLine=function(e){return t.Message.setOneofWrapperField(this,14,proto.mediapipe.RenderAnnotation.oneofGroups_[0],e)},proto.mediapipe.RenderAnnotation.prototype.clearGradientLine=function(){return this.setGradientLine(void 0)},proto.mediapipe.RenderAnnotation.prototype.hasGradientLine=function(){return null!=t.Message.getField(this,14)},proto.mediapipe.RenderAnnotation.prototype.getScribble=function(){return t.Message.getWrapperField(this,proto.mediapipe.RenderAnnotation.Scribble,15)},proto.mediapipe.RenderAnnotation.prototype.setScribble=function(e){return t.Message.setOneofWrapperField(this,15,proto.mediapipe.RenderAnnotation.oneofGroups_[0],e)},proto.mediapipe.RenderAnnotation.prototype.clearScribble=function(){return this.setScribble(void 0)},proto.mediapipe.RenderAnnotation.prototype.hasScribble=function(){return null!=t.Message.getField(this,15)},proto.mediapipe.RenderAnnotation.prototype.getThickness=function(){return t.Message.getFloatingPointFieldWithDefault(this,11,1)},proto.mediapipe.RenderAnnotation.prototype.setThickness=function(e){return t.Message.setField(this,11,e)},proto.mediapipe.RenderAnnotation.prototype.clearThickness=function(){return t.Message.setField(this,11,void 0)},proto.mediapipe.RenderAnnotation.prototype.hasThickness=function(){return null!=t.Message.getField(this,11)},proto.mediapipe.RenderAnnotation.prototype.getColor=function(){return t.Message.getWrapperField(this,i.Color,12)},proto.mediapipe.RenderAnnotation.prototype.setColor=function(e){return t.Message.setWrapperField(this,12,e)},proto.mediapipe.RenderAnnotation.prototype.clearColor=function(){return this.setColor(void 0)},proto.mediapipe.RenderAnnotation.prototype.hasColor=function(){return null!=t.Message.getField(this,12)},proto.mediapipe.RenderAnnotation.prototype.getSceneTag=function(){return t.Message.getFieldWithDefault(this,13,"")},proto.mediapipe.RenderAnnotation.prototype.setSceneTag=function(e){return t.Message.setField(this,13,e)},proto.mediapipe.RenderAnnotation.prototype.clearSceneTag=function(){return t.Message.setField(this,13,void 0)},proto.mediapipe.RenderAnnotation.prototype.hasSceneTag=function(){return null!=t.Message.getField(this,13)},t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.RenderViewport.prototype.toObject=function(e){return proto.mediapipe.RenderViewport.toObject(e,this)},proto.mediapipe.RenderViewport.toObject=function(e,n){var r,i={id:null==(r=t.Message.getField(n,1))?void 0:r,widthPx:null==(r=t.Message.getField(n,2))?void 0:r,heightPx:null==(r=t.Message.getField(n,3))?void 0:r,composeOnVideo:null==(r=t.Message.getBooleanField(n,4))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.RenderViewport.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.RenderViewport;return proto.mediapipe.RenderViewport.deserializeBinaryFromReader(r,n)},proto.mediapipe.RenderViewport.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=t.readString();e.setId(n);break;case 2:n=t.readInt32(),e.setWidthPx(n);break;case 3:n=t.readInt32(),e.setHeightPx(n);break;case 4:n=t.readBool(),e.setComposeOnVideo(n);break;default:t.skipField()}return e},proto.mediapipe.RenderViewport.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.RenderViewport.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.RenderViewport.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=t.Message.getField(e,1))&&n.writeString(1,r),null!=(r=t.Message.getField(e,2))&&n.writeInt32(2,r),null!=(r=t.Message.getField(e,3))&&n.writeInt32(3,r),null!=(r=t.Message.getField(e,4))&&n.writeBool(4,r)},proto.mediapipe.RenderViewport.prototype.getId=function(){return t.Message.getFieldWithDefault(this,1,"")},proto.mediapipe.RenderViewport.prototype.setId=function(e){return t.Message.setField(this,1,e)},proto.mediapipe.RenderViewport.prototype.clearId=function(){return t.Message.setField(this,1,void 0)},proto.mediapipe.RenderViewport.prototype.hasId=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.RenderViewport.prototype.getWidthPx=function(){return t.Message.getFieldWithDefault(this,2,0)},proto.mediapipe.RenderViewport.prototype.setWidthPx=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.RenderViewport.prototype.clearWidthPx=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.RenderViewport.prototype.hasWidthPx=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.RenderViewport.prototype.getHeightPx=function(){return t.Message.getFieldWithDefault(this,3,0)},proto.mediapipe.RenderViewport.prototype.setHeightPx=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.RenderViewport.prototype.clearHeightPx=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.RenderViewport.prototype.hasHeightPx=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.RenderViewport.prototype.getComposeOnVideo=function(){return t.Message.getBooleanFieldWithDefault(this,4,!1)},proto.mediapipe.RenderViewport.prototype.setComposeOnVideo=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.RenderViewport.prototype.clearComposeOnVideo=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.RenderViewport.prototype.hasComposeOnVideo=function(){return null!=t.Message.getField(this,4)},n.object.extend(e,proto.mediapipe)}(render_data_pb);var interactive_segmenter_result={};Object.defineProperty(interactive_segmenter_result,"__esModule",{value:!0}),interactive_segmenter_result.InteractiveSegmenterResult=void 0;class InteractiveSegmenterResult{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;null===(e=this.confidenceMasks)||void 0===e||e.forEach((e=>{e.close()})),null===(t=this.categoryMask)||void 0===t||t.close()}}interactive_segmenter_result.InteractiveSegmenterResult=InteractiveSegmenterResult;var interactive_segmenter_options={};Object.defineProperty(interactive_segmenter_options,"__esModule",{value:!0}),function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.InteractiveSegmenter=void 0;const r=calculator_pb,i=calculator_options_pb,o=base_options_pb,a=image_segmenter_graph_options_pb,s=segmenter_options_pb,u=vision_task_runner,l=color_pb,c=render_data_pb,p=interactive_segmenter_result;n(interactive_segmenter_options,e),n(interactive_segmenter_result,e);const d="image_in",h="norm_rect_in",f="roi_in",g="confidence_masks",m="category_mask",y="quality_scores";class b extends u.VisionTaskRunner{static createFromOptions(e,t){return u.VisionTaskRunner.createVisionInstance(b,e,t)}static createFromModelBuffer(e,t){return u.VisionTaskRunner.createVisionInstance(b,e,{baseOptions:{modelAssetBuffer:t}})}static createFromModelPath(e,t){return u.VisionTaskRunner.createVisionInstance(b,e,{baseOptions:{modelAssetPath:t}})}constructor(e,t){super(new u.VisionGraphRunner(e,t),d,h,!1),this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.options=new a.ImageSegmenterGraphOptions,this.segmenterOptions=new s.SegmenterOptions,this.options.setSegmenterOptions(this.segmenterOptions),this.options.setBaseOptions(new o.BaseOptions)}get baseOptions(){return this.options.getBaseOptions()}set baseOptions(e){this.options.setBaseOptions(e)}setOptions(e){var t,n;return"outputCategoryMask"in e&&(this.outputCategoryMask=null!==(t=e.outputCategoryMask)&&void 0!==t&&t),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=null===(n=e.outputConfidenceMasks)||void 0===n||n),super.applyOptions(e)}segment(e,t,n,r){const i="function"!=typeof n?n:{};return this.userCallback="function"==typeof n?n:r,this.reset(),this.processRenderData(t,this.getSynctheticTimestamp()),this.processImageData(e,i),this.processResults()}reset(){this.confidenceMasks=void 0,this.categoryMask=void 0,this.qualityScores=void 0}processResults(){try{const e=new p.InteractiveSegmenterResult(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.userCallback)return e;this.userCallback(e)}finally{this.freeKeepaliveStreams()}}refreshGraph(){const e=new r.CalculatorGraphConfig;e.addInputStream(d),e.addInputStream(f),e.addInputStream(h);const t=new i.CalculatorOptions;t.setExtension(a.ImageSegmenterGraphOptions.ext,this.options);const n=new r.CalculatorGraphConfig.Node;n.setCalculator("mediapipe.tasks.vision.interactive_segmenter.InteractiveSegmenterGraph"),n.addInputStream("IMAGE:"+d),n.addInputStream("ROI:"+f),n.addInputStream("NORM_RECT:"+h),n.setOptions(t),e.addNode(n),this.addKeepaliveNode(e),this.outputConfidenceMasks&&(e.addOutputStream(g),n.addOutputStream("CONFIDENCE_MASKS:"+g),this.keepStreamAlive(g),this.graphRunner.attachImageVectorListener(g,((e,t)=>{this.confidenceMasks=e.map((e=>this.convertToMPMask(e,!this.userCallback))),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(g,(e=>{this.confidenceMasks=[],this.setLatestOutputTimestamp(e)}))),this.outputCategoryMask&&(e.addOutputStream(m),n.addOutputStream("CATEGORY_MASK:"+m),this.keepStreamAlive(m),this.graphRunner.attachImageListener(m,((e,t)=>{this.categoryMask=this.convertToMPMask(e,!this.userCallback),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(m,(e=>{this.categoryMask=void 0,this.setLatestOutputTimestamp(e)}))),e.addOutputStream(y),n.addOutputStream("QUALITY_SCORES:"+y),this.graphRunner.attachFloatVectorListener(y,((e,t)=>{this.qualityScores=e,this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(y,(e=>{this.categoryMask=void 0,this.setLatestOutputTimestamp(e)}));const o=e.serializeBinary();this.setGraph(new Uint8Array(o),!0)}processRenderData(e,t){const n=new c.RenderData,r=new c.RenderAnnotation,i=new l.Color;if(i.setR(255),r.setColor(i),e.keypoint&&e.scribble)throw new Error("Cannot provide both keypoint and scribble.");if(e.keypoint){const t=new c.RenderAnnotation.Point;t.setNormalized(!0),t.setX(e.keypoint.x),t.setY(e.keypoint.y),r.setPoint(t)}else{if(!e.scribble)throw new Error("Must provide either a keypoint or a scribble.");{const t=new c.RenderAnnotation.Scribble;for(const n of e.scribble){const e=new c.RenderAnnotation.Point;e.setNormalized(!0),e.setX(n.x),e.setY(n.y),t.addPoint(e)}r.setScribble(t)}}n.addRenderAnnotations(r),this.graphRunner.addProtoToStream(n.serializeBinary(),"drishti.RenderData",f,t)}}e.InteractiveSegmenter=b}(interactive_segmenter);var object_detector={},object_detector_options_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=base_options_pb;n.object.extend(proto,a),n.exportSymbol("proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions",null,r),proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions=function(e){t.Message.initialize(this,e,0,-1,proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.repeatedFields_,null)},n.inherits(proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.displayName="proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions"),proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.repeatedFields_=[5,6],t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.toObject(e,this)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.toObject=function(e,n){var r,i={baseOptions:(r=n.getBaseOptions())&&a.BaseOptions.toObject(e,r),displayNamesLocale:t.Message.getFieldWithDefault(n,2,"en"),maxResults:t.Message.getFieldWithDefault(n,3,-1),scoreThreshold:null==(r=t.Message.getOptionalFloatingPointField(n,4))?void 0:r,categoryAllowlistList:null==(r=t.Message.getRepeatedField(n,5))?void 0:r,categoryDenylistList:null==(r=t.Message.getRepeatedField(n,6))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions;return proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new a.BaseOptions;t.readMessage(n,a.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=t.readString(),e.setDisplayNamesLocale(n);break;case 3:n=t.readInt32(),e.setMaxResults(n);break;case 4:n=t.readFloat(),e.setScoreThreshold(n);break;case 5:n=t.readString(),e.addCategoryAllowlist(n);break;case 6:n=t.readString(),e.addCategoryDenylist(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getBaseOptions())&&n.writeMessage(1,r,a.BaseOptions.serializeBinaryToWriter),null!=(r=t.Message.getField(e,2))&&n.writeString(2,r),null!=(r=t.Message.getField(e,3))&&n.writeInt32(3,r),null!=(r=t.Message.getField(e,4))&&n.writeFloat(4,r),(r=e.getCategoryAllowlistList()).length>0&&n.writeRepeatedString(5,r),(r=e.getCategoryDenylistList()).length>0&&n.writeRepeatedString(6,r)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.ext=new t.ExtensionFieldInfo(443442058,{ext:0},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions,proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.toObject,0),o.CalculatorOptions.extensionsBinary[443442058]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[443442058]=proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.ext,proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,a.BaseOptions,1)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.getDisplayNamesLocale=function(){return t.Message.getFieldWithDefault(this,2,"en")},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.setDisplayNamesLocale=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.clearDisplayNamesLocale=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.hasDisplayNamesLocale=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.getMaxResults=function(){return t.Message.getFieldWithDefault(this,3,-1)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.setMaxResults=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.clearMaxResults=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.hasMaxResults=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.getScoreThreshold=function(){return t.Message.getFloatingPointFieldWithDefault(this,4,0)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.setScoreThreshold=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.clearScoreThreshold=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.hasScoreThreshold=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.getCategoryAllowlistList=function(){return t.Message.getRepeatedField(this,5)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.setCategoryAllowlistList=function(e){return t.Message.setField(this,5,e||[])},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.addCategoryAllowlist=function(e,n){return t.Message.addToRepeatedField(this,5,e,n)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.clearCategoryAllowlistList=function(){return this.setCategoryAllowlistList([])},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.getCategoryDenylistList=function(){return t.Message.getRepeatedField(this,6)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.setCategoryDenylistList=function(e){return t.Message.setField(this,6,e||[])},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.addCategoryDenylist=function(e,n){return t.Message.addToRepeatedField(this,6,e,n)},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.prototype.clearCategoryDenylistList=function(){return this.setCategoryDenylistList([])},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.ext=new t.ExtensionFieldInfo(443442058,{ext:0},proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions,proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.toObject,0),o.CalculatorOptions.extensionsBinary[443442058]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[443442058]=proto.mediapipe.tasks.vision.object_detector.proto.ObjectDetectorOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.object_detector.proto)}(object_detector_options_pb);var object_detector_options={};Object.defineProperty(object_detector_options,"__esModule",{value:!0});var object_detector_result={};Object.defineProperty(object_detector_result,"__esModule",{value:!0}),function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.ObjectDetector=void 0;const r=calculator_pb,i=calculator_options_pb,o=detection_pb,a=base_options_pb,s=object_detector_options_pb,u=detection_result,l=vision_task_runner,c="input_frame_gpu",p="norm_rect",d="detections";n(object_detector_options,e),n(object_detector_result,e);class h extends l.VisionTaskRunner{static createFromOptions(e,t){return l.VisionTaskRunner.createVisionInstance(h,e,t)}static createFromModelBuffer(e,t){return l.VisionTaskRunner.createVisionInstance(h,e,{baseOptions:{modelAssetBuffer:t}})}static async createFromModelPath(e,t){return l.VisionTaskRunner.createVisionInstance(h,e,{baseOptions:{modelAssetPath:t}})}constructor(e,t){super(new l.VisionGraphRunner(e,t),c,p,!1),this.result={detections:[]},this.options=new s.ObjectDetectorOptions,this.options.setBaseOptions(new a.BaseOptions)}get baseOptions(){return this.options.getBaseOptions()}set baseOptions(e){this.options.setBaseOptions(e)}setOptions(e){return void 0!==e.displayNamesLocale?this.options.setDisplayNamesLocale(e.displayNamesLocale):"displayNamesLocale"in e&&this.options.clearDisplayNamesLocale(),void 0!==e.maxResults?this.options.setMaxResults(e.maxResults):"maxResults"in e&&this.options.clearMaxResults(),void 0!==e.scoreThreshold?this.options.setScoreThreshold(e.scoreThreshold):"scoreThreshold"in e&&this.options.clearScoreThreshold(),void 0!==e.categoryAllowlist?this.options.setCategoryAllowlistList(e.categoryAllowlist):"categoryAllowlist"in e&&this.options.clearCategoryAllowlistList(),void 0!==e.categoryDenylist?this.options.setCategoryDenylistList(e.categoryDenylist):"categoryDenylist"in e&&this.options.clearCategoryDenylistList(),this.applyOptions(e)}detect(e,t){return this.result={detections:[]},this.processImageData(e,t),this.result}detectForVideo(e,t,n){return this.result={detections:[]},this.processVideoData(e,n,t),this.result}addJsObjectDetections(e){for(const t of e){const e=o.Detection.deserializeBinary(t);this.result.detections.push((0,u.convertFromDetectionProto)(e))}}refreshGraph(){const e=new r.CalculatorGraphConfig;e.addInputStream(c),e.addInputStream(p),e.addOutputStream(d);const t=new i.CalculatorOptions;t.setExtension(s.ObjectDetectorOptions.ext,this.options);const n=new r.CalculatorGraphConfig.Node;n.setCalculator("mediapipe.tasks.vision.ObjectDetectorGraph"),n.addInputStream("IMAGE:"+c),n.addInputStream("NORM_RECT:"+p),n.addOutputStream("DETECTIONS:"+d),n.setOptions(t),e.addNode(n),this.graphRunner.attachProtoVectorListener(d,((e,t)=>{this.addJsObjectDetections(e),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(d,(e=>{this.setLatestOutputTimestamp(e)}));const o=e.serializeBinary();this.setGraph(new Uint8Array(o),!0)}}e.ObjectDetector=h}(object_detector);var pose_landmarker={},pose_detector_graph_options_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=base_options_pb;n.object.extend(proto,a),n.exportSymbol("proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions",null,r),proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.displayName="proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.toObject=function(e,n){var r,i={baseOptions:(r=n.getBaseOptions())&&a.BaseOptions.toObject(e,r),minDetectionConfidence:t.Message.getFloatingPointFieldWithDefault(n,2,.5),minSuppressionThreshold:t.Message.getFloatingPointFieldWithDefault(n,3,.5),numPoses:null==(r=t.Message.getField(n,4))?void 0:r};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions;return proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new a.BaseOptions;t.readMessage(n,a.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=t.readFloat(),e.setMinDetectionConfidence(n);break;case 3:n=t.readFloat(),e.setMinSuppressionThreshold(n);break;case 4:n=t.readInt32(),e.setNumPoses(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getBaseOptions())&&n.writeMessage(1,r,a.BaseOptions.serializeBinaryToWriter),null!=(r=t.Message.getField(e,2))&&n.writeFloat(2,r),null!=(r=t.Message.getField(e,3))&&n.writeFloat(3,r),null!=(r=t.Message.getField(e,4))&&n.writeInt32(4,r)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.ext=new t.ExtensionFieldInfo(514774813,{ext:0},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions,proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[514774813]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[514774813]=proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.ext,proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,a.BaseOptions,1)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.getMinDetectionConfidence=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,.5)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.setMinDetectionConfidence=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.clearMinDetectionConfidence=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.hasMinDetectionConfidence=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.getMinSuppressionThreshold=function(){return t.Message.getFloatingPointFieldWithDefault(this,3,.5)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.setMinSuppressionThreshold=function(e){return t.Message.setField(this,3,e)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.clearMinSuppressionThreshold=function(){return t.Message.setField(this,3,void 0)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.hasMinSuppressionThreshold=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.getNumPoses=function(){return t.Message.getFieldWithDefault(this,4,0)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.setNumPoses=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.clearNumPoses=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.prototype.hasNumPoses=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.ext=new t.ExtensionFieldInfo(514774813,{ext:0},proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions,proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[514774813]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[514774813]=proto.mediapipe.tasks.vision.pose_detector.proto.PoseDetectorGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.pose_detector.proto)}(pose_detector_graph_options_pb);var pose_landmarker_graph_options_pb={},pose_landmarks_detector_graph_options_pb={};!function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=base_options_pb;n.object.extend(proto,a),n.exportSymbol("proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions",null,r),proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.displayName="proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.toObject=function(e,n){var r,i={baseOptions:(r=n.getBaseOptions())&&a.BaseOptions.toObject(e,r),minDetectionConfidence:t.Message.getFloatingPointFieldWithDefault(n,2,.5)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions;return proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new a.BaseOptions;t.readMessage(n,a.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=t.readFloat(),e.setMinDetectionConfidence(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getBaseOptions())&&n.writeMessage(1,r,a.BaseOptions.serializeBinaryToWriter),null!=(r=t.Message.getField(e,2))&&n.writeFloat(2,r)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.ext=new t.ExtensionFieldInfo(518928384,{ext:0},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions,proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[518928384]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[518928384]=proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.ext,proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,a.BaseOptions,1)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.prototype.getMinDetectionConfidence=function(){return t.Message.getFloatingPointFieldWithDefault(this,2,.5)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.prototype.setMinDetectionConfidence=function(e){return t.Message.setField(this,2,e)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.prototype.clearMinDetectionConfidence=function(){return t.Message.setField(this,2,void 0)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.prototype.hasMinDetectionConfidence=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.ext=new t.ExtensionFieldInfo(518928384,{ext:0},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions,proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[518928384]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[518928384]=proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarksDetectorGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.pose_landmarker.proto)}(pose_landmarks_detector_graph_options_pb),function(e){var t=googleProtobuf,n=t,r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==r&&r||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")(),i=calculator_pb;n.object.extend(proto,i);var o=calculator_options_pb;n.object.extend(proto,o);var a=base_options_pb;n.object.extend(proto,a);var s=pose_detector_graph_options_pb;n.object.extend(proto,s);var u=pose_landmarks_detector_graph_options_pb;n.object.extend(proto,u),n.exportSymbol("proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions",null,r),proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions=function(e){t.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions,t.Message),n.DEBUG&&!COMPILED&&(proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.displayName="proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions"),t.Message.GENERATE_TO_OBJECT&&(proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.toObject=function(e){return proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.toObject(e,this)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.toObject=function(e,n){var r,i={baseOptions:(r=n.getBaseOptions())&&a.BaseOptions.toObject(e,r),poseDetectorGraphOptions:(r=n.getPoseDetectorGraphOptions())&&s.PoseDetectorGraphOptions.toObject(e,r),poseLandmarksDetectorGraphOptions:(r=n.getPoseLandmarksDetectorGraphOptions())&&u.PoseLandmarksDetectorGraphOptions.toObject(e,r),minTrackingConfidence:t.Message.getFloatingPointFieldWithDefault(n,4,.5)};return e&&(i.$jspbMessageInstance=n),i}),proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.deserializeBinary=function(e){var n=new t.BinaryReader(e),r=new proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions;return proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.deserializeBinaryFromReader(r,n)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();)switch(t.getFieldNumber()){case 1:var n=new a.BaseOptions;t.readMessage(n,a.BaseOptions.deserializeBinaryFromReader),e.setBaseOptions(n);break;case 2:n=new s.PoseDetectorGraphOptions,t.readMessage(n,s.PoseDetectorGraphOptions.deserializeBinaryFromReader),e.setPoseDetectorGraphOptions(n);break;case 3:n=new u.PoseLandmarksDetectorGraphOptions,t.readMessage(n,u.PoseLandmarksDetectorGraphOptions.deserializeBinaryFromReader),e.setPoseLandmarksDetectorGraphOptions(n);break;case 4:n=t.readFloat(),e.setMinTrackingConfidence(n);break;default:t.skipField()}return e},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.serializeBinary=function(){var e=new t.BinaryWriter;return proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.serializeBinaryToWriter=function(e,n){var r=void 0;null!=(r=e.getBaseOptions())&&n.writeMessage(1,r,a.BaseOptions.serializeBinaryToWriter),null!=(r=e.getPoseDetectorGraphOptions())&&n.writeMessage(2,r,s.PoseDetectorGraphOptions.serializeBinaryToWriter),null!=(r=e.getPoseLandmarksDetectorGraphOptions())&&n.writeMessage(3,r,u.PoseLandmarksDetectorGraphOptions.serializeBinaryToWriter),null!=(r=t.Message.getField(e,4))&&n.writeFloat(4,r)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.ext=new t.ExtensionFieldInfo(516587230,{ext:0},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions,proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[516587230]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[516587230]=proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.ext,proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.getBaseOptions=function(){return t.Message.getWrapperField(this,a.BaseOptions,1)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.setBaseOptions=function(e){return t.Message.setWrapperField(this,1,e)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.clearBaseOptions=function(){return this.setBaseOptions(void 0)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.hasBaseOptions=function(){return null!=t.Message.getField(this,1)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.getPoseDetectorGraphOptions=function(){return t.Message.getWrapperField(this,s.PoseDetectorGraphOptions,2)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.setPoseDetectorGraphOptions=function(e){return t.Message.setWrapperField(this,2,e)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.clearPoseDetectorGraphOptions=function(){return this.setPoseDetectorGraphOptions(void 0)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.hasPoseDetectorGraphOptions=function(){return null!=t.Message.getField(this,2)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.getPoseLandmarksDetectorGraphOptions=function(){return t.Message.getWrapperField(this,u.PoseLandmarksDetectorGraphOptions,3)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.setPoseLandmarksDetectorGraphOptions=function(e){return t.Message.setWrapperField(this,3,e)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.clearPoseLandmarksDetectorGraphOptions=function(){return this.setPoseLandmarksDetectorGraphOptions(void 0)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.hasPoseLandmarksDetectorGraphOptions=function(){return null!=t.Message.getField(this,3)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.getMinTrackingConfidence=function(){return t.Message.getFloatingPointFieldWithDefault(this,4,.5)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.setMinTrackingConfidence=function(e){return t.Message.setField(this,4,e)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.clearMinTrackingConfidence=function(){return t.Message.setField(this,4,void 0)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.prototype.hasMinTrackingConfidence=function(){return null!=t.Message.getField(this,4)},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.ext=new t.ExtensionFieldInfo(516587230,{ext:0},proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions,proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.toObject,0),o.CalculatorOptions.extensionsBinary[516587230]=new t.ExtensionFieldBinaryInfo(proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.ext,t.BinaryReader.prototype.readMessage,t.BinaryWriter.prototype.writeMessage,proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.serializeBinaryToWriter,proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.deserializeBinaryFromReader,!1),o.CalculatorOptions.extensions[516587230]=proto.mediapipe.tasks.vision.pose_landmarker.proto.PoseLandmarkerGraphOptions.ext,n.object.extend(e,proto.mediapipe.tasks.vision.pose_landmarker.proto)}(pose_landmarker_graph_options_pb);var pose_landmarker_result={};Object.defineProperty(pose_landmarker_result,"__esModule",{value:!0}),pose_landmarker_result.PoseLandmarkerResult=void 0;class PoseLandmarkerResult{constructor(e,t,n){this.landmarks=e,this.worldLandmarks=t,this.segmentationMasks=n}close(){var e;null===(e=this.segmentationMasks)||void 0===e||e.forEach((e=>{e.close()}))}}pose_landmarker_result.PoseLandmarkerResult=PoseLandmarkerResult;var pose_landmarker_options={};Object.defineProperty(pose_landmarker_options,"__esModule",{value:!0}),function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.PoseLandmarker=void 0;const r=calculator_pb,i=calculator_options_pb,o=landmark_pb,a=base_options_pb,s=pose_detector_graph_options_pb,u=pose_landmarker_graph_options_pb,l=pose_landmarks_detector_graph_options_pb,c=landmark_result,p=vision_task_runner,d=pose_landmarker_result;n(pose_landmarker_options,e),n(pose_landmarker_result,e);const h="image_in",f="norm_rect",g="normalized_landmarks",m="world_landmarks",y="segmentation_masks",b=.5;class v extends p.VisionTaskRunner{static createFromOptions(e,t){return p.VisionTaskRunner.createVisionInstance(v,e,t)}static createFromModelBuffer(e,t){return p.VisionTaskRunner.createVisionInstance(v,e,{baseOptions:{modelAssetBuffer:t}})}static createFromModelPath(e,t){return p.VisionTaskRunner.createVisionInstance(v,e,{baseOptions:{modelAssetPath:t}})}constructor(e,t){super(new p.VisionGraphRunner(e,t),h,f,!1),this.landmarks=[],this.worldLandmarks=[],this.outputSegmentationMasks=!1,this.options=new u.PoseLandmarkerGraphOptions,this.options.setBaseOptions(new a.BaseOptions),this.poseLandmarksDetectorGraphOptions=new l.PoseLandmarksDetectorGraphOptions,this.options.setPoseLandmarksDetectorGraphOptions(this.poseLandmarksDetectorGraphOptions),this.poseDetectorGraphOptions=new s.PoseDetectorGraphOptions,this.options.setPoseDetectorGraphOptions(this.poseDetectorGraphOptions),this.initDefaults()}get baseOptions(){return this.options.getBaseOptions()}set baseOptions(e){this.options.setBaseOptions(e)}setOptions(e){var t,n,r,i,o;return"numPoses"in e&&this.poseDetectorGraphOptions.setNumPoses(null!==(t=e.numPoses)&&void 0!==t?t:1),"minPoseDetectionConfidence"in e&&this.poseDetectorGraphOptions.setMinDetectionConfidence(null!==(n=e.minPoseDetectionConfidence)&&void 0!==n?n:b),"minTrackingConfidence"in e&&this.options.setMinTrackingConfidence(null!==(r=e.minTrackingConfidence)&&void 0!==r?r:b),"minPosePresenceConfidence"in e&&this.poseLandmarksDetectorGraphOptions.setMinDetectionConfidence(null!==(i=e.minPosePresenceConfidence)&&void 0!==i?i:b),"outputSegmentationMasks"in e&&(this.outputSegmentationMasks=null!==(o=e.outputSegmentationMasks)&&void 0!==o&&o),this.applyOptions(e)}detect(e,t,n){const r="function"!=typeof t?t:{};return this.userCallback="function"==typeof t?t:n,this.resetResults(),this.processImageData(e,r),this.processResults()}detectForVideo(e,t,n,r){const i="function"!=typeof n?n:{};return this.userCallback="function"==typeof n?n:r,this.resetResults(),this.processVideoData(e,i,t),this.processResults()}resetResults(){this.landmarks=[],this.worldLandmarks=[],this.segmentationMasks=void 0}processResults(){try{const e=new d.PoseLandmarkerResult(this.landmarks,this.worldLandmarks,this.segmentationMasks);if(!this.userCallback)return e;this.userCallback(e)}finally{this.freeKeepaliveStreams()}}initDefaults(){this.poseDetectorGraphOptions.setNumPoses(1),this.poseDetectorGraphOptions.setMinDetectionConfidence(b),this.poseLandmarksDetectorGraphOptions.setMinDetectionConfidence(b),this.options.setMinTrackingConfidence(b)}addJsLandmarks(e){this.landmarks=[];for(const t of e){const e=o.NormalizedLandmarkList.deserializeBinary(t);this.landmarks.push((0,c.convertToLandmarks)(e))}}adddJsWorldLandmarks(e){this.worldLandmarks=[];for(const t of e){const e=o.LandmarkList.deserializeBinary(t);this.worldLandmarks.push((0,c.convertToWorldLandmarks)(e))}}refreshGraph(){const e=new r.CalculatorGraphConfig;e.addInputStream(h),e.addInputStream(f),e.addOutputStream(g),e.addOutputStream(m),e.addOutputStream(y);const t=new i.CalculatorOptions;t.setExtension(u.PoseLandmarkerGraphOptions.ext,this.options);const n=new r.CalculatorGraphConfig.Node;n.setCalculator("mediapipe.tasks.vision.pose_landmarker.PoseLandmarkerGraph"),n.addInputStream("IMAGE:"+h),n.addInputStream("NORM_RECT:"+f),n.addOutputStream("NORM_LANDMARKS:"+g),n.addOutputStream("WORLD_LANDMARKS:"+m),n.setOptions(t),e.addNode(n),this.addKeepaliveNode(e),this.graphRunner.attachProtoVectorListener(g,((e,t)=>{this.addJsLandmarks(e),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(g,(e=>{this.landmarks=[],this.setLatestOutputTimestamp(e)})),this.graphRunner.attachProtoVectorListener(m,((e,t)=>{this.adddJsWorldLandmarks(e),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(m,(e=>{this.worldLandmarks=[],this.setLatestOutputTimestamp(e)})),this.outputSegmentationMasks&&(n.addOutputStream("SEGMENTATION_MASK:"+y),this.keepStreamAlive(y),this.graphRunner.attachImageVectorListener(y,((e,t)=>{this.segmentationMasks=e.map((e=>this.convertToMPMask(e,!this.userCallback))),this.setLatestOutputTimestamp(t)})),this.graphRunner.attachEmptyPacketListener(y,(e=>{this.segmentationMasks=[],this.setLatestOutputTimestamp(e)})));const o=e.serializeBinary();this.setGraph(new Uint8Array(o),!0)}}e.PoseLandmarker=v,v.POSE_CONNECTIONS=[{start:0,end:1},{start:1,end:2},{start:2,end:3},{start:3,end:7},{start:0,end:4},{start:4,end:5},{start:5,end:6},{start:6,end:8},{start:9,end:10},{start:11,end:12},{start:11,end:13},{start:13,end:15},{start:15,end:17},{start:15,end:19},{start:15,end:21},{start:17,end:19},{start:12,end:14},{start:14,end:16},{start:16,end:18},{start:16,end:20},{start:16,end:22},{start:18,end:20},{start:11,end:23},{start:12,end:24},{start:23,end:24},{start:23,end:25},{start:24,end:26},{start:25,end:27},{start:26,end:28},{start:27,end:29},{start:28,end:30},{start:29,end:31},{start:30,end:32},{start:27,end:31},{start:28,end:32}]}(pose_landmarker),Object.defineProperty(vision,"__esModule",{value:!0});var PoseLandmarker_1=vision.PoseLandmarker=ObjectDetector_1=vision.ObjectDetector=InteractiveSegmenter_1=vision.InteractiveSegmenter=ImageSegmenter_1=vision.ImageSegmenter=ImageEmbedder_1=vision.ImageEmbedder=ImageClassifier_1=vision.ImageClassifier=HandLandmarker_1=vision.HandLandmarker=GestureRecognizer_1=vision.GestureRecognizer=FaceStylizer_1=vision.FaceStylizer=FaceLandmarker_1=vision.FaceLandmarker=FaceDetector_1=vision.FaceDetector=MPMask_1=vision.MPMask=MPImage_1=vision.MPImage=FilesetResolver_1=vision.FilesetResolver=DrawingUtils_1=vision.DrawingUtils=void 0;const fileset_resolver_1=fileset_resolver,drawing_utils_1=drawing_utils,image_1=image,mask_1=mask,face_detector_1=face_detector,face_landmarker_1=face_landmarker,face_stylizer_1=face_stylizer,gesture_recognizer_1=gesture_recognizer,hand_landmarker_1=hand_landmarker,image_classifier_1=image_classifier,image_embedder_1=image_embedder,image_segmenter_1=image_segmenter,interactive_segmenter_1=interactive_segmenter,object_detector_1=object_detector,pose_landmarker_1=pose_landmarker,DrawingUtils=drawing_utils_1.DrawingUtils;var DrawingUtils_1=vision.DrawingUtils=DrawingUtils;const FilesetResolver=fileset_resolver_1.FilesetResolver;var FilesetResolver_1=vision.FilesetResolver=FilesetResolver;const MPImage=image_1.MPImage;var MPImage_1=vision.MPImage=MPImage;const MPMask=mask_1.MPMask;var MPMask_1=vision.MPMask=MPMask;const FaceDetector=face_detector_1.FaceDetector;var FaceDetector_1=vision.FaceDetector=FaceDetector;const FaceLandmarker=face_landmarker_1.FaceLandmarker;var FaceLandmarker_1=vision.FaceLandmarker=FaceLandmarker;const FaceStylizer=face_stylizer_1.FaceStylizer;var FaceStylizer_1=vision.FaceStylizer=FaceStylizer;const GestureRecognizer=gesture_recognizer_1.GestureRecognizer;var GestureRecognizer_1=vision.GestureRecognizer=GestureRecognizer;const HandLandmarker=hand_landmarker_1.HandLandmarker;var HandLandmarker_1=vision.HandLandmarker=HandLandmarker;const ImageClassifier=image_classifier_1.ImageClassifier;var ImageClassifier_1=vision.ImageClassifier=ImageClassifier;const ImageEmbedder=image_embedder_1.ImageEmbedder;var ImageEmbedder_1=vision.ImageEmbedder=ImageEmbedder;const ImageSegmenter=image_segmenter_1.ImageSegmenter;var ImageSegmenter_1=vision.ImageSegmenter=ImageSegmenter;const InteractiveSegmenter=interactive_segmenter_1.InteractiveSegmenter;var InteractiveSegmenter_1=vision.InteractiveSegmenter=InteractiveSegmenter;const ObjectDetector=object_detector_1.ObjectDetector;var ObjectDetector_1=vision.ObjectDetector=ObjectDetector;const PoseLandmarker=pose_landmarker_1.PoseLandmarker;PoseLandmarker_1=vision.PoseLandmarker=PoseLandmarker}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.amdD=function(){throw new Error("define cannot be used indirect")},__webpack_require__.amdO={},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.d(__webpack_exports__,{default:()=>BD});var e={};__webpack_require__.r(e),__webpack_require__.d(e,{maxNorm:()=>po,minMaxNorm:()=>go,nonNeg:()=>fo,unitNorm:()=>ho});var t={};__webpack_require__.r(t),__webpack_require__.d(t,{constant:()=>bo,glorotNormal:()=>Co,glorotUniform:()=>So,heNormal:()=>Mo,heUniform:()=>To,identity:()=>wo,leCunNormal:()=>Eo,leCunUniform:()=>Ao,ones:()=>yo,orthogonal:()=>Fo,randomNormal:()=>xo,randomUniform:()=>vo,truncatedNormal:()=>_o,varianceScaling:()=>ko,zeros:()=>mo});var n={};__webpack_require__.r(n),__webpack_require__.d(n,{Layer:()=>Wi,RNN:()=>Gs,RNNCell:()=>Us,activation:()=>xl,add:()=>Al,alphaDropout:()=>vc,average:()=>Fl,averagePooling1d:()=>$l,averagePooling2d:()=>Gl,averagePooling3d:()=>Vl,avgPool1d:()=>zl,avgPool2d:()=>Ul,avgPool3d:()=>Hl,avgPooling1d:()=>jl,avgPooling2d:()=>Wl,avgPooling3d:()=>ql,batchNormalization:()=>Bl,bidirectional:()=>pc,categoryEncoding:()=>Sc,centerCrop:()=>wc,concatenate:()=>Ol,conv1d:()=>pl,conv2d:()=>dl,conv2dTranspose:()=>hl,conv3d:()=>fl,conv3dTranspose:()=>gl,convLstm2d:()=>sc,convLstm2dCell:()=>uc,cropping2D:()=>yl,dense:()=>_l,depthwiseConv2d:()=>vl,dot:()=>Il,dropout:()=>wl,elu:()=>ol,embedding:()=>El,flatten:()=>Sl,gaussianDropout:()=>bc,gaussianNoise:()=>yc,globalAveragePooling1d:()=>Xl,globalAveragePooling2d:()=>Yl,globalMaxPool1d:()=>hc,globalMaxPool2d:()=>fc,globalMaxPooling1d:()=>Kl,globalMaxPooling2d:()=>Jl,gru:()=>tc,gruCell:()=>nc,input:()=>Ua,inputLayer:()=>il,layerNormalization:()=>Ll,leakyReLU:()=>sl,lstm:()=>rc,lstmCell:()=>ic,masking:()=>xc,maxPool1d:()=>gc,maxPool2d:()=>mc,maxPooling1d:()=>Zl,maxPooling2d:()=>Ql,maxPooling3d:()=>ec,maximum:()=>Rl,minimum:()=>Nl,multiply:()=>Dl,permute:()=>Tl,prelu:()=>ul,randomWidth:()=>Cc,reLU:()=>al,repeatVector:()=>Cl,rescaling:()=>_c,reshape:()=>Ml,resizing:()=>kc,rnn:()=>lc,separableConv2d:()=>ml,simpleRNN:()=>oc,simpleRNNCell:()=>ac,softmax:()=>ll,spatialDropout1d:()=>kl,stackedRNNCells:()=>cc,thresholdedReLU:()=>cl,timeDistributed:()=>dc,upSampling2d:()=>bl,zeroPadding2d:()=>Pl});var r={};__webpack_require__.r(r),__webpack_require__.d(r,{MAPE:()=>Bc,MSE:()=>$c,binaryAccuracy:()=>Mc,binaryCrossentropy:()=>Tc,categoricalAccuracy:()=>Ac,categoricalCrossentropy:()=>Fc,cosineProximity:()=>Nc,mape:()=>Lc,meanAbsoluteError:()=>Dc,meanAbsolutePercentageError:()=>Ic,meanSquaredError:()=>Pc,mse:()=>zc,precision:()=>Oc,recall:()=>Rc,sparseCategoricalAccuracy:()=>Ec});var i={};__webpack_require__.r(i),__webpack_require__.d(i,{modelFromJSON:()=>Pa});var o={};__webpack_require__.r(o),__webpack_require__.d(o,{l1:()=>Gc,l1l2:()=>jc,l2:()=>Uc});var a={};__webpack_require__.r(a),__webpack_require__.d(a,{json:()=>lp});var s={};__webpack_require__.r(s),__webpack_require__.d(s,{json:()=>cp});var u={};__webpack_require__.r(u),__webpack_require__.d(u,{json:()=>pp});var l={};__webpack_require__.r(l),__webpack_require__.d(l,{json:()=>dp});var c={};__webpack_require__.r(c),__webpack_require__.d(c,{json:()=>hp});var p={};__webpack_require__.r(p),__webpack_require__.d(p,{json:()=>fp});var d={};__webpack_require__.r(d),__webpack_require__.d(d,{json:()=>gp});var h={};__webpack_require__.r(h),__webpack_require__.d(h,{json:()=>mp});var f={};__webpack_require__.r(f),__webpack_require__.d(f,{json:()=>yp});var g={};__webpack_require__.r(g),__webpack_require__.d(g,{json:()=>bp});var m={};__webpack_require__.r(m),__webpack_require__.d(m,{json:()=>vp});var y={};__webpack_require__.r(y),__webpack_require__.d(y,{json:()=>xp});var b={};__webpack_require__.r(b),__webpack_require__.d(b,{json:()=>_p});var v={};__webpack_require__.r(v),__webpack_require__.d(v,{json:()=>wp});var x={};__webpack_require__.r(x),__webpack_require__.d(x,{json:()=>kp});var _={};__webpack_require__.r(_),__webpack_require__.d(_,{json:()=>Sp});var w={};__webpack_require__.r(w),__webpack_require__.d(w,{json:()=>Cp});var k={};__webpack_require__.r(k),__webpack_require__.d(k,{json:()=>Mp});var S={};__webpack_require__.r(S),__webpack_require__.d(S,{json:()=>Tp});var C={};__webpack_require__.r(C),__webpack_require__.d(C,{OP_SCOPE_SUFFIX:()=>Wp.zvA,abs:()=>Wp.WnP,acos:()=>Wp.Khb,acosh:()=>Wp.__u,add:()=>Wp.IHx,addN:()=>Wp.QBD,all:()=>Wp.$6P,any:()=>Wp.YjB,argMax:()=>Wp.NqF,argMin:()=>Wp.vHJ,asin:()=>Wp.ZRM,asinh:()=>Wp.VfV,atan:()=>Wp.z4N,atan2:()=>Wp.fvJ,atanh:()=>Wp.C80,avgPool:()=>Wp.wS1,avgPool3d:()=>Wp.uR5,basicLSTMCell:()=>Wp.zEQ,batchNorm:()=>Wp.tgs,batchNorm2d:()=>Wp.Dxk,batchNorm3d:()=>Wp.JY5,batchNorm4d:()=>Wp.p3b,batchToSpaceND:()=>Wp.E4h,bincount:()=>Wp.yE8,bitwiseAnd:()=>Wp.ycw,booleanMaskAsync:()=>Wp.anm,broadcastArgs:()=>Wp.XsQ,broadcastTo:()=>Wp.UFq,buffer:()=>Wp.f3b,cast:()=>Wp.pju,ceil:()=>Wp.mDi,clipByValue:()=>Wp.iUl,clone:()=>Wp.d9v,complex:()=>Wp.PYB,concat:()=>Wp.zoF,concat1d:()=>Wp.gME,concat2d:()=>Wp.Izb,concat3d:()=>Wp.MNy,concat4d:()=>Wp.ZaL,conv1d:()=>Wp.PAt,conv2d:()=>Wp.Tek,conv2dTranspose:()=>Wp.bc,conv3d:()=>Wp.pdZ,conv3dTranspose:()=>Wp.$QV,cos:()=>Wp.mCk,cosh:()=>Wp.f9Y,cosineWindow:()=>Wp.mew,cumprod:()=>Wp.$Gn,cumsum:()=>Wp.zbp,denseBincount:()=>Wp.ppE,depthToSpace:()=>Wp.nTT,depthwiseConv2d:()=>Wp.B10,diag:()=>Wp.Ka3,dilation2d:()=>Wp.WmZ,div:()=>Wp.hiC,divNoNan:()=>Wp.NTj,dot:()=>Wp.AKD,dropout:()=>Wp.rvX,einsum:()=>Wp.WYO,elu:()=>Wp.pyx,enclosingPowerOfTwo:()=>Wp.GRh,ensureShape:()=>Wp.EDe,equal:()=>Wp.DgJ,erf:()=>Wp.qNN,euclideanNorm:()=>Wp.d2q,exp:()=>Wp.Qqt,expandDims:()=>Wp.dt4,expm1:()=>Wp.t$B,eye:()=>Wp.iyy,fft:()=>Wp.kp_,fill:()=>Wp.hlL,floor:()=>Wp.GWj,floorDiv:()=>Wp.qPi,fused:()=>Wp.imm,gather:()=>Wp.Iqj,gatherND:()=>Wp.dbB,greater:()=>Wp.pjt,greaterEqual:()=>Wp.brS,ifft:()=>Wp.Sxn,imag:()=>Wp.asL,image:()=>Wp.BHj,inTopKAsync:()=>Wp.V3u,irfft:()=>Wp.wx0,isFinite:()=>Wp.xVT,isInf:()=>Wp.UWc,isNaN:()=>Wp.i2d,leakyRelu:()=>Wp.hi7,less:()=>Wp.d9m,lessEqual:()=>Wp.zN1,linalg:()=>Wp.$r2,linspace:()=>Wp.SX3,localResponseNormalization:()=>Wp.G9k,log:()=>Wp.cM7,log1p:()=>Wp.Krr,logSigmoid:()=>Wp.e_t,logSoftmax:()=>Wp.CmS,logSumExp:()=>Wp.l_t,logicalAnd:()=>Wp.HvI,logicalNot:()=>Wp.hJK,logicalOr:()=>Wp.K5V,logicalXor:()=>Wp.egP,losses:()=>Wp.MB5,lowerBound:()=>Wp.eab,matMul:()=>Wp.OI3,max:()=>Wp.Fp7,maxPool:()=>Wp._sB,maxPool3d:()=>Wp.YQQ,maxPoolWithArgmax:()=>Wp.Ip$,maximum:()=>Wp.gWQ,mean:()=>Wp.J69,meshgrid:()=>Wp.ry_,min:()=>Wp.VV$,minimum:()=>Wp.LTh,mirrorPad:()=>Wp.VdP,mod:()=>Wp.wQq,moments:()=>Wp.Gi7,movingAverage:()=>Wp.p_,mul:()=>Wp.dC7,multiRNNCell:()=>Wp.rq4,multinomial:()=>Wp.SJ_,neg:()=>Wp.W76,norm:()=>Wp.KOy,notEqual:()=>Wp.Quu,oneHot:()=>Wp.lfX,ones:()=>Wp.iUs,onesLike:()=>Wp.JpU,op:()=>Wp.op,outerProduct:()=>Wp.N2O,pad:()=>Wp.vku,pad1d:()=>Wp.pNR,pad2d:()=>Wp.koy,pad3d:()=>Wp.t1L,pad4d:()=>Wp.lGY,pool:()=>Wp.d_R,pow:()=>Wp.sQ3,prelu:()=>Wp.AL3,print:()=>Wp.S0v,prod:()=>Wp.WVs,raggedGather:()=>Wp.$gW,raggedRange:()=>Wp.VT$,raggedTensorToTensor:()=>Wp.N89,rand:()=>Wp.TN_,randomGamma:()=>Wp.wzB,randomNormal:()=>Wp.nGf,randomStandardNormal:()=>Wp.ruB,randomUniform:()=>Wp.LGj,randomUniformInt:()=>Wp.pe5,range:()=>Wp.w6H,real:()=>Wp.kwC,reciprocal:()=>Wp.M25,relu:()=>Wp.UYe,relu6:()=>Wp.btT,reshape:()=>Wp.XLQ,reverse:()=>Wp.GYS,reverse1d:()=>Wp.SDf,reverse2d:()=>Wp.diP,reverse3d:()=>Wp.sx7,reverse4d:()=>Wp.mG2,rfft:()=>Wp.QEs,round:()=>Wp.NMM,rsqrt:()=>Wp.bp0,scalar:()=>Wp.iD$,scatterND:()=>Wp.snQ,searchSorted:()=>Wp.zcT,selu:()=>Wp.U8D,separableConv2d:()=>Wp.U_I,setdiff1dAsync:()=>Wp.ODp,sigmoid:()=>Wp.XD2,sign:()=>Wp.Xxe,signal:()=>Wp.tdS,sin:()=>Wp.O$l,sinh:()=>Wp.R_K,slice:()=>Wp.tPi,slice1d:()=>Wp.jZU,slice2d:()=>Wp.SmN,slice3d:()=>Wp.CnO,slice4d:()=>Wp.p0P,softmax:()=>Wp.XAC,softplus:()=>Wp.Wvh,spaceToBatchND:()=>Wp.fBT,sparse:()=>Wp.rVs,sparseToDense:()=>Wp.ers,spectral:()=>Wp.uN7,split:()=>Wp.Vl2,sqrt:()=>Wp._b3,square:()=>Wp.h62,squaredDifference:()=>Wp.$i,squeeze:()=>Wp.L9e,stack:()=>Wp.knu,step:()=>Wp.Nbs,stridedSlice:()=>Wp.NXj,string:()=>Wp.Z_8,sub:()=>Wp.luU,sum:()=>Wp.Smz,tan:()=>Wp.ORZ,tanh:()=>Wp.AEp,tensor:()=>Wp.XeE,tensor1d:()=>Wp.RRF,tensor2d:()=>Wp.odF,tensor3d:()=>Wp.wOQ,tensor4d:()=>Wp.yXz,tensor5d:()=>Wp.Bfx,tensor6d:()=>Wp.xZs,tensorScatterUpdate:()=>Wp.Pg0,tile:()=>Wp.Gg6,topk:()=>Wp.hg7,transpose:()=>Wp.p4s,truncatedNormal:()=>Wp.Xu6,unique:()=>Wp.Two,unsortedSegmentSum:()=>Wp.pUJ,unstack:()=>Wp.HHK,upperBound:()=>Wp.GaM,variable:()=>Wp.VD$,where:()=>Wp.arb,whereAsync:()=>Wp.itS,zeros:()=>Wp.lls,zerosLike:()=>Wp.P84});var M={};__webpack_require__.r(M),__webpack_require__.d(M,{CSVDataset:()=>ah,Dataset:()=>Xd,FileDataSource:()=>bh,TextLineDataset:()=>Qd,URLDataSource:()=>vh,array:()=>Kd,csv:()=>xh,func:()=>_h,generator:()=>wh,microphone:()=>Sh,version_data:()=>Ch,webcam:()=>kh,zip:()=>Jd});var T={};__webpack_require__.r(T),__webpack_require__.d(T,{addImpl:()=>Wh,bincountImpl:()=>Xh,bincountReduceImpl:()=>Yh,bitwiseAndImpl:()=>Kh,castImpl:()=>$h,ceilImpl:()=>nf,concatImpl:()=>af,equalImpl:()=>sf,expImpl:()=>cf,expm1Impl:()=>hf,floorDivImpl:()=>vf,floorImpl:()=>mf,gatherNdImpl:()=>wf,gatherV2Impl:()=>kf,greaterEqualImpl:()=>Tf,greaterImpl:()=>Sf,lessEqualImpl:()=>Nf,lessImpl:()=>Ff,linSpaceImpl:()=>Bf,logImpl:()=>Lf,maxImpl:()=>zf,maximumImpl:()=>jf,minimumImpl:()=>Wf,multiplyImpl:()=>qf,negImpl:()=>Jf,notEqualImpl:()=>Qf,prodImpl:()=>og,raggedGatherImpl:()=>ug,raggedRangeImpl:()=>cg,raggedTensorToTensorImpl:()=>gg,rangeImpl:()=>mg,rsqrtImpl:()=>yg,scatterImpl:()=>xg,sigmoidImpl:()=>_g,simpleAbsImpl:()=>Ah,sliceImpl:()=>Sg,sparseFillEmptyRowsImpl:()=>Tg,sparseReshapeImpl:()=>Eg,sparseSegmentReductionImpl:()=>Ag,sqrtImpl:()=>Fg,squaredDifferenceImpl:()=>Ng,staticRegexReplaceImpl:()=>Bg,stridedSliceImpl:()=>$g,stringNGramsImpl:()=>jg,stringSplitImpl:()=>Ug,stringToHashBucketFastImpl:()=>Wg,subImpl:()=>Vg,tileImpl:()=>Yg,topKImpl:()=>Zg,transposeImpl:()=>ng,uniqueImpl:()=>Qg});var E={};__webpack_require__.r(E),__webpack_require__.d(E,{assertNotComplex:()=>g_,bindCanvasToFramebuffer:()=>Ux,bindColorTextureToFramebuffer:()=>Wx,bindTextureToProgramUniformSampler:()=>Gx,bindTextureUnit:()=>Px,bindVertexBufferToProgramAttribute:()=>Lx,callAndCheck:()=>bx,canBeRepresented:()=>_x,createFragmentShader:()=>Cx,createFramebuffer:()=>Bx,createProgram:()=>Ex,createStaticIndexBuffer:()=>Rx,createStaticVertexBuffer:()=>Ox,createTexture:()=>Dx,createVertexShader:()=>Sx,getBatchDim:()=>Kx,getExtensionOrThrow:()=>kx,getFramebufferErrorMessage:()=>qx,getMaxTexturesInShader:()=>s_,getNumChannels:()=>Nx,getProgramUniformLocation:()=>jx,getProgramUniformLocationOrThrow:()=>zx,getRowsCols:()=>Jx,getShapeAs3D:()=>Zx,getTextureShapeFromLogicalShape:()=>Qx,getWebGLDisjointQueryTimerVersion:()=>u_,getWebGLErrorMessage:()=>wx,getWebGLMaxTextureSize:()=>i_,hasExtension:()=>l_,isCapableOfRenderingToFloatTexture:()=>p_,isDownloadFloatTextureEnabled:()=>d_,isReshapeFree:()=>t_,isWebGLFenceEnabled:()=>f_,isWebGLVersionEnabled:()=>c_,linkProgram:()=>Ax,logShaderSourceAndInfoLog:()=>Tx,resetMaxTextureSize:()=>o_,resetMaxTexturesInShader:()=>a_,unbindColorTextureFromFramebuffer:()=>Vx,unbindTextureUnit:()=>$x,validateFramebuffer:()=>Hx,validateProgram:()=>Fx,validateTextureSize:()=>Ix});var A={};__webpack_require__.r(A),__webpack_require__.d(A,{bindVertexProgramAttributeStreams:()=>aw,createBufferFromOutputTexture:()=>lw,createFloat16MatrixTexture:()=>Q_,createFloat16PackedMatrixTexture:()=>ow,createFloat32MatrixTexture:()=>J_,createIndexBuffer:()=>X_,createPackedMatrixTexture:()=>rw,createUnsignedBytesMatrixTexture:()=>tw,createVertexBuffer:()=>q_,createVertexShader:()=>H_,downloadByteEncodedFloatMatrixFromOutputTexture:()=>pw,downloadFloat32MatrixFromBuffer:()=>cw,downloadMatrixFromPackedOutputTexture:()=>hw,downloadPackedMatrixFromBuffer:()=>dw,getInternalFormatForFloat16MatrixTexture:()=>Z_,getInternalFormatForFloat16PackedMatrixTexture:()=>iw,getInternalFormatForFloat32MatrixTexture:()=>K_,getInternalFormatForPackedMatrixTexture:()=>nw,getInternalFormatForUnsignedBytesMatrixTexture:()=>ew,uploadDenseMatrixToTexture:()=>sw,uploadPixelDataToTexture:()=>uw});var F={};__webpack_require__.r(F),__webpack_require__.d(F,{Abs:()=>O.Abs,Acos:()=>O.Acos,Acosh:()=>O.Acosh,AdadeltaOptimizer:()=>O.AdadeltaOptimizer,AdagradOptimizer:()=>O.AdagradOptimizer,AdamOptimizer:()=>O.AdamOptimizer,AdamaxOptimizer:()=>O.AdamaxOptimizer,Add:()=>O.Add,AddN:()=>O.AddN,All:()=>O.All,Any:()=>O.Any,ArgMax:()=>O.ArgMax,ArgMin:()=>O.ArgMin,Asin:()=>O.Asin,Asinh:()=>O.Asinh,Atan:()=>O.Atan,Atan2:()=>O.Atan2,Atanh:()=>O.Atanh,AvgPool:()=>O.AvgPool,AvgPool3D:()=>O.AvgPool3D,AvgPool3DGrad:()=>O.AvgPool3DGrad,AvgPoolGrad:()=>O.AvgPoolGrad,BatchMatMul:()=>O.BatchMatMul,BatchToSpaceND:()=>O.BatchToSpaceND,Bincount:()=>O.Bincount,BitwiseAnd:()=>O.BitwiseAnd,BroadcastArgs:()=>O.BroadcastArgs,BroadcastTo:()=>O.BroadcastTo,Callback:()=>Wc,CallbackList:()=>Io,Cast:()=>O.Cast,Ceil:()=>O.Ceil,ClipByValue:()=>O.ClipByValue,Complex:()=>O.Complex,ComplexAbs:()=>O.ComplexAbs,Concat:()=>O.Concat,Conv2D:()=>O.Conv2D,Conv2DBackpropFilter:()=>O.Conv2DBackpropFilter,Conv2DBackpropInput:()=>O.Conv2DBackpropInput,Conv3D:()=>O.Conv3D,Conv3DBackpropFilterV2:()=>O.Conv3DBackpropFilterV2,Conv3DBackpropInputV2:()=>O.Conv3DBackpropInputV2,Cos:()=>O.Cos,Cosh:()=>O.Cosh,CropAndResize:()=>O.CropAndResize,Cumprod:()=>O.Cumprod,Cumsum:()=>O.Cumsum,CustomCallback:()=>Po,DataStorage:()=>O.DataStorage,DenseBincount:()=>O.DenseBincount,DepthToSpace:()=>O.DepthToSpace,DepthwiseConv2dNative:()=>O.DepthwiseConv2dNative,DepthwiseConv2dNativeBackpropFilter:()=>O.DepthwiseConv2dNativeBackpropFilter,DepthwiseConv2dNativeBackpropInput:()=>O.DepthwiseConv2dNativeBackpropInput,Diag:()=>O.Diag,Dilation2D:()=>O.Dilation2D,Dilation2DBackpropFilter:()=>O.Dilation2DBackpropFilter,Dilation2DBackpropInput:()=>O.Dilation2DBackpropInput,Draw:()=>O.Draw,ENV:()=>O.ENV,EarlyStopping:()=>qc,Einsum:()=>O.Einsum,Elu:()=>O.Elu,EluGrad:()=>O.EluGrad,Environment:()=>O.Environment,Equal:()=>O.Equal,Erf:()=>O.Erf,Exp:()=>O.Exp,ExpandDims:()=>O.ExpandDims,Expm1:()=>O.Expm1,FFT:()=>O.FFT,Fill:()=>O.Fill,FlipLeftRight:()=>O.FlipLeftRight,Floor:()=>O.Floor,FloorDiv:()=>O.FloorDiv,FromPixels:()=>O.FromPixels,FusedBatchNorm:()=>O.FusedBatchNorm,FusedConv2D:()=>O.FusedConv2D,FusedDepthwiseConv2D:()=>O.FusedDepthwiseConv2D,GPGPUContext:()=>fw,GatherNd:()=>O.GatherNd,GatherV2:()=>O.GatherV2,GraphModel:()=>fd,Greater:()=>O.Greater,GreaterEqual:()=>O.GreaterEqual,History:()=>Lo,IFFT:()=>O.IFFT,Identity:()=>O.Identity,Imag:()=>O.Imag,InputSpec:()=>$i,IsFinite:()=>O.IsFinite,IsInf:()=>O.IsInf,IsNan:()=>O.IsNan,KernelBackend:()=>O.KernelBackend,LRN:()=>O.LRN,LRNGrad:()=>O.LRNGrad,LayerVariable:()=>Bi,LayersModel:()=>Ba,LeakyRelu:()=>O.LeakyRelu,Less:()=>O.Less,LessEqual:()=>O.LessEqual,LinSpace:()=>O.LinSpace,Log:()=>O.Log,Log1p:()=>O.Log1p,LogSoftmax:()=>O.LogSoftmax,LogicalAnd:()=>O.LogicalAnd,LogicalNot:()=>O.LogicalNot,LogicalOr:()=>O.LogicalOr,LogicalXor:()=>O.LogicalXor,LowerBound:()=>O.LowerBound,MathBackendCPU:()=>Eh,MathBackendWebGL:()=>Lk,MatrixBandPart:()=>O.MatrixBandPart,Max:()=>O.Max,MaxPool:()=>O.MaxPool,MaxPool3D:()=>O.MaxPool3D,MaxPool3DGrad:()=>O.MaxPool3DGrad,MaxPoolGrad:()=>O.MaxPoolGrad,MaxPoolWithArgmax:()=>O.MaxPoolWithArgmax,Maximum:()=>O.Maximum,Mean:()=>O.Mean,Min:()=>O.Min,Minimum:()=>O.Minimum,MirrorPad:()=>O.MirrorPad,Mod:()=>O.Mod,MomentumOptimizer:()=>O.MomentumOptimizer,Multinomial:()=>O.Multinomial,Multiply:()=>O.Multiply,Neg:()=>O.Neg,NonMaxSuppressionV3:()=>O.NonMaxSuppressionV3,NonMaxSuppressionV4:()=>O.NonMaxSuppressionV4,NonMaxSuppressionV5:()=>O.NonMaxSuppressionV5,NotEqual:()=>O.NotEqual,OP_SCOPE_SUFFIX:()=>O.OP_SCOPE_SUFFIX,OneHot:()=>O.OneHot,OnesLike:()=>O.OnesLike,Optimizer:()=>O.Optimizer,OptimizerConstructors:()=>O.OptimizerConstructors,Pack:()=>O.Pack,PadV2:()=>O.PadV2,Pool:()=>O.Pool,Pow:()=>O.Pow,Prelu:()=>O.Prelu,Prod:()=>O.Prod,RMSPropOptimizer:()=>O.RMSPropOptimizer,RNN:()=>Gs,RaggedGather:()=>O.RaggedGather,RaggedRange:()=>O.RaggedRange,RaggedTensorToTensor:()=>O.RaggedTensorToTensor,Range:()=>O.Range,Rank:()=>O.Rank,Real:()=>O.Real,RealDiv:()=>O.RealDiv,Reciprocal:()=>O.Reciprocal,Reduction:()=>O.Reduction,Relu:()=>O.Relu,Relu6:()=>O.Relu6,Reshape:()=>O.Reshape,ResizeBilinear:()=>O.ResizeBilinear,ResizeBilinearGrad:()=>O.ResizeBilinearGrad,ResizeNearestNeighbor:()=>O.ResizeNearestNeighbor,ResizeNearestNeighborGrad:()=>O.ResizeNearestNeighborGrad,Reverse:()=>O.Reverse,RotateWithOffset:()=>O.RotateWithOffset,Round:()=>O.Round,Rsqrt:()=>O.Rsqrt,SGDOptimizer:()=>O.SGDOptimizer,ScatterNd:()=>O.ScatterNd,SearchSorted:()=>O.SearchSorted,Select:()=>O.Select,Selu:()=>O.Selu,Sequential:()=>za,Sigmoid:()=>O.Sigmoid,Sign:()=>O.Sign,Sin:()=>O.Sin,Sinh:()=>O.Sinh,Slice:()=>O.Slice,Softmax:()=>O.Softmax,Softplus:()=>O.Softplus,SpaceToBatchND:()=>O.SpaceToBatchND,SparseFillEmptyRows:()=>O.SparseFillEmptyRows,SparseReshape:()=>O.SparseReshape,SparseSegmentMean:()=>O.SparseSegmentMean,SparseSegmentSum:()=>O.SparseSegmentSum,SparseToDense:()=>O.SparseToDense,SplitV:()=>O.SplitV,Sqrt:()=>O.Sqrt,Square:()=>O.Square,SquaredDifference:()=>O.SquaredDifference,StaticRegexReplace:()=>O.StaticRegexReplace,Step:()=>O.Step,StridedSlice:()=>O.StridedSlice,StringNGrams:()=>O.StringNGrams,StringSplit:()=>O.StringSplit,StringToHashBucketFast:()=>O.StringToHashBucketFast,Sub:()=>O.Sub,Sum:()=>O.Sum,SymbolicTensor:()=>zi,Tan:()=>O.Tan,Tanh:()=>O.Tanh,Tensor:()=>O.Tensor,TensorBuffer:()=>O.TensorBuffer,TensorScatterUpdate:()=>O.TensorScatterUpdate,Tile:()=>O.Tile,TopK:()=>O.TopK,Transform:()=>O.Transform,Transpose:()=>O.Transpose,Unique:()=>O.Unique,Unpack:()=>O.Unpack,UnsortedSegmentSum:()=>O.UnsortedSegmentSum,UpperBound:()=>O.UpperBound,Variable:()=>O.Variable,ZerosLike:()=>O.ZerosLike,_FusedMatMul:()=>O._FusedMatMul,abs:()=>O.abs,acos:()=>O.acos,acosh:()=>O.acosh,add:()=>O.add,addN:()=>O.addN,all:()=>O.all,any:()=>O.any,argMax:()=>O.argMax,argMin:()=>O.argMin,asin:()=>O.asin,asinh:()=>O.asinh,atan:()=>O.atan,atan2:()=>O.atan2,atanh:()=>O.atanh,avgPool:()=>O.avgPool,avgPool3d:()=>O.avgPool3d,backend:()=>O.backend,backend_util:()=>O.backend_util,basicLSTMCell:()=>O.basicLSTMCell,batchNorm:()=>O.batchNorm,batchNorm2d:()=>O.batchNorm2d,batchNorm3d:()=>O.batchNorm3d,batchNorm4d:()=>O.batchNorm4d,batchToSpaceND:()=>O.batchToSpaceND,bincount:()=>O.bincount,bitwiseAnd:()=>O.bitwiseAnd,booleanMaskAsync:()=>O.booleanMaskAsync,broadcastArgs:()=>O.broadcastArgs,broadcastTo:()=>O.broadcastTo,broadcast_util:()=>O.broadcast_util,browser:()=>O.browser,buffer:()=>O.buffer,callbacks:()=>Xc,cast:()=>O.cast,ceil:()=>O.ceil,clipByValue:()=>O.clipByValue,clone:()=>O.clone,complex:()=>O.complex,concat:()=>O.concat,concat1d:()=>O.concat1d,concat2d:()=>O.concat2d,concat3d:()=>O.concat3d,concat4d:()=>O.concat4d,constraints:()=>e,conv1d:()=>O.conv1d,conv2d:()=>O.conv2d,conv2dTranspose:()=>O.conv2dTranspose,conv3d:()=>O.conv3d,conv3dTranspose:()=>O.conv3dTranspose,copyRegisteredKernels:()=>O.copyRegisteredKernels,cos:()=>O.cos,cosh:()=>O.cosh,cosineWindow:()=>O.cosineWindow,cumprod:()=>O.cumprod,cumsum:()=>O.cumsum,customGrad:()=>O.customGrad,data:()=>M,denseBincount:()=>O.denseBincount,deprecationWarn:()=>O.deprecationWarn,depthToSpace:()=>O.depthToSpace,depthwiseConv2d:()=>O.depthwiseConv2d,deregisterOp:()=>ep,device_util:()=>O.device_util,diag:()=>O.diag,dilation2d:()=>O.dilation2d,disableDeprecationWarnings:()=>O.disableDeprecationWarnings,dispose:()=>O.dispose,disposeVariables:()=>O.disposeVariables,div:()=>O.div,divNoNan:()=>O.divNoNan,dot:()=>O.dot,dropout:()=>O.dropout,einsum:()=>O.einsum,elu:()=>O.elu,enableDebugMode:()=>O.enableDebugMode,enableProdMode:()=>O.enableProdMode,enclosingPowerOfTwo:()=>O.enclosingPowerOfTwo,engine:()=>O.engine,ensureShape:()=>O.ensureShape,env:()=>O.env,equal:()=>O.equal,erf:()=>O.erf,euclideanNorm:()=>O.euclideanNorm,exp:()=>O.exp,expandDims:()=>O.expandDims,expm1:()=>O.expm1,eye:()=>O.eye,fft:()=>O.fft,fill:()=>O.fill,findBackend:()=>O.findBackend,findBackendFactory:()=>O.findBackendFactory,floor:()=>O.floor,floorDiv:()=>O.floorDiv,forceHalfFloat:()=>$k,fused:()=>O.fused,gather:()=>O.gather,gatherND:()=>O.gatherND,gather_util:()=>O.gather_util,getBackend:()=>O.getBackend,getGradient:()=>O.getGradient,getKernel:()=>O.getKernel,getKernelsForBackend:()=>O.getKernelsForBackend,gpgpu_util:()=>A,grad:()=>O.grad,grads:()=>O.grads,greater:()=>O.greater,greaterEqual:()=>O.greaterEqual,ifft:()=>O.ifft,imag:()=>O.imag,image:()=>O.image,inTopKAsync:()=>O.inTopKAsync,initializers:()=>t,input:()=>Ua,io:()=>O.io,irfft:()=>O.irfft,isFinite:()=>O.isFinite,isInf:()=>O.isInf,isNaN:()=>O.isNaN,keep:()=>O.keep,kernel_impls:()=>O.kernel_impls,layers:()=>n,leakyRelu:()=>O.leakyRelu,less:()=>O.less,lessEqual:()=>O.lessEqual,linalg:()=>O.linalg,linspace:()=>O.linspace,loadGraphModel:()=>gd,loadGraphModelSync:()=>md,loadLayersModel:()=>$a,localResponseNormalization:()=>O.localResponseNormalization,log:()=>O.log,log1p:()=>O.log1p,logSigmoid:()=>O.logSigmoid,logSoftmax:()=>O.logSoftmax,logSumExp:()=>O.logSumExp,logicalAnd:()=>O.logicalAnd,logicalNot:()=>O.logicalNot,logicalOr:()=>O.logicalOr,logicalXor:()=>O.logicalXor,losses:()=>O.losses,lowerBound:()=>O.lowerBound,matMul:()=>O.matMul,math:()=>O.math,max:()=>O.max,maxPool:()=>O.maxPool,maxPool3d:()=>O.maxPool3d,maxPoolWithArgmax:()=>O.maxPoolWithArgmax,maximum:()=>O.maximum,mean:()=>O.mean,memory:()=>O.memory,meshgrid:()=>O.meshgrid,metrics:()=>r,min:()=>O.min,minimum:()=>O.minimum,mirrorPad:()=>O.mirrorPad,mod:()=>O.mod,model:()=>ja,models:()=>i,moments:()=>O.moments,movingAverage:()=>O.movingAverage,mul:()=>O.mul,multiRNNCell:()=>O.multiRNNCell,multinomial:()=>O.multinomial,neg:()=>O.neg,nextFrame:()=>O.nextFrame,norm:()=>O.norm,notEqual:()=>O.notEqual,oneHot:()=>O.oneHot,ones:()=>O.ones,onesLike:()=>O.onesLike,op:()=>O.op,outerProduct:()=>O.outerProduct,pad:()=>O.pad,pad1d:()=>O.pad1d,pad2d:()=>O.pad2d,pad3d:()=>O.pad3d,pad4d:()=>O.pad4d,pool:()=>O.pool,pow:()=>O.pow,prelu:()=>O.prelu,print:()=>O.print,prod:()=>O.prod,profile:()=>O.profile,raggedGather:()=>O.raggedGather,raggedRange:()=>O.raggedRange,raggedTensorToTensor:()=>O.raggedTensorToTensor,rand:()=>O.rand,randomGamma:()=>O.randomGamma,randomNormal:()=>O.randomNormal,randomStandardNormal:()=>O.randomStandardNormal,randomUniform:()=>O.randomUniform,randomUniformInt:()=>O.randomUniformInt,range:()=>O.range,ready:()=>O.ready,real:()=>O.real,reciprocal:()=>O.reciprocal,registerBackend:()=>O.registerBackend,registerCallbackConstructor:()=>Wa,registerGradient:()=>O.registerGradient,registerKernel:()=>O.registerKernel,registerOp:()=>Zc,regularizers:()=>o,relu:()=>O.relu,relu6:()=>O.relu6,removeBackend:()=>O.removeBackend,reshape:()=>O.reshape,reverse:()=>O.reverse,reverse1d:()=>O.reverse1d,reverse2d:()=>O.reverse2d,reverse3d:()=>O.reverse3d,reverse4d:()=>O.reverse4d,rfft:()=>O.rfft,round:()=>O.round,rsqrt:()=>O.rsqrt,scalar:()=>O.scalar,scatterND:()=>O.scatterND,scatter_util:()=>O.scatter_util,searchSorted:()=>O.searchSorted,selu:()=>O.selu,separableConv2d:()=>O.separableConv2d,sequential:()=>Ga,serialization:()=>O.serialization,setBackend:()=>O.setBackend,setPlatform:()=>O.setPlatform,setWebGLContext:()=>lx,setdiff1dAsync:()=>O.setdiff1dAsync,shared:()=>T,sigmoid:()=>O.sigmoid,sign:()=>O.sign,signal:()=>O.signal,sin:()=>O.sin,sinh:()=>O.sinh,slice:()=>O.slice,slice1d:()=>O.slice1d,slice2d:()=>O.slice2d,slice3d:()=>O.slice3d,slice4d:()=>O.slice4d,slice_util:()=>O.slice_util,softmax:()=>O.softmax,softplus:()=>O.softplus,spaceToBatchND:()=>O.spaceToBatchND,sparse:()=>O.sparse,sparseToDense:()=>O.sparseToDense,spectral:()=>O.spectral,split:()=>O.split,sqrt:()=>O.sqrt,square:()=>O.square,squaredDifference:()=>O.squaredDifference,squeeze:()=>O.squeeze,stack:()=>O.stack,step:()=>O.step,stridedSlice:()=>O.stridedSlice,string:()=>O.string,sub:()=>O.sub,sum:()=>O.sum,sumOutType:()=>O.sumOutType,tan:()=>O.tan,tanh:()=>O.tanh,tensor:()=>O.tensor,tensor1d:()=>O.tensor1d,tensor2d:()=>O.tensor2d,tensor3d:()=>O.tensor3d,tensor4d:()=>O.tensor4d,tensor5d:()=>O.tensor5d,tensor6d:()=>O.tensor6d,tensorScatterUpdate:()=>O.tensorScatterUpdate,tensor_util:()=>O.tensor_util,test_util:()=>O.test_util,tidy:()=>O.tidy,tile:()=>O.tile,time:()=>O.time,topk:()=>O.topk,train:()=>O.train,transpose:()=>O.transpose,truncatedNormal:()=>O.truncatedNormal,unique:()=>O.unique,unregisterGradient:()=>O.unregisterGradient,unregisterKernel:()=>O.unregisterKernel,unsortedSegmentSum:()=>O.unsortedSegmentSum,unstack:()=>O.unstack,upcastType:()=>O.upcastType,upperBound:()=>O.upperBound,util:()=>O.util,valueAndGrad:()=>O.valueAndGrad,valueAndGrads:()=>O.valueAndGrads,variable:()=>O.variable,variableGrads:()=>O.variableGrads,version:()=>NF,version_converter:()=>yd,version_core:()=>O.version_core,version_cpu:()=>em,version_layers:()=>ba,version_webgl:()=>Pk,webgl:()=>zk,webgl_util:()=>E,where:()=>O.where,whereAsync:()=>O.whereAsync,zeros:()=>O.zeros,zerosLike:()=>O.zerosLike});var O=__webpack_require__(9882),R=__webpack_require__(9121),N=__webpack_require__(2271),D=__webpack_require__(4841),I=__webpack_require__(1901);const B={kernelName:R.SYM,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,D.d)(e,(0,I.N)((0,N.p)(n,"float32"),-1))}}};var L=__webpack_require__(1274),P=__webpack_require__(7370),$=__webpack_require__(9494),z=__webpack_require__(3261),j=__webpack_require__(248),G=__webpack_require__(827);const U={kernelName:R.VGw,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=(0,j.h)((0,N.p)(n,"float32")),r=(0,z._)((0,G.l)((0,$.i)(1),t));return(0,P.W)((0,L.h)(e,r))}}}},W={kernelName:R.SpW,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=(0,z._)((0,G.l)((0,j.h)((0,N.p)(n,"float32")),1));return(0,L.h)(e,t)}}}};var V=__webpack_require__(2200),H=__webpack_require__(4968),q=__webpack_require__(5475);const X={kernelName:R.mm_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=V.assertAndGetBroadcastShape(n.shape,r.shape);return{a:()=>{let t=e;const r=V.getReductionAxes(n.shape,i);return r.length>0&&(t=(0,q.S)(t,r)),(0,H.X)(t,n.shape)},b:()=>{let t=e;const n=V.getReductionAxes(r.shape,i);return n.length>0&&(t=(0,q.S)(t,n)),(0,H.X)(t,r.shape)}}}},Y={kernelName:R.Xze,saveAllInputs:!0,gradFunc:(e,t)=>{const n={};return t.forEach(((t,r)=>{n[r]=()=>e.clone()})),n}};var K=__webpack_require__(6577);const J={kernelName:R.sJF,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,K.P)(n)}}},Z={kernelName:R.aJk,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,K.P)(n)}}},Q={kernelName:R.M2y,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,L.h)(e,(0,z._)((0,G.l)((0,$.i)(1),(0,j.h)((0,N.p)(n,"float32")))))}}};var ee=__webpack_require__(6407);const te={kernelName:R.qw7,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=(0,z._)((0,ee.I)((0,$.i)(1),(0,j.h)((0,N.p)(n,"float32"))));return(0,L.h)(e,t)}}}},ne={kernelName:R.QCc,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=(0,V.assertAndGetBroadcastShape)(n.shape,r.shape);return{a:()=>{const t=(0,ee.I)((0,j.h)(n),(0,j.h)(r));let o=(0,D.d)(e,(0,L.h)(r,t));const a=(0,V.getReductionAxes)(n.shape,i);return a.length>0&&(o=(0,q.S)(o,a)),(0,H.X)(o,n.shape)},b:()=>{const t=(0,ee.I)((0,j.h)(n),(0,j.h)(r));let o=(0,P.W)((0,D.d)(e,(0,L.h)(n,t)));const a=(0,V.getReductionAxes)(r.shape,i);return a.length>0&&(o=(0,q.S)(o,a)),(0,H.X)(o,r.shape)}}}},re={kernelName:R.jMg,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,L.h)(e,(0,ee.I)((0,j.h)((0,N.p)(n,"float32")),1))}}},ie={kernelName:R.Oyi,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,L.h)(e,(0,G.l)((0,$.i)(1),(0,j.h)((0,N.p)(n,"float32"))))}}};var oe=__webpack_require__(7097),ae=__webpack_require__(3740),se=__webpack_require__(569),ue=__webpack_require__(2582),le=__webpack_require__(2668);const ce=(0,le.op)({avgPool3dGrad_:function(e,t,n,r,i,o){const a=(0,ae._1)(e,"dy","avgPool3dGrad"),s=(0,ae._1)(t,"input","avgPool3dGrad");let u=a,l=s,c=!1;4===s.rank&&(c=!0,u=(0,H.X)(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),l=(0,H.X)(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),se.hu(5===u.rank,(()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`)),se.hu(5===l.rank,(()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${l.rank}.`)),(0,ue.m)("avgPool3dGrad",i,o);const p={dy:u,input:l},d={filterSize:n,strides:r,pad:i,dimRoundingMode:o},h=oe.BV.runKernel(R.IMb,p,d);return c?(0,H.X)(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}}),pe={kernelName:R._k9,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:i,strides:o,pad:a,dimRoundingMode:s}=n;return{x:()=>ce(e,r,i,o,a,s)}}},de=(0,le.op)({avgPoolGrad_:function(e,t,n,r,i){const o=(0,ae._1)(e,"dy","avgPoolGrad"),a=(0,ae._1)(t,"input","avgPoolGrad");se.hu(a.rank===o.rank,(()=>`Rank of input (${a.rank}) does not match rank of dy (${o.rank})`));let s=a,u=o,l=!1;3===a.rank&&(l=!0,s=(0,H.X)(a,[1,a.shape[0],a.shape[1],a.shape[2]]),u=(0,H.X)(o,[1,o.shape[0],o.shape[1],o.shape[2]])),se.hu(4===u.rank,(()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${u.rank}.`)),se.hu(4===s.rank,(()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${s.rank}.`));const c={dy:u,input:s},p={filterSize:n,strides:r,pad:i},d=oe.BV.runKernel(R.ROF,c,p);return l?(0,H.X)(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),he={kernelName:R.JhU,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:i,strides:o,pad:a}=n;return{x:()=>de(e,r,i,o,a)}}};var fe=__webpack_require__(8687);const ge={kernelName:R.XLW,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{const[r,i]=t,{transposeA:o,transposeB:a}=n;return o||a?!o&&a?{a:()=>(0,fe.O)(e,i,!1,!1),b:()=>(0,fe.O)(e,r,!0,!1)}:o&&!a?{a:()=>(0,fe.O)(i,e,!1,!0),b:()=>(0,fe.O)(r,e,!1,!1)}:{a:()=>(0,fe.O)(i,e,!0,!0),b:()=>(0,fe.O)(e,r,!0,!0)}:{a:()=>(0,fe.O)(e,i,!1,!0),b:()=>(0,fe.O)(r,e,!0,!1)}}};var me=__webpack_require__(7918);const ye={kernelName:R.zws,gradFunc:(e,t,n)=>{const{blockShape:r,crops:i}=n;return{x:()=>(0,me.f)(e,r,i)}}},be={kernelName:R.Ly9,gradFunc:(e,t,n)=>{const r=n,i=r.inputShape,o=r.shape,a=Array.from(o);for(let e=i.length-1;e>=0;e--)if(i[e]===o[e])a[e]=1;else if(1!==i[e])throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${o}].`);const s=[];for(let e=0;e<a.length;e++)a[e]>1&&s.push(e);return{x:()=>(0,q.S)(e,s,!0)}}},ve={kernelName:R.RFZ,gradFunc:e=>({x:()=>e.clone()})},xe={kernelName:R.gJX,gradFunc:e=>({x:()=>(0,K.P)(e)})};var _e=__webpack_require__(7630),we=__webpack_require__(624),ke=__webpack_require__(2856),Se=__webpack_require__(5912);const Ce={kernelName:R.xnO,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{clipValueMin:i,clipValueMax:o}=n;return{x:()=>(0,Se.a)((0,ke.H)((0,_e.b)(r,i),(0,we.z)(r,o)),e,(0,K.P)(e))}}},Me={kernelName:R.yj2,inputsToSave:["x"],gradFunc:B.gradFunc};var Te=__webpack_require__(8644);const Ee={kernelName:R.Eh3,saveAllInputs:!0,gradFunc:(e,t,n)=>{const r=t.map((e=>e.shape)),{axis:i}=n,o=(0,se.EC)(i,t[0].shape)[0],a=r.map((e=>e[o]));return(0,Te.V)(e,a,o).map((e=>()=>e))}};var Ae=__webpack_require__(6013),Fe=__webpack_require__(9832);const Oe={kernelName:R.mhS,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,{dilations:o,strides:a,pad:s,dataFormat:u}=n;return se.hu(ue.I0(o),(()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`)),{x:()=>(0,Fe._)(r.shape,e,i,a,s,u),filter:()=>(0,Ae.p)(r,e,i.shape,a,s,u)}}};var Re=__webpack_require__(4794);const Ne={kernelName:R.wm,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,{strides:o,pad:a,dataFormat:s,dimRoundingMode:u}=n;return{dy:()=>(0,Re.T)(e,i,o,a,s,1,u),filter:()=>(0,Ae.p)(e,r,i.shape,o,a,s,u)}}},De=(0,le.op)({conv3DBackpropFilter_:function(e,t,n,r,i){let o=e;4===e.rank&&(o=(0,H.X)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let a=t;4===a.rank&&(a=(0,H.X)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),se.hu(5===o.rank,(()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${o.shape}.`)),se.hu(5===a.rank,(()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${a.shape}.`)),se.hu(5===n.length,(()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`)),se.hu(o.shape[4]===n[3],(()=>`Error in conv3dDerFilter: depth of input ${o.shape[4]}) must match input depth in filter (${n[3]}.`)),se.hu(a.shape[4]===n[4],(()=>`Error in conv3dDerFilter: depth of dy (${a.shape[4]}) must match output depth for filter (${n[4]}).`));const s={x:o,dy:a},u={strides:r,pad:i,filterShape:n};return oe.BV.runKernel(R.o2y,s,u)}});var Ie=__webpack_require__(7594);const Be={kernelName:R.x12,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:i,pad:o}=n;se.hu((0,ue.I0)(r),(()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`));const[a,s]=t;return{x:()=>(0,Ie._)(a.shape,e,s,i,o),filter:()=>De(a,e,s.shape,i,o)}}};var Le=__webpack_require__(9331);const Pe={kernelName:R.mc4,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,D.d)((0,P.W)((0,Le.O)((0,N.p)(n,"float32"))),e)}}};var $e=__webpack_require__(3254);const ze={kernelName:R.TR1,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,D.d)((0,$e.R)((0,N.p)(n,"float32")),e)}}};var je=__webpack_require__(3591),Ge=__webpack_require__(7405),Ue=__webpack_require__(9065);const We={kernelName:R.iHb,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i,exclusive:o,reverse:a}=n;return{x:()=>{const t=(0,je.Q3)([i],r.rank);let n=(0,Ge.z)(e,i,o,!a);return null!=t&&(n=(0,Ue.p)(n,t)),n}}}};var Ve=__webpack_require__(8098),He=__webpack_require__(4375);const qe={kernelName:R.cie,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:i,pad:o,dimRoundingMode:a}=n,s=null==r?[1,1]:r;se.hu(ue.I0(s),(()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`));const[u,l]=t;return se.hu(4===u.rank,(()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${u.rank}.`)),se.hu(4===l.rank,(()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${l.rank}.`)),se.hu(u.shape[3]===l.shape[2],(()=>`Error in gradient of depthwiseConv2d: number of input channels (${u.shape[3]}) must match the inChannels dimension in filter ${l.shape[2]}.`)),se.hu(ue.jT(i,s),(()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${s}'.`)),ue.m("depthwiseConv2d",o,a),{x:()=>(0,He.v)(u.shape,e,l,i,o,s,a),filter:()=>(0,Ve.z)(u,e,l.shape,i,o,s,a)}}},Xe={kernelName:R.p4S,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,o={x:r,filter:i,dy:e},a={x:r,filter:i,dy:e};return{x:()=>oe.BV.runKernel(R.ekb,o,n),filter:()=>oe.BV.runKernel(R.Vn9,a,n)}}},Ye={kernelName:R.SX0,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t,r={dy:e,y:n};return{x:()=>oe.BV.runKernel(R.HEU,r)}}};var Ke=__webpack_require__(4842);const Je={kernelName:R.Omj,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=(0,D.d)((0,Ke.Q)((0,P.W)((0,j.h)(n))),2/Math.sqrt(Math.PI));return{x:()=>(0,D.d)(e,r)}}},Ze={kernelName:R.NEP,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,D.d)(e,n)}}},Qe={kernelName:R.YFo,inputsToSave:["input"],gradFunc:(e,t)=>{const[n]=t;return{input:()=>(0,H.X)(e,n.shape)}}},et={kernelName:R.Y0y,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,D.d)(e,(0,Ke.Q)(n))}}},tt={kernelName:R.OR,gradFunc:e=>({x:()=>(0,K.P)(e)})},nt={kernelName:R.jeX,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=(0,V.assertAndGetBroadcastShape)(n.shape,r.shape);return{a:()=>{const t=(0,L.h)(e,(0,N.p)(r,"float32")),o=(0,V.getReductionAxes)(n.shape,i);return o.length>0?(0,H.X)((0,q.S)(t,o),n.shape):t},b:()=>{let t=(0,D.d)(e,(0,N.p)(n,"float32"));const o=(0,V.getReductionAxes)(r.shape,i);o.length>0&&(t=(0,H.X)((0,q.S)(t,o),r.shape));const a=(0,j.h)(r);return(0,P.W)((0,L.h)(t,(0,N.p)(a,"float32")))}}}};var rt=__webpack_require__(2634),it=__webpack_require__(7501);const ot={kernelName:R.sHE,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{const{varianceEpsilon:r}=n,[i,o,a,s]=t,u=null==s?(0,$.i)(1):s,l=(0,V.getReductionAxes)(o.shape,i.shape),c=[];if(1===o.rank){for(let e=0;e<i.shape.length-1;++e)c.push(i.shape[e]);c.push(1)}const p=(0,G.l)(i,o),d=(0,D.d)(e,u),h=(0,rt.b)((0,ee.I)(a,(0,$.i)(r))),f=(0,D.d)((0,D.d)((0,D.d)(h,h),h),(0,$.i)(-.5));return{x:()=>1===o.rank?(0,H.X)((0,D.d)((0,D.d)(e,(0,it.G)((0,H.X)(h,[1,1,1,o.shape[0]]),c)),u),i.shape):(0,H.X)((0,D.d)((0,D.d)(e,h),u),i.shape),mean:()=>{let e=(0,D.d)((0,D.d)(h,(0,$.i)(-1)),d);return 1===o.rank&&(e=(0,q.S)(e,l)),(0,H.X)(e,o.shape)},variance:()=>{let e=(0,D.d)((0,D.d)(f,p),d);return 1===o.rank&&(e=(0,q.S)(e,l)),(0,H.X)(e,o.shape)},scale:()=>{const t=(0,D.d)(p,h);let n=(0,D.d)(e,t);return 1===o.rank&&(n=(0,q.S)(n,l)),(0,H.X)(n,o.shape)},offset:()=>{let t=e;return 1===o.rank&&(t=(0,q.S)(t,l)),(0,H.X)(t,o.shape)}}}};var at=__webpack_require__(8749);const st={kernelName:R.qi_,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{const[r,i]=t,{axis:o}=n,a=(0,se.EC)(o,r.shape)[0];return{x:()=>{const t=r.shape,n=i.size,s=t.slice(0,a),u=s.length,l=t.slice(o,t.length).slice(1),c=l.length,p=ut(0,u),d=ut(u+1,u+1+c),h=lt([s,[n],l]),f=(0,H.X)(e,h),g=(0,H.X)(i,[n]),m=lt([[u],p,d]),y=(0,Ue.p)(f,m);let b=(0,at.p)(y,g,r.shape[a]);const v=(0,je.LJ)(m);return b=(0,Ue.p)(b,v),b},indices:()=>i}}};function ut(e,t){const n=[];for(let r=e;r<t;++r)n.push(r);return n}function lt(e){const t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}const ct={kernelName:R.Acj,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>(0,K.P)(n),b:()=>(0,K.P)(r)}}},pt={kernelName:R.iJz,gradFunc:e=>({x:()=>(0,N.p)(e,"float32")})},dt={kernelName:R.avt,gradFunc:e=>({x:()=>(0,K.P)(e)})},ht={kernelName:R.iWB,gradFunc:e=>({x:()=>(0,K.P)(e)})},ft={kernelName:R.r7n,gradFunc:e=>({x:()=>(0,K.P)(e)})};var gt=__webpack_require__(636);const mt={kernelName:R.J$2,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{alpha:i}=n,o=(0,gt.p)(r,0);return{x:()=>(0,Se.a)(o,e,(0,D.d)(e,i))}}},yt={kernelName:R.kU,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,L.h)(e,(0,ee.I)(n,1))}}},bt={kernelName:R.ZbH,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,L.h)(e,(0,N.p)(n,"float32"))}}},vt={kernelName:R.qCd,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n;return{logits:()=>{const t=(0,Ke.Q)(r);return(0,G.l)(e,(0,D.d)((0,q.S)(e,i,!0),t))}}}},xt=(0,le.op)({localResponseNormalizationBackprop_:function(e,t,n,r=5,i=1,o=1,a=.5){const s={x:e,y:t,dy:n},u={depthRadius:r,bias:i,alpha:o,beta:a};return oe.BV.runKernel(R.Hhh,s,u)}}),_t={kernelName:R.eZ0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{depthRadius:o,bias:a,alpha:s,beta:u}=n;return{x:()=>xt(r,i,e,o,a,s,u)}}};var wt=__webpack_require__(6477);function kt(e,t,n,r){return t.rank<n.rank&&(t=(0,H.X)(t,je.rv(t.shape,r))),e.rank<n.rank&&(e=(0,H.X)(e,je.rv(e.shape,r))),{x:()=>(0,D.d)(e,(0,N.p)((0,wt.D)(n,t),e.dtype))}}const St={kernelName:R.YoZ,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{reductionIndices:i}=r,o=t[0],a=kt(e,t[1],o,se.EC(i,o.shape));return{x:()=>a.x()}}};var Ct=__webpack_require__(6573);const Mt={kernelName:R.BMI,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>(0,D.d)(e,(0,N.p)((0,_e.b)(n,r),"float32")),b:()=>(0,D.d)(e,(0,N.p)((0,Ct.d)(n,r),"float32"))}}},Tt=(0,le.op)({maxPool3dGrad_:function(e,t,n,r,i,o,a){const s=(0,ae._1)(e,"dy","maxPool3dGrad"),u=(0,ae._1)(t,"input","maxPool3dGrad"),l=(0,ae._1)(n,"output","maxPool3dGrad");let c=s,p=u,d=l,h=!1;4===u.rank&&(h=!0,c=(0,H.X)(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),p=(0,H.X)(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),d=(0,H.X)(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),se.hu(5===c.rank,(()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`)),se.hu(5===p.rank,(()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${p.rank}.`)),se.hu(5===d.rank,(()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`)),(0,ue.m)("maxPool3dGrad",o,a);const f={dy:c,input:p,output:d},g={filterSize:r,strides:i,pad:o,dimRoundingMode:a},m=oe.BV.runKernel(R.OU7,f,g);return h?(0,H.X)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}}),Et={kernelName:R.OAf,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{filterSize:o,strides:a,pad:s,dimRoundingMode:u}=n;return{x:()=>Tt(e,r,i,o,a,s,u)}}},At=(0,le.op)({maxPoolGrad_:function(e,t,n,r,i,o,a){const s=(0,ae._1)(e,"dy","maxPoolGrad"),u=(0,ae._1)(t,"input","maxPoolGrad"),l=(0,ae._1)(n,"output","maxPoolGrad");se.hu(u.rank===s.rank,(()=>`Rank of input (${u.rank}) does not match rank of dy (${s.rank})`)),se.hu(4===s.rank,(()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${s.rank}.`)),se.hu(4===u.rank,(()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${u.rank}.`)),ue.m("maxPoolGrad",o,a);const c={dy:s,input:u,output:l},p={filterSize:r,strides:i,pad:o,dimRoundingMode:a};return oe.BV.runKernel(R.OV7,c,p)}}),Ft={kernelName:R.mTV,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{filterSize:o,strides:a,pad:s}=n;return{x:()=>At(e,r,i,o,a,s)}}};var Ot=__webpack_require__(4917);const Rt={kernelName:R.q2K,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n,o=se.EC(i,r.shape),a=(0,je.kz)(r.shape,o)[1],s=se.NA(a);return{x:()=>{const t=r.shape.slice();o.forEach((e=>{t[e]=1}));const n=(0,H.X)(e,t);return(0,L.h)((0,D.d)(n,(0,Ot.i)(r.shape,"float32")),s)}}}},Nt={kernelName:R.c17,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{axis:i}=r,[o,a]=t,s=kt(e,a,o,se.EC(i,o.shape));return{x:()=>s.x()}}},Dt={kernelName:R.q8u,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>(0,D.d)(e,(0,N.p)((0,we.z)(n,r),"float32")),b:()=>(0,D.d)(e,(0,N.p)((0,gt.p)(n,r),"float32"))}}};var It=__webpack_require__(2676);const Bt={kernelName:R.jQs,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:i}=n,o=i.map((e=>e[0]));return{x:()=>(0,It.t)(e,o,r.shape)}}};var Lt=__webpack_require__(6943);const Pt={kernelName:R.Vbg,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=(0,V.assertAndGetBroadcastShape)(n.shape,r.shape);return{a:()=>{const t=(0,V.getReductionAxes)(n.shape,i);return t.length>0?(0,H.X)((0,q.S)(e,t),n.shape):e},b:()=>{const t=(0,D.d)(e,(0,P.W)((0,Lt.G)((0,L.h)(n,r)))),o=(0,V.getReductionAxes)(r.shape,i);return o.length>0?(0,H.X)((0,q.S)(t,o),r.shape):t}}}},$t={kernelName:R.wYn,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=(0,V.assertAndGetBroadcastShape)(n.shape,r.shape);return{a:()=>{const t=(0,D.d)(e,(0,N.p)(r,"float32")),o=(0,V.getReductionAxes)(n.shape,i);return o.length>0?(0,H.X)((0,q.S)(t,o),n.shape):t},b:()=>{const t=(0,D.d)(e,(0,N.p)(n,"float32")),o=(0,V.getReductionAxes)(r.shape,i);return o.length>0?(0,H.X)((0,q.S)(t,o),r.shape):t}}}},zt={kernelName:R.kuV,gradFunc:e=>({x:()=>(0,P.W)(e)})};var jt=__webpack_require__(723);const Gt={kernelName:R.we_,inputsToSave:["indices"],gradFunc:(e,t)=>{const n=t[0];return{indices:()=>(0,jt.l)(n.shape,"float32")}}},Ut={kernelName:R.qWM,gradFunc:e=>({x:()=>(0,K.P)(e)})};var Wt=__webpack_require__(4136);const Vt={kernelName:R.QiL,saveAllInputs:!0,gradFunc:(e,t,n)=>{const{axis:r}=n;return(0,Wt.H)(e,r).map((e=>()=>e))}},Ht={kernelName:R.lyA,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:i}=n,o=i.map((e=>e[0]));return{x:()=>(0,It.t)(e,o,r.shape)}}};var qt=__webpack_require__(2597),Xt=__webpack_require__(3453);const Yt={kernelName:R.pe_,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{const[n,r,i]=t,o=n,a=r,s=V.assertAndGetBroadcastShape(o.shape,a.shape);return{a:()=>{const t=(0,N.p)(a,"float32");let n=(0,D.d)(e,(0,D.d)(t,(0,Xt.s)(o,(0,G.l)(t,(0,$.i)(1)))));const r=V.getReductionAxes(o.shape,s);return r.length>0&&(n=(0,q.S)(n,r)),(0,H.X)(n,o.shape)},b:()=>{const t=(0,gt.p)(o,0),n=(0,Se.a)(t,(0,qt.c)(o),(0,K.P)(o));let r=(0,D.d)(e,(0,D.d)(i,n));const u=V.getReductionAxes(a.shape,s);return u.length>0&&(r=(0,q.S)(r,u)),(0,H.X)(r,a.shape)}}}},Kt={kernelName:R.o0g,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{const[n,r]=t,i=(0,gt.p)(n,0);return{x:()=>(0,Se.a)(i,e,(0,D.d)(e,r)),alpha:()=>{let t=(0,Se.a)(i,(0,K.P)(e),(0,D.d)(e,n));const o=(0,V.getReductionAxes)(r.shape,e.shape);return o.length>0&&(t=(0,q.S)(t,o)),(0,H.X)(t,r.shape)}}}};var Jt=__webpack_require__(9640);const Zt={kernelName:R.DlI,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n;let o=[];return o=null==i?r.shape.map(((e,t)=>t)):"number"==typeof i?[i]:i,{x:()=>function(e,t,n){const r=e.shape.length,i=r-n.length,o=je.Q3(n,r);let a=e;null!=o&&(a=(0,Ue.p)(e,o));const s=a.shape.slice(),u=s.splice(r-n.length,n.length).reduce(((e,t)=>e*t),1);s.push(u);let l=function(e,t,n){const r=e.shape.slice();r[n]=1;const i=(0,H.X)(t,r),o=(0,Jt.$)(e,n,!0,!1),a=(0,Jt.$)(e,n,!0,!0),s=(0,D.d)(o,a);return(0,D.d)(i,s)}(a.reshape(s),t,i);if(l=l.reshape(a.shape),null!=o){const e=je.LJ(o);l=(0,Ue.p)(l,e)}return l}(r,e,o)}}},Qt={kernelName:R.oHH,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=V.assertAndGetBroadcastShape(n.shape,r.shape);return{a:()=>{const t=(0,L.h)(e,(0,N.p)(r,"float32")),o=V.getReductionAxes(n.shape,i);return o.length>0?(0,H.X)((0,q.S)(t,o),n.shape):t},b:()=>{let t=(0,D.d)(e,(0,N.p)(n,"float32"));const o=V.getReductionAxes(r.shape,i);o.length>0&&(t=(0,H.X)((0,q.S)(t,o),r.shape));const a=(0,j.h)(r);return(0,P.W)((0,L.h)(t,(0,N.p)(a,"float32")))}}}},en={kernelName:R.$HU,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,L.h)(e,(0,P.W)((0,j.h)(n)))}}},tn={kernelName:R.SbG,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=(0,D.d)((0,we.z)(n,6),(0,I.N)(n));return{x:()=>(0,D.d)(e,(0,N.p)(r,"float32"))}}},nn={kernelName:R.qkr,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,D.d)(e,(0,N.p)((0,I.N)(n),"float32"))}}},rn={kernelName:R.HZH,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,H.X)(e,n.shape)}}},on={kernelName:R._Yw,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,i={dy:e,images:r};return{images:()=>oe.BV.runKernel(R.zbQ,i,n)}}},an={kernelName:R.dpD,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,i={dy:e,images:r};return{images:()=>oe.BV.runKernel(R.Hmb,i,n)}}};var sn=__webpack_require__(7486);const un={kernelName:R.mKl,gradFunc:(e,t,n)=>{const{dims:r}=n,i=(0,se.EC)(r,e.shape);return{x:()=>(0,sn.G)(e,i)}}},ln={kernelName:R.e07,gradFunc:e=>({x:()=>(0,K.P)(e)})},cn={kernelName:R.bV0,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,P.W)((0,L.h)(e,(0,D.d)((0,Xt.s)(n,1.5),2)))}}};var pn=__webpack_require__(8651);const dn={kernelName:R.PhF,inputsToSave:["condition"],gradFunc:(e,t)=>{const[n]=t;return{condition:()=>(0,N.p)((0,K.P)(n),"float32"),t:()=>(0,D.d)(e,(0,N.p)(n,e.dtype)),e:()=>(0,D.d)(e,(0,N.p)((0,pn.h)(n),e.dtype))}}};var hn=__webpack_require__(3179);const fn={kernelName:R.oFR,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=(0,gt.p)(n,(0,$.i)(0)),r=(0,$.i)(hn.y),i=(0,$.i)(hn.$),o=(0,D.d)(e,i),a=(0,D.d)((0,D.d)(e,r),(0,Ke.Q)((0,N.p)(n,"float32")));return(0,Se.a)(t,o,a)}}}},gn={kernelName:R.a5O,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,D.d)(e,(0,D.d)(n,(0,G.l)((0,$.i)(1),n)))}}},mn={kernelName:R.i5y,gradFunc:e=>({x:()=>(0,K.P)(e)})};var yn=__webpack_require__(173);const bn={kernelName:R.RQH,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,D.d)((0,yn.m)((0,N.p)(n,"float32")),e)}}};var vn=__webpack_require__(2699);const xn={kernelName:R.wYB,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,D.d)((0,vn.f)((0,N.p)(n,"float32")),e)}}};var _n=__webpack_require__(9682),wn=__webpack_require__(7650);const kn={kernelName:R.p2w,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{begin:i,size:o}=n,a=r.shape,[s,u]=(0,wn.parseSliceParams)(r,i,o),l=[];for(let t=0;t<e.rank;t++)l.push([s[t],a[t]-s[t]-u[t]]);return{x:()=>(0,_n.v)(e,l)}}},Sn={kernelName:R.Gcp,outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{dim:i}=n,o=(0,D.d)(e,r);return{logits:()=>(0,G.l)(o,(0,D.d)((0,q.S)(o,[i],!0),r))}}};var Cn=__webpack_require__(625);const Mn={kernelName:R.MRv,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,D.d)(e,(0,Cn.X)(n))}}};var Tn=__webpack_require__(8441);const En={kernelName:R.TQc,gradFunc:(e,t,n)=>{const{blockShape:r,paddings:i}=n;return{x:()=>(0,Tn.E)(e,r,i)}}};var An=__webpack_require__(6884);const Fn={kernelName:R.L8s,gradFunc:(e,t,n)=>{const{axis:r}=n;return{x:()=>(0,An.z)(e,r)}}},On={kernelName:R.FKq,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,L.h)(e,(0,D.d)((0,z._)((0,N.p)(n,"float32")),2))}}},Rn={kernelName:R.bK0,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,D.d)(e,(0,D.d)((0,N.p)(n,"float32"),2))}}},Nn={kernelName:R._tC,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=(0,$.i)(2);return{a:()=>(0,D.d)(e,(0,D.d)(i,(0,G.l)(n,r))),b:()=>(0,D.d)(e,(0,D.d)(i,(0,G.l)(r,n)))}}},Dn={kernelName:R.h8e,gradFunc:e=>({x:()=>(0,K.P)(e)})},In={kernelName:R.Tr8,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=V.assertAndGetBroadcastShape(n.shape,r.shape);return{a:()=>{let t=e;const r=V.getReductionAxes(n.shape,i);return r.length>0&&(t=(0,q.S)(t,r)),(0,H.X)(t,n.shape)},b:()=>{let t=e;const n=V.getReductionAxes(r.shape,i);return n.length>0&&(t=(0,q.S)(t,n)),(0,H.X)((0,P.W)(t),r.shape)}}}},Bn={kernelName:R.GBy,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,i=r.shape.slice(),{axis:o}=n;(0,se.EC)(o,r.shape).forEach((e=>{i[e]=1}));const a=(0,H.X)(e,i),s=(0,D.d)(a,(0,Ot.i)(r.shape,"float32"));return{x:()=>s}}},Ln={kernelName:R.sEM,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,L.h)(e,(0,j.h)((0,yn.m)(n)))}}},Pn={kernelName:R.MIZ,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>(0,D.d)((0,G.l)((0,$.i)(1),(0,j.h)(n)),e)}}},$n={kernelName:R.n9L,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{reps:i}=n;return{x:()=>{let t=(0,K.P)(r);if(1===r.rank)for(let n=0;n<i[0];++n)t=(0,ee.I)(t,(0,It.t)(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<i[0];++n)for(let o=0;o<i[1];++o)t=(0,ee.I)(t,(0,It.t)(e,[n*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<i[0];++n)for(let o=0;o<i[1];++o)for(let a=0;a<i[2];++a)t=(0,ee.I)(t,(0,It.t)(e,[n*r.shape[0],o*r.shape[1],a*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);for(let n=0;n<i[0];++n)for(let o=0;o<i[1];++o)for(let a=0;a<i[2];++a)for(let s=0;s<i[3];++s)t=(0,ee.I)(t,(0,It.t)(e,[n*r.shape[0],o*r.shape[1],a*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},zn={kernelName:R.G3Y,gradFunc:(e,t,n)=>{const r=n,{perm:i}=r,o=je.LJ(i);return{x:()=>(0,Ue.p)(e,o)}}};var jn=__webpack_require__(2991);const Gn={kernelName:R.ToN,gradFunc:(e,t,n)=>{const r=n,{axis:i}=r;return{value:()=>(0,jn.k)(e,i)}}};var Un=__webpack_require__(1300),Wn=__webpack_require__(4926),Vn=__webpack_require__(632);const Hn={kernelName:R.Qvg,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>function(e,t){const n=(0,Vn.g)(t,(0,K.P)(t)),r=(0,Wn.I)(e,n);let i=(0,_e.b)(t,(0,$.i)(0,"int32"));const o=r.rank-i.rank;for(let e=0;e<o;++e)i=(0,Un.d)(i,e+1);i=(0,ke.H)(i,(0,Ot.i)(r.shape,"bool"));const a=(0,K.P)(r);return(0,Se.a)(i,r,a)}(e,n)}}},qn={kernelName:R.RuY,gradFunc:e=>({x:()=>(0,K.P)(e)})};var Xn=__webpack_require__(6151);const Yn=[B,U,W,X,Y,J,Z,Q,te,ne,re,ie,pe,he,ge,ye,be,ve,xe,Ce,Me,Ee,Ne,Oe,Be,Pe,ze,We,qe,Xe,Qt,Ye,Je,Ze,Qe,et,nt,tt,ot,st,ct,pt,dt,ht,ft,mt,yt,bt,vt,_t,St,St,Mt,Et,Ft,Rt,Nt,Dt,Bt,Pt,$t,zt,Gt,Ut,Vt,Ht,Ht,Yt,Kt,Zt,en,tn,nn,rn,on,an,un,ln,cn,dn,fn,gn,mn,bn,xn,kn,Sn,Mn,En,En,Fn,Fn,On,Nn,Rn,Dn,In,Bn,Ln,Pn,$n,zn,Gn,Hn,qn];for(const e of Yn)(0,Xn.Li)(e);__webpack_require__(330);class Kn extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Kn.prototype)}}class Jn extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Jn.prototype)}}class Zn extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Zn.prototype)}}class Qn extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Qn.prototype)}}class er extends Error{constructor(e){super(e),Object.setPrototypeOf(this,er.prototype)}}class tr{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const e=this.cache.keys().next().value;this.cache.delete(e)}this.maxEntries=e}}function nr(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}{const n=new Array(t);return n.fill(e),n}}function rr(e,t){if(!e)throw new er(t)}function ir(e,t){let n=0;for(const r of e)r===t&&n++;return n}function or(e){return 1===e.length?e[0]:e}function ar(e){return Array.isArray(e)?e:[e]}function sr(e){const t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function ur(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,((e,t)=>t.toUpperCase()))}let lr={};function cr(e){if(null==e)return null;const t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function pr(e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))e.forEach((e=>pr(e)));else{const t=Object.keys(e);for(const n of t){const t=e[n];null!=t&&"object"==typeof t&&(Array.isArray(t)||"ndarray"!==t.type||"number"!=typeof t.value?pr(t):e[n]=t.value)}}}function dr(e,t={},n={},r="object",i=!1){if("string"==typeof e){const i=e;let o;if(i in n)o=n[i];else if(i in lr)o=lr[i];else if(o=t[i],null==o)throw new Zn(`Unknown ${r}: ${e}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}{const o=e;if(null==o.className||null==o.config)throw new Zn(`${r}: Improper config format: ${JSON.stringify(o)}.\n'className' and 'config' must set.`);const a=o.className;let s,u;if(a in n?[s,u]=n[a]:a in lr?[s,u]=lr.className:a in t&&([s,u]=t[a]),null==s)throw new Zn(`Unknown ${r}: ${a}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(null!=u){const e={};for(const t of Object.keys(lr))e[t]=lr[t];for(const t of Object.keys(n))e[t]=n[t];o.config.customObjects=e;const t=Object.assign({},lr);for(const e of Object.keys(n))lr[e]=n[e];pr(o.config);const r=u(s,o.config,n,i);return lr=Object.assign({},t),r}{const e=Object.assign({},lr);for(const e of Object.keys(n))lr[e]=n[e];const t=new s(o.config);return lr=Object.assign({},e),t}}}function hr(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function fr(e){if(null==e)return e;const t=[];for(const n of e)-1===t.indexOf(n)&&t.push(n);return t}function gr(e){if(null==e)throw new Zn(`Invalid value in obj: ${JSON.stringify(e)}`);for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}function mr(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new Zn(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function yr(e,t,n=0,r=1/0){return rr(n>=0),rr(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((e=>typeof e===t))}function br(e,t){Array.isArray(e)?(O.util.assert(e.length>0,(()=>`${t} is unexpectedly an empty array.`)),e.forEach(((e,n)=>br(e,`element ${n+1} of ${t}`)))):O.util.assert(Number.isInteger(e)&&e>0,(()=>`Expected ${t} to be a positive integer, but got ${vr(e)}.`))}function vr(e){return null===e?"null":Array.isArray(e)?"["+e.map((e=>vr(e))).join(",")+"]":"string"==typeof e?`"${e}"`:`${e}`}function xr(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}let _r=0;function wr(){return _r++}const kr={};function Sr(e=""){return e in kr||(kr[e]=0),kr[e]+=1,e+kr[e].toString()}const Cr=["channelsFirst","channelsLast"],Mr=["nearest","bilinear"],Tr=["valid","same","causal"],Er=["max","avg"],Ar=["sum","mul","concat","ave"],Fr=new Map;function Or(e){mr(Cr,"DataFormat",e)}function Rr(e){mr(Tr,"PaddingMode",e)}function Nr(e){mr(Er,"PoolMode",e)}const Dr=[];function Ir(e,t){Dr.push(e);try{const e=t();return Dr.pop(),e}catch(e){throw Dr.pop(),e}}function Br(e){if(!$r(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===Dr.length?"":Dr.join("/")+"/")+e}function Lr(e){if(!$r(e))throw new Error("Not a valid tensor name: '"+e+"'");Fr.has(e)||Fr.set(e,0);const t=Fr.get(e);if(Fr.set(e,Fr.get(e)+1),t>0){const n=`${e}_${t}`;return Fr.set(n,1),n}return e}const Pr=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function $r(e){return!!e.match(Pr)}function zr(e,t,n){null==t&&(t=0),null==n&&(n=e.length);let r=1;for(let i=t;i<n;++i)r*=e[i];return r}function jr(e){if(0===e.length)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r<t&&(t=r)}return t}function Gr(e){if(0===e.length)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r>t&&(t=r)}return t}function Ur(e,t){if(t<e)throw new Zn(`end (${t}) < begin (${e}) is forbidden.`);const n=[];for(let r=e;r<t;++r)n.push(r);return n}let Wr;function Vr(){return null==Wr&&(Wr=(0,O.backend)().epsilon()),Wr}function Hr(e,t){return O.cast(e,t)}function qr(e,t=-1){const n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),O.reshape(e,n)}function Xr(e,t,n){return(0,O.tidy)((()=>{switch(e.rank){case 1:return O.slice1d(e,t,n);case 2:return O.slice2d(e,[t,0],[n,e.shape[1]]);case 3:return O.slice3d(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return O.slice4d(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return O.slice(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return O.slice(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new Zn(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}))}function Yr(e,t,n){return(0,O.tidy)((()=>{switch(e.rank){case 1:return O.slice1d(e,t,n);case 2:return O.slice2d(e,[0,t],[e.shape[0],n]);case 3:return O.slice3d(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return O.slice4d(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new Zn(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}}))}function Kr(e,t,n,r){return(0,O.tidy)((()=>{switch(e.rank){case 1:return O.slice1d(e,t,n);case 2:switch(r){case 1:return Xr(e,t,n);case 2:return Yr(e,t,n);default:throw new Zn(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return Xr(e,t,n);case 2:return O.slice3d(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return Yr(e,t,n);default:throw new Zn(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return Xr(e,t,n);case 2:return O.slice4d(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return O.slice4d(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return Yr(e,t,n);default:throw new Zn(`The axis is not within the rank of the tensor ${r}`)}default:throw new Zn(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}}))}function Jr(e,t=-1){let n;return t<0&&(n=e[0].rank,t=0!==n?n:0),t===e[0].rank&&(t=-1),O.concat(e,t)}function Zr(e,t){switch(e.rank){case 1:return O.concat1d([e,t]);case 2:return O.concat2d([e,t],0);case 3:return O.concat3d([e,t],0);case 4:return O.concat4d([e,t],0);default:throw new Zn(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function Qr(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new Zn(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return O.tile(e,t)}function ei(e,t=0,n=1,r,i){return O.randomNormal(e,t,n,r,i)}function ti(e,t,n,r){if(e.rank<2||t.rank<2)throw new Qn(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3&&e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new Qn(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`);if(2===e.rank&&2===t.rank){const i=!1,o=!1;return O.fused.matMul({a:e,b:t,transposeA:i,transposeB:o,bias:r?ii(e.rank,r,"channelsLast"):null,activation:n})}{const i=e.shape.slice(),o=i.pop();e=O.reshape(e,[-1,o]);const a=t.shape.slice(),s=a.pop(),u=a.pop(),l=[...a,s],c=Array.from({length:t.rank},((e,n)=>0===n?t.rank-2:n<=t.rank-2?n-1:n));t=O.reshape(O.transpose(t,c),[u,-1]);const p=[...i,...l],d=!1,h=!1;return O.reshape(O.fused.matMul({a:e,b:t,transposeA:d,transposeB:h,bias:r?ii(e.rank,r,"channelsLast"):null,activation:n}),p)}}function ni(e,t,n){return(0,O.tidy)((()=>(t=Array.isArray(t)?(0,O.tensor1d)(t,"int32"):O.cast(t,"int32"),O.gather(e,t,n))))}function ri(e){return O.mul(e,e)}function ii(e,t,n){const r=t.shape;if(1!==t.rank&&t.rank!==e)throw new Zn(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(5===e){if("channelsFirst"===n)return 1===r.length?O.reshape(t,[1,r[0],1,1,1]):O.reshape(t,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?O.reshape(t,[1,1,1,1,r[0]]):O.reshape(t,[1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?O.reshape(t,[1,r[0],1,1]):O.reshape(t,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?O.reshape(t,[1,1,1,r[0]]):O.reshape(t,[1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?O.reshape(t,[1,r[0],1]):O.reshape(t,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?O.reshape(t,[1,1,r[0]]):O.reshape(t,[1].concat(r))}else if(e<3)return t;throw new Zn(`Unsupported input rank by biasAdd: ${t.rank}`)}function oi(e,t,n){return(0,O.tidy)((()=>(null==n&&(n="channelsLast"),Or(n),O.add(e,ii(e.rank,t,n)))))}function ai(e,t,n,r){return(0,O.tidy)((()=>O.dropout(e,t,n,r)))}function si(e,t,n=!1){return n?e():t()}const ui=["fanIn","fanOut","fanAvg"],li=["normal","uniform","truncatedNormal"];class ci extends O.serialization.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class pi extends ci{apply(e,t){return(0,O.zeros)(e,t)}}pi.className="Zeros",O.serialization.registerClass(pi);class di extends ci{apply(e,t){return(0,O.ones)(e,t)}}di.className="Ones",O.serialization.registerClass(di);class hi extends ci{constructor(e){if(super(),"object"!=typeof e)throw new Zn(`Expected argument of type ConstantConfig but got ${e}`);if(void 0===e.value)throw new Zn(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return(0,O.tidy)((()=>(0,O.mul)((0,O.scalar)(this.value),(0,O.ones)(e,t))))}getConfig(){return{value:this.value}}}hi.className="Constant",O.serialization.registerClass(hi);class fi extends ci{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return(0,O.randomUniform)(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}fi.className="RandomUniform",O.serialization.registerClass(fi);class gi extends ci{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Qn(`randomNormal does not support dType ${t}.`);return ei(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}gi.className="RandomNormal",O.serialization.registerClass(gi);class mi extends ci{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Qn(`truncatedNormal does not support dType ${t}.`);return(0,O.truncatedNormal)(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}mi.className="TruncatedNormal",O.serialization.registerClass(mi);class yi extends ci{constructor(e){super(),this.gain=null!=e.gain?e.gain:1}apply(e,t){return(0,O.tidy)((()=>{if(2!==e.length||e[0]!==e[1])throw new Zn("Identity matrix initializer can only be used for 2D square matrices.");return(0,O.mul)(this.gain,(0,O.eye)(e[0]))}))}getConfig(){return{gain:this.gain}}}yi.className="Identity",O.serialization.registerClass(yi);class bi extends ci{constructor(e){if(super(),e.scale<0)throw new Zn(`scale must be a positive float. Got: ${e.scale}`);var t;this.scale=null==e.scale?1:e.scale,this.mode=null==e.mode?"fanIn":e.mode,t=this.mode,mr(ui,"FanMode",t),this.distribution=null==e.distribution?"normal":e.distribution,function(e){mr(li,"Distribution",e)}(this.distribution),this.seed=e.seed}apply(e,t){const n=function(e,t="channelsLast"){let n,r;if(Or(t),2===e.length)n=e[0],r=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===t){const t=zr(e,2);n=e[1]*t,r=e[0]*t}else if("channelsLast"===t){const t=zr(e,0,e.length-2);n=e[e.length-2]*t,r=e[e.length-1]*t}}else{const t=zr(e);n=Math.sqrt(t),r=Math.sqrt(t)}return[n,r]}(e),r=n[0],i=n[1];let o=this.scale;if("fanIn"===this.mode?o/=Math.max(1,r):"fanOut"===this.mode?o/=Math.max(1,i):o/=Math.max(1,(r+i)/2),"normal"===this.distribution){const n=Math.sqrt(o);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Qn(`${this.getClassName()} does not support dType ${t}.`);return(0,O.truncatedNormal)(e,0,n,t,this.seed)}{const n=Math.sqrt(3*o);return(0,O.randomUniform)(e,-n,n,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}bi.className="VarianceScaling",O.serialization.registerClass(bi);class vi extends bi{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return bi.className}}vi.className="GlorotUniform",O.serialization.registerClass(vi);class xi extends bi{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return bi.className}}xi.className="GlorotNormal",O.serialization.registerClass(xi);class _i extends bi{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return bi.className}}_i.className="HeNormal",O.serialization.registerClass(_i);class wi extends bi{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return bi.className}}wi.className="HeUniform",O.serialization.registerClass(wi);class ki extends bi{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return bi.className}}ki.className="LeCunNormal",O.serialization.registerClass(ki);class Si extends bi{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return bi.className}}Si.className="LeCunUniform",O.serialization.registerClass(Si);class Ci extends ci{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=null==e.gain?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return(0,O.tidy)((()=>{if(e.length<2)throw new Qn("Shape must be at least 2D.");if("int32"!==t&&"float32"!==t&&void 0!==t)throw new TypeError(`Unsupported data type ${t}.`);const n=O.util.sizeFromShape(e.slice(0,-1)),r=e[e.length-1],i=n*r;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=ei([Math.max(r,n),Math.min(r,n)],0,1,t,this.seed),a=O.linalg.qr(o,!1);let s=a[0];const u=a[1].flatten().stridedSlice([0],[Math.min(r,n)*Math.min(r,n)],[Math.min(r,n)+1]);return s=(0,O.mul)(s,u.sign()),n<r&&(s=s.transpose()),(0,O.mul)((0,O.scalar)(this.gain),s.reshape(e))}))}getConfig(){return{gain:this.gain,seed:this.seed}}}Ci.className="Orthogonal",O.serialization.registerClass(Ci);const Mi={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Ti(e,t={}){return dr(e,O.serialization.SerializationMap.getMap().classNameMap,t,"initializer")}function Ei(e){return cr(e)}function Ai(e){if("string"==typeof e){const t=e in Mi?Mi[e]:e;if("GlorotNormal"===t)return new xi;if("GlorotUniform"===t)return new vi;if("HeNormal"===t)return new _i;if("HeUniform"===t)return new wi;if("LeCunNormal"===t)return new ki;if("LeCunUniform"===t)return new Si;{const e={};return e.className=t,e.config={},Ti(e)}}return e instanceof ci?e:Ti(e)}function Fi(e){return Array.isArray(e)&&Array.isArray(e[0])}function Oi(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function Ri(e){let t;if(Array.isArray(e)){if(1!==e.length)throw new Zn(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function Ni(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new Zn(`Expected exactly 1 Shape; got ${e.length}`)}return e}function Di(e){let t=0;for(const n of e)0===n.shape.length?t+=1:t+=n.shape.reduce(((e,t)=>e*t));return t}const Ii="Variable";class Bi{constructor(e,t="float32",n=Ii,r=!0,i=null){this.dtype=null==t?"float32":t,this.shape=e.shape,this.id=wr(),n=null==n?Ii:n,this.originalName=Br(n),this.name=Lr(this.originalName),this.trainable_=r,this.constraint=i,this.val=O.variable(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function Li(e){return e.map((e=>e.read()))}function Pi(e){e.forEach((e=>{e[0].write(e[1])}))}class $i{constructor(e){this.dtype=e.dtype,this.shape=e.shape,null!=e.shape?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class zi{constructor(e,t,n,r,i,o,a){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=a,this.id=wr(),null!=o&&(this.originalName=Br(o),this.name=Lr(this.originalName)),this.rank=t.length}}let ji=0;class Gi{constructor(e,t){this.callArgs=t,this.id=ji++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const t of e.inboundLayers)null!=t&&t.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)null!=t?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let Ui=0;class Wi extends O.serialization.Serializable{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Ui++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const e=this.getClassName();t=sr(e)+"_"+Sr(e)}if(this.name=t,this.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){let t;if(null!=e.batchInputShape)t=e.batchInputShape;else if(null!=e.inputShape){let n=null;null!=e.batchSize&&(n=e.batchSize),t=[n].concat(e.inputShape)}this.batchInputShape=t;let n=e.dtype;null==n&&(n=e.inputDType),null==n&&(n="float32"),this.dtype=n}null!=e.weights?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(0===this.inboundNodes.length)throw new Jn(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new Zn(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return or(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return or(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Kn(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(0===this.inboundNodes.length)throw new Kn(`Layer ${this.name} is not connected, no input to return.`);return or(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new Kn(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Kn(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return or(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map((e=>e()))}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach((t=>t.trainable=e)),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter((e=>e.trainable)):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter((e=>!e.trainable)).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){if(e=ar(e),null==this.inputSpec||0===this.inputSpec.length)return;const t=ar(this.inputSpec);if(e.length!==t.length)throw new Zn(`Layer ${this.name} expects ${t.length} inputs, but it received ${e.length} input tensors. Input received: ${e}`);for(let n=0;n<e.length;n++){const r=e[n],i=t[n];if(null==i)continue;const o=r.rank;if(null!=i.ndim&&o!==i.ndim)throw new Zn(`Input ${n} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${o}`);if(null!=i.maxNDim&&o>i.maxNDim)throw new Zn(`Input ${n} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${o}`);if(null!=i.minNDim&&o<i.minNDim)throw new Zn(`Input ${n} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${o}.`);if(null!=i.dtype&&r.dtype!==i.dtype)throw new Zn(`Input ${n} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${r.dtype}.`);if(i.axes){const e=r.shape;for(const t in i.axes){const r=Number(t),o=i.axes[t],a=r>=0?e[r]:e[e.length+r];if(null!=o&&-1===[o,null].indexOf(a))throw new Zn(`Input ${n} is incompatible with layer ${this.name}: expected axis ${r} of input shape to have value ${o} but got shape ${e}.`)}}if(null!=i.shape)for(let e=0;e<i.shape.length;++e){const t=i.shape[e],o=r.shape[e];if(null!=t&&null!=o&&t!==o)throw new Zn(`Input ${n} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${r.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){null!=this._callHook&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const n=ar(e);let r=!0;for(const e of n)if(!(e instanceof zi)){r=!1;break}let i=!0;for(const e of n)if(e instanceof zi){i=!1;break}if(r===i)throw new Zn("Arguments to apply() must be all SymbolicTensors or all Tensors");return Ir(this.name,(()=>{if(!this.built){this.assertInputCompatibility(e);const t=[];for(const n of ar(e))t.push(n.shape);this.build(or(t)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let r=this.call(e,t);const i=ar(r),o=[];for(let e of i)-1!==n.indexOf(e)&&(e=e.clone()),o.push(e);if(r=or(o),null!=this.activityRegularizer)throw new Qn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}{const n=function(e){e=ar(e);const t=[];for(const n of e)t.push(n.shape);return or(t)}(e),r=this.computeOutputShape(n);let i;const o="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(e)?n[0]:n),i=null!=r&&r.length>0&&Array.isArray(r[0])?r.map(((n,r)=>new zi(o,n,this,ar(e),t,this.name,r))):new zi(o,r,this,ar(e),t,this.name),this.addInboundNode(e,i,null,null,n,r,t),this._refCount++,null!=this.activityRegularizer)throw new Qn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}}))}warnOnIncompatibleInputShape(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach(((n,r)=>{null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new Kn(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const t of this.inboundNodes){const n=JSON.stringify(t.outputShapes);-1===e.indexOf(n)&&e.push(n)}if(1===e.length){const e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&1===e.length?e[0]:e}throw new Kn(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Jn(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Di(this.weights)}build(e){this.built=!0}getWeights(e=!1){return Li(e?this.trainableWeights:this.weights)}setWeights(e){(0,O.tidy)((()=>{const t=this.weights;if(t.length!==e.length)throw new Zn(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(0===t.length)return;const n=[],r=Li(t);for(let i=0;i<r.length;++i){const o=r[i],a=t[i],s=e[i];if(!O.util.arraysEqual(o.shape,s.shape))throw new Zn(`Layer weight shape ${o.shape} not compatible with provided weight shape ${s.shape}`);n.push([a,s])}Pi(n)}))}addWeight(e,t,n,r,i,o,a,s){if(-1!==this._addedWeightNames.indexOf(e))throw new Zn(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=s?s():Ai("zeros"));const u=r.apply(t,n),l=new Bi(u,n,e,o,a);return u.dispose(),null!=i&&this.addLoss((()=>i.apply(l.read()))),null==o&&(o=!0),o?this._trainableWeights.push(l):this._nonTrainableWeights.push(l),l}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){null==e||Array.isArray(e)&&0===e.length||(e=ar(e),void 0!==this._losses&&null!==this._losses&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);t.forEach((e=>{if(null!=e)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)}))}return null}return t}addInboundNode(e,t,n,r,i,o,a=null){const s=ar(e);t=ar(t),n=ar(n),r=ar(r),i=Oi(i),o=Oi(o);const u=[],l=[],c=[];for(const e of s)u.push(e.sourceLayer),l.push(e.nodeIndex),c.push(e.tensorIndex);new Gi({outboundLayer:this,inboundLayers:u,nodeIndices:l,tensorIndices:c,inputTensors:s,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:i,outputShapes:o},a);for(let e=0;e<t.length;e++)t[e].sourceLayer=this,t[e].nodeIndex=this.inboundNodes.length-1,t[e].tensorIndex=e}getConfig(){const e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach((e=>e.dispose())),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(null===this._refCount)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return 0==--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function Vi(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];{const e=t.inboundNodes[n];if(0===e.inboundLayers.length)return e.inputTensors;{const t=[];for(let n=0;n<e.inboundLayers.length;n++){const r=Vi(e.inputTensors[n],e.inboundLayers[n],e.nodeIndices[n]);for(const e of r)-1===t.indexOf(e)&&t.push(e)}return t}}}class Hi extends Wi{constructor(e){if(super({dtype:e.dtype,name:null!=e.name?e.name:Sr("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new Zn("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(null==t){if(null==e.inputShape)throw new Zn("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new Zn("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];const r=new zi(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Gi({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new Zn(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}function qi(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new Zn("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));let n=e.dtype;return null==n&&(n="float32"),new Hi({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}Hi.className="InputLayer",O.serialization.registerClass(Hi);class Xi{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Xi)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(null==e)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,n){if(null!=this.id2Value[e.id])throw new Zn(`Duplicate key: name=${e.name}, id=${e.id}`);return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return(0,O.cast)(t,e.dtype)}catch(n){throw new Zn(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return null!=this.id2Value[e.id]}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof zi){if(null==this.id2Value[e.id])throw new Zn(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}{const t=this.name2Id[e];if(null==t)throw new Zn(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof zi){if(null==this.id2Value[e.id])throw new Zn(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}{const t=this.name2Id[e];if(null==t)throw new Zn(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){null!=this.id2Mask&&(0,O.dispose)(this.id2Mask)}}const Yi=new tr,Ki=new tr;function Ji(e,t,n,r){const i=null!=n&&n.training,o=Array.isArray(e),a=o?e:[e],s=a.map((e=>e.name)),u=[],l=t.names();for(const e of s)-1!==l.indexOf(e)?u.push(t.getValue(e)):u.push(null);null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const c=s.join(",")+"|"+t.names().sort().join(",");let p,d=Yi.get(c);if(null==d){const e=function(e,t){O.util.assert(null!=e&&e.length>0,(()=>"Expected at least one fetch, got none"));let n=[],r={};if(1===e.length){const i=Qi(e[0],t);n=i.sorted,r=i.recipientMap}else{const i=new Set;for(const o of e){const{sorted:e,recipientMap:a}=Qi(o,t);for(const t of e)i.has(t.name)||(n.push(t),i.add(t.name));for(const e in a)null==r[e]&&(r[e]=new Set),a[e].forEach((t=>r[e].add(t)))}}return{sorted:n,recipientCounts:Zi(r)}}(a,t);d=e.sorted,p=e.recipientCounts,Yi.put(c,d),Ki.put(c,p)}p={},i||Object.assign(p,Ki.get(c));const h=new Xi(t);for(let e=0;e<d.length;++e){if(null!=r){const e=(0,O.memory)().numTensors;e>r.maxNumTensors&&(r.maxNumTensors=e),e<r.minNumTensors&&(r.minNumTensors=e)}const o=d[e],a=o.sourceLayer;if(a instanceof Hi)continue;const l=[],c=[],f=[];let g=!1;for(const e of o.inputs){const n=h.getValue(e),r=h.getMask(e);l.push(n),c.push(r),null!=r&&(g=!0),i||(p[e.name]--,0!==p[e.name]||t.hasKey(e)||-1!==s.indexOf(e.name)||n.isDisposed||!0===e.sourceLayer.stateful||f.push(n))}g&&((n=n||{}).mask=c[0]);const m=ar(a.apply(l,n));let y=null;a.supportsMasking&&(y=a.computeMask(l,c));const b=eo(o),v=Array.isArray(b)?b:[b];for(let e=0;e<v.length;++e){h.hasKey(v[e])||h.add(v[e],m[e],Array.isArray(y)?y[0]:y);const t=s.indexOf(v[e].name);-1!==t&&(u[t]=m[e])}i||(0,O.dispose)(f)}return h.disposeMasks(),o?u:u[0]}function Zi(e){const t={};for(const n in e)t[n]=e[n].size;return t}function Qi(e,t){const n=new Set,r=[],i={};for(const e of t.names())n.add(e);const o=[],a=[];for(o.push(e);o.length>0;){const e=o[o.length-1];if(n.has(e.name)){o.pop();continue}const t=a[a.length-1]===o.length-1;if(0===e.inputs.length||t)o.pop(),r.push(e),n.add(e.name),t&&a.pop();else{a.push(o.length-1);for(const t of e.inputs)null==i[t.name]&&(i[t.name]=new Set),i[t.name].add(e.name),n.has(t.name)||o.push(t)}}return{sorted:r,recipientMap:i}}function eo(e){let t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{let n=null;for(let t=0;t<e.sourceLayer.inboundNodes.length;++t)for(const r of e.sourceLayer.inboundNodes[t].outputTensors)if(r.id===e.id){n=t;break}t=e.sourceLayer.getOutputAt(n)}return t}function to(e,t){return(0,O.tidy)((()=>O.sqrt(O.sum(O.mul(e,e),t,!0))))}(0,O.env)().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",(()=>100),(function(e){null!=Yi&&Yi.setMaxEntries(e),null!=Ki&&Ki.setMaxEntries(e)}));class no extends O.serialization.Serializable{getConfig(){return{}}}class ro extends no{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return(0,O.tidy)((()=>{const t=to(e,this.axis),n=O.clipByValue(t,0,this.maxValue);return O.mul(e,O.div(n,O.add(Vr(),t)))}))}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}ro.className="MaxNorm",O.serialization.registerClass(ro);class io extends no{constructor(e){super(),this.defaultAxis=0,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return(0,O.tidy)((()=>O.div(e,O.add(Vr(),to(e,this.axis)))))}getConfig(){return{axis:this.axis}}}io.className="UnitNorm",O.serialization.registerClass(io);class oo extends no{apply(e){return O.relu(e)}}oo.className="NonNeg",O.serialization.registerClass(oo);class ao extends no{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=e.minValue?e.minValue:this.defaultMinValue,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.rate=null!=e.rate?e.rate:this.defaultRate,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return(0,O.tidy)((()=>{const t=to(e,this.axis),n=O.add(O.mul(this.rate,O.clipByValue(t,this.minValue,this.maxValue)),O.mul(1-this.rate,t));return O.mul(e,O.div(n,O.add(Vr(),t)))}))}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}ao.className="MinMaxNorm",O.serialization.registerClass(ao);const so={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function uo(e){return cr(e)}function lo(e,t={}){return dr(e,O.serialization.SerializationMap.getMap().classNameMap,t,"constraint")}function co(e){return null==e?null:"string"==typeof e?lo({className:e in so?so[e]:e,config:{}}):e instanceof no?e:lo(e)}function po(e){return new ro(e)}function ho(e){return new io(e)}function fo(){return new oo}function go(e){return new ao(e)}function mo(){return new pi}function yo(){return new di}function bo(e){return new hi(e)}function vo(e){return new fi(e)}function xo(e){return new gi(e)}function _o(e){return new mi(e)}function wo(e){return new yi(e)}function ko(e){return new bi(e)}function So(e){return new vi(e)}function Co(e){return new xi(e)}function Mo(e){return new _i(e)}function To(e){return new wi(e)}function Eo(e){return new ki(e)}function Ao(e){return new Si(e)}function Fo(e){return new Ci(e)}async function Oo(e){if(null==e)return;const t=[],n=[],r=[];for(const i in e){const o=e[i];if("number"!=typeof o){const e=o;t.push(e.data()),n.push(i),r.push(e)}}if(t.length>0){const i=await Promise.all(t);for(let t=0;t<i.length;++t)e[n[t]]=i[t][0];(0,O.dispose)(r)}}function Ro(e){if(null!=e)for(const t in e){const n=e[t];"number"!=typeof n&&n.dispose()}}var No;!function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(No||(No={}));class Do{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class Io{constructor(e,t=10){null==e&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){null==e&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){null==e&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class Bo extends Do{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){null==t&&(t={});const n=null==t.size?0:t.size;this.seen+=n;for(const e in t){const r=t[e];if("number"==typeof r)this.totals.hasOwnProperty(e)||(this.totals[e]=0),this.totals[e]=this.totals[e]+r*n;else{let t;e in this.totals?t=this.totals[e]:this.totals[e]=0;const i=(0,O.tidy)((()=>(0,O.add)(this.totals[e],(0,O.mul)(r,n))));this.totals[e]=i,null!=t&&t.dispose()}}}async onEpochEnd(e,t){if(null!=t)for(const e of this.params.metrics)null!=this.totals[e]&&("number"==typeof this.totals[e]?t[e]=this.totals[e]/this.seen:(0,O.tidy)((()=>{const n=(0,O.mul)((0,O.div)(1,this.seen),this.totals[e]);t[e]=n,this.totals[e].dispose(),(0,O.keep)(t[e])})))}}class Lo extends Do{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){null==t&&(t={}),this.epoch.push(e);for(const e in t)null==this.history[e]&&(this.history[e]=[]),this.history[e].push(t[e])}async syncData(){const e=[],t=[],n=[];for(const r in this.history){const i=this.history[r];for(let o=0;o<i.length;++o)if("number"!=typeof i[o]){const a=i[o];e.push(a.data()),t.push(r),n.push(o)}}const r=await Promise.all(e);for(let e=0;e<r.length;++e)this.history[t[e]][n[e]].dispose(),this.history[t[e]][n[e]]=r[e][0]}}class Po extends Do{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||O.nextFrame,this.yieldEvery=t||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");O.util.isNumber(this.yieldEvery)&&(this.maybeWait=function(e,t,n){let r,i=null!=n?n():O.util.now();return(...o)=>{const a=null!=n?n():O.util.now();return a-i<t||(i=a,r=e(...o)),r}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){const r=[];null!=this.yield&&(await Oo(n),r.push(this.yield(e,t,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,null!=this.epochBegin&&(await Oo(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const n=[];null!=this.epochEnd&&(await Oo(t),n.push(this.epochEnd(e,t))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){null!=this.batchBegin&&(await Oo(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const n=[];null!=this.batchEnd&&(await Oo(t),n.push(this.batchEnd(e,t))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):O.util.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){null!=this.trainBegin&&(await Oo(e),await this.trainBegin(e))}async onTrainEnd(e){null!=this.trainEnd&&(await Oo(e),await this.trainEnd(e))}}function $o(e,t){return null==e&&(e={}),e instanceof Do?[e]:Array.isArray(e)&&e[0]instanceof Do?e:ar(e).map((e=>new Po(e,t)))}class zo{constructor(){}static registerCallbackConstructor(e,t){O.util.assert(e>=0&&Number.isInteger(e),(()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`)),zo.checkForDuplicate(t),null==zo.constructors[e]&&(zo.constructors[e]=[]),zo.constructors[e].push(t)}static checkForDuplicate(e){for(const t in zo.constructors)zo.constructors[+t].forEach((t=>{if(t===e)throw new Zn("Duplicate callback constructor.")}))}static clear(){zo.constructors={}}static createCallbacks(e){const t=[];for(const n in zo.constructors){const r=+n;e>=r&&t.push(...zo.constructors[r])}return t.map((e=>new e))}}function jo(e,t,n,r,i,o,a,s,u){const l=new Lo,c=[new Bo,...zo.createCallbacks(t)];null!=e&&c.push(...e),c.push(l);const p=new Io(c);return p.setParams({epochs:n,initialEpoch:r,samples:i,steps:o,batchSize:a,verbose:t,doValidation:s,metrics:u}),{callbackList:p,history:l}}function Go(e,t={},n=!1){return dr(e,O.serialization.SerializationMap.getMap().classNameMap,t,"layer",n)}function Uo(e,t){return(0,O.tidy)((()=>{"float32"!==e.dtype&&(e=O.cast(e,"float32"));const n=O.sum(ri(e),t,!0),r=O.fill(n.shape,Vr()),i=O.sqrt(O.maximum(n,r));return O.div(e,i)}))}function Wo(e,t){return(0,O.tidy)((()=>O.mean(ri(O.sub(t,e)),-1)))}function Vo(e,t){return(0,O.tidy)((()=>O.mean(O.abs(O.sub(t,e)),-1)))}function Ho(e,t){return(0,O.tidy)((()=>{const n=O.sub(e,t),r=O.clipByValue(O.abs(e),Vr(),Number.MAX_VALUE),i=O.abs(O.div(n,r));return O.mul(100,O.mean(i,-1))}))}function qo(e,t,n=!1){return(0,O.tidy)((()=>{if(n)t=O.softmax(t);else{const e=O.sum(t,t.shape.length-1,!0);t=O.div(t,e)}return t=O.clipByValue(t,Vr(),1-Vr()),O.neg(O.sum(O.mul(O.cast(e,"float32"),O.log(t)),t.shape.length-1))}))}function Xo(e,t,n=!1){return(0,O.tidy)((()=>{const r=O.cast(O.floor(function(e){const t=[zr(e.shape)];return O.reshape(e,t)}(e)),"int32"),i=(t=O.clipByValue(t,Vr(),1-Vr())).shape;return qo(O.reshape(O.oneHot(r,i[i.length-1]),i),t,n)}))}function Yo(e,t){return(0,O.tidy)((()=>{let n;return n=O.clipByValue(t,Vr(),1-Vr()),n=O.log(O.div(n,O.sub(1,n))),O.mean(function(e,t){if(!O.util.arraysEqual(e.shape,t.shape))throw new Zn(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return(0,O.tidy)((()=>{const n=O.relu(t),r=O.neg(O.abs(t));return O.add(O.sub(n,O.mul(t,e)),O.log1p(O.exp(r)))}))}(e,n),-1)}))}function Ko(e,t){return(0,O.tidy)((()=>{const n=Uo(e,-1),r=Uo(t,-1),i=O.mul(n,r);return O.neg(O.sum(i,-1))}))}zo.constructors={};const Jo={meanSquaredError:Wo,meanAbsoluteError:Vo,meanAbsolutePercentageError:Ho,meanSquaredLogarithmicError:function(e,t){return(0,O.tidy)((()=>{const n=O.clipByValue(t,Vr(),Number.MAX_VALUE),r=O.log(O.add(1,n)),i=O.clipByValue(e,Vr(),Number.MAX_VALUE),o=O.log(O.add(1,i));return O.mean(ri(O.sub(r,o)),-1)}))},squaredHinge:function(e,t){return(0,O.tidy)((()=>{const n=O.maximum(0,O.sub(1,O.mul(e,t)));return O.mean(ri(n),-1)}))},hinge:function(e,t){return(0,O.tidy)((()=>{const n=O.maximum(0,O.sub(1,O.mul(e,t)));return O.mean(n,-1)}))},categoricalHinge:function(e,t){return(0,O.tidy)((()=>{const n=O.sum(O.mul(e,t),-1),r=O.max(O.mul(O.sub(1,e),t),-1);return O.maximum(0,O.add(1,O.sub(r,n)))}))},logcosh:function(e,t){return(0,O.tidy)((()=>{const n=Math.log(2),r=O.sub(t,e),i=O.sub(O.add(r,O.softplus(O.mul(-2,r))),n);return O.mean(i,-1)}))},categoricalCrossentropy:qo,sparseCategoricalCrossentropy:Xo,binaryCrossentropy:Yo,kullbackLeiblerDivergence:function(e,t){return(0,O.tidy)((()=>{const n=O.clipByValue(e,Vr(),1),r=O.clipByValue(t,Vr(),1);return O.sum(O.mul(e,O.log(O.div(n,r))),-1)}))},poisson:function(e,t){return(0,O.tidy)((()=>{const n=O.log(O.add(Vr(),t));return O.mean(O.sub(t,O.mul(e,n)),-1)}))},cosineProximity:Ko};function Zo(e){if("string"==typeof e){if(e in Jo)return Jo[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new Zn(t)}return e}function Qo(e,t){return(0,O.tidy)((()=>{const n=O.mul(.5,O.onesLike(t)),r=Hr(O.greater(t,n),e.dtype);return O.mean(O.equal(e,r),-1)}))}function ea(e,t){return(0,O.tidy)((()=>Hr(O.equal(O.argMax(e,-1),O.argMax(t,-1)),"float32")))}function ta(e,t){return(0,O.tidy)((()=>O.cast(O.sum(O.logicalAnd(O.equal(e,1),O.equal(t,1))),"float32")))}function na(e,t){return(0,O.tidy)((()=>{const n=ta(e,t),r=function(e,t){return(0,O.tidy)((()=>O.cast(O.sum(O.logicalAnd(O.equal(e,0),O.equal(t,1))),"float32")))}(e,t),i=O.add(n,r);return O.cast(O.where(O.greater(i,0),O.div(n,i),0),"float32")}))}function ra(e,t){return Yo(e,t)}function ia(e,t){return e.rank===t.rank&&(e=O.squeeze(e,[e.rank-1])),(t=O.argMax(t,-1)).dtype!==e.dtype&&(t=O.cast(t,e.dtype)),O.cast(O.equal(e,t),"float32")}const oa=qo,aa=Xo,sa={binaryAccuracy:Qo,categoricalAccuracy:ea,precision:na,categoricalCrossentropy:oa,sparseCategoricalCrossentropy:aa,mse:Wo,MSE:Wo,mae:Vo,MAE:Vo,mape:Ho,MAPE:Ho,cosine:Ko};function ua(e){if("string"==typeof e&&e in sa)return sa[e];if("string"!=typeof e&&null!=e)return e;throw new Zn(`Unknown metric ${e}`)}function la(e){if(rr(null!==e,`Unknown LossOrMetricFn ${e}`),"string"==typeof e)return e;{let t;for(const n of Object.keys(Jo))if(Jo[n]===e){t=n;break}if(void 0!==t)return t;for(const n of Object.keys(sa))if(sa[n]===e){t=n;break}return void 0!==t?t:e.name}}function ca(e,t,n=!1){if(null==e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||!pa(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(e);n.length>1048576&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${n.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function pa(e){if(null===e)return!0;if("object"==typeof e){if(Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);for(const n of t){if("string"!=typeof n)return!1;if(!pa(e[n]))return!1}return!0}if(Array.isArray(e)){for(const t of e)if(!pa(t))return!1;return!0}return!1}{const t=typeof e;return"string"===t||"number"===t||"boolean"===t}}function da(e,t,n=console.log){let r="";for(let n=0;n<e.length;++n)n>0&&(r=r.slice(0,r.length-1)+" "),r+=e[n],r=r.slice(0,t[n]),r+=" ".repeat(t[n]-r.length);n(r)}function ha(e,t,n){let r,i;try{i=e.inboundNodes.map((e=>JSON.stringify(e.inputShapes))).join(",")}catch(e){i="multiple"}try{r=JSON.stringify(e.outputShape)}catch(e){r="multiple"}da([`${e.name} (${e.getClassName()})`,i,r,e.countParams().toString()],t,n)}function fa(e,t,n,r){let i,o;try{o=e.inboundNodes.map((e=>JSON.stringify(e.inputShapes))).join(",")}catch(e){o="multiple"}try{i=JSON.stringify(e.outputShape)}catch(e){i="multiple"}const a=[];for(const t of e.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(t)))for(let e=0;e<t.inboundLayers.length;++e){const n=t.inboundLayers[e].name,r=t.nodeIndices[e],i=t.tensorIndices[e];a.push(`${n}[${r}][${i}]`)}const s=e.name,u=e.getClassName(),l=0===a.length?"":a[0];da([`${s} (${u})`,o,i,e.countParams().toString(),l],t,r);for(let e=1;e<a.length;++e)da(["","","","",a[e]],t,r)}function ga(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"==typeof n}function ma(e,t){if(null===e)return null;if("string"==typeof e)return ur(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){const n=[],r=e.length;for(let i=0;i<r;++i){const r=e[i];ga(t,i,r)?n.push(r):n.push(ma(r,t))}return n}{const t={};for(const n of Object.keys(e)){const r=e[n];if("name"===n&&"string"==typeof r)t[n]=r;else{const e=ur(n);t[e]=ma(r,e)}}return t}}function ya(e,t){if(null==e)return null;if("string"==typeof e)return sr(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){const n=[],r=e.length;for(let i=0;i<r;++i){const r=e[i];ga(t,i,r)?n.push(r):n.push(ya(r,t))}return n}{const t={};for(const n of Object.keys(e)){const r=e[n];t[sr(n)]="name"!==n&&"className"!==n||"string"!=typeof r?ya(r,n):r}return t}}const ba="4.8.0";class va extends Wi{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,null==this.name){const e=this.getClassName().toLowerCase();this.name=Sr(e)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],fr(this.inputs).length!==this.inputs.length)throw new Zn(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map((e=>e.name))}`);fr(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map((e=>e.name))}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const e of this.outputs){const t=e.sourceLayer,n=e.nodeIndex,r=e.tensorIndex;this.outputLayers.push(t),this.outputLayersNodeIndices.push(n),this.outputLayersTensorIndices.push(r)}for(const e of this.inputs){const t=e.sourceLayer,n=e.nodeIndex,r=e.tensorIndex;rr(0===n,"input layer has >1 nodes"),rr(0===r,"input layer has >1 tensors"),this.inputLayers.push(t),this.inputLayersNodeIndices.push(n),this.inputLayersTensorIndices.push(r)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let t=0;t<this.inputLayers.length;t++){const n=this.inputLayers[t];if(!(n instanceof Hi))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${t} (0-based) originates from layer type ${n.getClassName()}.`);this.inputNames.push(n.name),this.feedInputShapes.push(n.batchInputShape),this.feedInputNames.push(n.name)}for(const e of this.outputLayers)this.outputNames.push(e.name);this.internalInputShapes=this.inputs.map((e=>e.shape)),this.internalOutputShapes=this.outputs.map((e=>e.shape));const t={},n={},r={},i={},o={},a=[],s=(e,t,n,r,i,u)=>{null!=r&&null!=i&&null!=u||(r=e.sourceLayer,i=e.nodeIndex,u=e.tensorIndex);const l=r.inboundNodes[i];if(-1!==n.indexOf(l))throw new Jn(`The tensor ${e.name} at layer "${r.name}" is part of a cycle.`);if(-1!==t.indexOf(l))return;this.containerNodes.add(va.nodeKey(r,i)),r.id in o||(o[r.id]=Object.keys(o).length),-1===n.indexOf(l)&&n.push(l);const c=l.inboundLayers.length;for(let e=0;e<c;e++){const r=l.inputTensors[e],i=l.inboundLayers[e],o=l.nodeIndices[e],a=l.tensorIndices[e];s(r,t,n,i,o,a)}for(t.push(l);n.indexOf(l)>=0;)n.splice(n.indexOf(l),1);a.push(l)},u=[],l=[];for(const e of this.outputs)s(e,u,l);const c=a.slice().reverse();for(const e of c){n[e.id]=e,e.id in t||(t[e.id]=0);let o=t[e.id];const a=null==r[e.outboundLayer.id]?0:r[e.outboundLayer.id];o=Math.max(o,a),r[e.outboundLayer.id]=o,i[e.outboundLayer.id]=e.outboundLayer,t[e.id]=o;for(let r=0;r<e.inboundLayers.length;r++){const i=e.inboundLayers[r],a=e.nodeIndices[r],s=i.inboundNodes[a],u=null==t[s.id]?0:t[s.id];t[s.id]=Math.max(o+1,u),n[s.id]=s}}const p={};for(const e in t){const r=t[e];r in p||(p[r]=[]),p[r].push(n[e])}const d={};for(const e in r){const t=r[e];t in d||(d[t]=[]),d[t].push(i[e])}let h=Object.keys(d).map((e=>parseInt(e,10))).sort(hr);this.layers=[];for(const e of h){const t=d[e];t.sort(((e,t)=>{const n=o[e.id],r=o[t.id];return n<r?-1:n>r?1:0}));for(const e of t)e instanceof va&&this.internalContainerRefs.push(e),this.layers.push(e)}this.layersByDepth=d,h=Object.keys(p).map((e=>parseInt(e,10))).sort(hr);const f=this.inputs.slice(),g=[];for(const e of h)for(const t of p[e]){const e=t.outboundLayer;if(null!=e){for(const n of t.inputTensors)if(-1===f.indexOf(n))throw new Jn(`Graph disconnected: cannot obtain value for tensor ${n} at layer "${e.name}". The following previous layers were accessed without issue: ${g}`);for(const e of t.outputTensors)f.push(e);g.push(e.name)}}this.nodesByDepth=p;const m=this.layers.map((e=>e.name));for(const e of m){const t=m.filter((t=>t===e)).length;if(1!==t)throw new Jn(`The name "${e}" is used ${t} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(m))}this.outboundNodes=[],this.inboundNodes=[],new Gi({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map((e=>null)),outputMasks:this.outputs.map((e=>null)),inputShapes:this.inputs.map((e=>e.shape)),outputShapes:this.outputs.map((e=>e.shape))}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach((t=>{t._trainableWeights.forEach((t=>t.trainable=e))})),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new Zn("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const e of this.layers)t.push(...e.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){const n={};let r=0;for(const e of this.layers)for(const t of e.weights){if(null!=n[t.originalName])throw new Zn(`Duplicate weight name: ${t.originalName}`);n[t.originalName]=t,r++}const i=[];for(const r in e){let o=r;if(null==n[r]){const e=r.split("/");o=e.slice(0,-2).concat([e[e.length-1]]).join("/")}if(null!=n[o])i.push([n[o],e[r]]);else if(t)throw new Zn(`Provided weight data has no target variable: ${r}`);delete n[o]}if(t){const e=[];for(const t in n)e.push(t);if(e.length>0)throw new Zn(`${e.length} of ${r} weights are not set: ${e}`)}Pi(i)}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${ba}`,t.backend="TensorFlow.js",t}toJSON(e,t=!0){const n=ya(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return(0,O.tidy)((()=>{e=ar(e);const n=new Xi;for(let t=0;t<this.inputs.length;++t)n.add(this.inputs[t],e[t]);return Ji(this.outputs,n,t)}))}computeMask(e,t){return(0,O.tidy)((()=>{let n;return e=ar(e),n=null==t?nr(null,e.length):ar(t),this.runInternalGraph(e,n)[1]}))}computeOutputShape(e){const t=Oi(e);if(t.length!==this.inputLayers.length)throw new Zn(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const n={};for(let e=0;e<t.length;e++){const r=this.inputLayers[e],i=t[e];n[r.name+"_0_0"]=i}const r=Object.keys(this.nodesByDepth).map((e=>parseInt(e,10))).sort(hr);if(r.length>1)for(const e of r){const t=this.nodesByDepth[e];for(const e of t){const t=e.outboundLayer;if(-1!==this.inputLayers.map((e=>e.id)).indexOf(t.id))continue;const r=[];for(let t=0;t<e.inboundLayers.length;t++){const i=e.inboundLayers[t],o=e.nodeIndices[t],a=e.tensorIndices[t],s=n[`${i.name}_${o}_${a}`];r.push(s)}const i=Oi(t.computeOutputShape(or(r))),o=t.inboundNodes.indexOf(e);for(let e=0;e<i.length;e++)n[`${t.name}_${o}_${e}`]=i[e]}}const i=[],o=[];for(let e=0;e<this.outputLayers.length;e++){const t=this.outputLayers[e],n=this.outputLayersNodeIndices[e],r=this.outputLayersTensorIndices[e],i=`${t.name}_${n}_${r}`;o.push(i)}for(let e=0;e<o.length;e++){const t=o[e];rr(t in n),i.push(n[t])}return or(i)}runInternalGraph(e,t){null==t&&(t=nr(null,e.length));const n={};for(let r=0;r<this.inputs.length;++r){const i=this.inputs[r],o=e[r],a=t[r];n[i.id]=[o,a]}const r=Object.keys(this.nodesByDepth).map((e=>parseInt(e,10))).sort(hr);for(const e of r){const t=this.nodesByDepth[e];for(const e of t){const t=e.outboundLayer,r=e.inputTensors,i=e.outputTensors,o=new Array;for(const e of r)e.id in n&&o.push(n[e.id]);if(o.length===r.length){let r,a,s,u,l={};if(null!=e.callArgs&&(l=e.callArgs),1===o.length){const[e,n]=o[0];null==l.mask&&(l.mask=n),s=ar(t.call(e,l)),u=ar(t.computeMask(e,n)),r=[e],a=[n]}else r=o.map((e=>e[0])),a=o.map((e=>e[1])),null==l.mask&&(l.mask=a),s=ar(t.call(r,l)),u=ar(t.computeMask(r,a));if(t.activityRegularizer)throw new Qn("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let e=0;e<i.length;++e){const t=i[e],r=s[e],o=u[e];n[t.id]=[r,o]}}}}const i=[],o=[],a=[];for(const e of this.outputs){rr(e.id in n,`Could not compute output ${e.name} : ${e.id}`);const[t,r]=n[e.id];a.push(t.shape),i.push(t),o.push(r)}return[i,o,a]}buildNodeConversionMap(e){const t={};let n;for(const e of this.layers){n=e instanceof va?1:0;for(let r=0;r<e.inboundNodes.length;r++){const i=va.nodeKey(e,r);this.containerNodes.has(i)&&(t[i]=n,n+=1)}}return t}getLayer(e,t){if(null!=t)return this.findLayer(t);if(null==e)throw new Zn("Provide either a layer name or layer index");if("number"==typeof e)return this.findLayer(e);for(const t of this.layers)if(t.name===e)return t;throw new Zn(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new Zn(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return(0,O.tidy)((()=>{const e=[];for(const t of this.layers)for(let n=0;n<t.inboundNodes.length;++n){const r=va.nodeKey(t,n);this.containerNodes.has(r)&&e.push(...t.calculateLosses())}return e}))}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),n=[];for(const e of this.layers){const r=e.getClassName(),i=e.getConfig(),o=[];for(let n=0;n<e.inboundNodes.length;n++){const r=e.inboundNodes[n],i=va.nodeKey(e,n);let a={};if(this.containerNodes.has(i)){if(r.callArgs)try{JSON.stringify(r.callArgs),a=r.callArgs}catch(t){console.warn(`Layer ${e.name} was passed non-serializable keyword arguments: ${r.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),a={}}if(r.inboundLayers.length>0){const e=[];for(let n=0;n<r.inboundLayers.length;n++){const i=r.inboundLayers[n],o=r.nodeIndices[n],s=r.tensorIndices[n];let u=t[va.nodeKey(i,o)];null==u&&(u=0),e.push([i.name,u,s,a])}o.push(e)}}}const a={};a.name=e.name,a.className=r,a.config=i,a.inboundNodes=o,n.push(a)}e.layers=n;const r=[];for(let e=0;e<this.inputLayers.length;e++){const n=this.inputLayers[e],i=this.inputLayersNodeIndices[e],o=va.nodeKey(n,i);if(!this.containerNodes.has(o))continue;let a=t[o];null==a&&(a=0);const s=this.inputLayersTensorIndices[e];r.push([n.name,a,s])}e.inputLayers=r;const i=[];for(let e=0;e<this.outputLayers.length;e++){const n=this.outputLayers[e],r=this.outputLayersNodeIndices[e],o=va.nodeKey(n,r);if(!this.containerNodes.has(o))continue;let a=t[o];null==a&&(a=0);const s=this.outputLayersTensorIndices[e];i.push([n.name,a,s])}return e.outputLayers=i,e}static fromConfig(e,t,n={},r=!1){const i={},o={};function a(e,t){e.name in o?o[e.name].push(t):o[e.name]=[t]}function s(e,t){const n=[];let r;for(const o of t){const s=o[0],u=o[1],l=o[2];if(r=null==o[3]?{}:o[3],!(s in i))return void a(e,t);const c=i[s];if(c.inboundNodes.length<=u)return void a(e,t);const p=c.inboundNodes[u];n.push(p.outputTensors[l])}n.length>0&&e.apply(or(n),r)}function u(e){const n=e.name,o=Go(e,null!=t.customObjects?t.customObjects:{});o.setFastWeightInitDuringBuild(r),i[n]=o,e.inboundNodes.forEach((e=>{if(!(e instanceof Array))throw new Zn(`Corrupted configuration, expected array for nodeData: ${e}`);a(o,e)}))}const l=t.name,c=t.layers;for(const e of c)u(e);for(;!gr(o);)for(const e of c){const t=i[e.name];if(t.name in o){const e=o[t.name];delete o[t.name];for(const n of e)s(t,n)}}const p=[],d=[],h=t.inputLayers;for(const e of h){const t=e[0],n=e[1],r=e[2];rr(t in i);const o=i[t].inboundNodes[n].outputTensors;p.push(o[r])}const f=t.outputLayers;for(const e of f){const t=e[0],n=e[1],r=e[2];rr(t in i);const o=i[t].inboundNodes[n].outputTensors;d.push(o[r])}return new e({inputs:p,outputs:d,name:l})}get stateful(){if(this._stateful)throw new Zn("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){(0,O.tidy)((()=>{this.layers.forEach((e=>{e.stateful&&e.resetStates()}))}))}}function xa(e,t){return function(e,t,n){const r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((e=>null));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"==typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return e}if("object"==typeof e&&Object.keys(e).length>0&&"object"==typeof e[Object.keys(e)[0]]){const n=[];return t.forEach((t=>{t in e?n.push(e[t]):n.push(null)})),n}throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}(e,t,"classWeight")}async function _a(e,t,n,r){if(null!=t||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const t=(0,O.tidy)((()=>{if(1===e.shape.length)return(0,O.clone)(e);if(2===e.shape.length){if(e.shape[1]>1){const t=1;return(0,O.argMax)(e,t)}if(1===e.shape[1])return(0,O.reshape)(e,[e.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}throw new Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)})),r=Array.from(await t.data());(0,O.dispose)(t);const i=[];return r.forEach((e=>{if(null==n[e])throw new Error(`classWeight must contain all classes in the training data. The class ${e} exists in the data but not in classWeight`);i.push(n[e])})),(0,O.tensor1d)(i,"float32")}return null}function wa(e,t){return(0,O.mul)(e,t)}function ka(e,t){let n,r;const i=t;n=i.xs,r=i.ys,O.util.assert(null!=n&&null!=r,(()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`));const o=Sa("input",e.inputNames,n),a=Sa("output",e.outputNames,r),s=o[0].shape[0];O.util.assert(o.length===e.inputs.length,(()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${o.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`)),O.util.assert(a.length===e.outputs.length,(()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${a.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`));for(let t=0;t<o.length;t++)O.util.assert(o[t].shape[0]===s,(()=>`Batch size mismatch: input ${e.inputNames[t]} has ${o[t].shape[0]}; expected  ${s} based on input ${e.inputNames[0]}.`));for(let t=0;t<a.length;t++)O.util.assert(a[t].shape[0]===s,(()=>`Batch size mismatch: output ${e.outputNames[t]} has ${a[t].shape[0]}; expected  ${s} based on input ${e.inputNames[0]}.`));return{xs:o,ys:a}}function Sa(e,t,n){if(n instanceof O.Tensor)return[n];if(Array.isArray(n))return O.util.assert(n.length===t.length,(()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`)),n;{const r=[];for(const i of t){if(null==n[i])throw new Zn(`The feature data generated by the dataset lacks the required ${e} key '${i}'.`);r.push(n[i])}return r}}function Ca(e){return"function"==typeof e.iterator}function Ma(e){O.util.assert(e>0&&Number.isInteger(e),(()=>`batchSize is required to be a positive integer, but got ${e}`))}function Ta(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((e=>Xr(e,t,n-t))):Xr(e,t,n-t)}function Ea(e,t){return O.tidy((()=>null==e?null:Array.isArray(e)?e.map((e=>Ea(e,t))):ni(e,"int32"===t.dtype?t:O.cast(t,"int32"))))}function Aa(e,t){const n=[];let r=0,i=null;for(;r<e;)i=r+t,i>=e&&(i=e),n.push([r,i]),r=i;return n}function Fa(e){const t=[];e instanceof O.Tensor&&(e=[e]);for(let n=0;n<e.length;++n){const r=e[n];if(1===r.rank)t.push(qr(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function Oa(e,t){if(null==e)return;const n=[];if(t instanceof O.Tensor)n.push(t.id);else if(Array.isArray(t))t.forEach((e=>n.push(e.id)));else if(null!=t)for(const e in t){const r=t[e];n.push(r.id)}const r=[];if(e instanceof O.Tensor)-1===n.indexOf(e.id)&&r.push(e);else if(Array.isArray(e))e.forEach((e=>{-1===n.indexOf(e.id)&&r.push(e)}));else if(null!=e)for(const t in e){const i=e[t];-1===n.indexOf(i.id)&&r.push(i)}r.forEach((e=>{e.isDisposed||e.dispose()}))}function Ra(e){return Array.isArray(e)}function Na(e){return!function(e){return e instanceof O.Tensor}(e)&&!Ra(e)}function Da(e,t,n,r=!0,i=""){if(null==t||0===t.length){if(null!=e){let t=!1;if(Ra(e)&&e.length>0)t=!0;else if(Na(e)){for(const n in e)if(e.hasOwnProperty(n)){t=!0;break}}else t=!0;if(t)throw new Zn(`Error when checking model ${i} expected no data, but got ${e}`)}return[]}if(null==e)return t.map((e=>null));let o;if(Na(e)){o=[];for(const n of t){if(null==e[n])throw new Zn(`No data provided for "${n}". Need data for each key in: ${t}`);o.push(e[n])}}else if(Ra(e)){if(e.length!==t.length)throw new Zn(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);o=e}else{if(t.length>1)throw new Zn(`The model ${i} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);o=[e]}if(o=Fa(o),null!=n)for(let e=0;e<t.length;++e){if(null==n[e])continue;const a=o[e];if(a.shape.length!==n[e].length)throw new Zn(`Error when checking ${i}: expected ${t[e]} to have ${n[e].length} dimension(s). but got array with shape ${a.shape}`);for(let t=0;t<n[e].length;++t){if(0===t&&!r)continue;const o=a.shape[t],s=n[e][t];if(null!=s&&s>=0&&o!==s)throw new Zn(`${i} expected a batch of elements where each example has shape [${n[e].slice(1,n[e].length)}] (i.e.,tensor shape [*,${n[e].slice(1,n[e].length)}]) but the ${i} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return o}function Ia(e,t,n,r=!0,i=""){let o;if(Array.isArray(e)){if(e.length!==t.length)throw new Zn(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);o=e}else{if(t.length>1)throw new Zn(`The model expects ${t.length} ${i} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);o=[e]}if(null!=n)for(let e=0;e<t.length;++e){if(null==n[e])continue;const a=o[e];if(a.shape.length!==n[e].length)throw new Zn(`Error when checking ${i}: expected ${t[e]} to have ${n[e].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let o=0;o<n[e].length;++o){if(0===o&&!r)continue;const s=a.shape[o],u=n[e][o];if(null!=u&&u!==s)throw new Zn(`Error when checking ${i}: expected ${t[e]} to have shape ${JSON.stringify(n[e])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}class Ba extends va{constructor(e){super(e),this.isTraining=!1}summary(e,t,n=console.log){if(!this.built)throw new Zn("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function(e,t,n,r=console.log){const i=function(e){let t=!0;const n=[],r=[];for(const t in e.nodesByDepth)n.push(e.nodesByDepth[t]);for(const e of n){if(e.length>1||1===e.length&&e[0].inboundLayers.length>1){t=!1;break}r.push(...e)}if(t)for(const n of e.layers){let e=!1;for(const i of n.inboundNodes)if(-1!==r.indexOf(i)){if(e){t=!1;break}e=!0}if(!t)break}return t}(e),o=["Layer (type)","Input Shape","Output shape","Param #"];let a;if(i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map((e=>Math.floor(t*e)))),!i){o.push("Receives inputs"),a=[];for(const t in e.nodesByDepth)a.push(...e.nodesByDepth[t])}r("_".repeat(t)),da(o,n,r),r("=".repeat(t));const s=e.layers;for(let e=0;e<s.length;++e)i?ha(s[e],n,r):fa(s[e],n,a,r),r((e===s.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();const u=function(e){let t;return t=null!=e.collectedTrainableWeights?Di(e.collectedTrainableWeights):Di(e.trainableWeights),t}(e),l=Di(e.nonTrainableWeights);r(`Total params: ${u+l}`),r(`Trainable params: ${u}`),r(`Non-trainable params: ${l}`),r("_".repeat(t))}(this,e,t,n)}compile(e){if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"==typeof e.optimizer)this.optimizer_=function(e){const t={Adagrad:()=>O.train.adagrad(.01),Adadelta:()=>O.train.adadelta(1,.95,Vr()),Adam:()=>O.train.adam(.001,.9,.999,Vr()),Adamax:()=>O.train.adamax(.002,.9,.999,Vr(),0),RMSProp:()=>O.train.rmsprop(.001,.9,0,Vr()),SGD:()=>O.train.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new Zn(`Unknown Optimizer ${e}`)}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof O.Optimizer))throw new Zn("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(Array.isArray(e.loss)||"string"==typeof e.loss||"function"==typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new Zn(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);const n=e.loss;t=n.map((e=>Zo(e)))}else{const n=Zo(e.loss);this.outputs.forEach((e=>{t.push(n)}))}else{e.loss=e.loss;for(const t in e.loss)if(-1===this.outputNames.indexOf(t))throw new Zn(`Unknown entry in loss dictionary: "${t}". Only expected the following keys: ${this.outputNames}`);for(const n of this.outputNames)null==e.loss[n]&&console.warn(`Output "${n}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${n} during training`),t.push(Zo(e.loss[n]))}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let e=0;e<this.outputs.length;++e){const t=this.internalOutputShapes[e],n=this.outputNames[e];this.feedOutputNames.push(n),this.feedOutputShapes.push(t),this.feedLossFns.push(this.lossFunctions[e])}const n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Ir("loss",(()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;const t=this.lossFunctions[e];this.outputs.length>1&&(this.metricsTensors.push([t,e]),this.metricsNames.push(this.outputNames[e]+"_loss"))}}));const r=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((e=>[]));let n;if("string"==typeof e||"function"==typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!=typeof e)throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);n=e}if(Array.isArray(n))return t.map((e=>n));{const e=[];for(const r of t){let t=n.hasOwnProperty(r)?n[r]:[];Array.isArray(t)||(t=[t]),e.push(t)}return e}}(e.metrics,this.outputNames),i=(e,t,n)=>{this.outputNames.length>1&&(t=this.outputNames[e]+"_"+t),this.metricsNames.push(t),this.metricsTensors.push([n,e])};Ir("metric",(()=>{for(let e=0;e<this.outputs.length;++e)-1===n.indexOf(e)&&(t=>{let n,r,o;for(const a of t){if("string"==typeof a&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(a)){const t=this.internalOutputShapes[e];let i;1===t[t.length-1]||this.lossFunctions[e]===Yo?-1!==["accuracy","acc"].indexOf(a)?r=Qo:-1!==["crossentropy","ce"].indexOf(a)&&(r=ra):this.lossFunctions[e]===Xo?-1!==["accuracy","acc"].indexOf(a)?r=ia:-1!==["crossentropy","ce"].indexOf(a)&&(r=aa):-1!==["accuracy","acc"].indexOf(a)?r=ea:-1!==["crossentropy","ce"].indexOf(a)&&(r=oa),-1!==["accuracy","acc"].indexOf(a)?i="acc":-1!==["crossentropy","ce"].indexOf(a)&&(i="ce"),o=r,n=""+i}else{const e=ua(a);o=e,n=""+la(a)}let t;Ir(n,(()=>{t=o})),i(e,n,t)}})(r[e])})),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,n={}){const r=null==n.batchSize?32:n.batchSize;Ma(r);const i=this.standardizeUserDataXY(e,t,!0,r);try{const e=i[0].concat(i[1]);this.makeTestFunction();const t=this.testFunction;return or(this.testLoop(t,e,r,n.verbose,n.steps))}finally{Oa(i[0],e),Oa(i[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),async function(e,t,n){const r=null!=(n=n||{}).batches,i=e.testFunction;let o=[];if(n.verbose>0)throw new Qn("Verbose mode is not implemented yet.");O.util.assert(!r||n.batches>0&&Number.isInteger(n.batches),(()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`));const a="function"==typeof t.next?t:await t.iterator();let s=0,u=0;for(;!r||u<n.batches;){const t=await a.next();if(o=O.tidy((()=>{if(t.value){const{xs:n,ys:r}=ka(e,t.value),a=n.concat(r),l=O.tidy((()=>i(a)));if(O.dispose(a),0===u)for(let e=0;e<l.length;++e)o.push((0,O.scalar)(0));const c=a[0].shape[0];for(let e=0;e<l.length;++e){const t=l[e],n=o[e];o[e]=O.tidy((()=>O.add(o[e],O.mul(c,t)))),u>0&&O.dispose(n)}O.dispose(l),s+=c,++u}return o})),t.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let e=0;e<o.length;++e){const t=o[e];o[e]=O.div(o[e],s),O.dispose(t)}return or(o)}(this,e,t)}checkNumSamples(e,t,n,r="steps"){let i;if(null!=n){if(i=null,null!=t)throw new Zn(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else{if(null==e)throw new Zn(`Either the input data should have a defined shape, or ${r} shoud be specified.`);i=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return i}execute(e,t){if(Array.isArray(t)&&0===t.length)throw new Zn("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(t),r=n?t:[t],i=this.retrieveSymbolicTensors(r),o=new Xi;if(e instanceof O.Tensor&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new Zn(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let t=0;t<this.inputs.length;++t)o.add(this.inputs[t],e[t])}else for(const t of this.inputs){const n=e[t.name];if(null==n)throw new Zn(`No value is provided for the model's input ${t.name}`);o.add(t,n)}const a=Ji(i,o);return n?a:a[0]}retrieveSymbolicTensors(e){const t=nr(null,e.length);let n=e.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],o=i.map((e=>e.name));for(let r=0;r<e.length;++r){const a=o.indexOf(e[r]);if(-1!==a&&(t[r]=i[a],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw t.forEach(((t,r)=>{null==t&&n.push(e[r])})),new Zn(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(n)}`)}return t}predictLoop(e,t=32,n=!1){return O.tidy((()=>{const r=this.checkNumSamples(e);if(n)throw new Qn("Verbose predictLoop() is not implemented yet.");const i=Aa(r,t),o=this.outputs.map((e=>[]));for(let t=0;t<i.length;++t)O.tidy((()=>{const n=i[t][0],r=i[t][1],o=Ta(e,n,r),a=[];if(Array.isArray(o))for(let e=0;e<o.length;++e)a.push({key:this.inputs[e],value:o[e]});else a.push({key:this.inputs[0],value:o});const s=new Xi(a);return Ji(this.outputs,s)})).forEach(((e,t)=>o[t].push(e)));return or(o.map((e=>O.concat(e,0))))}))}predict(e,t={}){const n=Fa(e);Ia(n,this.inputNames,this.feedInputShapes,!1);try{const e=null==t.batchSize?32:t.batchSize;return Ma(e),this.predictLoop(n,e)}finally{Oa(n,e)}}predictOnBatch(e){Ia(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,n=!0,r){if(null==this.optimizer_)throw new Jn("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let e=0;e<this.feedOutputShapes.length;++e){const t=this.feedOutputShapes[e];this.feedLossFns[e]===Xo?i.push(t.slice(0,t.length-1).concat([1])):i.push(t)}if(function(e,t,n){const r=fr(e.map((e=>e.shape[0])));r.sort();const i=fr(t.map((e=>e.shape[0])));if(i.sort(),r.length>1)throw new Zn(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map((e=>e.shape)))}`);if(i.length>1)throw new Zn(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map((e=>e.shape)))}`);if(r.length>0&&i.length>0&&!O.util.arraysEqual(r,i))throw new Zn(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${i[0]} target sample(s).`)}(e=Da(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=Da(t,this.feedOutputNames,i,!1,"target")),function(e,t,n){const r=[Wo,Yo,qo];for(let i=0;i<e.length;++i){const o=e[i],a=t[i],s=n[i];if(null!=a){if(a===qo&&1===o.shape[o.shape.length-1])throw new Zn(`You are passing a target array of shape ${o.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(-1!==r.indexOf(a)){const e=o.shape.slice(1),t=s.slice(1);for(let n=0;n<e.length;++n){const r=e[n],i=t[n];if(null!=i&&r!==i)throw new Zn(`A target Tensor with shape ${o.shape} was passed for an output of shape ${s}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=r&&r>0&&e[0].shape[0]%r!=0)throw new Zn(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,n,r,i=!0,o){const[a,s]=this.standardizeUserDataXY(e,t,i,o);if(null!=n)throw new Error("sample weight is not supported yet.");let u=null;if(null!=r){const e=xa(r,this.outputNames);u=[];for(let t=0;t<e.length;++t)u.push(await _a(s[t],null,e[t]))}return[a,s,u]}testLoop(e,t,n,r=0,i){return O.tidy((()=>{const o=this.checkNumSamples(t,n,i,"steps"),a=[];if(r>0)throw new Qn("Verbose mode is not implemented yet.");if(null!=i)throw new Qn("steps mode in testLoop() is not implemented yet");{const r=Aa(o,n),i=(0,O.tensor1d)(Ur(0,o));for(let n=0;n<r.length;++n){const o=r[n][0],s=r[n][1],u=Xr(i,o,s-o),l=Ea(t,u),c=e(l);if(0===n)for(let e=0;e<c.length;++e)a.push((0,O.scalar)(0));for(let e=0;e<c.length;++e){const t=c[e];a[e]=O.add(a[e],O.mul(s-o,t))}}for(let e=0;e<a.length;++e)a[e]=O.div(a[e],o)}return a}))}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){const r=e[n];let i=r;ir(e,r)>1&&(i+=`_${ir(e.slice(0,n),r)}`),t.push(i)}return t}makeTrainFunction(){return e=>{const t=[],n=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),o=[],a=this.collectedTrainableWeights.map((e=>e.read()));return[this.optimizer_.minimize((()=>{const e=[];for(let t=0;t<this.inputs.length;++t)e.push({key:this.inputs[t],value:n[t]});const a=new Xi(e),s=Ji(this.outputs,a,{training:!0});let u;for(let e=0;e<this.lossFunctions.length;++e){let n=(0,this.lossFunctions[e])(r[e],s[e]);null!=i[e]&&(n=wa(n,i[e]));const o=O.mean(n);t.push(o),u=0===e?n:O.add(u,n)}for(let e=0;e<this.metricsTensors.length;++e){let n;if(this.outputs.length>1&&e<this.outputs.length)n=t[e];else{const t=this.metricsTensors[e][0],i=this.metricsTensors[e][1];n=O.mean(t(r[i],s[i]))}O.keep(n),o.push(n)}return u=O.mean(u),this.calculateLosses().forEach((e=>{u=O.add(u,e)})),u}),!0,a)].concat(o)}}makeTestFunction(){this.testFunction=e=>O.tidy((()=>{const t=[];let n;const r=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let e=0;e<this.inputs.length;++e)o.push({key:this.inputs[e],value:r[e]});const a=new Xi(o),s=Ji(this.outputs,a);for(let e=0;e<this.lossFunctions.length;++e){const r=this.lossFunctions[e],o=O.mean(r(i[e],s[e]));n=0===e?o:O.add(n,o),t.push(n)}for(let e=0;e<this.metricsTensors.length;++e){const n=this.metricsTensors[e][0],r=this.metricsTensors[e][1],o=O.mean(n(i[r],s[r]));t.push(o)}return t}))}async fit(e,t,n={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");let r,i,o,a,s,u,l,c,p;this.isTraining=!0;try{const d=null==n.batchSize?32:n.batchSize;Ma(d);const h=!1,f=await this.standardizeUserData(e,t,n.sampleWeight,n.classWeight,h,d);r=f[0],i=f[1],p=f[2];let g,m=!1;if(null!=n.validationData&&n.validationData.length>0){if(m=!0,2!==n.validationData.length)throw 3===n.validationData.length?new Qn("validationData including sample weights is not supported yet."):new Zn(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${n.validationData} is invalid.`);s=n.validationData[0],u=n.validationData[1];const e=!0,t=await this.standardizeUserData(s,u,null,null,e,d);l=t[0],c=t[1],g=l.concat(c)}else if(null!=n.validationSplit&&n.validationSplit>0&&n.validationSplit<1){m=!0;const e=Math.floor(r[0].shape[0]*(1-n.validationSplit)),t=r[0].shape[0];l=Ta(r,e,t),o=r,r=Ta(r,0,e),c=Ta(i,e,t),a=i,i=Ta(i,0,e),g=l.concat(c)}else null!=n.validationSteps&&(m=!0);const y=r.concat(i).concat(p);this.checkTrainableWeightsConsistency();const b=this.makeTrainFunction(),v=this.getDedupedMetricsNames();let x,_;m?(this.makeTestFunction(),x=this.testFunction,_=v.slice().concat(v.map((e=>"val_"+e)))):(x=null,g=[],_=v.slice());const w=$o(n.callbacks,n.yieldEvery);return await this.fitLoop(b,y,v,d,n.epochs,n.verbose,w,x,g,n.shuffle,_,n.initialEpoch,null,null)}finally{this.isTraining=!1,Oa(r,e),Oa(i,t),Oa(o,e),Oa(a,t),Oa(l,s),Oa(c,u),null!=p&&O.dispose(p)}}async fitLoop(e,t,n,r,i,o,a,s,u,l,c,p,d,h){null==r&&(r=32),null==i&&(i=1),null==l&&(l=!0),null==p&&(p=0);let f=!1;if(null!=s&&null!=u&&(f=!0),null!=h&&(f=!0,null==d))throw new Zn("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const g=this.checkNumSamples(t,r,d,"steps_per_epoch");let m;null!=g&&(m=Ur(0,g)),null==o&&(o=1);const{callbackList:y,history:b}=jo(a,o,i,p,g,d,r,f,c);y.setModel(this),this.history=b,await y.onTrainBegin(),this.stopTraining_=!1;for(let o=p;o<i;++o){await y.onEpochBegin(o);const i={};if(null!=d)throw new Qn("stepsPerEpoch mode is not implemented yet.");{if("batch"===l)throw new Qn("batch shuffling is not implemneted yet");l&&O.util.shuffle(m);const o=(0,O.tensor1d)(m),a=Aa(g,r);for(let l=0;l<a.length;++l){const c={};if(await y.onBatchBegin(l,c),O.tidy((()=>{const p=a[l][0],d=a[l][1],h=Xr(o,p,d-p);c.batch=l,c.size=d-p;const g=Ea(t,h),m=e(g);for(let e=0;e<n.length;++e){const t=n[e],r=m[e];c[t]=r,O.keep(r)}if(l===a.length-1&&f){const e=this.testLoop(s,u,r);for(let t=0;t<n.length;++t){const r=n[t],o=e[t];O.keep(o),i["val_"+r]=o}}})),await y.onBatchEnd(l,c),Ro(c),this.stopTraining_)break}o.dispose()}if(await y.onEpochEnd(o,i),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return async function(e,t,n){const r=null!=n.batchesPerEpoch;if(O.util.assert(null!=e.optimizer,(()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig).")),O.util.assert(null!=n,(()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call.")),O.util.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),(()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`)),O.util.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),(()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`)),O.util.assert(null==n.validationSplit,(()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead.")),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{const i=null!=n.validationData;let o,a;if(i)if(Ca(n.validationData))O.util.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),(()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`));else{const e=function(e){if(3===e.length)throw new Qn("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}(n.validationData);o=e.xs,a=e.ys}const s=e.makeTrainFunction(),u=e.getDedupedMetricsNames();let l;l=i?u.slice().concat(u.map((e=>"val_"+e))):u.slice();const c=$o(n.callbacks,n.yieldEvery),p=null==n.verbose?1:n.verbose,{callbackList:d,history:h}=jo(c,p,n.epochs,null,null,function(e,t){let n=null;return null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}(t,n),null,i,l);d.setModel(e),e.history=h,await d.onTrainBegin(),e.stopTraining_=!1;let f=null==n.initialEpoch?0:n.initialEpoch,g=await t.iterator();for(;f<n.epochs;){const l={};await d.onEpochBegin(f);let c=0,p=0;for(r||(g=await t.iterator());!r||c<n.batchesPerEpoch;){const t=await g.next();if(r&&t.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${c} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, `+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset.");break}if(null!=t.value){const{xs:r,ys:i}=ka(e,t.value),o={};o.batch=p,o.size=r[0].shape[0],await d.onBatchBegin(p,o);const a=[];if(null!=n.classWeight){const t=xa(n.classWeight,e.outputNames);for(let e=0;e<t.length;++e)a.push(await _a(i[e],null,t[e]))}const l=r.concat(i).concat(a),h=s(l);O.dispose(l);for(let e=0;e<u.length;++e){const t=u[e],n=h[e];o[t]=n,O.keep(n)}await d.onBatchEnd(p,o),Ro(o),p++,c++}if(r?c>=n.batchesPerEpoch:t.done){if(i){let t;t=Ca(n.validationData)?ar(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):ar(e.evaluate(o,a,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<e.metricsNames.length;++n)l[`val_${e.metricsNames[n]}`]=t[n]}break}if(e.stopTraining_)break}if(await d.onEpochEnd(f,l),f++,e.stopTraining_)break}return await d.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}(this,e,t)}async trainOnBatch(e,t){const n=await this.standardizeUserData(e,t),r=n[0],i=n[1],o=this.makeTrainFunction()(r.concat(i)),a=[];for(const e of o){const t=await e.data();a.push(t[0])}return O.dispose(o),Oa(n[0],e),Oa(n[1],t),or(a)}getNamedWeights(e){const t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,i=this.getWeights(n);for(let e=0;e<r.length;++e)n&&!r[e].trainable||t.push({name:r[e].originalName,tensor:i[e]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const t=O.memory().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-O.memory().numTensors}return e}getLossIdentifiers(){let e;if("string"==typeof this.loss)e=sr(this.loss);else if(Array.isArray(this.loss)){for(const e of this.loss)if("string"!=typeof e)throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map((e=>sr(e)))}else{const t=Object.keys(this.loss);e={};const n=this.loss;for(const r of t){if("string"!=typeof n[r])throw new Error("Serialization of non-string loss is not supported.");e[r]=sr(n[r])}}return e}getMetricIdentifiers(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[sr(la(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((e=>sr(la(e))));{const e={};for(const t in this.metrics)e[t]=sr(la(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const t=Go(ma(e.optimizer_config));let n,r;if("string"==typeof e.loss)n=ur(e.loss);else if(Array.isArray(e.loss))n=e.loss.map((e=>ur(e)));else if(null!=e.loss){n={};for(const t in e.loss)n[t]=ur(e.loss[t])}if(Array.isArray(e.metrics))r=e.metrics.map((e=>ur(e)));else if(null!=e.metrics){r={};for(const t in e.metrics)r[t]=ur(e.metrics[t])}this.compile({loss:n,metrics:r,optimizer:t})}async save(e,t){if("string"==typeof e){const t=O.io.getSaveHandlers(e);if(0===t.length)throw new Zn(`Cannot find any save handlers for URL '${e}'`);if(t.length>1)throw new Zn(`Found more than one (${t.length}) save handlers for URL '${e}'`);e=t[0]}if(null==e.save)throw new Zn("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await O.io.encodeWeights(this.getNamedWeights(t)),r={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:`TensorFlow.js tfjs-layers v${ba}`,convertedBy:null};if(null!=t&&t.includeOptimizer&&null!=this.optimizer){r.trainingConfig=this.getTrainingConfig();const e="optimizer",{data:t,specs:i}=await O.io.encodeWeights(await this.optimizer.getWeights(),e);n.specs.push(...i),n.data=O.io.concatenateArrayBuffers([n.data,t])}if(null!=this.userDefinedMetadata){const e=!0;ca(this.userDefinedMetadata,this.name,e),r.userDefinedMetadata=this.userDefinedMetadata}return r.weightData=n.data,r.weightSpecs=n.specs,e.save(r)}setUserDefinedMetadata(e){ca(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Ba.className="Model",O.serialization.registerClass(Ba);class La extends Ba{}async function Pa(e,t){"modelTopology"in e||(e={modelTopology:e});let n=e.modelTopology;null!=n.model_config&&(n=n.model_config);const r=Go(ma(n),t);if(null!=e.weightsManifest){const t=await O.io.loadWeights(e.weightsManifest,e.pathPrefix,r.weights.map((e=>e.originalName))),n={};for(const e of r.weights)n[e.originalName]=t[e.originalName];r.loadWeights(n),(0,O.dispose)(t)}return r}async function $a(e,t){if(null==t&&(t={}),"string"==typeof e){const n=O.io.getLoadHandlers(e,t);if(0===n.length)n.push(O.io.browserHTTPRequest(e,t));else if(n.length>1)throw new Zn(`Found more than one (${n.length}) load handlers for URL '${e}'`);e=n[0]}return async function(e,t,n){if(null==n&&(n={}),null==e.load)throw new Zn("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const r=await e.load();let i=r.modelTopology;null!=i.model_config&&(i=i.model_config);const o=null==n.strict||n.strict,a=null!=r.weightData&&null!=r.weightSpecs&&o,s=Go(ma(i),void 0,a),u=r.trainingConfig;if(null!=u&&s.loadTrainingConfig(u),null!=r.userDefinedMetadata&&s.setUserDefinedMetadata(r.userDefinedMetadata),null!=r.weightData){if(null==r.weightSpecs)throw new Zn("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:e,optimizerWeights:t}=function(e,t){const n=O.io.decodeWeights(e,t),r={},i=[];return t.forEach((e=>{"optimizer"===e.group?i.push({name:e.name,tensor:n[e.name]}):r[e.name]=n[e.name]})),{modelWeights:r,optimizerWeights:i}}(r.weightData,r.weightSpecs);s.loadWeights(e,o),null!=s.optimizer&&t.length>0&&await s.optimizer.setWeights(t),(0,O.dispose)(e),(0,O.dispose)(t.map((e=>e.tensor)))}return s}(e,0,t)}La.className="Functional",O.serialization.registerClass(La);class za extends Ba{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=null!=e.name?e.name:Sr("sequential_"),null!=e.layers)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some((e=>e<0)))throw new Zn(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const t=e instanceof za||e instanceof Ba;let n;if(t){if(n=e,1!==n.outputs.length)throw new Zn("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new Zn("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new Zn("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const t=qi({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(t)}if(t)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==e.inboundNodes.length)throw new Zn(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(1!==e.inboundNodes[0].outputTensors.length)throw new Zn("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=Vi(this.outputs[0])}this.inboundNodes=[],new Gi({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:nr(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((e=>e.shape)),outputShapes:this.outputs[0].shape})}else{const t=e.apply(this.outputs[0]);if(Array.isArray(t))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[t],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return null==this.model&&this.build(),this.model.call(e,t)}build(e){if(Ni(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Ba({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,n=console.log){this.built||this.build(),super.summary(e,t,n)}setWeights(e){null==this.model&&this.build(),this.model.setWeights(e)}evaluate(e,t,n={}){if(!this.built)throw new Jn("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new Jn("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return null==this.model&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,n={}){if(!this.built)throw new Jn("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new Jn("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,n={},r=!1){let i,o={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new Zn("Legacy serialization format not supported yet.");i=t}else O.util.assert(null!=t.layers,(()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field.")),i=t.layers,delete t.layers,o=t;const a=new e(o);if(!(a instanceof za))throw new Qn(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const e of i){const t=Go(e,void 0,r);r&&t.setFastWeightInitDuringBuild(!0),a.add(t)}return a}set stopTraining(e){if(null==this.model)throw new Zn("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(null==this.model)throw new Zn("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}}function ja(e){return new Ba(e)}function Ga(e){return new za(e)}function Ua(e){return qi(e)}function Wa(e,t){zo.registerCallbackConstructor(e,t)}za.className="Sequential",O.serialization.registerClass(za);class Va extends O.serialization.Serializable{getConfig(){return{}}}class Ha extends Va{apply(e,t=1){return function(e,t=1){if(1!==t)throw new Qn(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return O.elu(e)}(e,t)}}Ha.className="elu",O.serialization.registerClass(Ha);class qa extends Va{apply(e){return O.selu(e)}}qa.className="selu",O.serialization.registerClass(qa);class Xa extends Va{apply(e){return O.relu(e)}}Xa.className="relu",O.serialization.registerClass(Xa);class Ya extends Va{apply(e){return(0,O.tidy)((()=>O.minimum(6,O.relu(e))))}}Ya.className="relu6",O.serialization.registerClass(Ya);class Ka extends Va{apply(e){return e}}Ka.className="linear",O.serialization.registerClass(Ka);class Ja extends Va{apply(e){return O.sigmoid(e)}}Ja.className="sigmoid",O.serialization.registerClass(Ja);class Za extends Va{apply(e){return function(e){return(0,O.tidy)((()=>{const t=O.add(.5,O.mul(.2,e));return O.clipByValue(t,0,1)}))}(e)}}Za.className="hardSigmoid",O.serialization.registerClass(Za);class Qa extends Va{apply(e){return O.softplus(e)}}Qa.className="softplus",O.serialization.registerClass(Qa);class es extends Va{apply(e){return function(e){return(0,O.tidy)((()=>O.div(e,O.add(O.abs(e),1))))}(e)}}es.className="softsign",O.serialization.registerClass(es);class ts extends Va{apply(e){return O.tanh(e)}}ts.className="tanh",O.serialization.registerClass(ts);class ns extends Va{apply(e,t=-1){return O.softmax(e,t)}}ns.className="softmax",O.serialization.registerClass(ns);class rs extends Va{apply(e,t=-1){return O.logSoftmax(e,t)}}rs.className="logSoftmax",O.serialization.registerClass(rs);class is extends Va{apply(e,t=1){return(0,O.tidy)((()=>O.mul(O.sigmoid(O.mul(e,t)),e)))}}is.className="swish",O.serialization.registerClass(is);class os extends Va{apply(e){return(0,O.tidy)((()=>O.mul(e,O.tanh(O.softplus(e)))))}}function as(e){return e.getClassName()}function ss(e,t={}){return dr(e,O.serialization.SerializationMap.getMap().classNameMap,t,"activation")}function us(e){if(null==e){return ss({className:"linear",config:{}})}if("string"==typeof e){const t={};return t.className=e,t.config={},ss(t)}return e instanceof Va?e:ss(e)}function ls(e){if(null!=e&&"object"!=typeof e)throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}os.className="mish",O.serialization.registerClass(os);class cs extends O.serialization.Serializable{}class ps extends cs{constructor(e){super(),ls(e),this.l1=null==e||null==e.l1?.01:e.l1,this.l2=null==e||null==e.l2?.01:e.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(e){return(0,O.tidy)((()=>{let t=(0,O.zeros)([1]);return this.hasL1&&(t=(0,O.add)(t,(0,O.sum)(O.mul(this.l1,(0,O.abs)(e))))),this.hasL2&&(t=(0,O.add)(t,(0,O.sum)(O.mul(this.l2,ri(e))))),O.reshape(t,[])}))}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}ps.className="L1L2",O.serialization.registerClass(ps);const ds={l1l2:"L1L2"};function hs(e){return cr(e)}function fs(e,t={}){return dr(e,O.serialization.SerializationMap.getMap().classNameMap,t,"regularizer")}function gs(e){return null==e?null:"string"==typeof e?fs({className:e in ds?ds[e]:e,config:{}}):e instanceof cs?e:fs(e)}class ms extends Wi{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,null!=e&&(this.maxValue=e.maxValue)}call(e,t){e=Ri(e);let n=(0,O.relu)(e);return null!=this.maxValue&&(n=(0,O.clipByValue)(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}ms.className="ReLU",O.serialization.registerClass(ms);class ys extends Wi{constructor(e){super(null==e?{}:e),this.DEFAULT_ALPHA=.3,null==e&&(e={}),this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=Ri(e);return(0,O.leakyRelu)(n,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}ys.className="LeakyReLU",O.serialization.registerClass(ys);class bs extends Wi{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Ai(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=gs(e.alphaRegularizer),this.alphaConstraint=co(e.alphaConstraint),null==e.sharedAxes)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else{if("number"!=typeof e.sharedAxes)throw new Zn(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`);this.sharedAxes=[e.sharedAxes]}}build(e){const t=(e=Ni(e)).slice(1);if(null!=this.sharedAxes)for(const e of this.sharedAxes)t[e-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let t=1;t<e.length;++t)n[t]=e[t];this.inputSpec=[new $i({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=Ri(e),(0,O.prelu)(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Ei(this.alphaInitializer),alphaRegularizer:hs(this.alphaRegularizer),alphaConstraint:uo(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}bs.className="PReLU",O.serialization.registerClass(bs);class vs extends Wi{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==this.DEFAULT_ALPHA)throw new Qn(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=Ri(e);return(0,O.elu)(n)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}vs.className="ELU",O.serialization.registerClass(vs);class xs extends Wi{constructor(e){super(null==e?{}:e),this.DEFAULT_THETA=1,null==e&&(e={}),this.theta=null==e.theta?this.DEFAULT_THETA:e.theta}call(e,t){const n=Ri(e);return(0,O.mul)(n,(0,O.cast)((0,O.greater)(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}xs.className="ThresholdedReLU",O.serialization.registerClass(xs);class _s extends Wi{constructor(e){super(null==e?{}:e),this.DEFAULT_AXIS=1,null==e&&(e={}),this.softmax=(new ns).apply,this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis}call(e,t){const n=Ri(e);return this.softmax(n,this.axis)}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}function ws(e,t,n){if("number"==typeof e)return nr(e,t);if(e.length!==t)throw new Zn(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let i=0;i<t;++i){const o=e[i];if((r=o)!==parseInt(r.toString(),10))throw new Zn(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${o}`)}return e;var r}function ks(e,t,n,r,i=1){if(null==e)return e;let o;return o="same"===n?e:e-(t+(t-1)*(i-1))+1,Math.floor((o+r-1)/r)}function Ss(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+Gr([n-t,0]);else{if("same"!==r)throw new Zn(`Unsupport padding mode: ${r}.`);e*=t}return e}function Cs(e,t){return(0,O.tidy)((()=>(Or(t),"channelsFirst"===t?O.transpose(e,[0,2,3,1]):e)))}function Ms(e,t){return(0,O.tidy)((()=>(Or(t),"channelsFirst"===t?O.transpose(e,[0,2,3,4,1]):e)))}function Ts(e,t,n,r=[1,1],i="valid",o,a,s=null){return(0,O.tidy)((()=>{if(null==o&&(o="channelsLast"),Or(o),3!==e.rank&&4!==e.rank)throw new Zn(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(3!==t.rank&&4!==t.rank)throw new Zn(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let u=Cs(e,o);if("causal"===i)throw new Qn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=O.fused.conv2d({x:u,filter:t,strides:r,pad:"same"===i?"same":"valid",dilations:a,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===o&&(u=O.transpose(u,[0,3,1,2])),u}))}_s.className="Softmax",O.serialization.registerClass(_s);class Es extends Wi{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Es.verifyArgs(t),this.rank=e,br(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new Qn(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=ws(t.kernelSize,e,"kernelSize"),this.strides=ws(null==t.strides?1:t.strides,e,"strides"),this.padding=null==t.padding?"valid":t.padding,Rr(this.padding),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,Or(this.dataFormat),this.activation=us(t.activation),this.useBias=null==t.useBias||t.useBias,this.biasInitializer=Ai(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=co(t.biasConstraint),this.biasRegularizer=gs(t.biasRegularizer),this.activityRegularizer=gs(t.activityRegularizer),this.dilationRate=ws(null==t.dilationRate?1:t.dilationRate,e,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new Zn(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(2===this.rank){if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new Zn(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(3===this.rank)if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new Zn(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}static verifyArgs(e){if(rr("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!=typeof e.kernelSize&&!yr(e.kernelSize,"number",1,3))throw new Zn(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:as(this.activation),useBias:this.useBias,biasInitializer:Ei(this.biasInitializer),biasRegularizer:hs(this.biasRegularizer),activityRegularizer:hs(this.activityRegularizer),biasConstraint:uo(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class As extends Es{constructor(e,t){super(e,t),this.kernel=null,As.verifyArgs(t),this.filters=t.filters,br(this.filters,"filters"),this.kernelInitializer=Ai(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=co(t.kernelConstraint),this.kernelRegularizer=gs(t.kernelRegularizer)}build(e){e=Ni(e);const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new Zn(`The channel dimension of the input should be defined. Found ${e[t]}`);const n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return(0,O.tidy)((()=>{let t;e=Ri(e);const n=null==this.bias?null:this.bias.read(),r=xr(this.activation.getClassName());if(null!=r&&2===this.rank)t=Ts(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)t=function(e,t,n,r=1,i="valid",o,a=1){return(0,O.tidy)((()=>{if(null==o&&(o="channelsLast"),Or(o),3!==e.shape.length)throw new Zn(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(3!==t.shape.length)throw new Zn(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(null!=n&&1!==n.shape.length)throw new Zn(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if("channelsFirst"===o&&(e=O.transpose(e,[0,2,1])),"causal"===i)throw new Qn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let s=O.conv1d(e,t,r,"same"===i?"same":"valid","NWC",a);return null!=n&&(s=oi(s,n)),s}))}(e,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)t=Ts(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new Qn("convolutions greater than 3D are not implemented yet.");t=function(e,t,n,r=[1,1,1],i="valid",o,a){return(0,O.tidy)((()=>{if(null==o&&(o="channelsLast"),Or(o),4!==e.rank&&5!==e.rank)throw new Zn(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(4!==t.rank&&5!==t.rank)throw new Zn(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let s=Ms(e,o);if("causal"===i)throw new Qn("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=O.conv3d(s,t,r,"same"===i?"same":"valid","NDHWC",a),null!=n&&(s=oi(s,n)),"channelsFirst"===o&&(s=O.transpose(s,[0,4,1,2,3])),s}))}(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(t=this.activation.apply(t))}return t}))}computeOutputShape(e){e=Ni(e);const t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2);for(let e=0;e<n.length;++e){const r=ks(n[e],this.kernelSize[e],this.padding,this.strides[e],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[e]);t.push(r)}let r=[e[0]];return"channelsLast"===this.dataFormat?(r=r.concat(t),r.push(this.filters)):(r.push(this.filters),r=r.concat(t)),r}getConfig(){const e={filters:this.filters,kernelInitializer:Ei(this.kernelInitializer),kernelRegularizer:hs(this.kernelRegularizer),kernelConstraint:uo(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||"number"!=typeof e.filters||e.filters<1)throw new Zn(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Fs extends As{constructor(e){super(2,e),Fs.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!yr(e.kernelSize,"number",1,2))throw new Zn(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Fs.className="Conv2D",O.serialization.registerClass(Fs);class Os extends As{constructor(e){super(3,e),Os.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new Zn(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}Os.className="Conv3D",O.serialization.registerClass(Os);class Rs extends Fs{constructor(e){if(super(e),this.inputSpec=[new $i({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new Zn(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(4!==(e=Ni(e)).length)throw new Zn("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new Zn("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new $i({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return O.tidy((()=>{let t=Ri(e);if(4!==t.shape.length)throw new Zn(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${t.shape.length}`);const n=t.shape,r=n[0];let i,o;"channelsFirst"===this.dataFormat?(i=2,o=3):(i=1,o=2);const a=n[i],s=n[o],u=this.kernelSize[0],l=this.kernelSize[1],c=this.strides[0],p=this.strides[1],d=[r,Ss(a,c,u,this.padding),Ss(s,p,l,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=O.transpose(t,[0,2,3,1]));let h=O.conv2dTranspose(t,this.kernel.read(),d,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(h=O.transpose(h,[0,3,1,2])),null!=this.bias&&(h=oi(h,this.bias.read(),this.dataFormat)),null!=this.activation&&(h=this.activation.apply(h)),h}))}computeOutputShape(e){const t=(e=Ni(e)).slice();let n,r,i;"channelsFirst"===this.dataFormat?(n=1,r=2,i=3):(n=3,r=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return t[n]=this.filters,t[r]=Ss(t[r],s,o,this.padding),t[i]=Ss(t[i],u,a,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}Rs.className="Conv2DTranspose",O.serialization.registerClass(Rs);class Ns extends Os{constructor(e){if(super(e),this.inputSpec=[new $i({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new Zn(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(5!==(e=Ni(e)).length)throw new Zn("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new Zn("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new $i({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return O.tidy((()=>{let t=Ri(e);if(5!==t.shape.length)throw new Zn(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${t.shape.length}`);const n=t.shape,r=n[0];let i,o,a;"channelsFirst"===this.dataFormat?(a=2,i=3,o=4):(a=1,i=2,o=3);const s=n[a],u=n[i],l=n[o],c=this.kernelSize[0],p=this.kernelSize[1],d=this.kernelSize[2],h=this.strides[0],f=this.strides[1],g=this.strides[2],m=[r,Ss(s,h,c,this.padding),Ss(u,f,p,this.padding),Ss(l,g,d,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=O.transpose(t,[0,2,3,4,1]));let y=O.conv3dTranspose(t,this.kernel.read(),m,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(y=O.transpose(y,[0,4,1,2,3])),null!==this.bias&&(y=oi(y,this.bias.read(),this.dataFormat)),null!==this.activation&&(y=this.activation.apply(y)),y}))}computeOutputShape(e){const t=(e=Ni(e)).slice();let n,r,i,o;"channelsFirst"===this.dataFormat?(n=1,r=2,i=3,o=4):(n=4,r=1,i=2,o=3);const a=this.kernelSize[0],s=this.kernelSize[1],u=this.kernelSize[2],l=this.strides[0],c=this.strides[1],p=this.strides[2];return t[n]=this.filters,t[r]=Ss(t[r],l,a,this.padding),t[i]=Ss(t[i],c,s,this.padding),t[o]=Ss(t[o],p,u,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}Ns.className="Conv3DTranspose",O.serialization.registerClass(Ns);class Ds extends As{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==t.filters)throw new Zn("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=t.kernelInitializer||null!=t.kernelRegularizer||null!=t.kernelConstraint)throw new Zn("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=t.padding&&"same"!==t.padding&&"valid"!==t.padding)throw new Zn(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=Ai(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=gs(t.depthwiseRegularizer),this.depthwiseConstraint=co(t.depthwiseConstraint),this.pointwiseInitializer=Ai(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=gs(t.pointwiseRegularizer),this.pointwiseConstraint=co(t.pointwiseConstraint)}build(e){if((e=Ni(e)).length<this.rank+2)throw new Zn(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new Zn(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);const n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),i=[];for(let e=0;e<this.rank;++e)i.push(1);i.push(n*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new $i({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return(0,O.tidy)((()=>{let t;if(e=Ri(e),1===this.rank)throw new Qn("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(e=O.transpose(e,[0,2,3,1])),t=O.separableConv2d(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(t=oi(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),"channelsFirst"===this.dataFormat&&(t=O.transpose(t,[0,3,1,2])),t}))}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Ei(this.depthwiseInitializer),e.pointwiseInitializer=Ei(this.pointwiseInitializer),e.depthwiseRegularizer=hs(this.depthwiseRegularizer),e.pointwiseRegularizer=hs(this.pointwiseRegularizer),e.depthwiseConstraint=uo(this.depthwiseConstraint),e.pointwiseConstraint=uo(this.pointwiseConstraint),e}}Ds.className="SeparableConv";class Is extends Ds{constructor(e){super(2,e)}}Is.className="SeparableConv2D",O.serialization.registerClass(Is);class Bs extends As{constructor(e){super(1,e),Bs.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!yr(e.kernelSize,"number",1,1))throw new Zn(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Bs.className="Conv1D",O.serialization.registerClass(Bs);class Ls extends Wi{constructor(e){super(e),"number"==typeof e.cropping?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return(0,O.tidy)((()=>{if(e=Ri(e),"channelsLast"===this.dataFormat){const t=Kr(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Kr(t,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const t=Kr(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Kr(t,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}}))}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}Ls.className="Cropping2D",O.serialization.registerClass(Ls);class Ps extends Wi{constructor(e){var t;super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==e.size?this.DEFAULT_SIZE:e.size,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Or(this.dataFormat),this.interpolation=null==e.interpolation?"nearest":e.interpolation,t=this.interpolation,mr(Mr,"InterpolationFormat",t)}computeOutputShape(e){if("channelsFirst"===this.dataFormat){const t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}{const t=null==e[1]?null:this.size[0]*e[1],n=null==e[2]?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return O.tidy((()=>{let t=Ri(e);const n=t.shape;if("channelsFirst"===this.dataFormat){t=O.transpose(t,[0,2,3,1]);const e=this.size[0]*n[2],r=this.size[1]*n[3],i="nearest"===this.interpolation?O.image.resizeNearestNeighbor(t,[e,r]):O.image.resizeBilinear(t,[e,r]);return O.transpose(i,[0,3,1,2])}{const e=this.size[0]*n[1],r=this.size[1]*n[2];return"nearest"===this.interpolation?O.image.resizeNearestNeighbor(t,[e,r]):O.image.resizeBilinear(t,[e,r])}}))}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}Ps.className="UpSampling2D",O.serialization.registerClass(Ps);class $s extends Es{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=Ai(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=co(e.depthwiseConstraint),this.depthwiseRegularizer=gs(e.depthwiseRegularizer)}build(e){if((e=Ni(e)).length<4)throw new Zn(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new Zn(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);const n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return(0,O.tidy)((()=>{let t=function(e,t,n=[1,1],r="valid",i,o){return(0,O.tidy)((()=>{null==i&&(i="channelsLast"),Or(i);let a=Cs(e,i);if(4!==e.rank)throw new Zn(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(4!==t.rank)throw new Zn(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return a=O.depthwiseConv2d(a,t,n,"same"===r?"same":"valid","NHWC",o),"channelsFirst"===i&&(a=O.transpose(a,[0,3,1,2])),a}))}(e=Ri(e),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(t=oi(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),t}))}computeOutputShape(e){e=Ni(e);const t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=ks(t,this.kernelSize[0],this.padding,this.strides[0]),o=ks(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,i,o]:[e[0],i,o,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Ei(this.depthwiseInitializer),e.depthwiseRegularizer=hs(this.depthwiseRegularizer),e.depthwiseConstraint=uo(this.depthwiseRegularizer),e}}function zs(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new Zn("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function i(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=i(t),constants:n=i(n)}}function js(e,t,n,r=!1,i,o,a=!1,s=!1){return O.tidy((()=>{const u=t.shape.length;if(u<3)throw new Zn(`Input should be at least 3D, but is ${u}D.`);const l=[1,0].concat(Ur(2,u));if(t=O.transpose(t,l),null!=o)throw new Qn("The rnn() functoin of the deeplearn.js backend does not support constants yet.");a&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=i&&((i=O.cast(O.cast(i,"bool"),"float32")).rank===u-1&&(i=O.expandDims(i,-1)),i=O.transpose(i,l)),r&&(t=O.reverse(t,0),null!=i&&(i=O.reverse(i,0)));const c=[];let p,d=n;const h=t.shape[0],f=O.unstack(t);let g,m;null!=i&&(g=O.unstack(i));for(let t=0;t<h;++t){const n=f[t],r=O.tidy((()=>e(n,d)));if(null==i)p=r[0],d=r[1];else{const e=O.tidy((()=>{const e=g[t],n=O.sub(O.onesLike(e),e);return{output:O.add(O.mul(r[0],e),O.mul(d[0],n)),newStates:d.map(((t,i)=>O.add(O.mul(r[1][i],e),O.mul(t,n))))}}));p=e.output,d=e.newStates}s&&c.push(p)}if(s){const e=1;m=O.stack(c,e)}return[p,m,d]}))}$s.className="DepthwiseConv2D",O.serialization.registerClass($s);class Gs extends Wi{constructor(e){let t;if(super(e),null==e.cell)throw new Zn("cell property is missing for the constructor of RNN.");if(t=Array.isArray(e.cell)?new Ks({cells:e.cell}):e.cell,null==t.stateSize)throw new Zn("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=null!=e.returnSequences&&e.returnSequences,this.returnState=null!=e.returnState&&e.returnState,this.goBackwards=null!=e.goBackwards&&e.goBackwards,this._stateful=null!=e.stateful&&e.stateful,this.unroll=null!=e.unroll&&e.unroll,this.supportsMasking=!0,this.inputSpec=[new $i({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){return null==this.states_?Ur(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((e=>null)):this.states_}setStates(e){this.states_=e}computeOutputShape(e){Fi(e)&&(e=e[0]);let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const n=t[0];let r;if(r=this.returnSequences?[e[0],e[1],n]:[e[0],n],this.returnState){const n=[];for(const r of t)n.push([e[0],r]);return[r].concat(n)}return r}computeMask(e,t){return O.tidy((()=>{Array.isArray(t)&&(t=t[0]);const e=this.returnSequences?t:null;if(this.returnState){const t=this.states.map((e=>null));return[e].concat(t)}return e}))}get states(){if(null==this.states_){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}return this.states_}set states(e){this.states_=e}build(e){if(null!=this.numConstants)throw new Qn("Constants support is not implemented in RNN yet.");Fi(e)&&(e=e[0]);const t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new $i({shape:[t,null,...n]});const r=[e[0]].concat(e.slice(2));let i;if(this.cell.build(r),i=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!O.util.arraysEqual(this.stateSpec.map((e=>e.shape[e.shape.length-1])),i))throw new Zn(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map((e=>new $i({shape:[null,e]})));this.stateful&&this.resetStates()}resetStates(e,t=!1){(0,O.tidy)((()=>{if(!this.stateful)throw new Kn("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new Zn("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((e=>O.zeros([n,e]))):this.states_=[O.zeros([n,this.cell.stateSize])];else if(null==e)O.dispose(this.states_),null!=this.keptStates&&(O.dispose(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((e=>O.zeros([n,e]))):this.states_[0]=O.zeros([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new Zn(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);!0===t?this.keptStates.push(this.states_.slice()):O.dispose(this.states_);for(let t=0;t<this.states_.length;++t){const r=e[t],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[t]:this.cell.stateSize,o=[n,i];if(!O.util.arraysEqual(r.shape,o))throw new Zn(`State ${t} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${r.shape}`);this.states_[t]=r}}this.states_=this.states_.map((e=>O.keep(e.clone())))}))}apply(e,t){let n=null==t?null:t.initialState,r=null==t?null:t.constants;null==t&&(t={});const i=zs(e,n,r,this.numConstants);e=i.inputs,n=i.initialState,r=i.constants;let o=[],a=[];if(null!=n){t.initialState=n,o=o.concat(n),this.stateSpec=[];for(const e of n)this.stateSpec.push(new $i({shape:e.shape}));a=a.concat(this.stateSpec)}if(null!=r&&(t.constants=r,o=o.concat(r),this.numConstants=r.length),o[0]instanceof zi){const n=[e].concat(o),r=this.inputSpec.concat(a),i=this.inputSpec;this.inputSpec=r;const s=super.apply(n,t);return this.inputSpec=i,s}return super.apply(e,t)}call(e,t){return(0,O.tidy)((()=>{const n=null==t?null:t.mask,r=null==t?null:t.training;let i=null==t?null:t.initialState;e=Ri(e),null==i&&(i=this.stateful?this.states_:this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new Zn(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},s=js(((e,t)=>{const n=this.cell.call([e].concat(t),a);return[n[0],n.slice(1)]}),e,i,this.goBackwards,n,null,this.unroll,this.returnSequences),u=s[0],l=s[1],c=s[2];this.stateful&&this.resetStates(c,r);const p=this.returnSequences?l:u;return this.returnState?[p].concat(c):p}))}getInitialState(e){return(0,O.tidy)((()=>{let t=O.zeros(e.shape);return t=O.sum(t,[1,2]),t=qr(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map((e=>e>1?Qr(t,[1,e]):t)):this.cell.stateSize>1?[Qr(t,[1,this.cell.stateSize])]:[t]}))}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===Gs.className&&(t.cell={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),e),t)}static fromConfig(e,t,n={}){const r=Go(t.cell,n);return new e(Object.assign(t,{cell:r}))}}Gs.className="RNN",O.serialization.registerClass(Gs);class Us extends Wi{}class Ws extends Us{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,br(this.units,"units"),this.activation=us(null==e.activation?this.DEFAULT_ACTIVATION:e.activation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=Ai(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ai(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ai(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=gs(e.kernelRegularizer),this.recurrentRegularizer=gs(e.recurrentRegularizer),this.biasRegularizer=gs(e.biasRegularizer),this.kernelConstraint=co(e.kernelConstraint),this.recurrentConstraint=co(e.recurrentConstraint),this.biasConstraint=co(e.biasConstraint),this.dropout=jr([1,Gr([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=jr([1,Gr([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ni(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return(0,O.tidy)((()=>{if(2!==e.length)throw new Zn(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let n=e[1];e=e[0];const r=null!=t.training&&t.training;let i;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=Js({ones:()=>O.onesLike(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=Js({ones:()=>O.onesLike(n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;i=ti(null!=o?O.mul(e,o):e,this.kernel.read()),null!=this.bias&&(i=oi(i,this.bias.read())),null!=a&&(n=O.mul(n,a));let s=O.add(i,ti(n,this.recurrentKernel.read()));return null!=this.activation&&(s=this.activation.apply(s)),[s,s]}))}getConfig(){const e=super.getConfig(),t={units:this.units,activation:as(this.activation),useBias:this.useBias,kernelInitializer:Ei(this.kernelInitializer),recurrentInitializer:Ei(this.recurrentInitializer),biasInitializer:Ei(this.biasInitializer),kernelRegularizer:hs(this.kernelRegularizer),recurrentRegularizer:hs(this.recurrentRegularizer),biasRegularizer:hs(this.biasRegularizer),activityRegularizer:hs(this.activityRegularizer),kernelConstraint:uo(this.kernelConstraint),recurrentConstraint:uo(this.recurrentConstraint),biasConstraint:uo(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}Ws.className="SimpleRNNCell",O.serialization.registerClass(Ws);class Vs extends Gs{constructor(e){e.cell=new Ws(e),super(e)}call(e,t){return(0,O.tidy)((()=>{null!=this.cell.dropoutMask&&(O.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(O.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,i=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})}))}static fromConfig(e,t){return new e(t)}}Vs.className="SimpleRNN",O.serialization.registerClass(Vs);class Hs extends Us{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new Zn("GRUCell does not support reset_after parameter set to true.");this.units=e.units,br(this.units,"units"),this.activation=us(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=us(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=Ai(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ai(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ai(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=gs(e.kernelRegularizer),this.recurrentRegularizer=gs(e.recurrentRegularizer),this.biasRegularizer=gs(e.biasRegularizer),this.kernelConstraint=co(e.kernelConstraint),this.recurrentConstraint=co(e.recurrentConstraint),this.biasConstraint=co(e.biasConstraint),this.dropout=jr([1,Gr([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=jr([1,Gr([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){const t=(e=Ni(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return(0,O.tidy)((()=>{if(2!==e.length)throw new Zn(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const n=null!=t.training&&t.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=Js({ones:()=>O.onesLike(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=Js({ones:()=>O.onesLike(r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,s,u;0<this.dropout&&this.dropout<1&&(e=O.mul(e,i[0]));let l=ti(e,this.kernel.read());this.useBias&&(l=oi(l,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=O.mul(r,o[0]));const c=this.recurrentKernel.read(),[p,d]=O.split(c,[2*this.units,this.units],c.rank-1),h=ti(r,p),[f,g,m]=O.split(l,3,l.rank-1),[y,b]=O.split(h,2,h.rank-1);a=this.recurrentActivation.apply(O.add(f,y)),s=this.recurrentActivation.apply(O.add(g,b));const v=ti(O.mul(s,r),d);u=this.activation.apply(O.add(m,v));const x=O.add(O.mul(a,r),O.mul(O.add(1,O.neg(a)),u));return[x,x]}))}getConfig(){const e=super.getConfig(),t={units:this.units,activation:as(this.activation),recurrentActivation:as(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ei(this.kernelInitializer),recurrentInitializer:Ei(this.recurrentInitializer),biasInitializer:Ei(this.biasInitializer),kernelRegularizer:hs(this.kernelRegularizer),recurrentRegularizer:hs(this.recurrentRegularizer),biasRegularizer:hs(this.biasRegularizer),activityRegularizer:hs(this.activityRegularizer),kernelConstraint:uo(this.kernelConstraint),recurrentConstraint:uo(this.recurrentConstraint),biasConstraint:uo(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}Hs.className="GRUCell",O.serialization.registerClass(Hs);class qs extends Gs{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Hs(e),super(e)}call(e,t){return(0,O.tidy)((()=>{null!=this.cell.dropoutMask&&(O.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(O.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,i=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})}))}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}qs.className="GRU",O.serialization.registerClass(qs);class Xs extends Us{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,br(this.units,"units"),this.activation=us(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=us(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=Ai(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ai(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ai(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=gs(e.kernelRegularizer),this.recurrentRegularizer=gs(e.recurrentRegularizer),this.biasRegularizer=gs(e.biasRegularizer),this.kernelConstraint=co(e.kernelConstraint),this.recurrentConstraint=co(e.recurrentConstraint),this.biasConstraint=co(e.biasConstraint),this.dropout=jr([1,Gr([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=jr([1,Gr([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;const n=(e=Ni(e))[e.length-1];let r;if(this.kernel=this.addWeight("kernel",[n,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const e=this.biasInitializer,n=this.units;r=new((t=class extends ci{apply(t,r){const i=e.apply([n]),o=(new di).apply([n]),a=e.apply([2*n]);return Zr(Zr(i,o),a)}}).className="CustomInit",t)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return(0,O.tidy)((()=>{const n=null!=t.training&&t.training;if(3!==e.length)throw new Zn(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=Js({ones:()=>O.onesLike(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=Js({ones:()=>O.onesLike(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let s,u,l,c;0<this.dropout&&this.dropout<1&&(e=O.mul(e,o[0]));let p=ti(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=O.mul(r,a[0])),p=O.add(p,ti(r,this.recurrentKernel.read())),this.useBias&&(p=oi(p,this.bias.read()));const[d,h,f,g]=O.split(p,4,p.rank-1);s=this.recurrentActivation.apply(d),u=this.recurrentActivation.apply(h),l=O.add(O.mul(u,i),O.mul(s,this.activation.apply(f))),c=this.recurrentActivation.apply(g);const m=O.mul(c,this.activation.apply(l));return[m,m,l]}))}getConfig(){const e=super.getConfig(),t={units:this.units,activation:as(this.activation),recurrentActivation:as(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ei(this.kernelInitializer),recurrentInitializer:Ei(this.recurrentInitializer),biasInitializer:Ei(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:hs(this.kernelRegularizer),recurrentRegularizer:hs(this.recurrentRegularizer),biasRegularizer:hs(this.biasRegularizer),activityRegularizer:hs(this.activityRegularizer),kernelConstraint:uo(this.kernelConstraint),recurrentConstraint:uo(this.recurrentConstraint),biasConstraint:uo(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}Xs.className="LSTMCell",O.serialization.registerClass(Xs);class Ys extends Gs{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Xs(e),super(e)}call(e,t){return(0,O.tidy)((()=>{null!=this.cell.dropoutMask&&(O.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(O.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,i=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})}))}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}Ys.className="LSTM",O.serialization.registerClass(Ys);class Ks extends Us{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return(0,O.tidy)((()=>{let n=e.slice(1);const r=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?r.push(n.splice(0,e.stateSize.length)):r.push(n.splice(0,1));r.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const s=this.cells[a];n=r[a],o=0===a?[e[0]].concat(n):[o[0]].concat(n),o=s.call(o,t),i.push(o.slice(1))}n=[];for(const e of i.slice().reverse())n.push(...e);return[o[0]].concat(n)}))}build(e){let t;Fi(e)&&(e=e[0]),this.cells.forEach(((n,r)=>{Ir(`RNNCell_${r}`,(()=>{n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}getConfig(){const e=super.getConfig(),t={cells:this.cells.map((e=>({className:e.getClassName(),config:e.getConfig()})))};return Object.assign(Object.assign({},e),t)}static fromConfig(e,t,n={}){const r=[];for(const e of t.cells)r.push(Go(e,n));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return Li(e)}setWeights(e){const t=[];for(const n of this.cells){const r=n.weights.length,i=e.splice(r);for(let e=0;e<n.weights.length;++e)t.push([n.weights[e],i[e]])}Pi(t)}}function Js(e){const{ones:t,rate:n,training:r=!1,count:i=1,dropoutFunc:o}=e,a=()=>null!=o?o(t(),n):ai(t(),n),s=()=>si(a,t,r);return!i||i<=1?O.keep(s().clone()):Array(i).fill(void 0).map(s).map((e=>O.keep(e.clone())))}Ks.className="StackedRNNCells",O.serialization.registerClass(Ks);class Zs extends Gs{constructor(e){if(e.unroll)throw new Qn("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Qn("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new $i({ndim:5})]}call(e,t){return O.tidy((()=>{if(null!=this.cell.dropoutMask&&(O.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(O.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new Zn("ConvRNN2D cell does not support constants");const n=null==t?null:t.mask,r=null==t?null:t.training,i=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})}))}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return O.tidy((()=>{const{stateSize:t}=this.cell,n=e.shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)],o=O.zeros(i);return Array.isArray(t)?Array(t.length).fill(o):[o]}))}resetStates(e,t=!1){O.tidy((()=>{if(!this.stateful)throw new Kn("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)];if(null==n[0])throw new Zn("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>O.zeros(i))):this.states_=[O.zeros(i)];else if(null==e)O.dispose(this.states_),null!=this.keptStates&&(O.dispose(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>O.zeros(i))):this.states_[0]=O.zeros(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new Zn(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):O.dispose(this.states_);for(let t=0;t<this.states_.length;++t){const n=e[t],r=i;if(!O.util.arraysEqual(n.shape,r))throw new Zn(`State ${t} is incompatible with layer ${this.name}: expected shape=${r}, received shape=${n.shape}`);this.states_[t]=n}}this.states_=this.states_.map((e=>O.keep(e.clone())))}))}computeSingleOutputShape(e){const{dataFormat:t,filters:n,kernelSize:r,padding:i,strides:o,dilationRate:a}=this.cell,s="channelsFirst"===t,u=e[s?3:2],l=e[s?4:3],c=ks(u,r[0],i,o[0],a[0]),p=ks(l,r[1],i,o[1],a[1]);return[...e.slice(0,2),...s?[n,c,p]:[c,p,n]]}}Zs.className="ConvRNN2D";class Qs extends Xs{constructor(e){const{filters:t,kernelSize:n,strides:r,padding:i,dataFormat:o,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,br(this.filters,"filters"),this.kernelSize=ws(n,2,"kernelSize"),this.kernelSize.forEach((e=>br(e,"kernelSize"))),this.strides=ws(r||1,2,"strides"),this.strides.forEach((e=>br(e,"strides"))),this.padding=i||"valid",Rr(this.padding),this.dataFormat=o||"channelsLast",Or(this.dataFormat),this.dilationRate=ws(a||1,2,"dilationRate"),this.dilationRate.forEach((e=>br(e,"dilationRate")))}build(e){var t;e=Ni(e);const n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new Zn(`The channel dimension of the input should be defined. Found ${e[n]}`);const r=e[n],i=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const o=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let e;if(this.unitForgetBias){const n=this.biasInitializer,r=this.filters;e=new((t=class extends ci{apply(e,t){return Jr([n.apply([r]),O.ones([r]),n.apply([2*r])])}}).className="CustomInit",t)}else e=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,e,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return O.tidy((()=>{if(3!==e.length)throw new Zn(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const n=t.training||!1,r=e[0],i=e[1],o=e[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=Js({ones:()=>O.onesLike(r),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,s=(e,t,n)=>t&&t[n]?O.mul(t[n],e):e;let u=s(r,a,0),l=s(r,a,1),c=s(r,a,2),p=s(r,a,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=Js({ones:()=>O.onesLike(i),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const d=this.recurrentDropoutMask;let h=s(i,d,0),f=s(i,d,1),g=s(i,d,2),m=s(i,d,3);const[y,b,v,x]=O.split(this.kernel.read(),4,3),[_,w,k,S]=this.useBias?O.split(this.bias.read(),4):[null,null,null,null];u=this.inputConv(u,y,_,this.padding),l=this.inputConv(l,b,w,this.padding),c=this.inputConv(c,v,k,this.padding),p=this.inputConv(p,x,S,this.padding);const[C,M,T,E]=O.split(this.recurrentKernel.read(),4,3);h=this.recurrentConv(h,C),f=this.recurrentConv(f,M),g=this.recurrentConv(g,T),m=this.recurrentConv(m,E);const A=this.recurrentActivation.apply(O.add(u,h)),F=this.recurrentActivation.apply(O.add(l,f)),R=O.add(O.mul(F,o),O.mul(A,this.activation.apply(O.add(c,g)))),N=O.mul(this.recurrentActivation.apply(O.add(p,m)),this.activation.apply(R));return[N,N,R]}))}getConfig(){const e=super.getConfig(),{units:t}=e,n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(e,t,n,r){const i=O.conv2d(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?oi(i,n,this.dataFormat):i}recurrentConv(e,t){return O.conv2d(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}Qs.className="ConvLSTM2DCell",O.serialization.registerClass(Qs);class eu extends Zs{constructor(e){const t=new Qs(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}eu.className="ConvLSTM2D",O.serialization.registerClass(eu);class tu extends Wi{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(null==this.noiseShape)return this.noiseShape;const t=e.shape,n=[];for(let e=0;e<this.noiseShape.length;++e)n.push(null==this.noiseShape[e]?t[e]:this.noiseShape[e]);return n}call(e,t){return(0,O.tidy)((()=>{this.invokeCallHook(e,t);const n=Ri(e);if(0<this.rate&&this.rate<1){const e=null!=t.training&&t.training,r=this.getNoiseShape(n);return si((()=>ai(n,this.rate,r,this.seed)),(()=>n),e)}return e}))}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}tu.className="Dropout",O.serialization.registerClass(tu);class nu extends tu{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}nu.className="SpatialDropout1D",O.serialization.registerClass(nu);class ru extends Wi{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){let t=null;null!=e.batchSize&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,br(this.units,"units"),this.activation=us(e.activation),null!=e.useBias&&(this.useBias=e.useBias),this.kernelInitializer=Ai(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Ai(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=co(e.kernelConstraint),this.biasConstraint=co(e.biasConstraint),this.kernelRegularizer=gs(e.kernelRegularizer),this.biasRegularizer=gs(e.biasRegularizer),this.activityRegularizer=gs(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){const t=(e=Ni(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){const t=(e=Ni(e)).slice();return t[t.length-1]=this.units,t}call(e,t){return(0,O.tidy)((()=>{this.invokeCallHook(e,t);const n=Ri(e),r=xr(this.activation.getClassName());let i;return null!=r?i=ti(n,this.kernel.read(),r,this.bias?this.bias.read():null):(i=ti(n,this.kernel.read()),null!=this.bias&&(i=oi(i,this.bias.read())),null!=this.activation&&(i=this.activation.apply(i))),i}))}getConfig(){const e={units:this.units,activation:as(this.activation),useBias:this.useBias,kernelInitializer:Ei(this.kernelInitializer),biasInitializer:Ei(this.biasInitializer),kernelRegularizer:hs(this.kernelRegularizer),biasRegularizer:hs(this.biasRegularizer),activityRegularizer:hs(this.activityRegularizer),kernelConstraint:uo(this.kernelConstraint),biasConstraint:uo(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}ru.className="Dense",O.serialization.registerClass(ru);class iu extends Wi{constructor(e){super(e=e||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Ni(e);for(const t of e.slice(1))if(null==t)throw new Zn(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],zr(e,1)]}call(e,t){return(0,O.tidy)((()=>{this.invokeCallHook(e,t);let n=Ri(e);if("channelsFirst"===this.dataFormat&&n.rank>1){const e=[0];for(let t=2;t<n.rank;++t)e.push(t);e.push(1),n=(0,O.transpose)(n,e)}return function(e){if(e.rank<=1)throw new Zn(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);const t=[e.shape[0],zr(e.shape,1)];return O.reshape(e,t)}(n)}))}getConfig(){const e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}iu.className="Flatten",O.serialization.registerClass(iu);class ou extends Wi{constructor(e){super(e),this.supportsMasking=!0,this.activation=us(e.activation)}call(e,t){return(0,O.tidy)((()=>{this.invokeCallHook(e,t);const n=Ri(e);return this.activation.apply(n)}))}getConfig(){const e={activation:as(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}ou.className="Activation",O.serialization.registerClass(ou);class au extends Wi{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return(0,O.tidy)((()=>{return t=e=Ri(e),n=this.n,(0,O.tidy)((()=>{if(2!==t.shape.length)throw new Zn(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);return Qr(qr(t,1),[1,n,1])}));var t,n}))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}au.className="RepeatVector",O.serialization.registerClass(au);class su extends Wi{constructor(e){super(e),this.targetShape=e.targetShape;for(let e=0;e<this.targetShape.length;++e)this.isUnknown(this.targetShape[e])&&(this.targetShape[e]=null)}isUnknown(e){return e<0||null==e}fixUnknownDimension(e,t){const n="Total size of new array must be unchanged.",r=t.slice();let i=1,o=null;for(let e=0;e<r.length;++e){const t=r[e];if(this.isUnknown(t)){if(null!==o)throw new Zn("Can only specifiy one unknown dimension.");o=e}else i*=t}const a=zr(e);if(null!==o){if(0===i||a%i!=0)throw new Zn(n);r[o]=a/i}else if(a!==i)throw new Zn(n);return r}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return(0,O.tidy)((()=>{this.invokeCallHook(e,t);const n=Ri(e),r=n.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return(0,O.reshape)(n,i)}))}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}su.className="Reshape",O.serialization.registerClass(su);class uu extends Wi{constructor(e){if(super(e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const t=Ur(1,e.dims.length+1);if(!O.util.arraysEqual(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new $i({ndim:this.dims.length+1})]}computeOutputShape(e){const t=(e=Ni(e)).slice();return this.dims.forEach(((n,r)=>{t[r+1]=e[n]})),t}call(e,t){return(0,O.transpose)(Ri(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}uu.className="Permute",O.serialization.registerClass(uu);class lu extends Wi{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,this.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const n=Ri(e);return(0,O.any)((0,O.notEqual)(n,this.maskValue),-1)}call(e,t){return(0,O.tidy)((()=>{this.invokeCallHook(e,t);const n=Ri(e),r=(0,O.any)((0,O.notEqual)(n,this.maskValue),-1,!0);return(0,O.mul)(n,(0,O.cast)(r,n.dtype))}))}}lu.className="Masking",O.serialization.registerClass(lu);class cu extends Wi{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){let t=null;null!=e.batchSize&&(t=e.batchSize),null==e.inputLength?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(ar(e.inputLength))}this.inputDim=e.inputDim,br(this.inputDim,"inputDim"),this.outputDim=e.outputDim,br(this.outputDim,"outputDim"),this.embeddingsInitializer=Ai(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=gs(e.embeddingsRegularizer),this.activityRegularizer=gs(e.activityRegularizer),this.embeddingsConstraint=co(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return(0,O.tidy)((()=>this.maskZero?(e=Ri(e),(0,O.notEqual)(e,(0,O.zerosLike)(e))):null))}computeOutputShape(e){if(e=Ni(e),null==this.inputLength)return[...e,this.outputDim];const t=ar(this.inputLength);if(t.length!==e.length-1)throw new Zn(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let n=0;for(let r=0;r<t.length;++r){const i=t[r],o=e[r+1];if(null!=i&&null!=o&&i!==o)throw new Zn(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);null==i&&(t[n]=o),n++}}return[e[0],...t,this.outputDim]}call(e,t){return(0,O.tidy)((()=>{this.invokeCallHook(e,t);let n=Ri(e);"int32"!==n.dtype&&(n=Hr(n,"int32"));const r=ni(this.embeddings.read(),(0,O.reshape)(n,[n.size]));return(0,O.reshape)(r,Ni(this.computeOutputShape(n.shape)))}))}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Ei(this.embeddingsInitializer),embeddingsRegularizer:hs(this.embeddingsRegularizer),activityRegularizer:hs(this.activityRegularizer),embeddingsConstraint:uo(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}cu.className="Embedding",O.serialization.registerClass(cu);class pu extends Wi{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Qn}computeElementwiseOpOutputShape(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;const n=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){const i=e[e.length-t.length+r],o=t[r];if(null==i||null==o||i<0||o<0)n.push(null);else if(1===i)n.push(o);else if(1===o)n.push(i);else{if(i!==o)throw new Zn("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(i)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Ni(e)]),e.length<2)throw new Zn(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(const n of e)null!=n&&null!==n[0]&&t.push(n[0]);if(t=fr(t),t.length>1)throw new Zn(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let n=null==e[0]?null:e[0].slice(1);for(let t=1;t<e.length;++t){const r=null==e[t]?null:e[t].slice(1);n=this.computeElementwiseOpOutputShape(n,r)}const r=e.map((e=>e.length));-1===e.indexOf(null)&&1===fr(r).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return(0,O.tidy)((()=>{if(this.reshapeRequired){const t=[],n=e.map((e=>e.rank));if(-1===n.indexOf(null)){const r=Gr(n);for(let n of e){const e=n.rank;for(let t=0;t<r-e;++t)n=qr(n,1);t.push(n)}return this.mergeFunction(t)}{let n=!1;for(const r of e){const e=r.rank;if(null==e){const e=r.shape,i=e[0],o=e.slice(1).concat([i]);let a=O.reshape(r,[i].concat(zr(e.slice(1))));a=O.transpose(a,[1,0]),a=O.reshape(a,o),t.push(a),n=!0}else if(e>1){const i=Ur(1,e).concat([0]);t.push(O.transpose(r,i)),n=!0}else t.push(r)}let r=this.mergeFunction(t);const i=r.rank;if(n)if(null==i){const e=r.shape,t=e[e.length-1],n=[t].concat(e.slice(0,e.length-1));r=O.reshape(O.transpose(O.reshape(r,[-1,t]),[1,0]),n)}else if(i>1){const e=[i-1].concat(Ur(0,i-1));r=O.transpose(r,e)}return r}}return this.mergeFunction(e)}))}computeOutputShape(e){let t;t=null==e[0]?null:e[0].slice(1);for(let n=1;n<e.length;++n){const r=null==e[n]?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}let n=[];for(const t of e)null!=t&&null!==t[0]&&n.push(t[0]);return n=fr(n),t=1===n.length?n.concat(t):[null].concat(t),t}computeMask(e,t){return O.tidy((()=>{if(null==t)return null;if(!Array.isArray(t))throw new Zn("`mask` should be an Array");if(!Array.isArray(e))throw new Zn("`inputs` should be an Array");if(t.length!==e.length)throw new Zn(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every((e=>null==e)))return null;let n=(t=t.map((e=>null==e?e:O.expandDims(e,0))))[0];for(let e=1;e<t.length-1;++e)n=O.logicalAnd(n,t[e]);return n}))}}class du extends pu{constructor(e){super(e)}mergeFunction(e){return(0,O.tidy)((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=O.add(t,e[n]);return t}))}}du.className="Add",O.serialization.registerClass(du);class hu extends pu{constructor(e){super(e)}mergeFunction(e){return(0,O.tidy)((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=O.mul(t,e[n]);return t}))}}hu.className="Multiply",O.serialization.registerClass(hu);class fu extends pu{constructor(e){super(e)}mergeFunction(e){return(0,O.tidy)((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=O.add(t,e[n]);return O.mul(1/e.length,t)}))}}fu.className="Average",O.serialization.registerClass(fu);class gu extends pu{constructor(e){super(e)}mergeFunction(e){return(0,O.tidy)((()=>{let t=e[0];for(let n=1;n<e.length;++n)t=O.maximum(t,e[n]);return t}))}}gu.className="Maximum",O.serialization.registerClass(gu);class mu extends pu{constructor(e){super(e)}mergeFunction(e){return(0,O.tidy)((()=>{let t=e[0];for(let n=1;n<e.length;++n)t=O.minimum(t,e[n]);return t}))}}mu.className="Minimum",O.serialization.registerClass(mu);class yu extends pu{constructor(e){super(e),this.DEFAULT_AXIS=-1,null==e&&(e={}),this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new Zn("A `Concatenate` layer should be called on a list of at least 2 inputs");let t=!0;for(const n of e)if(null!=n){t=!1;break}if(t)return;const n=[];for(let t=0;t<e.length;++t){const r=e[t].slice();r.splice(this.axis,1);let i=!1;for(const e of n)if(O.util.arraysEqual(e,r)){i=!0;break}i||n.push(r)}if(n.length>1)throw new Zn("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return(0,O.tidy)((()=>Jr(e,this.axis)))}computeOutputShape(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new Zn("A `Concatenate` layer should be called on a list of inputs.");const t=e,n=t[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(const e of t.slice(1)){if(null==n[r]||null==e[r]){n[r]=null;break}n[r]+=e[r]}return n}computeMask(e,t){if(null==t)return null;if(!Array.isArray(t))throw new Zn("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new Zn("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new Zn(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return O.tidy((()=>{let n=!0;if(t.forEach((e=>{null==e||(n=!1)})),n)return null;const r=[];for(let n=0;n<e.length;++n)null==t[n]?r.push(O.cast(O.onesLike(e[n]),"bool")):t[n].rank<e[n].rank?r.push(O.expandDims(t[n],-1)):r.push(t[n]);const i=O.concat(r,this.axis);return O.all(i,-1,!1)}))}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}function bu(e,t){for(;e<0;)e+=t;return e}yu.className="Concatenate",O.serialization.registerClass(yu);class vu extends pu{constructor(e){super(e),this.axes=e.axes,this.normalize=null!=e.normalize&&e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){O.util.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const t=e[0],n=e[1];if(t.length>3||n.length>3)throw new Qn("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new Zn(`Dimension incompatibility: ${t[r[0]]} !== ${n[r[1]]}`)}mergeFunction(e){if(2!==e.length)throw new Zn(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map(((t,n)=>bu(t,e[n].shape.length))):[bu(this.axes,n.shape.length),bu(this.axes,r.shape.length)],this.normalize&&(n=Uo(n,t[0]),r=Uo(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new Qn("batchDot is not implemented for tensors of 4D or higher rank yet");if(O.util.assert(e.shape.length>=2,(()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`)),O.util.assert(e.shape.length>=2,(()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`)),"number"==typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new Qn("batchDot is not implemented for complex64-type Tensors yet.");const r=e.shape.length,i=t.shape.length;null==n&&(n=[r-1,i-2]);const o=n;return O.tidy((()=>{let n,a;if(r>i){n=r-i;const e=[];for(let t=0;t<n;++t)e.push(1);t=O.reshape(t,t.shape.concat(e))}else if(i>r){n=i-r;const t=[];for(let e=0;e<n;++e)t.push(1);e=O.reshape(e,e.shape.concat(t))}else n=0;if(2===e.shape.length&&2===t.shape.length)a=o[0]===o[1]?O.sum(O.mul(e,t),o[0]):O.sum(O.mul(O.transpose(e,[1,0]),t),o[1]);else{const n=o[0]!==e.shape.length-1,r=o[1]===t.shape.length-1;a=O.matMul(e,t,n,r)}if(n>0){let e;e=r>i?r+i-3:r-1;const t=[];for(let r=e;r<e+n;++r)t.push(r);a=O.squeeze(a,t)}return 1===a.shape.length&&(a=O.expandDims(a,1)),a}))}(n,r,t)}interpretAxes(e,t){let n;return n=Array.isArray(this.axes)?this.axes:[bu(this.axes,e.length),bu(this.axes,t.length)],n}computeOutputShape(e){O.util.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new Qn("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);const i=t.concat(n);return 1===i.length&&i.push(1),i}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}vu.className="Dot",O.serialization.registerClass(vu);class xu extends Wi{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return(0,O.tidy)((()=>{this.invokeCallHook(e,t);const n=Ri(e);return si((()=>(0,O.add)(ei(n.shape,0,this.stddev),n)),(()=>n),t.training||!1)}))}}xu.className="GaussianNoise",O.serialization.registerClass(xu);class _u extends Wi{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return(0,O.tidy)((()=>{this.invokeCallHook(e,t);const n=Ri(e);return this.rate>0&&this.rate<1?si((()=>{const e=Math.sqrt(this.rate/(1-this.rate));return(0,O.mul)(n,ei(n.shape,1,e))}),(()=>n),t.training||!1):n}))}}_u.className="GaussianDropout",O.serialization.registerClass(_u);class wu extends Wi{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Ri(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return(0,O.tidy)((()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(e),r=()=>{const t=Ri(e),r=-1.7580993408473766;let i=(0,O.greaterEqual)((0,O.randomUniform)(n),this.rate);i=Hr(i,"float32");const o=((1-this.rate)*(1+this.rate*r**2))**-.5,a=-o*r*this.rate,s=(0,O.add)((0,O.mul)(t,i),(0,O.mul)((0,O.add)(i,-1),r));return(0,O.add)((0,O.mul)(s,o),a)};return si(r,(()=>Ri(e)),t.training||!1)}return e}))}}function ku(e,t,n,r,i,o=.001){let a;if(2===e.rank)a=O.batchNorm2d(e,t,n,r,i,o);else if(3===e.rank)a=O.batchNorm3d(e,t,n,r,i,o);else{if(4!==e.rank)throw new Qn(`batchNormalization is not implemented for array of rank ${e.rank} yet`);a=O.batchNorm4d(e,t,n,r,i,o)}return a}wu.className="AlphaDropout",O.serialization.registerClass(wu);class Su extends Wi{constructor(e){null==e&&(e={}),super(e),this.supportsMasking=!0,this.axis=null==e.axis?-1:e.axis,this.momentum=null==e.momentum?.99:e.momentum,this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=Ai(e.betaInitializer||"zeros"),this.gammaInitializer=Ai(e.gammaInitializer||"ones"),this.movingMeanInitializer=Ai(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Ai(e.movingVarianceInitializer||"ones"),this.betaConstraint=co(e.betaConstraint),this.gammaConstraint=co(e.gammaConstraint),this.betaRegularizer=gs(e.betaRegularizer),this.gammaRegularizer=gs(e.gammaRegularizer)}build(e){e=Ni(e);const t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new Zn(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new $i({ndim:e.length,axes:{[t]:n}})];const r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return(0,O.tidy)((()=>{const n=null!=t.training&&t.training,r=Ri(e),i=r.shape,o=i.length,a=Ur(0,o),s=this.axis>=0?this.axis:this.axis+o;a.splice(s,1);const u=nr(1,o);u[s]=i[s];const l=a.slice();l.sort();const c=!O.util.arraysEqual(l,Ur(0,o).slice(0,o-1));if(!n)return(()=>{if(c){const e=(0,O.reshape)(this.movingMean.read(),u),t=(0,O.reshape)(this.movingVariance.read(),u),n=this.center?(0,O.reshape)(this.beta.read(),u):null,i=this.scale?(0,O.reshape)(this.gamma.read(),u):null;return ku(r,e,t,n,i,this.epsilon)}return ku(r,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[p,d,h]=function(e,t,n,r,i=.001){return O.util.arraysEqual(r.slice().sort(),Ur(0,e.rank-1))?function(e,t,n,r,i=.001){return(0,O.tidy)((()=>{const o=O.moments(e,r),a=o.mean,s=o.variance;return[ku(e,a,s,n,t,i),a,s]}))}(e,t,n,r,i):function(e,t,n,r,i=.001){return(0,O.tidy)((()=>{const o=O.moments(e,r),a=o.mean,s=o.variance,u=[];for(const t of Ur(0,e.rank))-1!==r.indexOf(t)?u.push(1):u.push(e.shape[t]);const l=(0,O.reshape)(a,u),c=(0,O.reshape)(s,u),p=null==t?null:(0,O.reshape)(t,u),d=null==n?null:(0,O.reshape)(n,u);return[ku(e,l,c,d,p,i),a,s]}))}(e,t,n,r,i)}(r,this.gamma.read(),this.beta.read(),a,this.epsilon),f=(e,t,n)=>{O.tidy((()=>{const r=1-n,i=e.read(),o=O.mul(O.sub(i,t),r);e.write(O.sub(i,o))}))};return(()=>{f(this.movingMean,d,this.momentum),f(this.movingVariance,h,this.momentum)})(),p}))}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ei(this.betaInitializer),gammaInitializer:Ei(this.gammaInitializer),movingMeanInitializer:Ei(this.movingMeanInitializer),movingVarianceInitializer:Ei(this.movingVarianceInitializer),betaRegularizer:hs(this.betaRegularizer),gammaRegularizer:hs(this.gammaRegularizer),betaConstraint:uo(this.betaConstraint),gammaConstraint:uo(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}Su.className="BatchNormalization",O.serialization.registerClass(Su);class Cu extends Wi{constructor(e){if(null==e&&(e={}),super(e),this.axis=null==e.axis?-1:e.axis,"number"==typeof this.axis){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else{if(!Array.isArray(this.axis))throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);for(const e of this.axis)if(!Number.isInteger(e))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=Ai(e.betaInitializer||"zeros"),this.gammaInitializer=Ai(e.gammaInitializer||"ones"),this.betaRegularizer=gs(e.betaRegularizer),this.gammaRegularizer=gs(e.gammaRegularizer),this.supportsMasking=!0}build(e){const t=(e=Ni(e)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(let e=0;e<this.axis.length;++e)this.axis[e]<0&&(this.axis[e]+=t);for(const e of this.axis)if(e<0||e>=t)throw new Error(`Invalid axis: ${e}`);if(this.axis.length!==fr(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const n=this.axis.map((t=>e[t]));this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0}call(e,t){const n=Ri(e),r=n.shape,i=r.length;return(0,O.tidy)((()=>{let{mean:e,variance:t}=(0,O.moments)(n,this.axis,!0);const o=nr(1,i);for(const e of this.axis)o[e]=r[e];const a=e=>null!=e&&e.shape.length!==i?O.reshape(e,o):e;let s=this.scale?a(this.gamma.read()):null,u=this.center?a(this.beta.read()):null;const l=[],c=[];for(let e=0;e<i;++e)-1!==this.axis.indexOf(e)?(l.push(r[e]),c.push(1)):(l.push(1),c.push(r[e]));return e=O.tile(e,l),t=O.tile(t,l),null!=s&&(s=O.tile(s,c)),null!=u&&(u=O.tile(u,c)),ku(n,e,t,u,s,this.epsilon)}))}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ei(this.betaInitializer),gammaInitializer:Ei(this.gammaInitializer),betaRegularizer:hs(this.betaRegularizer),gammaRegularizer:hs(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}Cu.className="LayerNormalization",O.serialization.registerClass(Cu);class Mu extends Wi{constructor(e){if(null==e&&(e={}),super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)this.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new Zn(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,n;if("number"==typeof e.padding[0])t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new Zn(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],2!==e.padding[1].length)throw new Zn(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new $i({ndim:4})]}computeOutputShape(e){let t,n;return e=Ni(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}call(e,t){return(0,O.tidy)((()=>{return t=Ri(e),n=this.padding,r=this.dataFormat,(0,O.tidy)((()=>{if(4!==t.rank)throw new Zn(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(null==n&&(n=[[1,1],[1,1]]),2!==n.length||2!==n[0].length||2!==n[1].length)throw new Zn("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==r&&(r="channelsLast"),"channelsLast"!==r&&"channelsFirst"!==r)throw new Zn(`Unknown data format: ${r}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let e;return e="channelsFirst"===r?[[0,0],[0,0],n[0],n[1]]:[[0,0],n[0],n[1],[0,0]],O.pad(t,e)}));var t,n,r}))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}function Tu(e,t,n,r,i,o){return(0,O.tidy)((()=>{let a;Or(i),Nr(o),Rr(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==o&&(o="max"),e=Cs(e,i);const s="same"===r?"same":"valid";return a="max"===o?O.maxPool(e,t,n,s):O.avgPool(e,t,n,s),"channelsFirst"===i&&(a=O.transpose(a,[0,3,1,2])),a}))}function Eu(e,t,n,r,i,o){return(0,O.tidy)((()=>{let a;Or(i),Nr(o),Rr(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==o&&(o="max"),e=Ms(e,i);const s="same"===r?"same":"valid";return a="max"===o?O.maxPool3d(e,t,n,s):O.avgPool3d(e,t,n,s),"channelsFirst"===i&&(a=O.transpose(a,[0,4,1,2,3])),a}))}Mu.className="ZeroPadding2D",O.serialization.registerClass(Mu);class Au extends Wi{constructor(e){if(null==e.poolSize&&(e.poolSize=2),super(e),"number"==typeof e.poolSize)this.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!=typeof e.poolSize[0])throw new Zn(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);this.poolSize=e.poolSize}if(br(this.poolSize,"poolSize"),null==e.strides)this.strides=this.poolSize;else if("number"==typeof e.strides)this.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!=typeof e.strides[0])throw new Zn(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);this.strides=e.strides}br(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,Rr(this.padding),this.inputSpec=[new $i({ndim:3})]}computeOutputShape(e){const t=ks((e=Ni(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return(0,O.tidy)((()=>{this.invokeCallHook(e,t),e=qr(Ri(e),2);const n=this.poolingFunction(Ri(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return O.squeeze(n,[2])}))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class Fu extends Au{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return Or(i),Rr(r),Tu(e,t,n,r,i,"max")}}Fu.className="MaxPooling1D",O.serialization.registerClass(Fu);class Ou extends Au{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return Or(i),Rr(r),Tu(e,t,n,r,i,"avg")}}Ou.className="AveragePooling1D",O.serialization.registerClass(Ou);class Ru extends Wi{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new Zn(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];br(this.poolSize,"poolSize"),br(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Or(this.dataFormat),Rr(this.padding),this.inputSpec=[new $i({ndim:4})]}computeOutputShape(e){e=Ni(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=ks(t,this.poolSize[0],this.padding,this.strides[0]),n=ks(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return(0,O.tidy)((()=>(this.invokeCallHook(e,t),this.poolingFunction(Ri(e),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class Nu extends Ru{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return Or(i),Rr(r),Tu(e,t,n,r,i,"max")}}Nu.className="MaxPooling2D",O.serialization.registerClass(Nu);class Du extends Ru{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return Or(i),Rr(r),Tu(e,t,n,r,i,"avg")}}Du.className="AveragePooling2D",O.serialization.registerClass(Du);class Iu extends Wi{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new Zn(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];br(this.poolSize,"poolSize"),br(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Or(this.dataFormat),Rr(this.padding),this.inputSpec=[new $i({ndim:5})]}computeOutputShape(e){e=Ni(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=ks(t,this.poolSize[0],this.padding,this.strides[0]),n=ks(n,this.poolSize[1],this.padding,this.strides[1]),r=ks(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}call(e,t){return(0,O.tidy)((()=>(this.invokeCallHook(e,t),this.poolingFunction(Ri(e),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class Bu extends Iu{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return Or(i),Rr(r),Eu(e,t,n,r,i,"max")}}Bu.className="MaxPooling3D",O.serialization.registerClass(Bu);class Lu extends Iu{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return Or(i),Rr(r),Eu(e,t,n,r,i,"avg")}}Lu.className="AveragePooling3D",O.serialization.registerClass(Lu);class Pu extends Wi{constructor(e){super(e),this.inputSpec=[new $i({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new Qn}}class $u extends Pu{constructor(e){super(e||{})}call(e,t){return(0,O.tidy)((()=>{const t=Ri(e);return O.mean(t,1)}))}}$u.className="GlobalAveragePooling1D",O.serialization.registerClass($u);class zu extends Pu{constructor(e){super(e||{})}call(e,t){return(0,O.tidy)((()=>{const t=Ri(e);return O.max(t,1)}))}}zu.className="GlobalMaxPooling1D",O.serialization.registerClass(zu);class ju extends Wi{constructor(e){super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Or(this.dataFormat),this.inputSpec=[new $i({ndim:4})]}computeOutputShape(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new Qn}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class Gu extends ju{call(e,t){return(0,O.tidy)((()=>{const t=Ri(e);return"channelsLast"===this.dataFormat?O.mean(t,[1,2]):O.mean(t,[2,3])}))}}Gu.className="GlobalAveragePooling2D",O.serialization.registerClass(Gu);class Uu extends ju{call(e,t){return(0,O.tidy)((()=>{const t=Ri(e);return"channelsLast"===this.dataFormat?O.max(t,[1,2]):O.max(t,[2,3])}))}}Uu.className="GlobalMaxPooling2D",O.serialization.registerClass(Uu);class Wu extends Wi{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(e){null!=this.layer&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,n={}){const r=Go(t.layer,n);delete t.layer;const i={layer:r};return Object.assign(i,t),new e(i)}}class Vu extends Wu{constructor(e){super(e),this.supportsMasking=!0}build(e){if((e=Ni(e)).length<3)throw new Zn(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){const t=[(e=Ni(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}call(e,t){return(0,O.tidy)((()=>js(((e,n)=>[Ri(this.layer.call(e,t)),[]]),e=Ri(e),[],!1,null,null,!1,!0)[1]))}}Vu.className="TimeDistributed",O.serialization.registerClass(Vu);class Hu extends Wu{constructor(e){super(e);const t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=Go(n),t.goBackwards=!0!==t.goBackwards;const r={};var i;if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=Go(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,i=this.mergeMode,mr(Ar,"BidirectionalMergeMode",i),e.weights)throw new Qn("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t,n,r,i=this.forwardLayer.computeOutputShape(e);return Array.isArray(i)&&Array.isArray(i[0])||(i=[i]),this.returnState?(r=i.slice(1),t=i[0]):t=i[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):or(n)}apply(e,t){let n=null==t?null:t.initialState,r=null==t?null:t.constants;null==t&&(t={});const i=zs(e,n,r,this.numConstants);if(e=i.inputs,n=i.initialState,r=i.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(null==n||0===n.length)&&null==r)return super.apply(e,t);const o=[],a=[];if(null!=n){const e=n.length;if(e%2>0)throw new Zn("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,o.push(...n);const r=n.map((e=>new $i({shape:e.shape})));this.forwardLayer.stateSpec=r.slice(0,e/2),this.backwardLayer.stateSpec=r.slice(e/2),a.push(...r)}if(null!=r)throw new Qn("Support for constants in Bidirectional layers is not implemented yet.");const s=o[0]instanceof zi;for(const e of o)if(e instanceof zi!==s)throw new Zn("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(s){const n=[e].concat(o),r=this.inputSpec.concat(a),i=this.inputSpec;this.inputSpec=r;const s=super.apply(n,t);return this.inputSpec=i,s}return super.apply(e,t)}call(e,t){return(0,O.tidy)((()=>{const n=t.initialState;let r,i,o,a;if(null==n)r=this.forwardLayer.call(e,t),i=this.backwardLayer.call(e,t);else{const o=n.slice(0,n.length/2),a=n.slice(n.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:o})),i=this.backwardLayer.call(e,Object.assign(t,{initialState:a}))}return this.returnState&&(Array.isArray(r)&&(o=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=O.reverse(i,1)),"concat"===this.mergeMode?a=Jr([r,i]):"sum"===this.mergeMode?a=O.add(r,i):"ave"===this.mergeMode?a=O.mul(.5,O.add(r,i)):"mul"===this.mergeMode?a=O.mul(r,i):null==this.mergeMode&&(a=[r,i]),this.returnState?null==this.mergeMode?a.concat(o):[a].concat(o):a}))}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Ir(this.forwardLayer.name,(()=>{this.forwardLayer.build(e)})),Ir(this.backwardLayer.name,(()=>{this.backwardLayer.build(e)})),this.built=!0}computeMask(e,t){let n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){const e=this.forwardLayer.states.map((e=>null));return Array.isArray(n)?n.concat(e).concat(e):[n].concat(e).concat(e)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const n=Go(t.layer);if(delete t.layer,null!=t.numConstants)throw new Qn("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=t;return r.layer=n,new e(r)}}Hu.className="Bidirectional",O.serialization.registerClass(Hu);class qu extends Wi{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return(0,O.tidy)((()=>("float32"!==(e=Ri(e)).dtype&&(e=Hr(e,"float32")),(0,O.add)((0,O.mul)(e,this.scale),this.offset))))}}qu.className="Rescaling",O.serialization.registerClass(qu);const{resizeBilinear:Xu,cropAndResize:Yu}=O.image;class Ku extends Wi{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,r,i,o,a,s){return(0,O.tidy)((()=>{let u,l=!1;const c=[t/o,n/a,(r+t)/o,(i+n)/a],p=[];3===e.rank?(l=!0,u=(0,O.stack)([e])):u=e;for(let e=0;e<u.shape[0];e++)p.push(c);const d=(0,O.tensor)(p,[p.length,4]),h=(0,O.range)(0,p.length,1,"int32"),f=Yu(u,d,h,[r,i],"nearest");return Hr(l?Ri((0,O.unstack)(f)):f,s)}))}upsize(e,t,n,r){return(0,O.tidy)((()=>Hr(Xu(e,[t,n]),r)))}call(e,t){return(0,O.tidy)((()=>{const t=Ri(e),n=t.dtype,r=t.shape,i=r[r.length-3],o=r[r.length-2];let a=0;i!==this.height&&(a=Math.floor((i-this.height)/2));let s=0;return o!==this.width&&(s=Math.floor((o-this.width)/2),0===s&&(s=1)),a>=0&&s>=0?this.centerCrop(t,a,s,this.height,this.width,i,o,n):this.upsize(e,this.height,this.width,n)}))}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){const t=(e=Ni(e)).length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}}Ku.className="CenterCrop",O.serialization.registerClass(Ku);class Ju extends Wi{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return null==(e=Ni(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return(0,O.tidy)((()=>{let n;if("int32"!==(e=Ri(e)).dtype&&(e=Hr(e,"int32")),void 0!==t.countWeights){if("count"!==this.outputMode)throw new Zn(`countWeights is not used when outputMode !== count.\n              Received countWeights=${t.countWeights}`);n=Ri(t.countWeights)}const r=(0,O.max)(e),i=(0,O.min)(e),o=(0,O.greater)(this.numTokens,r).bufferSync().get(0),a=(0,O.greaterEqual)(i,0).bufferSync().get(0);if(!o||!a)throw new Zn(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return function(e,t,n,r){let i=Ri(e);if("int32"!==i.dtype&&(i=Hr(i,"int32")),"int"===t)return i;const o=i.shape;if(0===i.rank&&(i=(0,O.expandDims)(i,-1)),"oneHot"===t&&1!==i.shape[i.shape.length-1]&&(i=(0,O.expandDims)(i,-1)),i.rank>2)throw new Zn(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${o} which would result in output rank ${i.rank}.`);const a=["multiHot","oneHot"].includes(t),s=i;let u;if(u=void 0!==r&&"count"===t?(0,O.denseBincount)(s,r,n,a):(0,O.denseBincount)(s,[],n,a),"tfIdf"!==t)return u;if(r)return(0,O.mul)(u,r);throw new Zn("When outputMode is 'tfIdf', weights must be provided.")}(e,this.outputMode,this.numTokens,n)}))}}Ju.className="CategoryEncoding",O.serialization.registerClass(Ju);const Zu=new Set(["bilinear","nearest"]);class Qu extends Wi{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation){if(!Zu.has(e.interpolation))throw new Zn(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);this.interpolation=e.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=Boolean(e.cropToAspectRatio)}computeOutputShape(e){const t=(e=Ni(e))[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return(0,O.tidy)((()=>{const t=[this.height,this.width];if("bilinear"===this.interpolation)return O.image.resizeBilinear(e,t,!this.cropToAspectRatio);if("nearest"===this.interpolation)return O.image.resizeNearestNeighbor(e,t,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...Zu]} are supported`)}))}}Qu.className="Resizing",O.serialization.registerClass(Qu);class el{constructor(e){this.seed=e}next(){if(void 0!==this.seed)return this.seed++}}el.className="RandomSeed";class tl extends Wi{constructor(e){super(e),this.randomGenerator=new el(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}tl.className="BaseRandomLayer";const nl=new Set(["bilinear","nearest"]);class rl extends tl{constructor(e){super(e);const{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new Zn(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new Zn(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new Zn(`factor cannot have upper bound less than lower bound.\n        Got upper bound: ${this.widthUpper}.\n        Got lower bound: ${this.widthLower}\n      `);if(n){if(!nl.has(n))throw new Zn(`Invalid interpolation parameter: ${n} is not implemented`);this.interpolation=n}}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){const t=(e=Ni(e))[2];return[this.imgHeight,-1,t]}call(e,t){return(0,O.tidy)((()=>{const t=Ri(e);this.imgHeight=t.shape[t.shape.length-3];const n=t.shape[t.shape.length-2];this.widthFactor=(0,O.randomUniform)([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let r=this.widthFactor.dataSync()[0]*n;r=Math.round(r);const i=[this.imgHeight,r];switch(this.interpolation){case"bilinear":return O.image.resizeBilinear(e,i);case"nearest":return O.image.resizeNearestNeighbor(e,i);default:throw new Error(`Interpolation is ${this.interpolation}\n          but only ${[...nl]} are supported`)}}))}}function il(e){return new Hi(e)}function ol(e){return new vs(e)}function al(e){return new ms(e)}function sl(e){return new ys(e)}function ul(e){return new bs(e)}function ll(e){return new _s(e)}function cl(e){return new xs(e)}function pl(e){return new Bs(e)}function dl(e){return new Fs(e)}function hl(e){return new Rs(e)}function fl(e){return new Os(e)}function gl(e){return new Ns(e)}function ml(e){return new Is(e)}function yl(e){return new Ls(e)}function bl(e){return new Ps(e)}function vl(e){return new $s(e)}function xl(e){return new ou(e)}function _l(e){return new ru(e)}function wl(e){return new tu(e)}function kl(e){return new nu(e)}function Sl(e){return new iu(e)}function Cl(e){return new au(e)}function Ml(e){return new su(e)}function Tl(e){return new uu(e)}function El(e){return new cu(e)}function Al(e){return new du(e)}function Fl(e){return new fu(e)}function Ol(e){return new yu(e)}function Rl(e){return new gu(e)}function Nl(e){return new mu(e)}function Dl(e){return new hu(e)}function Il(e){return new vu(e)}function Bl(e){return new Su(e)}function Ll(e){return new Cu(e)}function Pl(e){return new Mu(e)}function $l(e){return new Ou(e)}function zl(e){return $l(e)}function jl(e){return $l(e)}function Gl(e){return new Du(e)}function Ul(e){return Gl(e)}function Wl(e){return Gl(e)}function Vl(e){return new Lu(e)}function Hl(e){return Vl(e)}function ql(e){return Vl(e)}function Xl(e){return new $u(e)}function Yl(e){return new Gu(e)}function Kl(e){return new zu(e)}function Jl(e){return new Uu(e)}function Zl(e){return new Fu(e)}function Ql(e){return new Nu(e)}function ec(e){return new Bu(e)}function tc(e){return new qs(e)}function nc(e){return new Hs(e)}function rc(e){return new Ys(e)}function ic(e){return new Xs(e)}function oc(e){return new Vs(e)}function ac(e){return new Ws(e)}function sc(e){return new eu(e)}function uc(e){return new Qs(e)}function lc(e){return new Gs(e)}function cc(e){return new Ks(e)}function pc(e){return new Hu(e)}function dc(e){return new Vu(e)}rl.className="RandomWidth",O.serialization.registerClass(rl);const hc=Kl,fc=Jl,gc=Zl,mc=Ql;function yc(e){return new xu(e)}function bc(e){return new _u(e)}function vc(e){return new wu(e)}function xc(e){return new lu(e)}function _c(e){return new qu(e)}function wc(e){return new Ku(e)}function kc(e){return new Qu(e)}function Sc(e){return new Ju(e)}function Cc(e){return new rl(e)}function Mc(e,t){return Qo(e,t)}function Tc(e,t){return ra(e,t)}function Ec(e,t){return ia(e,t)}function Ac(e,t){return ea(e,t)}function Fc(e,t){return oa(e,t)}function Oc(e,t){return na(e,t)}function Rc(e,t){return function(e,t){return(0,O.tidy)((()=>{const n=ta(e,t),r=function(e,t){return(0,O.tidy)((()=>O.cast(O.sum(O.logicalAnd(O.equal(e,1),O.equal(t,0))),"float32")))}(e,t),i=O.add(n,r);return O.cast(O.where(O.greater(i,0),O.div(n,i),0),"float32")}))}(e,t)}function Nc(e,t){return Ko(e,t)}function Dc(e,t){return Vo(e,t)}function Ic(e,t){return Ho(e,t)}function Bc(e,t){return Ho(e,t)}function Lc(e,t){return Ho(e,t)}function Pc(e,t){return Wo(e,t)}function $c(e,t){return Wo(e,t)}function zc(e,t){return Wo(e,t)}function jc(e){return new ps(e)}function Gc(e){return ls(t=e),new ps({l1:null!=t?t.l1:null,l2:0});var t}function Uc(e){return ls(t=e),new ps({l2:null!=t?t.l2:null,l1:0});var t}class Wc extends Do{constructor(){super(...arguments),this.model=null}setModel(e){if(!(e instanceof Ba))throw new Error("model must be a LayersModel, not some other Container");this.model=e}}function Vc(e,t){return e<t}function Hc(e,t){return e>t}class qc extends Wc{constructor(e){if(super(),null==e&&(e={}),e.restoreBestWeights)throw new Qn("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=e.monitor||"val_loss",this.minDelta=Math.abs(e.minDelta||0),this.patience=e.patience||0,this.verbose=e.verbose||0,this.mode=e.mode||"auto",this.baseline=e.baseline,-1===["auto","min","max"].indexOf(this.mode)&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),"min"===this.mode?this.monitorFunc=Vc:"max"===this.mode||-1!==this.monitor.indexOf("acc")?this.monitorFunc=Hc:this.monitorFunc=Vc,this.monitorFunc===Vc&&(this.minDelta*=-1)}async onTrainBegin(e){this.wait=0,this.stoppedEpoch=0,null!=this.baseline?this.best=this.baseline:this.best=this.monitorFunc===Vc?1/0:-1/0}async onEpochEnd(e,t){await Oo(t);const n=this.getMonitorValue(t);null!=n&&(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=e,this.model.stopTraining=!0)))}async onTrainEnd(e){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(e){null==e&&(e={});const t=e[this.monitor];return null==t&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(e)}`),t}}const Xc={earlyStopping:function(e){return new qc(e)}};var Yc,Kc;(0,O.env)().registerFlag("KEEP_INTERMEDIATE_TENSORS",(()=>!1),(e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(Yc||(Yc={})),function(e){let t;!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(Kc||(Kc={}));const Jc={};function Zc(e,t){const n={tfOpName:e,category:"custom",inputs:[],attrs:[],customExecutor:t};Jc[e]=n}function Qc(e){return Jc[e]}function ep(e){delete Jc[e]}function tp(e,t,n,r,i){const o=t.inputParams[e];if(o&&void 0!==o.inputIndexStart){const e=o.inputIndexStart,a=0===o.inputIndexEnd?void 0:void 0===o.inputIndexEnd?e+1:o.inputIndexEnd,s=e<0?t.inputNames.length+e:e;if("tensor"===o.type)return np(t.inputNames[s],n,r,i);if("tensors"===o.type){const o=t.inputs.slice(e,a);return t.inputNames.slice(e,a).filter(((e,t)=>{var n;return"NoOp"!==(null===(n=o[t])||void 0===n?void 0:n.op)})).map((e=>np(e,n,r,i)))}const u=np(t.inputNames[s],n,r,i),l=u.dataSync();return"number"===o.type?l[0]:O.util.toNestedArray(u.shape,l)}const a=t.attrParams[e];return a&&a.value}function np(e,t,n,r){const[i,o]=ap(e,n);if(null!=r){const e=r.getHashTableHandleByName(i);if(null!=e)return e}const a=n.currentContextIds.find((e=>!!t[op(i,e)]));return void 0!==a?t[op(i,a)][o]:void 0}function rp(e,t,n){return t[op(e,n.currentContextId)]}function ip(e,t){const[n,r,i]=ap(e,t);return[op(n,t&&t.currentContextId),r,i]}function op(e,t){return t?`${e}-${t}`:e}function ap(e,t){if(""===e)return["",0,void 0];const n=null!=t&&null!=t.parseNodeNameCache;if(n){const n=t.parseNodeNameCache.get(e);if(null!=n)return n}const r=e.split(":");let i;if(1===r.length)i=[e,0,void 0];else{const e=r[0],t=3===r.length?r[1]:void 0;i=[e,Number(r[r.length-1]),t]}return n&&t.parseNodeNameCache.set(e,i),i}function sp(e,t,n){let r=tp("pad",e,t,n);if("explicit"===r){r=tp("explicitPaddings",e,t,n);const i=[[0,0],[0,0],[0,0],[0,0]];for(let e=0;e<4;e++)i[e][0]=r[2*e],i[e][1]=r[2*e+1];return i}return r}function up(e){return e.kept?e:(0,O.clone)(e)}const lp=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],cp=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],pp=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],dp=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],hp=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],fp=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],gp=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],mp=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],yp=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],bp=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],vp=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],xp=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],_p=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],wp=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],kp=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Sp=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],Cp=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],Mp=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],Tp=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}];class Ep{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[].concat(...[a,s,u,l,c,p,d,h,f,g,m,y,b,v,x,_,w,k,S].map((e=>e.json)));this.opMappers=e.reduce(((e,t)=>(e[t.tfOpName]=t,e)),{})}transformGraph(e,t={}){const n=e.node,r=[],i=[],o=[],a=n.reduce(((e,t)=>(e[t.name]=this.mapNode(t),t.op.startsWith("Placeholder")?r.push(e[t.name]):"Const"===t.op?i.push(e[t.name]):null!=t.input&&0!==t.input.length||o.push(e[t.name]),e)),{});let s=[];const u=[];let l={},c={};null!=t&&(l=this.mapSignatureEntries(t.inputs),c=this.mapSignatureEntries(t.outputs));const p=Object.keys(a);p.forEach((e=>{const t=a[e];t.inputNames.forEach(((e,n)=>{const[r,,i]=ip(e),o=a[r];if(null!=o.outputs){const e=o.outputs.indexOf(i);if(-1!==e){const i=`${r}:${e}`;t.inputNames[n]=i}}t.inputs.push(o),o.children.push(t)}))})),0===Object.keys(c).length?p.forEach((e=>{const t=a[e];0===t.children.length&&u.push(t)})):Object.keys(c).forEach((e=>{const[t]=ip(e),n=a[t];null!=n&&(n.signatureKey=c[e],u.push(n))})),Object.keys(l).length>0?Object.keys(l).forEach((e=>{const[t]=ip(e),n=a[t];n&&(n.signatureKey=l[e],s.push(n))})):s=r;let d={};null!=e.library&&null!=e.library.function&&(d=e.library.function.reduce(((e,t)=>(e[t.signature.name]=this.mapFunction(t),e)),{}));const h={nodes:a,inputs:s,outputs:u,weights:i,placeholders:r,signature:t,functions:d};return o.length>0&&(h.initNodes=o),h}mapSignatureEntries(e){return Object.keys(e||{}).reduce(((t,n)=>(t[e[n].name]=n,t)),{})}mapNode(e){const t=Qc(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});const n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((e=>e.startsWith("^")?e.slice(1):e)),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return null!=t.inputs&&(n.inputParams=t.inputs.reduce(((e,t)=>(e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e)),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce(((t,n)=>{const r=n.type;let i;switch(n.type){case"string":i=Fp(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=Fp(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":i=zp(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=zp(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":i=Rp(e.attr,n.tfName,n.defaultValue||0),void 0===i&&n.tfDeprecatedName&&(i=Rp(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":i=$p(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=$p(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":i=Op(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=Op(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":i=Gp(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=Gp(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":i=Pp(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=Pp(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":i=jp(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=jp(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":i=Ip(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=Ip(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":i=Bp(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=Bp(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":i=Dp(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=Dp(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${n.type} for op: ${e.op}`)}return t[n.name]={value:i,type:r},t}),{})),n}mapFunction(e){const t=e.nodeDef,n=[];let r={};null!=t&&(r=t.reduce(((e,t)=>(e[t.name]=this.mapNode(t),"Const"===t.op&&n.push(e[t.name]),e)),{}));const i=[],o=[];e.signature.inputArg.forEach((e=>{const[t]=ip(e.name),n={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:Np(e.type),type:"dtype"}},children:[]};n.signatureKey=e.name,i.push(n),r[t]=n})),Object.keys(r).forEach((e=>{const t=r[e];t.inputNames.forEach(((e,n)=>{const[i,,o]=ip(e),a=r[i];if(null!=a.outputs){const e=a.outputs.indexOf(o);if(-1!==e){const r=`${i}:${e}`;t.inputNames[n]=r}}t.inputs.push(a),a.children.push(t)}))}));const a=e.ret;e.signature.outputArg.forEach((e=>{const[t,n]=ip(a[e.name]),i=r[t];null!=i&&(i.defaultOutput=n,o.push(i))}));const s=this.mapArgsToSignature(e);return{nodes:r,inputs:i,outputs:o,weights:n,placeholders:[],signature:s}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce(((e,t)=>(e[t.name]=this.mapArgToTensorInfo(t),e)),{}),outputs:e.signature.outputArg.reduce(((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t)),{})}}mapArgToTensorInfo(e,t){let n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}function Ap(e,t){const n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){const t=(0,O.env)().global;if(void 0!==t.atob)return t.atob(e);if("undefined"!=typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function Fp(e,t,n,r=!1){const i=e[t];return null!=i?Ap(i.s,r):n}function Op(e,t,n){const r=e[t];return r?r.b:n}function Rp(e,t,n){const r=e[t]||{},i=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof i?i:parseInt(i,10)}function Np(e){switch("string"==typeof e&&(e=Yc[e]),e){case Yc.DT_FLOAT:case Yc.DT_HALF:return"float32";case Yc.DT_INT32:case Yc.DT_INT64:case Yc.DT_INT8:case Yc.DT_UINT8:return"int32";case Yc.DT_BOOL:return"bool";case Yc.DT_DOUBLE:return"float32";case Yc.DT_STRING:return"string";default:return null}}function Dp(e,t,n){const r=e[t];return r&&r.func?r.func.name:n}function Ip(e,t,n){const r=e[t];return r&&r.type?Np(r.type):n}function Bp(e,t,n){const r=e[t];return r&&r.list&&r.list.type?r.list.type.map((e=>Np(e))):n}function Lp(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((e=>"number"==typeof e.size?e.size:parseInt(e.size,10))):[]}function Pp(e,t,n){const r=e[t];return r&&r.shape?Lp(r.shape):n}function $p(e,t,n){const r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((e=>"number"==typeof e?e:parseInt(e,10))):n}function zp(e,t,n,r=!1){const i=e[t];return i&&i.list&&i.list.s?i.list.s.map((e=>Ap(e,r))):n}function jp(e,t,n){const r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((e=>Lp(e))):n}function Gp(e,t,n){const r=e[t];return r&&r.list&&r.list.b?r.list.b:n}class Up{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map((e=>this.getInput(e))),null!=e.rawAttrs&&(this.attrs=Object.keys(e.rawAttrs).reduce(((e,t)=>(e[t]=this.getAttr(t),e)),{}))}getInput(e){return np(e,this.tensorMap,this.context)}getAttr(e,t){const n=this.node.rawAttrs[e];if(null!=n.tensor)return np(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return Rp(this.node.rawAttrs,e,t);if(null!=n.s)return Fp(this.node.rawAttrs,e,t);if(null!=n.b)return Op(this.node.rawAttrs,e,t);if(null!=n.shape)return Pp(this.node.rawAttrs,e,t);if(null!=n.type)return Ip(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return $p(this.node.rawAttrs,e,t);if(null!=n.list.s)return zp(this.node.rawAttrs,e,t);if(null!=n.list.shape)return jp(this.node.rawAttrs,e,t);if(null!=n.list.b)return Gp(this.node.rawAttrs,e,t);if(null!=n.list.type)return Bp(this.node.rawAttrs,e,t)}return t}}var Wp=__webpack_require__(2778);function Vp(e,t,n=""){if("number"!=typeof e&&"number"!=typeof t){O.util.assert(e.length===t.length,(()=>n+` Shapes ${e} and ${t} must match`));for(let r=0;r<e.length;r++){const i=e[r],o=t[r];O.util.assert(i<0||o<0||i===o,(()=>n+` Shapes ${e} and ${t} must match`))}}}function Hp(e){return"number"!=typeof e&&!e.some((e=>e<0))}function qp(e,t,n){let r=Xp(e,n);const i=!Hp(r);if(i&&0===t.length)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(i&&t.forEach((e=>{r=Xp(e.shape,r)})),!Hp(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function Xp(e,t){if("number"==typeof e)return t;if("number"==typeof t)return e;if(e.length!==t.length)throw new Error(`Incompatible ranks during merge: ${e} vs. ${t}`);const n=[];for(let r=0;r<e.length;++r){const i=e[r],o=t[r];if(i>=0&&o>=0&&i!==o)throw new Error(`Incompatible shape during merge: ${e} vs. ${t}`);n[r]=i>=0?i:o}return n}class Yp{constructor(e,t,n,r,i,o,a){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=(0,O.scalar)(0),(0,O.keep)(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach((t=>{null!=e&&e.has(t.tensor.id)||t.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map((e=>this.read(e)))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},\n          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),Vp(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),n.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(n.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);n.tensor=t,(0,O.keep)(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach(((e,n)=>this.write(e,t[n])))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let t=0;t<this.size();t++)e.push(t)}if(0===e.length)return(0,O.tensor)([],[0].concat(this.elementShape));const n=this.readMany(e);return Vp(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),(0,O.stack)(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(0===this.size())return(0,O.tensor)([],[0].concat(this.elementShape));const t=[];for(let e=0;e<this.size();e++)t.push(e);const n=this.readMany(t);return Vp(this.elementShape,n[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${n[0].shape})`),(0,O.concat)(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error(`Max index must be < array size (${n}  vs. ${this.maxSize})`);this.writeMany(e,(0,O.unstack)(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let n=0;const r=e.map((e=>(n+=e,n)));if(n!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${n}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const i=0===n?0:t.size/n,o=[];(0,O.tidy)((()=>{t=(0,O.reshape)(t,[1,n,i]);for(let n=0;n<e.length;++n){const a=[0,0===n?0:r[n-1],0],s=[1,e[n],i];o[n]=(0,O.reshape)((0,O.slice)(t,a,s),this.elementShape)}return o}));const a=[];for(let t=0;t<e.length;t++)a[t]=t;this.writeMany(a,o)}}class Kp{get id(){return this.idTensor.id}constructor(e,t,n,r=-1){this.tensors=e,this.elementShape=t,this.elementDtype=n,null!=e&&e.forEach((e=>{if(n!==e.dtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${e.dtype}`);Vp(t,e.shape,"TensorList shape mismatch: "),(0,O.keep)(e)})),this.idTensor=(0,O.scalar)(0),this.maxNumElements=r,(0,O.keep)(this.idTensor)}copy(){return new Kp([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach((t=>{null!=e&&e.has(t.id)||t.dispose()})),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,n=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(-1!==n&&this.tensors.length!==n)throw new Error(`Operation expected a list with ${n} elements but got a list with ${this.tensors.length} elements.`);Vp(e,this.elementShape,"TensorList shape mismatch: ");const r=qp(this.elementShape,this.tensors,e);return(0,O.tidy)((()=>{const e=this.tensors.map((e=>(0,O.reshape)(e,r)));return(0,O.stack)(e,0)}))}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(0===this.size())throw new Error("Trying to pop from an empty list.");const n=qp(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,Vp(r.shape,e,"TensorList shape mismatch: "),(0,O.reshape)(r,n)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Vp(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");(0,O.keep)(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const t=new Kp([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let n=0;n<Math.min(this.tensors.length,e);++n)t.tensors[n]=this.tensors[n];return t}getItem(e,t,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(null==this.tensors[e])throw new Error(`element at index ${e} is null.`);Vp(this.tensors[e].shape,t,"TensorList shape mismatch: ");const r=qp(this.elementShape,this.tensors,t);return(0,O.reshape)(this.tensors[e],r)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Vp(this.elementShape,t.shape,"TensorList shape mismatch: "),(0,O.keep)(t),null!=this.tensors[e]&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,n){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);Vp(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=qp(this.elementShape,this.tensors,n);return 0===e.length?(0,O.tensor)([],[0].concat(r)):(0,O.tidy)((()=>{const t=e.map((e=>(0,O.reshape)(this.tensors[e],r)));return(0,O.stack)(t,0)}))}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Vp(this.elementShape,t,"TensorList shape mismatch: ");const n=qp(this.elementShape,this.tensors,t);return 0===this.size()?(0,O.tensor)([],[0].concat(n)):(0,O.tidy)((()=>{const e=this.tensors.map((e=>(0,O.reshape)(e,n)));return(0,O.concat)(e,0)}))}}function Jp(e,t,n){const[r,i]=tp("fusedOps",e,t,n),o="biasadd"===r,a=!o,s="prelu"===i,u="fusedbatchnorm"===r,l=tp("numArgs",e,t,n);if(o){if(s&&2!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&o&&1!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=tp("strides",e,t,n),p=sp(e,t,n),d=tp("dataFormat",e,t,n).toUpperCase(),h=tp("dilations",e,t,n);let[f,g]=tp("args",e,t,n);return a&&(g=f,f=void 0),{stride:c,pad:p,dataFormat:d,dilations:h,biasArg:f,preluArg:g,activationFunc:i,leakyreluAlpha:tp("leakyreluAlpha",e,t,n)}}function Zp(e,t,n){return{boxes:tp("boxes",e,t,n),scores:tp("scores",e,t,n),maxOutputSize:tp("maxOutputSize",e,t,n),iouThreshold:tp("iouThreshold",e,t,n),scoreThreshold:tp("scoreThreshold",e,t,n),softNmsSigma:tp("softNmsSigma",e,t,n)}}class Qp{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=(0,O.scalar)(0),this.tensorMap=new Map,(0,O.keep)(this.handle)}clearAndClose(){this.tensorMap.forEach((e=>e.dispose())),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return $.i(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return this.tensorMap.forEach((e=>e.dispose())),this.tensorMap.clear(),(0,O.tidy)((()=>{const e=(0,O.unstack)(t),r=n.length,i=e.length;O.util.assert(r===i,(()=>`The number of elements doesn't match, keys has ${r} elements, the values has ${i} elements.`));for(let t=0;t<r;t++){const r=n[t],i=e[t];(0,O.keep)(i),this.tensorMap.set(r,i)}return this.handle}))}async find(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return(0,O.tidy)((()=>{const e=[];for(let r=0;r<n.length;r++){const i=n[r],o=this.findWithDefault(i,t);e.push(o)}return(0,O.stack)(e)}))}findWithDefault(e,t){const n=this.tensorMap.get(e);return null!=n?n:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}function ed(e,t,n,r,i=O.tidy){const o=((e,t,n)=>{switch(e.category){case"arithmetic":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(tp("a",e,t,n),tp("b",e,t,n))];case"AddN":return[r.addN(tp("tensors",e,t,n))];case"FloorMod":case"Mod":return[r.mod(tp("a",e,t,n),tp("b",e,t,n))];case"Mul":return[r.mul(tp("a",e,t,n),tp("b",e,t,n))];case"RealDiv":case"Div":return[r.div(tp("a",e,t,n),tp("b",e,t,n))];case"DivNoNan":return[r.divNoNan(tp("a",e,t,n),tp("b",e,t,n))];case"FloorDiv":return[r.floorDiv(tp("a",e,t,n),tp("b",e,t,n))];case"Sub":return[r.sub(tp("a",e,t,n),tp("b",e,t,n))];case"Minimum":return[r.minimum(tp("a",e,t,n),tp("b",e,t,n))];case"Maximum":return[r.maximum(tp("a",e,t,n),tp("b",e,t,n))];case"Pow":return[r.pow(tp("a",e,t,n),tp("b",e,t,n))];case"SquaredDifference":return[r.squaredDifference(tp("a",e,t,n),tp("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"basic_math":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"Abs":case"ComplexAbs":return[r.abs(tp("x",e,t,n))];case"Acos":return[r.acos(tp("x",e,t,n))];case"Acosh":return[r.acosh(tp("x",e,t,n))];case"Asin":return[r.asin(tp("x",e,t,n))];case"Asinh":return[r.asinh(tp("x",e,t,n))];case"Atan":return[r.atan(tp("x",e,t,n))];case"Atan2":return[r.atan2(tp("x",e,t,n),tp("y",e,t,n))];case"Atanh":return[r.atanh(tp("x",e,t,n))];case"Ceil":return[r.ceil(tp("x",e,t,n))];case"Complex":return[r.complex(tp("real",e,t,n),tp("imag",e,t,n))];case"Cos":return[r.cos(tp("x",e,t,n))];case"Cosh":return[r.cosh(tp("x",e,t,n))];case"Elu":return[r.elu(tp("x",e,t,n))];case"Erf":return[r.erf(tp("x",e,t,n))];case"Exp":return[r.exp(tp("x",e,t,n))];case"Expm1":return[r.expm1(tp("x",e,t,n))];case"Floor":return[r.floor(tp("x",e,t,n))];case"Log":return[r.log(tp("x",e,t,n))];case"Log1p":return[r.log1p(tp("x",e,t,n))];case"Imag":return[r.imag(tp("x",e,t,n))];case"Neg":return[r.neg(tp("x",e,t,n))];case"Reciprocal":return[r.reciprocal(tp("x",e,t,n))];case"Real":return[r.real(tp("x",e,t,n))];case"Relu":return[r.relu(tp("x",e,t,n))];case"Round":return[r.round(tp("x",e,t,n))];case"Selu":return[r.selu(tp("x",e,t,n))];case"Sigmoid":return[r.sigmoid(tp("x",e,t,n))];case"Sin":return[r.sin(tp("x",e,t,n))];case"Sign":return[r.sign(tp("x",e,t,n))];case"Sinh":return[r.sinh(tp("x",e,t,n))];case"Softplus":return[r.softplus(tp("x",e,t,n))];case"Sqrt":return[r.sqrt(tp("x",e,t,n))];case"Square":return[r.square(tp("x",e,t,n))];case"Tanh":return[r.tanh(tp("x",e,t,n))];case"Tan":return[r.tan(tp("x",e,t,n))];case"ClipByValue":return[r.clipByValue(tp("x",e,t,n),tp("clipValueMin",e,t,n),tp("clipValueMax",e,t,n))];case"Relu6":return[r.relu6(tp("x",e,t,n))];case"Rsqrt":return[r.rsqrt(np(e.inputNames[0],t,n))];case"LeakyRelu":return[r.leakyRelu(tp("x",e,t,n),tp("alpha",e,t,n))];case"Prelu":return[r.prelu(tp("x",e,t,n),tp("alpha",e,t,n))];case"IsNan":return[r.isNaN(np(e.inputNames[0],t,n))];case"IsInf":return[r.isInf(np(e.inputNames[0],t,n))];case"IsFinite":return[r.isFinite(np(e.inputNames[0],t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"control":return(async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{const r=tp("thenBranch",e,t,n),i=tp("elseBranch",e,t,n),o=tp("cond",e,t,n),a=tp("args",e,t,n);return(await o.data())[0]?n.functionMap[r].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap):n.functionMap[i].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=tp("body",e,t,n),i=tp("cond",e,t,n),o=tp("args",e,t,n),a=await n.functionMap[i].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap),s=o.map((e=>e.id));let u=await a[0].data();a.forEach((e=>{e.kept||-1!==s.indexOf(e.id)||e.dispose()}));let l=o;for(;u[0];){const e=l;l=await n.functionMap[r].executeFunctionAsync(l,n.tensorArrayMap,n.tensorListMap);const t=l.map((e=>e.id));e.forEach((e=>{e.kept||-1!==s.indexOf(e.id)||-1!==t.indexOf(e.id)||e.dispose()}));const o=await n.functionMap[i].executeFunctionAsync(l,n.tensorArrayMap,n.tensorListMap);u=await o[0].data(),o.forEach((e=>{e.kept||-1!==s.indexOf(e.id)||-1!==t.indexOf(e.id)||e.dispose()}))}return l}case"LoopCond":return[up(tp("pred",e,t,n))];case"Switch":{const r=tp("pred",e,t,n);let i=tp("data",e,t,n);return i.kept||(i=up(i)),(await r.data())[0]?[void 0,i]:[i,void 0]}case"Merge":{const r=e.inputNames.find((e=>void 0!==np(e,t,n)));return r?[up(np(r,t,n))]:void 0}case"Enter":{const r=tp("frameName",e,t,n),i=tp("tensor",e,t,n);return n.enterFrame(r),[up(i)]}case"Exit":{const r=tp("tensor",e,t,n);return n.exitFrame(),[up(r)]}case"NextIteration":{const r=tp("tensor",e,t,n);return n.nextIteration(),[up(r)]}case"TensorArrayV3":{const r=tp("size",e,t,n),i=tp("dtype",e,t,n),o=tp("elementShape",e,t,n),a=tp("dynamicSize",e,t,n),s=tp("clearAfterRead",e,t,n),u=tp("identicalElementShapes",e,t,n),l=tp("name",e,t,n),c=new Yp(l,i,r,o,u,a,s);return n.addTensorArray(c),[c.idTensor,(0,O.scalar)(1)]}case"TensorArrayWriteV3":{const r=tp("tensorArrayId",e,t,n),i=tp("index",e,t,n),o=tp("tensor",e,t,n),a=n.getTensorArray(r.id);return a.write(i,o),[a.idTensor]}case"TensorArrayReadV3":{const r=tp("tensorArrayId",e,t,n),i=tp("index",e,t,n);return[n.getTensorArray(r.id).read(i)]}case"TensorArrayGatherV3":{const r=tp("tensorArrayId",e,t,n),i=tp("indices",e,t,n),o=tp("dtype",e,t,n);return[n.getTensorArray(r.id).gather(i,o)]}case"TensorArrayScatterV3":{const r=tp("tensorArrayId",e,t,n),i=tp("indices",e,t,n),o=tp("tensor",e,t,n),a=n.getTensorArray(r.id);return a.scatter(i,o),[a.idTensor]}case"TensorArrayConcatV3":{const r=tp("tensorArrayId",e,t,n),i=n.getTensorArray(r.id),o=tp("dtype",e,t,n);return[i.concat(o)]}case"TensorArraySplitV3":{const r=tp("tensorArrayId",e,t,n),i=tp("tensor",e,t,n),o=tp("lengths",e,t,n),a=n.getTensorArray(r.id);return a.split(o,i),[a.idTensor]}case"TensorArraySizeV3":{const r=tp("tensorArrayId",e,t,n),i=n.getTensorArray(r.id);return[(0,O.scalar)(i.size(),"int32")]}case"TensorArrayCloseV3":{const r=tp("tensorArrayId",e,t,n),i=n.getTensorArray(r.id);return i.clearAndClose(),[i.idTensor]}case"TensorListSetItem":{const r=tp("tensorListId",e,t,n),i=tp("index",e,t,n),o=tp("tensor",e,t,n),a=n.getTensorList(r.id);return a.setItem(i,o),[a.idTensor]}case"TensorListGetItem":{const r=tp("tensorListId",e,t,n),i=tp("index",e,t,n),o=tp("elementShape",e,t,n),a=tp("elementDType",e,t,n);return[n.getTensorList(r.id).getItem(i,o,a)]}case"TensorListScatterV2":case"TensorListScatter":{const r=tp("indices",e,t,n),i=function(e,t,n,r){if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const i=Math.max(...t);if(null!=r&&-1!==r&&i>=r)throw new Error(`Max index must be < array size (${i}  vs. ${r})`);const o=new Kp([],n,e.dtype,r),a=(0,O.unstack)(e,0);return t.forEach(((e,t)=>{o.setItem(e,a[t])})),o}(tp("tensor",e,t,n),r,tp("elementShape",e,t,n),tp("numElements",e,t,n));return n.addTensorList(i),[i.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=tp("elementShape",e,t,n),i=tp("elementDType",e,t,n);let o;o="TensorListReserve"===e.op?"numElements":"maxNumElements";const a=tp(o,e,t,n),s=function(e,t,n,r){return new Kp([],e,t,r)}(r,i,0,"TensorListReserve"===e.op?-1:a);return n.addTensorList(s),[s.idTensor]}case"TensorListGather":{const r=tp("tensorListId",e,t,n),i=tp("indices",e,t,n),o=tp("elementShape",e,t,n),a=tp("elementDType",e,t,n);return[n.getTensorList(r.id).gather(i,a,o)]}case"TensorListStack":{const r=tp("tensorListId",e,t,n),i=tp("elementShape",e,t,n),o=tp("elementDType",e,t,n),a=tp("numElements",e,t,n);return[n.getTensorList(r.id).stack(i,o,a)]}case"TensorListFromTensor":{const r=function(e,t,n){const r=e.dtype;if(e.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${e.shape}`);if(e.dtype!==n)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${n}`);Vp(e.shape.slice(1),t,"TensorList shape mismatch: ");const i=(0,O.unstack)(e);return new Kp(i,t,r)}(tp("tensor",e,t,n),tp("elementShape",e,t,n),tp("elementDType",e,t,n));return n.addTensorList(r),[r.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=tp("tensorListId",e,t,n),i=n.getTensorList(r.id),o=tp("dtype",e,t,n),a=tp("elementShape",e,t,n);return[i.concat(o,a)]}case"TensorListPushBack":{const r=tp("tensorListId",e,t,n),i=tp("tensor",e,t,n),o=n.getTensorList(r.id);return o.pushBack(i),[o.idTensor]}case"TensorListPopBack":{const r=tp("tensorListId",e,t,n),i=tp("elementShape",e,t,n),o=tp("elementDType",e,t,n);return[n.getTensorList(r.id).popBack(i,o)]}case"TensorListSplit":{const r=tp("tensor",e,t,n),i=tp("elementShape",e,t,n),o=function(e,t,n){let r=0;const i=t.map((e=>(r+=e,r)));if(r!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${r}, and tensor's shape is: ${e.shape}`);const o=Xp(e.shape.slice(1),n),a=0===r?0:e.size/r,s=(0,O.tidy)((()=>{const n=[];e=(0,O.reshape)(e,[1,r,a]);for(let r=0;r<t.length;++r){const s=[0,0===r?0:i[r-1],0],u=[1,t[r],a];n[r]=(0,O.reshape)((0,O.slice)(e,s,u),o)}return e.dispose(),n})),u=new Kp([],n,e.dtype,t.length);for(let e=0;e<s.length;e++)u.setItem(e,s[e]);return u}(r,tp("lengths",e,t,n),i);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const r=tp("tensorListId",e,t,n),i=n.getTensorList(r.id);return[(0,O.scalar)(i.size(),"int32")]}case"TensorListResize":{const r=tp("tensorListId",e,t,n),i=tp("size",e,t,n),o=n.getTensorList(r.id).resize(i);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n);case"convolution":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"Conv1D":{const i=tp("stride",e,t,n),o=tp("pad",e,t,n),a=tp("dataFormat",e,t,n).toUpperCase(),s=tp("dilation",e,t,n);return[r.conv1d(tp("x",e,t,n),tp("filter",e,t,n),i,o,a,s)]}case"Conv2D":{const i=tp("strides",e,t,n),o=sp(e,t,n),a=tp("dataFormat",e,t,n).toUpperCase(),s=tp("dilations",e,t,n);return[r.conv2d(tp("x",e,t,n),tp("filter",e,t,n),[i[1],i[2]],o,a,[s[1],s[2]])]}case"_FusedConv2D":{const{stride:i,pad:o,dataFormat:a,dilations:s,biasArg:u,preluArg:l,activationFunc:c,leakyreluAlpha:p}=Jp(e,t,n);return[r.fused.conv2d({x:tp("x",e,t,n),filter:tp("filter",e,t,n),strides:[i[1],i[2]],pad:o,dataFormat:a,dilations:[s[1],s[2]],bias:u,activation:c,preluActivationWeights:l,leakyreluAlpha:p})]}case"FusedDepthwiseConv2dNative":{const{stride:i,pad:o,dataFormat:a,dilations:s,biasArg:u,preluArg:l,activationFunc:c,leakyreluAlpha:p}=Jp(e,t,n);return[r.fused.depthwiseConv2d({x:tp("x",e,t,n),filter:tp("filter",e,t,n),strides:[i[1],i[2]],pad:o,dataFormat:a,dilations:[s[1],s[2]],bias:u,activation:c,preluActivationWeights:l,leakyreluAlpha:p})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const i=tp("outputShape",e,t,n),o=tp("strides",e,t,n),a=sp(e,t,n);return[r.conv2dTranspose(tp("x",e,t,n),tp("filter",e,t,n),i,[o[1],o[2]],a)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const i=tp("strides",e,t,n),o=sp(e,t,n),a=tp("dilations",e,t,n),s=tp("dataFormat",e,t,n).toUpperCase();return[r.depthwiseConv2d(tp("input",e,t,n),tp("filter",e,t,n),[i[1],i[2]],o,s,[a[1],a[2]])]}case"Conv3D":{const i=tp("strides",e,t,n),o=tp("pad",e,t,n),a=tp("dataFormat",e,t,n).toUpperCase(),s=tp("dilations",e,t,n);return[r.conv3d(tp("x",e,t,n),tp("filter",e,t,n),[i[1],i[2],i[3]],o,a,[s[1],s[2],s[3]])]}case"AvgPool":{const i=tp("strides",e,t,n),o=tp("pad",e,t,n),a=tp("kernelSize",e,t,n);return[r.avgPool(tp("x",e,t,n),[a[1],a[2]],[i[1],i[2]],o)]}case"MaxPool":{const i=tp("strides",e,t,n),o=tp("pad",e,t,n),a=tp("kernelSize",e,t,n);return[r.maxPool(tp("x",e,t,n),[a[1],a[2]],[i[1],i[2]],o)]}case"MaxPoolWithArgmax":{const i=tp("strides",e,t,n),o=tp("pad",e,t,n),a=tp("kernelSize",e,t,n),s=tp("includeBatchInIndex",e,t,n),{result:u,indexes:l}=r.maxPoolWithArgmax(tp("x",e,t,n),[a[1],a[2]],[i[1],i[2]],o,s);return[u,l]}case"AvgPool3D":{const i=tp("strides",e,t,n),o=tp("pad",e,t,n),a=tp("kernelSize",e,t,n);return[r.avgPool3d(tp("x",e,t,n),[a[1],a[2],a[3]],[i[1],i[2],i[3]],o)]}case"MaxPool3D":{const i=tp("strides",e,t,n),o=tp("pad",e,t,n),a=tp("kernelSize",e,t,n);return[r.maxPool3d(tp("x",e,t,n),[a[1],a[2],a[3]],[i[1],i[2],i[3]],o)]}case"Dilation2D":{const i=tp("strides",e,t,n),o=tp("pad",e,t,n),a=tp("dilations",e,t,n),s=i[1],u=i[2],l=a[1],c=a[2];return[r.dilation2d(tp("x",e,t,n),tp("filter",e,t,n),[s,u],o,[l,c],"NHWC")]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"creation":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"Fill":{const i=tp("shape",e,t,n),o=tp("dtype",e,t,n),a=tp("value",e,t,n);return[r.fill(i,a,o)]}case"LinSpace":{const i=tp("start",e,t,n),o=tp("stop",e,t,n),a=tp("num",e,t,n);return[r.linspace(i,o,a)]}case"Multinomial":{const i=tp("logits",e,t,n),o=tp("numSamples",e,t,n),a=tp("seed",e,t,n);return[r.multinomial(i,o,a)]}case"OneHot":{const i=tp("indices",e,t,n),o=tp("depth",e,t,n),a=tp("onValue",e,t,n),s=tp("offValue",e,t,n),u=tp("dtype",e,t,n);return[r.oneHot(i,o,a,s,u)]}case"Ones":return[r.ones(tp("shape",e,t,n),tp("dtype",e,t,n))];case"OnesLike":return[r.onesLike(tp("x",e,t,n))];case"RandomStandardNormal":return[r.randomStandardNormal(tp("shape",e,t,n),tp("dtype",e,t,n),tp("seed",e,t,n))];case"RandomUniform":return[r.randomUniform(tp("shape",e,t,n),tp("minval",e,t,n),tp("maxval",e,t,n),tp("dtype",e,t,n))];case"RandomUniformInt":return[r.randomUniformInt(tp("shape",e,t,n),tp("minval",e,t,n),tp("maxval",e,t,n),tp("seed",e,t,n))];case"Range":{const i=tp("start",e,t,n),o=tp("stop",e,t,n),a=tp("step",e,t,n);return[r.range(i,o,a,tp("dtype",e,t,n))]}case"TruncatedNormal":{const i=tp("shape",e,t,n),o=tp("mean",e,t,n),a=tp("stdDev",e,t,n),s=tp("seed",e,t,n);return[r.truncatedNormal(i,o,a,tp("dtype",e,t,n),s)]}case"Zeros":return[r.zeros(tp("shape",e,t,n),tp("dtype",e,t,n))];case"ZerosLike":return[r.zerosLike(tp("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"dynamic":return(async(e,t,n,r,i=C)=>{switch(e.op){case"NonMaxSuppressionV5":{const{boxes:r,scores:o,maxOutputSize:a,iouThreshold:s,scoreThreshold:u,softNmsSigma:l}=Zp(e,t,n),c=await i.image.nonMaxSuppressionWithScoreAsync(r,o,a,s,u,l);return[c.selectedIndices,c.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:r,scores:o,maxOutputSize:a,iouThreshold:s,scoreThreshold:u}=Zp(e,t,n),l=tp("padToMaxOutputSize",e,t,n),c=await i.image.nonMaxSuppressionPaddedAsync(r,o,a,s,u,l);return[c.selectedIndices,c.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:r,scores:o,maxOutputSize:a,iouThreshold:s,scoreThreshold:u}=Zp(e,t,n);return[await i.image.nonMaxSuppressionAsync(r,o,a,s,u)]}case"Where":{const r=i.cast(tp("condition",e,t,n),"bool"),o=[await i.whereAsync(r)];return r.dispose(),o}case"ListDiff":return i.setdiff1dAsync(tp("x",e,t,n),tp("y",e,t,n));default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n);case"evaluation":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"LowerBound":{const i=tp("sortedSequence",e,t,n),o=tp("values",e,t,n);return[r.lowerBound(i,o)]}case"TopKV2":{const i=tp("x",e,t,n),o=tp("k",e,t,n),a=tp("sorted",e,t,n),s=r.topk(i,o,a);return[s.values,s.indices]}case"UpperBound":{const i=tp("sortedSequence",e,t,n),o=tp("values",e,t,n);return[r.upperBound(i,o)]}case"Unique":{const i=tp("x",e,t,n),o=r.unique(i);return[o.values,o.indices]}case"UniqueV2":{const i=tp("x",e,t,n),o=tp("axis",e,t,n),a=r.unique(i,o);return[a.values,a.indices]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"image":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"ResizeBilinear":{const i=tp("images",e,t,n),o=tp("size",e,t,n),a=tp("alignCorners",e,t,n),s=tp("halfPixelCenters",e,t,n);return[r.image.resizeBilinear(i,[o[0],o[1]],a,s)]}case"ResizeNearestNeighbor":{const i=tp("images",e,t,n),o=tp("size",e,t,n),a=tp("alignCorners",e,t,n),s=tp("halfPixelCenters",e,t,n);return[r.image.resizeNearestNeighbor(i,[o[0],o[1]],a,s)]}case"CropAndResize":{const i=tp("image",e,t,n),o=tp("boxes",e,t,n),a=tp("boxInd",e,t,n),s=tp("cropSize",e,t,n),u=tp("method",e,t,n),l=tp("extrapolationValue",e,t,n);return[r.image.cropAndResize(i,o,a,s,u,l)]}case"ImageProjectiveTransformV3":{const i=tp("images",e,t,n),o=tp("transforms",e,t,n),a=tp("outputShape",e,t,n),s=tp("fillValue",e,t,n),u=tp("interpolation",e,t,n),l=tp("fillMode",e,t,n);return[r.image.transform(i,o,u.toLowerCase(),l.toLowerCase(),s,a)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"graph":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":const i=tp("default",e,t,n);return[np(e.name,t,n)||i];case"Placeholder":return[np(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[up(tp("x",e,t,n))];case"IdentityN":return tp("x",e,t,n).map((e=>up(e)));case"Shape":return[r.tensor1d(tp("x",e,t,n).shape,"int32")];case"ShapeN":return tp("x",e,t,n).map((e=>r.tensor1d(e.shape)));case"Size":return[r.scalar(tp("x",e,t,n).size,"int32")];case"Rank":return[r.scalar(tp("x",e,t,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const o=tp("x",e,t,n),a=tp("data",e,t,n),s=tp("message",e,t,n),u=tp("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(s);for(let e=0;e<a.length;e++)console.log(Array.prototype.slice.call(a[e].dataSync()).slice(0,u));return[o];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"logical":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"Equal":return[r.equal(tp("a",e,t,n),tp("b",e,t,n))];case"NotEqual":return[r.notEqual(tp("a",e,t,n),tp("b",e,t,n))];case"Greater":return[r.greater(tp("a",e,t,n),tp("b",e,t,n))];case"GreaterEqual":return[r.greaterEqual(tp("a",e,t,n),tp("b",e,t,n))];case"Less":return[r.less(tp("a",e,t,n),tp("b",e,t,n))];case"LessEqual":return[r.lessEqual(tp("a",e,t,n),tp("b",e,t,n))];case"LogicalAnd":return[r.logicalAnd(tp("a",e,t,n),tp("b",e,t,n))];case"LogicalNot":return[r.logicalNot(tp("a",e,t,n))];case"LogicalOr":return[r.logicalOr(tp("a",e,t,n),tp("b",e,t,n))];case"Select":case"SelectV2":return[r.where(tp("condition",e,t,n),tp("a",e,t,n),tp("b",e,t,n))];case"BitwiseAnd":return[r.bitwiseAnd(tp("a",e,t,n),tp("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"matrices":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(tp("a",e,t,n),tp("b",e,t,n),tp("transposeA",e,t,n),tp("transposeB",e,t,n))];case"Einsum":return[r.einsum(tp("equation",e,t,n),...tp("tensors",e,t,n))];case"Transpose":return[r.transpose(tp("x",e,t,n),tp("perm",e,t,n))];case"_FusedMatMul":const[i,o]=tp("fusedOps",e,t,n),a="biasadd"===i,s="prelu"===o,u=tp("numArgs",e,t,n),l=tp("leakyreluAlpha",e,t,n);if(a){if(s&&2!==u)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&1!==u)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,p]=tp("args",e,t,n);return[r.fused.matMul({a:tp("a",e,t,n),b:tp("b",e,t,n),transposeA:tp("transposeA",e,t,n),transposeB:tp("transposeB",e,t,n),bias:c,activation:o,preluActivationWeights:p,leakyreluAlpha:l})];case"MatrixBandPart":return[r.linalg.bandPart(tp("a",e,t,n),tp("numLower",e,t,n),tp("numUpper",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"normalization":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"EuclideanNorm":return[r.euclideanNorm(tp("x",e,t,n),tp("axis",e,t,n),tp("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[r.batchNorm(tp("x",e,t,n),tp("mean",e,t,n),tp("variance",e,t,n),tp("offset",e,t,n),tp("scale",e,t,n),tp("epsilon",e,t,n))];case"LRN":return[r.localResponseNormalization(tp("x",e,t,n),tp("radius",e,t,n),tp("bias",e,t,n),tp("alpha",e,t,n),tp("beta",e,t,n))];case"Softmax":return[r.softmax(tp("x",e,t,n))];case"LogSoftmax":return[r.logSoftmax(tp("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"ragged":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"RaggedGather":{const{outputNestedSplits:i,outputDenseValues:o}=r.raggedGather(tp("paramsNestedSplits",e,t,n),tp("paramsDenseValues",e,t,n),tp("indices",e,t,n),tp("outputRaggedRank",e,t,n));return i.concat(o)}case"RaggedRange":{const{rtNestedSplits:i,rtDenseValues:o}=r.raggedRange(tp("starts",e,t,n),tp("limits",e,t,n),tp("splits",e,t,n));return[i,o]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(tp("shape",e,t,n),tp("values",e,t,n),tp("defaultValue",e,t,n),tp("rowPartitionTensors",e,t,n),tp("rowPartitionTypes",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"reduction":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"Max":{const i=tp("axis",e,t,n),o=tp("keepDims",e,t,n);return[r.max(tp("x",e,t,n),i,o)]}case"Mean":{const i=tp("axis",e,t,n),o=tp("keepDims",e,t,n);return[r.mean(tp("x",e,t,n),i,o)]}case"Min":{const i=tp("axis",e,t,n),o=tp("keepDims",e,t,n);return[r.min(tp("x",e,t,n),i,o)]}case"Sum":{const i=tp("axis",e,t,n),o=tp("keepDims",e,t,n);return[r.sum(tp("x",e,t,n),i,o)]}case"All":{const i=tp("axis",e,t,n),o=tp("keepDims",e,t,n);return[r.all(tp("x",e,t,n),i,o)]}case"Any":{const i=tp("axis",e,t,n),o=tp("keepDims",e,t,n);return[r.any(tp("x",e,t,n),i,o)]}case"ArgMax":{const i=tp("axis",e,t,n);return[r.argMax(tp("x",e,t,n),i)]}case"ArgMin":{const i=tp("axis",e,t,n);return[r.argMin(tp("x",e,t,n),i)]}case"Prod":{const i=tp("axis",e,t,n),o=tp("keepDims",e,t,n);return[r.prod(tp("x",e,t,n),i,o)]}case"Cumprod":{const i=tp("axis",e,t,n),o=tp("exclusive",e,t,n),a=tp("reverse",e,t,n);return[r.cumprod(tp("x",e,t,n),i,o,a)]}case"Cumsum":{const i=tp("axis",e,t,n),o=tp("exclusive",e,t,n),a=tp("reverse",e,t,n);return[r.cumsum(tp("x",e,t,n),i,o,a)]}case"Bincount":const i=tp("x",e,t,n),o=tp("weights",e,t,n),a=tp("size",e,t,n);return[r.bincount(i,o,a)];case"DenseBincount":{const i=tp("x",e,t,n),o=tp("weights",e,t,n),a=tp("size",e,t,n),s=tp("binaryOutput",e,t,n);return[r.denseBincount(i,o,a,s)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"slice_join":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"ConcatV2":case"Concat":{const i=tp("n",e,t,n),o=tp("axis",e,t,n);let a=tp("tensors",e,t,n);return a=a.slice(0,i),[r.concat(a,o)]}case"Gather":{const i=tp("x",e,t,n),o=tp("indices",e,t,n);return[r.gather(i,r.cast(o,"int32"),0)]}case"GatherV2":{const i=tp("axis",e,t,n),o=tp("batchDims",e,t,n),a=tp("x",e,t,n),s=tp("indices",e,t,n);return[r.gather(a,r.cast(s,"int32"),i,o)]}case"Reverse":{const i=tp("dims",e,t,n),o=[];for(let e=0;e<i.length;e++)i[e]&&o.push(e);const a=tp("x",e,t,n);return[r.reverse(a,o)]}case"ReverseV2":{const i=tp("axis",e,t,n),o=tp("x",e,t,n);return[r.reverse(o,i)]}case"Slice":{const i=tp("begin",e,t,n),o=tp("size",e,t,n);return[r.slice(tp("x",e,t,n),i,o)]}case"StridedSlice":{const i=tp("begin",e,t,n),o=tp("end",e,t,n),a=tp("strides",e,t,n),s=tp("beginMask",e,t,n),u=tp("endMask",e,t,n),l=tp("ellipsisMask",e,t,n),c=tp("newAxisMask",e,t,n),p=tp("shrinkAxisMask",e,t,n),d=tp("x",e,t,n);return[r.stridedSlice(d,i,o,a,s,u,l,c,p)]}case"Pack":return(0,O.tidy)((()=>{const i=tp("axis",e,t,n),o=tp("tensors",e,t,n),a=o[0].shape,s=r.squeeze(o[0]).shape,u=o.map((e=>{const t=O.util.arraysEqual(e.shape,a);if(!t&&!O.util.arraysEqual(r.squeeze(e).shape,s))throw new Error("the input tensors shape does not match");return t?e:r.reshape(e,a)}));return[r.stack(u,i)]}));case"Unpack":{const i=tp("axis",e,t,n),o=tp("tensor",e,t,n);return r.unstack(o,i)}case"Tile":{const i=tp("reps",e,t,n);return[r.tile(tp("x",e,t,n),i)]}case"Split":case"SplitV":{const i=tp("axis",e,t,n),o=tp("numOrSizeSplits",e,t,n),a=tp("x",e,t,n);return r.split(a,o,i)}case"ScatterNd":{const i=tp("indices",e,t,n),o=tp("values",e,t,n),a=tp("shape",e,t,n);return[r.scatterND(i,o,a)]}case"GatherNd":{const i=tp("x",e,t,n),o=tp("indices",e,t,n);return[r.gatherND(i,o)]}case"SparseToDense":{const i=tp("sparseIndices",e,t,n),o=tp("outputShape",e,t,n),a=tp("sparseValues",e,t,n),s=tp("defaultValue",e,t,n);return[r.sparseToDense(i,a,o,a.dtype===s.dtype?s:r.cast(s,a.dtype))]}case"TensorScatterUpdate":{const i=tp("indices",e,t,n),o=tp("values",e,t,n),a=tp("tensor",e,t,n);return[r.tensorScatterUpdate(a,i,o)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"sparse":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"SparseFillEmptyRows":{const{outputIndices:i,outputValues:o,emptyRowIndicator:a,reverseIndexMap:s}=r.sparse.sparseFillEmptyRows(tp("indices",e,t,n),tp("values",e,t,n),tp("denseShape",e,t,n),tp("defaultValue",e,t,n));return[i,o,a,s]}case"SparseReshape":{const{outputIndices:i,outputShape:o}=r.sparse.sparseReshape(tp("inputIndices",e,t,n),tp("inputShape",e,t,n),tp("newShape",e,t,n));return[i,o]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(tp("data",e,t,n),tp("indices",e,t,n),tp("segmentIds",e,t,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(tp("data",e,t,n),tp("indices",e,t,n),tp("segmentIds",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"spectral":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"FFT":return[r.fft(tp("x",e,t,n))];case"IFFT":return[r.ifft(tp("x",e,t,n))];case"RFFT":return[r.rfft(tp("x",e,t,n))];case"IRFFT":return[r.irfft(tp("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"string":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(tp("input",e,t,n),tp("pattern",e,t,n),tp("rewrite",e,t,n),tp("replaceGlobal",e,t,n))];case"StringNGrams":{const{nGrams:i,nGramsSplits:o}=r.string.stringNGrams(tp("data",e,t,n),tp("dataSplits",e,t,n),tp("separator",e,t,n),tp("nGramWidths",e,t,n),tp("leftPad",e,t,n),tp("rightPad",e,t,n),tp("padWidth",e,t,n),tp("preserveShortSequences",e,t,n));return[i,o]}case"StringSplit":{const{indices:i,values:o,shape:a}=r.string.stringSplit(tp("input",e,t,n),tp("delimiter",e,t,n),tp("skipEmpty",e,t,n));return[i,o,a]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(tp("input",e,t,n),tp("numBuckets",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"transformation":return i((()=>((e,t,n,r=C)=>{switch(e.op){case"Cast":return[r.cast(tp("x",e,t,n),tp("dtype",e,t,n))];case"ExpandDims":{const i=tp("axis",e,t,n);return[r.expandDims(tp("x",e,t,n),i)]}case"Squeeze":{const i=tp("axis",e,t,n);return[r.squeeze(tp("x",e,t,n),i)]}case"Reshape":return[r.reshape(tp("x",e,t,n),tp("shape",e,t,n))];case"EnsureShape":return[r.ensureShape(tp("x",e,t,n),tp("shape",e,t,n))];case"MirrorPad":return[r.mirrorPad(tp("x",e,t,n),tp("padding",e,t,n),tp("mode",e,t,n))];case"PadV2":case"Pad":return[r.pad(tp("x",e,t,n),tp("padding",e,t,n),tp("constantValue",e,t,n))];case"SpaceToBatchND":{const i=tp("blockShape",e,t,n),o=tp("paddings",e,t,n);return[r.spaceToBatchND(tp("x",e,t,n),i,o)]}case"BatchToSpaceND":{const i=tp("blockShape",e,t,n),o=tp("crops",e,t,n);return[r.batchToSpaceND(tp("x",e,t,n),i,o)]}case"DepthToSpace":{const i=tp("blockSize",e,t,n),o=tp("dataFormat",e,t,n).toUpperCase();return[r.depthToSpace(tp("x",e,t,n),i,o)]}case"BroadcastTo":return[r.broadcastTo(tp("x",e,t,n),tp("shape",e,t,n))];case"BroadcastArgs":return[r.broadcastArgs(tp("s0",e,t,n),tp("s1",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"hash_table":return(async(e,t,n,r)=>{switch(e.op){case"HashTable":case"HashTableV2":{const i=r.getHashTableHandleByName(e.name);if(null!=i)return[i];{const i=tp("keyDType",e,t,n),o=tp("valueDType",e,t,n),a=new Qp(i,o);return r.addHashTable(e.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const i=tp("tableHandle",e,t,n,r),o=tp("keys",e,t,n),a=tp("values",e,t,n),s=r.getHashTableById(i.id);return[await s.import(o,a)]}case"LookupTableFind":case"LookupTableFindV2":{const i=tp("tableHandle",e,t,n,r),o=tp("keys",e,t,n),a=tp("defaultValue",e,t,n),s=r.getHashTableById(i.id);return[await s.find(o,a)]}case"LookupTableSize":case"LookupTableSizeV2":{const i=tp("tableHandle",e,t,n,r);return[r.getHashTableById(i.id).tensorSize()]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n,r);case"custom":const o=Qc(e.op);if(o&&o.customExecutor)return o.customExecutor(new Up(e,t,n));throw TypeError(`Custom op ${e.op} is not registered.`);default:throw TypeError(`Unknown op '${e.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(e,t,n);return O.util.isPromise(o)?o.then((e=>[].concat(e))):[].concat(o)}class td{constructor(e={},t={},n={},r={},i){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=r,this.parseNodeNameCache=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map((e=>0===e.id&&0===e.iterationId?"":`${e.frameName}-${e.iterationId}`)).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}function nd(e,t,n,r){const i=new Set,o=[];let a=null,s=null;const u=new Set,l=new Set(Object.keys(e).map((e=>ap(e)[0])));r=r||[];const c=new Set(r.map((e=>ap(e.name)[0]))),p=[...t];for(;p.length>0;){const e=p.pop();(sd(e)||ud(e)||ld(e))&&null==a&&(a=e,s=a.children.map((e=>e.name)).filter((e=>i.has(e)))),i.add(e.name),null==n[e.name]&&(l.has(e.name)||c.has(e.name)||(0!==e.inputs.length?e.inputs.forEach((e=>{u.has(e.name)||(u.add(e.name),p.push(e))})):o.push(e.name)))}return{inputs:e,outputs:t,usedNodes:i,missingInputs:o,dynamicNode:a,syncInputs:s}}class rd extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}const id=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),od=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),ad=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function sd(e){return id.has(e.op)}function ud(e){return od.has(e.op)}function ld(e){return ad.has(e.op)}class cd{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map((t=>e[t].map((e=>e.id))));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map((e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0})))}get outputs(){return this._outputs.map((e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0})))}get inputNodes(){return this._inputs.map((e=>e.signatureKey||e.name))}get outputNodes(){return this._outputs.map((e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t}))}get functions(){return Object.keys(this._functions).reduce(((e,t)=>(e[t]=this._functions[t].signature,e)),{})}constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,null!=e.functions&&Object.keys(e.functions).forEach((t=>{this._functionExecutorMap[t]=new cd(e.functions[t],this)}))}getCompilationKey(e,t){const n=e.map((e=>e.name)).sort(),r=t.map((e=>e.name)).sort();return n.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(e,t){const n=nd(e,t,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:i,syncInputs:o}=n;if(null!=i)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(r.length>0){const n=t.map((e=>e.name)),i=Object.keys(e);throw new Error(`Cannot compute the outputs [${n}] from the provided inputs [${i}]. Missing the following inputs: [${r}]`)}const a=function(e,t){const{usedNodes:n,inputs:r}=t,i=Object.keys(r).map((e=>ap(e)[0])).map((t=>e.nodes[t])),o=e.initNodes||[],a=e=>n.has("string"==typeof e?e:e.name);function s(e){return[...new Map(e.map((e=>[e.name,e]))).values()]}const u=s([...i,...e.weights,...o]).filter(a),l=s([...u,...Object.values(e.nodes)]).filter(a),c=new Map(l.map((e=>[e.name,e]))),p={};for(const e of l){p[e.name]=p[e.name]||0;for(const t of e.children)a(t)||(p[t.name]=Number.POSITIVE_INFINITY),p[t.name]=(p[t.name]||0)+1}const d=Object.entries(p).filter((([,e])=>0===e)).map((([e])=>e)),h=[...d];for(;d.length>0;){const e=d.pop(),t=c.get(e);for(const e of t.children.filter(a))0==--p[e.name]&&(h.push(e.name),d.push(e.name))}const f=function(e,t){const n=new Map(e.map((e=>[e.name,e]))),r=t.map((e=>e.name)),i=new Set(r);for(;r.length>0;){const e=r.pop(),t=n.get(e);for(const e of t.children)n.has(e.name)&&!i.has(e.name)&&(i.add(e.name),r.push(e.name))}return e.filter((e=>i.has(e.name)))}(h.map((e=>c.get(e))),u);return function(e,t){const n=new Map(e.map(((e,t)=>[e.name,t]))),r=new Set(t.map((e=>e.name))),i=e=>r.has("string"==typeof e?e:e.name),o=new Set(e.map((e=>e.name))),a=e=>o.has("string"==typeof e?e:e.name);for(const t of e){for(const e of t.children.filter(a)){if(!n.has(e.name))throw new rd(`Child ${e.name} of node ${t.name} is unreachable.`);if(n.get(t.name)>n.get(e.name))throw new rd(`Node ${t.name} is scheduled to run after its child ${e.name}.`)}if(!i(t))for(const e of t.inputs){if(!n.has(e.name))throw new rd(`Input ${e.name} of node ${t.name} is unreachable.`);if(n.get(e.name)>n.get(t.name))throw new rd(`Node ${t.name} is scheduled to run before its input ${e.name}.`)}}}(f,u),f}(this.graph,n),s=function(e){const t=new Map(e.map(((e,t)=>[e.name,t]))),n=Number.MAX_SAFE_INTEGER,r=e.map(((e,t)=>sd(e)?n:t)),i=e=>{const n=r[t.get(e.name)];return null==n?-1:n},o=e.map(((e,t)=>e.children.map(i).reduce(((e,t)=>Math.max(e,t)),r[t]))),a=new Map;for(let t=0;t<e.length;++t){const r=o[t];if(r===n)continue;const i=e[t],s=e[r];a.has(s.name)||a.set(s.name,[]),a.get(s.name).push(i)}return a}(a);return{orderedNodes:a,nodeLiveUntilMap:s}}cloneAndKeepTensor(e){if(null==e)return null;const t=e.clone();return(0,O.keep)(t),t}cloneTensorList(e){return e?e.map((e=>this.cloneAndKeepTensor(e))):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map((([e,t])=>[e,this.cloneTensorList(t)])))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);const n=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const r=n.map((e=>this.graph.nodes[ap(e)[0]])),i=t.map((e=>ap(e)[0])),o=new Set(i);let a=i.map((e=>this.graph.nodes[e]));0===a.length&&(a=this._outputs);const s=this.getCompilationKey(r,a);let u=this.compiledMap.get(s);null==u&&(u=this.compile(e,a),this.compiledMap.set(s,u));try{this.keepIntermediateTensors=(0,O.env)().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(e){this.keepIntermediateTensors=!1,console.warn(e.message)}const l={},c={};return(0,O.tidy)((()=>{const n=new td(this.weightMap,l,c,this.functionExecutorMap,this.parseNodeNameCache),r=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach((t=>{const[i,o]=ap(t,n),a=[];a[o]=e[t],r[i]=a,this.keepIntermediateTensors&&(this.clonedTensorsMap[i]=this.cloneTensorList(a))}));const i=this.getFrozenTensorIds(r),{orderedNodes:a,nodeLiveUntilMap:s}=u;for(const e of a){if(r[e.name])continue;const t=ed(e,r,n,this._resourceManager);if(O.util.isPromise(t))throw new Error(`The execution of the op '${e.op}' returned a promise. Please use model.executeAsync() instead.`);r[e.name]=t,this.keepIntermediateTensors&&(this.clonedTensorsMap[e.name]=this.cloneTensorList(t)),this.checkTensorForDisposalWithNodeLiveUntilInfo(e,r,n,i,o,s.get(e.name))}return null==this.parent&&n.dispose(i),t.map((e=>np(e,r,n)))}))}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map((t=>e[t])).map((e=>e.map((e=>e.id)))));return new Set(t)}checkTensorForDisposal(e,t,n,r,i,o,a){if(!sd(t)&&!o.has(e)){for(const r of n[e])null!=r&&(a[r.id]=(a[r.id]||0)+t.children.length);for(const e of t.inputs){if(sd(e))continue;const t=rp(e.name,n,r);if(null!=t)for(const e of t){if(!e||e.kept||i.has(e.id))continue;const t=a[e.id];1===t?(e.dispose(),delete a[e.id]):null!=t&&a[e.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,n,r,i,o){function a(e){return sd(e)||i.has(e.name)}if(!sd(e)&&null!=o)for(const e of o){if(a(e))continue;const i=rp(e.name,t,n);for(const e of i)!e||e.kept||r.has(e.id)||e.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach((e=>{for(const t of e)t&&!t.isDisposed&&t.dispose()})),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t,n=!1,r={},i={}){this.disposeIntermediateTensors(),n||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=(0,O.env)().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(e){this.keepIntermediateTensors=!1,console.warn(e.message)}const o=new td(this.weightMap,r,i,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(e,o,t,n),s=t.map((e=>np(e,a,o))),u=s.map((e=>e.id)),l=Object.keys(e).map((t=>e[t].id)),c=new Set([...u,...l,...this.weightIds]);return Object.values(a).forEach((e=>{e.forEach((e=>{!e||e.isDisposed||c.has(e.id)||e.dispose()}))})),null==this.parent&&o.dispose(c),s}async executeFunctionAsync(e,t,n){const r=e.reduce(((e,t,n)=>(e[this.inputs[n].name]=t,e)),{});return this._executeAsync(r,this.outputNodes,!0,t,n)}async executeWithControlFlow(e,t,n,r){const i=Object.keys(e),o=i.map((e=>this.graph.nodes[ap(e)[0]])),a=n.map((e=>ap(e)[0])),s=new Set(a);let u=a.map((e=>this.graph.nodes[e]));0===u.length&&(u=this._outputs);const{usedNodes:l,missingInputs:c,dynamicNode:p,syncInputs:d}=nd(e,u,this.weightMap,this._initNodes),h=[...o,...this.graph.weights,...this._initNodes||[]].map((e=>({node:e,contexts:t.currentContext}))),f=Object.assign({},this.weightMap);Object.keys(e).forEach((t=>{const[n,r]=ap(t),i=[];i[r]=e[t],f[n]=i}));const g={},m=this.getFrozenTensorIds(f),y={};for(;h.length>0;){const e=this.processStack(o,h,t,f,y,m,s,g,l);await Promise.all(e)}null!=p||r||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const b=u.filter((e=>!sd(e)&&!np(e.name,f,t))).map((e=>e.name));if(b.length>0){let e="";throw null!=p&&(e=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${d}]`),new Error(`Cannot compute the outputs [${b}] from the provided inputs [${i}]. Consider providing the following inputs: [${c}]. ${e}`)}return f}processStack(e,t,n,r,i,o,a,s,u){const l=[];for(;t.length>0;){const e=t.pop();n.currentContext=e.contexts;let c="";if("Enter"===e.node.op&&tp("isConstant",e.node,r,n)&&([c]=ip(e.node.name,n)),null==r[e.node.name]){const p=ed(e.node,r,n,this._resourceManager);c||([c]=ip(e.node.name,n));const d=n.currentContext;O.util.isPromise(p)?l.push(p.then((l=>(r[c]=l,this.keepIntermediateTensors&&(this.clonedTensorsMap[c]=this.cloneTensorList(l)),n.currentContext=d,this.checkTensorForDisposal(c,e.node,r,n,o,a,s),this.processChildNodes(e.node,t,n,r,i,u),l)))):(r[c]=p,this.keepIntermediateTensors&&(this.clonedTensorsMap[c]=this.cloneTensorList(p)),this.checkTensorForDisposal(c,e.node,r,n,o,a,s),this.processChildNodes(e.node,t,n,r,i,u))}else this.processChildNodes(e.node,t,n,r,i,u)}return l}processChildNodes(e,t,n,r,i,o){e.children.forEach((e=>{const[a]=ip(e.name,n);!i[a]&&o.has(e.name)&&("Merge"===e.op?e.inputNames.some((e=>!!np(e,r,n)))&&(i[a]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((e=>!!np(e,r,n)))&&(i[a]=!0,t.push({contexts:n.currentContext,node:e})))}))}dispose(){Object.keys(this.weightMap).forEach((e=>this.weightMap[e].forEach((e=>e.dispose()))))}checkInputShapeAndType(e){Object.keys(e).forEach((t=>{const n=e[t],[r]=ap(t),i=this.graph.nodes[r];if(i.attrParams.shape&&i.attrParams.shape.value){const e=i.attrParams.shape.value,t=e.length===n.shape.length&&n.shape.every(((t,n)=>-1===e[n]||e[n]===t));O.util.assert(t,(()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${e}], but was [${n.shape}]`))}i.attrParams.dtype&&i.attrParams.dtype.value&&O.util.assert(n.dtype===i.attrParams.dtype.value,(()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${n.dtype}`))}))}mapInputs(e){var t,n;const r={};for(const i in e){const o=null===(n=null===(t=this._signature)||void 0===t?void 0:t.inputs)||void 0===n?void 0:n[i];null!=o?r[o.name]=e[i]:r[i]=e[i]}return r}checkInputs(e){const t=Object.keys(e).filter((e=>{const[t]=ap(e);return null==this.graph.nodes[t]}));if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map((e=>{var t,n;const r=null===(n=null===(t=this._signature)||void 0===t?void 0:t.outputs)||void 0===n?void 0:n[e];return null!=r?r.name:e}),{})}checkOutputs(e){e.forEach((e=>{const[t]=ap(e);if(!this.graph.nodes[t])throw new Error(`The output '${e}' is not found in the graph`)}))}}class pd{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}const dd="?tfjs-format=file",hd="model.json";class fd{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,t={},n=O.io){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=n,null==t&&(this.loadOptions={}),this.resourceManager=new pd}findIOHandler(){const e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return O.util.isPromise(e)?e.then((e=>this.loadSync(e))):this.loadSync(e)}loadSync(e){this.artifacts=e;const t=this.artifacts.modelTopology;let n=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){const e=this.artifacts.userDefinedMetadata;null!=e.signature&&(n=e.signature),null!=e.structuredOutputKeys&&(this.structuredOutputKeys=e.structuredOutputKeys)}this.signature=n,this.version=`${t.versions.producer}.${t.versions.minConsumer}`;const r=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new cd(Ep.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){const t=Ep.Instance.transformGraph(e.modelInitializer);this.initializer=new cd(t),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if("string"==typeof e){const t=this.io.getSaveHandlers(e);if(0===t.length)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(t.length>1)throw new Error(`Found more than one (${t.length}) save handlers for URL '${e}'`);e=t[0]}if(null==e.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const t=e instanceof O.Tensor?[e]:e,n={};return t.forEach(((e,t)=>n[this.structuredOutputKeys[t]]=e)),n}return e}predict(e,t){const n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}async predictAsync(e,t){const n=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(n)}normalizeInputs(e){var t;if(!(e instanceof O.Tensor||Array.isArray(e))){const n=null===(t=this.signature)||void 0===t?void 0:t.inputs;if(null!=n)for(const t in n){const r=n[t];null!=r.resourceId&&(e[t]=this.resourceIdToCapturedInput[r.resourceId])}return e}e=Array.isArray(e)?e:[e];const n=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+n!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-n} non-resource placeholders, while there are ${e.length} input tensors provided.`);let r=0;return this.inputNodes.reduce(((t,n)=>{var i,o,a;const s=null===(a=null===(o=null===(i=this.signature)||void 0===i?void 0:i.inputs)||void 0===o?void 0:o[n])||void 0===a?void 0:a.resourceId;return t[n]=null!=s?this.resourceIdToCapturedInput[s]:e[r++],t}),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const t=this.initializerSignature.outputs,n=Object.keys(t);for(let r=0;r<n.length;r++){const i=t[n[r]];this.resourceIdToCapturedInput[i.resourceId]=e[r]}}}execute(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce(((t,n)=>(t[n]=[e[n]],t)),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&(0,O.dispose)(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function gd(e,t={},n=O.io){if(null==e)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==t&&(t={}),t.fromTFHub&&"string"==typeof e&&(e=function(e){return e.endsWith("/")||(e+="/"),`${e}${hd}${dd}`}(e));const r=new fd(e,t,n);return await r.load(),r}function md(e){if(null==e)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let t;if(e instanceof Array){const[n,r]=e;if(!n)throw new Error("modelJSON must be the first element of the array");if(!(r&&r instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in n))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in n))throw new Error("Model JSON is missing 'weightsManifest'");const i=O.io.getWeightSpecs(n.weightsManifest),o=O.io.getModelArtifactsForJSONSync(n,i,r);t=O.io.fromMemorySync(o)}else if("load"in e)t=e;else{if(!("modelTopology"in e&&"weightSpecs"in e&&"weightData"in e))throw new Error("Unknown model format");t=O.io.fromMemorySync(e)}const n=new fd(t);return n.load(),n}const yd="4.8.0";var bd,vd=__webpack_require__(6377);function xd(e,t,n=new Map,r=new Set){if(null==e)return null;if("function"==typeof Blob&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);const i=t(e);if(i.recurse&&null!==i.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(Cd(e)){const i=Array.isArray(e)?[]:{};r.add(e);for(const o in e){const a=xd(e[o],t,n,r);i[o]=a}return r.delete(e),e.__proto__&&(i.__proto__=e.__proto__),i}throw new Error(`Can't recurse into non-iterable type: ${e}`)}return n.set(e,i.value),i.value}function _d(e,t=kd){return wd(e,t)}function wd(e,t,n=new Set){const r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");const i=t(e);if(i.recurse&&null!==i.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(Cd(r)){const i=Array.isArray(r)?[]:{};n.add(r);for(const o in r){const r=wd(e.map((e=>e[o])),t,n);i[o]=r}return n.delete(r),i}throw new Error(`Can't recurse into non-iterable type: ${r}`)}return i.value}function kd(e){return null===e?null:Cd(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}async function Sd(e,t){const n=new Map;xd(e,t,n);for(const e of Array.from(n.keys())){const t=n.get(e);if(O.util.isPromise(t)){const r=await t;n.set(e,r)}}return xd(e,t,n)}function Cd(e){let t=!1;if(O.env().get("IS_BROWSER"))t=e instanceof TextDecoder;else{const{StringDecoder:n}=__webpack_require__(4977);t=e instanceof n}return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"==typeof e&&!(e instanceof O.Tensor)&&!(e instanceof Promise)&&!t)}function Md(e){return e instanceof O.Tensor?{value:e.clone(),recurse:!1}:Cd(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}class Td{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,null==e)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(const t of e)this.push(t)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}class Ed extends Td{constructor(){super(Ed.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){const e=2*this.capacity,t=new Array(e),n=this.length();for(let e=0;e<n;e++)t[e]=this.get(this.wrap(this.begin+e));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}function Ad(e){return new Rd(e)}function Fd(e){return new Nd(e)}Ed.INITIAL_CAPACITY=32;class Od{async toArray(){const e=[];let t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){const e=this.prefetch(100),t=[];let n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)t=await this.next(),n=e(t.value)}handleErrors(e){return new zd(this,e)}filter(e){return new Pd(this,e)}map(e){return new $d(this,e)}mapAsync(e){return new jd(this,e)}serialMapAsync(e){return new jd(this,e).serial()}flatmap(e){return new Ud(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile((e=>!0===e))}rowMajorBatch(e,t=!0){return new Ld(this,e,t)}columnMajorBatch(e,t=!0,n=kd){return this.rowMajorBatch(e,t).map((e=>_d(e,n)))}concatenate(e,t){return new Wd(Ad([this,e]),t)}take(e){return e<0||null==e?this:new Bd(this,e)}skip(e){return e<0||null==e?this:new Id(this,e)}prefetch(e){return new Hd(this,e)}shuffle(e,t){return new qd(this,e,t)}serial(){return new Dd(this)}}class Rd extends Od{constructor(e){super(),this.items=e,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const e=this.items[this.trav];return this.trav++,{value:(t=e,function(e,t){return xd(e,t)}(t,Md)),done:!1};var t}}class Nd extends Od{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(e){throw e.message=`Error thrown while iterating through a dataset: ${e.message}`,e}}}class Dd extends Od{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){return this.upstream.next()}}class Id extends Od{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const e=await this.upstream.next();if(e.done)return e;O.dispose(e.value)}return this.upstream.next()}}class Bd extends Od{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class Ld extends Od{constructor(e,t,n=!0){super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){const e=[];for(;e.length<this.batchSize;){const t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}}class Pd extends Od{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;){const e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;O.dispose(e.value)}}}class $d extends Od{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Map`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const t=O.tensor_util.getTensorsInContainer(e.value),n=this.transform(e.value),r=O.tensor_util.getTensorsInContainer(n);for(const e of t)O.tensor_util.isTensorInList(e,r)||e.dispose();return{value:n,done:!1}}}class zd extends Od{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(e){if(!this.handler(e))return{value:null,done:!0}}}}class jd extends Od{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const t=O.tensor_util.getTensorsInContainer(e.value),n=await this.transform(e.value),r=O.tensor_util.getTensorsInContainer(n);for(const e of t)O.tensor_util.isTensorInList(e,r)||e.dispose();return{value:n,done:!1}}}class Gd extends Od{constructor(){super(),this.outputQueue=new Ed,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class Ud extends Gd{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){const e=await this.upstream.next();if(e.done)return!1;const t=O.tensor_util.getTensorsInContainer(e.value),n=this.transform(e.value),r=O.tensor_util.getTensorsInContainer(n);this.outputQueue.pushAll(n);for(const e of t)O.tensor_util.isTensorInList(e,r)||e.dispose();return!0}}class Wd extends Od{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,null==this.iterator){const e=await this.moreIterators.next();if(e.done)return{value:null,done:!0};this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}}!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(bd||(bd={}));class Vd extends Od{constructor(e,t=bd.FAIL){super(),this.iterators=e,this.mismatchMode=t,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(e){await e;let t=0,n=0;const r=await Sd(this.iterators,(function(e){return e instanceof Od?{value:e.next().then((e=>(t++,e.done&&n++,e.value))),recurse:!1}:{value:null,recurse:!0}}));if(t===n)return{value:null,done:!0};if(n>0)switch(this.mismatchMode){case bd.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case bd.SHORTEST:return{value:null,done:!0};case bd.LONGEST:}return this.count++,{value:r,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}}class Hd extends Od{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new Td(t)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}}class qd extends Hd{constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=vd.alea(n||O.util.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(!t.done)return this.refill(),t;this.upstreamExhausted=!0}return{value:null,done:!0}}}class Xd{constructor(){this.size=null}batch(e,t=!0){const n=this;let r;return O.util.assert(e>0,(()=>`batchSize needs to be positive, but it is\n      ${e}`)),r=this.size===1/0||null==this.size?this.size:t?Math.ceil(this.size/e):Math.floor(this.size/e),Yd((async()=>(await n.iterator()).columnMajorBatch(e,t,Zd)),r)}concatenate(e){const t=this;let n;return n=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,Yd((async()=>(await t.iterator()).concatenate(await e.iterator())),n)}filter(e){const t=this;let n;return n=this.size===1/0?1/0:null,Yd((async()=>(await t.iterator()).filter((t=>O.tidy((()=>e(t)))))),n)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){const t=this;return Yd((async()=>(await t.iterator()).map((t=>O.tidy((()=>e(t)))))),this.size)}mapAsync(e){const t=this;return Yd((async()=>(await t.iterator()).mapAsync(e)),this.size)}prefetch(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const t=this;return Yd((async()=>(await t.iterator()).prefetch(e)),this.size)}repeat(e){const t=this;let n;return n=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,Yd((async()=>{return n=Fd((async()=>({value:await t.iterator(),done:!1}))).take(e),new Wd(n,r);var n,r}),n)}skip(e){const t=this;let n;return n=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,Yd((async()=>(await t.iterator()).skip(e)),n)}shuffle(e,t,n=!0){if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const r=this,i=vd.alea(t||O.util.now().toString());return Yd((async()=>{let t=i.int32();return n&&(t+=i.int32()),(await r.iterator()).shuffle(e,t.toString())}),this.size)}take(e){const t=this;let n;return n=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,Yd((async()=>(await t.iterator()).take(e)),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function Yd(e,t=null){return new class extends Xd{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function Kd(e){return Yd((async()=>Ad(e)),e.length)}function Jd(e){if(!Cd(e))throw new Error("The argument to zip() must be an object or array.");let t;if(Array.isArray(e))for(let n=0;n<e.length;n++)t=null==t?e[n].size:Math.min(t,e[n].size);else if(e instanceof Object)for(const n in e)t=null==t?e[n].size:Math.min(t,e[n].size);return Yd((async()=>function(e,t=bd.FAIL){return new Vd(e,t)}(await Sd(e,(e=>{if(e instanceof Xd)return{value:e.iterator(),recurse:!1};if(Cd(e))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")})),bd.SHORTEST)),t)}function Zd(e){if(null===e)return null;return null==(t=e[0])||null===(n=t)||"object"!=typeof n&&"function"!=typeof n||Array.isArray(t)||"object"==typeof t&&t instanceof O.Tensor||O.util.isTypedArray(t)?{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof O.Tensor?O.stack(e):O.tensor(e)}(e),recurse:!1}:{value:null,recurse:!0};var t,n}Xd.MAX_BUFFER_SIZE=1e4;class Qd extends Xd{constructor(e){super(),this.input=e}async iterator(){return(await this.input.iterator()).decodeUTF8().split("\n").map((e=>(e.endsWith("\r")&&(e=e.slice(0,-1)),e)))}}const eh='"',th=Symbol("out"),nh=Symbol("field"),rh=Symbol("quote"),ih=Symbol("quoteafterquote"),oh=Symbol("quoteinquote");class ah extends Xd{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){const e=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&e&&O.util.assert(e.length===this.fullColumnNames.length,(()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+").")),this.fullColumnNames||(this.fullColumnNames=e);const t=this.fullColumnNames.reduce(((e,t)=>(e[t]=e[t]+1||1,e)),{}),n=Object.keys(t).filter((e=>t[e]>1));if(O.util.assert(0===n.length,(()=>"Duplicate column names found: "+n.toString())),this.columnConfigs)for(const e of Object.keys(this.columnConfigs))if(-1===this.fullColumnNames.indexOf(e))throw new Error('The key "'+e+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").");this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){const e=await this.base.iterator(),t=await e.next();if(t.done)throw new Error("No data was found for CSV parsing.");const n=t.value;return this.parseRow(n,!1)}return null}constructor(e,t){super(),this.input=e,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new Qd(e),t||(t={}),this.hasHeader=!1!==t.hasHeader,this.fullColumnNames=t.columnNames,this.columnConfigs=t.columnConfigs,this.configuredColumnsOnly=t.configuredColumnsOnly,t.delimWhitespace?(O.util.assert(null==t.delimiter,(()=>"Delimiter should not be provided when delimWhitespace is true.")),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=t.delimiter?t.delimiter:","}async iterator(){this.columnNamesValidated||await this.setColumnNames();let e=await this.base.iterator();return this.hasHeader&&(e=e.skip(1)),e.map((e=>this.makeDataElement(e)))}makeDataElement(e){const t=this.parseRow(e),n={},r={};for(let i=0;i<this.fullColumnNames.length;i++){const o=this.fullColumnNames[i],a=this.columnConfigs?this.columnConfigs[o]:null;if(!this.configuredColumnsOnly||a){const s=t[i];let u=null;if(""===s)if(a&&void 0!==a.default)u=a.default;else{if(a&&(a.required||a.isLabel))throw new Error(`Required column ${o} is empty in this line: ${e}`);u=void 0}else{const e=Number(s);if(isNaN(e))u=a&&"bool"===a.dtype?this.getBoolean(s):s;else if(a&&a.dtype)switch(a.dtype){case"float32":default:u=e;break;case"int32":u=Math.floor(e);break;case"bool":u=this.getBoolean(s)}else u=e}a&&a.isLabel?r[o]=u:n[o]=u}}return 0===Object.keys(r).length?n:{xs:n,ys:r}}getBoolean(e){return"1"===e||"true"===e.toLowerCase()?1:0}parseRow(e,t=!0){const n=[];let r=0;const i=e.length;let o=th;for(let t=0;t<i;t++)switch(o){case th:switch(e.charAt(t)){case eh:r=t+1,o=rh;break;case this.delimiter:if(r=t+1," "===this.delimiter&&this.delimWhitespace)break;n.push(""),o=th;break;default:o=nh,r=t}break;case nh:e.charAt(t)===this.delimiter&&(n.push(e.substring(r,t)),o=th,r=t+1);break;case rh:e.charAt(t)===eh&&(o=ih);break;case ih:switch(e.charAt(t)){case this.delimiter:n.push(e.substring(r,t-1)),o=th,r=t+1;break;case eh:o=rh;break;default:o=oh}break;case oh:e.charAt(t)===eh&&(o=rh)}if(o===ih?n.push(e.substring(r,i-1)):n.push(e.substring(r)),t&&n.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${n}`);return n}}class sh extends Od{constructor(e){super(),this.microphoneConfig=e,this.isClosed=!1,this.fftSize=e.fftSize||1024;const t=Math.log2(this.fftSize);if(this.fftSize<0||t<4||t>14||!Number.isInteger(t))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=e.numFramesPerSpectrogram||43,this.sampleRateHz=e.sampleRateHz,this.columnTruncateLength=e.columnTruncateLength||this.fftSize,this.audioTrackConstraints=e.audioTrackConstraints,this.smoothingTimeConstant=e.smoothingTimeConstant||0,this.includeSpectrogram=!1!==e.includeSpectrogram,this.includeWaveform=!0===e.includeWaveform,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(e={}){if(!(0,O.env)().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");const t=new sh(e);return await t.start(),t}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})}catch(e){throw new Error(`Error thrown while initializing video stream: ${e.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");const e=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new e,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`)}else this.sampleRateHz=this.audioContext.sampleRate;const t=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,t.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let e,t;const n=await this.getAudioData();if(this.includeSpectrogram){const t=this.flattenQueue(n.freqDataQueue);e=this.getTensorFromAudioDataArray(t,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){const e=this.flattenQueue(n.timeDataQueue);t=this.getTensorFromAudioDataArray(e,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:e,waveform:t},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){const e=[],t=[];let n=0;return new Promise((r=>{const i=setInterval((()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&r({freqDataQueue:e,timeDataQueue:t}),e.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),t.push(this.timeData.slice())),++n===this.numFrames&&(clearInterval(i),r({freqDataQueue:e,timeDataQueue:t}))}),this.fftSize/this.sampleRateHz*1e3)}))}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(e){const t=e[0].length,n=new Float32Array(e.length*t);return e.forEach(((e,r)=>n.set(e,r*t))),n}getTensorFromAudioDataArray(e,t){const n=new Float32Array(O.util.sizeFromShape(t));return n.set(e,n.length-e.length),(0,O.tensor)(n,t)}}class uh extends Od{constructor(e,t){if(super(),this.webcamVideoElement=e,this.webcamConfig=t,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=(0,O.tensor1d)([0],"int32"),this.webcamConfig.centerCrop){const e=1*this.webcamConfig.resizeWidth/this.webcamVideoElement.width,t=1*this.webcamConfig.resizeHeight/this.webcamVideoElement.height,n=(1-e)/2,r=(1-t)/2,i=n+e,o=t+r;this.cropBox=(0,O.tensor2d)([r,n,o,i],[1,4])}else this.cropBox=(0,O.tensor2d)([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(e,t={}){if(!(0,O.env)().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!e){if(e=document.createElement("video"),!t.resizeWidth||!t.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");e.width=t.resizeWidth,e.height=t.resizeHeight}const n=new uh(e,t);return await n.start(),n}async start(){this.webcamConfig.facingMode&&O.util.assert("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,(()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`));try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(e){throw e.message=`Error thrown while initializing video stream: ${e.message}`,e}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(e){console.log(e),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise((e=>{this.webcamVideoElement.onloadedmetadata=()=>{e()}}))}async next(){if(this.isClosed)return{value:null,done:!0};let e;try{e=O.browser.fromPixels(this.webcamVideoElement)}catch(e){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(e)}`)}if(!this.resize)return{value:e,done:!1};try{return{value:this.cropAndResizeFrame(e),done:!1}}catch(e){throw new Error(`Error thrown cropping the video: ${e.message}`)}finally{e.dispose()}}needToResize(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)}cropAndResizeFrame(e){return(0,O.tidy)((()=>{const t=(0,O.expandDims)((0,O.cast)(e,"float32"),0);let n;n=O.image.cropAndResize(t,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");const r=n.shape;return(0,O.reshape)(n,r.slice(1))}))}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach((e=>e.stop()));try{this.webcamVideoElement.srcObject=null}catch(e){console.log(e),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}class lh{}class ch extends Od{split(e){return new ph(this,e)}}class ph extends ch{constructor(e,t){super(),this.upstream=e,this.impl=new dh(e,t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class dh extends Gd{constructor(e,t){super(),this.upstream=e,this.separator=t,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){const e=await this.upstream.next();if(e.done)return""!==this.carryover&&(this.outputQueue.push(this.carryover),this.carryover="",!0);const t=e.value.split(this.separator);t[0]=this.carryover+t[0];for(const e of t.slice(0,-1))this.outputQueue.push(e);return this.carryover=t[t.length-1],!0}}class hh extends Od{decodeUTF8(){return new fh(this)}}class fh extends ch{constructor(e){super(),this.upstream=e,this.impl=new gh(e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class gh extends Gd{constructor(e){if(super(),this.upstream=e,(0,O.env)().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:e}=__webpack_require__(1601);this.decoder=new e("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}async pump(){const e=await this.upstream.next();let t,n;return!e.done&&(t=e.value,n=(0,O.env)().get("IS_BROWSER")?this.decoder.decode(t,{stream:!0}):this.decoder.write(Buffer.from(t.buffer)),this.outputQueue.push(n),!0)}}class mh extends hh{constructor(e,t={}){super(),this.file=e,this.options=t,O.util.assert(e instanceof Uint8Array||!!(0,O.env)().get("IS_BROWSER")&&(e instanceof File||e instanceof Blob),(()=>"FileChunkIterator only supports File, Blob and Uint8Array right now.")),this.offset=t.offset||0,this.chunkSize=t.chunkSize||1048576}summary(){return`FileChunks ${this.file}`}async next(){if(this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size))return{value:null,done:!0};const e=new Promise(((e,t)=>{const n=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)e(new Uint8Array(this.file.slice(this.offset,n)));else{const r=new FileReader;r.onload=n=>{let i=r.result;if(i instanceof ArrayBuffer&&(i=new Uint8Array(i)),!(i instanceof Uint8Array))return t(new TypeError("FileReader returned unknown type."));e(i)},r.onabort=e=>t(new Error("Aborted")),r.onerror=e=>t(new Error(e.type));const i=this.file.slice(this.offset,n);r.readAsArrayBuffer(i)}this.offset=n}));return{value:await e,done:!1}}}function yh(e){return"string"==typeof e&&"file://"===e.slice(0,7)}class bh extends lh{constructor(e,t={}){super(),this.input=e,this.options=t}async iterator(){if(yh(this.input)&&(0,O.env)().get("IS_NODE")){const e=__webpack_require__(7792);this.input=e.readFileSync(this.input.slice(7))}return new mh(this.input,this.options)}}class vh extends lh{constructor(e,t={}){super(),this.url=e,this.fileOptions=t}async iterator(){return yh(this.url)?new bh(this.url,this.fileOptions).iterator():async function(e,t={},n){let r,i;var o;"string"==typeof e?r=e:(r=e.url,i={method:(o=e).method,headers:o.headers,body:o.body,mode:o.mode,credentials:o.credentials,cache:o.cache,redirect:o.redirect,referrer:o.referrer,integrity:o.integrity});const a=await(n||O.util.fetch)(r,i);if(a.ok){const e=new Uint8Array(await a.arrayBuffer());return new mh(e,t)}throw new Error(a.statusText)}(this.url,this.fileOptions)}}function xh(e,t={}){return new ah(new vh(e),t)}function _h(e){const t=Fd(e);return Yd((async()=>t))}function wh(e){return Yd((async()=>{const t=await e();return Fd((()=>t.next()))}))}async function kh(e,t){return uh.create(e,t)}async function Sh(e){return sh.create(e)}const Ch="4.8.0";function Mh(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>{null!=e&&O.util.assert("complex64"!==e.dtype,(()=>`${t} does not support complex64 tensors in the CPU backend.`))}))}const Th=O.kernel_impls.whereImpl;class Eh extends O.KernelBackend{nextDataId(){return Eh.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new O.DataStorage(this,(0,O.engine)())}write(e,t,n){this.firstUse&&(this.firstUse=!1,(0,O.env)().get("IS_NODE")&&O.backend_util.warn("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&O.util.isString(n[0])){const i=n.map((e=>O.util.encodeString(e)));r=this.write(i,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){this.data.get(e).refCount++}decRef(e){this.data.has(e)&&this.data.get(e).refCount--}move(e,t,n,r,i){this.data.set(e,{values:t,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:n}=this.data.get(e);if("complex64"===t){const e=this.readSync(n.real.dataId),t=this.readSync(n.imag.dataId);return O.backend_util.mergeRealAndImagArrays(e,t)}return O.util.convertBackendValuesAndArrayBuffer(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map((e=>O.util.decodeString(e)));return(0,O.buffer)(e.shape,e.dtype,n)}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8")}return(0,O.buffer)(e.shape,e.dtype,t)}makeOutput(e,t,n){return(0,O.engine)().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(e);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=O.util.now();return e(),{kernelMs:O.util.now()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Mh([e],"where");const t=this.readSync(e.dataId);return Th(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}function Ah(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}Eh.nextDataId=0;const Fh={kernelName:O.Abs,backendName:"cpu",kernelFunc:e=>{const{x:t}=e.inputs,n=e.backend;Mh(t,"abs");let r=new Float32Array(O.util.sizeFromShape(t.shape));return r=Ah(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,t.dtype)}};function Oh(e){return(t,n,r,i,o)=>{const a=O.backend_util.assertAndGetBroadcastShape(t,n),s=a.length,u=O.util.computeStrides(a),l=O.util.sizeFromShape(a),c=O.util.getTypedArrayFromDType(o,l),p=t.length,d=n.length,h=O.util.computeStrides(t),f=O.util.computeStrides(n),g=O.backend_util.getBroadcastDims(t,a),m=O.backend_util.getBroadcastDims(n,a);if(g.length+m.length===0)for(let t=0;t<c.length;++t)c[t]=e(r[t%r.length],i[t%i.length]);else for(let t=0;t<c.length;++t){const n=O.util.indexToLoc(t,s,u),o=n.slice(-p);g.forEach((e=>o[e]=0));const a=O.util.locToIndex(o,p,h),l=n.slice(-d);m.forEach((e=>l[e]=0));const y=O.util.locToIndex(l,d,f);c[t]=e(r[a],i[y])}return[c,a]}}function Rh(e){const{inputs:t,backend:n}=e,{real:r,imag:i}=t,o=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",o),imag:n.makeTensorInfo(i.shape,"float32",a)},s}const Nh={kernelName:O.Complex,backendName:"cpu",kernelFunc:Rh};function Dh(e,t,n="float32"){if("complex64"===n)return Rh({inputs:{real:Dh(e,t,"float32"),imag:Dh(e,t,"float32")},backend:e});const r=O.util.makeZerosTypedArray(O.util.sizeFromShape(t),n);return e.makeTensorInfo(t,n,r)}function Ih(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Bh={kernelName:O.Identity,backendName:"cpu",kernelFunc:Ih};function Lh(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.real,o=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,o)}const Ph={kernelName:O.Real,backendName:"cpu",kernelFunc:Lh};function $h(e,t,n,r){if("int32"===r)return[t,"int32",Int32Array.from(e)];if("bool"===r){const r=O.util.toTypedArray([0],n),[i,o]=Oh(((e,t)=>e!==t?1:0))(t,[],e,r,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function zh(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:o}=r;if("complex64"===o){if("complex64"===i.dtype)return Ih({inputs:{x:i},backend:n});const e=Dh(n,i.shape,i.dtype),t=zh({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),r=Rh({inputs:{real:t,imag:e},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),r}if("complex64"===i.dtype){const e=Lh({inputs:{input:i},backend:n}),t=zh({inputs:{x:e},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(e),t}if(!O.util.hasEncodingLoss(i.dtype,o)){const e=Ih({inputs:{x:i},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:o}}const a=n.data.get(i.dataId).values,[s,u,l]=$h(a,i.shape,i.dtype,o);return n.makeTensorInfo(s,u,l)}const jh={kernelName:O.Cast,backendName:"cpu",kernelFunc:zh};function Gh(e,t,n,r){return null==n?({inputs:n,backend:i})=>{const{a:o,b:a}=n,s=i;Mh([o,a],e);const u=s.data.get(o.dataId).values,l=s.data.get(a.dataId).values,c="string"===o.dtype?O.backend_util.fromUint8ToStringArray(u):u,p="string"===o.dtype?O.backend_util.fromUint8ToStringArray(l):l,d=r||o.dtype,[h,f]=t(o.shape,a.shape,c,p,d);return s.makeTensorInfo(f,d,h)}:({inputs:e,backend:i})=>{const{a:o,b:a}=e,s=i;if("complex64"===o.dtype||"complex64"===a.dtype){const e=zh({inputs:{x:o},backend:s,attrs:{dtype:"complex64"}}),t=s.data.get(e.dataId),r=t.complexTensorInfos.real,i=t.complexTensorInfos.imag,u=s.data.get(r.dataId).values,l=s.data.get(i.dataId).values,c=zh({inputs:{x:a},backend:s,attrs:{dtype:"complex64"}}),p=s.data.get(c.dataId),d=p.complexTensorInfos.real,h=p.complexTensorInfos.imag,f=s.data.get(d.dataId).values,g=s.data.get(h.dataId).values,[m,y,b]=n(o.shape,a.shape,u,l,f,g),v=s.makeTensorInfo(b,"float32",m),x=s.makeTensorInfo(b,"float32",y),_=Rh({inputs:{real:v,imag:x},backend:s});return s.disposeIntermediateTensorInfo(e),s.disposeIntermediateTensorInfo(c),s.disposeIntermediateTensorInfo(v),s.disposeIntermediateTensorInfo(x),_}{const e=s.data.get(o.dataId).values,n=s.data.get(a.dataId).values,i=r||o.dtype,[u,l]=t(o.shape,a.shape,e,n,i);return s.makeTensorInfo(l,i,u)}}}function Uh(e){return(t,n,r,i,o,a)=>{const s=O.backend_util.assertAndGetBroadcastShape(t,n),u=O.util.sizeFromShape(s),l=s.length,c=O.util.computeStrides(s),p=O.util.getTypedArrayFromDType("float32",u),d=O.util.getTypedArrayFromDType("float32",u),h=O.backend_util.getBroadcastDims(t,s),f=O.backend_util.getBroadcastDims(n,s),g=O.backend_util.mergeRealAndImagArrays(r,i),m=O.backend_util.mergeRealAndImagArrays(o,a),y=t.length,b=O.util.computeStrides(t),v=n.length,x=O.util.computeStrides(n);if(h.length+f.length===0)for(let t=0;t<p.length;t++){const n=t%g.length,r=t%m.length,i=e(g[2*n],g[2*n+1],m[2*r],m[2*r+1]);p[t]=i.real,d[t]=i.imag}else for(let t=0;t<p.length;t++){const n=O.util.indexToLoc(t,l,c),r=n.slice(-y);h.forEach((e=>r[e]=0));const i=O.util.locToIndex(r,y,b),o=n.slice(-v);f.forEach((e=>o[e]=0));const a=O.util.locToIndex(o,v,x),s=e(g[2*i],g[2*i+1],m[2*a],m[2*a+1]);p[t]=s.real,d[t]=s.imag}return[p,d,s]}}const Wh=Oh(((e,t)=>e+t)),Vh=Uh(((e,t,n,r)=>({real:e+n,imag:t+r}))),Hh=Gh(O.Add,Wh,Vh),qh={kernelName:O.Add,backendName:"cpu",kernelFunc:Hh};function Xh(e,t,n,r,i){const o=O.util.sizeFromShape(r),a=O.util.makeZerosTypedArray(i,n);for(let n=0;n<e.length;n++){const r=e[n];if(r<0)throw new Error("Input x must be non-negative!");r>=i||(a[r]+=o>0?t[n]:1)}return a}function Yh(e,t,n,r=!1){const i=e.shape[0],o=e.shape[1],a=(0,O.buffer)([i,n],t.dtype);for(let s=0;s<i;s++)for(let i=0;i<o;i++){const o=e.get(s,i);if(o<0)throw new Error("Input x must be non-negative!");o>=n||(r?a.set(1,s,o):t.size>0?a.set(a.get(s,o)+t.get(s,i),s,o):a.set(a.get(s,o)+1,s,o))}return a}const Kh=Oh(((e,t)=>e&t)),Jh=Gh(O.BitwiseAnd,Kh),Zh={kernelName:O.BitwiseAnd,backendName:"cpu",kernelFunc:Jh};function Qh(e){return(t,n,r)=>{const i=O.util.getArrayFromDType(n,t.length);for(let n=0;n<t.length;++n)i[n]=e(t[n],r);return i}}function ef(e,t,n){return tf(e,Qh(t),n)}function tf(e,t,n){return({inputs:r,attrs:i,backend:o})=>{const{x:a}=r;Mh(a,e);const s=o,u=s.data.get(a.dataId).values;let l;if("string"===a.dtype){if(!Array.isArray(u))throw new Error("String tensor's value was not an instance of Array");l=O.backend_util.fromUint8ToStringArray(u)}else l=u;const c=n||a.dtype,p=t(l,c,i);return s.makeTensorInfo(a.shape,c,p)}}const nf=Qh((e=>Math.ceil(e))),rf=tf(O.Ceil,nf),of={kernelName:O.Ceil,backendName:"cpu",kernelFunc:rf};function af(e,t,n,r){const i=O.util.getArrayFromDType(n,O.util.sizeFromShape(t));if(r&&"string"!==n){let t=0;e.forEach((e=>{const n=O.util.sizeFromShape(e.shape);i.set(e.vals,t),t+=n}))}else{let r=0;e.forEach((e=>{const o="string"===n?O.backend_util.fromUint8ToStringArray(e.vals):e.vals;let a=0;for(let n=0;n<e.shape[0];++n){const s=n*t[1]+r;for(let t=0;t<e.shape[1];++t)i[s+t]=o[a++]}r+=e.shape[1]}))}return i}const sf=Oh(((e,t)=>e===t?1:0)),uf=Gh(O.Equal,sf,null,"bool"),lf={kernelName:O.Equal,backendName:"cpu",kernelFunc:uf},cf=Qh((e=>Math.exp(e))),pf=tf(O.Exp,cf,"float32"),df={kernelName:O.Exp,backendName:"cpu",kernelFunc:pf},hf=Qh((e=>Math.expm1(e))),ff=tf(O.Expm1,hf),gf={kernelName:O.Expm1,backendName:"cpu",kernelFunc:ff},mf=Qh((e=>Math.floor(e))),yf=tf(O.Floor,mf),bf={kernelName:O.Floor,backendName:"cpu",kernelFunc:yf},vf=Oh(((e,t)=>Math.floor(e/t))),xf=Gh(O.FloorDiv,vf,null,"int32"),_f={kernelName:O.FloorDiv,backendName:"cpu",kernelFunc:xf};function wf(e,t,n,r,i,o,a,s,u){const l=(0,O.buffer)([r,o],n);for(let n=0;n<r;n++){const r=[];let c=0;for(let t=0;t<i;t++){const o=e[n*i+t];c+=o*a[t],r.push(o)}if(c<0||c>=u/o)throw new Error(`Invalid indices: ${r} does not index into ${s}`);for(let e=0;e<o;e++)l.values[n*o+e]=t.get(...t.indexToLoc(c*o+e))}return l}function kf(e,t,n){const r=(0,O.buffer)(n,e.dtype);for(let n=0;n<r.size;++n){const i=r.indexToLoc(n).slice(),o=i[0],a=i[2],s=t.locToIndex([o,a]);i[2]=t.values[s];const u=e.locToIndex(i);0<=u&&u<e.values.length&&(r.values[n]=e.values[u])}return r}const Sf=Oh(((e,t)=>e>t?1:0)),Cf=Gh(O.Greater,Sf,null,"bool"),Mf={kernelName:O.Greater,backendName:"cpu",kernelFunc:Cf},Tf=Oh(((e,t)=>e>=t?1:0)),Ef=Gh(O.GreaterEqual,Tf,null,"bool"),Af={kernelName:O.GreaterEqual,backendName:"cpu",kernelFunc:Ef},Ff=Oh(((e,t)=>e<t?1:0)),Of=Gh(O.Less,Ff,null,"bool"),Rf={kernelName:O.Less,backendName:"cpu",kernelFunc:Of},Nf=Oh(((e,t)=>e<=t?1:0)),Df=Gh(O.LessEqual,Nf,null,"bool"),If={kernelName:O.LessEqual,backendName:"cpu",kernelFunc:Df};function Bf(e,t,n){const r=(t-e)/(n-1),i=O.util.makeZerosTypedArray(n,"float32");i[0]=e;for(let e=1;e<i.length;e++)i[e]=i[e-1]+r;return i}const Lf=Qh((e=>Math.log(e))),Pf=tf(O.Log,Lf),$f={kernelName:O.Log,backendName:"cpu",kernelFunc:Pf};function zf(e,t,n,r){const i=O.util.getTypedArrayFromDType(r,O.util.sizeFromShape(n));for(let n=0;n<i.length;++n){const r=n*t;let o=e[r];for(let n=0;n<t;++n){const t=e[r+n];(Number.isNaN(t)||t>o)&&(o=t)}i[n]=o}return i}const jf=Oh(((e,t)=>Math.max(e,t))),Gf=Gh(O.Maximum,jf),Uf={kernelName:O.Maximum,backendName:"cpu",kernelFunc:Gf},Wf=Oh(((e,t)=>Math.min(e,t))),Vf=Gh(O.Minimum,Wf),Hf={kernelName:O.Minimum,backendName:"cpu",kernelFunc:Vf},qf=Oh(((e,t)=>e*t)),Xf=Uh(((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n}))),Yf=Gh(O.Multiply,qf,Xf),Kf={kernelName:O.Multiply,backendName:"cpu",kernelFunc:Yf};function Jf(e,t,n){const r=O.util.createScalarValue(-1,n);return qf([],t,r,e,n)}const Zf={kernelName:O.Neg,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;Mh(r,"neg");const i=n.data.get(r.dataId).values,[o,a]=Jf(i,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,o)}},Qf=Oh(((e,t)=>e!==t?1:0)),eg=Gh(O.NotEqual,Qf,null,"bool"),tg={kernelName:O.NotEqual,backendName:"cpu",kernelFunc:eg};function ng(e,t,n,r,i){const o=t.length,a=O.util.sizeFromShape(t),s=O.util.computeStrides(t),u=O.util.computeStrides(i),l=O.util.getTypedArrayFromDType(n,O.util.sizeFromShape(i));for(let t=0;t<a;++t){const n=O.util.indexToLoc(t,o,s),i=new Array(n.length);for(let e=0;e<i.length;e++)i[e]=n[r[e]];l[O.util.locToIndex(i,o,u)]=e[t]}return l}function rg(e){const{inputs:t,attrs:n,backend:r}=e,{x:i}=t,{perm:o}=n;Mh(i,"transpose");const a=i.shape.length,s=new Array(a);for(let e=0;e<s.length;e++)s[e]=i.shape[o[e]];const u=ng(r.data.get(i.dataId).values,i.shape,i.dtype,o,s);return{dataId:r.write(u,s,i.dtype),shape:s,dtype:i.dtype}}const ig={kernelName:O.Transpose,backendName:"cpu",kernelFunc:rg};function og(e,t,n,r){const[i,o]=O.backend_util.computeOutAndReduceShapes(e,r),a=(0,O.upcastType)(t,"int32"),s=O.util.makeZerosTypedArray(O.util.sizeFromShape(i),a),u=O.util.sizeFromShape(o);for(let e=0;e<s.length;++e){const t=e*u;let r=1;for(let e=0;e<u;++e)r*=n[t+e];s[e]=r}return{outVals:s,outShape:i,outDtype:a}}const ag={kernelName:O.Prod,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:a}=r;Mh(i,"prod");const s=i.shape.length,u=O.util.parseAxisParam(o,i.shape),l=O.backend_util.getAxesPermutation(u,s);let c=u,p=i;const d=[];null!=l&&(p=rg({inputs:{x:i},backend:n,attrs:{perm:l}}),d.push(p),c=O.backend_util.getInnerMostAxes(c.length,s));const h=n.data.get(p.dataId).values,{outVals:f,outShape:g,outDtype:m}=og(p.shape,p.dtype,h,c);let y=g;return a&&(y=O.backend_util.expandShapeToKeepDim(g,u)),d.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(y,m,f)}};function sg(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function ug(e,t,n,r,i,o,a,s){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach(((e,r)=>{if(e<0||e>=n){const i=O.util.indexToLoc(r,t.length,O.util.computeStrides(t)).join(",");throw new Error(`indices[${i}] = ${e} is not in [0, ${n})`)}}))}(o,a,t[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:l,valueSlices:c,numValues:p}=function(e,t,n,r){const i=[];let o=0;const a=t.length-1+n.length,s=new Array(a).fill(null).map((()=>[0]));!function(e,t){for(let n=0;n<e.length;++n){const r=e[n],i=n===e.length-1?t:e[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let e=1;e<r.length;++e)if(r[e-1]>r[e])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);let u=1;for(let e=0;e<t.length-1;++e){u*=t[e];const n=t[e+1];for(let t=1;t<u+1;++t)s[e].push(t*n)}for(let r=0;r<e.length;++r){let a=e[r],u=e[r]+1;for(let e=0;e<n.length;++e){const r=n[e],i=e+t.length-1;if(i>=0){const e=s[i],t=e[e.length-1]-r[a];for(let e=a;e<u;++e)s[i].push(r[e+1]+t)}a=r[a],u=r[u]}u!==a&&(i.push([a,u]),o+=u-a)}return{outSplits:s,valueSlices:i,numValues:o}}(o,a,e,u),d=function(e){const t=[];for(let n=0;n<e.length;++n){const r=e[n].length,i=O.util.getArrayFromDType("int32",r);t.push(i),e[n].forEach(((e,t)=>i[t]=e))}return t}(l),h=function(e,t,n,r,i){const o=t.slice();o[0]=i;const a=O.util.getArrayFromDType(n,O.util.sizeFromShape(o)),s=e.length;return function(e,t,n,r,i,o){const a=sg(t,2)[1],s=sg(o,2)[1];let u=0;for(const t of n)for(let n=t[0];n<t[1];++n){for(let t=0;t<r;++t)i[u*s+t]=e[n*a+t];++u}}(e,t,r,0===s?0:s/t[0],a,o),[a,o]}(n,r,i,c,p);return[d,h[0],h[1]]}const lg=2147483647;function cg(e,t,n,r,i,o,a){if(t.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(a.length>1)throw new Error("deltas must be a scalar or vector");const s=0===t.length,u=0===i.length,l=0===a.length,c=[];s||c.push(t[0]),u||c.push(i[0]),l||c.push(a[0]);for(let e=1;e<c.length;++e)if(c[e]!==c[e-1])throw new Error("starts, limits, and deltas must have the same shape");const p=0===c.length?1:c[0],d=O.util.getArrayFromDType("int32",p+1);d[0]=0;for(let t=0;t<p;++t){const n=s?e[0]:e[t],i=u?r[0]:r[t],a=l?o[0]:o[t];if(0===a)throw new Error("Requires delta != 0");let c;if(a>0&&i<n||a<0&&i>n)c=0;else if(c=Math.ceil(Math.abs((i-n)/a)),c>lg)throw new Error(`Requires ((limit - start) / delta) <= ${lg}`);d[t+1]=d[t]+c}const h=d[p],f=O.util.getArrayFromDType(n,h);let g=0;for(let t=0;t<p;++t){const n=d[t+1]-d[t];let r=s?e[0]:e[t];const i=l?o[0]:o[t];for(let e=0;e<n;++e)f[g++]=r,r+=i}return[d,f]}var pg=O.backend_util.RowPartitionType;class dg{constructor(e,t,n,r,i,o,a,s,u,l){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=r,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=s,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=O.backend_util.getRowPartitionTypesHelper(l),this.raggedRank=O.backend_util.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===pg.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===pg.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case pg.VALUE_ROWIDS:return dg.getMaxWidthValueRowID(t);case pg.ROW_SPLITS:return dg.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${pg[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(0===t||1===t)return 0;let n=0;for(let r=0;r<t-1;++r){const t=e[r+1]-e[r];t>n&&(n=t)}return n}static getMaxWidthValueRowID(e){const t=e.length;if(0===t)return 0;let n=0,r=e[0],i=0;for(let o=1;o<t;++o){const t=e[o];t!==r&&(r=t,i=Math.max(o-n,i),n=o)}return Math.max(t-n,i)}tensorShapeFromTensor(e,t,n=!0){if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return fg(e,n)}calculateOutputSize(e){const t=this.valuesShape,n=this.defaultValueShape;O.backend_util.validateDefaultValueShape(n,t);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=O.backend_util.combineRaggedTensorToTensorShapes(this.raggedRank,r,t);i[0]<0&&(i[0]=e);for(let e=1;e<=this.raggedRank;++e)i[e]<0&&(i[e]=this.getMaxWidth(e));return i}calculateFirstParentOutputIndex(e,t,n){const r=Math.min(e,n),i=[];let o=0;for(let e=0;e<r;++e,o+=t)i.push(o);for(let t=r;t<e;++t)i.push(-1);return O.util.assert(i.length===e,(()=>"Final length of result must be equal to firstDimension.")),i}calculateOutputIndexRowSplit(e,t,n,r){const i=e.length,o=[];for(let a=0;a<i-1;++a){const i=e[a+1]-e[a];let s=Math.min(r,i),u=t[a];-1===u&&(s=0);for(let e=0;e<s;++e)o.push(u),u+=n;for(let e=0;e<i-s;++e)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,t,n,r){const i=e.length,o=[];if(0===i)return[];let a=0,s=e[0];if(s>=t.length)throw new Error(`Got currentValueRowId=${s}, which is not less than ${t.length}`);let u=t[s];o.push(u);for(let l=1;l<i;++l){const i=e[l];if(i===s)u>=0&&(++a,a<r?u+=n:u=-1);else{if(a=0,s=i,i>=t.length)throw new Error(`Got nextValueRowId=${i} which is not less than ${t.length}`);u=t[i]}o.push(u)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,t,n,r){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case pg.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,t,n,r);case pg.ROW_SPLITS:if(i.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(i,t,n,r);default:throw new Error(`Unsupported partition type: ${pg[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case pg.FIRST_DIM_SIZE:return e[0];case pg.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case pg.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${pg[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let e=n.length-2;e>=0;--e)n[e]=n[e+1]*t[e+1];const r=fg(t,!1),i=O.util.getArrayFromDType(this.valuesDType,O.util.sizeFromShape(r));if(n[0]*t[0]>0){let o=this.calculateFirstParentOutputIndex(e,n[0],t[0]);for(let e=1;e<=this.raggedRank;++e)o=this.calculateOutputIndex(e-1,o,n[e],t[e]);this.setOutput(this.raggedRank,o,i,r)}return[r,i]}setOutput(e,t,n,r){if(0===n.length)return;const i=this.values,o=n;let a=r.slice();a=a.slice(e+1);const s=O.util.sizeFromShape(a),u=t.length;let l=this.defaultValue;if(l.length!==s&&1!==l.length){const e=this.defaultValueShape;(0,O.tidy)((()=>{const t=(0,O.reshape)(l,e),n=(0,O.broadcastTo)(t,a);l=n.dataSync()}))}let c=0,p=0,d=0;for(let e=0;e<=u;++e){let r=e<u?t[e]:-1;if(r!==d){if(p<d){const e=i.subarray(c*s);hg(o.subarray(p*s),e,(d-p)*s)}if(e>=u){const e=n.length;r=Math.floor(e/s)}if(r>d)if(1===this.defaultValue.length)o.subarray(d*s,r*s).fill(this.defaultValue[0]),d=r;else for(;r>d;)hg(o.slice(d*s),l,s),++d;r<0?(c=e+1,p=d):(c=e,p=d,d=p+1)}else++d}}}function hg(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function fg(e,t){const n=[];for(let r of e){if(r<0){if(!t)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function gg(e,t,n,r,i,o,a,s,u,l){return new dg(e,t,n,r,i,o,a,s,u,l).compute()}function mg(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return O.util.makeZerosTypedArray(0,r);const i=Math.abs(Math.ceil((t-e)/n)),o=O.util.makeZerosTypedArray(i,r);t<e&&1===n&&(n=-1),o[0]=e;for(let e=1;e<o.length;e++)o[e]=o[e-1]+n;return o}const yg=Qh((e=>1/Math.sqrt(e))),bg=tf(O.Rsqrt,yg),vg={kernelName:O.Rsqrt,backendName:"cpu",kernelFunc:bg};function xg(e,t,n,r,i,o,a,s,u,l){const c=[r/i,i],p=e.values,d=t.values;if(0===r)return(0,O.buffer)(n,t.dtype);const h=u instanceof O.TensorBuffer?u:(0,O.buffer)(c,t.dtype);"string"==typeof u||"number"==typeof u?h.values.fill(u):"boolean"==typeof u&&h.values.fill(+u);for(let e=0;e<o;e++){const o=[];let u=0;for(let t=0;t<a;t++){const n=p[e*a+t];o.push(n),u+=n*s[t]}if(u<0||u>=r/i)throw new Error(`Invalid indices: ${o} does not index into ${n}`);for(let n=0;n<i;n++)l?h.values[u*i+n]+=d[e*i+n]:h.values[u*i+n]=0===t.rank?d[0]:d[e*i+n]}return h}const _g=Qh((e=>1/(1+Math.exp(-e)))),wg=ef(O.Sigmoid,(e=>1/(1+Math.exp(-e)))),kg={kernelName:O.Sigmoid,backendName:"cpu",kernelFunc:wg};function Sg(e,t,n,r,i){const o=O.slice_util.isSliceContinous(r,t,n),a=O.util.sizeFromShape(n),s=O.util.computeStrides(r);if(o){const n=O.slice_util.computeFlatOffset(t,s);return"string"===i?e.slice(n,n+a):e.subarray(n,n+a)}const u="string"===i?O.backend_util.fromUint8ToStringArray(e):e,l=(0,O.buffer)(r,i,u),c=(0,O.buffer)(n,i);for(let e=0;e<c.size;++e){const n=c.indexToLoc(e),r=n.map(((e,n)=>e+t[n]));c.set(l.get(...r),...n)}return"string"===i?O.backend_util.fromStringArrayToUint8(c.values):c.values}function Cg(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:o,size:a}=r;Mh(i,"slice");const[s,u]=O.slice_util.parseSliceParams(i,o,a);O.slice_util.assertParamsValid(i,s,u);const l=Sg(n.data.get(i.dataId).values,s,u,i.shape,i.dtype);return n.makeTensorInfo(u,i.dtype,l)}const Mg={kernelName:O.Slice,backendName:"cpu",kernelFunc:Cg};function Tg(e,t,n,r,i,o,a){const s=t[0],u=o[0],l=new Array(u),c=new Array(s),p=t[1];if(0===u){if(0!==s)throw new Error(O.backend_util.getSparseFillEmptyRowsIndicesDenseShapeMismatch(s));return[O.util.getArrayFromDType(n,0),[0,p],O.util.getArrayFromDType(i,0),l,c]}let d=!0,h=0;const f=new Array(u).fill(0);for(let t=0;t<s;++t){const n=e[t*p];if(n<0)throw new Error(O.backend_util.getSparseFillEmptyRowsNegativeIndexErrorMessage(t,n));if(n>=u)throw new Error(O.backend_util.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(t,n,u));++f[n],d=d&&n>=h,h=n}let g=!0;for(let e=0;e<u;++e){const t=0===f[e];l[e]=t,g=g&&!t,f[e]=Math.max(f[e],1),e>0&&(f[e]+=f[e-1])}if(g&&d){const t=e,n=r;for(let e=0;e<s;++e)c[e]=e;return[t,[s,p],n,l,c]}{const t=f[u-1],o=O.util.getArrayFromDType(n,t*p),d=O.util.getArrayFromDType(i,t),h=new Array(u).fill(0);for(let t=0;t<s;++t){const n=e[t*p],i=h[n],a=(0===n?0:f[n-1])+i;h[n]++;for(let n=0;n<p;++n)o[a*p+n]=e[t*p+n];d[a]=r[t],c[t]=a}for(let e=0;e<u;++e)if(0===h[e]){const t=0===e?0:f[e-1];o[t*p+0]=e;for(let e=1;e<p;++e)o[t*p+e]=0;d[t]=a}return[o,[t,p],d,l,c]}}function Eg(e,t,n,r,i){const o=O.util.sizeFromShape(r),a=t[0],s=i.length,u=[];let l=1,c=-1;for(let e=0;e<s;++e){const t=i[e];if(-1===t){if(-1!==c)throw new Error(O.backend_util.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(c,e));c=e,u.push(1)}else{if(t<0)throw new Error(O.backend_util.getSparseReshapeNegativeOutputDimErrorMessage(e,t));l*=t,u.push(t)}}if(-1!==c){if(l<=0)throw new Error(O.backend_util.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());const e=Math.trunc(o/l);if(l*e!==o)throw new Error(O.backend_util.getSparseReshapeInputOutputMultipleErrorMessage(r,u));u[c]=e}if(O.util.sizeFromShape(u)!==o)throw new Error(O.backend_util.getSparseReshapeInputOutputMismatchErrorMessage(r,u));const p=r.length,d=[];if(p>0){d[p-1]=1;for(let e=p-2;e>=0;--e)d[e]=d[e+1]*r[e+1]}const h=[];if(s>0){h[s-1]=1;for(let e=s-2;e>=0;--e)h[e]=h[e+1]*u[e+1]}const f=O.util.getArrayFromDType(n,a*s);for(let t=0;t<a;++t){let n=0;for(let r=0;r<p;++r)n+=e[t*p+r]*d[r];for(let e=0;e<s;++e)f[t*s+e]=Math.trunc(n/h[e]),n%=h[e]}return[f,[a,s],u]}function Ag(e,t,n,r,i,o=!1,a=0){const s=r.length,u=[t[0],e.length/t[0]],l=u[1],c=s>0?i[s-1]+1:0;if(c<0)throw new Error(O.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());const p=t.slice();p[0]=c;const d=p.reduce(((e,t)=>e*t),1),h=O.util.getArrayFromDType(n,d);if(0===s)return c>0&&h.fill(a),[h,p];if(c<=0)throw new Error(O.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let f=0,g=1,m=0,y=i[f];for(;;){let t=0;if(g<s){if(t=i[g],y===t){++g;continue}if(y>=t)throw new Error(O.backend_util.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(y<0||y>=c)throw new Error(O.backend_util.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(y,c));y>m&&h.fill(a,m*l,y*l);for(let t=f;t<g;++t){const n=r[t];if(n<0||n>=u[0])throw new Error(O.backend_util.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(t,r[t],u[0]));for(let t=0;t<l;t++)h[y*l+t]+=e[n*l+t]}if(o)for(let e=0;e<l;e++)h[y*l+e]/=g-f;if(f=g,++g,m=y+1,y=t,g>s)break}return m<c&&h.fill(a,m*l,c*l),[h,p]}const Fg=Qh((e=>Math.sqrt(e))),Og=ef(O.Sqrt,(e=>Math.sqrt(e))),Rg={kernelName:O.Sqrt,backendName:"cpu",kernelFunc:Og},Ng=Oh(((e,t)=>{const n=e-t;return n*n})),Dg=Gh(O.SquaredDifference,Ng),Ig={kernelName:O.SquaredDifference,backendName:"cpu",kernelFunc:Dg},Bg=Qh(((e,t)=>{const{pattern:n,replaceGlobal:r,rewrite:i}=t;return e.replace(new RegExp(n,r?"g":""),i)})),Lg=tf(O.StaticRegexReplace,Bg),Pg={kernelName:O.StaticRegexReplace,backendName:"cpu",kernelFunc:Lg};function $g(e,t,n,r){const i=(0,O.buffer)(e,t.dtype);for(let e=0;e<i.size;e++){const o=i.indexToLoc(e),a=new Array(o.length);for(let e=0;e<a.length;e++)a[e]=o[e]*n[e]+r[e];i.set(t.get(...a),...o)}return i}class zg{constructor(e,t,n,r,i,o){this.separator=O.util.encodeString(e),this.nGramWidths=t,this.leftPad=O.util.encodeString(n),this.rightPad=O.util.encodeString(r),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,r,i,o){for(let a=0;a<i;++a){const s=this.getPadWidth(o),u=Math.max(0,s-a),l=Math.max(0,s-(i-(a+1))),c=o-(u+l),p=t+(u>0?0:a-s);let d=0;d+=u*this.leftPad.length;for(let t=0;t<c;++t)d+=e[p+t].length;d+=l*this.rightPad.length,d+=(u+l+c-1)*this.separator.length,n[r+a]=new Uint8Array(d);const h=n[r+a];let f=0;const g=e=>e.forEach((e=>h[f++]=e));for(let e=0;e<u;++e)g(this.leftPad),g(this.separator);for(let t=0;t<c-1;++t)g(e[p+t]),g(this.separator);if(c>0){g(e[p+c-1]);for(let e=0;e<l;++e)g(this.separator),g(this.rightPad)}else{for(let e=0;e<l-1;++e)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,t){const n=e.length,r=t.length;if(r>0){let e=t[0];if(0!==e)throw new Error(`First split value must be 0, got ${e}`);for(let i=1;i<r;++i){let r=t[i]>=e;if(r=r&&t[i]<=n,!r)throw new Error(`Invalid split value ${t[i]}, must be in [${e}, ${n}]`);e=t[i]}if(e!==n)throw new Error(`Last split value must be data size. Expected ${n}, got ${e}`)}const i=r-1,o=O.util.getArrayFromDType("int32",r);if(0===n||0===r){const e=new Array(n);for(let e=0;e<=i;++e)o[e]=0;return[e,o]}o[0]=0;for(let e=1;e<=i;++e){const n=t[e]-t[e-1];let r=0;this.nGramWidths.forEach((e=>{r+=this.getNumNGrams(n,e)})),this.preserveShort&&n>0&&0===r&&(r=1),o[e]=o[e-1]+r}const a=new Array(o[i]);for(let n=0;n<i;++n){const r=t[n];let i=o[n];if(this.nGramWidths.forEach((o=>{const s=t[n+1]-t[n],u=this.getNumNGrams(s,o);this.createNGrams(e,r,a,i,u,o),i+=u})),this.preserveShort&&i===o[n]){const o=t[n+1]-t[n];if(0===o)continue;const s=o+2*this.padWidth,u=1;this.createNGrams(e,r,a,i,u,s)}}return[a,o]}}function jg(e,t,n,r,i,o,a,s){return new zg(n,r,i,o,a,s).compute(e,t)}function Gg(e,t,n,r){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)r.push(e.subarray(t,t+1));return}if(1===t.length){const i=t[0];let o=e.indexOf(i);for(;-1!==o;){const t=e.subarray(0,o);n&&0===t.length||r.push(t),o=(e=e.subarray(o+1)).indexOf(i)}return void(n&&0===e.length||r.push(e))}let i=0;for(let o=0;o<e.length+1;o++)if(o===e.length||-1!==t.indexOf(e[o])){const t=e.subarray(i,o);n&&0===t.length||r.push(t),i=o+1}}function Ug(e,t,n){const r=e.length,i=[];let o=0,a=0;const s=new Array(r);for(let u=0;u<r;++u){const r=i.length;Gg(e[u],t,n,i);const l=i.length-r;s[u]=l,o+=l,a=Math.max(a,l)}const u=O.util.getArrayFromDType("int32",2*o),l=new Array(o),c=[r,a];let p=0;for(let e=0;e<r;++e)for(let t=0;t<s[e];++t)u[2*p]=e,u[2*p+1]=t,l[p]=i[p],++p;return[u,l,c]}function Wg(e,t){const n=O.util.getArrayFromDType("int32",e.length);for(let r=0;r<e.length;++r)n[r]=O.util.fingerPrint64(e[r]).modulo(t).getLowBitsUnsigned();return n}const Vg=Oh(((e,t)=>e-t)),Hg=Uh(((e,t,n,r)=>({real:e-n,imag:t-r}))),qg=Gh(O.Sub,Vg,Hg),Xg={kernelName:O.Sub,backendName:"cpu",kernelFunc:qg};function Yg(e,t){const n=new Array(e.rank);for(let r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];const r=(0,O.buffer)(n,e.dtype);for(let t=0;t<r.values.length;++t){const n=r.indexToLoc(t),i=new Array(e.rank);for(let t=0;t<i.length;t++)i[t]=n[t]%e.shape[t];const o=e.locToIndex(i);r.values[t]=e.values[o]}return r}const Kg=(e,t)=>{const n=t.value-e.value;return 0===n?e.index-t.index:n};function Jg(e,t,n=0,r=e.length-1){for(;r>n;){if(r-n>600){const i=r-n+1,o=t-n+1,a=Math.log(i),s=.5*Math.exp(2*a/3),u=.5*Math.sqrt(a*s*(i-s)/i)*Math.sign(o-i/2);Jg(e,t,Math.max(n,Math.floor(t-o*s/i+u)),Math.min(r,Math.floor(t+(i-o)*s/i+u)))}const i=e[t];let o=n,a=r;for(O.util.swap(e,n,t),Kg(e[r],i)>0&&O.util.swap(e,n,r);o<a;){for(O.util.swap(e,o,a),o++,a--;Kg(e[o],i)<0;)o+=1;for(;Kg(e[a],i)>0;)a-=1}0===Kg(e[n],i)?O.util.swap(e,n,a):(a+=1,O.util.swap(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}}function Zg(e,t,n,r,i){const o=t[t.length-1],[a,s]=[e.length/o,o],u=O.util.getTypedArrayFromDType(n,a*r),l=O.util.getTypedArrayFromDType("int32",a*r);for(let t=0;t<a;t++){const n=t*s,o=e.subarray(n,n+s);let a=new Array(o.length);o.forEach(((e,t)=>a[t]={value:e,index:t})),r<a.length&&(Jg(a,r),a=a.slice(0,r)),i&&a.sort(Kg);const c=t*r,p=u.subarray(c,c+r),d=l.subarray(c,c+r);for(let e=0;e<r;e++)p[e]=a[e].value,d[e]=a[e].index}const c=t.slice();return c[c.length-1]=r,[(0,O.buffer)(c,n,u),(0,O.buffer)(c,"int32",l)]}function Qg(e,t,n,r){const i=O.util.parseAxisParam(t,n)[0],o=[1,n[0],1];for(let e=0;e<i;e++)o[0]*=n[e];o[1]=n[i];for(let e=i+1;e<n.length;e++)o[2]*=n[e];const a=new Map,s=new Int32Array(n[i]),u=new O.TensorBuffer(o,r,e),l=[],c=1===o[0]&&1===o[2];for(let t=0;t<n[i];t++){let n;if(c)n=e[t].toString();else{const e=[];for(let n=0;n<o[0];n++)for(let r=0;r<o[2];r++)e.push(u.get(n,t,r));n=e.join(",")}const r=a.get(n);if(null!=r)s[t]=r;else{const e=a.size;a.set(n,e),s[t]=e,l.push(t)}}const p=o.slice();p[1]=a.size;const d=new O.TensorBuffer(p,r);l.forEach(((e,t)=>{for(let n=0;n<o[0];n++)for(let r=0;r<o[2];r++)d.set(u.get(n,e,r),n,t,r)}));const h=n.slice();return h[i]=p[1],{outputValues:d.values,outputShape:h,indices:s}}const em="4.8.0";(0,O.registerBackend)("cpu",(()=>new Eh),1);const tm=ef(O.Elu,(e=>e>=0?e:Math.exp(e)-1)),nm={kernelName:O.Elu,backendName:"cpu",kernelFunc:tm};function rm(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:o}=r;Mh([i],"leakyRelu");const a=O.util.sizeFromShape(i.shape),s=n.data.get(i.dataId).values,u=O.util.getTypedArrayFromDType("float32",a);for(let e=0;e<s.length;e++)u[e]=s[e]<0?o*s[e]:s[e];return n.makeTensorInfo(i.shape,"float32",u)}const im={kernelName:O.LeakyRelu,backendName:"cpu",kernelFunc:rm},om=Oh(((e,t)=>e<0?t*e:e));function am(e){const{inputs:t,backend:n}=e,{x:r,alpha:i}=t;Mh([r,i],"prelu");const o=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,[s,u]=om(r.shape,i.shape,o,a,"float32");return n.makeTensorInfo(u,"float32",s)}const sm={kernelName:O.Prelu,backendName:"cpu",kernelFunc:am},um=ef(O.Relu,(e=>Math.max(0,e))),lm={kernelName:O.Relu,backendName:"cpu",kernelFunc:um},cm=ef(O.Relu6,(e=>Math.min(Math.max(0,e),6))),pm={kernelName:O.Relu6,backendName:"cpu",kernelFunc:cm};function dm(e,t,n,r,i){if("linear"===n)return Ih({inputs:{x:t},backend:e});if("relu"===n)return um({inputs:{x:t},backend:e});if("elu"===n)return tm({inputs:{x:t},backend:e});if("relu6"===n)return cm({inputs:{x:t},backend:e});if("prelu"===n)return am({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return rm({inputs:{x:t},backend:e,attrs:{alpha:i}});if("sigmoid"===n)return wg({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}function hm(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:o}=r,a=O.util.sizeFromShape(i.shape),s=O.util.inferFromImplicitShape(o,a),u=O.util.sizeFromShape(s);O.util.assert(a===u,(()=>`The new shape (${s}) has ${u} elements and the old shape (${i.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`)),n.incRef(i.dataId);const l=n.data.get(i.dataId);if(null!=l.complexTensorInfos){const e=l.complexTensorInfos.real,t=l.complexTensorInfos.imag;e.shape=s,t.shape=s}return{dataId:i.dataId,shape:s,dtype:i.dtype}}const fm={kernelName:O.Reshape,backendName:"cpu",kernelFunc:hm};function gm(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:o}=t,{transposeA:a,transposeB:s}=r;Mh([i,o],"matMul");const u=i.shape.length,l=o.shape.length,c=a?i.shape[u-2]:i.shape[u-1],p=s?o.shape[l-1]:o.shape[l-2],d=a?i.shape[u-1]:i.shape[u-2],h=s?o.shape[l-2]:o.shape[l-1],f=i.shape.slice(0,-2),g=o.shape.slice(0,-2),m=O.util.sizeFromShape(f),y=O.util.sizeFromShape(g),b=O.broadcast_util.assertAndGetBroadcastShape(i.shape.slice(0,-2),o.shape.slice(0,-2)).concat([d,h]);O.util.assert(c===p,(()=>`Error in matMul: inner shapes (${c}) and (${p}) of Tensors with shapes ${i.shape} and ${o.shape} and transposeA=${a} and transposeB=${s} must match.`));const v=s?[y,h,p]:[y,p,h],x=hm({inputs:{x:i},backend:n,attrs:{shape:a?[m,c,d]:[m,d,c]}}),_=hm({inputs:{x:o},backend:n,attrs:{shape:v}}),w=a?x.shape[1]:x.shape[2],k=a?x.shape[2]:x.shape[1],S=s?_.shape[1]:_.shape[2],C=Math.max(m,y),M=n.data.get(x.dataId).values,T=n.data.get(_.dataId).values,E=O.util.computeStrides(x.shape),A=O.util.computeStrides(_.shape),[F,R,N]=a?[E[0],1,E[1]]:[E[0],E[1],1],[D,I,B]=s?[1,A[1],A[0]]:[A[1],1,A[0]],L=k*S,P=(0,O.buffer)([C,k,S],x.dtype),$=P.values,z=n.blockSize;for(let e=0;e<C;e++){const t=e%m,n=e%y;for(let r=0;r<k;r+=z){const i=Math.min(r+z,k);for(let o=0;o<S;o+=z){const a=Math.min(o+z,S);for(let s=0;s<w;s+=z){const u=Math.min(s+z,w);for(let l=r;l<i;l++)for(let r=o;r<a;r++){let i=0;for(let e=s;e<u;e++)i+=M[t*F+l*R+e*N]*T[e*D+r*I+n*B];$[e*L+(l*S+r)]+=i}}}}}return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(_),n.makeTensorInfo(b,P.dtype,P.values)}const mm={kernelName:O.BatchMatMul,backendName:"cpu",kernelFunc:gm},ym={kernelName:O._FusedMatMul,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:o,bias:a,preluActivationWeights:s}=t,{transposeA:u,transposeB:l,activation:c,leakyreluAlpha:p}=r;let d,h,f;const g=[];d=gm({inputs:{a:i,b:o},attrs:{transposeA:u,transposeB:l},backend:n}),a&&(h=Hh({inputs:{a:d,b:a},backend:n}),g.push(d),d=h),c&&(f=dm(n,d,c,s,p),g.push(d),d=f);for(const e of g)n.disposeIntermediateTensorInfo(e);return d}},bm=ef(O.Acos,(e=>Math.acos(e))),vm={kernelName:O.Acos,backendName:"cpu",kernelFunc:bm},xm=ef(O.Acosh,(e=>Math.acosh(e))),_m={kernelName:O.Acosh,backendName:"cpu",kernelFunc:xm},wm={kernelName:O.AddN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,r=t;Mh(t,"addN");const i=r.map((e=>n.data.get(e.dataId).values)),o=(0,O.buffer)(r[0].shape,r[0].dtype),a=o.values;for(let e=0;e<r.length;e++){const t=i[e];for(let e=0;e<a.length;e++)a[e]+=t[e]}return n.makeTensorInfo(o.shape,o.dtype,o.values)}},km={kernelName:O.All,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:a}=r;Mh(i,"all");const s=O.util.parseAxisParam(o,i.shape);let u=s;const l=O.backend_util.getAxesPermutation(u,i.shape.length);let c=i;null!=l&&(c=rg({inputs:{x:i},backend:n,attrs:{perm:l}}),u=O.backend_util.getInnerMostAxes(u.length,i.shape.length)),O.backend_util.assertAxesAreInnerMostDims("all",u,c.shape.length);const[p,d]=O.backend_util.computeOutAndReduceShapes(c.shape,u),h=O.util.sizeFromShape(d),f=O.util.makeZerosTypedArray(O.util.sizeFromShape(p),c.dtype),g=n.data.get(c.dataId).values;for(let e=0;e<f.length;++e){const t=e*h;let n=g[t];for(let e=0;e<h;++e){const r=g[t+e];n=n&&r}f[e]=n}null!=l&&n.disposeIntermediateTensorInfo(c);const m=n.makeTensorInfo(p,c.dtype,f);if(a){const e=hm({inputs:{x:m},backend:n,attrs:{shape:O.backend_util.expandShapeToKeepDim(p,s)}});return n.disposeIntermediateTensorInfo(m),e}return m}},Sm={kernelName:O.Any,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:a}=r;Mh(i,"any");const s=O.util.parseAxisParam(o,i.shape);let u=s;const l=O.backend_util.getAxesPermutation(u,i.shape.length);let c=i;null!=l&&(c=rg({inputs:{x:i},backend:n,attrs:{perm:l}}),u=O.backend_util.getInnerMostAxes(u.length,i.shape.length)),O.backend_util.assertAxesAreInnerMostDims("any",u,c.shape.length);const[p,d]=O.backend_util.computeOutAndReduceShapes(c.shape,u),h=O.util.sizeFromShape(d),f=O.util.makeZerosTypedArray(O.util.sizeFromShape(p),c.dtype),g=n.data.get(c.dataId).values;for(let e=0;e<f.length;++e){const t=e*h;let n=g[t];for(let e=0;e<h;++e){const r=g[t+e];n=n||r}f[e]=n}null!=l&&n.disposeIntermediateTensorInfo(c);const m=n.makeTensorInfo(p,c.dtype,f);if(a){const e=hm({inputs:{x:m},backend:n,attrs:{shape:O.backend_util.expandShapeToKeepDim(p,s)}});return n.disposeIntermediateTensorInfo(m),e}return m}},Cm={kernelName:O.ArgMax,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o}=r;Mh(i,"argMax");let a=O.util.parseAxisParam(o,i.shape);const s=O.backend_util.getAxesPermutation(a,i.shape.length);let u=i;const l=[];null!=s&&(u=rg({inputs:{x:i},backend:n,attrs:{perm:s}}),l.push(u),a=O.backend_util.getInnerMostAxes(a.length,u.shape.length)),a=[a[0]],O.backend_util.assertAxesAreInnerMostDims("argMax",a,u.shape.length);const[c,p]=O.backend_util.computeOutAndReduceShapes(u.shape,a),d=O.util.sizeFromShape(c),h=O.util.makeZerosTypedArray(d,"int32"),f=O.util.sizeFromShape(p),g=n.data.get(u.dataId).values;for(let e=0;e<h.length;++e){const t=e*f;let n=g[t],r=0;for(let e=0;e<f;++e){const i=g[t+e];i>n&&(n=i,r=e)}h[e]=r}return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(c,"int32",h)}},Mm={kernelName:O.ArgMin,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o}=r;Mh(i,"argMin");let a=O.util.parseAxisParam(o,i.shape);const s=O.backend_util.getAxesPermutation(a,i.shape.length);let u=i;const l=[];null!=s&&(u=rg({inputs:{x:i},backend:n,attrs:{perm:s}}),l.push(u),a=O.backend_util.getInnerMostAxes(a.length,u.shape.length)),a=[a[0]],O.backend_util.assertAxesAreInnerMostDims("argMin",a,u.shape.length);const[c,p]=O.backend_util.computeOutAndReduceShapes(u.shape,a),d=O.util.sizeFromShape(c),h=O.util.makeZerosTypedArray(d,"int32"),f=O.util.sizeFromShape(p),g=n.data.get(u.dataId).values;for(let e=0;e<h.length;++e){const t=e*f;let n=g[t],r=0;for(let e=0;e<f;++e){const i=g[t+e];i<n&&(n=i,r=e)}h[e]=r}return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(c,"int32",h)}},Tm=ef(O.Asin,(e=>Math.asin(e))),Em={kernelName:O.Asin,backendName:"cpu",kernelFunc:Tm},Am=ef(O.Asinh,(e=>Math.asinh(e))),Fm={kernelName:O.Asinh,backendName:"cpu",kernelFunc:Am},Om=ef(O.Atan,(e=>Math.atan(e))),Rm={kernelName:O.Atan,backendName:"cpu",kernelFunc:Om},Nm=Oh(((e,t)=>Math.atan2(e,t))),Dm=Gh(O.Atan2,Nm),Im={kernelName:O.Atan2,backendName:"cpu",kernelFunc:Dm},Bm=ef(O.Atanh,(e=>Math.atanh(e))),Lm={kernelName:O.Atanh,backendName:"cpu",kernelFunc:Bm};function Pm(e,t,n,r,i,o){const a=i.strideHeight,s=i.strideWidth,u=i.dilationHeight,l=i.dilationWidth,c=i.effectiveFilterHeight,p=i.effectiveFilterWidth,d=i.padInfo.top,h=i.padInfo.left,f="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=(0,O.buffer)(i.outShape,n),m=g.values,y=i.outShape[1]*i.outShape[2]*i.outShape[3],b=i.outShape[2]*i.outShape[3],v=i.outShape[3];for(let t=0;t<i.batchSize;++t){const n=t*y,g=t*r[0];for(let t=0;t<i.inChannels;++t)for(let y=0;y<i.outHeight;++y){const x=y*a-d,_=Math.max(0,x),w=Math.min(i.inHeight,c+x),k=n+y*b;for(let n=0;n<i.outWidth;++n){const a=n*s-h,c=Math.max(0,a),d=Math.min(i.inWidth,p+a);let y=f,b=0,x=0;for(let n=_;n<w;n+=u){const i=g+n*r[1];for(let n=c;n<d;n+=l){const a=e[i+n*r[2]+t];"max"===o&&a>y?y=a:"avg"===o&&(b+=a,x++)}if(isNaN(y))break}m[k+n*v+t]="avg"===o?b/x:y}}}return g}function $m(e,t,n,r,i=!1,o=!1){const a=(0,O.buffer)(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,p=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,g=(0,O.buffer)(t,n,e);for(let e=0;e<r.batchSize;++e)for(let t=0;t<r.inChannels;++t)for(let n=0;n<r.outHeight;++n){const m=n*s-h;let y=m;for(;y<0;)y+=l;const b=Math.min(r.inHeight,p+m);for(let s=0;s<r.outWidth;++s){const p=s*u-f;let h=p;for(;h<0;)h+=c;const v=Math.min(r.inWidth,d+p);let x=Number.NEGATIVE_INFINITY,_=-1;for(let n=y;n<b;n+=l){const a=n-m;for(let s=h;s<v;s+=c){const u=s-p,l=g.get(e,n,s,t);l>x&&(x=l,_=i?o?((e*r.inHeight+n)*r.inWidth+s)*r.inChannels+t:(n*r.inWidth+s)*r.inChannels+t:a*d+u)}}a.set(_,e,n,s,t)}}return a}function zm(e,t,n,r,i,o){const a=i.strideDepth,s=i.strideHeight,u=i.strideWidth,l=i.dilationDepth,c=i.dilationHeight,p=i.dilationWidth,d=i.effectiveFilterDepth,h=i.effectiveFilterHeight,f=i.effectiveFilterWidth,g=i.padInfo.front,m=i.padInfo.top,y=i.padInfo.left,b="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=(0,O.buffer)(i.outShape,n),x=v.values,_=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],w=i.outShape[2]*i.outShape[3]*i.outShape[4],k=i.outShape[3]*i.outShape[4],S=i.outShape[4];for(let t=0;t<i.batchSize;++t){const n=t*_,v=t*r[0];for(let t=0;t<i.inChannels;++t)for(let _=0;_<i.outDepth;++_){const C=_*a-g;let M=C;for(;M<0;)M+=l;const T=Math.min(i.inDepth,d+C),E=n+_*w;for(let n=0;n<i.outHeight;++n){const a=n*s-m;let d=a;for(;d<0;)d+=c;const g=Math.min(i.inHeight,h+a),_=E+n*k;for(let n=0;n<i.outWidth;++n){const a=n*u-y;let s=a;for(;s<0;)s+=p;const h=Math.min(i.inWidth,f+a),m=_+n*S;let w=b,k=0,C=0;for(let n=M;n<T;n+=l){const i=v+n*r[1];for(let n=d;n<g;n+=c){const a=i+n*r[2];for(let n=s;n<h;n+=p){const i=e[a+n*r[3]+t];if("max"===o&&i>w?w=i:"avg"===o&&(k+=i,C++),isNaN(w))break}if(isNaN(w))break}if(isNaN(w))break}x[m+t]="avg"===o?k/Math.max(C,1):w}}}}return v}const jm={kernelName:O.AvgPool,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;Mh(i,"avgPool");const{filterSize:o,strides:a,pad:s,dimRoundingMode:u}=r;O.util.assert(O.backend_util.eitherStridesOrDilationsAreOne(a,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '1'`));const l=O.backend_util.computePool2DInfo(i.shape,o,a,1,s,u);let c;if(1===l.filterWidth&&1===l.filterHeight&&O.util.arraysEqual(l.inShape,l.outShape))c=Ih({inputs:{x:i},backend:n});else{const e=n.data.get(i.dataId).values,t=O.util.computeStrides(i.shape),r=Pm(e,i.shape,i.dtype,t,l,"avg");c=n.makeTensorInfo(l.outShape,i.dtype,r.values)}return c}},Gm={kernelName:O.AvgPool3D,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:o,strides:a,pad:s,dimRoundingMode:u,dataFormat:l}=r;Mh(i,"avgPool3d");const c=O.backend_util.computePool3DInfo(i.shape,o,a,1,s,u,l),p=zm(n.data.get(i.dataId).values,i.shape,i.dtype,O.util.computeStrides(i.shape),c,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}},Um={kernelName:O.AvgPool3DGrad,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:o}=t,{filterSize:a,strides:s,pad:u,dimRoundingMode:l}=r;Mh([i,o],"avgPool3DGrad");const c=O.backend_util.computePool3DInfo(o.shape,a,s,1,u,l),p=c.strideDepth,d=c.strideHeight,h=c.strideWidth,f=c.filterDepth,g=c.filterHeight,m=c.filterWidth,y=c.dilationDepth,b=c.dilationHeight,v=c.dilationWidth,x=c.effectiveFilterDepth,_=c.effectiveFilterHeight,w=c.effectiveFilterWidth,k=x-1-c.padInfo.front,S=w-1-c.padInfo.left,C=_-1-c.padInfo.top,M=(0,O.buffer)(o.shape,"float32"),T=1/(f*g*m),E=n.bufferSync(i);for(let e=0;e<c.batchSize;++e)for(let t=0;t<c.inChannels;++t)for(let n=0;n<c.inDepth;++n)for(let r=0;r<c.inHeight;++r)for(let i=0;i<c.inWidth;++i){const o=n-k,a=r-C,s=i-S;let u=0;for(let n=0;n<x;n+=y){const r=(o+n)/p;if(!(r<0||r>=c.outDepth||Math.floor(r)!==r))for(let n=0;n<_;n+=b){const i=(a+n)/d;if(!(i<0||i>=c.outHeight||Math.floor(i)!==i))for(let n=0;n<w;n+=v){const o=(s+n)/h;o<0||o>=c.outWidth||Math.floor(o)!==o||(u+=E.get(e,r,i,o,t))}}}M.set(u*T,e,n,r,i,t)}return n.makeTensorInfo(M.shape,M.dtype,M.values)}},Wm={kernelName:O.AvgPoolGrad,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:o}=t,a=o;Mh([i,o],"avgPoolGrad");const{filterSize:s,strides:u,pad:l}=r,c=O.backend_util.computePool2DInfo(a.shape,s,u,1,l),p=c.strideHeight,d=c.strideWidth,h=c.filterHeight,f=c.filterWidth,g=c.dilationHeight,m=c.dilationWidth,y=c.effectiveFilterHeight,b=c.effectiveFilterWidth,v=b-1-c.padInfo.left,x=y-1-c.padInfo.top,_=(0,O.buffer)(a.shape,"float32"),w=1/(h*f),k=n.data.get(i.dataId).values,S=(0,O.buffer)(i.shape,"float32",k);for(let e=0;e<c.batchSize;++e)for(let t=0;t<c.inChannels;++t)for(let n=0;n<c.inHeight;++n)for(let r=0;r<c.inWidth;++r){const i=n-x,o=r-v;let a=0;for(let n=0;n<y;n+=g){const r=(i+n)/p;if(!(r<0||r>=c.outHeight||Math.floor(r)!==r))for(let n=0;n<b;n+=m){const i=(o+n)/d;i<0||i>=c.outWidth||Math.floor(i)!==i||(a+=S.get(e,r,i,t))}}_.set(a*w,e,n,r,t)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}},Vm={kernelName:O.FusedBatchNorm,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,scale:o,offset:a,mean:s,variance:u}=t;O.util.assert(s.shape.length===u.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),O.util.assert(null==a||s.shape.length===a.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),O.util.assert(null==o||s.shape.length===o.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks.")),Mh([i,s,u,o,a],"batchNorm");let{varianceEpsilon:l}=r;null==l&&(l=.001);const c=n.data.get(i.dataId).values,p=n.data.get(s.dataId).values,d=n.data.get(u.dataId).values,h=o?n.data.get(o.dataId).values:new Float32Array([1]),f=a?n.data.get(a.dataId).values:new Float32Array([0]),g=new Float32Array(c.length),m=f.length,y=h.length,b=d.length,v=p.length;let x=0,_=0,w=0,k=0;for(let e=0;e<c.length;++e)g[e]=f[x++]+(c[e]-p[_++])*h[w++]/Math.sqrt(d[k++]+l),x>=m&&(x=0),_>=v&&(_=0),w>=y&&(w=0),k>=b&&(k=0);return n.makeTensorInfo(i.shape,i.dtype,g)}},Hm={kernelName:O.BatchToSpaceND,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:o,crops:a}=r;Mh([i],"batchToSpaceND");const s=o.reduce(((e,t)=>e*t)),u=O.backend_util.getReshaped(i.shape,o,s),l=O.backend_util.getPermuted(u.length,o.length),c=O.backend_util.getReshapedPermuted(i.shape,o,s),p=O.backend_util.getSliceBeginCoords(a,o.length),d=O.backend_util.getSliceSize(c,a,o.length),h=hm({inputs:{x:i},backend:n,attrs:{shape:u}}),f=rg({inputs:{x:h},backend:n,attrs:{perm:l}}),g=hm({inputs:{x:f},backend:n,attrs:{shape:c}}),m=Cg({inputs:{x:g},backend:n,attrs:{begin:p,size:d}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),m}},qm={kernelName:O.Bincount,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:o}=t,{size:a}=r,s=Xh(n.data.get(i.dataId).values,n.data.get(o.dataId).values,o.dtype,o.shape,a);return n.makeTensorInfo([a],o.dtype,s)}},Xm={kernelName:O.BroadcastArgs,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{s0:r,s1:i}=t,o=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,s=O.backend_util.assertAndGetBroadcastShape(Array.from(o),Array.from(a));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},Ym=ef(O.ClipByValue,((e,t)=>{const n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e})),Km={kernelName:O.ClipByValue,backendName:"cpu",kernelFunc:Ym},Jm={kernelName:O.ComplexAbs,backendName:"cpu",kernelFunc:e=>{const{x:t}=e.inputs,n=e.backend,r=new Float32Array(O.util.sizeFromShape(t.shape)),i=n.data.get(t.dataId),o=i.complexTensorInfos.real,a=i.complexTensorInfos.imag,s=n.data.get(o.dataId).values,u=n.data.get(a.dataId).values;for(let e=0;e<s.length;e++){const t=s[e],n=u[e];r[e]=Math.hypot(t,n)}return n.makeOutput(r,t.shape,"float32")}};function Zm(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.imag,o=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,o)}const Qm={kernelName:O.Imag,backendName:"cpu",kernelFunc:Zm};function ey(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,o=O.util.parseAxisParam(i,t[0].shape)[0],a=t.map((e=>e.shape));O.backend_util.assertParamsConsistent(a,o);let s=O.backend_util.computeOutShape(t.map((e=>e.shape)),o);if(0===O.util.sizeFromShape(s))return n.makeTensorInfo(s,t[0].dtype,[]);const u=t.filter((e=>O.util.sizeFromShape(e.shape)>0));if(1===u.length)return Ih({inputs:{x:u[0]},backend:n});if("complex64"===u[0].dtype){const e=u.map((e=>Lh({inputs:{input:e},backend:n}))),t=u.map((e=>Zm({inputs:{input:e},backend:n}))),r=ey({inputs:e,backend:n,attrs:{axis:o}}),i=ey({inputs:t,backend:n,attrs:{axis:o}}),a=Rh({inputs:{real:r,imag:i},backend:n});return e.forEach((e=>n.disposeIntermediateTensorInfo(e))),t.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),a}const l=u.map((e=>{const t=O.util.sizeFromShape(e.shape.slice(o));return hm({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),c=l.map((e=>({vals:n.data.get(e.dataId).values,shape:e.shape})));s=O.backend_util.computeOutShape(l.map((e=>e.shape)),1);const p=1===l[0].shape[0],d=af(c,s,t[0].dtype,p),h=O.backend_util.computeOutShape(u.map((e=>e.shape)),o),f=n.makeTensorInfo(h,t[0].dtype,d);return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),f}const ty={kernelName:O.Concat,backendName:"cpu",kernelFunc:ey};function ny(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:a,pad:s,dataFormat:u,dilations:l,dimRoundingMode:c}=r;Mh([i,o],"conv2d");const p=O.backend_util.convertConv2DDataFormat(u),d=O.backend_util.computeConv2DInfo(i.shape,o.shape,a,l,s,c,!1,p),h=d.filterHeight,f=d.filterWidth,g=d.dilationHeight,m=d.dilationWidth,y=d.padInfo.left,b=d.padInfo.top,v="channelsLast"===d.dataFormat,x=new O.TensorBuffer(d.outShape,i.dtype),_=O.util.computeStrides(i.shape),w=O.util.computeStrides(o.shape),k=_[0],S=v?_[1]:_[2],C=v?_[2]:1,M=v?1:_[1],T=x.strides[0],E=v?x.strides[1]:x.strides[2],A=v?x.strides[2]:1,F=v?1:x.strides[1],R=n.data.get(i.dataId).values,N=n.data.get(o.dataId).values,D=x.values;for(let e=0;e<d.batchSize;++e){const t=e*k,n=e*T;for(let e=0;e<d.outHeight;++e){const r=n+e*E,i=e*d.strideHeight-b;for(let e=0;e<h;++e){const n=i+e*g;if(n<0||n>=d.inHeight)continue;const o=e*w[0],a=t+n*S;for(let e=0;e<d.outWidth;++e){const t=r+e*A,n=e*d.strideWidth-y;for(let e=0;e<f;++e){const r=n+e*m;if(r<0||r>=d.inWidth)continue;const i=a+r*C;let s=o+e*w[1];for(let e=0;e<d.inChannels;++e){const n=R[i+e*M];for(let e=0;e<d.outChannels;++e)D[t+e*F]+=n*N[s+e];s+=d.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,D)}const ry={kernelName:O.Conv2D,backendName:"cpu",kernelFunc:ny},iy={kernelName:O.Conv2DBackpropFilter,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:o}=t,{strides:a,pad:s,dataFormat:u,dimRoundingMode:l,filterShape:c}=r;Mh([i,o],"conv2dBackpropFilter");const p=O.backend_util.convertConv2DDataFormat(u),d=O.backend_util.computeConv2DInfo(i.shape,c,a,1,s,l,!1,p),{strideHeight:h,strideWidth:f,filterHeight:g,filterWidth:m}=d,y="channelsLast"===d.dataFormat,b=new O.TensorBuffer(d.filterShape,"float32"),v=d.padInfo.left,x=d.padInfo.top,_=n.data.get(i.dataId).values,w=n.data.get(o.dataId).values,k=new O.TensorBuffer(i.shape,i.dtype,_),S=new O.TensorBuffer(o.shape,o.dtype,w);for(let e=0;e<g;++e){const t=Math.max(0,Math.ceil((x-e)/h)),n=Math.min(d.outHeight,(d.inHeight+x-e)/h);for(let r=0;r<m;++r){const i=Math.max(0,Math.ceil((v-r)/f)),o=Math.min(d.outWidth,(d.inWidth+v-r)/f);for(let a=0;a<d.inChannels;++a)for(let s=0;s<d.outChannels;++s){let u=0;for(let l=0;l<d.batchSize;++l)for(let c=t;c<n;++c){const t=e+c*h-x;for(let e=i;e<o;++e){const n=r+e*f-v;u+=y?k.get(l,t,n,a)*S.get(l,c,e,s):k.get(l,a,t,n)*S.get(l,s,c,e)}}b.set(u,e,r,a,s)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}},oy={kernelName:O.Conv2DBackpropInput,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:o}=t,{inputShape:a,strides:s,pad:u,dataFormat:l,dimRoundingMode:c}=r;Mh([i,o],"conv2dBackpropInput");const p=O.util.computeStrides(o.shape),d=O.util.computeStrides(i.shape);let h=O.backend_util.convertConv2DDataFormat(l);const f=O.backend_util.computeConv2DInfo(a,o.shape,s,1,u,c,!1,h),g=new O.TensorBuffer(f.inShape,"float32"),m=g.values,y=n.data.get(i.dataId).values,b=n.data.get(o.dataId).values,[v,x,_]=p,{batchSize:w,filterHeight:k,filterWidth:S,inChannels:C,inHeight:M,inWidth:T,outChannels:E,outHeight:A,outWidth:F,strideHeight:R,strideWidth:N}=f;h=f.dataFormat;const D=k-1-f.padInfo.top,I=S-1-f.padInfo.left,B="channelsLast"===h,L=g.strides[0],P=B?g.strides[1]:g.strides[2],$=B?g.strides[2]:1,z=B?1:g.strides[1],j=d[0],G=B?d[1]:d[2],U=B?d[2]:1,W=B?1:d[1];for(let e=0;e<w;++e)for(let t=0;t<C;++t)for(let n=0;n<M;++n){const r=n-D,i=Math.max(0,Math.ceil(r/R)),o=Math.min(A,(k+r)/R);for(let a=0;a<T;++a){const s=a-I,u=Math.max(0,Math.ceil(s/N)),l=Math.min(F,(S+s)/N);let c=0;for(let n=i;n<o;++n){const i=n*R-r;for(let r=u;r<l;++r){const o=j*e+G*n+U*r,a=v*(k-1-i)+x*(S-1-(r*N-s))+_*t;for(let e=0;e<E;++e)c+=y[o+W*e]*b[a+e]}}m[L*e+P*n+$*a+z*t]=c}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}},ay={kernelName:O.Conv3D,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:a,pad:s,dilations:u}=r;Mh([i,o],"conv3d");const l=O.backend_util.computeConv3DInfo(i.shape,o.shape,a,u,s),{filterDepth:c,filterHeight:p,filterWidth:d,dilationDepth:h,dilationHeight:f,dilationWidth:g,padInfo:m}=l,y=m.front,b=m.left,v=m.top,x=new O.TensorBuffer(l.outShape,i.dtype),_=n.data.get(i.dataId).values,w=n.data.get(o.dataId).values,k=x.values,S=O.util.computeStrides(i.shape),C=O.util.computeStrides(o.shape);for(let e=0;e<l.batchSize;++e){const t=e*S[0],n=e*x.strides[0];for(let e=0;e<l.outDepth;++e){const r=n+e*x.strides[1],i=e*l.strideDepth-y;for(let e=0;e<c;++e){const n=i+e*h;if(n<0||n>=l.inDepth)continue;const o=e*C[0],a=t+n*S[1];for(let e=0;e<l.outHeight;++e){const t=r+e*x.strides[2],n=e*l.strideHeight-v;for(let e=0;e<p;++e){const r=n+e*f;if(r<0||r>=l.inHeight)continue;const i=o+e*C[1],s=a+r*S[2];for(let e=0;e<l.outWidth;++e){const n=t+e*l.outChannels,r=e*l.strideWidth-b;for(let e=0;e<d;++e){const t=r+e*g;if(t<0||t>=l.inWidth)continue;const o=i+e*C[2],a=s+t*l.inChannels;let u=o;for(let e=0;e<l.inChannels;++e){const t=_[a+e];for(let e=0;e<l.outChannels;++e)k[n+e]+=t*w[u+e];u+=l.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}},sy={kernelName:O.Conv3DBackpropFilterV2,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:o}=t,{strides:a,pad:s,filterShape:u}=r;Mh([i,o],"conv3dBackpropFilterV2");const l=O.util.computeStrides(i.shape),c=O.util.computeStrides(o.shape),p=O.backend_util.computeConv3DInfo(i.shape,u,a,1,s),d=p.strideDepth,h=p.strideHeight,f=p.strideWidth,g=p.filterDepth,m=p.filterHeight,y=p.filterWidth,b=new O.TensorBuffer(p.filterShape,"float32"),v=b.values,[x,_,w,k]=b.strides,S=n.data.get(o.dataId).values,[C,M,T,E]=c,A=n.data.get(i.dataId).values,[F,R,N,D]=l,I=p.padInfo.front,B=p.padInfo.left,L=p.padInfo.top;for(let e=0;e<g;++e){const t=Math.max(0,Math.ceil((I-e)/d)),n=Math.min(p.outDepth,(p.inDepth+I-e)/d),r=e*x;for(let i=0;i<m;++i){const o=Math.max(0,Math.ceil((L-i)/h)),a=Math.min(p.outHeight,(p.inHeight+L-i)/h),s=i*_+r;for(let r=0;r<y;++r){const u=Math.max(0,Math.ceil((B-r)/f)),l=Math.min(p.outWidth,(p.inWidth+B-r)/f),c=r*w+s;for(let s=0;s<p.inChannels;++s){const g=s*k+c;for(let c=0;c<p.outChannels;++c){let m=0;for(let g=0;g<p.batchSize;++g){const p=g*F,y=g*C;for(let g=t;g<n;++g){const t=(e+g*d-I)*R+p,n=g*M+y;for(let e=o;e<a;++e){const o=(i+e*h-L)*N+t,a=e*T+n;for(let e=u;e<l;++e){const t=e*E+a;m+=A[(r+e*f-B)*D+o+s]*S[t+c]}}}}v[g+c]=m}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}},uy={kernelName:O.Conv3DBackpropInputV2,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:o}=t,{pad:a,strides:s,inputShape:u}=r;Mh([i],"conv3dBackpropInputV2");const l=O.util.computeStrides(i.shape),c=O.util.computeStrides(o.shape),p=O.backend_util.computeConv3DInfo(u,o.shape,s,1,a),d=new O.TensorBuffer(p.inShape,"float32"),h=d.values,[f,g,m,y]=d.strides,b=n.data.get(i.dataId).values,[v,x,_,w]=l,k=n.data.get(o.dataId).values,[S,C,M,T]=c,{batchSize:E,filterDepth:A,filterHeight:F,filterWidth:R,inChannels:N,inDepth:D,inHeight:I,inWidth:B,outChannels:L,outDepth:P,outHeight:$,outWidth:z,strideDepth:j,strideHeight:G,strideWidth:U}=p,W=A-1-p.padInfo.front,V=F-1-p.padInfo.top,H=R-1-p.padInfo.left;for(let e=0;e<E;++e)for(let t=0;t<N;++t)for(let n=0;n<D;++n){const r=n-W,i=Math.max(0,Math.ceil(r/j)),o=Math.min(P,(A+r)/j);for(let a=0;a<I;++a){const s=a-V,u=Math.max(0,Math.ceil(s/G)),l=Math.min($,(F+s)/G);for(let c=0;c<B;++c){const p=c-H,d=Math.max(0,Math.ceil(p/U)),E=Math.min(z,(R+p)/U);let O=0;for(let n=i;n<o;++n){const i=n*j-r;for(let r=u;r<l;++r){const o=r*G-s;for(let a=d;a<E;++a){const s=v*e+x*n+_*r+w*a,u=S*(A-1-i)+C*(F-1-o)+M*(R-1-(a*U-p))+T*t;for(let e=0;e<L;++e)O+=b[s+e]*k[u+e]}}}h[f*e+g*n+m*a+y*c+t]=O}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}},ly=ef(O.Cos,(e=>Math.cos(e))),cy={kernelName:O.Cos,backendName:"cpu",kernelFunc:ly},py=ef(O.Cosh,(e=>Math.cosh(e))),dy={kernelName:O.Cosh,backendName:"cpu",kernelFunc:py},hy={kernelName:O.CropAndResize,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:o,boxInd:a}=t,{cropSize:s,method:u,extrapolationValue:l}=r,[c,p,d,h]=i.shape,f=o.shape[0],[g,m]=s,y=(0,O.buffer)([f,g,m,h],"float32"),b=n.data.get(o.dataId).values,v=n.data.get(a.dataId).values,x=n.data.get(i.dataId).values,_=O.util.computeStrides(i.shape),w=O.util.computeStrides(y.shape);for(let e=0;e<f;e++){const t=4*e,n=b[t],r=b[t+1],i=b[t+2],o=b[t+3],a=v[e];if(a>=c)continue;const s=g>1?(i-n)*(p-1)/(g-1):0,f=m>1?(o-r)*(d-1)/(m-1):0;for(let t=0;t<g;t++){const c=g>1?n*(p-1)+t*s:.5*(n+i)*(p-1);if(c<0||c>p-1)for(let n=0;n<m;n++)for(let r=0;r<h;r++){const i=r+n*w[2]+t*w[1]+e*w[0];y.values[i]=l}else if("bilinear"===u){const n=Math.floor(c),i=Math.ceil(c),s=c-n;for(let u=0;u<m;u++){const c=m>1?r*(d-1)+u*f:.5*(r+o)*(d-1);if(c<0||c>d-1){for(let n=0;n<h;n++){const r=n+u*w[2]+t*w[1]+e*w[0];y.values[r]=l}continue}const p=Math.floor(c),g=Math.ceil(c),b=c-p;for(let r=0;r<h;r++){let o=r+p*_[2]+n*_[1]+a*_[0];const l=x[o];o=r+g*_[2]+n*_[1]+a*_[0];const c=x[o];o=r+p*_[2]+i*_[1]+a*_[0];const d=x[o];o=r+g*_[2]+i*_[1]+a*_[0];const h=l+(c-l)*b,f=d+(x[o]-d)*b;o=r+u*w[2]+t*w[1]+e*w[0],y.values[o]=h+(f-h)*s}}}else for(let n=0;n<m;++n){const i=m>1?r*(d-1)+n*f:.5*(r+o)*(d-1);if(i<0||i>d-1){for(let r=0;r<h;r++){const i=r+n*w[2]+t*w[1]+e*w[0];y.values[i]=l}continue}const s=Math.round(i),u=Math.round(c);for(let r=0;r<h;r++){const i=r+s*_[2]+u*_[1]+a*_[0],o=r+n*w[2]+t*w[1]+e*w[0];y.values[o]=x[i]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}},fy={kernelName:O.Cumprod,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,exclusive:a,reverse:s}=r;Mh(i,"cumprod");const u=O.backend_util.getAxesPermutation([o],i.shape.length);let l=i;null!=u&&(l=rg({inputs:{x:i},backend:n,attrs:{perm:u}}));const c=O.backend_util.getInnerMostAxes(1,i.shape.length)[0];if(c!==l.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${l.shape.length-1} but got axis=${c}`);const p=(0,O.upcastType)(l.dtype,"int32"),d=O.util.makeOnesTypedArray(O.util.sizeFromShape(l.shape),p),h=n.data.get(l.dataId).values,f=l.shape[l.shape.length-1],g=s?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let e=0;e<h.length;e+=f)for(let t=0;t<f;t++){const n=g(e,t);if(0===t)d[n]=a?1:h[n];else{const r=g(e,t-1);d[n]=a?h[r]*d[r]:h[n]*d[r]}}const m=n.makeTensorInfo(l.shape,p,d);if(null!=u){const e=rg({inputs:{x:m},backend:n,attrs:{perm:O.backend_util.getUndoAxesPermutation(u)}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(l),e}return m}},gy={kernelName:O.Cumsum,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,exclusive:a,reverse:s}=r;Mh(i,"cumsum");const u=O.backend_util.getAxesPermutation([o],i.shape.length);let l=i;null!=u&&(l=rg({inputs:{x:i},backend:n,attrs:{perm:u}}));const c=O.backend_util.getInnerMostAxes(1,i.shape.length)[0];if(c!==l.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${l.shape.length-1} but got axis=${c}`);const p=(0,O.upcastType)(l.dtype,"int32"),d=O.util.makeZerosTypedArray(O.util.sizeFromShape(l.shape),p),h=n.data.get(l.dataId).values,f=l.shape[l.shape.length-1],g=s?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let e=0;e<h.length;e+=f)for(let t=0;t<f;t++){const n=g(e,t);if(0===t)d[n]=a?0:h[n];else{const r=g(e,t-1);d[n]=a?h[r]+d[r]:h[n]+d[r]}}const m=n.makeTensorInfo(l.shape,p,d);if(null!=u){const e=rg({inputs:{x:m},backend:n,attrs:{perm:O.backend_util.getUndoAxesPermutation(u)}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(l),e}return m}},my={kernelName:O.DenseBincount,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:o}=t,{size:a,binaryOutput:s}=r;if(1===i.shape.length){const e=Xh(n.data.get(i.dataId).values,n.data.get(o.dataId).values,o.dtype,o.shape,a);return n.makeTensorInfo([a],o.dtype,e)}if(2===i.shape.length){const e=Yh(n.bufferSync(i),n.bufferSync(o),a,s);return n.makeTensorInfo(e.shape,o.dtype,e.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}},yy={kernelName:O.DepthToSpace,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:o,dataFormat:a}=r;O.util.assert("NHWC"===a,(()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${a}`));const s=i.shape[0],u=i.shape[1],l=i.shape[2],c=i.shape[3],p=u*o,d=l*o,h=c/(o*o),f=n.data.get(i.dataId).values,g=new Float32Array(s*p*d*h);let m=0;for(let e=0;e<s;++e)for(let t=0;t<p;++t){const n=Math.floor(t/o),r=t%o;for(let t=0;t<d;++t){const i=Math.floor(t/o),a=(r*o+t%o)*h;for(let t=0;t<h;++t){const r=t+a+c*(i+l*(n+u*e));g[m++]=f[r]}}}return n.makeTensorInfo([s,p,d,h],i.dtype,g)}};function by(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:a,pad:s,dilations:u,dimRoundingMode:l}=r;Mh([i,o],"depthwiseConv2DNative");const c=O.util.computeStrides(i.shape),p=O.util.computeStrides(o.shape);let d=u;null==d&&(d=[1,1]),O.util.assert(O.backend_util.eitherStridesOrDilationsAreOne(a,d),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${d}'`));const h=O.backend_util.computeConv2DInfo(i.shape,o.shape,a,d,s,l,!0),{filterHeight:f,filterWidth:g,dilationHeight:m,dilationWidth:y,padInfo:b}=h,v=b.left,x=b.top,_=h.outChannels/h.inChannels,w=new O.TensorBuffer(h.outShape,i.dtype),k=n.data.get(i.dataId).values,S=n.data.get(o.dataId).values,C=w.values;for(let e=0;e<h.batchSize;++e){const t=e*c[0],n=e*w.strides[0];for(let e=0;e<h.outHeight;++e){const r=n+e*w.strides[1],i=e*h.strideHeight-x;for(let e=0;e<f;++e){const n=i+e*m;if(n<0||n>=h.inHeight)continue;const o=e*p[0],a=t+n*c[1];for(let e=0;e<h.outWidth;++e){const t=r+e*w.strides[2],n=e*h.strideWidth-v;for(let e=0;e<g;++e){const r=n+e*y;if(r<0||r>=h.inWidth)continue;const i=o+e*p[1],s=a+r*h.inChannels;let u=t,l=i;for(let e=0;e<h.inChannels;++e){const t=k[s+e];for(let e=0;e<_;++e)C[u+e]+=t*S[l+e];u+=_,l+=_}}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const vy={kernelName:O.DepthwiseConv2dNative,backendName:"cpu",kernelFunc:by},xy={kernelName:O.DepthwiseConv2dNativeBackpropFilter,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:o}=t,{strides:a,dilations:s,pad:u,dimRoundingMode:l,filterShape:c}=r;Mh([i,o],"depthwiseConv2dNativeBackpropFilter");const p=O.backend_util.computeConv2DInfo(i.shape,c,a,s,u,l,!0),{strideHeight:d,strideWidth:h,filterHeight:f,filterWidth:g}=p,m=new O.TensorBuffer(p.filterShape,"float32"),y=p.padInfo.left,b=p.padInfo.top,v=p.outChannels/p.inChannels,x=n.data.get(i.dataId).values,_=new O.TensorBuffer(i.shape,i.dtype,x),w=n.data.get(o.dataId).values,k=new O.TensorBuffer(o.shape,o.dtype,w);for(let e=0;e<f;++e){const t=Math.max(0,Math.ceil((b-e)/d)),n=Math.min(p.outHeight,(p.inHeight+b-e)/d);for(let r=0;r<g;++r){const i=Math.max(0,Math.ceil((y-r)/h)),o=Math.min(p.outWidth,(p.inWidth+y-r)/h);for(let a=0;a<p.outChannels;++a){const s=Math.trunc(a/v),u=a%v;let l=0;for(let u=0;u<p.batchSize;++u)for(let c=t;c<n;++c){const t=e+c*d-b;for(let e=i;e<o;++e){const n=r+e*h-y;l+=_.get(u,t,n,s)*k.get(u,c,e,a)}}m.set(l,e,r,s,u)}}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}},_y={kernelName:O.DepthwiseConv2dNativeBackpropInput,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:o}=t,{strides:a,dilations:s,pad:u,dimRoundingMode:l,inputShape:c}=r;Mh([i,o],"depthwiseConv2DNativeBackpropInput");const p=O.util.computeStrides(i.shape),d=O.util.computeStrides(o.shape),h=O.backend_util.computeConv2DInfo(c,o.shape,a,s,u,l,!0),f=new O.TensorBuffer(h.inShape,"float32"),g=f.values,[m,y,b]=f.strides,v=n.data.get(i.dataId).values,[x,_,w]=p,k=n.data.get(o.dataId).values,[S,C,M]=d,{batchSize:T,filterHeight:E,filterWidth:A,inChannels:F,inHeight:R,inWidth:N,outChannels:D,outHeight:I,outWidth:B,strideHeight:L,strideWidth:P}=h,$=E-1-h.padInfo.top,z=A-1-h.padInfo.left,j=D/F;for(let e=0;e<T;++e)for(let t=0;t<F;++t)for(let n=0;n<R;++n){const r=n-$,i=Math.max(0,Math.ceil(r/L)),o=Math.min(I,(E+r)/L);for(let a=0;a<N;++a){const s=a-z,u=Math.max(0,Math.ceil(s/P)),l=Math.min(B,(A+s)/P);let c=0;for(let n=i;n<o;++n){const i=n*L-r;for(let r=u;r<l;++r){const o=x*e+_*n+w*r,a=S*(E-1-i)+C*(A-1-(r*P-s))+M*t;for(let e=0;e<j;++e)c+=v[o+(t*j+e)]*k[a+e]}}g[m*e+y*n+b*a+t]=c}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}},wy={kernelName:O.Diag,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,i=O.util.sizeFromShape(r.shape),o=n.data.get(r.dataId).values,a=(0,O.buffer)([i,i],r.dtype),s=a.values;for(let e=0;e<o.length;e++)s[e*i+e]=o[e];const u=[...r.shape,...r.shape];return n.makeTensorInfo(u,a.dtype,a.values)}},ky={kernelName:O.Dilation2D,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i}=e,{strides:o,pad:a,dilations:s}=n,u=t,l=u.data.get(r.dataId).values,c=r.shape.length,p=u.data.get(i.dataId).values,d=i.shape.length,{batchSize:h,inHeight:f,inWidth:g,inChannels:m,outHeight:y,outWidth:b,padInfo:v,strideHeight:x,strideWidth:_,filterHeight:w,filterWidth:k,dilationHeight:S,dilationWidth:C,outShape:M}=O.backend_util.computeDilation2DInfo(r.shape,i.shape,o,a,"NHWC",s),T=O.util.sizeFromShape(M),E=M.length,A=O.util.getArrayFromDType(r.dtype,T);for(let e=0;e<h;++e)for(let t=0;t<y;++t){const n=t*x-v.top;for(let o=0;o<b;++o){const a=o*_-v.left;for(let s=0;s<m;++s){let u=Number.MIN_SAFE_INTEGER;for(let t=0;t<w;++t){const o=n+t*S;if(o>=0&&o<f)for(let n=0;n<k;++n){const h=a+n*C;if(h>=0&&h<g){const a=O.util.locToIndex([e,o,h,s],c,O.util.computeStrides(r.shape)),f=O.util.locToIndex([t,n,s],d,O.util.computeStrides(i.shape)),g=l[a]+p[f];g>u&&(u=g)}}}A[O.util.locToIndex([e,t,o,s],E,O.util.computeStrides(M))]=u}}}return{dataId:u.write(O.util.toTypedArray(A,r.dtype),M,r.dtype),shape:M,dtype:r.dtype}}},Sy={kernelName:O.Dilation2DBackpropFilter,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i,dy:o}=e,{strides:a,pad:s,dilations:u}=n,l=t,c=O.util.toNestedArray(r.shape,l.data.get(r.dataId).values),p=O.util.toNestedArray(i.shape,l.data.get(i.dataId).values),{batchSize:d,inHeight:h,inWidth:f,inChannels:g,outHeight:m,outWidth:y,padInfo:b,strideHeight:v,strideWidth:x,filterHeight:_,filterWidth:w,dilationHeight:k,dilationWidth:S,outShape:C}=O.backend_util.computeDilation2DInfo(r.shape,i.shape,a,s,"NHWC",u);O.util.assert(o.rank===C.length,(()=>`Error in ${O.Dilation2DBackpropFilter}, dy must have the same rank as output ${C.length}, but got ${o.rank}`));const M=O.util.toNestedArray(C,l.data.get(o.dataId).values),T=O.util.makeZerosNestedTypedArray(i.shape,i.dtype);for(let e=0;e<d;++e)for(let t=0;t<m;++t){const n=t*v-b.top;for(let r=0;r<y;++r){const i=r*x-b.left;for(let o=0;o<g;++o){let a=Number.MIN_SAFE_INTEGER,s=0,u=0;for(let t=0;t<_;++t){const r=n+t*k;if(r>=0&&r<h)for(let n=0;n<w;++n){const l=i+n*S;if(l>=0&&l<f){const i=c[e][r][l][o]+p[t][n][o];i>a&&(a=i,s=t,u=n)}}}T[s][u][o]+=M[e][t][r][o]}}}return{dataId:l.write(O.util.toTypedArray(T,r.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},Cy={kernelName:O.Dilation2DBackpropInput,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i,dy:o}=e,{strides:a,pad:s,dilations:u}=n,l=t,c=O.util.toNestedArray(r.shape,l.data.get(r.dataId).values),p=O.util.toNestedArray(i.shape,l.data.get(i.dataId).values),{batchSize:d,inHeight:h,inWidth:f,inChannels:g,outHeight:m,outWidth:y,padInfo:b,strideHeight:v,strideWidth:x,filterHeight:_,filterWidth:w,dilationHeight:k,dilationWidth:S,outShape:C}=O.backend_util.computeDilation2DInfo(r.shape,i.shape,a,s,"NHWC",u);O.util.assert(o.rank===C.length,(()=>`Error in ${O.Dilation2DBackpropInput}, dy must have the same rank as output ${C.length}, but got ${o.rank}`));const M=O.util.toNestedArray(C,l.data.get(o.dataId).values),T=O.util.makeZerosNestedTypedArray(r.shape,r.dtype);for(let e=0;e<d;++e)for(let t=0;t<m;++t){const n=t*v-b.top;for(let r=0;r<y;++r){const i=r*x-b.left;for(let o=0;o<g;++o){let a=Number.MIN_SAFE_INTEGER,s=n<0?0:n,u=i<0?0:i;for(let t=0;t<_;++t){const r=n+t*k;if(r>=0&&r<h)for(let n=0;n<w;++n){const l=i+n*S;if(l>=0&&l<f){const i=c[e][r][l][o]+p[t][n][o];i>a&&(a=i,s=r,u=l)}}}T[e][s][u][o]+=M[e][t][r][o]}}}return{dataId:l.write(O.util.toTypedArray(T,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},My={kernelName:O.Draw,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:i}=t,{canvas:o,options:a}=r,{contextOptions:s,imageOptions:u}=a||{},l=(null==u?void 0:u.alpha)||1,c=(null==s?void 0:s.contextType)||"2d";if("2d"!==c)throw new Error(`Context type ${s.contextType} is not supported by the CPU backend.`);const p=o.getContext(c,(null==s?void 0:s.contextAttributes)||{});if(null==p)throw new Error(`Could not get the context with ${c} type.`);const[d,h]=i.shape.slice(0,2),f=2===i.shape.length?1:i.shape[2],g=n.data.get(i.dataId).values,m="float32"===i.dtype?255:1,y=new Uint8ClampedArray(h*d*4);for(let e=0;e<d*h;++e){const t=[0,0,0,255*l];for(let n=0;n<f;n++){const r=g[e*f+n];if("float32"===i.dtype){if(r<0||r>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${r}.`)}else if("int32"===i.dtype&&(r<0||r>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${r}.`);1===f?(t[0]=r*m,t[1]=r*m,t[2]=r*m):t[n]=r*m}const n=4*e;y[n+0]=Math.round(t[0]),y[n+1]=Math.round(t[1]),y[n+2]=Math.round(t[2]),y[n+3]=Math.round(t[3])}o.width=h,o.height=d;const b=new ImageData(y,h,d);return p.putImageData(b,0,0),i}};function Ty(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:a}=r;let s;Mh(i,"sum"),s="bool"===i.dtype?zh({inputs:{x:i},backend:n,attrs:{dtype:"int32"}}):Ih({inputs:{x:i},backend:n});const u=s.shape.length,l=O.util.parseAxisParam(o,s.shape),c=O.backend_util.getAxesPermutation(l,u);let p=l,d=s;null!=c&&(d=rg({inputs:{x:s},backend:n,attrs:{perm:c}}),p=O.backend_util.getInnerMostAxes(p.length,u)),O.backend_util.assertAxesAreInnerMostDims("sum",p,d.shape.length);const[h,f]=O.backend_util.computeOutAndReduceShapes(d.shape,p);let g=Dh(n,h,O.backend_util.upcastType(d.dtype,"int32"));const m=O.util.sizeFromShape(f),y=n.data.get(g.dataId).values,b=n.data.get(d.dataId).values;for(let e=0;e<y.length;++e){const t=e*m;let n=0;for(let e=0;e<m;++e)n+=b[t+e];y[e]=n}if(a){const e=g;g=hm({inputs:{x:g},backend:n,attrs:{shape:O.backend_util.expandShapeToKeepDim(g.shape,l)}}),n.disposeIntermediateTensorInfo(e)}return n.disposeIntermediateTensorInfo(s),null!=c&&n.disposeIntermediateTensorInfo(d),g}const Ey={kernelName:O.Sum,backendName:"cpu",kernelFunc:Ty},Ay={kernelName:O.Einsum,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,o=t,{allDims:a,summedDims:s,idDims:u}=O.backend_util.decodeEinsumEquation(i,o.length);O.backend_util.checkEinsumDimSizes(a.length,u,o);const{path:l,steps:c}=O.backend_util.getEinsumComputePath(s,u),p=c.length;let d=null,h=a.length;const f=[];for(let e=0;e<p;++e){for(const t of c[e]){const{permutationIndices:e,expandDims:r}=O.backend_util.getEinsumPermutation(h,u[t]);let i;O.backend_util.isIdentityPermutation(e)?i=o[t]:(i=rg({inputs:{x:o[t]},backend:n,attrs:{perm:e}}),f.push(i));const a=i.shape.slice();for(let e=0;e<r.length;++e)a.splice(r[e],0,1);O.util.arraysEqual(i.shape,a)||(i=hm({inputs:{x:i},backend:n,attrs:{shape:a}}),f.push(i)),null===d?d=i:(d=Yf({inputs:{a:i,b:d},backend:n}),f.push(d))}e<p-1&&(l[e]>=0&&(d=Ty({inputs:{x:d},backend:n,attrs:{axis:l[e]-(a.length-h),keepDims:!1}}),f.push(d)),h--)}for(const e of f)e!==d&&n.disposeIntermediateTensorInfo(e);return d}},Fy={kernelName:O.EluGrad,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{dy:r,y:i}=t;Mh([r,i],"eluGrad");const o=new Float32Array(O.util.sizeFromShape(i.shape)),a=n.data.get(i.dataId).values,s=n.data.get(r.dataId).values;for(let e=0;e<a.length;++e){const t=a[e];o[e]=t>=0?s[e]:s[e]*(t+1)}return n.makeTensorInfo(i.shape,"float32",o)}},Oy=O.backend_util.ERF_P,Ry=O.backend_util.ERF_A1,Ny=O.backend_util.ERF_A2,Dy=O.backend_util.ERF_A3,Iy=O.backend_util.ERF_A4,By=O.backend_util.ERF_A5,Ly=ef(O.Erf,(e=>{const t=Math.sign(e),n=Math.abs(e),r=1/(1+Oy*n);return t*(1-((((By*r+Iy)*r+Dy)*r+Ny)*r+Ry)*r*Math.exp(-n*n))})),Py={kernelName:O.Erf,backendName:"cpu",kernelFunc:Ly};function $y(e){const{inputs:t,backend:n,attrs:r}=e,{input:i}=t,{dim:o}=r,a=i.shape.length,s=i.shape.slice();let u=o;return o<0&&(O.util.assert(-(a+1)<=o,(()=>`Axis must be in the interval [${-(a+1)}, ${a}]`)),u=a+o+1),s.splice(u,0,1),hm({inputs:{x:i},backend:n,attrs:{shape:s}})}const zy={kernelName:O.ExpandDims,backendName:"cpu",kernelFunc:$y},jy=Oh(((e,t)=>e/t)),Gy=Gh(O.RealDiv,jy),Uy={kernelName:O.RealDiv,backendName:"cpu",kernelFunc:Gy};function Wy(e,t,n){const r=e.shape,i=r[0],o=r[1],a=n.data.get(e.dataId),s=a.complexTensorInfos.real,u=a.complexTensorInfos.imag,l=[i,o],c=O.util.sizeFromShape(l),p=O.util.getTypedArrayFromDType("float32",c),d=O.util.getTypedArrayFromDType("float32",c);for(let e=0;e<i;e++){const r=Cg({inputs:{x:s},backend:n,attrs:{begin:[e,0],size:[1,o]}}),i=Cg({inputs:{x:u},backend:n,attrs:{begin:[e,0],size:[1,o]}}),a=Rh({inputs:{real:r,imag:i},backend:n}),{real:l,imag:c}=Vy(a,t,n),h=O.backend_util.mergeRealAndImagArrays(l,c);for(let t=0;t<o;t++){const n=O.backend_util.getComplexWithIndex(h,t);p[e*o+t]=n.real,d[e*o+t]=n.imag}n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a)}const h=n.makeTensorInfo(l,"float32",p),f=n.makeTensorInfo(l,"float32",d),g=Rh({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),g}function Vy(e,t,n){const r=O.util.sizeFromShape(e.shape),i=n.data.get(e.dataId),o=n.data.get(i.complexTensorInfos.real.dataId).values,a=n.data.get(i.complexTensorInfos.imag.dataId).values;if(0==((s=r)&s-1)){const i=Hy(o,a,r,t,n),s=[e.shape[0],e.shape[1]];if(t){const e=n.makeTensorInfo(s,"float32",i.real),t=n.makeTensorInfo(s,"float32",i.imag),o=n.makeTensorInfo([],"float32",O.util.createScalarValue(r,"float32")),a=Ih({inputs:{x:o},backend:n}),u=Uy.kernelFunc({inputs:{a:e,b:o},backend:n}),l=Uy.kernelFunc({inputs:{a:t,b:a},backend:n}),c=n.data.get(u.dataId).values,p=n.data.get(l.dataId).values;return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(l),{real:c,imag:p}}return i}{const e=function(e,t,n){const r=new Float32Array(2*t);for(let i=0;i<t;i++){let o=0,a=0;for(let r=0;r<t;r++){const s=O.backend_util.exponent(i*r,t,n),u=O.backend_util.getComplexWithIndex(e,r);o+=u.real*s.real-u.imag*s.imag,a+=u.real*s.imag+u.imag*s.real}n&&(o/=t,a/=t),O.backend_util.assignToTypedArray(r,o,a,i)}return r}(O.backend_util.mergeRealAndImagArrays(o,a),r,t);return O.backend_util.splitRealAndImagArrays(e)}var s}function Hy(e,t,n,r,i){if(1===n)return{real:e,imag:t};const o=O.backend_util.mergeRealAndImagArrays(e,t),a=n/2,s=O.backend_util.complexWithEvenIndex(o),u=s.real,l=s.imag,c=[u.length],p=i.makeTensorInfo(c,"float32",u),d=i.makeTensorInfo(c,"float32",l),h=Rh({inputs:{real:p,imag:d},backend:i}),f=O.backend_util.complexWithOddIndex(o),g=f.real,m=f.imag,y=[g.length],b=i.makeTensorInfo(y,"float32",g),v=i.makeTensorInfo(y,"float32",m),x=Rh({inputs:{real:b,imag:v},backend:i}),_=Hy(u,l,a,r,i),w=_.real,k=_.imag,S=[w.length],C=i.makeTensorInfo(S,"float32",w),M=i.makeTensorInfo(S,"float32",k),T=Rh({inputs:{real:C,imag:M},backend:i}),E=Hy(g,m,a,r,i),A=E.real,F=E.imag,R=[A.length],N=i.makeTensorInfo(R,"float32",A),D=i.makeTensorInfo(R,"float32",F),I=Rh({inputs:{real:N,imag:D},backend:i}),B=O.backend_util.exponents(n,r),L=[B.real.length],P=i.makeTensorInfo(L,"float32",B.real),$=i.makeTensorInfo(L,"float32",B.imag),z=Rh({inputs:{real:P,imag:$},backend:i}),j=Yf({inputs:{a:z,b:I},backend:i}),G=Hh({inputs:{a:T,b:j},backend:i}),U=qg({inputs:{a:T,b:j},backend:i}),W=Lh({inputs:{input:G},backend:i}),V=Lh({inputs:{input:U},backend:i}),H=Zm({inputs:{input:G},backend:i}),q=Zm({inputs:{input:U},backend:i}),X=ey({inputs:[W,V],backend:i,attrs:{axis:0}}),Y=ey({inputs:[H,q],backend:i,attrs:{axis:0}}),K=i.data.get(X.dataId).values,J=i.data.get(Y.dataId).values;return i.disposeIntermediateTensorInfo(p),i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(h),i.disposeIntermediateTensorInfo(b),i.disposeIntermediateTensorInfo(v),i.disposeIntermediateTensorInfo(x),i.disposeIntermediateTensorInfo(C),i.disposeIntermediateTensorInfo(M),i.disposeIntermediateTensorInfo(T),i.disposeIntermediateTensorInfo(N),i.disposeIntermediateTensorInfo(D),i.disposeIntermediateTensorInfo(I),i.disposeIntermediateTensorInfo(P),i.disposeIntermediateTensorInfo($),i.disposeIntermediateTensorInfo(z),i.disposeIntermediateTensorInfo(j),i.disposeIntermediateTensorInfo(G),i.disposeIntermediateTensorInfo(U),i.disposeIntermediateTensorInfo(W),i.disposeIntermediateTensorInfo(H),i.disposeIntermediateTensorInfo(V),i.disposeIntermediateTensorInfo(q),i.disposeIntermediateTensorInfo(X),i.disposeIntermediateTensorInfo(Y),{real:K,imag:J}}const qy={kernelName:O.FFT,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t,i=O.util.sizeFromShape(r.shape),o=r.shape[r.shape.length-1],a=hm({inputs:{x:r},backend:n,attrs:{shape:[i/o,o]}}),s=Wy(a,!1,n),u=hm({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),u}};function Xy(e){const{backend:t,attrs:n}=e,{shape:r,value:i,dtype:o}=n,a=o||O.util.inferDtype(i),s=O.util.getArrayFromDType(a,O.util.sizeFromShape(r));return function(e,t,n){e.fill(t)}(s,i),t.makeTensorInfo(r,a,s)}const Yy={kernelName:O.Fill,backendName:"cpu",kernelFunc:Xy},Ky={kernelName:O.FlipLeftRight,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,i=n,o=O.util.getTypedArrayFromDType(r.dtype,O.util.sizeFromShape(r.shape)),[a,s,u,l]=r.shape,c=i.data.get(r.dataId).values;for(let e=0;e<a;e++){const t=e*u*s*l;for(let e=0;e<s;e++){const n=e*(u*l);for(let e=0;e<u;e++){const r=e*l;for(let i=0;i<l;i++){const a=Math.round(u-e-1),s=t+n+r+i;let p=c[s];a>=0&&a<u&&(p=c[t+n+a*l+i]),o[s]=p}}}}return{dataId:i.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},Jy={kernelName:O.FusedConv2D,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o,bias:a,preluActivationWeights:s}=t,{strides:u,pad:l,dataFormat:c,dilations:p,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=r;let g=ny({inputs:{x:i,filter:o},backend:n,attrs:{strides:u,pad:l,dataFormat:c,dilations:p,dimRoundingMode:d}});if(a){const e=g;if("NCHW"===c&&1===a.shape.length&&1!==a.shape[0]){const e=hm({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});g=Hh({inputs:{a:g,b:e},backend:n}),n.disposeIntermediateTensorInfo(e)}else g=Hh({inputs:{a:g,b:a},backend:n});n.disposeIntermediateTensorInfo(e)}if(h){const e=g;if("NCHW"===c&&"prelu"===h&&1===s.shape.length&&1!==s.shape[0]){const e=hm({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});g=dm(n,g,h,e,f),n.disposeIntermediateTensorInfo(e)}else g=dm(n,g,h,s,f);n.disposeIntermediateTensorInfo(e)}return g}},Zy={kernelName:O.FusedDepthwiseConv2D,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o,bias:a,preluActivationWeights:s}=t,{strides:u,pad:l,dataFormat:c,dilations:p,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=r;let g=by({inputs:{x:i,filter:o},backend:n,attrs:{strides:u,pad:l,dataFormat:c,dilations:p,dimRoundingMode:d}});if(a){const e=g;g=Hh({inputs:{a:g,b:a},backend:n}),n.disposeIntermediateTensorInfo(e)}if(h){const e=g;g=dm(n,g,h,s,f),n.disposeIntermediateTensorInfo(e)}return g}},Qy={kernelName:O.GatherNd,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{params:r,indices:i}=t,o=O.util.sizeFromShape(r.shape),a=i.shape,s=a[a.length-1],[u,l,c,p]=O.backend_util.prepareAndValidate(r,i);if(0===l)return n.makeTensorInfo(u,r.dtype,[]);const d=wf(n.data.get(i.dataId).values,n.bufferSync(r),r.dtype,l,s,c,p,r.shape,o);return n.makeTensorInfo(u,r.dtype,d.values)}},eb={kernelName:O.GatherV2,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,indices:o}=t,{axis:a,batchDims:s}=r;Mh([i,o],"gatherV2");const u=O.util.parseAxisParam(a,i.shape)[0],l=n.data.get(o.dataId).values,c=i.shape[u];for(let e=0;e<l.length;++e){const t=l[e];O.util.assert(t<=c-1&&t>=0,(()=>`GatherV2: the index value ${t} is not in [0, ${c-1}]`))}let p=s;null==s&&(p=0);const d=O.util.sizeFromShape(o.shape),h=O.backend_util.segment_util.collectGatherOpShapeInfo(i,o,u,p),f=hm({inputs:{x:i},backend:n,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),g=hm({inputs:{x:o},backend:n,attrs:{shape:[h.batchSize,d/h.batchSize]}}),m=[h.batchSize,h.outerSize,d/h.batchSize,h.sliceSize],y=n.bufferSync(g),b=kf(n.bufferSync(f),y,m);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(h.outputShape,b.dtype,b.values)}},tb={kernelName:O.IFFT,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t,i=O.util.sizeFromShape(r.shape),o=r.shape[r.shape.length-1],a=hm({inputs:{x:r},backend:n,attrs:{shape:[i/o,o]}}),s=Wy(a,!0,n),u=hm({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),u}},nb=ef(O.IsFinite,(e=>Number.isFinite(e)?1:0),"bool"),rb={kernelName:O.IsFinite,backendName:"cpu",kernelFunc:nb},ib=ef(O.IsInf,(e=>Math.abs(e)===1/0?1:0),"bool"),ob={kernelName:O.IsInf,backendName:"cpu",kernelFunc:ib},ab=ef(O.IsNan,(e=>Number.isNaN(e)?1:0),"bool"),sb={kernelName:O.IsNan,backendName:"cpu",kernelFunc:ab},ub={kernelName:O.LinSpace,backendName:"cpu",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:i,num:o}=n,a=Bf(r,i,o);return t.makeTensorInfo([a.length],"float32",a)}},lb=ef(O.Log1p,(e=>Math.log1p(e))),cb={kernelName:O.Log1p,backendName:"cpu",kernelFunc:lb},pb=Oh(((e,t)=>e&&t)),db=Gh(O.LogicalAnd,pb,null,"bool"),hb={kernelName:O.LogicalAnd,backendName:"cpu",kernelFunc:db},fb=ef(O.LogicalNot,(e=>e?0:1),"bool"),gb={kernelName:O.LogicalNot,backendName:"cpu",kernelFunc:fb},mb=Oh(((e,t)=>e||t)),yb=Gh(O.LogicalOr,mb,null,"bool"),bb={kernelName:O.LogicalOr,backendName:"cpu",kernelFunc:yb},vb={kernelName:O.LRN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:o,bias:a,alpha:s,beta:u}=r;Mh(i,"LRN");const l=i.shape[3],c=l-1,p=n.data.get(i.dataId).values,d=O.util.sizeFromShape(i.shape),h=new Float32Array(d);function f(e){const t=e%l;let n=e-t+Math.max(0,t-o);const r=e-t+Math.min(t+o,c);let i=0;for(;n<=r;n++){const e=p[n];i+=e*e}return i}for(let e=0;e<d;e++){const t=f(e),n=p[e]*Math.pow(a+s*t,-u);h[e]=n}return n.makeTensorInfo(i.shape,i.dtype,h)}},xb={kernelName:O.LRNGrad,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,y:o,dy:a}=t,{depthRadius:s,bias:u,alpha:l,beta:c}=r;Mh(a,"LRNGrad");const p=O.util.sizeFromShape(a.shape),d=a.shape[3],h=n.data.get(a.dataId).values,f=n.data.get(i.dataId).values,g=n.data.get(o.dataId).values,m=new Float32Array(p),y=p;for(let e=0;e<y;e++){const t=e%d,n=e-t+Math.max(0,t-s),r=e-t+Math.min(d,t+s+1);let i=0;for(let e=n;e<r;e++)i+=Math.pow(f[e],2);i=l*i+u;for(let t=n;t<r;t++){let n=-2*l*c*f[t]*g[e]/i;e===t&&(n+=Math.pow(i,-c)),n*=h[e],m[t]+=n}}return n.makeTensorInfo(a.shape,i.dtype,m)}};function _b(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:o,keepDims:a}=r,s=n;let u=i.shape;const l=u.length,c=O.util.parseAxisParam(o,u);let p=c;const d=O.backend_util.getAxesPermutation(p,l);let h=s.data.get(i.dataId).values;if(null!=d){const e=new Array(l);for(let t=0;t<e.length;t++)e[t]=u[d[t]];h=ng(h,u,i.dtype,d,e),p=O.backend_util.getInnerMostAxes(p.length,l),u=e}Mh(i,"max"),O.backend_util.assertAxesAreInnerMostDims("max",p,l);const[f,g]=O.backend_util.computeOutAndReduceShapes(u,p),m=zf(h,O.util.sizeFromShape(g),f,i.dtype),y=s.write(m,f,i.dtype);let b=f;return a&&(b=O.backend_util.expandShapeToKeepDim(f,c)),{dataId:y,shape:b,dtype:i.dtype}}const wb={kernelName:O.Max,backendName:"cpu",kernelFunc:_b},kb={kernelName:O.MaxPool,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;Mh(i,"maxPool");const{filterSize:o,strides:a,pad:s,dimRoundingMode:u}=r;O.util.assert(O.backend_util.eitherStridesOrDilationsAreOne(a,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '1'`));const l=O.backend_util.computePool2DInfo(i.shape,o,a,1,s,u);let c;if(1===l.filterWidth&&1===l.filterHeight&&O.util.arraysEqual(l.inShape,l.outShape))c=Ih({inputs:{x:i},backend:n});else{const e=n.data.get(i.dataId).values,t=O.util.computeStrides(i.shape),r=Pm(e,i.shape,i.dtype,t,l,"max");c=n.makeTensorInfo(l.outShape,i.dtype,r.values)}return c}},Sb={kernelName:O.MaxPool3D,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:o,strides:a,pad:s,dimRoundingMode:u,dataFormat:l}=r;Mh(i,"maxPool3d");const c=O.backend_util.computePool3DInfo(i.shape,o,a,1,s,u,l),p=zm(n.data.get(i.dataId).values,i.shape,i.dtype,O.util.computeStrides(i.shape),c,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}},Cb={kernelName:O.MaxPool3DGrad,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:o}=t,{filterSize:a,strides:s,pad:u,dimRoundingMode:l}=r;Mh([i,o],"maxPool3DGrad");const c=O.backend_util.computePool3DInfo(o.shape,a,s,1,u,l),p=function(e,t){const n=(0,O.buffer)(t.outShape,"int32"),r=t.strideDepth,i=t.strideHeight,o=t.strideWidth,a=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,l=t.effectiveFilterDepth,c=t.effectiveFilterHeight,p=t.effectiveFilterWidth,d=t.padInfo.front,h=t.padInfo.top,f=t.padInfo.left;for(let g=0;g<t.batchSize;++g)for(let m=0;m<t.inChannels;++m)for(let y=0;y<t.outDepth;++y){const b=y*r-d;let v=b;for(;v<0;)v+=a;const x=Math.min(t.inDepth,l+b);for(let r=0;r<t.outHeight;++r){const l=r*i-h;let d=l;for(;d<0;)d+=s;const _=Math.min(t.inHeight,c+l);for(let i=0;i<t.outWidth;++i){const h=i*o-f;let w=h;for(;w<0;)w+=u;const k=Math.min(t.inWidth,p+h);let S=Number.NEGATIVE_INFINITY,C=-1;for(let t=v;t<x;t+=a){const n=t-b;for(let r=d;r<_;r+=s){const i=r-l;for(let o=w;o<k;o+=u){const a=o-h,s=e.get(g,t,r,o,m);s>=S&&(S=s,C=n*c*p+i*c+a)}}}n.set(C,g,y,r,i,m)}}}return n}(n.bufferSync(o),c),d=c.strideDepth,h=c.strideHeight,f=c.strideWidth,g=c.dilationDepth,m=c.dilationHeight,y=c.dilationWidth,b=c.effectiveFilterDepth,v=c.effectiveFilterHeight,x=c.effectiveFilterWidth,_=b-1-c.padInfo.front,w=x-1-c.padInfo.left,k=v-1-c.padInfo.top,S=(0,O.buffer)(o.shape,"float32"),C=n.bufferSync(i);for(let e=0;e<c.batchSize;++e)for(let t=0;t<c.inChannels;++t)for(let n=0;n<c.inDepth;++n)for(let r=0;r<c.inHeight;++r)for(let i=0;i<c.inWidth;++i){const o=n-_,a=r-k,s=i-w;let u=0;for(let n=0;n<b;n+=g){const r=(o+n)/d;if(!(r<0||r>=c.outDepth||Math.floor(r)!==r))for(let i=0;i<v;i+=m){const o=(a+i)/h;if(!(o<0||o>=c.outHeight||Math.floor(o)!==o))for(let a=0;a<x;a+=y){const l=(s+a)/f;if(l<0||l>=c.outWidth||Math.floor(l)!==l)continue;const d=b*v*x-1-p.get(e,r,o,l,t)===n*v*x+i*x+a?1:0;0!==d&&(u+=C.get(e,r,o,l,t)*d)}}}S.set(u,e,n,r,i,t)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}},Mb={kernelName:O.MaxPoolGrad,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:o,output:a}=t,s=o;Mh([o,a],"maxPoolGrad");const{filterSize:u,strides:l,pad:c,dimRoundingMode:p}=r,d=O.backend_util.computePool2DInfo(s.shape,u,l,1,c,p),h=n.data.get(s.dataId).values,f=(0,O.buffer)(d.outShape,s.dtype,$m(h,s.shape,s.dtype,d).values),g=d.strideHeight,m=d.strideWidth,y=d.dilationHeight,b=d.dilationWidth,v=d.effectiveFilterHeight,x=d.effectiveFilterWidth,_=x-1-d.padInfo.left,w=v-1-d.padInfo.top,k=(0,O.buffer)(s.shape,"float32"),S=n.data.get(i.dataId).values,C=(0,O.buffer)(i.shape,"float32",S);for(let e=0;e<d.batchSize;++e)for(let t=0;t<d.inChannels;++t)for(let n=0;n<d.inHeight;++n)for(let r=0;r<d.inWidth;++r){const i=n-w,o=r-_;let a=0;for(let n=0;n<v;n+=y){const r=(i+n)/g;if(!(r<0||r>=d.outHeight||Math.floor(r)!==r))for(let i=0;i<x;i+=b){const s=(o+i)/m;if(s<0||s>=d.outWidth||Math.floor(s)!==s)continue;const u=v*x-1-f.get(e,r,s,t)===n*x+i?1:0;0!==u&&(a+=C.get(e,r,s,t)*u)}}k.set(a,e,n,r,t)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}},Tb={kernelName:O.MaxPoolWithArgmax,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{filterSize:i,strides:o,pad:a,includeBatchInIndex:s}=t,u=n;Mh(r,"MaxPoolWithArgmax");const l=u.data.get(r.dataId).values,c=O.backend_util.computePool2DInfo(r.shape,i,o,[1,1],a),[p,d]=function(e,t,n,r,i){const o=Pm(e,0,n,O.util.computeStrides(t),i,"max"),a=$m(e,t,n,i,!0,r);return[o.values,a.values]}(l,r.shape,r.dtype,s,c),h=u.write(p,c.outShape,r.dtype),f=u.write(d,c.outShape,r.dtype);return[{dataId:h,shape:c.outShape,dtype:r.dtype},{dataId:f,shape:c.outShape,dtype:"int32"}]}},Eb={kernelName:O.Mean,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:a}=r,s=O.util.parseAxisParam(o,i.shape),u=O.backend_util.computeOutAndReduceShapes(i.shape,s)[1],l=O.util.sizeFromShape(u),c=[],p=n.makeTensorInfo([],"float32",new Float32Array([l]));c.push(p);const d=zh({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});c.push(d);const h=Gy({inputs:{a:d,b:p},backend:n});c.push(h);const f=Ty({inputs:{x:h},backend:n,attrs:{axis:o,keepDims:a}});return c.forEach((e=>n.disposeIntermediateTensorInfo(e))),f}},Ab={kernelName:O.Min,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:a}=r;Mh(i,"min");const s=O.util.parseAxisParam(o,i.shape);let u=s;const l=O.backend_util.getAxesPermutation(u,i.shape.length);let c=i;null!=l&&(c=rg({inputs:{x:i},backend:n,attrs:{perm:l}}),u=O.backend_util.getInnerMostAxes(u.length,i.shape.length)),O.backend_util.assertAxesAreInnerMostDims("min",u,c.shape.length);const[p,d]=O.backend_util.computeOutAndReduceShapes(c.shape,u),h=O.util.sizeFromShape(d),f=O.util.makeZerosTypedArray(O.util.sizeFromShape(p),c.dtype),g=n.data.get(c.dataId).values;for(let e=0;e<f.length;++e){const t=e*h;let n=g[t];for(let e=0;e<h;++e){const r=g[t+e];(Number.isNaN(r)||r<n)&&(n=r)}f[e]=n}null!=l&&n.disposeIntermediateTensorInfo(c);const m=n.makeTensorInfo(p,c.dtype,f);if(a){const e=hm({inputs:{x:m},backend:n,attrs:{shape:O.backend_util.expandShapeToKeepDim(p,s)}});return n.disposeIntermediateTensorInfo(m),e}return m}},Fb={kernelName:O.MirrorPad,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:o,mode:a}=r;Mh(i,"mirrorPad");const s=o.map(((e,t)=>e[0]+i.shape[t]+e[1])),u=o.map((e=>e[0])),l=o.map(((e,t)=>e[0]+i.shape[t])),c="reflect"===a?0:1,p=n.data.get(i.dataId).values,d=i.shape.length,h=O.util.computeStrides(i.shape),f=O.util.sizeFromShape(s),g=s.length,m=O.util.computeStrides(s),y=O.util.getTypedArrayFromDType(i.dtype,f);for(let e=0;e<f;e++){let t=O.util.indexToLoc(e,g,m);for(let e=0;e<g;e++)t[e]<u[e]?t[e]=2*u[e]-t[e]-c:t[e]>=l[e]&&(t[e]=2*(l[e]-1)-t[e]+c);t=t.map(((e,t)=>e-u[t]));const n=O.util.locToIndex(t,d,h);y[e]=p[n]}return{dataId:n.write(y,s,i.dtype),shape:s,dtype:i.dtype}}},Ob=Oh(((e,t)=>{const n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),Rb=Gh(O.Mod,Ob),Nb={kernelName:O.Mod,backendName:"cpu",kernelFunc:Rb};function Db(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:o}=r,a=i.shape.length;let s=o;if(-1===s&&(s=a-1),s!==a-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${a} and dim was ${s}`);const u=O.util.parseAxisParam([s],i.shape),l=_b({inputs:{x:i},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),c=O.backend_util.expandShapeToKeepDim(l.shape,u),p=hm({inputs:{x:l},backend:n,attrs:{shape:c}}),d=qg({inputs:{a:i,b:p},backend:n}),h=pf({inputs:{x:d},backend:n}),f=Ty({inputs:{x:h},backend:n,attrs:{axis:u,keepDims:!1}}),g=hm({inputs:{x:f},backend:n,attrs:{shape:c}}),m=Gy({inputs:{a:h,b:g},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),m}const Ib={kernelName:O.Softmax,backendName:"cpu",kernelFunc:Db},Bb={kernelName:O.Multinomial,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:o,seed:a,normalized:s}=r;Mh(i,"multinomial");const u=s?i:Db({inputs:{logits:i},backend:n,attrs:{dim:-1}}),l=u.shape[0],c=u.shape[1],p=n.data.get(u.dataId).values,d=[l,o],h=O.util.makeZerosTypedArray(O.util.sizeFromShape(d),"int32");for(let e=0;e<l;++e){const t=e*c,n=new Float32Array(c-1);n[0]=p[t];for(let e=1;e<n.length;++e)n[e]=n[e-1]+p[t+e];const r=vd.alea(a.toString()),i=e*o;for(let e=0;e<o;++e){const t=r();h[i+e]=n.length;for(let r=0;r<n.length;r++)if(t<n[r]){h[i+e]=r;break}}}return s||n.disposeIntermediateTensorInfo(u),n.makeTensorInfo(d,"int32",h)}},Lb=O.kernel_impls.nonMaxSuppressionV3Impl,Pb={kernelName:O.NonMaxSuppressionV3,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:o}=t,{maxOutputSize:a,iouThreshold:s,scoreThreshold:u}=r;Mh(i,"NonMaxSuppression");const l=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values,{selectedIndices:p}=Lb(l,c,a,s,u);return n.makeTensorInfo([p.length],"int32",new Int32Array(p))}},$b=O.kernel_impls.nonMaxSuppressionV4Impl,zb={kernelName:O.NonMaxSuppressionV4,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:o}=t,{maxOutputSize:a,iouThreshold:s,scoreThreshold:u,padToMaxOutputSize:l}=r;Mh(i,"NonMaxSuppressionPadded");const c=n.data.get(i.dataId).values,p=n.data.get(o.dataId).values,{selectedIndices:d,validOutputs:h}=$b(c,p,a,s,u,l);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}},jb=O.kernel_impls.nonMaxSuppressionV5Impl,Gb={kernelName:O.NonMaxSuppressionV5,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:o}=t,{maxOutputSize:a,iouThreshold:s,scoreThreshold:u,softNmsSigma:l}=r;Mh(i,"NonMaxSuppressionWithScore");const c=n.data.get(i.dataId).values,p=n.data.get(o.dataId).values,d=a,h=s,f=u,g=l,{selectedIndices:m,selectedScores:y}=jb(c,p,d,h,f,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}},Ub={kernelName:O.OneHot,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:o,depth:a,onValue:s,offValue:u}=r;Mh(i,"oneHot");const l=O.util.sizeFromShape(i.shape),c=new Float32Array(l*a);c.fill(u);const p=n.data.get(i.dataId).values;for(let e=0;e<l;++e)p[e]>=0&&p[e]<a&&(c[e*a+p[e]]=s);return n.makeTensorInfo([...i.shape,a],o,c)}};function Wb(e){const{inputs:t,backend:n}=e,{x:r}=t;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){const e=Lh({inputs:{input:r},backend:n}),t=Wb({inputs:{x:e},backend:n}),i=Zm({inputs:{input:r},backend:n}),o=Wb({inputs:{x:i},backend:n}),a=Rh({inputs:{real:t,imag:o},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),a}return Xy({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const Vb={kernelName:O.ZerosLike,backendName:"cpu",kernelFunc:Wb},Hb={kernelName:O.OnesLike,backendName:"cpu",kernelFunc:function e(t){const{inputs:n,backend:r}=t,{x:i}=n;if("string"===i.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===i.dtype){const t=Lh({inputs:{input:i},backend:r}),n=e({inputs:{x:t},backend:r}),o=Zm({inputs:{input:i},backend:r}),a=Wb({inputs:{x:o},backend:r}),s=Rh({inputs:{real:n,imag:a},backend:r});return r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(a),s}return Xy({backend:r,attrs:{shape:i.shape,value:1,dtype:i.dtype}})}};function qb(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(1===t.length)return $y({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const o=t[0].shape,a=t[0].dtype;t.forEach((e=>{O.util.assertShapesMatch(o,e.shape,"All tensors passed to stack must have matching shapes"),O.util.assert(a===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const s=[],u=ey({inputs:t.map((e=>{const t=$y({inputs:{input:e},backend:n,attrs:{dim:i}});return s.push(t),t})),backend:n,attrs:{axis:i}});return s.forEach((e=>n.disposeIntermediateTensorInfo(e))),u}const Xb={kernelName:O.Pack,backendName:"cpu",kernelFunc:qb},Yb={kernelName:O.PadV2,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:o,constantValue:a}=r;Mh(i,"pad");const s=o.map(((e,t)=>e[0]+i.shape[t]+e[1])),u=o.map((e=>e[0])),l=n.data.get(i.dataId).values,c=O.util.sizeFromShape(i.shape),p=i.shape.length,d=O.util.computeStrides(i.shape),h=O.util.sizeFromShape(s),f=s.length,g=O.util.computeStrides(s),m=O.util.getTypedArrayFromDType(i.dtype,h);0!==a&&m.fill(a);for(let e=0;e<c;e++){const t=O.util.indexToLoc(e,p,d).map(((e,t)=>e+u[t]));m[O.util.locToIndex(t,f,g)]=l[e]}return{dataId:n.write(m,s,i.dtype),shape:s,dtype:i.dtype}}},Kb=Oh(((e,t)=>Math.pow(e,t))),Jb=Gh(O.Pow,Kb),Zb={kernelName:O.Pow,backendName:"cpu",kernelFunc:Jb},Qb={kernelName:O.RaggedGather,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:o,indices:a}=t,{outputRaggedRank:s}=r,u=i.map((e=>n.data.get(e.dataId).values)),l=i.map((e=>e.shape)),c=n.data.get(o.dataId).values,p=n.data.get(a.dataId).values,[d,h,f]=ug(u,l,c,o.shape,o.dtype,p,a.shape),g=d.map((e=>n.makeTensorInfo([e.length],"int32",e))),m=n.makeTensorInfo(f,o.dtype,h);return g.concat([m])}},ev={kernelName:O.RaggedRange,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:o}=t,a=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,[l,c]=cg(a,r.shape,r.dtype,s,i.shape,u,o.shape);return[n.makeTensorInfo([l.length],"int32",l),n.makeTensorInfo([c.length],r.dtype,c)]}},tv={kernelName:O.RaggedTensorToTensor,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{shape:i,values:o,defaultValue:a,rowPartitionTensors:s}=t,{rowPartitionTypes:u}=r,l=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values,p=n.data.get(a.dataId).values,d=s.map((e=>n.data.get(e.dataId).values)),h=s.map((e=>e.shape)),[f,g]=gg(l,i.shape,c,o.shape,o.dtype,p,a.shape,d,h,u);return n.makeTensorInfo(f,o.dtype,g)}},nv={kernelName:O.Range,backendName:"cpu",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:i,dtype:o,step:a}=n,s=mg(r,i,a,o);return t.makeTensorInfo([s.length],o,s)}},rv=ef(O.Reciprocal,(e=>1/e)),iv={kernelName:O.Reciprocal,backendName:"cpu",kernelFunc:rv},ov={kernelName:O.ResizeBilinear,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:o,halfPixelCenters:a,size:s}=r;Mh(i,"resizeBilinear");const u=O.util.computeStrides(i.shape),[l,c]=s,[p,d,h,f]=i.shape,g=n.data.get(i.dataId).values,m=new Float32Array(O.util.sizeFromShape([p,l,c,f])),y=[o&&l>1?d-1:d,o&&c>1?h-1:h],b=[o&&l>1?l-1:l,o&&c>1?c-1:c];let v=0;const x=y[0]/b[0],_=y[1]/b[1];for(let e=0;e<p;e++)for(let t=0;t<l;t++){let n;n=a?x*(t+.5)-.5:x*t;const r=Math.max(0,Math.floor(n)),i=n-r,o=Math.min(d-1,Math.ceil(n)),s=e*u[0]+r*u[1],l=e*u[0]+o*u[1];for(let e=0;e<c;e++){let t;t=a?_*(e+.5)-.5:_*e;const n=Math.max(0,Math.floor(t)),r=t-n,o=Math.min(h-1,Math.ceil(t)),c=s+n*u[2],p=l+n*u[2],d=s+o*u[2],y=l+o*u[2];for(let e=0;e<f;e++){const t=g[c+e],n=g[p+e],o=t+(g[d+e]-t)*r,a=o+(n+(g[y+e]-n)*r-o)*i;m[v++]=a}}}return n.makeTensorInfo([p,l,c,f],"float32",m)}},av={kernelName:O.ResizeBilinearGrad,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:o}=t,{alignCorners:a}=r;Mh([o,i],"resizeBilinearGrad");const s=O.util.computeStrides(i.shape),[u,l,c,p]=i.shape,[,d,h]=o.shape,f=new Float32Array(u*l*c*p),g=[a&&d>1?l-1:l,a&&h>1?c-1:c],m=[a&&d>1?d-1:d,a&&h>1?h-1:h],y=g[0]/m[0],b=g[1]/m[1],v=n.data.get(o.dataId).values;let x=0;for(let e=0;e<u;e++){const t=e*s[0];for(let e=0;e<d;e++){const n=e*y,r=Math.floor(n),i=Math.min(Math.ceil(n),l-1),o=t+r*s[1],a=t+i*s[1],u=n-r,d=1-u;for(let e=0;e<h;e++){const t=e*b,n=Math.floor(t),r=Math.min(Math.ceil(t),c-1),i=t-n,l=1-i,h=o+n*s[2],g=o+r*s[2],m=a+n*s[2],y=a+r*s[2],_=d*l,w=d*i,k=u*l,S=u*i;for(let e=0;e<p;e++){const t=v[x++];f[h+e]+=t*_,f[g+e]+=t*w,f[m+e]+=t*k,f[y+e]+=t*S}}}}return n.makeTensorInfo([u,c,l,p],"float32",f)}},sv={kernelName:O.ResizeNearestNeighbor,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:o,halfPixelCenters:a,size:s}=r;Mh(i,"resizeNearestNeighbor");const u=O.util.computeStrides(i.shape),[l,c]=s,[p,d,h,f]=i.shape,g=n.data.get(i.dataId).values,m=new Float32Array(p*l*c*f),y=[o&&l>1?d-1:d,o&&c>1?h-1:h],b=[o&&l>1?l-1:l,o&&c>1?c-1:c],v=y[0]/b[0],x=y[1]/b[1];let _=0;for(let e=0;e<p;e++){const t=e*u[0];for(let e=0;e<l;e++){const n=a?v*(e+.5):v*e;let r=Math.min(d-1,o?Math.round(n):Math.floor(n));a&&(r=Math.max(0,r));const i=t+r*u[1];for(let e=0;e<c;e++){const t=a?x*(e+.5):x*e;let n=Math.min(h-1,o?Math.round(t):Math.floor(t));a&&(n=Math.max(0,n));const r=i+n*u[2];for(let e=0;e<f;e++){const t=g[r+e];m[_++]=t}}}}return n.makeTensorInfo([p,l,c,f],i.dtype,m)}},uv={kernelName:O.ResizeNearestNeighborGrad,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:o}=t,{alignCorners:a}=r;Mh([o,i],"resizeNearestNeighborGrad");const s=O.util.computeStrides(i.shape),u=O.util.computeStrides(o.shape),[l,c,p,d]=i.shape,[,h,f]=o.shape,g=new Float32Array(l*c*p*d),m=n.data.get(o.dataId).values,y=[a&&h>1?c-1:c,a&&f>1?p-1:p],b=[a&&h>1?h-1:h,a&&f>1?f-1:f],v=y[0]/b[0],x=y[1]/b[1],_=1/v,w=1/x,k=2*Math.ceil(_)+2,S=2*Math.ceil(w)+2;for(let e=0;e<l;e++){const t=e*s[0];for(let e=0;e<c;e++){const n=t+e*s[1],r=Math.floor(e*_),i=Math.floor(r-k/2);for(let r=0;r<p;r++){const o=n+r*s[2],l=Math.floor(r*w),y=Math.floor(l-S/2);for(let n=0;n<d;n++){let s=0;for(let o=0;o<k;o++){const l=o+i;if(l<0||l>=h)continue;const d=t+l*u[1],g=l*v;if(e===Math.min(c-1,a?Math.round(g):Math.floor(g)))for(let e=0;e<S;e++){const t=e+y;if(t<0||t>=f)continue;const i=d+t*u[2],o=t*x;r===Math.min(p-1,a?Math.round(o):Math.floor(o))&&(s+=m[i+n])}}g[o+n]=s}}}}return n.makeTensorInfo(i.shape,i.dtype,g)}},lv={kernelName:O.Reverse,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:o}=r;Mh(i,"reverse");const a=i.shape.length,s=O.util.parseAxisParam(o,i.shape);if(0===a)return Ih({inputs:{x:i},backend:n});const u=new O.TensorBuffer(i.shape,i.dtype),l=n.bufferSync(i);for(let e=0;e<u.size;e++){const t=u.indexToLoc(e),n=t.slice();s.forEach((e=>n[e]=i.shape[e]-1-n[e])),u.set(l.get(...n),...t)}return n.makeTensorInfo(u.shape,u.dtype,u.values)}},cv={kernelName:O.RotateWithOffset,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,{radians:i,fillValue:o,center:a}=t,s=n,u=O.util.getTypedArrayFromDType(r.dtype,O.util.sizeFromShape(r.shape)),[l,c,p,d]=r.shape,[h,f]=O.backend_util.getImageCenter(a,c,p),g=Math.sin(i),m=Math.cos(i),y=s.data.get(r.dataId).values;for(let e=0;e<l;e++){const t=e*p*c*d;for(let e=0;e<c;e++){const n=e*(p*d);for(let r=0;r<p;r++){const i=r*d;for(let a=0;a<d;a++){const s=[l,e,r,a],b=s[2],v=s[1];let x=(b-h)*m-(v-f)*g,_=(b-h)*g+(v-f)*m;x=Math.round(x+h),_=Math.round(_+f);let w=o;"number"!=typeof o&&(w=3===a?255:o[a]),x>=0&&x<p&&_>=0&&_<c&&(w=y[t+_*(p*d)+x*d+a]),u[t+n+i+a]=w}}}}return{dataId:s.write(u,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},pv=ef(O.Round,(e=>{const t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2==0?t:t+1})),dv={kernelName:O.Round,backendName:"cpu",kernelFunc:pv},hv={kernelName:O.ScatterNd,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:o}=t,{shape:a}=r,{sliceRank:s,numUpdates:u,sliceSize:l,strides:c,outputSize:p}=O.backend_util.calculateShapes(o,i,a),d=xg(n.bufferSync(i),n.bufferSync(o),a,p,l,u,s,c,0,!0);return n.makeTensorInfo(a,d.dtype,d.values)}};function fv(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<t?n=i+1:r=i;return r}function gv(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<=t?n=i+1:r=i;return r}const mv={kernelName:O.SearchSorted,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:o}=t,{side:a}=r,s=function(e,t,n,r,i,o){const a=O.util.getArrayFromDType("int32",n*i);for(let s=0;s<n;++s){const n=e.slice(s*r,(s+1)*r),u=s*i;for(let e=0;e<i;++e)a[u+e]="left"===o?fv(n,t[e+u]):gv(n,t[e+u])}return a}(n.data.get(i.dataId).values,n.data.get(o.dataId).values,i.shape[0],i.shape[1],o.shape[1],a);return n.makeTensorInfo(o.shape,"int32",s)}},yv={kernelName:O.Select,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:r,t:i,e:o}=t;Mh([r,i,o],"select");const a=r.shape.length,s=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,c=(0,O.upcastType)(i.dtype,o.dtype),p=O.util.makeZerosTypedArray(O.util.sizeFromShape(i.shape),c);let d=0;const h=0===a||a>1||1===i.shape.length?1:O.util.sizeFromShape(i.shape.slice(1));for(let e=0;e<s.length;e++)for(let t=0;t<h;t++)1===s[e]?p[d++]=u[e]:p[d++]=l[e];return n.makeTensorInfo(i.shape,c,p)}},bv=O.backend_util.SELU_SCALEALPHA,vv=O.backend_util.SELU_SCALE,xv=ef(O.Selu,(e=>e>=0?vv*e:bv*(Math.exp(e)-1))),_v={kernelName:O.Selu,backendName:"cpu",kernelFunc:xv},wv=ef(O.Sign,(e=>e<0?-1:e>0?1:0)),kv={kernelName:O.Sign,backendName:"cpu",kernelFunc:wv},Sv=ef(O.Sin,(e=>Math.sin(e))),Cv={kernelName:O.Sin,backendName:"cpu",kernelFunc:Sv},Mv=ef(O.Sinh,(e=>Math.sinh(e))),Tv={kernelName:O.Sinh,backendName:"cpu",kernelFunc:Mv},Ev=Math.log(1.1920928955078125e-7)+2,Av=ef(O.Softplus,(e=>{const t=e>-Ev,n=e<Ev,r=Math.exp(e);let i;return i=n?r:t?e:Math.log(1+r),i})),Fv={kernelName:O.Softplus,backendName:"cpu",kernelFunc:Av},Ov={kernelName:O.SpaceToBatchND,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:o,paddings:a}=r;Mh([i],"spaceToBatchND");const s=O.util.sizeFromShape(o),u=[[0,0]];u.push(...a);for(let e=1+o.length;e<i.shape.length;++e)u.push([0,0]);const l=Yb.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:u,constantValue:0}}),c=O.backend_util.getReshaped(l.shape,o,s,!1),p=O.backend_util.getPermuted(c.length,o.length,!1),d=O.backend_util.getReshapedPermuted(l.shape,o,s,!1),h=hm({inputs:{x:l},backend:n,attrs:{shape:c}}),f=rg({inputs:{x:h},backend:n,attrs:{perm:p}}),g=hm({inputs:{x:f},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),g}},Rv={kernelName:O.SparseFillEmptyRows,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:o,defaultValue:a}=t;if(1!==o.shape.length)throw new Error(`Dense shape must be a vector, saw:\n        ${o.shape}`);if(2!==r.shape.length)throw new Error(`Indices must be a matrix, saw:\n        ${r.shape}`);if(1!==i.shape.length)throw new Error(`Values must be a vector, saw:\n        ${i.shape}`);if(0!==a.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${a.shape}`);const s=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,c=n.data.get(a.dataId).values[0],[p,d,h,f,g]=Tg(s,r.shape,r.dtype,u,i.dtype,l,c);return[n.makeTensorInfo(d,r.dtype,p),n.makeTensorInfo([d[0]],i.dtype,h),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map((e=>Number(e))))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}},Nv={kernelName:O.SparseReshape,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:o}=t;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape\n        ${r.shape}`);if(1!==i.shape.length)throw new Error(`Input shape should be a vector but received shape\n        ${i.shape}`);if(1!==o.shape.length)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const a=Array.from(n.data.get(i.dataId).values),s=n.data.get(r.dataId).values,u=Array.from(n.data.get(o.dataId).values),[l,c,p]=Eg(s,r.shape,r.dtype,a,u);return[n.makeTensorInfo(c,r.dtype,l),n.makeTensorInfo([p.length],o.dtype,new Int32Array(p))]}},Dv={kernelName:O.SparseSegmentMean,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:o}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n          ${i.shape}`);if(1!==o.shape.length)throw new Error(`Segment ids should be a vector but received shape\n          ${o.shape}`);if(i.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const a=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,[l,c]=Ag(a,r.shape,r.dtype,s,u,!0);return n.makeTensorInfo(c,r.dtype,l)}},Iv={kernelName:O.SparseSegmentSum,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:o}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n         ${i.shape}`);if(1!==o.shape.length)throw new Error(`Segment ids should be a vector but received shape\n         ${o.shape}`);if(i.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const a=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,[l,c]=Ag(a,r.shape,r.dtype,s,u);return n.makeTensorInfo(c,r.dtype,l)}},Bv={kernelName:O.SparseToDense,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:o,defaultValue:a}=t,{outputShape:s}=r,{sliceRank:u,numUpdates:l,sliceSize:c,strides:p,outputSize:d}=O.backend_util.calculateShapes(o,i,s),h=!1,f=n.bufferSync(i);let g;switch(o.dtype){case"bool":g=xg(f,n.bufferSync(o),s,d,c,l,u,p,Boolean(n.data.get(a.dataId).values[0]),h);break;case"float32":case"int32":g=xg(f,n.bufferSync(o),s,d,c,l,u,p,n.data.get(a.dataId).values[0],h);break;case"string":g=xg(f,n.bufferSync(o),s,d,c,l,u,p,O.util.decodeString(n.data.get(a.dataId).values[0]),h);break;default:throw new Error(`Unsupported type ${o.dtype}`)}return n.makeTensorInfo(s,g.dtype,g.values)}},Lv={kernelName:O.SplitV,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:o,axis:a}=r,s=O.util.parseAxisParam(a,i.shape)[0],u=O.backend_util.prepareSplitSize(i,o,s),l=new Array(i.shape.length).fill(0),c=i.shape.slice();return u.map((e=>{const t=[...c];t[s]=e;const r=Cg({inputs:{x:i},backend:n,attrs:{begin:l,size:t}});return l[s]+=e,r}))}},Pv={kernelName:O.Square,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{const{x:n}=e,r=t;Mh(n,"square");const i=r.data.get(n.dataId).values,o=new Float32Array(i.length);for(let e=0;e<i.length;++e){const t=i[e];o[e]=t*t}return{dataId:r.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},$v=ef(O.Step,((e,t)=>{const n=t;return isNaN(e)?NaN:e>0?1:n.alpha})),zv={kernelName:O.Step,backendName:"cpu",kernelFunc:$v},jv={kernelName:O.StridedSlice,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:o,end:a,strides:s,beginMask:u,endMask:l,ellipsisMask:c,newAxisMask:p,shrinkAxisMask:d}=r;Mh(i,"stridedSlice");const{finalShapeSparse:h,finalShape:f,isIdentity:g,sliceDim0:m,isSimpleSlice:y,begin:b,end:v,strides:x}=O.slice_util.sliceInfo(i.shape,o,a,s,u,l,c,p,d);let _;if(g)_=hm({inputs:{x:i},backend:n,attrs:{shape:f}});else if(m||y){O.util.assert(i.shape.length>=1,(()=>`Input must have rank at least 1, got: ${i.shape.length}`));const e=O.slice_util.computeOutShape(b,v,x),t=Cg({inputs:{x:i},backend:n,attrs:{begin:b,size:e}});_=hm({inputs:{x:t},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(t)}else{const e=$g(h,n.bufferSync(i),x,b);_=n.makeTensorInfo(f,e.dtype,e.values)}return _}},Gv={kernelName:O.StringNGrams,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:o,leftPad:a,rightPad:s,padWidth:u,preserveShortSequences:l}=r,{data:c,dataSplits:p}=t,d=n.data.get(c.dataId).values,h=n.data.get(p.dataId).values,[f,g]=jg(d,h,i,o,a,s,u,l);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(p.shape,"int32",g)]}},Uv={kernelName:O.StringSplit,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:o,delimiter:a}=t;if("string"!==o.dtype)throw new Error("Input must be of datatype string");if(1!==o.shape.length)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(0!==a.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const s=n.data.get(o.dataId).values,u=n.data.get(a.dataId).values[0],[l,c,p]=Ug(s,u,i),d=c.length;return[n.makeTensorInfo([d,2],"int32",l),n.makeTensorInfo([d],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(p))]}},Wv={kernelName:O.StringToHashBucketFast,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:o}=t;if("string"!==o.dtype)throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const a=Wg(n.data.get(o.dataId).values,i);return n.makeTensorInfo(o.shape,"int32",a)}},Vv=ef(O.Tan,(e=>Math.tan(e))),Hv={kernelName:O.Tan,backendName:"cpu",kernelFunc:Vv},qv=ef(O.Tanh,(e=>Math.tanh(e))),Xv={kernelName:O.Tanh,backendName:"cpu",kernelFunc:qv},Yv={kernelName:O.TensorScatterUpdate,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{tensor:r,indices:i,updates:o}=t,{sliceRank:a,numUpdates:s,sliceSize:u,strides:l,outputSize:c}=O.backend_util.calculateShapes(o,i,r.shape),p=n.bufferSync(i),d=n.bufferSync(o),h=n.bufferSync(r),f=xg(p,d,r.shape,c,u,s,a,l,h,!1);return n.makeTensorInfo(r.shape,f.dtype,f.values)}},Kv={kernelName:O.Tile,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:o}=r;Mh(i,"tile");const a=Yg(n.bufferSync(i),o);return n.makeTensorInfo(a.shape,a.dtype,a.values)}},Jv={kernelName:O.TopK,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:o,sorted:a}=r;Mh(i,"topk");const s=n.data.get(i.dataId).values,[u,l]=Zg(s,i.shape,i.dtype,o,a);return[n.makeTensorInfo(u.shape,u.dtype,u.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}},Zv={kernelName:O.Transform,backendName:"cpu",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{image:i,transforms:o}=t,{interpolation:a,fillMode:s,fillValue:u,outputShape:l}=n,[c,p,d,h]=i.shape,[f,g]=null!=l?l:[p,d],m=[c,f,g,h],y=O.util.computeStrides(i.shape),b=y[0],v=y[1],x=y[2],_=O.util.computeStrides(m),w=_[0],k=_[1],S=_[2],C=O.util.getTypedArrayFromDType(i.dtype,O.util.sizeFromShape(m));C.fill(u);const M=r.data.get(i.dataId).values,T=r.data.get(o.dataId).values;for(let e=0;e<c;++e){const t=1===o.shape[0]?T:T.subarray(8*e,8*e+8);for(let n=0;n<f;++n)for(let r=0;r<g;++r)for(let i=0;i<h;++i){let o;const l=t[6]*r+t[7]*n+1;if(0===l)continue;const c=(t[0]*r+t[1]*n+t[2])/l,h=(t[3]*r+t[4]*n+t[5])/l,f=Qv(c,d,s),g=Qv(h,p,s);switch(a){case"nearest":o=tx(M,p,d,b,v,x,e,g,f,i,u);break;case"bilinear":o=nx(M,p,d,b,v,x,e,g,f,i,u);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${a}`)}C[e*w+n*k+r*S+i]=o}return r.makeTensorInfo(m,i.dtype,C)}return{dataId:r.write(C,m,i.dtype),shape:i.shape,dtype:i.dtype}}};function Qv(e,t,n){switch(n){case"reflect":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const e=2*t;n<e&&(n=e*Math.trunc(-n/e)+n),n=n<-t?n+e:-n-1}else if(n>t-1)if(t<=1)n=0;else{const e=2*t;n-=e*Math.trunc(n/e),n>=t&&(n=e-n-1)}return O.util.clamp(0,n,t-1)}(e,t);case"wrap":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const e=t-1;n+=t*(Math.trunc(-n/e)+1)}else if(n>t-1)if(t<=1)n=0;else{const e=t-1;n-=t*Math.trunc(n/e)}return O.util.clamp(0,n,t-1)}(e,t);case"nearest":return function(e,t){return O.util.clamp(0,e,t-1)}(e,t);default:return function(e,t){return e}(e)}}function ex(e,t,n,r,i,o,a,s,u,l,c){return 0<=s&&s<t&&0<=u&&u<n?e[a*r+s*i+u*o+l]:c}function tx(e,t,n,r,i,o,a,s,u,l,c){return ex(e,t,n,r,i,o,a,Math.round(s),Math.round(u),l,c)}function nx(e,t,n,r,i,o,a,s,u,l,c){const p=Math.floor(s),d=Math.floor(u),h=p+1,f=d+1;return(h-s)*((f-u)*ex(e,t,n,r,i,o,a,p,d,l,c)+(u-d)*ex(e,t,n,r,i,o,a,p,f,l,c))+(s-p)*((f-u)*ex(e,t,n,r,i,o,a,h,d,l,c)+(u-d)*ex(e,t,n,r,i,o,a,h,f,l,c))}const rx={kernelName:O.Unique,backendName:"cpu",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:o}=t;Mh(o,"unique");const a=r.data.get(o.dataId).values,{outputValues:s,outputShape:u,indices:l}=Qg(a,i,o.shape,o.dtype);return[r.makeTensorInfo(u,o.dtype,s),r.makeTensorInfo([l.length],"int32",l)]}},ix={kernelName:O.Unpack,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:i}=t;let{axis:o}=r;o<0&&(o+=i.shape.length);const a=i.shape.length,s=i.shape[o],u=new Array(a-1);let l=0;for(let e=0;e<a;e++)e!==o&&(u[l++]=i.shape[e]);const c=new Array(a).fill(0),p=i.shape.slice();p[o]=1;const d=new Array(s);for(let e=0;e<d.length;e++){c[o]=e;const t=Cg({inputs:{x:i},backend:n,attrs:{begin:c,size:p}});d[e]=hm({inputs:{x:t},backend:n,attrs:{shape:u}}),n.disposeIntermediateTensorInfo(t)}return d}},ox={kernelName:O.UnsortedSegmentSum,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:o}=t,{numSegments:a}=r;Mh(i,"unsortedSegmentSum");const s=[],u=[],l=i.shape.length-o.shape.length;let c=o;for(let e=0;e<l;++e){const t=$y({inputs:{input:c},backend:n,attrs:{dim:e+1}});c=t,u.push(t)}for(let e=0;e<a;++e){const t=O.util.createScalarValue(e,"int32"),r=n.makeTensorInfo([],"int32",t),o=uf({inputs:{a:r,b:c},backend:n}),a=zh({inputs:{x:o},backend:n,attrs:{dtype:"float32"}}),l=Yf({inputs:{a,b:i},backend:n}),p=Ty({inputs:{x:l},backend:n,attrs:{axis:0,keepDims:!1}});s.push(p),u.push(r),u.push(o),u.push(a),u.push(l),u.push(p)}const p=qb({inputs:s,backend:n,attrs:{axis:0}});return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),p}},ax=[ym,Fh,vm,_m,qh,wm,km,Sm,Cm,Mm,Em,Fm,Rm,Im,Lm,jm,Gm,Um,Wm,mm,Vm,Hm,qm,Zh,Xm,jh,of,Km,Nh,Jm,ty,ry,iy,oy,ay,sy,uy,cy,dy,hy,fy,gy,my,yy,vy,xy,_y,wy,ky,Sy,Cy,My,Ay,nm,Fy,lf,Py,df,zy,gf,qy,Yy,Ky,bf,_f,Jy,Zy,Qy,eb,Mf,Af,Bh,tb,Qm,rb,ob,sb,im,Rf,If,ub,$f,cb,hb,gb,bb,vb,xb,wb,Uf,kb,Sb,Cb,Mb,Tb,Eb,Ab,Hf,Fb,Nb,Bb,Kf,Zf,Pb,zb,Gb,tg,Ub,Hb,Xb,Yb,Zb,sm,ag,Qb,ev,tv,nv,Ph,Uy,iv,lm,pm,fm,ov,av,sv,uv,lv,cv,dv,vg,hv,mv,yv,_v,kg,kv,Cv,Tv,Mg,Ib,Fv,Ov,Rv,Nv,Dv,Iv,Bv,Lv,Rg,Pv,Ig,Pg,zv,jv,Gv,Uv,Wv,Xg,Ey,Hv,Xv,Yv,Kv,Jv,Zv,ig,rx,ix,ox,Vb];for(const e of ax)(0,O.registerKernel)(e);const sx={},ux={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function lx(e,t){sx[e]=t}function cx(e,t){if(!(e in sx)||null!=t){const n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=null==t?function(e){if((0,O.env)().getBool("IS_SAFARI")||"undefined"==typeof OffscreenCanvas||2!==e){if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}(e):t;return n.addEventListener("webglcontextlost",(t=>{t.preventDefault(),delete sx[e]}),!1),(0,O.env)().getBool("SOFTWARE_WEBGL_ENABLED")&&(ux.failIfMajorPerformanceCaveat=!1),1===e?n.getContext("webgl",ux)||n.getContext("experimental-webgl",ux):n.getContext("webgl2",ux)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;sx[e]=n}const n=sx[e];return null==n||n.isContextLost()?(delete sx[e],cx(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),sx[e])}var px,dx,hx;function fx(e,t){return[t,e]}function gx(e){const t=O.util.sizeFromShape(e),n=Math.ceil(t/4);return O.util.sizeToSquarishShape(n)}function mx(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function yx(e,t){const n=e;let r,i,o,a,s,u,l,c,p,d;return 2===(0,O.env)().getNumber("WEBGL_VERSION")?(r=n.R32F,i=n.R16F,o=n.RGBA16F,a=n.RGBA32F,s=n.RED,l=4,c=1,p=n.HALF_FLOAT,d=n.FLOAT,u=n.RGBA8):(r=e.RGBA,i=e.RGBA,o=e.RGBA,a=n.RGBA,s=e.RGBA,l=4,c=4,p=null!=t?t.HALF_FLOAT_OES:null,d=e.FLOAT,u=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:a,textureFormatFloat:s,downloadTextureFormat:u,downloadUnpackNumChannels:l,defaultNumChannels:c,textureTypeHalfFloat:p,textureTypeFloat:d}}function bx(e,t){const n=t();return(0,O.env)().getBool("DEBUG")&&function(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+wx(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(px||(px={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(dx||(dx={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(hx||(hx={}));const vx=5.96e-8,xx=65504;function _x(e){return!!((0,O.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||vx<Math.abs(e)&&Math.abs(e)<xx)}function wx(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function kx(e,t){return Xx(e,(()=>e.getExtension(t)),'Extension "'+t+'" not supported on this browser.')}function Sx(e,t){const n=Xx(e,(()=>e.createShader(e.VERTEX_SHADER)),"Unable to create vertex WebGLShader.");if(bx(e,(()=>e.shaderSource(n,t))),bx(e,(()=>e.compileShader(n))),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function Cx(e,t){const n=Xx(e,(()=>e.createShader(e.FRAGMENT_SHADER)),"Unable to create fragment WebGLShader.");if(bx(e,(()=>e.shaderSource(n,t))),bx(e,(()=>e.compileShader(n))),(0,O.env)().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw Tx(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const Mx=/ERROR: [0-9]+:([0-9]+):/g;function Tx(e,t){const n=Mx.exec(t);if(null==n)return console.log(`Couldn't parse line number in error: ${t}`),void console.log(e);const r=+n[1],i=e.split("\n"),o=i.length.toString().length+2,a=i.map(((e,t)=>O.util.rightPad((t+1).toString(),o)+e));let s=0;for(let e=0;e<a.length;e++)s=Math.max(a[e].length,s);const u=a.slice(0,r-1),l=a.slice(r-1,r),c=a.slice(r);console.log(u.join("\n")),console.log(t.split("\n")[0]),console.log(`%c ${O.util.rightPad(l[0],s)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join("\n"))}function Ex(e){return Xx(e,(()=>e.createProgram()),"Unable to create WebGLProgram.")}function Ax(e,t){if(bx(e,(()=>e.linkProgram(t))),!(0,O.env)().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function Fx(e,t){if(bx(e,(()=>e.validateProgram(t))),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function Ox(e,t){const n=Xx(e,(()=>e.createBuffer()),"Unable to create WebGLBuffer");return bx(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,n))),bx(e,(()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW))),n}function Rx(e,t){const n=Xx(e,(()=>e.createBuffer()),"Unable to create WebGLBuffer");return bx(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n))),bx(e,(()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW))),n}function Nx(){return 2===(0,O.env)().getNumber("WEBGL_VERSION")?1:4}function Dx(e){return Xx(e,(()=>e.createTexture()),"Unable to create WebGLTexture.")}function Ix(e,t){const n=(0,O.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0)throw new Error(`Requested texture size [${e}x${t}] is invalid.`);if(e>n||t>n)throw new Error(`Requested texture size [${e}x${t}] greater than WebGL maximum on this browser / GPU [${n}x${n}].`)}function Bx(e){return Xx(e,(()=>e.createFramebuffer()),"Unable to create WebGLFramebuffer.")}function Lx(e,t,n,r,i,o,a){const s=e.getAttribLocation(t,n);return-1!==s&&(bx(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,r))),bx(e,(()=>e.vertexAttribPointer(s,i,e.FLOAT,!1,o,a))),bx(e,(()=>e.enableVertexAttribArray(s))),!0)}function Px(e,t,n){Yx(e,n),bx(e,(()=>e.activeTexture(e.TEXTURE0+n))),bx(e,(()=>e.bindTexture(e.TEXTURE_2D,t)))}function $x(e,t){Yx(e,t),bx(e,(()=>e.activeTexture(e.TEXTURE0+t))),bx(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}function zx(e,t,n){return Xx(e,(()=>e.getUniformLocation(t,n)),'uniform "'+n+'" not present in program.')}function jx(e,t,n){return e.getUniformLocation(t,n)}function Gx(e,t,n,r){bx(e,(()=>Px(e,t,r))),bx(e,(()=>e.uniform1i(n,r)))}function Ux(e){bx(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,null))),bx(e,(()=>e.viewport(0,0,e.canvas.width,e.canvas.height))),bx(e,(()=>e.scissor(0,0,e.canvas.width,e.canvas.height)))}function Wx(e,t,n){bx(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,n))),bx(e,(()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)))}function Vx(e,t){bx(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,t))),bx(e,(()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)))}function Hx(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+qx(e,t))}function qx(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function Xx(e,t,n){const r=bx(e,(()=>t()));if(null==r)throw new Error(n);return r}function Yx(e,t){const n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error(`textureUnit must be in [gl.TEXTURE0, gl.TEXTURE${n}].`)}function Kx(e,t=2){return O.util.sizeFromShape(e.slice(0,e.length-t))}function Jx(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Zx(e){let t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[Kx(e),...Jx(e)]),t}function Qx(e,t=!1){let n=(0,O.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=(0,O.env)().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&(0,O.env)().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n*=2,r*=2,1===(e=e.map(((t,n)=>n>=e.length-2?O.util.nearestLargerEven(e[n]):e[n]))).length&&(e=[2,e[0]])),2!==e.length){const t=O.util.squeezeShape(e);e=t.newShape}let i=O.util.sizeFromShape(e),o=null;e.length<=1&&i<=n?o=[1,i]:2===e.length&&e[0]<=n&&e[1]<=n?o=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?o=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?o=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?o=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(o=[e[0],e[1]*e[2]*e[3]]);const a=null!=o&&Math.max(...o)>r&&Math.min(...o)<=(t?2:1)&&Math.min(...o)>0;if(null==o||a)if(t){const t=Kx(e);let n=2,r=2;e.length&&([n,r]=Jx(e)),i=t*(n/2)*(r/2),o=O.util.sizeToSquarishShape(i).map((e=>2*e))}else o=O.util.sizeToSquarishShape(i);return o}function e_(e){return e%2==0}function t_(e,t){if(e=e.slice(-2),t=t.slice(-2),O.util.arraysEqual(e,t))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){const n=e[e.length-1],r=t[t.length-1];if(n===r)return!0;if(e_(n)&&e_(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&e_(e[0])&&e_(t[0])}let n_,r_;function i_(e){if(null==n_){const t=cx(e);n_=t.getParameter(t.MAX_TEXTURE_SIZE)}return n_}function o_(){n_=null}function a_(){r_=null}function s_(e){if(null==r_){const t=cx(e);r_=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,r_)}function u_(e){if(0===e)return 0;let t;const n=cx(e);return t=l_(n,"EXT_disjoint_timer_query_webgl2")&&2===e?2:l_(n,"EXT_disjoint_timer_query")?1:0,t}function l_(e,t){return null!=e.getExtension(t)}function c_(e){try{if(null!=cx(e))return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function p_(e){if(0===e)return!1;const t=cx(e);if(1===e){if(!l_(t,"OES_texture_float"))return!1}else if(!l_(t,"EXT_color_buffer_float"))return!1;return h_(t)}function d_(e){if(0===e)return!1;const t=cx(e);if(1!==e){if(l_(t,"EXT_color_buffer_float"))return h_(t);const e="EXT_color_buffer_half_float";if(l_(t,e)){const n=t.getExtension(e);return function(e,t){const n=yx(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(i),o}(t,n)}return!1}return!!l_(t,"OES_texture_float")&&(!!l_(t,"WEBGL_color_buffer_float")&&h_(t))}function h_(e){const t=yx(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),i}function f_(e){return 2===e&&null!=cx(e).fenceSync}function g_(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>{null!=e&&O.util.assert("complex64"!==e.dtype,(()=>`${t} does not support complex64 tensors in the WebGL backend.`))}))}const m_=(0,O.env)();function y_(){let e,t,n,r,i,o,a,s,u,l;return 2===(0,O.env)().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",i="texture",o="outputColor",a="out vec4 outputColor;",s=(0,O.env)().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",u="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",i="texture2D",o="gl_FragColor",a="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:o,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function b_(e,t,n="index"){const r=O.util.computeStrides(t);return r.map(((t,i)=>`int ${e[i]} = ${n} / ${t}; ${i===r.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * ${t}`:`index -= ${e[i]} * ${t}`};`)).join("")}function v_(e,t,n="index"){const r=O.util.computeStrides(t);return r.map(((t,i)=>`int ${e[i]} = ${n} / outShapeStrides[${i}]; ${i===r.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * outShapeStrides[${i}]`:`index -= ${e[i]} * outShapeStrides[${i}]`};`)).join("")}function x_(e){const t=O.util.computeStrides(e).map((e=>e.toString()));return`\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;\n  }\n`}m_.registerFlag("HAS_WEBGL",(()=>m_.getNumber("WEBGL_VERSION")>0)),m_.registerFlag("WEBGL_VERSION",(()=>c_(2)?2:c_(1)?1:0)),m_.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(()=>!1)),m_.registerFlag("WEBGL_BUFFER_SUPPORTED",(()=>2===m_.get("WEBGL_VERSION"))),m_.registerFlag("WEBGL_CPU_FORWARD",(()=>!0)),m_.registerFlag("WEBGL_FORCE_F16_TEXTURES",(()=>!1)),m_.registerFlag("WEBGL_PACK",(()=>m_.getBool("HAS_WEBGL"))),m_.registerFlag("WEBGL_PACK_NORMALIZATION",(()=>m_.getBool("WEBGL_PACK"))),m_.registerFlag("WEBGL_PACK_CLIP",(()=>m_.getBool("WEBGL_PACK"))),m_.registerFlag("WEBGL_PACK_DEPTHWISECONV",(()=>m_.getBool("WEBGL_PACK"))),m_.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(()=>m_.getBool("WEBGL_PACK"))),m_.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(()=>m_.getBool("WEBGL_PACK"))),m_.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(()=>m_.getBool("WEBGL_PACK"))),m_.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(()=>m_.getBool("WEBGL_PACK"))),m_.registerFlag("WEBGL_PACK_REDUCE",(()=>m_.getBool("WEBGL_PACK"))),m_.registerFlag("WEBGL_LAZILY_UNPACK",(()=>m_.getBool("WEBGL_PACK"))),m_.registerFlag("WEBGL_CONV_IM2COL",(()=>m_.getBool("WEBGL_PACK"))),m_.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(()=>i_(m_.getNumber("WEBGL_VERSION")))),m_.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(()=>s_(m_.getNumber("WEBGL_VERSION")))),m_.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(()=>{const e=m_.getNumber("WEBGL_VERSION");return 0===e?0:u_(e)})),m_.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(()=>m_.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!O.device_util.isMobile())),m_.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(()=>p_(m_.getNumber("WEBGL_VERSION")))),m_.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(()=>!m_.getBool("WEBGL_FORCE_F16_TEXTURES")&&m_.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))),m_.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(()=>d_(m_.getNumber("WEBGL_VERSION")))),m_.registerFlag("WEBGL_FENCE_API_ENABLED",(()=>f_(m_.getNumber("WEBGL_VERSION")))),m_.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(()=>m_.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0)),m_.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(()=>-1),(e=>{if(e<0&&-1!==e)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)})),m_.registerFlag("WEBGL_FLUSH_THRESHOLD",(()=>O.device_util.isMobile()?1:-1),(e=>{if(e<0&&-1!==e)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)})),m_.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(()=>128)),m_.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(()=>!1)),m_.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(()=>1e5)),m_.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(()=>128)),m_.registerFlag("WEBGL_EXP_CONV",(()=>!1)),m_.registerFlag("SOFTWARE_WEBGL_ENABLED",(()=>m_.getBool("IS_TEST"))),m_.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(()=>1/0)),m_.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(()=>!1)),m_.registerFlag("WEBGL2_ISNAN_CUSTOM",(()=>!1)),m_.registerFlag("ENGINE_COMPILE_ONLY",(()=>!1));const __="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:w_}=O.backend_util;function k_(e,t,n){const r=[];if(e.forEach((e=>{const t=O.util.sizeFromShape(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?r.push(`uniform float ${e.name}${t>1?`[${t}]`:""};`):(r.push(`uniform sampler2D ${e.name};`),r.push(`uniform int offset${e.name};`)),n.enableShapeUniforms){const{uniformShape:t}=N_(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape);switch(t.length){case 1:r.push(`uniform int ${e.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${e.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${e.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${e.name}Shape;`)}r.push(`uniform ivec2 ${e.name}TexShape;`)}})),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((e=>{r.push(`uniform ${e.type} ${e.name}${e.arrayIndex?`[${e.arrayIndex}]`:""};`)}));const i=r.join("\n"),o=e.map((e=>function(e,t,n=!1,r){let i="";i+=n?C_(e,r):S_(e,r);const o=e.shapeInfo.logicalShape,a=t.logicalShape;return o.length<=a.length&&(i+=n?function(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=e.shapeInfo.logicalShape.length,a=t.logicalShape.length,s=w_(e.shapeInfo.logicalShape,t.logicalShape),u=R_(a),l=a-o;let c;const p=["x","y","z","w","u","v"];c=0===o?"":a<2&&s.length>=1?"coords = 0;":s.map((e=>`coords.${p[e+l]} = 0;`)).join("\n");let d="";d=a<2&&o>0?"coords":e.shapeInfo.logicalShape.map(((e,t)=>`coords.${p[t+l]}`)).join(", ");let h="return outputValue;";const f=1===O.util.sizeFromShape(e.shapeInfo.logicalShape),g=1===O.util.sizeFromShape(t.logicalShape);if(1!==o||f||g){if(f&&!g)h=1===a?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(s.length){const e=o-2,t=o-1;s.indexOf(e)>-1&&s.indexOf(t)>-1?h="return vec4(outputValue.x);":s.indexOf(e)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(t)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}}else h="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return`\n    vec4 ${i}() {\n      ${u} coords = getOutputCoords();\n      ${c}\n      vec4 outputValue = get${r}(${d});\n      ${h}\n    }\n  `}(e,t):function(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=t.texShape,a=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===u&&null==e.shapeInfo.flatOffset&&O.util.arraysEqual(a,o))return`\n      float ${i}() {\n        return sampleTexture(${n}, resultUV);\n      }\n    `;const l=R_(u),c=w_(e.shapeInfo.logicalShape,t.logicalShape),p=u-s;let d;const h=["x","y","z","w","u","v"];d=0===s?"":u<2&&c.length>=1?"coords = 0;":c.map((e=>`coords.${h[e+p]} = 0;`)).join("\n");let f="";return f=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map(((e,t)=>`coords.${h[t+p]}`)).join(", "),`\n    float ${i}() {\n      ${l} coords = getOutputCoords();\n      ${d}\n      return get${r}(${f});\n    }\n  `}(e,t)),i}(e,t,n.packedInputs,n.enableShapeUniforms))).join("\n"),a=t.texShape,s=y_(),u=function(e){return`\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ${e.texture2D}(textureSampler, uv).r;\n    }\n  `}(s);let l,c,p=function(e){return`${e.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${e.varyingFs} vec2 resultUV;\n    ${e.defineOutput}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ${e.defineSpecialNaN}\n    ${e.defineSpecialInf}\n    ${e.defineRound}\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ${M_}\n    ${T_}\n    ${E_}\n  `}(s);return t.isPacked?(l=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===r[0]?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ${r[1]}.0);\n      }\n    `:1===r[1]?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ${r[0]}.0);\n      }\n    `:n?"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);\n    }\n  `}(0,t,n);case 2:return function(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(O.util.arraysEqual(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));\n      }\n    `;const i=Math.ceil(e[1]/2);return n?"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec2(r, c);\n    }\n  `}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[2]/2),o=i*Math.ceil(e[1]/2);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      int b = index / ${o};\n      index -= b * ${o};\n\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec3(b, r, c);\n    }\n  `}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[e.length-1]/2),o=i*Math.ceil(e[e.length-2]/2);let a=o,s="",u="b, r, c";for(let t=2;t<e.length-1;t++)a*=e[e.length-t-1],s=`\n      int b${t} = index / ${a};\n      index -= b${t} * ${a};\n    `+s,u=`b${t}, `+u;return`\n    ivec${e.length} getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      ${s}\n\n      int b = index / ${o};\n      index -= b * ${o};\n\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec${e.length}(${u});\n    }\n  `}(e,t,n)}}(t.logicalShape,a,n.enableShapeUniforms),c=function(e){return`\n    void setOutput(vec4 val) {\n      ${e.output} = val;\n    }\n  `}(s)):(l=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){return 1===t[0]?n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.x * ${t[1]}.0);\n      }\n    `:1===t[1]?n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.y * ${t[0]}.0);\n      }\n    `:n?"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      return resTexRC.x * ${t[1]} + resTexRC.y;\n    }\n  `}(0,t,n);case 2:return function(e,t,n){return O.util.arraysEqual(e,t)?n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));\n      }\n    `:1===e[1]?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    `:1===e[0]?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(0, index);\n      }\n    `:n?"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      int r = index / ${e[1]};\n      int c = index - r * ${e[1]};\n      return ivec2(r, c);\n    }\n  `}(e,t,n);case 3:return function(e,t,n){if(n)return`\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ${v_(["r","c","d"],e)}\n    return ivec3(r, c, d);\n  }\n`;const r=b_(["r","c","d"],e);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${r}\n      return ivec3(r, c, d);\n    }\n  `}(e,t,n);case 4:return function(e,t,n){if(n)return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ${v_(["r","c","d","d2"],e)}\n      return ivec4(r, c, d, d2);\n    }\n  `;const r=b_(["r","c","d","d2"],e);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${r}\n      return ivec4(r, c, d, d2);\n    }\n  `}(e,t,n);case 5:return function(e,t){const n=b_(["r","c","d","d2","d3"],e);return`\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},\n                             ${t[1]}));\n\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  `}(e,t);case 6:return function(e,t){const n=b_(["r","c","d","d2","d3","d4"],e);return`\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  `}(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}(t.logicalShape,a,n.enableShapeUniforms),c=function(e){return`\n    void setOutput(float val) {\n      ${e.output} = vec4(val, 0, 0, 0);\n    }\n  `}(s)),n.packedInputs&&(p+=A_),[p,u,c,i,l,o,n.userCode].join("\n")}function S_(e,t=!1){const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[i,o]=e.shapeInfo.texShape;if(1===i&&1===o)return`\n      float ${r}() {\n        return sampleTexture(${n}, halfCR);\n      }\n    `;const a=F_(n);if(t)return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${a});\n      return sampleTexture(${n}, uv);\n    }\n  `;const[s,u]=e.shapeInfo.texShape;return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${s}, ${u}, ${a});\n      return sampleTexture(${n}, uv);\n    }\n  `}(e,t);case 1:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`\n      float ${r}(int index) {\n        ${O_(e)}\n      }\n    `;const i=e.shapeInfo.texShape,o=i[0],a=i[1];if(1===a&&1===o)return`\n      float ${r}(int index) {\n        return sampleTexture(${n}, halfCR);\n      }\n    `;const s=F_(n);return 1===a?t?`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${s}) + 0.5) / float(${n}TexShape[0]));\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${s}) + 0.5) / ${o}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:1===o?t?`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${s}) + 0.5) / float(${n}TexShape[1]), 0.5);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${s}) + 0.5) / ${a}.0, 0.5);\n        return sampleTexture(${n}, uv);\n      }\n    `:t?`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${s});\n      return sampleTexture(${n}, uv);\n    }\n  `:`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${o}, ${a}, index + ${s});\n      return sampleTexture(${n}, uv);\n    }\n  `}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape;if(null!=o&&O.util.arraysEqual(n,o)){if(t)return`\n      float ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `;const e=o[0];return`\n    float ${i}(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(${o[1]}.0, ${e}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `}const{newShape:a,keptDims:s}=O.util.squeezeShape(n),u=a;if(u.length<n.length){const n=["row","col"];return`\n      ${S_(D_(e,u),t)}\n      float ${i}(int row, int col) {\n        return ${i}(${I_(n,s)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${i}(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));\n        ${O_(e)}\n      }\n    `;const l=o[0],c=o[1],p=F_(r);return 1===c?t?`\n      float ${i}(int row, int col) {\n        float index = dot(vec3(row, col, ${p}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col) {\n      float index = dot(vec3(row, col, ${p}), vec3(${n[1]}, 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ${l}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `:1===l?t?`\n      float ${i}(int row, int col) {\n        float index = dot(vec3(row, col, ${p}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col) {\n      float index = dot(vec3(row, col, ${p}), vec3(${n[1]}, 1, 1));\n      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);\n      return sampleTexture(${r}, uv);\n    }\n  `:t?`\n      float ${i}(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${r}Shape[1] + col + ${p};\n        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n  float ${i}(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ${n[1]} + col + ${p};\n    vec2 uv = uvFromFlat(${l}, ${c}, index);\n    return sampleTexture(${r}, uv);\n  }\n`}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],a=n[2],{newShape:s,keptDims:u}=O.util.squeezeShape(n),l=s;if(l.length<n.length){const n=["row","col","depth"];return`\n        ${S_(D_(e,l),t)}\n        float ${i}(int row, int col, int depth) {\n          return ${i}(${I_(n,u)});\n        }\n      `}if(e.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(${o}, ${a}, 1)));\n        ${O_(e)}\n      }\n    `;const c=e.shapeInfo.texShape,p=c[0],d=c[1],h=e.shapeInfo.flatOffset;if(d===o&&null==h)return t?`\n      float ${i}(int row, int col, int depth) {\n        int stride1 = ${r}Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n        float ${i}(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(${a}, 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(${d}.0, ${p}.0);\n          return sampleTexture(${r}, uv);\n        }\n      `;if(d===a&&null==h)return t?`\n      float ${i}(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${p}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `;const f=F_(r);return t?`\n    float ${i}(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ${r}Shape[1] * ${r}Shape[2];\n      int stride1 = ${r}Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ${f};\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n      return sampleTexture(${r}, uv);\n    }\n    `:`\n      float ${i}(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${o} + col * ${a} + depth + ${f};\n        vec2 uv = uvFromFlat(${p}, ${d}, index);\n        return sampleTexture(${r}, uv);\n      }\n  `}(e,t);case 4:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],a=n[2]*o,s=n[1]*a,{newShape:u,keptDims:l}=O.util.squeezeShape(n);if(u.length<n.length){const n=["row","col","depth","depth2"];return`\n      ${S_(D_(e,u),t)}\n      float ${i}(int row, int col, int depth, int depth2) {\n        return ${i}(${I_(n,l)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(${s}, ${a}, ${o}, 1)));\n        ${O_(e)}\n      }\n    `;const c=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,d=p[0],h=p[1],f=`int stride2 = ${r}Shape[3];`,g=`int stride1 = ${r}Shape[2] * stride2;`,m=`int stride0 = ${r}Shape[1] * stride1;`;if(h===s&&null==c)return t?`\n      float ${i}(int row, int col, int depth, int depth2) {\n        ${f}\n        ${g}\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(${a}, ${o}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${h}.0, ${d}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;if(h===o&&null==c)return t?`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${n[1]*n[2]}, ${n[2]}, 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${h}.0, ${d}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;const y=F_(r);return t?`\n    float ${i}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ${f}\n      ${g}\n      ${m}\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${y});\n      return sampleTexture(${r}, uv);\n    }\n  `:`\n    float ${i}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${s} + col * ${a} +\n          depth * ${o} + depth2;\n      vec2 uv = uvFromFlat(${d}, ${h}, index + ${y});\n      return sampleTexture(${r}, uv);\n    }\n  `}(e,t);case 5:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[4],o=t[3]*i,a=t[2]*o,s=t[1]*a,{newShape:u,keptDims:l}=O.util.squeezeShape(t);if(u.length<t.length){const t=["row","col","depth","depth2","depth3"];return`\n      ${S_(D_(e,u))}\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        return ${r}(${I_(t,l)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${s}, ${a}, ${o}, ${i})) +\n          depth3;\n        ${O_(e)}\n      }\n    `;const c=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,d=p[0],h=p[1];if(h===s&&null==c)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(${a}, ${o}, ${i}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${h}.0, ${d}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(h===i&&null==c)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]},\n               ${t[2]*t[3]}, ${t[3]}, 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${h}.0, ${d}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;return`\n    float ${r}(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${s} + col * ${a} + depth * ${o} +\n          depth2 * ${i} + depth3 + ${F_(n)};\n      vec2 uv = uvFromFlat(${d}, ${h}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}(e);case 6:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:o}=O.util.squeezeShape(t);if(i.length<t.length){const t=["row","col","depth","depth2","depth3","depth4"];return`\n      ${S_(D_(e,i))}\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ${r}(${I_(t,o)});\n      }\n    `}const a=t[5],s=t[4]*a,u=t[3]*s,l=t[2]*u,c=t[1]*l;if(e.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(${c}, ${l}, ${u}, ${s})) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(${a}, 1)));\n        ${O_(e)}\n      }\n    `;const p=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],f=d[1];if(f===c&&null==p)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(${l}, ${u}, ${s}, ${a})) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${f}.0, ${h}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(f===a&&null==p)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]*t[4]},\n               ${t[2]*t[3]*t[4]},\n               ${t[3]*t[4]},\n               ${t[4]})) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${f}.0, ${h}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;return`\n    float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${c} + col * ${l} + depth * ${u} +\n          depth2 * ${s} + depth3 * ${a} + depth4 + ${F_(n)};\n      vec2 uv = uvFromFlat(${h}, ${f}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}(e);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function C_(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){const t=e.name;return`\n    vec4 ${"get"+t.charAt(0).toUpperCase()+t.slice(1)}() {\n      return ${y_().texture2D}(${t}, halfCR);\n    }\n  `}(e);case 1:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,o=y_();if(t)return`\n    vec4 ${r}(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ${o.texture2D}(${n}, uv);\n    }\n  `;const a=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`\n    vec4 ${r}(int index) {\n      vec2 uv = packedUVfrom1D(\n        ${a[0]}, ${a[1]}, index);\n      return ${o.texture2D}(${n}, uv);\n    }\n  `}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,a=o[0],s=o[1],u=y_();if(null!=o&&O.util.arraysEqual(n,o))return t?`\n      vec4 ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n\n        return ${u.texture2D}(${r}, uv);\n      }\n    `:`\n      vec4 ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}.0, ${a}.0);\n\n        return ${u.texture2D}(${r}, uv);\n      }\n    `;if(t)return`\n    vec4 ${i}(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ${u.texture2D}(${r}, uv);\n    }\n  `;const l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];return`\n    vec4 ${i}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${Math.ceil(n[1]/2)}, ${l[0]}, ${l[1]}, row, col);\n      return ${u.texture2D}(${r}, uv);\n    }\n  `}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,a=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===n[0]){const r=[1,2],o=["b","row","col"];return`\n        ${C_(D_(e,n.slice(1)),t)}\n        vec4 ${i}(int b, int row, int col) {\n          return ${i}(${I_(o,r)});\n        }\n      `}const s=y_();if(t)return`\n    vec4 ${i}(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ${s.texture2D}(${r}, uv);\n    }\n  `;const u=a[0],l=a[1],c=Math.ceil(n[2]/2);return`\n    vec4 ${i}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${u}, ${l}, ${c*Math.ceil(n[1]/2)}, ${c}, b, row, col);\n      return ${s.texture2D}(${r}, uv);\n    }\n  `}(e,t);default:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=y_();if(t)return`\n    vec4 ${r}(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ${n}Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${n}, uv);\n    }\n  `;const o=e.shapeInfo.logicalShape,a=o.length,s=e.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=u[0],c=u[1],p=Math.ceil(o[a-1]/2);let d=p*Math.ceil(o[a-2]/2),h="int b, int row, int col",f=`b * ${d} + (row / 2) * ${p} + (col / 2)`;for(let e=2;e<a-1;e++)h=`int b${e}, `+h,d*=o[a-e-1],f=`b${e} * ${d} + `+f;return`\n    vec4 ${r}(${h}) {\n      int index = ${f};\n      int texR = index / ${c};\n      int texC = index - texR * ${c};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${l});\n      return ${i.texture2D}(${n}, uv);\n    }\n  `}(e,t)}}const M_="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",T_="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",E_="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",A_="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function F_(e){return`offset${e}`}function O_(e){const t=e.name,n=O.util.sizeFromShape(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`\n    for (int i = 0; i < ${n}; i++) {\n      if (i == index) {\n        return ${t}[i];\n      }\n    }\n  `}function R_(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function N_(e,t,n){const{newShape:r,keptDims:i}=O.util.squeezeShape(t),o=t.length,a=e&&3===o&&1===t[0],s=a?t.slice(1):r,u=!e&&o>1&&!O.util.arraysEqual(t,n)&&r.length<o||a;return{useSqueezeShape:u,uniformShape:u?s:t,keptDims:i}}function D_(e,t){const n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function I_(e,t){return t.map((t=>e[t])).join(", ")}function B_(e,t,n){const r=[],i=[];let o,a,s,u=null,l=null;l=e.getUniformLocation(n,"NAN",!1),1===(0,O.env)().getNumber("WEBGL_VERSION")&&(u=e.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const i of t.variableNames){const o={name:i,uniform:e.getUniformLocation(n,i,c),offset:e.getUniformLocation(n,`offset${i}`,c)};t.enableShapeUniforms&&(o.shape=e.getUniformLocation(n,`${i}Shape`,c),o.texShape=e.getUniformLocation(n,`${i}TexShape`,c)),r.push(o)}if(t.enableShapeUniforms&&(o=e.getUniformLocation(n,"outShape",c),s=e.getUniformLocation(n,"outShapeStrides",c),a=e.getUniformLocation(n,"outTexShape",c)),t.customUniforms)for(const r of t.customUniforms)i.push(e.getUniformLocation(n,r.name,c));return{variablesLocations:r,customUniformLocations:i,infLoc:u,nanLoc:l,outShapeLocation:o,outShapeStridesLocation:s,outTexShapeLocation:a}}function L_(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach(((e,n)=>{const r=e.logicalShape,i=t[n],o=i.shape;if(!O.util.arraysEqual(r,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${o} must match`);if(e.isUniform&&i.isUniform)return;const a=e.texShape,s=i.isUniform?null:i.texData.texShape;if(!O.util.arraysEqual(a,s))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${s} must match`)}))}function P_(e){return(0,O.env)().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}class $_{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=px.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=y_();this.outputShape=e,this.enableShapeUniforms=P_(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?v_(["r","c","d"],e):b_(["r","c","d"],e)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ${t.output} = result;\n      }\n    `}}class z_{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=px.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=y_();this.outputShape=e,this.enableShapeUniforms=P_(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?v_(["r","c","d"],e):b_(["r","c","d"],e)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ${t.output} = result;\n      }\n    `}}class j_{constructor(e){this.variableNames=["A"],this.outTexUsage=dx.DOWNLOAD;const t=y_();this.outputShape=e,this.userCode=`\n      ${__}\n\n      void main() {\n        float x = getAAtOutCoords();\n        ${t.output} = encode_float(x);\n      }\n    `}}class G_{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=dx.DOWNLOAD;const t=y_();this.outputShape=e,this.userCode=`\n      ${__}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ${t.output} = encode_float(x);\n      }\n    `}}const U_={R:0,G:1,B:2,A:3};class W_{constructor(e,t=!1,n="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=y_();this.outputShape=e,this.enableShapeUniforms=P_(this.outputShape.length);let i="result";t&&(i="floor(result * 255. + 0.5)");let o="";for(let e=0;e<n.length;e++){const t=n[e];o+=`\n          if(offset == ${e}) {\n            result = values[${U_[t]}];\n          }`}this.userCode=`\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":x_(e)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ${n.length});\n\n        flatIndex = idiv(flatIndex, ${n.length}, 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ${r.texture2D}(A, uv);\n          ${o}\n        }\n        ${r.output} = vec4(${i}, 0., 0., 0.);\n      }\n    `}}class V_{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=y_();this.outputShape=e,this.enableShapeUniforms=P_(this.outputShape.length);let r="",i="result";t&&(i="floor(result * 255. + 0.5)");for(let t=0;t<=1;t++)for(let i=0;i<=1;i++){const o=2*t+i;r+=`\n          localCoords = coords;\n          if(localCoords[2] + ${i} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {\n          localCoords[2] += ${i};\n          if (localCoords[1] + ${t} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {\n            localCoords[1] += ${t};\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ${n.texture2D}(A, uv);\n\n            if (offset == 0) {\n              result[${o}] = values[0];\n            } else if (offset == 1) {\n              result[${o}] = values[1];\n            } else if (offset == 2) {\n              result[${o}] = values[2];\n            } else {\n              result[${o}] = values[3];\n            }\n          }\n        }\n        `}this.userCode=`\n        ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":x_(e)}\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ${r}\n\n          ${n.output} = ${i};\n        }\n    `}}function H_(e){const t=y_();return Sx(e,`${t.version}\n    precision highp float;\n    ${t.attribute} vec3 clipSpacePos;\n    ${t.attribute} vec2 uv;\n    ${t.varyingVs} vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }`)}function q_(e){return Ox(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function X_(e){return Rx(e,new Uint16Array([0,1,2,2,1,3]))}function Y_(e,t,n,r,i,o){Ix(t,n);const a=Dx(e),s=e.TEXTURE_2D;return bx(e,(()=>e.bindTexture(s,a))),bx(e,(()=>e.texParameteri(s,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE))),bx(e,(()=>e.texParameteri(s,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE))),bx(e,(()=>e.texParameteri(s,e.TEXTURE_MIN_FILTER,e.NEAREST))),bx(e,(()=>e.texParameteri(s,e.TEXTURE_MAG_FILTER,e.NEAREST))),1===(0,O.env)().getNumber("WEBGL_VERSION")?bx(e,(()=>e.texImage2D(s,0,r,t,n,0,i,o,null))):bx(e,(()=>e.texStorage2D(s,1,r,t,n))),bx(e,(()=>e.bindTexture(e.TEXTURE_2D,null))),{texture:a,texShape:[n,t]}}function K_(e){return e.internalFormatFloat}function J_(e,t,n,r){const[i,o]=fx(t,n);return Y_(e,i,o,K_(r),r.textureFormatFloat,e.FLOAT)}function Z_(e){return e.internalFormatHalfFloat}function Q_(e,t,n,r){const[i,o]=fx(t,n);return Y_(e,i,o,Z_(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function ew(e){return e.downloadTextureFormat}function tw(e,t,n,r){const[i,o]=fx(t,n);return Y_(e,i,o,ew(r),e.RGBA,e.UNSIGNED_BYTE)}function nw(e){return e.internalFormatPackedFloat}function rw(e,t,n,r){const[i,o]=mx(t,n);return Y_(e,i,o,nw(r),e.RGBA,e.FLOAT)}function iw(e){return e.internalFormatPackedHalfFloat}function ow(e,t,n,r){const[i,o]=mx(t,n);return Y_(e,i,o,iw(r),e.RGBA,r.textureTypeHalfFloat)}function aw(e,t,n){return bx(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,n))),Lx(e,t,"clipSpacePos",n,3,20,0)&&Lx(e,t,"uv",n,2,20,12)}function sw(e,t,n,r,i,o){let a,s,u;bx(e,(()=>e.bindTexture(e.TEXTURE_2D,t))),i instanceof Uint8Array?(a=new Uint8Array(n*r*4),s=e.UNSIGNED_BYTE,u=e.RGBA):(a=new Float32Array(n*r*4),s=e.FLOAT,u=o.internalFormatPackedFloat),a.set(i),2===(0,O.env)().getNumber("WEBGL_VERSION")?bx(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,s,a))):bx(e,(()=>e.texImage2D(e.TEXTURE_2D,0,u,n,r,0,e.RGBA,s,a))),bx(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}function uw(e,t,n){bx(e,(()=>e.bindTexture(e.TEXTURE_2D,t))),n.data instanceof Uint8Array?2===(0,O.env)().getNumber("WEBGL_VERSION")?bx(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data))):bx(e,(()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data))):2===(0,O.env)().getNumber("WEBGL_VERSION")?bx(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n))):bx(e,(()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n))),bx(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}function lw(e,t,n,r){const i=e.createBuffer();bx(e,(()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,i)));const o=16*t*n;return bx(e,(()=>e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ))),bx(e,(()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0))),bx(e,(()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null))),i}function cw(e,t,n){const r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function pw(e,t,n,r){const[i,o]=fx(t,n),a=new Uint8Array(t*n*4);return bx(e,(()=>e.readPixels(0,0,i,o,r.downloadTextureFormat,e.UNSIGNED_BYTE,a))),new Float32Array(a.buffer)}function dw(e,t,n,r,i,o,a,s){const u=e,l=new Float32Array(function(e,t){const[n,r]=mx(e,t);return n*r*4}(o,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function hw(e,t,n){const r=new Float32Array(t*n*4);return bx(e,(()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r))),r}class fw{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=(0,O.env)().getNumber("WEBGL_VERSION");if(null!=e?(this.gl=e,lx(t,e)):this.gl=cx(t),e=this.gl,2===(0,O.env)().getNumber("WEBGL_VERSION")){const t=e;this.createVertexArray=()=>bx(t,(()=>t.createVertexArray())),this.bindVertexArray=e=>bx(t,(()=>t.bindVertexArray(e))),this.deleteVertexArray=e=>bx(t,(()=>t.deleteVertexArray(e))),this.getVertexArray=()=>bx(t,(()=>t.getParameter(t.VERTEX_ARRAY_BINDING)))}else if(null!=e){const t=e.getExtension("OES_vertex_array_object");if(null==t)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>bx(e,(()=>t.createVertexArrayOES())),this.bindVertexArray=n=>bx(e,(()=>t.bindVertexArrayOES(n))),this.deleteVertexArray=n=>bx(e,(()=>t.deleteVertexArrayOES(n))),this.getVertexArray=()=>bx(e,(()=>e.getParameter(t.VERTEX_ARRAY_BINDING_OES)))}let n="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===(0,O.env)().getNumber("WEBGL_VERSION")){const e="OES_texture_float",t="OES_texture_half_float";if(this.textureFloatExtension=kx(this.gl,e),l_(this.gl,t))this.textureHalfFloatExtension=kx(this.gl,t);else if((0,O.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),l_(this.gl,r))this.colorBufferHalfFloatExtension=kx(this.gl,r);else if((0,O.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",l_(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!l_(this.gl,r))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(r)}this.vertexBuffer=q_(this.gl),this.indexBuffer=X_(this.gl),this.framebuffer=Bx(this.gl),this.textureConfig=yx(this.gl,this.textureHalfFloatExtension)}get debug(){return(0,O.env)().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;bx(e,(()=>e.finish())),bx(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,null))),bx(e,(()=>e.deleteFramebuffer(this.framebuffer))),bx(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,null))),bx(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null))),bx(e,(()=>e.deleteBuffer(this.indexBuffer))),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),J_(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),Q_(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),tw(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),uw(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,r){this.throwIfDisposed(),sw(this.gl,e,t,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),ow(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),rw(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(Vx(this.gl,this.framebuffer),this.outputTexture=null),bx(this.gl,(()=>this.gl.deleteTexture(e)))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,(()=>pw(this.gl,t,n,this.textureConfig)))}downloadPackedMatrixFromBuffer(e,t,n,r,i,o){return dw(this.gl,e,0,0,0,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return cw(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);const r=lw(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if((0,O.env)().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{const e=r.clientWaitSync(i,0,0);return e===r.ALREADY_SIGNALED||e===r.CONDITION_SATISFIED},t=i}else(0,O.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,(0,O.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,(()=>hw(this.gl,t,n)))}createProgram(e){this.throwIfDisposed();const t=this.gl;null==this.vertexShader&&(this.vertexShader=H_(t));const n=Ex(t);bx(t,(()=>t.attachShader(n,this.vertexShader))),bx(t,(()=>t.attachShader(n,e))),Ax(t,n);const r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&Fx(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;bx(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer))),aw(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(bx(this.gl,(()=>this.gl.deleteProgram(e))),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&Fx(this.gl,this.program),bx(this.gl,(()=>this.gl.useProgram(e)))}getUniformLocation(e,t,n=!0){return this.throwIfDisposed(),n?zx(this.gl,e,t):jx(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),bx(this.gl,(()=>this.gl.getAttribLocation(e,t)))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),Gx(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();const[r,i]=mx(t,n);this.setOutputMatrixTextureDriver(e,r,i)}setOutputMatrixWriteRegion(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&Fx(this.gl,this.program),Hx(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}bx(e,(()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),bx(this.gl,(()=>this.gl.finish()))}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=kx(this.gl,2===(0,O.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===(0,O.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(2===(0,O.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2();return void e.endQuery(t.TIME_ELAPSED_EXT)}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await O.util.repeatedTry((()=>this.disposed||this.isQueryAvailable(e,(0,O.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")))),this.getQueryTime(e,(0,O.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(0===t)return null;if(2===t){const t=this.gl;return t.getQueryParameter(e,t.QUERY_RESULT)/1e6}{const t=this.getQueryTimerExtensionWebGL1();return t.getQueryObjectEXT(e,t.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(0===t)return!0;if(2===t){const t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const t=this.getQueryTimerExtensionWebGL1(),n=t.getQueryObjectEXT(e,t.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(t.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(e){return new Promise((t=>{this.addItemToPoll((()=>e.isFencePassed()),(()=>t()))}))}pollItems(){const e=function(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map((e=>e.isDoneFn)));for(let t=0;t<=e;++t){const{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in(0,O.env)().platform&&(n=(0,O.env)().platform.setTimeoutCustom.bind((0,O.env)().platform)),O.util.repeatedTry((()=>(this.pollItems(),0===this.itemsToPoll.length)),(()=>0),null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Wx(this.gl,e,this.framebuffer),this.debug&&Hx(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(Wx(this.gl,this.outputTexture,this.framebuffer),this.debug&&Hx(this.gl)):Vx(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();const r=this.gl;Wx(r,e,this.framebuffer),this.debug&&Hx(r),this.outputTexture=e,bx(r,(()=>r.viewport(0,0,t,n))),bx(r,(()=>r.scissor(0,0,t,n)))}setOutputMatrixWriteRegionDriver(e,t,n,r){this.throwIfDisposed(),bx(this.gl,(()=>this.gl.scissor(e,t,n,r)))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}const{addImpl:gw,bincountImpl:mw,bincountReduceImpl:yw,bitwiseAndImpl:bw,castImpl:vw,ceilImpl:xw,concatImpl:_w,equalImpl:ww,expImpl:kw,expm1Impl:Sw,floorImpl:Cw,gatherNdImpl:Mw,gatherV2Impl:Tw,greaterImpl:Ew,greaterEqualImpl:Aw,lessImpl:Fw,lessEqualImpl:Ow,linSpaceImpl:Rw,logImpl:Nw,maxImpl:Dw,maximumImpl:Iw,minimumImpl:Bw,multiplyImpl:Lw,negImpl:Pw,notEqualImpl:$w,prodImpl:zw,raggedGatherImpl:jw,raggedRangeImpl:Gw,raggedTensorToTensorImpl:Uw,rangeImpl:Ww,rsqrtImpl:Vw,scatterImpl:Hw,sigmoidImpl:qw,simpleAbsImpl:Xw,sliceImpl:Yw,sparseFillEmptyRowsImpl:Kw,sparseReshapeImpl:Jw,sparseSegmentReductionImpl:Zw,sqrtImpl:Qw,staticRegexReplaceImpl:ek,stridedSliceImpl:tk,stringNGramsImpl:nk,stringSplitImpl:rk,stringToHashBucketFastImpl:ik,subImpl:ok,tileImpl:ak,topKImpl:sk,transposeImpl:uk,uniqueImpl:lk}=T;function ck(e,t){return["x","y","z","w","u","v"].slice(0,t).map((t=>`${e}.${t}`))}function pk(e,t){return 1===t?[e]:ck(e,t)}class dk{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=P_(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const e=pk("rc",this.rank),t=R_(this.rank),n=this.getOutOfBoundsCondition(e),r=this.getSetup(e),i=this.getOutput(e);this.userCode=`\n        void main() {\n          ${t} rc = getOutputCoords();\n\n          if(${n}) {\n            setOutput(vec4(0));\n          } else {\n            ${r}\n\n            setOutput(vec4(${i}));\n          }\n        }\n      `}}getSourceCoordsArr(e){const t=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let i=`${0===n?"r":"rp1"}, ${0===r?"c":"cp1"}`;for(let t=2;t<this.rank;t++)i=`${e[e.length-1-t]},`+i;t.push(i)}return t}getOutOfBoundsCondition(e){if(1===this.rank)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let n=this.rank-2;n<this.rank;n++)t+=`${e[n]} >= ${this.enableShapeUniforms?`outShape[${n}]`:this.outputShape[n]}`,n<this.rank-1&&(t+="||");return t}getSetup(e){if(1===this.rank)return"";const t=e.slice(-2),n=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`\n      int r = ${t[0]};\n      int c = ${t[1]};\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ${n};\n      bool rEdge = rp1 >= ${r};\n    `}getOutput(e){const t=this.getSourceCoordsArr(e);return 1===this.rank?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),\n            cEdge ? 0. : getA(${t[1]}),\n            rEdge ? 0. : getA(${t[2]}),\n            rEdge || cEdge ? 0. : getA(${t[3]})`}}class hk{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=P_(this.outputShape.length);let n="";for(let e=0;e<4;e++){let t="thisRC = rc;";e%2==1&&(t+="thisRC.z += 1;"),e>1&&(t+="thisRC.y += 1;"),n+=`\n        ${t}\n        ${e>0?"if(thisRC.y < rows && thisRC.z < cols){":""}\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${e}] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ${e>0?"}":""}\n      `}var r,i;this.userCode=`\n      ${r=t,i=this.enableShapeUniforms,`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${i?function(e,t,n="index"){const r=function(e,t){const n=e.length,r=e.map((e=>`${t}[${e}]`)),i=new Array(n-1);i[n-2]=r[n-1];for(let e=n-3;e>=0;--e)i[e]=`(${i[e+1]} * ${r[e+1]})`;return i}(e.map(((e,t)=>t)),t);return r.map(((t,i)=>`int ${e[i]} = ${n} / ${r[i]}; ${i===r.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * ${r[i]}`:`index -= ${e[i]} * ${r[i]}`};`)).join("")}(["r","c","d"],"inputShape"):b_(["r","c","d"],r)}\n      return ivec3(r, c, d);\n    }\n  `}\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":x_(e)}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};\n        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};\n\n        ${n}\n\n        setOutput(result);\n      }\n    `}}class fk{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){const r=mk(t,n),i=yk(e,r,n);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=gk(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const e=this.freeTextures[i].pop();return this.usedTextures[i].push(e),e}let a;return r===hx.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===hx.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===hx.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===hx.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===hx.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,t,n,r){if(null==this.freeTextures)return;const i=mk(n,r),o=yk(t,i,r);o in this.freeTextures||(this.freeTextures[o]=[]);const a=gk(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),s=(0,O.env)().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==s&&this._numBytesAllocated>s?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const u=this.usedTextures[o],l=u&&u.indexOf(e);if(null==l||l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[l]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const e in this.freeTextures)this.freeTextures[e].forEach((e=>{this.gpgpu.deleteMatrixTexture(e.texture)}));for(const e in this.usedTextures)this.usedTextures[e].forEach((e=>{this.gpgpu.deleteMatrixTexture(e.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function gk(e,t,n,r,i){const o=function(e,t){switch(e){case hx.PACKED_2X2_FLOAT32:return nw(t);case hx.PACKED_2X2_FLOAT16:return iw(t);case hx.UNPACKED_FLOAT32:return K_(t);case hx.UNPACKED_FLOAT16:return Z_(t);case hx.PACKED_4X1_UNSIGNED_BYTE:return ew(t);default:throw new Error(`Unknown physical texture type ${e}`)}}(t,r);let a;if(i){const[t,n]=mx(e[0],e[1]);a=t*n}else{const[t,n]=fx(e[0],e[1]);a=t*n}const s=function(e,t){const n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}(n,o);return a*s}function mk(e,t){if(e===dx.UPLOAD)return hx.PACKED_2X2_FLOAT32;if(e===dx.RENDER||null==e)return function(e){return(0,O.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?hx.PACKED_2X2_FLOAT32:hx.UNPACKED_FLOAT32:e?hx.PACKED_2X2_FLOAT16:hx.UNPACKED_FLOAT16}(t);if(e===dx.DOWNLOAD||e===dx.PIXELS)return hx.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function yk(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}class bk{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=P_(this.outputShape.length),this.userCode=`\n      float unaryOperation(float x) {\n        ${t}\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}const vk="if (isnan(x)) return x;",xk="return x;",_k="return abs(x);",wk="return (x >= 0.0) ? x : (exp(x) - 1.0);",kk=vk+"\n  return (x < 0.0) ? 0.0 : x;\n",Sk=vk+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",Ck="return x;",Mk="return 1.0 / (1.0 + exp(-1.0 * x));",Tk="return x;",Ek="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Ak="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Fk="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Ok="return 1.0 / (1.0 + exp(-1.0 * x));";class Rk{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=P_(this.outputShape.length),this.userCode=`\n      vec4 unaryOperation(vec4 x) {\n        ${t}\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}class Nk{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=P_(this.outputShape.length);const t=e.length,n=pk("rc",t),r=R_(t),i=function(e,t){if(1===e)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),o=n.slice(-2),a=t<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`\n      void main() {\n        ${r} rc = getOutputCoords();\n        vec4 packedInput = getA(${i});\n\n        setOutput(getChannel(packedInput, ${a}));\n      }\n    `}}const Dk=O.kernel_impls.whereImpl,Ik={},Bk=(0,O.env)().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");class Lk extends O.KernelBackend{nextDataId(){return Lk.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!(0,O.env)().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(null!=e){if(e instanceof fw)t=e;else{const n=cx((0,O.env)().getNumber("WEBGL_VERSION"),e);t=new fw(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const e=cx((0,O.env)().getNumber("WEBGL_VERSION"));t=new fw(e),this.binaryCache=((n=(0,O.env)().getNumber("WEBGL_VERSION"))in Ik||(Ik[n]={}),Ik[n]),this.gpgpuCreatedLocally=!0}var n;this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new fk(this.gpgpu),this.numMBBeforeWarning=null==(0,O.env)().global.screen?1024:(0,O.env)().global.screen.height*(0,O.env)().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new O.DataStorage(this,(0,O.engine)())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,r,i,o){const a=this.makeTensorInfo(t,n),s=this.texData.get(a.dataId);s.isPacked=!1,s.texture={texture:e,texShape:[r,i]},s.texShape=[r,i];const u=Zx(t),l=new W_(u,!1,o),c=this.runWebGLProgram(l,[a],n,[[r,i]]);return c.shape=t,s.texture=null,this.disposeIntermediateTensorInfo(a),c.dataId}write(e,t,n){if(((0,O.env)().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||(0,O.env)().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:dx.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){this.texData.get(e).refCount++}decRef(e){this.texData.has(e)&&this.texData.get(e).refCount--}move(e,t,n,r,i){if((0,O.env)().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:dx.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:n,dtype:r,complexTensorInfos:i,slice:o,shape:a,isPacked:s}=t;if(null!=o){let t;t=s?new Rk(a,Ck):new bk(a,Ck);const n=this.runWebGLProgram(t,[{dataId:e,shape:a,dtype:r}],r),i=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),i}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;const u=null!=this.activeTimers;let l,c;if(u&&(l=O.util.now()),"complex64"===r){const e=this.readSync(i.real.dataId),t=this.readSync(i.imag.dataId);c=O.backend_util.mergeRealAndImagArrays(e,t)}else c=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=O.util.now()-l),this.convertAndCacheOnCPU(e,c)}async read(e){if(this.pendingRead.has(e)){const t=this.pendingRead.get(e);return new Promise((e=>t.push(e)))}const t=this.texData.get(e),{values:n,shape:r,slice:i,dtype:o,complexTensorInfos:a,isPacked:s}=t;if(null!=i){let t;t=s?new Rk(r,Ck):new bk(r,Ck);const n=this.runWebGLProgram(t,[{dataId:e,shape:r,dtype:o}],o),i=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),i}if(null!=n)return this.convertAndCacheOnCPU(e);if((0,O.env)().getBool("DEBUG")&&!(0,O.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===(0,O.env)().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u,l,c=null;if("complex64"!==o&&(0,O.env)().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const t=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(t.texture.texture,...gx(r))}if(this.pendingRead.set(e,[]),"complex64"!==o&&await this.gpgpu.createAndWaitForFence(),"complex64"===o){const e=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),t=e[0],n=e[1];l=O.backend_util.mergeRealAndImagArrays(t,n)}else if(null==c)l=this.getValuesFromTexture(e);else{const e=O.util.sizeFromShape(r);l=this.gpgpu.downloadFloat32MatrixFromBuffer(c,e)}if(null!=u&&this.disposeIntermediateTensorInfo(u),null!=c){const e=this.gpgpu.gl;bx(e,(()=>e.deleteBuffer(c)))}const p=this.convertAndCacheOnCPU(e,l),d=this.pendingRead.get(e);return this.pendingRead.delete(e),d.forEach((e=>e(p))),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&(0,O.engine)().removeDataId(e,this),this.pendingDeletes--),p}readToGPU(e,t={}){const n=this.texData.get(e),{values:r,shape:i,slice:o,dtype:a,isPacked:s,texture:u}=n;if("complex64"===a)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=o){let n;n=s?new Rk(i,Ck):new bk(i,Ck);const r=this.runWebGLProgram(n,[{dataId:e,shape:i,dtype:a}],a),o=this.readToGPU(r,t);return this.disposeIntermediateTensorInfo(r),o}if(null==u)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const l=this.decode(e,t.customTexShape),c=(0,O.engine)().makeTensorFromTensorInfo(l),p=this.texData.get(l.dataId);return Object.assign({tensorRef:c},p.texture)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map((e=>O.util.decodeString(e)));return(0,O.buffer)(e.shape,e.dtype,n)}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8")}return(0,O.buffer)(e.shape,e.dtype,t)}checkNumericalProblems(e){if(null!=e)for(let t=0;t<e.length;t++){const n=e[t];if(!_x(n)){if((0,O.env)().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`);throw Error(`The value ${n} cannot be represented on this device.`)}}}getValuesFromTexture(e){const{shape:t,dtype:n,isPacked:r}=this.texData.get(e),i=O.util.sizeFromShape(t);if((0,O.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(e),r=this.texData.get(n.dataId),o=this.gpgpu.downloadMatrixFromPackedTexture(r.texture.texture,...gx(t)).subarray(0,i);return this.disposeIntermediateTensorInfo(n),o}const o=(0,O.env)().getBool("WEBGL_PACK")&&!0===r,a=o?Zx(t):t,s=o?new G_(a):new j_(a),u=this.runWebGLProgram(s,[{shape:a,dtype:n,dataId:e}],"float32"),l=this.texData.get(u.dataId),c=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(l.texture.texture,l.texShape[0],l.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(u),c}timerAvailable(){return(0,O.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,n=[];let r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e();const i=O.util.flatten(this.activeTimers.map((e=>e.query))).filter((e=>null!=e)),o=O.util.flatten(this.activeTimers.map((e=>e.name))).filter((e=>null!=e));this.activeTimers=t,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if((0,O.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const e=await Promise.all(i);a.kernelMs=O.util.sum(e),a.getExtraProfileInfo=()=>e.map(((e,t)=>({name:o[t],ms:e}))).map((e=>`${e.name}: ${e.ms}`)).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return(0,O.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:O.util.now(),endMs:null}}endTimer(e){return(0,O.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=O.util.now(),e)}async getQueryTime(e){if((0,O.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:n}=this.texData.get(e);return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:n,texShape:r,usage:i,isPacked:o,slice:a}=this.texData.get(e),s=a&&a.origDataId||e,u=this.dataRefCount.get(s);u>1?this.dataRefCount.set(s,u-1):(this.dataRefCount.delete(s),null!=t&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(t,r,i,o)));const l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=Bk){return(0,O.env)().getBool("WEBGL_CPU_FORWARD")&&e.every((e=>null==this.texData.get(e.dataId).texture&&O.util.sizeFromShape(e.shape)<t))}getGPGPUContext(){return this.gpgpu}where(e){O.backend_util.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return Dk(e.shape,t)}packedUnaryOp(e,t,n){const r=new Rk(e.shape,t),i=this.compileAndRun(r,[e],n);return(0,O.engine)().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){const t=Xw(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if((0,O.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,_k,e.dtype);const t=new bk(e.shape,_k),n=this.compileAndRun(t,[e]);return(0,O.engine)().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&O.util.isString(n[0])){const i=n.map((e=>O.util.encodeString(e)));r=this.write(i,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,n){return(0,O.engine)().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){const t=new Nk(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new dk(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const n=[Kx(e.shape),...Jx(e.shape)],r={dtype:e.dtype,shape:n,dataId:e.dataId},i=[Kx(t),...Jx(t)],o=new hk(i,n),a=[n],s=this.runWebGLProgram(o,[r],e.dtype,a,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}decode(e,t){const n=this.texData.get(e),{isPacked:r,shape:i,dtype:o}=n;if(null!=t){const e=O.util.sizeFromShape(i),n=t[0]*t[1]*4;O.util.assert(e<=n,(()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."))}const a=Zx(i);let s;s=r?new z_(a):new $_(a);const u=[null!=t?t:gx(a)];return{dtype:o,shape:i,dataId:this.runWebGLProgram(s,[{shape:a,dtype:o,dataId:e}],o,u,!0,t).dataId}}runWebGLProgram(e,t,n,r,i=!1,o){const a=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(a.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===px.DENSE){const t=null!=o?o:gx(e.outputShape);s.texShape=t.map((e=>2*e))}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===O.util.sizeFromShape(a.shape))return s.values=O.util.getTypedArrayFromDType(a.dtype,0),a;const u=[],l=t.map((t=>{if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&O.util.sizeFromShape(t.shape)<=(0,O.env)().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(this.uploadToGPU(t.dataId),!!n.isPacked!=!!e.packedInputs)t=n.isPacked?this.unpackTensor(t):this.packTensor(t),u.push(t),n=this.texData.get(t.dataId);else if(n.isPacked&&!t_(n.shape,t.shape)){const e=t,r=t.shape;t.shape=n.shape,t=this.packedReshape(t,r),u.push(t),n=this.texData.get(t.dataId),e.shape=r}return{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(a.dataId);const c={shape:a.shape,texData:s,isUniform:!1},p=function(e,t,n){let r="";t.concat(n).forEach((t=>{const i=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){const o=t.texData.texShape,{useSqueezeShape:a,uniformShape:s,keptDims:u}=N_(e.packedInputs,t.shape,o);let l="",c="",p="";if(1===s.length&&e.packedInputs){const e=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];l=`${e[0]>1}_${e[1]>1}`}else if(2!==s.length||e.packedInputs){if(s.length>2&&!e.packedInputs){const e=O.util.computeStrides(s);p=`${e[0]===o[1]}_${e[e.length-1]===o[1]}`}}else c=`${s[0]>1}_${s[1]>1}`;const d=t.shape.length,h=2===s.length&&O.util.arraysEqual(t.shape,o),f=1===O.util.sizeFromShape(t.shape),g=O.backend_util.getBroadcastDims(t.shape,n.shape),m=!e.packedInputs&&d===n.shape.length&&O.util.arraysEqual(o,n.texData.texShape),y=e.packedInputs||s.length>2?"":`${o[0]>1}_${o[1]>1}`;r+=`${d}_${m}_${a?u:""}_${s.length}_${f}_${g}_${h}_${l}_${c}_${p}_${y}_${i}`}else{const e=t.isUniform?"uniform":t.texData.texShape;r+=`${t.shape}_${e}_${i}`}}));const i=e.userCode;let o=e.constructor.name;return o+="_"+r+"_"+i+`${(0,O.env)().getNumber("WEBGL_VERSION")}`,o}(e,l,c),d=this.getAndSaveBinary(p,(()=>function(e,t,n,r){const i=n.map(((e,n)=>{const r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),o=i.map((e=>e.shapeInfo)),a={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=k_(i,a,t),u=Cx(e.gl,s),l=e.createProgram(u);return(0,O.env)().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:u,source:s,webGLProgram:l,inShapeInfos:o,outShapeInfo:a,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(l),Object.assign({program:t,fragmentShader:u,source:s,webGLProgram:l,inShapeInfos:o,outShapeInfo:a},B_(e,t,l)))}(this.gpgpu,e,l,c))),h=null!=this.activeTimers;let f;h&&(f=this.startTimer()),(0,O.env)().get("ENGINE_COMPILE_ONLY")||function(e,t,n,r,i){t.program.enableShapeUniforms||(L_(t.inShapeInfos,n),L_([t.outShapeInfo],[r]));const o=r.texData.texture,a=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(o.texture,a[0],a[1]):e.setOutputMatrixTexture(o.texture,a[0],a[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),1===(0,O.env)().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN);for(let r=0;r<n.length;++r){const i=n[r],{uniform:o,offset:a,shape:s,texShape:u}=t.variablesLocations[r];if(s){const{uniformShape:n}=N_(t.program.packedInputs,i.shape,i.texData.texShape);switch(n.length){case 1:e.gl.uniform1iv(s,new Int32Array(n));break;case 2:e.gl.uniform2iv(s,new Int32Array(n));break;case 3:e.gl.uniform3iv(s,new Int32Array(n));break;case 4:e.gl.uniform4iv(s,new Int32Array(n))}}if(u&&e.gl.uniform2i(u,i.texData.texShape[0],i.texData.texShape[1]),null!=o)if(i.isUniform)if(O.util.sizeFromShape(i.shape)<2)e.gl.uniform1f(o,i.uniformValues[0]);else{let t=i.uniformValues;t instanceof Float32Array||(t=new Float32Array(t)),e.gl.uniform1fv(o,t)}else null!=i.texData.slice&&null!=a&&e.gl.uniform1i(a,i.texData.slice.flatOffset),e.setInputMatrixTexture(i.texData.texture.texture,o,r)}const s=t.outShapeLocation;if(s)switch(r.shape.length){case 1:e.gl.uniform1iv(s,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(s,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(s,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(s,new Int32Array(r.shape))}if(t.outShapeStridesLocation){const n=O.util.computeStrides(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(n));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(n));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(n))}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&i)for(let n=0;n<t.program.customUniforms.length;++n){const r=t.program.customUniforms[n],o=t.customUniformLocations[n],a=i[n];if("float"===r.type)e.gl.uniform1fv(o,a);else if("vec2"===r.type)e.gl.uniform2fv(o,a);else if("vec3"===r.type)e.gl.uniform3fv(o,a);else if("vec4"===r.type)e.gl.uniform4fv(o,a);else if("int"===r.type)e.gl.uniform1iv(o,a);else if("ivec2"===r.type)e.gl.uniform2iv(o,a);else if("ivec3"===r.type)e.gl.uniform3iv(o,a);else{if("ivec4"!==r.type)throw Error(`uniform type ${r.type} is not supported yet.`);e.gl.uniform4iv(o,a)}}e.executeProgram()}(this.gpgpu,d,l,c,r),u.forEach((e=>this.disposeIntermediateTensorInfo(e))),h&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)}));const g=(0,O.env)().get("WEBGL_FLUSH_THRESHOLD");if(g>0){const e=O.util.now();e-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=e)}if(!(0,O.env)().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===i){const e=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),e}return a}compileAndRun(e,t,n,r,i=!1){return n=n||t[0].dtype,this.runWebGLProgram(e,t,n,r,i)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||((0,O.env)().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=(0,O.tidy)((()=>{if(!(0,O.env)().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=(0,O.env)().getBool("DEBUG");(0,O.env)().set("DEBUG",!1);const t=this.abs((0,O.scalar)(1e-8)).dataSync()[0];if((0,O.env)().set("DEBUG",e),t>0)return 32}return 16}))),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){const t=this.texData.get(e),{shape:n,dtype:r,values:i,texture:o,usage:a,isPacked:s}=t;if(null!=o)return;const u=null!=this.activeTimers;let l;u&&(l=O.util.now());let c=t.texShape;if(null==c&&(c=Qx(n,s),t.texShape=c),null!=i){const e=Zx(n);let o,a=c[1],p=c[0];const d=i instanceof Uint8Array||i instanceof Uint8ClampedArray;!s&&d||([a,p]=mx(c[0],c[1])),o=s?new V_(e,d):new W_(e,d);const h=d?[p,a]:c,f=this.makeTensorInfo(h,r),g=this.texData.get(f.dataId);g.usage=d?dx.PIXELS:dx.UPLOAD,g.texShape=h,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(f.dataId),a,p,i);const m=[[p,a]],y=!0,b=this.runWebGLProgram(o,[f],r,m,y),v=this.texData.get(b.dataId);t.texShape=v.texShape,t.isPacked=v.isPacked,t.usage=v.usage,(0,O.env)().get("ENGINE_COMPILE_ONLY")?this.disposeData(b.dataId):(t.texture=v.texture,t.values=null,this.texData.delete(b.dataId)),this.disposeIntermediateTensorInfo(f),u&&(this.uploadWaitMs+=O.util.now()-l)}else{const e=this.acquireTexture(c,a,r,s);t.texture=e}}convertAndCacheOnCPU(e,t){const n=this.texData.get(e),{dtype:r}=n;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){const n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length);for(let t=0;t<n.length;++t)n[t]=Math.round(e[t]);return n}throw new Error(`Unknown dtype ${t}`)}(t,r)),n.values}acquireTexture(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const e=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${e} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*O.util.bytesPerElement(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}for(const[,t]of Object.entries(this.binaryCache)){const n=new Promise((e=>{try{this.checkCompletion_(t),e(!0)}catch(e){throw e}}));e.push(n)}return Promise.all(e)}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await(0,O.nextFrame)(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw Tx(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:n,infLoc:r,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:s}=B_(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=r,e.nanLoc=i,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=s}}createTensorFromGPUData(e,t,n){e.channels=e.channels||"RGBA";const{texture:r,height:i,width:o,channels:a}=e,s=(0,O.engine)().backend;if(!s.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=s.writeTexture(r,t,n,i,o,a);return(0,O.engine)().makeTensorFromDataId(u,t,n,s)}}Lk.nextDataId=0;const Pk="4.8.0";function $k(){(0,O.env)().set("WEBGL_FORCE_F16_TEXTURES",!0)}O.device_util.isBrowser()&&(0,O.registerBackend)("webgl",(()=>new Lk),2);const zk={forceHalfFloat:$k},jk="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class Gk{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=O.backend_util.assertAndGetBroadcastShape(t,n),this.enableShapeUniforms=P_(this.outputShape.length),this.userCode=`\n      float binaryOperation(float a, float b) {\n        ${e}\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    `}}const Uk="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class Wk{constructor(e,t,n,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=O.backend_util.assertAndGetBroadcastShape(t,n);const i=this.outputShape.length;this.enableShapeUniforms=P_(i);let o="";if(r)if(0===i||1===O.util.sizeFromShape(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(o=`\n          ${R_(i)} coords = getOutputCoords();\n        `,1===i)this.enableShapeUniforms?o+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":o+=`\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;else{const e=pk("coords",i);this.enableShapeUniforms?o+=`\n            bool nextRowOutOfBounds =\n              (${e[i-2]} + 1) >= outShape[${i} - 2];\n            bool nextColOutOfBounds =\n              (${e[i-1]} + 1) >= outShape[${i} - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `:o+=`\n            bool nextRowOutOfBounds =\n              (${e[i-2]} + 1) >= ${this.outputShape[i-2]};\n            bool nextColOutOfBounds =\n              (${e[i-1]} + 1) >= ${this.outputShape[i-1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `}this.userCode=`\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${e}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${o}\n\n        setOutput(result);\n      }\n    `}}function Vk(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Hk={kernelName:O.Identity,backendName:"webgl",kernelFunc:Vk};function qk(e){const{inputs:t,backend:n}=e,{real:r,imag:i}=t,o=n.makeTensorInfo(r.shape,"complex64"),a=n.texData.get(o.dataId),s=Vk({inputs:{x:r},backend:n}),u=Vk({inputs:{x:i},backend:n});return a.complexTensorInfos={real:s,imag:u},o}const Xk={kernelName:O.Complex,backendName:"webgl",kernelFunc:qk},Yk="return (a < 0.) ? b * a : a;",Kk="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",Jk={kernelName:O.LeakyRelu,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:o}=r,a=n.makeTensorInfo([],"float32",O.util.createScalarValue(o,"float32")),s=(0,O.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wk(Kk,i.shape,a.shape):new Gk(Yk,i.shape,a.shape),u=n.runWebGLProgram(s,[i,a],"float32");return n.disposeIntermediateTensorInfo(a),u}},Zk="return (a < 0.) ? b * a : a;",Qk="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",eS={kernelName:O.Prelu,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r,alpha:i}=t,o=(0,O.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wk(Qk,r.shape,i.shape):new Gk(Zk,r.shape,i.shape);return n.runWebGLProgram(o,[r,i],"float32")}},tS="if (isnan(x)) return x;";function nS({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:r}){return({inputs:i,backend:o})=>{const{x:a}=i,s=o,u=r||a.dtype;if(s.shouldExecuteOnCPU([a])&&null!=n){const e=s.texData.get(a.dataId),t=n(e.values,u);return s.makeTensorInfo(a.shape,u,t)}let l;return l=(0,O.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=t?new Rk(a.shape,t):new bk(a.shape,e),s.runWebGLProgram(l,[a],u)}}function rS({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:o}){return({inputs:a,backend:s})=>{const{a:u,b:l}=a,c=s;if(r&&"complex64"===u.dtype){const t=c.texData.get(u.dataId),n=c.texData.get(l.dataId),[r,i]=[[t.complexTensorInfos.real,n.complexTensorInfos.real],[t.complexTensorInfos.imag,n.complexTensorInfos.imag]].map((t=>{const[n,r]=t,i={dataId:n.dataId,dtype:n.dtype,shape:u.shape},o={dataId:r.dataId,dtype:r.dtype,shape:l.shape},a=new Gk(e,u.shape,l.shape);return c.runWebGLProgram(a,[i,o],(0,O.upcastType)(n.dtype,r.dtype))})),o=qk({inputs:{real:r,imag:i},backend:c});return c.disposeIntermediateTensorInfo(r),c.disposeIntermediateTensorInfo(i),o}const p=o||(0,O.upcastType)(u.dtype,l.dtype);if(("string"===u.dtype||"string"===l.dtype||c.shouldExecuteOnCPU([u,l]))&&null!=i){const e=c.texData.get(u.dataId).values,t=c.texData.get(l.dataId).values,n="string"===u.dtype?O.backend_util.fromUint8ToStringArray(e):e,r="string"===u.dtype?O.backend_util.fromUint8ToStringArray(t):t,[o,a]=i(u.shape,l.shape,n,r,p),s=c.makeTensorInfo(a,p);return c.texData.get(s.dataId).values=o,s}let d;return d=(0,O.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=t?new Wk(t,u.shape,l.shape,n):new Gk(e,u.shape,l.shape),c.runWebGLProgram(d,[u,l],p)}}function iS(e,t=!1){if("linear"===e)return t?Tk:xk;if("relu"===e)return t?Ak:kk;if("elu"===e)return t?Ek:wk;if("relu6"===e)return t?Fk:Sk;if("prelu"===e)return t?Qk:Zk;if("leakyrelu"===e)return t?Kk:Yk;if("sigmoid"===e)return t?Ok:Mk;throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}class oS{constructor(e,t,n,r=!1,i=!1,o=!1,a=null,s=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=P_(this.outputShape.length);const l=r?e[1]:e[2],c=Math.ceil(l/2),p=r?"i * 2, rc.y":"rc.y, i * 2",d=i?"rc.z, i * 2":"i * 2, rc.z",h=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let g="",m="";a&&(g=s?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${a}\n        }`:u?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${a}\n        }`:`vec4 activation(vec4 x) {\n          ${a}\n        }`,m="result = activation(result);");const y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let b="rc.x",v="rc.x";e[0]<t[0]?b=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(v=`imod(rc.x, ${t[0]})`),this.userCode=`\n      ${g}\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ${c}.0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ${b};\n        int batchB = ${v};\n        for (int i = 0; i < ${c}; i++) {\n          vec4 a = getMatrixA(batchA, ${p});\n          vec4 b = getMatrixB(batchB, ${d});\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (${h[0]} * ${f[0]});\n          result += (${h[1]} * ${f[1]});\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ${y}\n\n        ${m}\n\n        setOutput(result);\n      }\n    `}}const aS={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class sS{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=O.backend_util.assertAndGetBroadcastShape(t,n),this.userCode=`\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ${e}\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    `}}const uS="return a * b;";function lS(e){const{inputs:t,backend:n}=e,{a:r,b:i}=t,o=O.backend_util.upcastType(r.dtype,i.dtype);if("complex64"===r.dtype){const e=n.texData.get(r.dataId),t=n.texData.get(i.dataId),o=new sS(aS.REAL,r.shape,i.shape),a=new sS(aS.IMAG,r.shape,i.shape),s=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:r.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:i.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:i.shape}],u=n.runWebGLProgram(o,s,"float32"),l=n.runWebGLProgram(a,s,"float32"),c=qk({inputs:{real:u,imag:l},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(l),c}if(n.shouldExecuteOnCPU([r,i])){const e=n.texData.get(r.dataId),t=n.texData.get(i.dataId),[a,s]=Lw(r.shape,i.shape,e.values,t.values,o),u=n.makeTensorInfo(s,o);return n.texData.get(u.dataId).values=a,u}let a;return a=(0,O.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wk(uS,r.shape,i.shape):new Gk(uS,r.shape,i.shape),n.runWebGLProgram(a,[r,i],o)}const cS={kernelName:O.Multiply,backendName:"webgl",kernelFunc:lS};function pS(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:o}=r,a=n,s=O.util.sizeFromShape(i.shape),u=O.util.inferFromImplicitShape(o,s),l=O.util.sizeFromShape(u);O.util.assert(s===l,(()=>`The new shape (${u}) has ${l} elements and the old shape (${i.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`));const c=a.texData.get(i.dataId);return!c.isPacked||t_(i.shape,u)||null!==c.texture&&t_(c.shape,u)?(a.incRef(i.dataId),{dataId:i.dataId,shape:u,dtype:i.dtype}):function(e,t,n){const r=[Kx(e.shape),...Jx(e.shape)],i={dtype:e.dtype,shape:r,dataId:e.dataId},o=[Kx(t),...Jx(t)],a=new hk(o,r),s=[r],u=n.runWebGLProgram(a,[i],e.dtype,s,!0);return{dataId:u.dataId,shape:t,dtype:u.dtype}}(i,u,a)}const dS={kernelName:O.Reshape,backendName:"webgl",kernelFunc:pS};class hS{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];const a=4*Math.floor(n/4),s=n%4;let u="sumValue += dot(values, ones);";if(null!=t){const e=1/t;u=`sumValue += dot(values * ${O.util.isInt(e)?e.toPrecision(2):e}, ones);`}let l="";i%n>0&&(l=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return 0.0;\n        }\n      `),this.userCode=`\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${l}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${a}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${u}\n        }\n\n        int inIdx = inOffset + ${a};\n        if (${1===s}) {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ${u}\n        } else if (${2===s}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ${u}\n        } else if (${3===s}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ${u}\n        }\n        setOutput(sumValue);\n      }\n    `}}class fS{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];let a="0.0",s="";"prod"===t?a="1.0":"min"===t?(a="1.0 / 1e-20",s="min"):"max"===t&&(a="-1.0 / 1e-20",s="max");let u=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"sum"===t?u="sumValue":"prod"===t?u="prodValue":"all"===t?u="allValue":"any"===t&&(u="anyValue");const l=4*Math.floor(n/4),c=n%4;let p=`\n      if (${"sum"===t}) {\n        sumValue += dot(values, ones);\n      } else if (${"prod"===t}) {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ${s}(values, minMaxValue);\n        if (${"min"===t} || ${"max"===t}) {\n          minMaxValue = ${s}(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    `,d="vec4";"all"===t?(a="1.0",p="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===t&&(a="0.0",p="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");let h="";i%n>0&&(h=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return initializationValue;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${a};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${h}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        vec4 minMaxValue = vec4(${a});\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ${l}; i += 4) {\n          int inIdx = inOffset + i;\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${p}\n        }\n\n        int inIdx = inOffset + ${l};\n        if (${1===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ${p}\n        } else if (${2===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ${p}\n        } else if (${3===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ${p}\n        }\n        setOutput(${u});\n      }\n    `}}function gS(e,t,n,r){const i=function(e){const t=[];for(;0===t.length||1!==t[t.length-1].outSize;){const n=t.length?t[t.length-1].outSize:e[1],r=O.backend_util.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape);let o=e;for(let a=0;a<i.length;a++){const{inSize:s,windowSize:u,outSize:l}=i[a];let c,p;c="mean"===n?0===a?new hS({windowSize:u,inSize:s,batchSize:e.shape[0],outSize:l},s):new hS({windowSize:u,inSize:s,batchSize:e.shape[0],outSize:l}):new fS({windowSize:u,inSize:s,batchSize:e.shape[0],outSize:l},n),p=o,o=r.runWebGLProgram(c,[o],t),p.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(p)}return o}class mS{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;const r=R_(this.rank),i=function(e){const t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let t=0;t<e.length;t++)r[e[t]]=n[t];return r.join()}(t);this.userCode=`\n    void main() {\n      ${r} resRC = getOutputCoords();\n      setOutput(getA(${i}));\n    }\n    `}}class yS{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=R_(this.rank),i=ck("rc",this.rank),o=new Array(this.rank);for(let e=0;e<t.length;e++)o[t[e]]=i[e];const a=`vec2(${o.slice(-2).join()})`,s=`++${i[this.rank-1]} < ${n[this.rank-1]}`,u=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`\n    void main() {\n      ${r} rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ${u};\n      if(${s}) {\n        result[1] = ${u};\n      }\n      --${i[this.rank-1]};\n      if(++${i[this.rank-2]} < ${n[this.rank-2]}) {\n        result[2] = ${u};\n        if(${s}) {\n          result[3] = ${u};\n        }\n      }\n      setOutput(result);\n    }\n    `}}function bS(e,t,n){const r=(0,O.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new yS(e.shape,t):new mS(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function vS(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:a}=r;return function(e,t,n,r){const i=t,o=e.shape.length,a=O.util.parseAxisParam(i,e.shape);let s=a;const u=O.backend_util.getAxesPermutation(s,o),l=null!=u;let c=e;l&&(c=bS(e,u,r),s=O.backend_util.getInnerMostAxes(s.length,o)),O.backend_util.assertAxesAreInnerMostDims("sum",s,o);const[p,d]=O.backend_util.computeOutAndReduceShapes(c.shape,s);let h=p;n&&(h=O.backend_util.expandShapeToKeepDim(p,a));const f=O.util.sizeFromShape(d),g=pS({inputs:{x:c},attrs:{shape:[O.util.sizeFromShape(e.shape)/f,f]},backend:r}),m=gS(g,(0,O.sumOutType)(e.dtype),"sum",r),y=pS({inputs:{x:m},attrs:{shape:h},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(m),l&&r.disposeIntermediateTensorInfo(c),y}(i,o,a,n)}const xS={kernelName:O.Sum,backendName:"webgl",kernelFunc:vS};function _S(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{perm:o}=r,a=n,s=i.shape.length,u=new Array(s);for(let e=0;e<u.length;e++)u[e]=i.shape[o[e]];let l;if(a.shouldExecuteOnCPU([i])){const e=a.texData.get(i.dataId).values,t=uk(e,i.shape,i.dtype,o,u);l=a.makeTensorInfo(u,i.dtype),a.texData.get(l.dataId).values=t}else l=bS(i,o,a);return l}const wS={kernelName:O.Transpose,backendName:"webgl",kernelFunc:_S},kS=1e3;function SS({a:e,b:t,transposeA:n,transposeB:r,backend:i,bias:o=null,preluActivationWeights:a=null,leakyreluAlpha:s=0,activation:u=null}){const l=e.shape.length,c=t.shape.length,p=n?e.shape[l-2]:e.shape[l-1],d=r?t.shape[c-1]:t.shape[c-2],h=n?e.shape[l-1]:e.shape[l-2],f=r?t.shape[c-2]:t.shape[c-1],g=e.shape.slice(0,-2),m=t.shape.slice(0,-2),y=O.util.sizeFromShape(g),b=O.util.sizeFromShape(m),v=O.broadcast_util.assertAndGetBroadcastShape(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([h,f]);O.util.assert(p===d,(()=>`Error in matMul: inner shapes (${p}) and (${d}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${r} must match.`));const x=n?[y,p,h]:[y,h,p],_=r?[b,f,d]:[b,d,f],w=pS({inputs:{x:e},backend:i,attrs:{shape:x}}),k=pS({inputs:{x:t},backend:i,attrs:{shape:_}}),S=[w,k],C=Math.max(y,b),M=n?w.shape[1]:w.shape[2],T=null!=o,E=null!=a,A="leakyrelu"===u,F=null!=u?iS(u,!0):null;let R;if((1===h||1===f)&&M>kS&&!1===(T||E||A||null!=F)){let e=w,t=k;n&&(e=_S({inputs:{x:w},backend:i,attrs:{perm:[0,2,1]}}),S.push(e)),r&&(t=_S({inputs:{x:k},backend:i,attrs:{perm:[0,2,1]}}),S.push(t));const o=1===f;let a=e;1!==f&&(a=pS({inputs:{x:e},backend:i,attrs:{shape:[C,M,1]}}),S.push(a));const s=1===f?2:1;let u=t;o&&(u=pS({inputs:{x:t},backend:i,attrs:{shape:[C,1,M]}}),S.push(u));const l=lS({inputs:{a,b:u},backend:i});R=vS({inputs:{x:l},backend:i,attrs:{axis:s,keepDims:!0}}),S.push(l)}else{const u=(0,O.upcastType)(e.dtype,t.dtype),l=new oS(x,_,[C,h,f],n,r,T,F,E,A),c=[w,k];if(null!=o&&c.push(o),E&&c.push(a),A){const e=i.makeTensorInfo([],"float32",O.util.createScalarValue(s,"float32"));c.push(e),S.push(e)}R=i.runWebGLProgram(l,c,u)}const N=pS({inputs:{x:R},backend:i,attrs:{shape:v}});S.push(R);for(const e of S)i.disposeIntermediateTensorInfo(e);return N}const CS={kernelName:O._FusedMatMul,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:o,bias:a,preluActivationWeights:s}=t,{transposeA:u,transposeB:l,activation:c,leakyreluAlpha:p}=r;return SS({a:i,b:o,transposeA:u,transposeB:l,backend:n,bias:a,preluActivationWeights:s,leakyreluAlpha:p,activation:c})}},MS="return abs(x);",TS={kernelName:O.Abs,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){const e=n.texData.get(r.dataId),t=Xw(e.values);return n.makeTensorInfo(r.shape,r.dtype,t)}let i;return i=(0,O.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Rk(r.shape,MS):new bk(r.shape,MS),n.runWebGLProgram(i,[r],r.dtype)}},ES=nS({opSnippet:vk+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),AS={kernelName:O.Acos,backendName:"webgl",kernelFunc:ES},FS=nS({opSnippet:vk+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),OS={kernelName:O.Acosh,backendName:"webgl",kernelFunc:FS},RS="return a + b;",NS=rS({opSnippet:RS,packedOpSnippet:RS,supportsComplex:!0,cpuKernelImpl:gw}),DS={kernelName:O.Add,backendName:"webgl",kernelFunc:NS};class IS{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(((e,t)=>`T${t}`));const n=[];this.variableNames.forEach((e=>{n.push(`float v${e} = get${e}AtOutCoords();`)}));const r=this.variableNames.map((e=>`v${e}`)).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        float result = ${r};\n        setOutput(result);\n      }\n    `}}class BS{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(((e,t)=>`T${t}`));const n=[];this.variableNames.forEach((e=>{n.push(`vec4 v${e} = get${e}AtOutCoords();`)}));const r=this.variableNames.map((e=>`v${e}`)).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        vec4 result = ${r};\n        setOutput(result);\n      }\n    `}}const LS={kernelName:O.AddN,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r}=t,i=n;if(1===i.length)return Vk({inputs:{x:i[0]},backend:r});if(i.length>(0,O.env)().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const t=Math.floor(i.length/2),n=e({inputs:i.slice(0,t),backend:r}),o=e({inputs:i.slice(t),backend:r});return e({inputs:[n,o],backend:r})}const o=i.map((e=>e.dtype)).reduce(((e,t)=>(0,O.upcastType)(e,t))),a=i.map((e=>e.shape)),s=(0,O.env)().getBool("WEBGL_PACK")?new BS(i[0].shape,a):new IS(i[0].shape,a);return r.runWebGLProgram(s,i,o)}},PS={kernelName:O.All,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:a}=r,s=i.shape.length,u=O.util.parseAxisParam(o,i.shape);let l=u;const c=O.backend_util.getAxesPermutation(l,s);let p=i;null!=c&&(p=_S({inputs:{x:i},backend:n,attrs:{perm:c}}),l=O.backend_util.getInnerMostAxes(l.length,s)),O.backend_util.assertAxesAreInnerMostDims("all",l,s);const[d,h]=O.backend_util.computeOutAndReduceShapes(p.shape,l),f=pS({inputs:{x:p},backend:n,attrs:{shape:[-1,O.util.sizeFromShape(h)]}}),g=gS(f,f.dtype,"all",n);let m;return m=pS(a?{inputs:{x:g},backend:n,attrs:{shape:O.backend_util.expandShapeToKeepDim(d,u)}}:{inputs:{x:g},backend:n,attrs:{shape:d}}),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),null!=c&&n.disposeIntermediateTensorInfo(p),m}},$S={kernelName:O.Any,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:a}=r,s=i.shape.length,u=O.util.parseAxisParam(o,i.shape);let l=u;const c=O.backend_util.getAxesPermutation(l,s);let p=i;null!=c&&(p=_S({inputs:{x:i},backend:n,attrs:{perm:c}}),l=O.backend_util.getInnerMostAxes(l.length,s)),O.backend_util.assertAxesAreInnerMostDims("any",l,s);const[d,h]=O.backend_util.computeOutAndReduceShapes(p.shape,l),f=pS({inputs:{x:p},backend:n,attrs:{shape:[-1,O.util.sizeFromShape(h)]}}),g=gS(f,f.dtype,"any",n);let m;return m=pS(a?{inputs:{x:g},backend:n,attrs:{shape:O.backend_util.expandShapeToKeepDim(d,u)}}:{inputs:{x:g},backend:n,attrs:{shape:d}}),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),null!=c&&n.disposeIntermediateTensorInfo(p),m}};class zS{constructor(e,t,n){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:o}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a="max"===t?">":"<",s=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ${r}; i++) {\n          int inIdx = ${s};\n          float candidate = getA(batch, inIdx);\n          if (candidate ${a} bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    `}}class jS{constructor(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,O.util.assert(e.length>2,(()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`));const i=e[e.length-1],o=Math.ceil(i/t);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,s=a.length,u=R_(s),l=pk("coords",s);let c,p;if(1===o){p=s+1;const e=R_(p);c=`\n        ${e} sourceLocR = ${e}(${l.join()}, 0);\n        ++${l[s-1]};\n        ${e} sourceLocG = ${e}(${l.join()}, 0);\n        ++${l[s-2]};\n        ${e} sourceLocA = ${e}(${l.join()}, 0);\n        --${l[s-1]};\n        ${e} sourceLocB = ${e}(${l.join()}, 0);\n        --${l[s-2]};`}else p=s,c=`\n        ${u} sourceLocR = coords;\n        ++${l[s-1]};\n        ${u} sourceLocG = coords;\n        ++${l[s-2]};\n        ${u} sourceLocA = coords;\n        --${l[s-1]};\n        ${u} sourceLocB = coords;\n        --${l[s-2]};`;const d=["x","y","z","w","u","v"].slice(0,p),h="."+d[p-1],f=d.map((e=>"int "+e)),g=pk("sourceLocR",p-1).concat("inIdx.r"),m=pk("sourceLocG",p-1).concat("inIdx.g"),y=pk("sourceLocB",p-1).concat("inIdx.b"),b=pk("sourceLocA",p-1).concat("inIdx.a"),v="max"===n?"greaterThan":"lessThan",x=r?"":`\n          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),\n                             getBestIndicesAChannel(${m.join()}),\n                             getBestIndicesAChannel(${y.join()}),\n                             getBestIndicesAChannel(${b.join()})));`,_=`vec4(\n            getAChannel(${g.join()}),\n            hasNextCol ? getAChannel(${m.join()}) : 0.,\n            hasNextRow ? getAChannel(${y.join()}) : 0.,\n            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,w=r?"":`\n      float getBestIndicesAChannel(${f.join()}) {\n        return getChannel(getBestIndicesA(${d.join()}),\n                                          vec2(${d.slice(-2).join()}));\n      }`;this.userCode=`\n      float getAChannel(${f.join()}) {\n        return getChannel(getA(${d.join()}),\n                               vec2(${d.slice(-2).join()}));\n      }\n      ${w}\n      void main() {\n        ${u} coords = getOutputCoords();\n        bool hasNextCol = ${l[s-1]} < ${a[s-1]-1};\n        bool hasNextRow = ${l[s-2]} < ${a[s-2]-1};\n        ${c}\n        ivec4 srcIdx = ivec4(sourceLocR${h}, sourceLocG${h},\n          sourceLocB${h}, sourceLocA${h}) * ${t};\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ${_};\n\n        for (int i = 0; i < ${t}; i++) {\n          inIdx = srcIdx;\n          ${x}\n          vec4 candidate = ${_};\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(${v}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    `}}function GS(e,t,n,r=null){let i=t.shape[0],o=t.shape[1];null!=r&&(i=r.shape[0],o=r.shape[1]);const a=O.backend_util.computeOptimalWindowSize(o),s={windowSize:a,inSize:o,batchSize:i,outSize:Math.ceil(o/a)},u=new zS(s,n,null==r),l=[t];null!=r&&l.push(r);const c=e.runWebGLProgram(u,l,"int32");if(1===c.shape[1])return c;const p=GS(e,t,n,c);return e.disposeIntermediateTensorInfo(c),p}function US(e,t,n,r=null){const i=null!=r?r.shape:t.shape,o=i[i.length-1],a=O.backend_util.computeOptimalWindowSize(o),s=new jS(i,a,n,null==r),u=null==r?[t]:[t,r],l=e.runWebGLProgram(s,u,"int32");if(l.shape.length===t.shape.length){const r=US(e,t,n,l);return e.disposeIntermediateTensorInfo(l),r}return l}function WS(e,t,n,r){const i=[n];if(O.backend_util.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,t.shape.length),!(0,O.env)().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const n=[],o=e.texData.get(t.dataId);let a=t;null!==o&&o.isPacked&&(a=e.unpackTensor(t),n.push(a));const[s,u]=O.backend_util.computeOutAndReduceShapes(a.shape,i),l=O.util.sizeFromShape(u),c=pS({inputs:{x:a},backend:e,attrs:{shape:[-1,l]}});n.push(c);const p=GS(e,c,r);n.push(p);const d=pS({inputs:{x:p},backend:e,attrs:{shape:s}});return n.forEach((t=>e.disposeIntermediateTensorInfo(t))),d}return US(e,t,r)}const VS={kernelName:O.ArgMax,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o}=r;let a=O.util.parseAxisParam(o,i.shape);const s=O.backend_util.getAxesPermutation(a,i.shape.length);let u=i;const l=[];null!=s&&(u=_S({inputs:{x:i},backend:n,attrs:{perm:s}}),l.push(u),a=O.backend_util.getInnerMostAxes(a.length,u.shape.length)),O.backend_util.assertAxesAreInnerMostDims("argMax",[a[0]],u.shape.length);const c=WS(n,u,a[0],"max");return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),c}},HS={kernelName:O.ArgMin,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o}=r;let a=O.util.parseAxisParam(o,i.shape);const s=O.backend_util.getAxesPermutation(a,i.shape.length);let u=i;const l=[];null!=s&&(u=_S({inputs:{x:i},backend:n,attrs:{perm:s}}),l.push(u),a=O.backend_util.getInnerMostAxes(a.length,u.shape.length)),O.backend_util.assertAxesAreInnerMostDims("argMin",[a[0]],u.shape.length);const c=WS(n,u,a[0],"min");return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),c}},qS=nS({opSnippet:vk+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),XS={kernelName:O.Asin,backendName:"webgl",kernelFunc:qS},YS=nS({opSnippet:vk+"return log(x + sqrt(x * x + 1.0));"}),KS={kernelName:O.Asinh,backendName:"webgl",kernelFunc:YS},JS=nS({opSnippet:vk+"\n  return atan(x);\n"}),ZS={kernelName:O.Atan,backendName:"webgl",kernelFunc:JS},QS=rS({opSnippet:jk+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Uk+"\n  return result;\n"}),eC={kernelName:O.Atan2,backendName:"webgl",kernelFunc:QS},tC=nS({opSnippet:vk+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),nC={kernelName:O.Atanh,backendName:"webgl",kernelFunc:tC};class rC{constructor(e,t,n,r=!1,i=!1){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterHeight,p=e.effectiveFilterWidth,d=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;const f="avg"===t,g=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,m=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let y="0.0";if(f||(y="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode=`\n        const ivec2 strides = ivec2(${a}, ${s});\n        const ivec2 pads = ivec2(${d}, ${h});\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ${c};\n              wR += ${u}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${p};\n                wC += ${l}) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ${t} currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ${r?i?g:m:`wR * ${p} + wC`};\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}let b=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===t&&(b="avgValue / max(count, 1.0)");const v=4*Math.floor(o/4),x=o%4,_=`\n      if (${f}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec2 strides = ivec2(${a}, ${s});\n      const ivec2 pads = ivec2(${d}, ${h});\n      const float initializationValue = ${y};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ${e.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${y});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ${c};\n            wR += ${u}) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ${e.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${v}; wC += 4) {\n            int xC = xCCorner + wC * ${l};\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${l}, d),\n              getValue(batch, xR, xC + 2 * ${l}, d),\n              getValue(batch, xR, xC + 3 * ${l}, d)\n            );\n\n            ${_}\n          }\n\n          int xC = xCCorner + ${v};\n          if (${1===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ${_}\n          } else if (${2===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${l}, d),\n              initializationValue,\n              initializationValue\n            );\n\n            ${_}\n          } else if (${3===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${l}, d),\n              getValue(batch, xR, xC + 2 * ${l}, d),\n              initializationValue\n            );\n\n            ${_}\n          }\n        }\n        setOutput(${b});\n      }\n    `}}class iC{constructor(e,t,n,r=!1,i=!1){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,s=e.strideHeight,u=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,p=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,g=e.padInfo.front,m=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const b="avg"===t;let v="0.0";if(b||(v="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode=`\n        const ivec3 strides =\n            ivec3(${a}, ${s}, ${u});\n        const ivec3 pads = ivec3(${g}, ${m}, ${y});\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ${d};\n              wD += ${l}) {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ${e.inDepth}) {\n              continue;\n            }\n\n            for (int wR = 0; wR < ${h};\n                wR += ${c}) {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ${e.inHeight}) {\n                continue;\n              }\n\n              for (int wC = 0; wC < ${f};\n                  wC += ${p}) {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ${e.inWidth}) {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ${t} currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ${r?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${h} * ${f} +\n                      wR * ${f} + wC`};\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}let x=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===t&&(x="avgValue / max(count, 1.0)");const _=4*Math.floor(o/4),w=o%4,k=`\n      if (${b}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec3 strides =\n        ivec3(${a}, ${s}, ${u});\n      const ivec3 pads = ivec3(${g}, ${m}, ${y});\n      const float initializationValue = ${v};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ${e.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${v});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ${d};\n            wD += ${l}) {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ${e.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${h};\n            wR += ${c}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${_}; wC += 4) {\n              int xC = xCCorner + wC * ${p};\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${p}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${p}, ch),\n                getValue(batch, xD, xR, xC + 3 * ${p}, ch)\n              );\n\n              ${k}\n            }\n\n            int xC = xCCorner + ${_};\n            if (${1===w}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ${k}\n            } else if (${2===w}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${p}, ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ${k}\n            } else if (${3===w}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${p}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${p}, ch),\n                initializationValue\n              );\n\n              ${k}\n            }\n          }\n        }\n        setOutput(${x});\n      }\n    `}}const oC={kernelName:O.AvgPool,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;g_(i,"avgPool");const{filterSize:o,strides:a,pad:s,dimRoundingMode:u}=r;O.util.assert(O.backend_util.eitherStridesOrDilationsAreOne(a,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '1'`));const l=O.backend_util.computePool2DInfo(i.shape,o,a,1,s,u);if(1===l.filterWidth&&1===l.filterHeight&&O.util.arraysEqual(l.inShape,l.outShape))return Vk({inputs:{x:i},backend:n});const c=new rC(l,"avg",!1);return n.runWebGLProgram(c,[i],"float32")}},aC={kernelName:O.AvgPool3D,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:o,strides:a,pad:s,dimRoundingMode:u,dataFormat:l}=r,c=O.backend_util.computePool3DInfo(i.shape,o,a,[1,1,1],s,u,l),p=new iC(c,"avg",!1);return n.runWebGLProgram(p,[i],"float32")}};class sC{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=s-1-e.padInfo.top,c=u-1-e.padInfo.left,p=1/(t*n);this.userCode=`\n      const ivec2 pads = ivec2(${l}, ${c});\n      const float avgMultiplier = float(${p});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${s};\n            wR += ${o}) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${u};\n            wC+= ${a}) {\n            float dyC = float(dyCCorner + wC) / ${i}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class uC{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,p=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=c-1-e.padInfo.front,f=p-1-e.padInfo.top,g=d-1-e.padInfo.left,m=1/(t*n*r);this.userCode=`\n      const ivec3 pads = ivec3(${h}, ${f}, ${g});\n      const float avgMultiplier = float(${m});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${c};\n            wD += ${s}) {\n          float dyD = float(dyDCorner + wD) / ${i}.0;\n\n          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${p};\n              wR += ${u}) {\n            float dyR = float(dyRCorner + wR) / ${o}.0;\n\n            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${d};\n                wC += ${l}) {\n              float dyC = float(dyCCorner + wC) / ${a}.0;\n\n              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const lC={kernelName:O.AvgPool3DGrad,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:o}=t,a=o,{filterSize:s,strides:u,pad:l,dimRoundingMode:c}=r,p=O.backend_util.computePool3DInfo(a.shape,s,u,[1,1,1],l,c),d=new uC(p);return n.runWebGLProgram(d,[i],a.dtype)}},cC={kernelName:O.AvgPoolGrad,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:o}=t,a=o;g_([i,o],"avgPoolGrad");const{filterSize:s,strides:u,pad:l}=r,c=O.backend_util.computePool2DInfo(a.shape,s,u,1,l),p=new sC(c);return n.runWebGLProgram(p,[i],a.dtype)}},pC={kernelName:O.BatchMatMul,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:o}=t,{transposeA:a,transposeB:s}=r;return SS({a:i,b:o,transposeA:a,transposeB:s,backend:n})}};class dC{constructor(e,t,n,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],O.backend_util.assertAndGetBroadcastShape(e,t),O.backend_util.assertAndGetBroadcastShape(e,n);let a="0.0";null!=r&&(O.backend_util.assertAndGetBroadcastShape(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let s="1.0";null!=i&&(O.backend_util.assertAndGetBroadcastShape(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ${a};\n        float scale = ${s};\n        float inv = scale * inversesqrt(variance + float(${o}));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    `}}class hC{constructor(e,t,n,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],O.backend_util.assertAndGetBroadcastShape(e,t),O.backend_util.assertAndGetBroadcastShape(e,n);let a="vec4(0.0)";null!=r&&(O.backend_util.assertAndGetBroadcastShape(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let s="vec4(1.0)";null!=i&&(O.backend_util.assertAndGetBroadcastShape(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`\n      void main() {\n        vec4 offset = ${a};\n        vec4 scale = ${s};\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(${o}));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    `}}const fC={kernelName:O.FusedBatchNorm,backendName:"webgl",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,mean:i,variance:o,offset:a,scale:s}=e;O.util.assert(i.shape.length===o.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),O.util.assert(null==a||i.shape.length===a.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),O.util.assert(null==s||i.shape.length===s.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));let{varianceEpsilon:u}=n;null==u&&(u=.001);const l=[r,i,o];let c=null;null!=a&&(c=a.shape,l.push(a));let p=null;null!=s&&(p=s.shape,l.push(s));const d=(0,O.env)().getBool("WEBGL_PACK_NORMALIZATION")?new hC(r.shape,i.shape,o.shape,c,p,u):new dC(r.shape,i.shape,o.shape,c,p,u);return t.runWebGLProgram(d,l,l[0].dtype)}};class gC{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=R_(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=function(e){if(1===e)return"sourceLoc";if(e<=6)return mC.slice(0,e).map((e=>"sourceLoc."+e)).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}(this.rank);let r;r=`\n        ${t} sourceLoc;\n        ${t} coords = getOutputCoords();\n        ${e.map(((e,t)=>`sourceLoc.${mC[t]} = start[${t}] + coords.${mC[t]};`)).join("\n")}\n      `,this.userCode=`\n      void main() {\n        ${r}\n        setOutput(getSource(${n}));\n      }\n    `}}const mC=["x","y","z","w","u","v"];class yC{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=R_(this.rank),n=pk("coords",this.rank),r=pk("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":`vec2(${r.slice(-2).join()})`,o=`getChannel(getSource(${r.join()}), ${i})`,a=`\n      result.x = ${o};\n      if (++${n[this.rank-1]} < ${e[this.rank-1]}) {\n        ++${r[this.rank-1]};\n        result.y = ${o};\n        --${r[this.rank-1]};\n      }\n    `,s=1===this.rank?"":`\n      --${n[this.rank-1]};\n      if (++${n[this.rank-2]} < ${e[this.rank-2]}) {\n        ++${r[this.rank-2]};\n        result.z = ${o};\n        if (++${n[this.rank-1]} < ${e[this.rank-1]}) {\n          ++${r[this.rank-1]};\n          result.w = ${o};\n        }\n      }\n    `,u=this.rank<=4?`sourceLoc = coords +\n            ${t}(${e.map(((e,t)=>`start[${t}]`)).join()});`:e.map(((e,t)=>`${r[t]} = ${n[t]} + start[${t}];`)).join("\n");this.userCode=`\n      void main() {\n        ${t} coords = getOutputCoords();\n        ${t} sourceLoc;\n        ${u}\n        vec4 result = vec4(0.);\n        ${a}\n        ${s}\n        setOutput(result);\n      }\n    `}}function bC(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:o,size:a}=r,[s,u]=O.slice_util.parseSliceParams(i,o,a);if(O.slice_util.assertParamsValid(i,s,u),0===O.util.sizeFromShape(u))return n.makeTensorInfo(u,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||"string"===i.dtype){const e=n.texData.get(i.dataId),t=Yw(e.values,s,u,i.shape,i.dtype);return n.makeTensorInfo(u,i.dtype,t)}const{isPacked:l}=n.texData.get(i.dataId),c=O.slice_util.isSliceContinous(i.shape,s,u);if(l||!c){const e=(0,O.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new yC(u):new gC(u),t=[s];return n.runWebGLProgram(e,[i],i.dtype,t)}return n.uploadToGPU(i.dataId),function(e,t,n,r){const i=r.texData.get(e.dataId),o=r.makeTensorInfo(n,e.dtype),a=r.texData.get(o.dataId);Object.assign(a,i),a.refCount=1,a.shape=n,a.dtype=e.dtype;let s=O.slice_util.computeFlatOffset(t,O.util.computeStrides(e.shape));i.slice&&(s+=i.slice.flatOffset),a.slice={flatOffset:s,origDataId:i.slice&&i.slice.origDataId||e.dataId};const u=r.dataRefCount.get(a.slice.origDataId)||1;return r.dataRefCount.set(a.slice.origDataId,u+1),o}(i,s,u,n)}const vC={kernelName:O.Slice,backendName:"webgl",kernelFunc:bC},xC={kernelName:O.BatchToSpaceND,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:o,crops:a}=r;O.util.assert(i.shape.length<=4,(()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"));const s=o.reduce(((e,t)=>e*t)),u=O.backend_util.getReshaped(i.shape,o,s),l=O.backend_util.getPermuted(u.length,o.length),c=O.backend_util.getReshapedPermuted(i.shape,o,s),p=O.backend_util.getSliceBeginCoords(a,o.length),d=O.backend_util.getSliceSize(c,a,o.length),h=[],f=pS({inputs:{x:i},backend:n,attrs:{shape:u}}),g=_S({inputs:{x:f},backend:n,attrs:{perm:l}}),m=pS({inputs:{x:g},backend:n,attrs:{shape:c}}),y=bC({inputs:{x:m},backend:n,attrs:{begin:p,size:d}});return h.push(f),h.push(g),h.push(m),h.forEach((e=>n.disposeIntermediateTensorInfo(e))),y}},_C={kernelName:O.Bincount,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:o}=t,{size:a}=r,s=n.readSync(i.dataId),u=n.readSync(o.dataId),l=mw(s,u,o.dtype,o.shape,a);return n.makeTensorInfo([a],o.dtype,l)}},wC={kernelName:O.BitwiseAnd,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{a:r,b:i}=t,o=(0,O.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"),a=(0,O.env)().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,i])||1===a){const e=n.texData.get(r.dataId).values,t=n.texData.get(i.dataId).values,[o,a]=bw(r.shape,i.shape,e,t,r.dtype),s=n.makeTensorInfo(a,r.dtype);return n.texData.get(s.dataId).values=o,s}let s;return s=o?new Wk("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",r.shape,i.shape,!1):new Gk("\n  return float(int(a.r) & int(b.r));\n",r.shape,i.shape),n.runWebGLProgram(s,[r,i],r.dtype)}},kC={kernelName:O.BroadcastArgs,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{s0:r,s1:i}=t,o=n.readSync(r.dataId),a=n.readSync(i.dataId),s=O.backend_util.assertAndGetBroadcastShape(Array.from(o),Array.from(a));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},SC=rS({opSnippet:"return float(a != b);",cpuKernelImpl:$w,dtype:"bool"}),CC={kernelName:O.NotEqual,backendName:"webgl",kernelFunc:SC};function MC(e){const{inputs:t,backend:n}=e,{input:r}=t;return Vk({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}const TC={kernelName:O.Real,backendName:"webgl",kernelFunc:MC},EC={kernelName:O.Cast,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r,attrs:i}=t,{x:o}=n,{dtype:a}=i;if("complex64"===a){if("complex64"===o.dtype)return Vk({inputs:{x:o},backend:r});const t=O.zeros(o.shape),n=e({inputs:{x:o},backend:r,attrs:{dtype:"float32"}}),i=qk({inputs:{real:n,imag:t},backend:r});return t.dispose(),r.disposeIntermediateTensorInfo(n),i}if("complex64"===o.dtype){const t=MC({inputs:{input:o},backend:r}),n=e({inputs:{x:t},backend:r,attrs:{dtype:a}});return r.disposeIntermediateTensorInfo(t),n}if(!O.util.hasEncodingLoss(o.dtype,a)){const e=Vk({inputs:{x:o},backend:r});return{dataId:e.dataId,shape:e.shape,dtype:a}}if(r.shouldExecuteOnCPU([o])){const e=r.texData.get(o.dataId).values,[t,n,i]=vw(e,o.shape,o.dtype,a);return r.makeTensorInfo(t,n,i)}if("int32"===a)return function(e,t){const n=new bk(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(o,r);if("bool"===a){const e=r.makeTensorInfo([],"bool",O.util.getTypedArrayFromDType("bool",1)),t=SC({inputs:{a:o,b:e},backend:r});return r.disposeIntermediateTensorInfo(e),t}throw new Error(`Error in Cast: failed to cast ${o.dtype} to ${a}`)}},AC="return ceil(x);",FC=nS({opSnippet:AC,packedOpSnippet:AC,cpuKernelImpl:xw}),OC={kernelName:O.Ceil,backendName:"webgl",kernelFunc:FC};class RC{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class NC{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}const DC={kernelName:O.ClipByValue,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{clipValueMin:o,clipValueMax:a}=r;let s;s=(0,O.env)().getBool("WEBGL_PACK_CLIP")?new NC(i.shape):new RC(i.shape);const u=[[o],[a]];return n.runWebGLProgram(s,[i],i.dtype,u)}};class IC{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function BC(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}const LC={kernelName:O.ComplexAbs,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,i=n.texData.get(r.dataId),o=new IC(r.shape),a=[BC(r,i.complexTensorInfos.real),BC(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(o,a,a[0].dtype)}};class PC{constructor(e){this.outputShape=[],this.outputShape=O.backend_util.computeOutShape(e,1),this.variableNames=e.map(((e,t)=>`T${t}`));const t=new Array(e.length-1);t[0]=e[0][1];for(let n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];const n=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let e=1;e<t.length;e++){const r=t[e-1];n.push(`else if (yC < ${t[e]}) setOutput(getT${e}(yR, yC-${r}));`)}const r=t.length,i=t[t.length-1];n.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ${n.join("\n        ")}\n      }\n    `}}class $C{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=O.backend_util.computeOutShape(e,t);const n=this.outputShape,r=n.length,i=R_(r),o=pk("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(((e,t)=>`T${t}`));const s=new Array(e.length-1);s[0]=e[0][t];for(let n=1;n<s.length;n++)s[n]=s[n-1]+e[n][t];const u=a[t],l=a.slice(-2),c=a.join();let p=`if (${u} < ${s[0]}) {\n        return getChannel(\n            getT0(${c}), vec2(${l.join()}));\n        }`;for(let e=1;e<s.length;e++){const t=s[e-1];p+=`\n        if (${u} < ${s[e]}  && ${u} >= ${s[e-1]}) {\n          return getChannel(\n            getT${e}(${zC(a,u,t)}),\n            vec2(${zC(l,u,t)}));\n        }`}const d=s.length,h=s[s.length-1];p+=`\n        return getChannel(\n          getT${d}(${zC(a,u,h)}),\n          vec2(${zC(l,u,h)}));`,this.userCode=`\n      float getValue(${a.map((e=>"int "+e))}) {\n        ${p}\n      }\n\n      void main() {\n        ${i} coords = getOutputCoords();\n        vec4 result = vec4(getValue(${o}), 0., 0., 0.);\n\n        ${o[r-1]} = ${o[r-1]} + 1;\n        if (${o[r-1]} < ${n[r-1]}) {\n          result.g = getValue(${o});\n        }\n\n        ${o[r-2]} = ${o[r-2]} + 1;\n        if (${o[r-2]} < ${n[r-2]}) {\n          result.a = getValue(${o});\n        }\n\n        ${o[r-1]} = ${o[r-1]} - 1;\n        if (${o[r-2]} < ${n[r-2]} &&\n            ${o[r-1]} < ${n[r-1]}) {\n          result.b = getValue(${o});\n        }\n        setOutput(result);\n      }\n    `}}function zC(e,t,n){const r=e.indexOf(t);return e.map(((e,t)=>t===r?`${e} - ${n}`:e)).join()}function jC(e){const{inputs:t,backend:n}=e,{input:r}=t;return Vk({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}const GC={kernelName:O.Imag,backendName:"webgl",kernelFunc:jC};function UC(e,t,n){const r=e[0].dtype;if("complex64"===r){const r=e.map((e=>MC({inputs:{input:e},backend:n}))),i=e.map((e=>jC({inputs:{input:e},backend:n}))),o=UC(r,t,n),a=UC(i,t,n),s=qk({inputs:{real:o,imag:a},backend:n});return r.forEach((e=>n.disposeIntermediateTensorInfo(e))),i.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),s}let i=n.shouldExecuteOnCPU(e);if("string"===r&&(i=!0),i){const i=e.map((e=>{const r=O.util.sizeFromShape(e.shape.slice(t));return pS({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})})),o=i.map((e=>({vals:n.readSync(e.dataId),shape:e.shape}))),a=O.backend_util.computeOutShape(i.map((e=>e.shape)),1),s=1===i[0].shape[0],u=_w(o,a,r,s),l=O.backend_util.computeOutShape(e.map((e=>e.shape)),t),c=n.makeTensorInfo(l,r,u);return i.forEach((e=>n.disposeIntermediateTensorInfo(e))),c}const o=e.filter((e=>O.util.sizeFromShape(e.shape)>0)),a=(0,O.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(1===o.length){const t=a?new bk(e[0].shape,Ck):new Rk(e[0].shape,Ck);return n.runWebGLProgram(t,e,r)}const s=(0,O.env)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>s){const e=[];for(let r=0;r<o.length;r+=s){const i=o.slice(r,r+s);e.push(UC(i,t,n))}const r=UC(e,t,n);for(const t of e)n.disposeIntermediateTensorInfo(t);return r}if(a){const e=new $C(o.map((e=>e.shape)),t);return n.runWebGLProgram(e,o,r)}const{tensors2D:u,outShape:l}=function(e,t,n){const r=O.backend_util.computeOutShape(e.map((e=>e.shape)),t);return{tensors2D:e.map((e=>pS({inputs:{x:e},attrs:{shape:[-1,O.util.sizeFromShape(e.shape.slice(t))]},backend:n}))),outShape:r}}(o,t,n),c=new PC(u.map((e=>e.shape))),p=n.runWebGLProgram(c,u,r);u.forEach((e=>n.disposeIntermediateTensorInfo(e)));const d=pS({inputs:{x:p},attrs:{shape:l},backend:n});return n.disposeIntermediateTensorInfo(p),d}function WC(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,o=O.util.parseAxisParam(i,t[0].shape)[0],a=t.map((e=>e.shape));O.backend_util.assertParamsConsistent(a,o);const s=O.backend_util.computeOutShape(t.map((e=>e.shape)),o);if(0===O.util.sizeFromShape(s))return n.makeTensorInfo(s,t[0].dtype,[]);const u=t.filter((e=>O.util.sizeFromShape(e.shape)>0));return 1===u.length?Vk({inputs:{x:u[0]},backend:n}):UC(u,o,n)}const VC={kernelName:O.Concat,backendName:"webgl",kernelFunc:WC};class HC{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,s=e.strideHeight,u=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,p=e.filterHeight,d=e.filterWidth,h=4*Math.floor(e.inChannels/4),f=e.inChannels%4,g="channelsLast"===e.dataFormat,m=g?1:2,y=g?2:3,b=g?3:1;let v="",x="";n&&(v=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:i?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,x="result = activation(result);");const _=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${v}\n\n      const ivec2 strides = ivec2(${s}, ${u});\n      const ivec2 pads = ivec2(${o}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[${b}];\n\n        ivec2 xRCCorner =\n            ivec2(coords[${m}], coords[${y}]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${p}; wR++) {\n          int xR = xRCorner + wR * ${l};\n\n          if (xR < 0 || xR >= ${e.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${d}; wC++) {\n            int xC = xCCorner + wC * ${c};\n\n            if (xC < 0 || xC >= ${e.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${h}; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (${g}) {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (${1===f}) {\n\n              if (${g}) {\n                dotProd +=\n                    getX(batch, xR, xC, ${h}) *\n                    getW(wR, wC, ${h}, d2);\n              } else {\n                dotProd +=\n                    getX(batch, ${h}, xR, xC) *\n                    getW(wR, wC, ${h}, d2);\n              }\n\n            } else if (${2===f}) {\n              vec2 wValues = vec2(\n                getW(wR, wC, ${h}, d2),\n                getW(wR, wC, ${h} + 1, d2)\n              );\n\n              if (${g}) {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ${h}),\n                  getX(batch, xR, xC, ${h} + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ${h}, xR, xC),\n                  getX(batch, ${h} + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (${3===f}) {\n              vec3 wValues = vec3(\n                getW(wR, wC, ${h}, d2),\n                getW(wR, wC, ${h} + 1, d2),\n                getW(wR, wC, ${h} + 2, d2)\n              );\n\n              if (${g}) {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ${h}),\n                  getX(batch, xR, xC, ${h} + 1),\n                  getX(batch, xR, xC, ${h} + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ${h}, xR, xC),\n                  getX(batch, ${h} + 1, xR, xC),\n                  getX(batch, ${h} + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ${_}\n        ${x}\n        setOutput(result);\n      }\n    `}}class qC{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterDepth,p=e.filterHeight,d=e.filterWidth,h=4*Math.floor(e.inChannels/4),f=e.inChannels%4;this.userCode=`\n      const ivec3 strides = ivec3(${i}, ${o}, ${a});\n      const ivec3 pads = ivec3(${t}, ${n}, ${r});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${c}; wF++) {\n          int xF = xFCorner + wF * ${s};\n\n          if (xF < 0 || xF >= ${e.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${p}; wR++) {\n            int xR = xRCorner + wR * ${u};\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${d}; wC++) {\n              int xC = xCCorner + wC * ${l};\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ${h}; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (${1===f}) {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ${h}) *\n                  getW(wF, wR, wC, ${h}, d2);\n              } else if (${2===f}) {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ${h}),\n                  getX(batch, xF, xR, xC, ${h} + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ${h}, d2),\n                  getW(wF, wR, wC, ${h} + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (${3===f}) {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ${h}),\n                  getX(batch, xF, xR, xC, ${h} + 1),\n                  getX(batch, xF, xR, xC, ${h} + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ${h}, d2),\n                  getW(wF, wR, wC, ${h} + 1, d2),\n                  getW(wF, wR, wC, ${h} + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class XC{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=P_(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,s=e.dilationWidth,u=e.filterHeight,l=e.filterWidth,c=l;let p="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let e=0;e<l;e++)p+=`\n           vec4 xTexelC${2*e};\n           int xTexelC${2*e}Ready;\n           vec4 xTexelC${2*e+1};\n           int xTexelC${2*e+1}Ready;\n           vec4 xC${e};`;p+=`\n     for (int r = 0; r < ${u}; r++) {\n      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {\n       `;for(let e=0;e<l;e++)p+=`\n           xTexelC${2*e} = vec4(0.0);\n           xTexelC${2*e}Ready = 0;\n           xTexelC${2*e+1} = vec4(0.0);\n           xTexelC${2*e+1}Ready = 0;\n           xC${e} = vec4(0.0);`;p+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let t=0;t<(c+1)/2;t++){const n=2*t;if(p+=`\n           xC = xCCorner + ${n*s};\n           `,1===a){if(n<l&&(o%2==1?(p+=`\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${n}Ready == 0) {\n                   xTexelC${n} = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${n}.zw = vec2(0.0);\n                   }\n                   xTexelC${n}Ready = 1;\n                 }\n               `,p+=1===s&&n>0?`\n                 xC${n} = vec4(xTexelC${n-2}.zw, xTexelC${n}.xy);\n                 `:`\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC${n} = vec4(previous.zw, xTexelC${n}.xy);\n                   } else {\n                     xC${n} = vec4(0.0, 0.0, xTexelC${n}.xy);\n                   }\n                   `):p+=`\n                 if (xC >= 0 && xC < inDims[1] && xTexelC${n}Ready == 0) {\n                   xTexelC${n} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${n}.zw = vec2(0.0);\n                   }\n                   xTexelC${n}Ready = 1;\n                 }\n\n                 xC${n} = xTexelC${n};\n                 `,n+1<l)){const e=o%2==0?O.util.nearestLargerEven(s):s;s%2==0&&o%2==1||s%2!=0&&o%2!=1?(p+=`\n                   xCOffset = xC + imod(pads[1], 2) + ${e};\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${n+1}Ready == 0) {\n                     xTexelC${n+1} = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC${n+1}.zw = vec2(0.0);\n                     }\n                     xTexelC${n+1}Ready = 1;\n                   }\n                   `,p+=s>1?`\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC${n+1} = vec4(previous.zw, xTexelC${n+1}.xy);\n                     } else {\n                      xC${n+1} = vec4(0.0, 0.0, xTexelC${n+1}.xy);\n                     }\n                     `:`\n                     xC${n+1} = vec4(xTexelC${n}.zw, xTexelC${n+1}.xy);\n                     `):p+=1===e?`\n                     xC${n+1} = xTexelC${n};\n                     `:`\n                     xCOffset = xC + ${e};\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${n+1}Ready == 0) {\n                       xTexelC${n+1} = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC${n+1}.zw = vec2(0.0);\n                       }\n                       xTexelC${n+1}Ready = 1;\n                     }\n\n                     xC${n+1} = xTexelC${n+1};\n                     `}}else n<l&&(o%2==1?(p+=`\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${n}Ready == 0) {\n                   xTexelC${n} = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${n}.zw = vec2(0.0);\n                   }\n                   xTexelC${n}Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${n+1}Ready == 0) {\n                   xTexelC${n+1} = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC${n+1}.zw = vec2(0.0);\n                   }\n                   xTexelC${n+1}Ready = 1;\n                 }\n\n                 xC${n} = vec4(xTexelC${n}.zw, xTexelC${n+1}.zw);\n               `,n+1<l&&(p+=`\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC${n+1} = vec4(xTexelC${n+1}.xy, final.xy);\n                 `)):(p+=`\n                 if(xC >= 0 && xC < inDims[1] && xTexelC${n}Ready == 0) {\n                   xTexelC${n} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${n}.zw = vec2(0.0);\n                   }\n                   xTexelC${n}Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${n+1}Ready == 0) {\n                   xTexelC${n+1} = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${n+1}.zw = vec2(0.);\n                   }\n                   xTexelC${n+1}Ready = 1;\n                 }\n\n                 xC${n} = vec4(\n                   xTexelC${n}.xy, xTexelC${n+1}.xy);\n               `,n+1<l&&(p+=`\n                   xC${n+1} = vec4(xTexelC${n}.zw, xTexelC${n+1}.zw);\n                 `)));n<l&&(p+=`\n             wTexel = getW(r, ${n}, d1, d2);\n             dotProd += xC${n}.xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ${e.inChannels}) {\n               dotProd += xC${n}.yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           `,n+1<l&&(p+=`\n               wTexel = getW(r, ${n+1}, d1, d2);\n               dotProd += xC${n+1}.xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ${e.inChannels}) {\n                 dotProd += xC${n+1}.yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             `))}p+="\n     }\n   ",p+="\n     }\n   ",p+="\n     }\n   ";let d="",h="";n&&(d=r?`vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ${n}\n         }`:i?`vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ${n}\n         }`:`vec4 activation(vec4 x) {\n           ${n}\n         }`,h="result = activation(result);");const f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n       ${d}\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ${p}\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ${f}\n         ${h}\n         setOutput(result);\n       }\n     `}}class YC{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=P_(this.outputShape.length);const{dataFormat:n}=t,r=y_(),i="channelsLast"===n,o=i?1:2,a=i?2:3,s=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)u+=`\n          blockIndex = rc.z + ${t};\n          pos = rc.y + ${e};\n\n          ${s}\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[${o}] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[${a}] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (${i}) {\n                  innerDims = vec2(d1, ch);\n                  result[${2*e+t}] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[${2*e+t}] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        `;this.userCode=`\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ${u}\n\n        ${r.output} = result;\n      }\n    `}}function KC(e,t){const n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&1===n&&e[0]>1?[e[0],1]:null}function JC({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:s=null}){const u=e.shape,l=r.texData.get(e.dataId),c=n.inChannels,p=u[0]*u[1]*u[2],d=n.outChannels,h="channelsLast"===n.dataFormat;let f;const g=[];if(null!=o){const e=KC(o.shape,h);null!=e&&(o=pS({inputs:{x:o},backend:r,attrs:{shape:e}}),g.push(o))}if(null!=i){const e=KC(i.shape,h);null!=e&&(i=pS({inputs:{x:i},backend:r,attrs:{shape:e}}),g.push(i))}if((1!==p&&1!==d||!(c>kS))&&l.isPacked&&h&&null!=l.texture&&u[2]%2!=0&&O.util.arraysEqual(l.shape.slice(-3),u.slice(-3))){const c=u[0]*u[1]*(u[2]+1),p={dataId:e.dataId,shape:[1,c,n.inChannels],dtype:e.dtype},d=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,O.util.assert(t_(l.shape,p.shape),(()=>`packed reshape ${l.shape} to ${p.shape} isn't free`));const h=pS({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});g.push(h);const m=SS({a:p,b:h,backend:r,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:o,leakyreluAlpha:a}),y=r.texData.get(m.dataId);O.util.assert(y.isPacked,(()=>"batchMatMul result is expected to be packed")),l.shape=d,y.shape=n.outShape,f=Vk({inputs:{x:m},backend:r}),f.shape=n.outShape,g.push(m)}else{const u=n.outHeight*n.outWidth,l=pS({inputs:{x:e},backend:r,attrs:{shape:h?[n.batchSize,u,n.inChannels]:[n.batchSize,n.inChannels,u]}}),c=pS({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),p=SS({a:h?l:c,b:h?c:l,transposeA:!h,transposeB:!1,backend:r,bias:i,activation:s,preluActivationWeights:o,leakyreluAlpha:a});f=pS({inputs:{x:p},backend:r,attrs:{shape:n.outShape}}),g.push(l),g.push(c),g.push(p)}for(const e of g)r.disposeIntermediateTensorInfo(e);return f}function ZC({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:s=null}){const{filterWidth:u,filterHeight:l,inChannels:c,outWidth:p,outHeight:d,dataFormat:h}=n,f="channelsLast"===h,g=u*l*c,m=d*p,y=[n.batchSize,g,m],b=[];if(null!=o){const e=KC(o.shape,f);null!=e&&(o=pS({inputs:{x:o},backend:r,attrs:{shape:e}}),b.push(o))}if(null!=i){const e=KC(i.shape,f);null!=e&&(i=pS({inputs:{x:i},backend:r,attrs:{shape:e}}),b.push(i))}const v=pS({inputs:{x:t},backend:r,attrs:{shape:[1,g,O.util.sizeFromShape(t.shape)/g]}});b.push(v);const x=new YC(y,n),_=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],w=r.runWebGLProgram(x,[e],"float32",_),k=pS({inputs:{x:w},backend:r,attrs:{shape:y}});b.push(w),b.push(k);const S=null!=i,C=null!=o,M="leakyrelu"===s,T=s?iS(s,!0):null,E=new oS(f?k.shape:v.shape,f?v.shape:k.shape,f?[n.batchSize,m,n.outChannels]:[n.batchSize,n.outChannels,m],!0,!1,S,T,C,M),A=f?[k,v]:[v,k];if(i&&A.push(i),C&&A.push(o),M){const e=r.makeTensorInfo([],"float32",O.util.createScalarValue(a,"float32"));A.push(e),b.push(e)}const F=r.runWebGLProgram(E,A,"float32"),R=pS({inputs:{x:F},backend:r,attrs:{shape:n.outShape}});b.push(F);for(const e of b)r.disposeIntermediateTensorInfo(e);return R}const QC={kernelName:O.Conv2D,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:a,pad:s,dataFormat:u,dilations:l,dimRoundingMode:c}=r,p=O.backend_util.convertConv2DDataFormat(u),d=O.backend_util.computeConv2DInfo(i.shape,o.shape,a,l,s,c,!1,p);let h;if(1!==d.filterHeight||1!==d.filterWidth||1!==d.dilationHeight||1!==d.dilationWidth||1!==d.strideHeight||1!==d.strideWidth||"SAME"!==d.padInfo.type&&"VALID"!==d.padInfo.type)if(d.strideWidth<=2&&"channelsLast"===p&&(0,O.env)().getBool("WEBGL_EXP_CONV")){const e=new XC(d),t=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];h=n.runWebGLProgram(e,[i,o],"float32",t)}else if((0,O.env)().getBool("WEBGL_CONV_IM2COL"))h=ZC({x:i,filter:o,convInfo:d,backend:n});else{const e=new HC(d);h=n.runWebGLProgram(e,[i,o],"float32")}else h=JC({x:i,filter:o,convInfo:d,backend:n});const f=pS({inputs:{x:h},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(h),f}};class eM{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o="channelsLast"===e.dataFormat;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${e.batchSize}; b++) {\n          for (int yR = 0; yR < ${e.outHeight}; yR++) {\n            int xR = wR + yR * ${t} - ${r};\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${e.outWidth}; yC++) {\n              int xC = wC + yC * ${n} - ${i};\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              ${o?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);"}\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class tM{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o="channelsLast"===e.dataFormat,a=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=o?1:2,l=o?2:3,c=o?3:1;this.userCode=`\n      const ivec2 pads = ivec2(${a}, ${s});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[${c}];\n\n        ivec2 dyCorner = ivec2(coords[${u}], coords[${l}]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${t}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${t} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${i}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {\n\n              if (${o}) {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class nM{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${e.batchSize}; b++) {\n          for (int yF = 0; yF < ${e.outDepth}; yF++) {\n            int xF = wF + yF * ${t} - ${i};\n\n            if (xF < 0 || xF >= ${e.inDepth}) {\n              continue;\n            }\n\n            for (int yR = 0; yR < ${e.outHeight}; yR++) {\n              int xR = wR + yR * ${n} - ${o};\n\n              if (xR < 0 || xR >= ${e.inHeight}) {\n                continue;\n              }\n\n              for (int yC = 0; yC < ${e.outWidth}; yC++) {\n                int xC = wC + yC * ${r} - ${a};\n\n                if (xC < 0 || xC >= ${e.inWidth}) {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class rM{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode=`\n      const ivec3 pads = ivec3(${s}, ${u}, ${l});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${t}; wF++) {\n          float dyF = float(dyFCorner + wF) / ${i}.0;\n\n          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ${t} - 1 - wF;\n\n          for (int wR = 0; wR < ${n}; wR++) {\n            float dyR = float(dyRCorner + wR) / ${o}.0;\n\n            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ${n} - 1 - wR;\n\n            for (int wC = 0; wC < ${r}; wC++) {\n              float dyC = float(dyCCorner + wC) / ${a}.0;\n\n              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ${r} - 1 - wC;\n\n              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const iM={kernelName:O.Conv2DBackpropFilter,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:o}=t,{strides:a,pad:s,dataFormat:u,dimRoundingMode:l,filterShape:c}=r,p=O.backend_util.convertConv2DDataFormat(u),d=O.backend_util.computeConv2DInfo(i.shape,c,a,1,s,l,!1,p),h=new eM(d);return n.runWebGLProgram(h,[i,o],"float32")}};class oM{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=P_(this.outputShape.length);const t=e.filterHeight,n=e.filterWidth,r=t-1-e.padInfo.top,i=n-1-e.padInfo.left;this.userCode=`\n      const ivec2 pads = ivec2(${r}, ${i});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ${t}; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ${t} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            int wCPerm = ${n} - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    `}}const aM={kernelName:O.Conv2DBackpropInput,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:o}=t,{inputShape:a,strides:s,pad:u,dataFormat:l,dimRoundingMode:c}=r,p=O.backend_util.convertConv2DDataFormat(l),d=O.backend_util.computeConv2DInfo(a,o.shape,s,1,u,c,!1,p);if((0,O.env)().getBool("WEBGL_PACK")&&"channelsLast"===p){const e=[[d.strideHeight,d.strideWidth]],t=new oM(d);return n.runWebGLProgram(t,[i,o],"float32",e)}{const e=new tM(d);return n.runWebGLProgram(e,[i,o],"float32")}}},sM={kernelName:O.Conv3D,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:a,pad:s,dilations:u}=r,l=O.backend_util.computeConv3DInfo(i.shape,o.shape,a,u,s),c=new qC(l);return n.runWebGLProgram(c,[i,o],"float32")}},uM={kernelName:O.Conv3DBackpropFilterV2,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:o}=t,{strides:a,pad:s,filterShape:u}=r,l=O.backend_util.computeConv3DInfo(i.shape,u,a,1,s),c=new nM(l);return n.runWebGLProgram(c,[i,o],"float32")}},lM={kernelName:O.Conv3DBackpropInputV2,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:o}=t,{pad:a,strides:s,inputShape:u}=r,l=O.backend_util.computeConv3DInfo(u,o.shape,s,1,a),c=new rM(l);return n.runWebGLProgram(c,[i,o],"float32")}},cM=nS({opSnippet:tS+"\n  return cos(x);\n",packedOpSnippet:`\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ${Uk}\n  return result;\n`}),pM={kernelName:O.Cos,backendName:"webgl",kernelFunc:cM},dM=nS({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),hM={kernelName:O.Cosh,backendName:"webgl",kernelFunc:dM};class fM{constructor(e,t,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,s,u]=e,[l]=t,[c,p]=n;this.outputShape=[l,c,p,u];const d="bilinear"===r?1:0,[h,f]=[a-1+".0",s-1+".0"],[g,m,y]=c>1?[""+(a-1)/(c-1),"(y2-y1) * height_ratio",`y1*${h} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${h}`],[b,v,x]=p>1?[""+(s-1)/(p-1),"(x2-x1) * width_ratio",`x1*${f} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${f}`];this.userCode=`\n      const float height_ratio = float(${g});\n      const float width_ratio = float(${b});\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ${o}) {\n          return;\n        }\n\n        float height_scale = ${m};\n        float width_scale = ${v};\n\n        float in_y = ${y};\n        if( in_y < 0.0 || in_y > ${h} ) {\n          setOutput(float(${i}));\n          return;\n        }\n        float in_x = ${x};\n        if( in_x < 0.0 || in_x > ${f} ) {\n          setOutput(float(${i}));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(${d} == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    `}}const gM={kernelName:O.CropAndResize,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:o,boxInd:a}=t,{cropSize:s,method:u,extrapolationValue:l}=r,c=new fM(i.shape,o.shape,s,u,l);return n.runWebGLProgram(c,[i,o,a],"float32")}};var mM;!function(e){e.Prod="*",e.Sum="+"}(mM||(mM={}));class yM{constructor(e,t,n,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===mM.Prod?"1.0":"0.0",a=n?o:`getX(${bM(i,"coords",this.op)})`,s=this.outputShape[this.outputShape.length-1];let u="",l="";n?(u=r?"end != "+(s-1):"end != 0",l=r?"end + 1":"end - 1"):(u=r?`end + pow2 < ${s}`:"end >= pow2",l=r?"end + pow2":"end - pow2"),this.userCode=`\n      void main() {\n        ${R_(i)} coords = getOutputCoords();\n        int end = ${vM(i,"coords",this.op)};\n        float val = ${a};\n        int pow2 = int(pow(2.0, index));\n        if (${u}) {\n          int idx = ${l};\n          ${vM(i,"coords",this.op)} = idx;\n          val ${this.op}= getX(${bM(i,"coords",this.op)});\n        }\n        setOutput(val);\n      }\n    `}}function bM(e,t,n){if(1===e)return`${t}`;if(2===e)return`${t}.x, ${t}.y`;if(3===e)return`${t}.x, ${t}.y, ${t}.z`;if(4===e)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function vM(e,t,n){if(1===e)return`${t}`;if(2===e)return`${t}.y`;if(3===e)return`${t}.z`;if(4===e)return`${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function xM(e,t,n,r,i,o){const a=t.shape.length,s=O.backend_util.getAxesPermutation([r],a);let u=t;null!=s&&(u=_S({inputs:{x:t},backend:n,attrs:{perm:s}}));const l=O.backend_util.getInnerMostAxes(1,a)[0];if(l!==a-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);const c=u.shape[l];let p=Vk({inputs:{x:u},backend:n});for(let t=0;t<=Math.ceil(Math.log2(c))-1;t++){const r=new yM(e,u.shape,!1,o),i=[[t]],a=p;p=n.runWebGLProgram(r,[p],p.dtype,i),n.disposeIntermediateTensorInfo(a)}if(i){const t=new yM(e,u.shape,i,o),r=p;p=n.runWebGLProgram(t,[p],p.dtype),n.disposeIntermediateTensorInfo(r)}if(null!=s){const e=_S({inputs:{x:p},backend:n,attrs:{perm:O.backend_util.getUndoAxesPermutation(s)}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(u),e}return p}const _M={kernelName:O.Cumprod,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,exclusive:a,reverse:s}=r;return xM(mM.Prod,i,n,o,a,s)}},wM={kernelName:O.Cumsum,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,exclusive:a,reverse:s}=r;return xM(mM.Sum,i,n,o,a,s)}},kM={kernelName:O.DenseBincount,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:o}=t,{size:a,binaryOutput:s}=r;if(1===i.shape.length){const e=n.readSync(i.dataId),t=n.readSync(o.dataId),r=mw(e,t,o.dtype,o.shape,a);return n.makeTensorInfo([a],o.dtype,r)}if(2===i.shape.length){const e=n.bufferSync(i),t=n.bufferSync(o),r=yw(e,t,a,s);return n.makeTensorInfo(r.shape,o.dtype,r.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}};class SM{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode=`\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ${this.getHeightCoordString()};\n      int w = ${this.getWidthCoordString()};\n      int d = ${this.getDepthCoordString()};\n\n      int in_h = h / ${t};\n      int offset_h = imod(h, ${t});\n      int in_w = w / ${t};\n      int offset_w = imod(w, ${t});\n      int offset_d = (offset_h * ${t} + offset_w) *\n        ${this.getOutputDepthSize()};\n      int in_d = d + offset_d;\n\n      float result = ${this.getInputSamplingString()};\n      setOutput(result);\n    }\n  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const CM={kernelName:O.DepthToSpace,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:o,dataFormat:a}=r,s=i.shape[0],u=("NHWC"===a?i.shape[1]:i.shape[2])*o,l=("NHWC"===a?i.shape[2]:i.shape[3])*o,c=("NHWC"===a?i.shape[3]:i.shape[1])/(o*o),p=new SM("NHWC"===a?[s,u,l,c]:[s,c,u,l],o,a);return n.runWebGLProgram(p,[i],i.dtype)}};class MM{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=P_(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,s=e.outChannels/e.inChannels;let u="",l="";n&&(u=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:i?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,l="result = activation(result);");const c=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${u}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${s};\n        int q = d2 - d1 * ${s};\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ${o}; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${a}; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ${c}\n        ${l}\n        setOutput(result);\n      }\n    `}}class TM{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=P_(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,s=e.strideWidth,u=e.dilationWidth,l=e.filterHeight,c=e.filterWidth,p=c;let d="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let e=0;e<c;e++)d+=`\n          vec4 xTexelC${2*e};\n          int xTexelC${2*e}Ready;\n          vec4 xTexelC${2*e+1};\n          int xTexelC${2*e+1}Ready;\n          vec4 xC${e};`;d+=`\n    for (int r = 0; r < ${l}; r++) {\n      `;for(let e=0;e<c;e++)d+=`\n          xTexelC${2*e} = vec4(0.0);\n          xTexelC${2*e}Ready = 0;\n          xTexelC${2*e+1} = vec4(0.0);\n          xTexelC${2*e+1}Ready = 0;\n          xC${e} = vec4(0.0);`;d+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let e=0;e<(p+1)/2;e++){const t=2*e;if(d+=`\n          xC = xCCorner + ${t*u};\n          `,1===s){if(t<c&&(a%2==1?(d+=`\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n              `,d+=1===u&&t>0?`\n                xC${t} = vec4(xTexelC${t-2}.zw, xTexelC${t}.xy);\n                `:`\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC${t} = vec4(previous.zw, xTexelC${t}.xy);\n                  } else {\n                    xC${t} = vec4(0.0, 0.0, xTexelC${t}.xy);\n                  }\n                  `):d+=`\n                if (xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n\n                xC${t} = xTexelC${t};\n                `,t+1<c)){const e=a%2==0?O.util.nearestLargerEven(u):u;u%2==0&&a%2==1||u%2!=0&&a%2!=1?(d+=`\n                  xCOffset = xC + imod(pads[1], 2) + ${e};\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                    xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC${t+1}.zw = vec2(0.0);\n                    }\n                    xTexelC${t+1}Ready = 1;\n                  }\n                  `,d+=u>1?`\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC${t+1} = vec4(previous.zw, xTexelC${t+1}.xy);\n                    } else {\n                     xC${t+1} = vec4(0.0, 0.0, xTexelC${t+1}.xy);\n                    }\n                    `:`\n                    xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.xy);\n                    `):d+=1===e?`\n                    xC${t+1} = xTexelC${t};\n                    `:`\n                    xCOffset = xC + ${e};\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                      xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC${t+1}.zw = vec2(0.0);\n                      }\n                      xTexelC${t+1}Ready = 1;\n                    }\n\n                    xC${t+1} = xTexelC${t+1};\n                    `}}else t<c&&(a%2==1?(d+=`\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${t+1}Ready == 0) {\n                  xTexelC${t+1} = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC${t+1}.zw = vec2(0.0);\n                  }\n                  xTexelC${t+1}Ready = 1;\n                }\n\n                xC${t} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);\n              `,t+1<c&&(d+=`\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC${t+1} = vec4(xTexelC${t+1}.xy, final.xy);\n                `)):(d+=`\n                if(xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                  xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${t+1}.zw = vec2(0.);\n                  }\n                  xTexelC${t+1}Ready = 1;\n                }\n\n                xC${t} = vec4(\n                  xTexelC${t}.xy, xTexelC${t+1}.xy);\n              `,t+1<c&&(d+=`\n                  xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);\n                `)));t<c&&(d+=`\n            wTexel = getW(r, ${t}, d1, q);\n            dotProd += xC${t} * vec4(wTexel.xz, wTexel.xz);\n          `,t+1<c&&(d+=`\n              wTexel = getW(r, ${t+1}, d1, q);\n              dotProd += xC${t+1} * vec4(wTexel.xz, wTexel.xz);\n            `))}d+="\n    }\n  ",d+="\n      }\n    ";let h="",f="";n&&(h=r?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:i?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`vec4 activation(vec4 x) {\n          ${n}\n        }`,f="result = activation(result);");const g=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${h}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${o};\n        int q = d2 - d1 * ${o};\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ${d}\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ${g}\n        ${f}\n        setOutput(result);\n      }\n    `}}const EM={kernelName:O.DepthwiseConv2dNative,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:a,pad:s,dilations:u,dimRoundingMode:l}=r;let c=u;null==c&&(c=[1,1]),O.util.assert(O.backend_util.eitherStridesOrDilationsAreOne(a,c),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`));const p=O.backend_util.computeConv2DInfo(i.shape,o.shape,a,c,s,l,!0);let d;d=(0,O.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels==1?new TM(p):new MM(p);const h=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];return n.runWebGLProgram(d,[i,o],"float32",h)}};class AM{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ${o} + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ${e.batchSize}; b++) {\n          for (int yR = 0; yR < ${e.outHeight}; yR++) {\n            int xR = wR + yR * ${t} - ${r};\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${e.outWidth}; yC++) {\n              int xC = wC + yC * ${n} - ${i};\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class FM{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=t-1-e.padInfo.top,a=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`\n      const ivec2 pads = ivec2(${o}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ${t}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${t} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${i}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ${s}; dm++) {\n              int d2 = d1 * ${s} + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const OM={kernelName:O.DepthwiseConv2dNativeBackpropFilter,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:o}=t,{strides:a,dilations:s,pad:u,dimRoundingMode:l,filterShape:c}=r,p=O.backend_util.computeConv2DInfo(i.shape,c,a,s,u,l,!0),d=new AM(p);return n.runWebGLProgram(d,[i,o],"float32")}},RM={kernelName:O.DepthwiseConv2dNativeBackpropInput,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:o}=t,{strides:a,dilations:s,pad:u,dimRoundingMode:l,inputShape:c}=r,p=O.backend_util.computeConv2DInfo(c,o.shape,a,s,u,l,!0),d=new FM(p);return n.runWebGLProgram(d,[i,o],"float32")}};class NM{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const DM={kernelName:O.Diag,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,i=[...r.shape,...r.shape],o=O.util.sizeFromShape(r.shape),a=pS({inputs:{x:r},backend:n,attrs:{shape:[o]}}),s=new NM(o),u=n.runWebGLProgram(s,[a],a.dtype),l=pS({inputs:{x:u},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),l}};class IM{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:n,padInfo:r,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:s,dilationHeight:u,dilationWidth:l}=e,{top:c,left:p}=r;this.userCode=`\n      const ivec2 strides = ivec2(${i}, ${o});\n      const ivec2 pads = ivec2(${c}, ${p});\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ${a}; h++) {\n          int hIn = hBeg + h * ${u};\n\n          if (hIn >= 0 && hIn < ${t}) {\n            for (int w = 0; w < ${s}; w++) {\n              int wIn = wBeg + w * ${l};\n\n              if (wIn >= 0 && wIn < ${n}) {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    `}}const BM={kernelName:O.Dilation2D,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:a,pad:s,dilations:u}=r,l=O.backend_util.computeDilation2DInfo(i.shape,o.shape,a,s,"NHWC",u);let c;const p=new IM(l);c=n.runWebGLProgram(p,[i,o],"float32");const d=pS({inputs:{x:c},backend:n,attrs:{shape:l.outShape}});return n.disposeIntermediateTensorInfo(c),d}},LM={kernelName:O.Einsum,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,o=t,{allDims:a,summedDims:s,idDims:u}=O.backend_util.decodeEinsumEquation(i,o.length);O.backend_util.checkEinsumDimSizes(a.length,u,o);const{path:l,steps:c}=O.backend_util.getEinsumComputePath(s,u),p=c.length;let d=null,h=a.length;const f=[];for(let e=0;e<p;++e){for(const t of c[e]){const{permutationIndices:e,expandDims:r}=O.backend_util.getEinsumPermutation(h,u[t]);let i;O.backend_util.isIdentityPermutation(e)?i=o[t]:(i=_S({inputs:{x:o[t]},backend:n,attrs:{perm:e}}),f.push(i));const a=i.shape.slice();for(let e=0;e<r.length;++e)a.splice(r[e],0,1);O.util.arraysEqual(i.shape,a)||(i=pS({inputs:{x:i},backend:n,attrs:{shape:a}}),f.push(i)),null===d?d=i:(d=lS({inputs:{a:i,b:d},backend:n}),f.push(d))}e<p-1&&(l[e]>=0&&(d=vS({inputs:{x:d},backend:n,attrs:{axis:l[e]-(a.length-h),keepDims:!1}}),f.push(d)),h--)}for(const e of f)e!==d&&n.disposeIntermediateTensorInfo(e);return d}},PM=nS({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),$M={kernelName:O.Elu,backendName:"webgl",kernelFunc:PM},zM={kernelName:O.EluGrad,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n}=e,{dy:r,y:i}=t,o=(0,O.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wk("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,i.shape):new Gk("return (b >= 0.0) ? a : a * (b + 1.0);",r.shape,i.shape);return n.runWebGLProgram(o,[r,i],r.dtype)}},jM=rS({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:ww}),GM={kernelName:O.Equal,backendName:"webgl",kernelFunc:jM},UM=nS({opSnippet:`\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = ${O.backend_util.ERF_P};\n  float a1 = ${O.backend_util.ERF_A1};\n  float a2 = ${O.backend_util.ERF_A2};\n  float a3 = ${O.backend_util.ERF_A3};\n  float a4 = ${O.backend_util.ERF_A4};\n  float a5 = ${O.backend_util.ERF_A5};\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n`}),WM={kernelName:O.Erf,backendName:"webgl",kernelFunc:UM},VM=nS({opSnippet:tS+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:kw,dtype:"float32"}),HM={kernelName:O.Exp,backendName:"webgl",kernelFunc:VM};function qM(e){const{inputs:t,attrs:n,backend:r}=e,{dim:i}=n,{input:o}=t,a=o.shape.length,s=o.shape.slice();let u=i;return i<0&&(O.util.assert(-(a+1)<=i,(()=>`Axis must be in the interval [${-(a+1)}, ${a}]`)),u=a+i+1),s.splice(u,0,1),pS({inputs:{x:o},backend:r,attrs:{shape:s}})}const XM={kernelName:O.ExpandDims,backendName:"webgl",kernelFunc:qM},YM="return exp(x) - 1.0;",KM=nS({opSnippet:YM,packedOpSnippet:YM,cpuKernelImpl:Sw}),JM={kernelName:O.Expm1,backendName:"webgl",kernelFunc:KM};class ZM{constructor(e,t,n){this.variableNames=["real","imag"];const r=t[1];this.outputShape=t;const i=n?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=n?`${r}.0`:"1.0";let a;if("real"===e)a="return real * expR - imag * expI;";else{if("imag"!==e)throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);a="return real * expI + imag * expR;"}this.userCode=`\n      const float exponentMultiplier = ${i};\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ${a}\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(${r});\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ${r}; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ${o};\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    `}}function QM(e,t,n){const r=n.texData.get(e.dataId),i=O.util.sizeFromShape(e.shape),o=e.shape[e.shape.length-1],a=pS({inputs:{x:e},backend:n,attrs:{shape:[i/o,o]}}),s=a.shape,u=new ZM("real",s,t),l=new ZM("imag",s,t),c=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:s},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:s}],p=n.runWebGLProgram(u,c,"float32"),d=n.runWebGLProgram(l,c,"float32"),h=qk({inputs:{real:p,imag:d},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(d);const f=pS({inputs:{x:h},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(h),f}const eT={kernelName:O.FFT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t;return QM(r,!1,n)}};class tT{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}function nT(e){const{backend:t,attrs:n}=e,{shape:r,value:i}=n;let{dtype:o}=n;if(o=o||O.util.inferDtype(i),"string"===o){const e=O.util.getArrayFromDType(o,O.util.sizeFromShape(r));return e.fill(i),t.makeTensorInfo(r,o,e)}{const e=new tT(r,i),n=[[i]];return t.runWebGLProgram(e,[],o,n)}}const rT={kernelName:O.Fill,backendName:"webgl",kernelFunc:nT};class iT{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ${t} - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ${t}) {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}const oT={kernelName:O.FlipLeftRight,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{const{image:n}=e,r=t,i=new iT(n.shape);return r.runWebGLProgram(i,[n],n.dtype)}},aT="return floor(x);",sT=nS({opSnippet:aT,packedOpSnippet:aT,cpuKernelImpl:Cw}),uT={kernelName:O.Floor,backendName:"webgl",kernelFunc:sT},lT=rS({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),cT={kernelName:O.FloorDiv,backendName:"webgl",kernelFunc:lT};class pT{constructor(e){this.variableNames=["A"];const t=y_(),[n,r]=e;this.outputShape=e,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);\n\n        vec4 values = ${t.texture2D}(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    `}}class dT{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=y_(),[n,r]=e;this.outputShape=e,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(${r}.0, ${n}.0);\n            vec4 values = ${t.texture2D}(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ${t.output} = result;\n      }\n    `}}const hT={kernelName:O.FromPixels,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e;let{pixels:i}=t;const{numChannels:o}=r,a="undefined"!=typeof HTMLVideoElement&&i instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&i instanceof HTMLImageElement,[u,l]=a?[i.videoWidth,i.videoHeight]:[i.width,i.height],c=[l,u],p=[l,u,o];if(s||a){const e=(0,O.env)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=fT&&e===gT||(gT=e,fT=document.createElement("canvas").getContext("2d",{willReadFrequently:gT})),fT.canvas.width=u,fT.canvas.height=l,fT.drawImage(i,0,0,u,l),i=fT.canvas}const d=n.makeTensorInfo(c,"int32");n.texData.get(d.dataId).usage=dx.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),i);const h=(0,O.env)().getBool("WEBGL_PACK")?new dT(p):new pT(p),f=n.runWebGLProgram(h,[d],"int32");return n.disposeData(d.dataId),f}};let fT,gT=(0,O.env)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");const mT={kernelName:O.FusedConv2D,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o,bias:a,preluActivationWeights:s}=t,{strides:u,pad:l,dataFormat:c,dilations:p,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=r,g=O.backend_util.convertConv2DDataFormat(c),m=O.backend_util.computeConv2DInfo(i.shape,o.shape,u,p,l,d,!1,g);let y;const b=[],v=null!=a,x=null!=s,_="leakyrelu"===h,w=()=>{const e=[i,o],t=(e,t)=>{if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){const t=pS({inputs:{x:e},backend:n,attrs:{shape:[e.shape[0],1,1]}});return b.push(t),t}return e};if(v&&e.push(t(a,c)),x&&e.push(t(s,c)),_){const t=n.makeTensorInfo([],"float32",O.util.createScalarValue(f,"float32"));e.push(t),b.push(t)}return e};if(1!==m.filterHeight||1!==m.filterWidth||1!==m.dilationHeight||1!==m.dilationWidth||1!==m.strideHeight||1!==m.strideWidth||"SAME"!==m.padInfo.type&&"VALID"!==m.padInfo.type)if(m.strideWidth<=2&&"channelsLast"===g&&(0,O.env)().getBool("WEBGL_EXP_CONV")){const e=h?iS(h,!0):null,t=new XC(m,v,e,x,_),r=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],i=w();y=n.runWebGLProgram(t,i,"float32",r)}else if((0,O.env)().getBool("WEBGL_CONV_IM2COL"))y=ZC({x:i,filter:o,convInfo:m,backend:n,bias:a,activation:h,preluActivationWeights:s,leakyreluAlpha:f});else{const e=h?iS(h,!1):null,t=new HC(m,v,e,x,_),r=w();y=n.runWebGLProgram(t,r,"float32")}else y=JC({x:i,filter:o,convInfo:m,backend:n,bias:a,activation:h,preluActivationWeights:s,leakyreluAlpha:f});const k=pS({inputs:{x:y},backend:n,attrs:{shape:m.outShape}});return b.push(y),b.forEach((e=>n.disposeIntermediateTensorInfo(e))),k}},yT={kernelName:O.FusedDepthwiseConv2D,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o,bias:a,preluActivationWeights:s}=t,{strides:u,pad:l,dilations:c,dimRoundingMode:p,activation:d,leakyreluAlpha:h}=r,f=[];let g=c;null==g&&(g=[1,1]),O.util.assert(O.backend_util.eitherStridesOrDilationsAreOne(u,g),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${u} and dilations '${g}'`));const m=O.backend_util.computeConv2DInfo(i.shape,o.shape,u,g,l,p,!0),y=(0,O.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels==1,b=d?iS(d,y):null,v=[i,o],x=null!=a,_=null!=s,w="leakyrelu"===d;if(x&&v.push(a),_&&v.push(s),w){const e=n.makeTensorInfo([],"float32",O.util.createScalarValue(h,"float32"));v.push(e),f.push(e)}let k;k=y?new TM(m,x,b,_,w):new MM(m,x,b,_,w);const S=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],C=n.runWebGLProgram(k,v,"float32",S);return f.forEach((e=>n.disposeIntermediateTensorInfo(e))),C}};class bT{constructor(e,t,n,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;const i=R_(n.length);let o="\n    int index;";for(let e=0;e<this.sliceDim;e++)o+=`\n          index = round(getIndices(coords[0], ${e}));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[e]};\n          flattenIndex += index * ${this.strides[e]};`;this.userCode=`\n         void main() {\n          ${i} coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ${o}\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      `}}const vT={kernelName:O.GatherNd,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{params:r,indices:i}=t,o=i.shape,a=o[o.length-1],s=O.util.sizeFromShape(r.shape),[u,l,c,p]=O.backend_util.prepareAndValidate(r,i),d=pS({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),h=pS({inputs:{x:r},backend:n,attrs:{shape:[O.util.sizeFromShape(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,i])||"string"===r.dtype){const e=n.readSync(i.dataId),t=n.bufferSync(r),o=Mw(e,t,r.dtype,l,a,c,p,r.shape,s);return n.makeTensorInfo(u,r.dtype,o.values)}const f=new bT(a,p,[l,c],r.shape),g=n.runWebGLProgram(f,[h,d],h.dtype),m=pS({inputs:{x:g},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(g),m}};class xT{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const n=R_(this.rank),r=function(e,t){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let t=0;t<e.length;t++)2===t?r.push("index"):r.push(`${n[t]}`);return r.join()}(e);this.userCode=`\n      void main() {\n        ${n} resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;\n        setOutput(inBounds * getA(${r}));\n      }\n    `}}function _T(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,indices:o}=t,{axis:a,batchDims:s}=r,u=O.util.parseAxisParam(a,i.shape)[0];if((0,O.env)().get("DEBUG")){const e=n.readSync(o.dataId),t=i.shape[u];for(let n=0;n<e.length;++n){const r=e[n];O.util.assert(r<=t-1&&r>=0,(()=>`GatherV2: the index value ${r} is not in [0, ${t-1}]`))}}const l=O.backend_util.segment_util.collectGatherOpShapeInfo(i,o,u,s),c=O.util.sizeFromShape(o.shape),p=[],d=pS({inputs:{x:i},backend:n,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),h=pS({inputs:{x:o},backend:n,attrs:{shape:[l.batchSize,c/l.batchSize]}});p.push(d),p.push(h);const f=[l.batchSize,l.outerSize,c/l.batchSize,l.sliceSize];if(n.shouldExecuteOnCPU([i,o])||"string"===i.dtype){const e=n.bufferSync(h),t=n.bufferSync(d),r=Tw(t,e,f);return p.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(l.outputShape,r.dtype,r.values)}const g=new xT(d.shape,f),m=n.runWebGLProgram(g,[d,h],d.dtype);p.push(m);const y=pS({inputs:{x:m},backend:n,attrs:{shape:l.outputShape}});return p.forEach((e=>n.disposeIntermediateTensorInfo(e))),y}const wT={kernelName:O.GatherV2,backendName:"webgl",kernelFunc:_T},kT=rS({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:Ew,dtype:"bool"}),ST={kernelName:O.Greater,backendName:"webgl",kernelFunc:kT},CT=rS({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:Aw}),MT={kernelName:O.GreaterEqual,backendName:"webgl",kernelFunc:CT},TT={kernelName:O.IFFT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t;return QM(r,!0,n)}},ET=nS({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),AT={kernelName:O.IsFinite,backendName:"webgl",kernelFunc:ET},FT=nS({opSnippet:"return float(isinf(x));",dtype:"bool"}),OT={kernelName:O.IsInf,backendName:"webgl",kernelFunc:FT},RT=nS({opSnippet:"return float(isnan(x));",dtype:"bool"}),NT={kernelName:O.IsNan,backendName:"webgl",kernelFunc:RT},DT=rS({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:Fw,dtype:"bool"}),IT={kernelName:O.Less,backendName:"webgl",kernelFunc:DT},BT=rS({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:Ow,dtype:"bool"}),LT={kernelName:O.LessEqual,backendName:"webgl",kernelFunc:BT},PT={kernelName:O.LinSpace,backendName:"webgl",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:i,num:o}=n,a=Rw(r,i,o);return t.makeTensorInfo([a.length],"float32",a)}},$T=nS({opSnippet:tS+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:Nw}),zT={kernelName:O.Log,backendName:"webgl",kernelFunc:$T},jT=nS({opSnippet:tS+"\n  return log(1.0 + x);\n"}),GT={kernelName:O.Log1p,backendName:"webgl",kernelFunc:jT},UT=rS({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),WT={kernelName:O.LogicalAnd,backendName:"webgl",kernelFunc:UT},VT=nS({opSnippet:"return float(!(x >= 1.0));"}),HT={kernelName:O.LogicalNot,backendName:"webgl",kernelFunc:VT},qT=rS({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),XT={kernelName:O.LogicalOr,backendName:"webgl",kernelFunc:qT};class YT{constructor(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[];const o=t,a=e[3]-1;let s;this.outputShape=e;const u=`float(${n}) + float(${r}) * sum`;s=.5===i?`inversesqrt(${u})`:1===i?`1.0/(${u})`:`exp(log(${u}) * float(-${i}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -${o}; j <= ${o}; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ${a}) {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ${s};\n        setOutput(val);\n      }\n    `}}class KT{constructor(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=t,a=e[3]-1;let s;this.outputShape=e;const u=`float(${n}) + float(${r}) * sum`;s=.5===i?`inversesqrt(${u})`:1===i?`1.0/(${u})`:`exp(log(${u}) * float(-${i}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ${this.outputShape[3]};\n        bool hasNextRow = c < ${this.outputShape[2]};\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ${o};\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ${o}; j <= ${o}; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ${s};\n        setOutput(result);\n      }\n    `}}const JT={kernelName:O.LRN,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:o,bias:a,alpha:s,beta:u}=r,l=(0,O.env)().getBool("WEBGL_PACK_NORMALIZATION")?new KT(i.shape,o,a,s,u):new YT(i.shape,o,a,s,u);return n.runWebGLProgram(l,[i],i.dtype)}};class ZT{constructor(e,t,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=i,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ${this.depth}; ++d) {\n          int depthBegin = int(max(0.0, float(d - ${t})));\n          int depthEnd = int(min(float(${this.depth}),\n              float(d + ${t} + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ${this.depth};\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(${r}) * norm + float(${n});\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(${r})\n                * float(${i})\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ${i});\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    `}}const QT={kernelName:O.LRNGrad,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i,y:o,dy:a}=t,{depthRadius:s,bias:u,alpha:l,beta:c}=r,p=new ZT(i.shape,s,u,l,c);return n.runWebGLProgram(p,[i,o,a],i.dtype)}};function eE(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:o,keepDims:a}=r,s=i.shape.length,u=O.util.parseAxisParam(o,i.shape);let l=u;const c=O.backend_util.getAxesPermutation(l,s),p=null!=c,d=n.shouldExecuteOnCPU([i]);let h=i;if(p){if(d){const e=n.texData.get(h.dataId).values,t=new Array(s);for(let e=0;e<t.length;e++)t[e]=i.shape[c[e]];const r=uk(e,i.shape,i.dtype,c,t);h=n.makeTensorInfo(t,i.dtype),n.texData.get(h.dataId).values=r}else h=bS(i,c,n);l=O.backend_util.getInnerMostAxes(l.length,s)}O.backend_util.assertAxesAreInnerMostDims("max",l,s);const[f,g]=O.backend_util.computeOutAndReduceShapes(h.shape,l);let m,y=f;if(a&&(y=O.backend_util.expandShapeToKeepDim(f,u)),d){const e=n.texData.get(h.dataId).values,t=Dw(e,O.util.sizeFromShape(g),y,i.dtype);m=n.makeTensorInfo(y,i.dtype),n.texData.get(m.dataId).values=t}else m=function(e,t,n,r){const i=O.util.sizeFromShape(t),o=pS({inputs:{x:e},attrs:{shape:[O.util.sizeFromShape(e.shape)/i,i]},backend:r}),a=gS(o,e.dtype,"max",r),s=pS({inputs:{x:a},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(a),s}(h,g,y,n);return p&&n.disposeIntermediateTensorInfo(h),m}const tE={kernelName:O.Max,backendName:"webgl",kernelFunc:eE},nE=rS({opSnippet:jk+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Uk+"\n  return result;\n",cpuKernelImpl:Iw}),rE={kernelName:O.Maximum,backendName:"webgl",kernelFunc:nE},iE={kernelName:O.MaxPool,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;g_(i,"maxPool");const{filterSize:o,strides:a,pad:s,dimRoundingMode:u}=r;O.util.assert(O.backend_util.eitherStridesOrDilationsAreOne(a,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '1'`));const l=O.backend_util.computePool2DInfo(i.shape,o,a,1,s,u);if(1===l.filterWidth&&1===l.filterHeight&&O.util.arraysEqual(l.inShape,l.outShape))return Vk({inputs:{x:i},backend:n});const c=new rC(l,"max",!1);return n.runWebGLProgram(c,[i],i.dtype)}},oE={kernelName:O.MaxPool3D,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:o,strides:a,pad:s,dataFormat:u,dimRoundingMode:l}=r,c=O.backend_util.computePool3DInfo(i.shape,o,a,[1,1,1],s,l,u),p=new iC(c,"max",!1);return n.runWebGLProgram(p,[i],i.dtype)}};class aE{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,s=o-1-e.padInfo.left,u=i*o-1;this.userCode=`\n      const ivec2 pads = ivec2(${a}, ${s});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${i};\n          wR += ${r}) {\n          float dyR = float(dyRCorner + wR) / ${t}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${o}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${n}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ${o} + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class sE{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.front,p=u-1-e.padInfo.top,d=l-1-e.padInfo.left,h=s*u*l-1;this.userCode=`\n      const ivec3 pads = ivec3(${c}, ${p}, ${d});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${s};\n           wD += ${i}) {\n          float dyD = float(dyDCorner + wD) / ${t}.0;\n\n          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${u};\n              wR += ${o}) {\n            float dyR = float(dyRCorner + wR) / ${n}.0;\n\n            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${l};\n                wC += ${a}) {\n              float dyC = float(dyCCorner + wC) / ${r}.0;\n\n              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ${h} -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ${u} * ${l} +\n                  wR * ${l} + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const uE={kernelName:O.MaxPool3DGrad,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:o}=t,a=o,{filterSize:s,strides:u,pad:l,dimRoundingMode:c}=r,p=O.backend_util.computePool3DInfo(a.shape,s,u,[1,1,1],l,c),d=new iC(p,"max",!0),h=n.runWebGLProgram(d,[a],a.dtype),f=new sE(p),g=n.runWebGLProgram(f,[i,h],a.dtype);return n.disposeIntermediateTensorInfo(h),g}},lE={kernelName:O.MaxPoolGrad,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:o,output:a}=t,s=o;g_([o,a],"maxPoolGrad");const{filterSize:u,strides:l,pad:c,dimRoundingMode:p}=r,d=O.backend_util.computePool2DInfo(s.shape,u,l,1,c,p),h=new rC(d,"max",!0),f=n.runWebGLProgram(h,[s],s.dtype),g=new aE(d),m=n.runWebGLProgram(g,[i,f],s.dtype);return n.disposeIntermediateTensorInfo(f),m}},cE={kernelName:O.MaxPoolWithArgmax,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{filterSize:i,strides:o,pad:a,includeBatchInIndex:s}=t,u=n;O.util.assert(4===r.shape.length,(()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`));const l=[1,1];O.util.assert(O.backend_util.eitherStridesOrDilationsAreOne(o,l),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`));const c=O.backend_util.computePool2DInfo(r.shape,i,o,l,a),[p,d]=function(e,t,n,r){let i=new rC(n,"max",!1);const o=r.runWebGLProgram(i,[e],"float32");return i=new rC(n,"max",!0,!0,t),[o,r.runWebGLProgram(i,[e],"float32")]}(r,s,c,u);return[p,d]}},pE={kernelName:O.Mean,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{keepDims:i,axis:o}=t,a=n,s=r.shape.length,u=O.util.parseAxisParam(o,r.shape);let l=u;const c=O.backend_util.getAxesPermutation(l,s),p=null!=c,d=a.shouldExecuteOnCPU([r]),h=[];let f=r;if(p){if(d){const e=a.texData.get(f.dataId).values,t=new Array(s);for(let e=0;e<t.length;e++)t[e]=r.shape[c[e]];const n=uk(e,r.shape,r.dtype,c,t);f=a.makeTensorInfo(t,r.dtype),a.texData.get(f.dataId).values=n}else f=bS(r,c,a);h.push(f),l=O.backend_util.getInnerMostAxes(l.length,s)}O.backend_util.assertAxesAreInnerMostDims("sum",l,s);const[g,m]=O.backend_util.computeOutAndReduceShapes(f.shape,l);let y=g;i&&(y=O.backend_util.expandShapeToKeepDim(g,u));const b=function(e,t,n,r){const i=O.util.sizeFromShape(t),o=pS({inputs:{x:e},attrs:{shape:[O.util.sizeFromShape(e.shape)/i,i]},backend:r}),a=gS(o,"float32","mean",r),s=pS({inputs:{x:a},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(a),s}(f,m,y,a);for(const e of h)a.disposeIntermediateTensorInfo(e);return b}},dE={kernelName:O.Min,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:a}=r,s=i.shape.length,u=O.util.parseAxisParam(o,i.shape);let l=u;const c=O.backend_util.getAxesPermutation(l,s);let p=i;null!=c&&(p=_S({inputs:{x:i},backend:n,attrs:{perm:c}}),l=O.backend_util.getInnerMostAxes(l.length,i.shape.length)),O.backend_util.assertAxesAreInnerMostDims("min",l,s);const[d,h]=O.backend_util.computeOutAndReduceShapes(p.shape,l),f=pS({inputs:{x:p},backend:n,attrs:{shape:[-1,O.util.sizeFromShape(h)]}}),g=gS(f,f.dtype,"min",n);let m;return m=pS(a?{inputs:{x:g},backend:n,attrs:{shape:O.backend_util.expandShapeToKeepDim(d,u)}}:{inputs:{x:g},backend:n,attrs:{shape:d}}),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),null!=c&&n.disposeIntermediateTensorInfo(p),m}},hE=rS({opSnippet:jk+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Uk+"\n  return result;\n",cpuKernelImpl:Bw}),fE={kernelName:O.Minimum,backendName:"webgl",kernelFunc:hE};class gE{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,i=R_(r),o=t.map((e=>e[0])).join(","),a=t.map(((t,n)=>t[0]+e[n])).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),u="reflect"===n?0:1;this.userCode=1!==r?`\n      ${i} start = ${i}(${o});\n      ${i} end = ${i}(${a});\n\n      void main() {\n        ${i} outC = getOutputCoords();\n        for (int i = 0; i < ${r}; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ${u};\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};\n          }\n        }\n        ${i} coords = outC - start;\n        setOutput(getX(${s}));\n      }\n    `:`\n        int start = ${o};\n        int end = ${a};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ${u};\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ${u};\n          }\n          setOutput(getX(outC - start));\n        }\n      `}}class mE{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,i=R_(r),o=t.map((e=>e[0])).join(","),a=t.map(((t,n)=>t[0]+e[n])).join(","),s=pk("rc",r),u=pk("source",r),l=`${s[r-1]} < ${this.outputShape[r-1]}`,c=1===r?"source":`vec2(${u.slice(-2).join()})`,p="reflect"===n?0:1;let d="";if(1===r){const e=`\n        ${i} source = rc;\n        if (source < start) {\n          source = start * 2 - source - ${p};\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ${p};\n        }\n        source -= start;\n      `;d=`\n        ${i} rc = outputLoc;\n        ${e}\n        result[0] = getChannel(getX(${u.join()}), ${c});\n        ${s[r-1]} += 1;\n        if(${l}) {\n          ${e}\n          result[1] = getChannel(getX(${u.join()}), ${c});\n        }\n      `}else{const e=`\n        ${i} source = rc;\n        ${i} lt = ${i}(lessThan(source, start));\n        ${i} gte = ${i}(greaterThanEqual(source, end));\n        ${i} orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ${p}) +\n                gte * ((end - 1) * 2 - source + ${p});\n        source -= start;\n      `;d=`\n        ${i} rc = outputLoc;\n        ${e}\n        result[0] = getChannel(getX(${u.join()}), ${c});\n        ${s[r-1]} += 1;\n        if(${l}) {\n          ${e}\n          result[1] = getChannel(getX(${u.join()}), ${c});\n        }\n        rc = outputLoc;\n        ${s[r-2]} += 1;\n        if(${s[r-2]} < ${this.outputShape[r-2]}) {\n          ${e}\n          result[2] = getChannel(getX(${u.join()}), ${c});\n          ${s[r-1]} += 1;\n          if(${l}) {\n            ${e}\n            result[3] = getChannel(getX(${u.join()}), ${c});\n          }\n        }\n      `}this.userCode=`\n      const ${i} start = ${i}(${o});\n      const ${i} end = ${i}(${a});\n\n      void main() {\n        ${i} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${d}\n        setOutput(result);\n      }\n    `}}const yE={kernelName:O.MirrorPad,backendName:"webgl",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r}=e,{paddings:i,mode:o}=n,a=(0,O.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new mE(r.shape,i,o):new gE(r.shape,i,o);return t.runWebGLProgram(a,[r],r.dtype)}},bE=rS({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+Uk+"\n  return result;\n"}),vE={kernelName:O.Mod,backendName:"webgl",kernelFunc:bE};class xE{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ${t-1}; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(${t-1}));\n      }\n    `}}const _E=rS({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),wE={kernelName:O.RealDiv,backendName:"webgl",kernelFunc:_E},kE="return a - b;",SE=rS({opSnippet:kE,packedOpSnippet:kE,supportsComplex:!0,cpuKernelImpl:ok}),CE={kernelName:O.Sub,backendName:"webgl",kernelFunc:SE};function ME(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:o}=r,a=O.util.parseAxisParam([o],i.shape),s=eE({inputs:{x:i},backend:n,attrs:{reductionIndices:a,keepDims:!1}}),u=O.backend_util.expandShapeToKeepDim(s.shape,a),l=pS({inputs:{x:s},backend:n,attrs:{shape:u}}),c=SE({inputs:{a:i,b:l},backend:n}),p=VM({inputs:{x:c},backend:n}),d=vS({inputs:{x:p},backend:n,attrs:{axis:a,keepDims:!1}}),h=pS({inputs:{x:d},backend:n,attrs:{shape:u}}),f=_E({inputs:{a:p,b:h},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),f}const TE={kernelName:O.Softmax,backendName:"webgl",kernelFunc:ME},EE={kernelName:O.Multinomial,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:o,seed:a,normalized:s}=r,u=s?i:ME({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),l=u.shape[0],c=u.shape[1],p=new xE(l,c,o),d=[[a]],h=n.runWebGLProgram(p,[u],"int32",d);return s||n.disposeIntermediateTensorInfo(u),h}},AE=vk+"\n  return -x;\n",FE={kernelName:O.Neg,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){const e=n.texData.get(r.dataId),[t,i]=Pw(e.values,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,t)}let i;return i=(0,O.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Rk(r.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new bk(r.shape,AE),n.runWebGLProgram(i,[r],r.dtype)}},OE=O.kernel_impls.nonMaxSuppressionV3Impl,RE={kernelName:O.NonMaxSuppressionV3,backendName:"webgl",kernelFunc:function(e){O.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:o}=t,{maxOutputSize:a,iouThreshold:s,scoreThreshold:u}=r,l=n.readSync(i.dataId),c=n.readSync(o.dataId),{selectedIndices:p}=OE(l,c,a,s,u);return n.makeTensorInfo([p.length],"int32",new Int32Array(p))}},NE=O.kernel_impls.nonMaxSuppressionV4Impl,DE={kernelName:O.NonMaxSuppressionV4,backendName:"webgl",kernelFunc:function(e){O.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:o}=t,{maxOutputSize:a,iouThreshold:s,scoreThreshold:u,padToMaxOutputSize:l}=r,c=n.readSync(i.dataId),p=n.readSync(o.dataId),{selectedIndices:d,validOutputs:h}=NE(c,p,a,s,u,l);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}},IE=O.kernel_impls.nonMaxSuppressionV5Impl,BE={kernelName:O.NonMaxSuppressionV5,backendName:"webgl",kernelFunc:function(e){O.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:o}=t,{maxOutputSize:a,iouThreshold:s,scoreThreshold:u,softNmsSigma:l}=r,c=n.readSync(i.dataId),p=n.readSync(o.dataId),d=a,h=s,f=u,g=l,{selectedIndices:m,selectedScores:y}=IE(c,p,d,h,f,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}};class LE{constructor(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(${r}), float(${n}),\n                      float(index == coords.y)));\n      }\n    `}}const PE={kernelName:O.OneHot,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:o,depth:a,onValue:s,offValue:u}=r,l=O.util.sizeFromShape(i.shape),c=new LE(l,a,s,u),p=pS({inputs:{x:i},backend:n,attrs:{shape:[l]}}),d=n.runWebGLProgram(c,[p],o);n.disposeIntermediateTensorInfo(p);const h=pS({inputs:{x:d},backend:n,attrs:{shape:[...i.shape,a]}});return n.disposeIntermediateTensorInfo(d),h}};function $E(e){const{inputs:t,backend:n}=e,{x:r}=t;if("complex64"===r.dtype){const e=MC({inputs:{input:r},backend:n}),t=$E({inputs:{x:e},backend:n}),i=jC({inputs:{input:r},backend:n}),o=$E({inputs:{x:i},backend:n}),a=qk({inputs:{real:t,imag:o},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),a}return nT({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}const zE={kernelName:O.ZerosLike,backendName:"webgl",kernelFunc:$E},jE={kernelName:O.OnesLike,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r}=t,{x:i}=n;if("string"===i.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===i.dtype){const t=MC({inputs:{input:i},backend:r}),n=e({inputs:{x:t},backend:r}),o=jC({inputs:{input:i},backend:r}),a=$E({inputs:{x:o},backend:r}),s=qk({inputs:{real:n,imag:a},backend:r});return r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(a),s}return nT({attrs:{shape:i.shape,dtype:i.dtype,value:1},backend:r})}},GE={kernelName:O.Pack,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(1===t.length)return qM({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const o=t[0].shape,a=t[0].dtype;t.forEach((e=>{O.util.assertShapesMatch(o,e.shape,"All tensors passed to stack must have matching shapes"),O.util.assert(a===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const s=[],u=WC({inputs:t.map((e=>{const t=qM({inputs:{input:e},backend:n,attrs:{dim:i}});return s.push(t),t})),backend:n,attrs:{axis:i}});return s.forEach((e=>n.disposeIntermediateTensorInfo(e))),u}};class UE{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,i=R_(r),o=t.map((e=>e[0])).join(","),a=t.map(((t,n)=>t[0]+e[n])).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?`\n      ${i} start = ${i}(${o});\n      ${i} end = ${i}(${a});\n\n      void main() {\n        ${i} outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ${i} coords = outC - start;\n          setOutput(getX(${s}));\n        }\n      }\n    `:`\n        int start = ${o};\n        int end = ${a};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      `}}class WE{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,i=R_(r),o=t.map((e=>e[0])).join(","),a=t.map(((t,n)=>t[0]+e[n])).join(","),s=pk("rc",r),u=pk("source",r),l=`${s[r-1]} < ${this.outputShape[r-1]}`,c=1===r?"source":`vec2(${u.slice(-2).join()})`,p=[`${i} rc = outputLoc;`,`${s[r-1]} += 1;\n       if(${l}) {\n      `,1===r?"":`}\n       rc = outputLoc;\n       ${s[r-2]} += 1;\n       if(${s[r-2]} < ${this.outputShape[r-2]}) {`,1===r?"":`  ${s[r-1]} += 1;\n         if(${l}) {`],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let h="";for(let e=0,t=1===r?2:4;e<t;e++)h+=`\n        ${p[e]}\n        if (${d}) {\n          result[${e}] = float(value);\n        } else {\n          ${i} source = rc - start;\n          result[${e}] = getChannel(getX(${u.join()}), ${c});\n        }\n      `;h+=1===r?"} ":"}}",this.userCode=`\n      const ${i} start = ${i}(${o});\n      const ${i} end = ${i}(${a});\n\n      void main() {\n        ${i} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${h}\n        setOutput(result);\n      }\n    `}}const VE=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:o,constantValue:a}=r;if(0===O.util.sizeFromShape(i.shape)){const e=o.map(((e,t)=>e[0]+i.shape[t]+e[1]));return nT({backend:n,attrs:{shape:e,value:a,dtype:i.dtype}})}const s=(0,O.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new WE(i.shape,o,a):new UE(i.shape,o,a),u=[[a]];return n.runWebGLProgram(s,[i],i.dtype,u)},HE={kernelName:O.PadV2,backendName:"webgl",kernelFunc:VE},qE=rS({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+Uk+"\n  return result;\n"}),XE={kernelName:O.Pow,backendName:"webgl",kernelFunc:qE},YE={kernelName:O.Prod,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:a}=r,s=i.shape.length,u=[],l=O.util.parseAxisParam(o,i.shape);let c=l;const p=O.backend_util.getAxesPermutation(c,s);let d,h=i;if(null!=p&&(h=_S({inputs:{x:i},backend:n,attrs:{perm:p}}),c=O.backend_util.getInnerMostAxes(c.length,s),u.push(h)),O.backend_util.assertAxesAreInnerMostDims("prod",c,s),n.shouldExecuteOnCPU([h])){const e=n.texData.get(h.dataId).values,{outVals:t,outShape:r,outDtype:i}=zw(h.shape,h.dtype,e,c);d=n.makeTensorInfo(r,i,t)}else{const[e,t]=O.backend_util.computeOutAndReduceShapes(h.shape,c),r=O.util.sizeFromShape(t),o=pS({inputs:{x:h},backend:n,attrs:{shape:[-1,r]}}),a=gS(o,(0,O.sumOutType)(i.dtype),"prod",n);d=pS({inputs:{x:a},backend:n,attrs:{shape:e}}),u.push(o),u.push(a)}if(a){u.push(d);const e=O.backend_util.expandShapeToKeepDim(d.shape,l);d=pS({inputs:{x:d},backend:n,attrs:{shape:e}})}return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),d}},KE={kernelName:O.RaggedGather,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:o,indices:a}=t,{outputRaggedRank:s}=r,u=i.map((e=>n.readSync(e.dataId))),l=i.map((e=>e.shape)),c=n.readSync(o.dataId),p=n.readSync(a.dataId),[d,h,f]=jw(u,l,c,o.shape,o.dtype,p,a.shape,s),g=d.map((e=>n.makeTensorInfo([e.length],"int32",e))),m=n.makeTensorInfo(f,o.dtype,h);return g.concat([m])}},JE={kernelName:O.RaggedRange,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:o}=t,a=n.readSync(r.dataId),s=n.readSync(i.dataId),u=n.readSync(o.dataId),[l,c]=Gw(a,r.shape,r.dtype,s,i.shape,u,o.shape);return[n.makeTensorInfo([l.length],"int32",l),n.makeTensorInfo([c.length],r.dtype,c)]}},ZE={kernelName:O.RaggedTensorToTensor,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{shape:i,values:o,defaultValue:a,rowPartitionTensors:s}=t,{rowPartitionTypes:u}=r,l=n.readSync(i.dataId),c=n.readSync(o.dataId),p=n.readSync(a.dataId),d=s.map((e=>n.readSync(e.dataId))),h=s.map((e=>e.shape)),[f,g]=Uw(l,i.shape,c,o.shape,o.dtype,p,a.shape,d,h,u);return n.makeTensorInfo(f,o.dtype,g)}},QE=e=>{const{backend:t,attrs:n}=e,{start:r,stop:i,step:o,dtype:a}=n,s=Ww(r,i,o,a);return t.makeTensorInfo([s.length],a,s)},eA={kernelName:O.Range,backendName:"webgl",kernelFunc:QE},tA=nS({opSnippet:"return 1.0 / x;"}),nA={kernelName:O.Reciprocal,backendName:"webgl",kernelFunc:tA},rA=nS({opSnippet:vk+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),iA={kernelName:O.Relu,backendName:"webgl",kernelFunc:rA},oA=nS({opSnippet:vk+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),aA={kernelName:O.Relu6,backendName:"webgl",kernelFunc:oA};class sA{constructor(e,t,n,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,s,u]=e;this.outputShape=[o,t,n,u];const l=[r&&t>1?a-1:a,r&&n>1?s-1:s],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];let p;p=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${l[0]/c[0]},\n          ${l[1]/c[1]});\n      const vec2 inputShapeRC = vec2(${a}.0, ${s}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${p};\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    `}}class uA{constructor(e,t,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,s,u]=e;this.outputShape=[o,t,n,u];const l=[r&&t>1?a-1:a,r&&n>1?s-1:s],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];let p;p=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${l[0]/c[0]},\n          ${l[1]/c[1]},\n          ${l[1]/c[1]});\n      const vec3 inputShapeRC = vec3(${a}.0, ${s}.0,\n                                     ${s}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${p};\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${u-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    `}}const lA={kernelName:O.ResizeBilinear,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:o,halfPixelCenters:a,size:s}=r,[u,l]=s,c=(0,O.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new uA(i.shape,u,l,o,a):new sA(i.shape,u,l,o,a);return n.runWebGLProgram(c,[i],"float32")}};class cA{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,i]=t,[,o,a]=e,s=[n&&o>1?r-1:r,n&&a>1?i-1:i],u=[n&&o>1?o-1:o,n&&a>1?a-1:a],l=s[0]/u[0],c=s[1]/u[1],p=1/l,d=1/c,h=2*Math.ceil(p)+2,f=2*Math.ceil(d)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${l});\n        const float widthScale = float(${c});\n\n        const float invHeightScale = float(${p});\n        const float invWidthScale = float(${d});\n\n        const int winHeight = int(${h});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${o}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${a}) {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}const pA={kernelName:O.ResizeBilinearGrad,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:o}=t,{alignCorners:a}=r,s=new cA(o.shape,i.shape,a);return n.runWebGLProgram(s,[o],o.dtype)}};class dA{constructor(e,t,n,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,s,u]=e;this.outputShape=[o,t,n,u];const l=[r&&t>1?a-1:a,r&&n>1?s-1:s],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],p=r?"0.5":"0.0";let d;d=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${l[0]/c[0]},\n          ${l[1]/c[1]});\n      const vec2 inputShapeRC = vec2(${a}.0, ${s}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${d};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    `}}class hA{constructor(e,t,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,s,u]=e;this.outputShape=[o,t,n,u];const l=[r&&t>1?a-1:a,r&&n>1?s-1:s],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],p=r?"0.5":"0.0";let d;d=i?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${l[0]/c[0]},\n          ${l[1]/c[1]},\n          ${l[1]/c[1]});\n      const vec3 inputShapeRC = vec3(${a}.0, ${s}.0,\n                                     ${s}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${d};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${u-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    `}}const fA={kernelName:O.ResizeNearestNeighbor,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:o,halfPixelCenters:a,size:s}=r,[u,l]=s,c=(0,O.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new hA(i.shape,u,l,o,a):new dA(i.shape,u,l,o,a);return n.runWebGLProgram(c,[i],i.dtype)}};class gA{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,i]=t,[,o,a]=e,s=[n&&o>1?r-1:r,n&&a>1?i-1:i],u=[n&&o>1?o-1:o,n&&a>1?a-1:a],l=s[0]/u[0],c=s[1]/u[1],p=1/l,d=1/c,h=2*Math.ceil(p)+2,f=2*Math.ceil(d)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${l});\n        const float widthScale = float(${c});\n\n        const float invHeightScale = float(${p});\n        const float invWidthScale = float(${d});\n\n        const int winHeight = int(${h});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${o}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${a}) {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(${s[0]}) *\n                (float(dyR) / float(${u[0]}));\n\n            float sourceFracCol =\n                float(${s[1]}) *\n                  (float(dyC) / float(${u[1]}));\n\n            int sourceNearestRow = int(min(\n                float(int(${r}) - 1),\n                ${n} ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(${i}) - 1),\n                ${n} ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}const mA={kernelName:O.ResizeNearestNeighborGrad,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:o}=t,{alignCorners:a}=r,s=new gA(o.shape,i.shape,a);return n.runWebGLProgram(s,[o],o.dtype)}};class yA{constructor(e,t){this.variableNames=["x"];const n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=e,1===n)return void(this.userCode=`\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(${e[0]} - coord - 1));\n        }\n      `);const r=e.map(((n,r)=>(n=>-1!==t.indexOf(n)&&1!==e[n]?`${e[n]} - coords[${n}] - 1`:`coords[${n}]`)(r))).join(","),i=R_(n);this.userCode=`\n      void main() {\n        ${i} coords = getOutputCoords();\n        setOutput(getX(${r}));\n      }\n    `}}class bA{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=e;const r=pk("rc",n),i=`${r[n-1]} + 1 < ${this.outputShape[n-1]}`,o=`${r[n-2]} + 1 < ${this.outputShape[n-2]}`,a=R_(n);function s(n){const r=e.map(((r,i)=>function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?`${e[n]} - ${r[n]} - 1`:`${r[n]}`}(i,n)));return`getChannel(getX(${r.join(",")}), vec2(${r.slice(-2).join(",")}))`}this.userCode=1===n?`\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${e[0]} - rc - 1),\n            ${e[0]} - rc - 1);\n          if(${i}){\n              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),\n                ${e[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `:`\n        void main() {\n          ${a} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${function(e){return s(e)}(r.slice())};\n          if(${i}){\n            result.g = ${function(e){return e[n-1]="("+e[n-1]+" + 1)",s(e)}(r.slice())};\n          }\n          if(${o}) {\n            result.b = ${function(e){return e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())};\n            if(${i}) {\n              result.a = ${function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `}}const vA={kernelName:O.Reverse,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:o}=r,a=i.shape.length,s=O.util.parseAxisParam(o,i.shape);if(0===a)return Vk({inputs:{x:i},backend:n});const u=(0,O.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new bA(i.shape,s):new yA(i.shape,s);return n.runWebGLProgram(u,[i],i.dtype)}};class xA{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=e[1],r=e[2];this.outputShape=e;let i="";i="number"==typeof t?`float outputValue = ${t.toFixed(2)};`:`\n        vec3 fill = vec3(${t.join(",")});\n        float outputValue = fill[coords[3]];`,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ${i}\n          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${n}) {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}const _A={kernelName:O.RotateWithOffset,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,{radians:i,fillValue:o,center:a}=t,s=n,u=new xA(r.shape,o),[l,c]=O.backend_util.getImageCenter(a,r.shape[1],r.shape[2]),p=[[l,c,Math.sin(i),Math.cos(i)]];return s.runWebGLProgram(u,[r],r.dtype,p)}},wA=nS({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),kA={kernelName:O.Round,backendName:"webgl",kernelFunc:wA},SA=nS({opSnippet:"return inversesqrt(x);",cpuKernelImpl:Vw}),CA={kernelName:O.Rsqrt,backendName:"webgl",kernelFunc:SA};class MA{constructor(e,t,n,r,i,o,a=!0,s=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const u=R_(i.length),l=R_(o.length);let c="";1===n?c="i":2===n&&(c="i, j");const p=`getIndices(${c})`;let d="";1===r?d="i":2===r&&(d="i, coords[1]");const h=`getUpdates(${d})`;let f="";s&&(f="coords[0], coords[1]");const g=`getDefaultValue(${f})`,m=t>1?"strides[j]":"strides";this.userCode=`\n        ${u} strides = ${u}(${i});\n\n        void main() {\n          ${l} coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ${e}; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ${t}; j++) {\n              int index = round(${p});\n              flattenedIndex += index * ${m};\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ${h};\n              found = true;\n            }\n          }\n          setOutput(mix(${g}, sum, float(found)));\n        }\n      `}}class TA{constructor(e,t,n,r,i,o,a=!0,s=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const u=R_(i.length),l=R_(o.length);let c="";1===n?c="i":2===n&&(c="i, j");const p=`getIndices(${c})`;let d="";1===r?d="i":2===r&&(d="i, coords[1]");const h=`getUpdates(${d})`;let f="";s&&(f="coords[0], coords[1]");const g=`getDefaultValue(${f})`,m=t>1?"strides[j]":"strides",y=t>1?"strides[j + 1]":"strides";this.userCode=`\n        ${u} strides = ${u}(${i});\n\n        void main() {\n          ${l} coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ${e}; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ${t}; j+=2) {\n              ivec4 index = round(${p});\n              flattenedIndex += index.xz * ${m};\n              if (j + 1 < ${t}) {\n                flattenedIndex += index.yw * ${y};\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ${h};\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(${g}, sum, found));\n        }\n      `}}const EA={kernelName:O.ScatterNd,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:o}=t,{shape:a}=r,{sliceRank:s,numUpdates:u,sliceSize:l,strides:c,outputSize:p}=O.backend_util.calculateShapes(o,i,a),d=[p/l,l];if(0===p)return n.makeTensorInfo(a,i.dtype);const h=pS({inputs:{x:i},backend:n,attrs:{shape:[u,s]}}),f=pS({inputs:{x:o},backend:n,attrs:{shape:[u,l]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));let m;m=(0,O.env)().getBool("WEBGL_PACK")?new TA(u,s,h.shape.length,f.shape.length,c,d):new MA(u,s,h.shape.length,f.shape.length,c,d);const y=n.runWebGLProgram(m,[f,h,g],f.dtype),b=pS({inputs:{x:y},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),b}};class AA{constructor(e,t,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];const i=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,o=2===(0,O.env)().getNumber("WEBGL_VERSION")?"while (left < right) {":i,a="left"===r?"<":"<=";this.userCode=`\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ${o}\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ${a} value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     `}}const FA={kernelName:O.SearchSorted,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:o}=t,{side:a}=r,s=new AA(i.shape[0],i.shape[1],o.shape[1],a),u=[[i.shape[1]]];return n.runWebGLProgram(s,[i,o],"int32",u)}};class OA{constructor(e,t,n){let r,i;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error(`Where for rank ${n} is not yet supported`);if(1===n)i="resRC",r="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],a=[];for(let r=0;r<t.length;r++)a.push(`${n[r]}`),r<e&&o.push(`${n[r]}`);r=o.join(),i=a.join()}const o=R_(n);this.userCode=`\n      void main() {\n        ${o} resRC = getOutputCoords();\n        float cVal = getC(${r});\n        if (cVal >= 1.0) {\n          setOutput(getA(${i}));\n        } else {\n          setOutput(getB(${i}));\n        }\n      }\n    `}}const RA={kernelName:O.Select,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:r,t:i,e:o}=t,a=new OA(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(a,[r,i,o],(0,O.upcastType)(i.dtype,o.dtype))}},NA=nS({opSnippet:`\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ${O.backend_util.SELU_SCALEALPHA};\n  float scale = ${O.backend_util.SELU_SCALE};\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n`}),DA={kernelName:O.Selu,backendName:"webgl",kernelFunc:NA},IA=nS({opSnippet:tS+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:qw}),BA={kernelName:O.Sigmoid,backendName:"webgl",kernelFunc:IA},LA=nS({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),PA={kernelName:O.Sign,backendName:"webgl",kernelFunc:LA},$A=nS({opSnippet:tS+"\n  return sin(x);\n",packedOpSnippet:`\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ${Uk}\n  return result;\n`}),zA={kernelName:O.Sin,backendName:"webgl",kernelFunc:$A},jA=nS({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),GA={kernelName:O.Sinh,backendName:"webgl",kernelFunc:jA},UA=nS({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),WA={kernelName:O.Softplus,backendName:"webgl",kernelFunc:UA},VA={kernelName:O.SpaceToBatchND,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:o,paddings:a}=r;O.util.assert(i.shape.length<=4,(()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"));const s=o.reduce(((e,t)=>e*t)),u=[[0,0]];u.push(...a);for(let e=1+o.length;e<i.shape.length;++e)u.push([0,0]);const l=[],c=VE({inputs:{x:i},backend:n,attrs:{paddings:u,constantValue:0}}),p=O.backend_util.getReshaped(c.shape,o,s,!1),d=O.backend_util.getPermuted(p.length,o.length,!1),h=O.backend_util.getReshapedPermuted(c.shape,o,s,!1),f=pS({inputs:{x:c},backend:n,attrs:{shape:p}}),g=_S({inputs:{x:f},backend:n,attrs:{perm:d}}),m=pS({inputs:{x:g},backend:n,attrs:{shape:h}});return l.push(c),l.push(f),l.push(g),l.forEach((e=>n.disposeIntermediateTensorInfo(e))),m}},HA={kernelName:O.SparseFillEmptyRows,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:o,defaultValue:a}=t;if(1!==o.shape.length)throw new Error(`Dense shape must be a vector, saw:\n         ${o.shape}`);if(2!==r.shape.length)throw new Error(`Indices must be a matrix, saw:\n         ${r.shape}`);if(1!==i.shape.length)throw new Error(`Values must be a vector, saw:\n         ${i.shape}`);if(0!==a.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${a.shape}`);const s=n.readSync(r.dataId),u=n.readSync(i.dataId),l=n.readSync(o.dataId),c=n.readSync(a.dataId)[0],[p,d,h,f,g]=Kw(s,r.shape,r.dtype,u,i.dtype,l,c);return[n.makeTensorInfo(d,r.dtype,p),n.makeTensorInfo([d[0]],i.dtype,h),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map((e=>Number(e))))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}},qA={kernelName:O.SparseReshape,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:o}=t;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(1!==i.shape.length)throw new Error(`Input shape should be a vector but received shape ${i.shape}`);if(1!==o.shape.length)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const a=Array.from(n.readSync(i.dataId)),s=n.readSync(r.dataId),u=Array.from(n.readSync(o.dataId)),[l,c,p]=Jw(s,r.shape,r.dtype,a,u);return[n.makeTensorInfo(c,r.dtype,l),n.makeTensorInfo([p.length],o.dtype,new Int32Array(p))]}},XA={kernelName:O.SparseSegmentMean,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:o}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n              ${i.shape}`);if(1!==o.shape.length)throw new Error(`Segment ids should be a vector but received shape\n              ${o.shape}`);const a=n.readSync(r.dataId),s=n.readSync(i.dataId),u=n.readSync(o.dataId),[l,c]=Zw(a,r.shape,r.dtype,s,u,!0);return n.makeTensorInfo(c,r.dtype,l)}},YA={kernelName:O.SparseSegmentSum,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:o}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n             ${i.shape}`);if(1!==o.shape.length)throw new Error(`Segment ids should be a vector but received shape\n             ${o.shape}`);const a=n.readSync(r.dataId),s=n.readSync(i.dataId),u=n.readSync(o.dataId),[l,c]=Zw(a,r.shape,r.dtype,s,u);return n.makeTensorInfo(c,r.dtype,l)}},KA={kernelName:O.SparseToDense,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:o,defaultValue:a}=t,{outputShape:s}=r,{sliceRank:u,numUpdates:l,sliceSize:c,strides:p,outputSize:d}=O.backend_util.calculateShapes(o,i,s);if("string"===o.dtype){const e=n.bufferSync(i),t=n.bufferSync(o),r=O.util.decodeString(n.readSync(a.dataId)[0]),h=Hw(e,t,s,d,c,l,u,p,r,!1);return n.makeTensorInfo(s,h.dtype,h.values)}const h=new MA(l,u,i.shape.length,o.shape.length,p,[d,1],!1),f=n.runWebGLProgram(h,[o,i,a],o.dtype),g=pS({inputs:{x:f},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(f),g}},JA={kernelName:O.SplitV,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:o,axis:a}=r,s=O.util.parseAxisParam(a,i.shape)[0],u=O.backend_util.prepareSplitSize(i,o,s),l=i.shape.length,c=new Array(l).fill(0),p=i.shape.slice();return u.map((e=>{const t=[...p];t[s]=e;const r=bC({inputs:{x:i},backend:n,attrs:{begin:c,size:t}});return c[s]+=e,r}))}},ZA="return sqrt(x);",QA=nS({opSnippet:ZA,packedOpSnippet:ZA,cpuKernelImpl:Qw}),eF={kernelName:O.Sqrt,backendName:"webgl",kernelFunc:QA},tF=nS({opSnippet:"return x * x;"}),nF={kernelName:O.Square,backendName:"webgl",kernelFunc:tF},rF="return (a - b) * (a - b);",iF=rS({opSnippet:rF,packedOpSnippet:rF}),oF={kernelName:O.SquaredDifference,backendName:"webgl",kernelFunc:iF},aF={kernelName:O.StaticRegexReplace,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");const o=n.readSync(i.dataId),a=O.backend_util.fromUint8ToStringArray(o),s=ek(a,"string",r);return n.makeTensorInfo(i.shape,"string",s)}},sF={kernelName:O.Step,backendName:"webgl",kernelFunc:function({inputs:e,attrs:t,backend:n}){const{x:r}=e,i=vk+`\n    return x > 0.0 ? 1.0 : float(${t.alpha});\n  `,o=new bk(r.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}};class uF{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;const r=n.length,i=R_(n.length),o=R_(n.length);let a="";if(1===r)a="coords * strides + begin";else{let e=0;a=n.map(((t,r)=>(e++,1===n.length?`coords * strides[${r}] + begin[${r}]`:`coords[${e-1}] * strides[${r}] + begin[${r}]`))).join(",")}this.userCode=`\n      ${i} begin = ${i}(${e});\n      ${i} strides = ${i}(${t});\n\n      void main() {\n        ${o} coords = getOutputCoords();\n        setOutput(getX(${a}));\n      }\n    `}}const lF={kernelName:O.StridedSlice,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:o,end:a,strides:s,beginMask:u,endMask:l,ellipsisMask:c,newAxisMask:p,shrinkAxisMask:d}=r,{finalShapeSparse:h,finalShape:f,isIdentity:g,sliceDim0:m,isSimpleSlice:y,begin:b,end:v,strides:x}=O.slice_util.sliceInfo(i.shape,o,a,s,u,l,c,p,d);let _;if(g)_=pS({inputs:{x:i},backend:n,attrs:{shape:f}});else if(m||y){O.util.assert(i.shape.length>=1,(()=>`Input must have rank at least 1, got: ${i.shape.length}`));const e=O.slice_util.computeOutShape(b,v,x),t=bC({inputs:{x:i},backend:n,attrs:{begin:b,size:e}});_=pS({inputs:{x:t},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(t)}else if(n.shouldExecuteOnCPU([i])){const e=n.readSync(i.dataId),t=(0,O.buffer)(i.shape,i.dtype,e),r=tk(h,t,x,b);_=n.makeTensorInfo(f,i.dtype,r.values)}else{const e=new uF(b,x,h);_=n.runWebGLProgram(e,[i],i.dtype)}const w=pS({inputs:{x:_},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(_),w}},cF={kernelName:O.StringNGrams,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:o,leftPad:a,rightPad:s,padWidth:u,preserveShortSequences:l}=r,{data:c,dataSplits:p}=t,d=n.readSync(c.dataId),h=n.readSync(p.dataId),[f,g]=nk(d,h,i,o,a,s,u,l);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(p.shape,"int32",g)]}},pF={kernelName:O.StringSplit,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:o,delimiter:a}=t;if("string"!==o.dtype)throw new Error("Input must be of datatype string");if(1!==o.shape.length)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(0!==a.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const s=n.readSync(o.dataId),u=n.readSync(a.dataId)[0],[l,c,p]=rk(s,u,i),d=c.length;return[n.makeTensorInfo([d,2],"int32",l),n.makeTensorInfo([d],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(p))]}},dF={kernelName:O.StringToHashBucketFast,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:o}=t;if("string"!==o.dtype)throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const a=n.readSync(o.dataId),s=ik(a,i);return n.makeTensorInfo(o.shape,"int32",s)}},hF=nS({opSnippet:"return tan(x);"}),fF={kernelName:O.Tan,backendName:"webgl",kernelFunc:hF},gF=nS({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),mF={kernelName:O.Tanh,backendName:"webgl",kernelFunc:gF},yF={kernelName:O.TensorScatterUpdate,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{tensor:i,indices:o,updates:a}=t,{}=r,{sliceRank:s,numUpdates:u,sliceSize:l,strides:c,outputSize:p}=O.backend_util.calculateShapes(a,o,i.shape),d=[p/l,l];if(0===p)return n.makeTensorInfo(i.shape,o.dtype);const h=pS({inputs:{x:o},backend:n,attrs:{shape:[u,s]}}),f=pS({inputs:{x:a},backend:n,attrs:{shape:[u,l]}}),g=pS({inputs:{x:i},backend:n,attrs:{shape:d}}),m=new MA(u,s,h.shape.length,f.shape.length,c,d,!1,!0),y=n.runWebGLProgram(m,[f,h,g],g.dtype),b=pS({inputs:{x:y},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),b}};class bF{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;const r=R_(this.rank),i=function(e){const t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(1===t)return`imod(resRC, ${e[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let t=0;t<e.length;t++)r.push(`imod(${n[t]}, ${e[t]})`);return r.join()}(e);this.userCode=`\n      void main() {\n        ${r} resRC = getOutputCoords();\n        setOutput(getA(${i}));\n      }\n    `}}function vF(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:o}=r;if("string"===i.dtype||i.shape.length>5){const e=n.readSync(i.dataId),t="string"===i.dtype?e.map((e=>O.util.decodeString(e))):e,r=(0,O.buffer)(i.shape,i.dtype,t),a=ak(r,o);return n.makeTensorInfo(a.shape,a.dtype,a.values)}const a=new bF(i.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const xF={kernelName:O.Tile,backendName:"webgl",kernelFunc:vF};class _F{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class wF{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}function kF(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function SF(e){let t=1;for(;t<e;)t*=2;return t}const CF={kernelName:O.TopK,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:o,sorted:a}=r,s=(0,O.env)().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=(0,O.env)().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),l=i.shape,c=l[l.length-1];if(n.shouldExecuteOnCPU([i])||c<s||o>u){const e=n.readSync(i.dataId),[t,r]=sk(e,l,i.dtype,o,a);return[n.makeTensorInfo(t.shape,t.dtype,t.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(0===o)return l[l.length-1]=0,[n.makeTensorInfo(l,i.dtype,[]),n.makeTensorInfo(l,"int32",[])];if(1===c)return[i,nT({attrs:{shape:l,dtype:"int32",value:0},backend:n})];const p=n.texData.get(i.dataId),d=null!==p&&p.isPacked,h=d?n.unpackTensor(i):i,f=O.util.sizeFromShape(l)/c,g=pS({inputs:{x:h},attrs:{shape:[f,c]},backend:n});d&&kF(n,h);const m=SF(o),y=SF(c);let b=null;const v=()=>null===b?[g,g]:[g,b],x=(e,t,r)=>{const i=v(),o=new _F(r),a=[[c],[null===b?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],s=b;b=n.runWebGLProgram(o,i,"int32",a),kF(n,s)};for(let e=1;e<m;e*=2){const t=2*e;for(let n=e;n>=1;n/=2)x(t,n,[f,y])}for(let e=y;e>m;e/=2){const t=v(),r=new wF([f,e/2]),i=[[c],[null===b?1:0],[m]],o=b;b=n.runWebGLProgram(r,t,"int32",i),kF(n,o);const a=m/2,s=2*a;for(let e=a;e>=1;e/=2)x(s,e,b.shape)}let _=b;b=bC({inputs:{x:b},backend:n,attrs:{begin:0,size:[f,o]}}),kF(n,_);let w=_T({inputs:{x:g,indices:b},backend:n,attrs:{axis:1,batchDims:1}});kF(n,g);const k=l.slice(0,-1);k.push(o),_=b,b=pS({inputs:{x:b},attrs:{shape:k},backend:n}),kF(n,_);const S=w;return w=pS({inputs:{x:w},attrs:{shape:k},backend:n}),kF(n,S),[w,b]}};class MF{constructor(e,t,n,r,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a="nearest"===n?1:2;let s;switch(r){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode=`\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(${s} == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${s} == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${s} == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(${i});\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(${i});\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(${t}));\n                float mapY = mapCoord(inY, float(${e}));\n\n                if (${a} == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        `}}const TF={kernelName:O.Transform,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:i,transforms:o}=t,{interpolation:a,fillMode:s,fillValue:u,outputShape:l}=r,[c,p,d,h]=i.shape,[f,g]=null!=l?l:[p,d],m=new MF(p,d,a,s,u,[c,f,g,h]);return n.runWebGLProgram(m,[i,o],"float32")}},EF={kernelName:O.Unique,backendName:"webgl",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:o}=t;g_(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const a=r.readSync(o.dataId),{outputValues:s,outputShape:u,indices:l}=lk(a,i,o.shape,o.dtype);return[r.makeTensorInfo(u,o.dtype,s),r.makeTensorInfo([l.length],"int32",l)]}},AF={kernelName:O.Unpack,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:i}=t;let{axis:o}=r;o<0&&(o+=i.shape.length);const a=i,s=a.shape.length,u=i.shape[o],l=new Array(s-1);let c=0;for(let e=0;e<s;e++)e!==o&&(l[c++]=a.shape[e]);const p=[],d=new Array(s).fill(0),h=a.shape.slice();h[o]=1;const f=new Array(u);for(let e=0;e<f.length;e++){d[o]=e;const t=bC({inputs:{x:a},backend:n,attrs:{begin:d,size:h}}),r=pS({inputs:{x:t},backend:n,attrs:{shape:l}});f[e]=r,p.push(t)}return p.forEach((e=>n.disposeIntermediateTensorInfo(e))),f}};class FF{constructor(e,t){this.variableNames=["x","segmentIds"];const n=e.windowSize,r=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/n);this.outputShape=[r,a];const s=4*Math.floor(n/4),u=n%4,l="\n        sumValue += dot(values, segFilter);\n    ";let c="";i%n>0&&(c=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return initializationValue;\n        }\n      `);let p="";i%n>0&&(p=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return -1.0;\n        }\n      `),this.userCode=`\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ${c}\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ${p}\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ${o})) * float(${n}));\n        int currentSeg = int(mod(float(outIdx), float(${o})));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${s}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ${l}\n        }\n\n        int inIdx = inOffset + ${s};\n        if (${1===u}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ${l}\n        } else if (${2===u}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ${l}\n        } else if (${3===u}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ${l}\n        }\n        setOutput(sumValue);\n      }\n    `}}const OF={kernelName:O.UnsortedSegmentSum,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:o}=t,{numSegments:a}=r,s=i.shape.length,u=[];let l=0;const c=O.backend_util.getAxesPermutation([l],s);let p=i;null!=c&&(p=_S({inputs:{x:i},backend:n,attrs:{perm:c}}),u.push(p),l=O.backend_util.getInnerMostAxes(1,s)[0]);const d=O.backend_util.segment_util.computeOutShape(p.shape,l,a),h=O.util.sizeFromShape([p.shape[l]]),f=pS({inputs:{x:p},backend:n,attrs:{shape:[-1,h]}});u.push(f);const g=(0,O.sumOutType)(i.dtype),m=(e,t,r,i,o)=>{const a=e.shape[0],s=e.shape[1],l=O.backend_util.segment_util.segOpComputeOptimalWindowSize(s,o),c=new FF({windowSize:l,inSize:s,batchSize:a,numSegments:o},t),p=n.compileAndRun(c,[e,r],i);if(u.push(p),p.shape[1]===o)return p;const d=QE({backend:n,attrs:{start:0,stop:o,step:1,dtype:"float32"}}),h=vF({inputs:{x:d},backend:n,attrs:{reps:[s/l]}});return u.push(d),u.push(h),m(p,t,h,i,o)},y=pS({inputs:{x:m(f,"unsortedSegmentSum",o,g,a)},backend:n,attrs:{shape:d}});let b=y;if(null!=c){u.push(y);const e=O.backend_util.getUndoAxesPermutation(c);b=_S({inputs:{x:b},backend:n,attrs:{perm:e}})}return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),b}},RF=[CS,TS,AS,OS,DS,LS,PS,$S,VS,HS,XS,KS,ZS,eC,nC,oC,aC,lC,cC,pC,fC,xC,_C,wC,kC,EC,OC,DC,Xk,LC,VC,QC,iM,aM,sM,uM,lM,pM,hM,gM,_M,wM,kM,CM,EM,OM,RM,DM,BM,LM,$M,zM,GM,WM,HM,XM,JM,eT,rT,oT,uT,cT,hT,mT,yT,vT,wT,ST,MT,Hk,TT,GC,AT,OT,NT,Jk,IT,LT,PT,zT,GT,WT,HT,XT,JT,QT,tE,rE,iE,oE,uE,lE,cE,pE,dE,fE,yE,vE,EE,cS,FE,RE,DE,BE,CC,PE,jE,GE,HE,XE,eS,YE,KE,JE,ZE,eA,TC,wE,nA,iA,aA,dS,lA,pA,fA,mA,vA,_A,kA,CA,EA,FA,RA,DA,BA,PA,zA,GA,vC,TE,WA,VA,HA,qA,XA,YA,KA,JA,eF,nF,oF,aF,sF,lF,cF,pF,dF,CE,xS,fF,mF,yF,xF,CF,TF,wS,EF,AF,OF,zE];for(const e of RF)(0,O.registerKernel)(e);const NF={"tfjs-core":O.version_core,"tfjs-backend-cpu":em,"tfjs-backend-webgl":Pk,"tfjs-data":Ch,"tfjs-layers":ba,"tfjs-converter":yd,tfjs:"4.8.0"},DF=e=>"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement,IF=e=>"undefined"!=typeof HTMLAudioElement&&e instanceof HTMLAudioElement,BF=e=>"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement,LF=e=>"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement,PF=e=>"undefined"==typeof ImageData?"object"==typeof e&&(e.data instanceof Uint8ClampedArray||e.data instanceof Uint8Array)&&"number"==typeof e.width&&"number"==typeof e.height:e instanceof ImageData,$F=e=>!!e&&(BF(e)||LF(e)||DF(e)),zF=e=>{if($F(e))return e;if("object"==typeof e){if($F(e.canvas))return e.canvas;if($F(e.elt))return e.elt}return null};class jF{constructor(...e){e.forEach((e=>this.addArg(e)))}addArg(e){var t;if(null!=e)switch(typeof e){case"string":this.set({string:e});break;case"number":this.set({number:e});break;case"function":this.set({callback:e});break;case"object":{((t=e)instanceof O.Tensor&&3===t.rank||PF(e))&&this.set({image:e});const n=zF(e);n&&(this.set({image:n}),DF(n)&&this.set({audio:n,video:n})),IF(e)?this.set({audio:e}):Array.isArray(e)?this.set({array:e}):this.set({options:e});break}default:throw new Error("invalid argument")}}set(e,t=!0){Object.keys(e).forEach((n=>{t&&this.has(n)&&console.warn(`Received multiple ${n} arguments, but only a single ${n} is supported.\n          The last ${n} will be used.`),this[n]=e[n]}))}has(e){return void 0!==this[e]}require(e,t){if(this.has(e))return this;throw new Error(t||`An argument for ${e} must be provided.`)}}function GF(...e){return new jF(...e)}function UF(e,t){return function(){return e.apply(t,arguments)}}const{toString:WF}=Object.prototype,{getPrototypeOf:VF}=Object,HF=(qF=Object.create(null),e=>{const t=WF.call(e);return qF[t]||(qF[t]=t.slice(8,-1).toLowerCase())});var qF;const XF=e=>(e=e.toLowerCase(),t=>HF(t)===e),YF=e=>t=>typeof t===e,{isArray:KF}=Array,JF=YF("undefined"),ZF=XF("ArrayBuffer"),QF=YF("string"),eO=YF("function"),tO=YF("number"),nO=e=>null!==e&&"object"==typeof e,rO=e=>{if("object"!==HF(e))return!1;const t=VF(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},iO=XF("Date"),oO=XF("File"),aO=XF("Blob"),sO=XF("FileList"),uO=XF("URLSearchParams");function lO(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let r,i;if("object"!=typeof e&&(e=[e]),KF(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const i=n?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let a;for(r=0;r<o;r++)a=i[r],t.call(null,e[a],a,e)}}function cO(e,t){t=t.toLowerCase();const n=Object.keys(e);let r,i=n.length;for(;i-- >0;)if(r=n[i],t===r.toLowerCase())return r;return null}const pO="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,dO=e=>!JF(e)&&e!==pO,hO=(fO="undefined"!=typeof Uint8Array&&VF(Uint8Array),e=>fO&&e instanceof fO);var fO;const gO=XF("HTMLFormElement"),mO=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),yO=XF("RegExp"),bO=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};lO(n,((n,i)=>{!1!==t(n,i,e)&&(r[i]=n)})),Object.defineProperties(e,r)},vO="abcdefghijklmnopqrstuvwxyz",xO="0123456789",_O={DIGIT:xO,ALPHA:vO,ALPHA_DIGIT:vO+vO.toUpperCase()+xO},wO=XF("AsyncFunction"),kO={isArray:KF,isArrayBuffer:ZF,isBuffer:function(e){return null!==e&&!JF(e)&&null!==e.constructor&&!JF(e.constructor)&&eO(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||eO(e.append)&&("formdata"===(t=HF(e))||"object"===t&&eO(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&ZF(e.buffer),t},isString:QF,isNumber:tO,isBoolean:e=>!0===e||!1===e,isObject:nO,isPlainObject:rO,isUndefined:JF,isDate:iO,isFile:oO,isBlob:aO,isRegExp:yO,isFunction:eO,isStream:e=>nO(e)&&eO(e.pipe),isURLSearchParams:uO,isTypedArray:hO,isFileList:sO,forEach:lO,merge:function e(){const{caseless:t}=dO(this)&&this||{},n={},r=(r,i)=>{const o=t&&cO(n,i)||i;rO(n[o])&&rO(r)?n[o]=e(n[o],r):rO(r)?n[o]=e({},r):KF(r)?n[o]=r.slice():n[o]=r};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&lO(arguments[e],r);return n},extend:(e,t,n,{allOwnKeys:r}={})=>(lO(t,((t,r)=>{n&&eO(t)?e[r]=UF(t,n):e[r]=t}),{allOwnKeys:r}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let i,o,a;const s={};if(t=t||{},null==e)return t;do{for(i=Object.getOwnPropertyNames(e),o=i.length;o-- >0;)a=i[o],r&&!r(a,e,t)||s[a]||(t[a]=e[a],s[a]=!0);e=!1!==n&&VF(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:HF,kindOfTest:XF,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(KF(e))return e;let t=e.length;if(!tO(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:gO,hasOwnProperty:mO,hasOwnProp:mO,reduceDescriptors:bO,freezeMethods:e=>{bO(e,((t,n)=>{if(eO(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];eO(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach((e=>{n[e]=!0}))};return KF(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>(e=+e,Number.isFinite(e)?e:t),findKey:cO,global:pO,isContextDefined:dO,ALPHABET:_O,generateString:(e=16,t=_O.ALPHA_DIGIT)=>{let n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n},isSpecCompliantForm:function(e){return!!(e&&eO(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(nO(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;const i=KF(e)?[]:{};return lO(e,((e,t)=>{const o=n(e,r+1);!JF(o)&&(i[t]=o)})),t[r]=void 0,i}}return e};return n(e,0)},isAsyncFn:wO,isThenable:e=>e&&(nO(e)||eO(e))&&eO(e.then)&&eO(e.catch)};function SO(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i)}kO.inherits(SO,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:kO.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const CO=SO.prototype,MO={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{MO[e]={value:e}})),Object.defineProperties(SO,MO),Object.defineProperty(CO,"isAxiosError",{value:!0}),SO.from=(e,t,n,r,i,o)=>{const a=Object.create(CO);return kO.toFlatObject(e,a,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),SO.call(a,e.message,t,n,r,i),a.cause=e,a.name=e.name,o&&Object.assign(a,o),a};const TO=SO;function EO(e){return kO.isPlainObject(e)||kO.isArray(e)}function AO(e){return kO.endsWith(e,"[]")?e.slice(0,-2):e}function FO(e,t,n){return e?e.concat(t).map((function(e,t){return e=AO(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const OO=kO.toFlatObject(kO,{},null,(function(e){return/^is[A-Z]/.test(e)})),RO=function(e,t,n){if(!kO.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=kO.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!kO.isUndefined(t[e])}))).metaTokens,i=n.visitor||l,o=n.dots,a=n.indexes,s=(n.Blob||"undefined"!=typeof Blob&&Blob)&&kO.isSpecCompliantForm(t);if(!kO.isFunction(i))throw new TypeError("visitor must be a function");function u(e){if(null===e)return"";if(kO.isDate(e))return e.toISOString();if(!s&&kO.isBlob(e))throw new TO("Blob is not supported. Use a Buffer instead.");return kO.isArrayBuffer(e)||kO.isTypedArray(e)?s&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,n,i){let s=e;if(e&&!i&&"object"==typeof e)if(kO.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(kO.isArray(e)&&function(e){return kO.isArray(e)&&!e.some(EO)}(e)||(kO.isFileList(e)||kO.endsWith(n,"[]"))&&(s=kO.toArray(e)))return n=AO(n),s.forEach((function(e,r){!kO.isUndefined(e)&&null!==e&&t.append(!0===a?FO([n],r,o):null===a?n:n+"[]",u(e))})),!1;return!!EO(e)||(t.append(FO(i,n,o),u(e)),!1)}const c=[],p=Object.assign(OO,{defaultVisitor:l,convertValue:u,isVisitable:EO});if(!kO.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!kO.isUndefined(n)){if(-1!==c.indexOf(n))throw Error("Circular reference detected in "+r.join("."));c.push(n),kO.forEach(n,(function(n,o){!0===(!(kO.isUndefined(n)||null===n)&&i.call(t,n,kO.isString(o)?o.trim():o,r,p))&&e(n,r?r.concat(o):[o])})),c.pop()}}(e),t};function NO(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function DO(e,t){this._pairs=[],e&&RO(e,this,t)}const IO=DO.prototype;IO.append=function(e,t){this._pairs.push([e,t])},IO.toString=function(e){const t=e?function(t){return e.call(this,t,NO)}:NO;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const BO=DO;function LO(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function PO(e,t,n){if(!t)return e;const r=n&&n.encode||LO,i=n&&n.serialize;let o;if(o=i?i(t,n):kO.isURLSearchParams(t)?t.toString():new BO(t,n).toString(r),o){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}const $O=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){kO.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},zO={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},jO={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:BO,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},isStandardBrowserEnv:(()=>{let e;return("undefined"==typeof navigator||"ReactNative"!==(e=navigator.product)&&"NativeScript"!==e&&"NS"!==e)&&"undefined"!=typeof window&&"undefined"!=typeof document})(),isStandardBrowserWebWorkerEnv:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,protocols:["http","https","file","blob","url","data"]},GO=function(e){function t(e,n,r,i){let o=e[i++];const a=Number.isFinite(+o),s=i>=e.length;return o=!o&&kO.isArray(r)?r.length:o,s?(kO.hasOwnProp(r,o)?r[o]=[r[o],n]:r[o]=n,!a):(r[o]&&kO.isObject(r[o])||(r[o]=[]),t(e,n,r[o],i)&&kO.isArray(r[o])&&(r[o]=function(e){const t={},n=Object.keys(e);let r;const i=n.length;let o;for(r=0;r<i;r++)o=n[r],t[o]=e[o];return t}(r[o])),!a)}if(kO.isFormData(e)&&kO.isFunction(e.entries)){const n={};return kO.forEachEntry(e,((e,r)=>{t(function(e){return kO.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),r,n,0)})),n}return null},UO={"Content-Type":void 0},WO={transitional:zO,adapter:["xhr","http"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,i=kO.isObject(e);if(i&&kO.isHTMLForm(e)&&(e=new FormData(e)),kO.isFormData(e))return r&&r?JSON.stringify(GO(e)):e;if(kO.isArrayBuffer(e)||kO.isBuffer(e)||kO.isStream(e)||kO.isFile(e)||kO.isBlob(e))return e;if(kO.isArrayBufferView(e))return e.buffer;if(kO.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return RO(e,new jO.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return jO.isNode&&kO.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((o=kO.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return RO(o?{"files[]":e}:e,t&&new t,this.formSerializer)}}return i||r?(t.setContentType("application/json",!1),function(e,t,n){if(kO.isString(e))try{return(0,JSON.parse)(e),kO.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||WO.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(e&&kO.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw TO.from(e,TO.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:jO.classes.FormData,Blob:jO.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};kO.forEach(["delete","get","head"],(function(e){WO.headers[e]={}})),kO.forEach(["post","put","patch"],(function(e){WO.headers[e]=kO.merge(UO)}));const VO=WO,HO=kO.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),qO=Symbol("internals");function XO(e){return e&&String(e).trim().toLowerCase()}function YO(e){return!1===e||null==e?e:kO.isArray(e)?e.map(YO):String(e)}function KO(e,t,n,r,i){return kO.isFunction(r)?r.call(this,t,n):(i&&(t=n),kO.isString(t)?kO.isString(r)?-1!==t.indexOf(r):kO.isRegExp(r)?r.test(t):void 0:void 0)}class JO{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function i(e,t,n){const i=XO(t);if(!i)throw new Error("header name must be a non-empty string");const o=kO.findKey(r,i);(!o||void 0===r[o]||!0===n||void 0===n&&!1!==r[o])&&(r[o||t]=YO(e))}const o=(e,t)=>kO.forEach(e,((e,n)=>i(e,n,t)));return kO.isPlainObject(e)||e instanceof this.constructor?o(e,t):kO.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim())?o((e=>{const t={};let n,r,i;return e&&e.split("\n").forEach((function(e){i=e.indexOf(":"),n=e.substring(0,i).trim().toLowerCase(),r=e.substring(i+1).trim(),!n||t[n]&&HO[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)})),t})(e),t):null!=e&&i(t,e,n),this}get(e,t){if(e=XO(e)){const n=kO.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(kO.isFunction(t))return t.call(this,e,n);if(kO.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=XO(e)){const n=kO.findKey(this,e);return!(!n||void 0===this[n]||t&&!KO(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function i(e){if(e=XO(e)){const i=kO.findKey(n,e);!i||t&&!KO(0,n[i],i,t)||(delete n[i],r=!0)}}return kO.isArray(e)?e.forEach(i):i(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const i=t[n];e&&!KO(0,this[i],i,e,!0)||(delete this[i],r=!0)}return r}normalize(e){const t=this,n={};return kO.forEach(this,((r,i)=>{const o=kO.findKey(n,i);if(o)return t[o]=YO(r),void delete t[i];const a=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(i):String(i).trim();a!==i&&delete t[i],t[a]=YO(r),n[a]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return kO.forEach(this,((n,r)=>{null!=n&&!1!==n&&(t[r]=e&&kO.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach((e=>n.set(e))),n}static accessor(e){const t=(this[qO]=this[qO]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=XO(e);t[r]||(function(e,t){const n=kO.toCamelCase(" "+t);["get","set","has"].forEach((r=>{Object.defineProperty(e,r+n,{value:function(e,n,i){return this[r].call(this,t,e,n,i)},configurable:!0})}))}(n,e),t[r]=!0)}return kO.isArray(e)?e.forEach(r):r(e),this}}JO.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),kO.freezeMethods(JO.prototype),kO.freezeMethods(JO);const ZO=JO;function QO(e,t){const n=this||VO,r=t||n,i=ZO.from(r.headers);let o=r.data;return kO.forEach(e,(function(e){o=e.call(n,o,i.normalize(),t?t.status:void 0)})),i.normalize(),o}function eR(e){return!(!e||!e.__CANCEL__)}function tR(e,t,n){TO.call(this,null==e?"canceled":e,TO.ERR_CANCELED,t,n),this.name="CanceledError"}kO.inherits(tR,TO,{__CANCEL__:!0});const nR=tR,rR=jO.isStandardBrowserEnv?{write:function(e,t,n,r,i,o){const a=[];a.push(e+"="+encodeURIComponent(t)),kO.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),kO.isString(r)&&a.push("path="+r),kO.isString(i)&&a.push("domain="+i),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function iR(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const oR=jO.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let n;function r(n){let r=n;return e&&(t.setAttribute("href",r),r=t.href),t.setAttribute("href",r),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return n=r(window.location.href),function(e){const t=kO.isString(e)?r(e):e;return t.protocol===n.protocol&&t.host===n.host}}():function(){return!0};function aR(e,t){let n=0;const r=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i,o=0,a=0;return t=void 0!==t?t:1e3,function(s){const u=Date.now(),l=r[a];i||(i=u),n[o]=s,r[o]=u;let c=a,p=0;for(;c!==o;)p+=n[c++],c%=e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),u-i<t)return;const d=l&&u-l;return d?Math.round(1e3*p/d):void 0}}(50,250);return i=>{const o=i.loaded,a=i.lengthComputable?i.total:void 0,s=o-n,u=r(s);n=o;const l={loaded:o,total:a,progress:a?o/a:void 0,bytes:s,rate:u||void 0,estimated:u&&a&&o<=a?(a-o)/u:void 0,event:i};l[t?"download":"upload"]=!0,e(l)}}const sR={http:null,xhr:"undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){let r=e.data;const i=ZO.from(e.headers).normalize(),o=e.responseType;let a;function s(){e.cancelToken&&e.cancelToken.unsubscribe(a),e.signal&&e.signal.removeEventListener("abort",a)}kO.isFormData(r)&&(jO.isStandardBrowserEnv||jO.isStandardBrowserWebWorkerEnv?i.setContentType(!1):i.setContentType("multipart/form-data;",!1));let u=new XMLHttpRequest;if(e.auth){const t=e.auth.username||"",n=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.set("Authorization","Basic "+btoa(t+":"+n))}const l=iR(e.baseURL,e.url);function c(){if(!u)return;const r=ZO.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders());!function(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new TO("Request failed with status code "+n.status,[TO.ERR_BAD_REQUEST,TO.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}((function(e){t(e),s()}),(function(e){n(e),s()}),{data:o&&"text"!==o&&"json"!==o?u.response:u.responseText,status:u.status,statusText:u.statusText,headers:r,config:e,request:u}),u=null}if(u.open(e.method.toUpperCase(),PO(l,e.params,e.paramsSerializer),!0),u.timeout=e.timeout,"onloadend"in u?u.onloadend=c:u.onreadystatechange=function(){u&&4===u.readyState&&(0!==u.status||u.responseURL&&0===u.responseURL.indexOf("file:"))&&setTimeout(c)},u.onabort=function(){u&&(n(new TO("Request aborted",TO.ECONNABORTED,e,u)),u=null)},u.onerror=function(){n(new TO("Network Error",TO.ERR_NETWORK,e,u)),u=null},u.ontimeout=function(){let t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const r=e.transitional||zO;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(new TO(t,r.clarifyTimeoutError?TO.ETIMEDOUT:TO.ECONNABORTED,e,u)),u=null},jO.isStandardBrowserEnv){const t=(e.withCredentials||oR(l))&&e.xsrfCookieName&&rR.read(e.xsrfCookieName);t&&i.set(e.xsrfHeaderName,t)}void 0===r&&i.setContentType(null),"setRequestHeader"in u&&kO.forEach(i.toJSON(),(function(e,t){u.setRequestHeader(t,e)})),kO.isUndefined(e.withCredentials)||(u.withCredentials=!!e.withCredentials),o&&"json"!==o&&(u.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&u.addEventListener("progress",aR(e.onDownloadProgress,!0)),"function"==typeof e.onUploadProgress&&u.upload&&u.upload.addEventListener("progress",aR(e.onUploadProgress)),(e.cancelToken||e.signal)&&(a=t=>{u&&(n(!t||t.type?new nR(null,e,u):t),u.abort(),u=null)},e.cancelToken&&e.cancelToken.subscribe(a),e.signal&&(e.signal.aborted?a():e.signal.addEventListener("abort",a)));const p=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(l);p&&-1===jO.protocols.indexOf(p)?n(new TO("Unsupported protocol "+p+":",TO.ERR_BAD_REQUEST,e)):u.send(r||null)}))}};kO.forEach(sR,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));function uR(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new nR(null,e)}function lR(e){return uR(e),e.headers=ZO.from(e.headers),e.data=QO.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),(e=>{e=kO.isArray(e)?e:[e];const{length:t}=e;let n,r;for(let i=0;i<t&&(n=e[i],!(r=kO.isString(n)?sR[n.toLowerCase()]:n));i++);if(!r){if(!1===r)throw new TO(`Adapter ${n} is not supported by the environment`,"ERR_NOT_SUPPORT");throw new Error(kO.hasOwnProp(sR,n)?`Adapter '${n}' is not available in the build`:`Unknown adapter '${n}'`)}if(!kO.isFunction(r))throw new TypeError("adapter is not a function");return r})(e.adapter||VO.adapter)(e).then((function(t){return uR(e),t.data=QO.call(e,e.transformResponse,t),t.headers=ZO.from(t.headers),t}),(function(t){return eR(t)||(uR(e),t&&t.response&&(t.response.data=QO.call(e,e.transformResponse,t.response),t.response.headers=ZO.from(t.response.headers))),Promise.reject(t)}))}const cR=e=>e instanceof ZO?e.toJSON():e;function pR(e,t){t=t||{};const n={};function r(e,t,n){return kO.isPlainObject(e)&&kO.isPlainObject(t)?kO.merge.call({caseless:n},e,t):kO.isPlainObject(t)?kO.merge({},t):kO.isArray(t)?t.slice():t}function i(e,t,n){return kO.isUndefined(t)?kO.isUndefined(e)?void 0:r(void 0,e,n):r(e,t,n)}function o(e,t){if(!kO.isUndefined(t))return r(void 0,t)}function a(e,t){return kO.isUndefined(t)?kO.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function s(n,i,o){return o in t?r(n,i):o in e?r(void 0,n):void 0}const u={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:(e,t)=>i(cR(e),cR(t),!0)};return kO.forEach(Object.keys(Object.assign({},e,t)),(function(r){const o=u[r]||i,a=o(e[r],t[r],r);kO.isUndefined(a)&&o!==s||(n[r]=a)})),n}const dR={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{dR[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const hR={};dR.transitional=function(e,t,n){function r(e,t){return"[Axios v1.4.0] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,i,o)=>{if(!1===e)throw new TO(r(i," has been removed"+(t?" in "+t:"")),TO.ERR_DEPRECATED);return t&&!hR[i]&&(hR[i]=!0,console.warn(r(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,o)}};const fR={assertOptions:function(e,t,n){if("object"!=typeof e)throw new TO("options must be an object",TO.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const o=r[i],a=t[o];if(a){const t=e[o],n=void 0===t||a(t,o,e);if(!0!==n)throw new TO("option "+o+" must be "+n,TO.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new TO("Unknown option "+o,TO.ERR_BAD_OPTION)}},validators:dR},gR=fR.validators;class mR{constructor(e){this.defaults=e,this.interceptors={request:new $O,response:new $O}}request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=pR(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:i}=t;let o;void 0!==n&&fR.assertOptions(n,{silentJSONParsing:gR.transitional(gR.boolean),forcedJSONParsing:gR.transitional(gR.boolean),clarifyTimeoutError:gR.transitional(gR.boolean)},!1),null!=r&&(kO.isFunction(r)?t.paramsSerializer={serialize:r}:fR.assertOptions(r,{encode:gR.function,serialize:gR.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase(),o=i&&kO.merge(i.common,i[t.method]),o&&kO.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete i[e]})),t.headers=ZO.concat(o,i);const a=[];let s=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,a.unshift(e.fulfilled,e.rejected))}));const u=[];let l;this.interceptors.response.forEach((function(e){u.push(e.fulfilled,e.rejected)}));let c,p=0;if(!s){const e=[lR.bind(this),void 0];for(e.unshift.apply(e,a),e.push.apply(e,u),c=e.length,l=Promise.resolve(t);p<c;)l=l.then(e[p++],e[p++]);return l}c=a.length;let d=t;for(p=0;p<c;){const e=a[p++],t=a[p++];try{d=e(d)}catch(e){t.call(this,e);break}}try{l=lR.call(this,d)}catch(e){return Promise.reject(e)}for(p=0,c=u.length;p<c;)l=l.then(u[p++],u[p++]);return l}getUri(e){return PO(iR((e=pR(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}kO.forEach(["delete","get","head","options"],(function(e){mR.prototype[e]=function(t,n){return this.request(pR(n||{},{method:e,url:t,data:(n||{}).data}))}})),kO.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,i){return this.request(pR(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}mR.prototype[e]=t(),mR.prototype[e+"Form"]=t(!0)}));const yR=mR;class bR{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const r=new Promise((e=>{n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e,r,i){n.reason||(n.reason=new nR(e,r,i),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}static source(){let e;return{token:new bR((function(t){e=t})),cancel:e}}}const vR=bR,xR={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(xR).forEach((([e,t])=>{xR[t]=e}));const _R=xR,wR=function e(t){const n=new yR(t),r=UF(yR.prototype.request,n);return kO.extend(r,yR.prototype,n,{allOwnKeys:!0}),kO.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(pR(t,n))},r}(VO);wR.Axios=yR,wR.CanceledError=nR,wR.CancelToken=vR,wR.isCancel=eR,wR.VERSION="1.4.0",wR.toFormData=RO,wR.AxiosError=TO,wR.Cancel=wR.CanceledError,wR.all=function(e){return Promise.all(e)},wR.spread=function(e){return function(t){return e.apply(null,t)}},wR.isAxiosError=function(e){return kO.isObject(e)&&!0===e.isAxiosError},wR.mergeConfig=pR,wR.AxiosHeaders=ZO,wR.formToJSON=e=>GO(kO.isHTMLForm(e)?new FormData(e):e),wR.HttpStatusCode=_R,wR.default=wR;const kR=wR;function SR(e,t){return t?new Promise(((n,r)=>{e.then((e=>{t(e),n(e)})).catch((e=>{t(void 0,e),r(e)}))})):e}const CR=async(e,t,n)=>{const r=document.createElement("a");r.style.display="none",document.body.appendChild(r);const i=new Blob([e],{type:n});r.href=URL.createObjectURL(i),r.download=t,r.click()},MR=(e=0,t=1)=>Math.random()*(t-e)+e,TR=(e=0,t=1)=>{let n,r,i,o,a,s;if(s)n=r,s=!1;else{do{i=MR(0,2)-1,o=MR(0,2)-1,a=i*i+o*o}while(a>=1);a=Math.sqrt(-2*Math.log(a)/a),n=i*a,r=o*a,s=!0}return n*t+e};const ER=new class{constructor(e){this.options=e||{}}normalizeValue(e,t,n){return(e-t)/(n-t)}unnormalizeValue(e,t,n){return e*(n-t)+t}getMin(e){return e.reduce(((e,t)=>Math.min(e,t)))}getMax(e){return e.reduce(((e,t)=>Math.max(e,t)))}isJsonOrString(e){try{JSON.parse(e)}catch(e){return!1}return!0}zipArrays(e,t){return e.length!==t.length?(console.error("arrays do not have the same length"),[]):[...new Array(e.length).fill(null)].map(((n,r)=>({...e[r],...t[r]})))}createLabelsFromArrayValues(e,t){let n;return Array.isArray(e)&&(n=e.map(((e,n)=>`${t}_${n}`))),n}formatDataAsObject(e,t){let n={};if(Array.isArray(e))return e.forEach(((e,r)=>{const i=t[r];n[i]=e})),n;if("object"==typeof e)return n=e,n;throw new Error("input provided is not supported or does not match your output label specifications")}getDataType(e){let t=typeof e;return"object"===t&&Array.isArray(e)&&(t="array"),t}};var AR=__webpack_require__(8810);const FR=new class{constructor(){"undefined"!=typeof window&&(this.m_p5Instance=window)}setP5Instance(e){this.m_p5Instance=e}get p5Instance(){return void 0!==this.m_p5Instance&&"function"==typeof this.m_p5Instance.loadImage?this.m_p5Instance:void 0!==this.m_p5Instance.p5&&void 0!==this.m_p5Instance.p5.Image&&"function"==typeof this.m_p5Instance.p5.Image?this.m_p5Instance.p5:void 0}checkP5(){return!!this.p5Instance}getBlob(e){return new Promise(((t,n)=>{e.toBlob((e=>{e?t(e):n(new Error("Canvas could not be converted to Blob."))}))}))}loadAsync(e){return new Promise(((t,n)=>{this.p5Instance.loadImage(e,(e=>{t(e)}),(()=>{n(new Error(`Could not load image from url ${e}`))}))}))}async rawToBlob(e,t,n){const r=Array.from(e),i=document.createElement("canvas"),o=i.getContext("2d");i.width=t,i.height=n;const a=o.createImageData(t,n),{data:s}=a;for(let e=0;e<t*n*4;e+=1)s[e]=r[e];return o.putImageData(a,0,0),this.getBlob(i)}async ImageDataToBlob(e,t,n){const r=document.createElement("canvas"),i=r.getContext("2d");return r.width=t,r.height=n,i.putImageData(e,0,0),this.getBlob(r)}async blobToP5Image(e){return this.checkP5()&&"undefined"!=typeof URL?this.loadAsync(URL.createObjectURL(e)):null}};function OR(e){return $F(e)||PF(e)}async function RR(e,t){e&&(DF(e)||IF(e))?(t&&await O.nextFrame(),0===e.readyState&&await new Promise(((t,n)=>{e.addEventListener("error",(()=>n(e.error))),e.addEventListener("loadeddata",t)}))):e&&LF(e)&&(e.complete||await new Promise(((t,n)=>{e.addEventListener("error",n),e.addEventListener("load",t)})))}const NR={inputs:[],outputs:[],dataUrl:null,modelUrl:null,layers:[],task:null,debug:!1,learningRate:.2,hiddenUnits:16,neuroEvolution:!1};class DR{constructor(e,t){this.callback=t,"imageClassification"===e.task&&(NR.learningRate=.02),this.options={...NR,...e}||NR,this.neuralNetwork=new class{constructor(){this.isTrained=!1,this.isCompiled=!1,this.isLayered=!1,this.model=null,this.init=this.init.bind(this),this.createModel=this.createModel.bind(this),this.addLayer=this.addLayer.bind(this),this.compile=this.compile.bind(this),this.setOptimizerFunction=this.setOptimizerFunction.bind(this),this.train=this.train.bind(this),this.trainInternal=this.trainInternal.bind(this),this.predict=this.predict.bind(this),this.classify=this.classify.bind(this),this.save=this.save.bind(this),this.load=this.load.bind(this),this.init()}init(){this.createModel()}createModel(e="sequential"){return e.toLowerCase(),this.model=Ga(),this.model}addLayer(e){const t=e||{};this.model.add(t),this.model.layers.length>=2&&(this.isLayered=!0)}compile(e){this.model.compile(e),this.isCompiled=!0}setOptimizerFunction(e,t){return t.call(this,e)}train(e,t){return SR(this.trainInternal(e),t)}async trainInternal(e){const t=e,n=t.inputs,r=t.outputs,{batchSize:i,epochs:o,shuffle:a,validationSplit:s,whileTraining:u}=t;await this.model.fit(n,r,{batchSize:i,epochs:o,shuffle:a,validationSplit:s,callbacks:u}),n.dispose(),r.dispose(),this.isTrained=!0}predictSync(e){const t=O.tidy((()=>this.model.predict(e))),n=t.arraySync();return t.dispose(),e.dispose(),n}async predict(e){const t=O.tidy((()=>this.model.predict(e))),n=await t.array();return t.dispose(),e.dispose(),n}async classify(e){return this.predict(e)}classifySync(e){return this.predictSync(e)}async save(e,t){const{string:n,callback:r}=GF(e,t),i=n||"model";this.model.save(O.io.withSaveHandler((async e=>{this.weightsManifest={modelTopology:e.modelTopology,weightsManifest:[{paths:[`./${i}.weights.bin`],weights:e.weightSpecs}]},await CR(e.weightData,`${i}.weights.bin`,"application/octet-stream"),await CR(JSON.stringify(this.weightsManifest),`${i}.json`,"text/plain"),r&&r()})))}async load(e=null,t){if(e instanceof FileList){const t=await Promise.all(Array.from(e).map((async e=>e.name.includes(".json")&&!e.name.includes("_meta")?{name:"model",file:e}:e.name.includes(".json")&&e.name.includes("_meta.json")?{name:"metadata",file:await e.text()}:e.name.includes(".bin")?{name:"weights",file:e}:{name:null,file:null}))),n=t.find((e=>"model"===e.name)).file,r=t.find((e=>"weights"===e.name)).file;this.model=await $a(O.io.browserFiles([n,r]))}else if(e instanceof Object){const t=await kR.get(e.model,{responseType:"text"}),n=JSON.stringify(t.data),r=new File([n],"model.json",{type:"application/json"}),i=(await kR.get(e.weights,{responseType:"blob"})).data,o=new File([i],"model.weights.bin",{type:"application/macbinary"});this.model=await $a(O.io.browserFiles([r,o]))}else this.model=await $a(e);return this.isCompiled=!0,this.isLayered=!0,this.isTrained=!0,t&&t(),this.model}dispose(){this.model.dispose()}mutate(e=.1,t){O.tidy((()=>{const n=this.model.getWeights(),r=[];for(let i=0;i<n.length;i+=1){const o=n[i],{shape:a}=n[i],s=o.dataSync().slice();for(let n=0;n<s.length;n+=1)Math.random()<e&&(s[n]=t?t(s[n]):Math.min(Math.max(s[n]+TR(),-1),1));const u=O.tensor(s,a);r[i]=u}this.model.setWeights(r)}))}crossover(e){return O.tidy((()=>{const t=this.model.getWeights(),n=e.model.getWeights(),r=[];for(let e=0;e<t.length;e+=1){const i=t[e],o=n[e],{shape:a}=t[e],s=i.dataSync().slice(),u=o.dataSync().slice();for(let e=0;e<s.length;e+=1)Math.random()<.5&&(s[e]=u[e]);const l=O.tensor(s,a);r[e]=l}this.model.setWeights(r)}))}},this.neuralNetworkData=new class{constructor(){this.meta={inputUnits:null,outputUnits:null,inputs:{},outputs:{},isNormalized:!1},this.isMetadataReady=!1,this.isWarmedUp=!1,this.data={raw:[]},this.createMetadata=this.createMetadata.bind(this),this.getDataStats=this.getDataStats.bind(this),this.getInputMetaStats=this.getInputMetaStats.bind(this),this.getDataUnits=this.getDataUnits.bind(this),this.getInputMetaUnits=this.getInputMetaUnits.bind(this),this.getDTypesFromData=this.getDTypesFromData.bind(this),this.addData=this.addData.bind(this),this.convertRawToTensors=this.convertRawToTensors.bind(this),this.normalizeDataRaw=this.normalizeDataRaw.bind(this),this.normalizeInputData=this.normalizeInputData.bind(this),this.normalizeArray=this.normalizeArray.bind(this),this.unnormalizeArray=this.unnormalizeArray.bind(this),this.applyOneHotEncodingsToDataRaw=this.applyOneHotEncodingsToDataRaw.bind(this),this.getDataOneHot=this.getDataOneHot.bind(this),this.getInputMetaOneHot=this.getInputMetaOneHot.bind(this),this.createOneHotEncodings=this.createOneHotEncodings.bind(this),this.loadDataFromUrl=this.loadDataFromUrl.bind(this),this.loadJSON=this.loadJSON.bind(this),this.loadCSV=this.loadCSV.bind(this),this.loadBlob=this.loadBlob.bind(this),this.loadData=this.loadData.bind(this),this.saveData=this.saveData.bind(this),this.saveMeta=this.saveMeta.bind(this),this.loadMeta=this.loadMeta.bind(this),this.findEntries=this.findEntries.bind(this),this.formatRawData=this.formatRawData.bind(this),this.csvToJSON=this.csvToJSON.bind(this)}createMetadata(e,t=null){return this.getDTypesFromData(e),this.getDataStats(e),this.getDataOneHot(e),this.getDataUnits(e,t),this.isMetadataReady=!0,{...this.meta}}getDataStats(e){const t=Object.assign({},this.meta),n=this.getInputMetaStats(e,t.inputs,"xs"),r=this.getInputMetaStats(e,t.outputs,"ys");return t.inputs=n,t.outputs=r,this.meta={...this.meta,...t},t}getInputMetaStats(e,t,n){const r=Object.assign({},t);return Object.keys(r).forEach((t=>{if("string"===r[t].dtype)r[t].min=0,r[t].max=1;else if("number"===r[t].dtype){const i=e.map((e=>e[n][t]));r[t].min=ER.getMin(i),r[t].max=ER.getMax(i)}else if("array"===r[t].dtype){const i=e.map((e=>e[n][t])).flat();r[t].min=ER.getMin(i),r[t].max=ER.getMax(i)}})),r}getDataUnits(e,t=null){const n=null!==t?t:void 0,r=Object.assign({},this.meta);let i;i=n||[this.getInputMetaUnits(e,r.inputs)].flat();const o=this.getInputMetaUnits(e,r.outputs);return r.inputUnits=i,r.outputUnits=o,this.meta={...this.meta,...r},r}getInputMetaUnits(e,t){let n=0;const r=Object.assign({},t);return Object.entries(r).forEach((e=>{const{dtype:t}=e[1];if("number"===t)n+=1;else if("string"===t){const{uniqueValues:t}=e[1],r=t.length;n+=r}else"array"===t&&(n=[])})),n}getDTypesFromData(e){const t={...this.meta,inputs:{},outputs:{}},n=e[0],r=Object.keys(n.xs),i=Object.keys(n.ys);return r.forEach((e=>{t.inputs[e]={dtype:ER.getDataType(n.xs[e])}})),i.forEach((e=>{t.outputs[e]={dtype:ER.getDataType(n.ys[e])}})),this.meta=t,t}addData(e,t){this.data.raw.push({xs:e,ys:t})}convertRawToTensors(e){const t=Object.assign({},this.meta),n=e.length;return O.tidy((()=>{const r=[],i=[];return e.forEach((e=>{const n=Object.keys(t.inputs).map((t=>e.xs[t])).flat();r.push(n);const o=Object.keys(t.outputs).map((t=>e.ys[t])).flat();i.push(o)})),{inputs:O.tensor(r.flat(),[n,...t.inputUnits]),outputs:O.tensor(i.flat(),[n,t.outputUnits])}}))}normalizeDataRaw(e){const t=Object.assign({},this.meta),n=this.normalizeInputData(e,t.inputs,"xs"),r=this.normalizeInputData(e,t.outputs,"ys");return ER.zipArrays(n,r)}normalizeInputData(e,t,n){const r=e.length,i=Object.assign({},t),o={};return Object.keys(i).forEach((t=>{const r={min:i[t].min,max:i[t].max},a=e.map((e=>e[n][t]));"string"===i[t].dtype?(r.legend=i[t].legend,o[t]=this.normalizeArray(a,r)):"number"===i[t].dtype?o[t]=this.normalizeArray(a,r):"array"===i[t].dtype&&(o[t]=a.map((e=>this.normalizeArray(e,r))))})),[...new Array(r).fill(null)].map(((e,t)=>{const r={[n]:{}};return Object.keys(i).forEach((e=>{r[n][e]=o[e][t]})),r}))}normalizeArray(e,t){const{min:n,max:r}=t;if(t.legend)return e.map((e=>t.legend[e]?t.legend[e]:e));if(e.every((e=>"number"==typeof e)))return e.map((e=>ER.normalizeValue(e,n,r)));throw new Error("error in inputArray of normalizeArray() function")}unnormalizeArray(e,t){const{min:n,max:r}=t;if(t.legend)return e.map((e=>{let n;return Object.entries(t.legend).forEach((t=>{const r=t[0],i=t[1];e.map(((e,t)=>e===i[t])).every((e=>!0===e))&&(n=r)})),n}));if(e.every((e=>"number"==typeof e)))return e.map((e=>ER.unnormalizeValue(e,n,r)));throw new Error("error in inputArray of normalizeArray() function")}applyOneHotEncodingsToDataRaw(e){const t=Object.assign({},this.meta);return e.map((e=>{const n={...e.xs},r={...e.ys};return Object.keys(t.inputs).forEach((r=>{t.inputs[r].legend&&(n[r]=t.inputs[r].legend[e.xs[r]])})),Object.keys(t.outputs).forEach((n=>{t.outputs[n].legend&&(r[n]=t.outputs[n].legend[e.ys[n]])})),{xs:n,ys:r}}))}getDataOneHot(e){const t=Object.assign({},this.meta),n=this.getInputMetaOneHot(e,t.inputs,"xs"),r=this.getInputMetaOneHot(e,t.outputs,"ys");return t.inputs=n,t.outputs=r,this.meta={...this.meta,...t},t}getInputMetaOneHot(e,t,n){const r=Object.assign({},t);return Object.entries(r).forEach((t=>{const i=t[0],{dtype:o}=t[1];if("string"===o){const t=[...new Set(e.map((e=>e[n][i])))],o=this.createOneHotEncodings(t);r[i]={...r[i],...o}}})),r}createOneHotEncodings(e){return O.tidy((()=>{const t={uniqueValues:e,legend:{}},n=e,r=n.map(((e,t)=>t)),i=O.oneHot(O.tensor1d(r,"int32"),n.length).arraySync();return n.forEach(((e,n)=>{t.legend[e]=i[n]})),t}))}async loadDataFromUrl(e,t,n){try{let r;if(e.endsWith(".csv"))r=await this.loadCSV(e,t,n);else if(e.endsWith(".json"))r=await this.loadJSON(e,t,n);else{if(!e.includes("blob"))throw new Error("Not a valid data format. Must be csv or json");r=await this.loadBlob(e,t,n)}return r}catch(e){throw console.error(e),new Error(e)}}async loadJSON(e,t,n){try{let r;if(e instanceof Object)r=Object.assign({},e);else{const{data:t}=await kR.get(e);r=t}return this.formatRawData(r,t,n)}catch(e){throw console.error("error loading json"),new Error(e)}}async loadCSV(e,t,n){try{const r=xh(e),i={entries:await r.toArray()};return this.formatRawData(i,t,n)}catch(e){throw console.error("error loading csv",e),new Error(e)}}async loadBlob(e,t,n){try{const{data:r}=await kR.get(e),i=r;let o;if(ER.isJsonOrString(i)){const e=JSON.parse(i);o=await this.loadJSON(e,t,n)}else{const e=this.csvToJSON(i);o=await this.loadJSON(e,t,n)}return o}catch(e){throw console.log("mmm might be passing in a string or something!",e),new Error(e)}}async loadData(e=null,t){try{let n;if("string"!=typeof e){const t=e[0];if((new FileReader).readAsText(t),t.name.includes(".json")){const e=await t.text();n=JSON.parse(e)}else console.log('data must be a json object containing an array called "data" or "entries')}else{n=await kR.get(e,{responseType:"text"});const t=JSON.stringify(n.data);ER.isJsonOrString(t)?n=JSON.parse(t):console.log("Whoops! something went wrong. Either this kind of data is not supported yet or there is an issue with .loadData")}this.data.raw=this.findEntries(n),!this.data.raw.length>0&&console.log('data must be a json object containing an array called "data" '),t&&t()}catch(e){throw new Error(e)}}async saveData(e){const t=new Date;let n=`${String(t.getFullYear())}-${String(t.getMonth()+1)}-${String(t.getDate())}_${String(t.getHours())}-${String(t.getMinutes())}-${String(t.getSeconds())}`;e&&(n=e);const r={data:this.data.raw};await CR(JSON.stringify(r),`${n}.json`,"text/plain")}async saveMeta(e,t){const{string:n,callback:r}=GF(e,t),i=n||"model";await CR(JSON.stringify(this.meta),`${i}_meta.json`,"text/plain"),r&&r()}async loadMeta(e=null,t){if(e instanceof FileList){const t=await Promise.all(Array.from(e).map((async e=>e.name.includes(".json")&&!e.name.includes("_meta")?{name:"model",file:e}:e.name.includes(".json")&&e.name.includes("_meta.json")?{name:"metadata",file:await e.text()}:e.name.includes(".bin")?{name:"weights",file:e}:{name:null,file:null}))),n=JSON.parse(t.find((e=>"metadata"===e.name)).file);this.meta=n}else if(e instanceof Object){let t=await kR.get(e.metadata,{responseType:"text"});t=JSON.stringify(t.data),t=JSON.parse(t),this.meta=t}else{const t=`${e.substring(0,e.lastIndexOf("/"))}/model_meta.json`;let n=await kR.get(t);n=n.data,this.meta=n}return this.isMetadataReady=!0,this.isWarmedUp=!0,t&&t(),this.meta}formatRawData(e,t,n){const r=this.findEntries(e);!r.length>0&&console.log("your data must be contained in an array in \n\n        a property called 'entries' or 'data' of your json object");const i=r.map(((e,r)=>{const i={xs:{},ys:{}};return t.forEach((t=>{void 0!==e[t]?i.xs[t]=e[t]:console.error(`the input label ${t} does not exist at row ${r}`)})),n.forEach((t=>{void 0!==e[t]?i.ys[t]=e[t]:console.error(`the output label ${t} does not exist at row ${r}`)})),i}));return this.data.raw=i,i}csvToJSON(e){const t=e.split("\n"),n=[],r=t[0].split(",");for(let e=1;e<t.length;e+=1){const i={},o=t[e].split(",");r.forEach(((e,t)=>{i[e]=o[t]})),n.push(i)}return{entries:n}}findEntries(e){const t=Object.assign({},e);return t.entries&&t.entries instanceof Array?t.entries:t.data&&t.data instanceof Array?t.data:(Object.keys(t).forEach((e=>{if("object"==typeof t[e])return this.findEntries(t[e])})),t)}getData(){return this.data.raw}},this.neuralNetworkVis=new class{constructor(){this.config={height:300}}modelSummary(e,t){const n={...e};AR.show.modelSummary(n,t)}scatterplot(e,t,n){const r=n.map((n=>({x:n.xs[e],y:n.ys[t]}))),i={xLabel:"X",yLabel:"Y",height:this.config.height};AR.render.scatterplot({name:"debug mode"},r,i)}scatterplotAll(e,t,n){let r=[];e.forEach((e=>{t.forEach((t=>{const i=n.map((n=>({x:n.xs[e],y:n.ys[t]})));r=[...r,...i]}))}));const i={xLabel:"X",yLabel:"Y",height:this.config.height};AR.render.scatterplot({name:"debug mode"},r,i)}barchart(e,t,n){const r=n.map((n=>({value:n.xs[e],index:n.ys[t]}))),i={xLabel:"label",yLabel:"value",height:this.config.height};console.log(i),AR.render.barchart({name:"Bar chart"},r)}trainingVis(){return AR.show.fitCallbacks({name:"Training Performance"},["loss","accuracy"],{height:this.config.height,callbacks:["onEpochEnd"]})}},this.data={training:[]},this.ready=!1,this.init=this.init.bind(this),this.addData=this.addData.bind(this),this.loadDataFromUrl=this.loadDataFromUrl.bind(this),this.loadDataInternal=this.loadDataInternal.bind(this),this.createMetaData=this.createMetaData.bind(this),this.prepareForTraining=this.prepareForTraining.bind(this),this.normalizeData=this.normalizeData.bind(this),this.normalizeInput=this.normalizeInput.bind(this),this.searchAndFormat=this.searchAndFormat.bind(this),this.formatInputItem=this.formatInputItem.bind(this),this.convertTrainingDataToTensors=this.convertTrainingDataToTensors.bind(this),this.formatInputsForPrediction=this.formatInputsForPrediction.bind(this),this.formatInputsForPredictionAll=this.formatInputsForPredictionAll.bind(this),this.isOneHotEncodedOrNormalized=this.isOneHotEncodedOrNormalized.bind(this),this.train=this.train.bind(this),this.trainInternal=this.trainInternal.bind(this),this.addLayer=this.addLayer.bind(this),this.createNetworkLayers=this.createNetworkLayers.bind(this),this.addDefaultLayers=this.addDefaultLayers.bind(this),this.compile=this.compile.bind(this),this.predict=this.predict.bind(this),this.predictMultiple=this.predictMultiple.bind(this),this.classify=this.classify.bind(this),this.classifyMultiple=this.classifyMultiple.bind(this),this.predictInternal=this.predictInternal.bind(this),this.classifyInternal=this.classifyInternal.bind(this),this.saveData=this.saveData.bind(this),this.loadData=this.loadData.bind(this),this.save=this.save.bind(this),this.load=this.load.bind(this),this.dispose=this.dispose.bind(this),this.mutate=this.mutate.bind(this),this.crossover=this.crossover.bind(this),this.init(this.callback)}init(e){!0===this.options.neuroEvolution&&this.createLayersNoTraining(),null!==this.options.dataUrl?this.ready=this.loadDataFromUrl(this.options,e):null!==this.options.modelUrl?this.ready=this.load(this.options.modelUrl,e):this.ready=!0}createLayersNoTraining(){const{inputs:e,outputs:t,task:n}=this.options;if("classification"===n)for(let n=0;n<t.length;n+=1){const r=new Array(e).fill(0);this.addData(r,[t[n]])}else{const n=new Array(e).fill(0),r=new Array(t).fill(0);this.addData(n,r)}this.neuralNetworkData.createMetadata(this.neuralNetworkData.data.raw),this.addDefaultLayers(this.options.task,this.neuralNetworkData.meta)}copy(){const e=new DR(this.options);return O.tidy((()=>{const t=this.neuralNetwork.model.getWeights(),n=[];for(let e=0;e<t.length;e+=1)n[e]=t[e].clone();return e.neuralNetwork.model.setWeights(n),e}))}addData(e,t,n=null){const{inputs:r,outputs:i}=this.options;let o,a;if(null!==n?(o=n.inputLabels,a=n.outputLabels):r.length>0&&i.length>0?(r.every((e=>"string"==typeof e))&&(o=r),i.every((e=>"string"==typeof e))&&(a=i)):"object"==typeof e&&"object"==typeof t?(o=Object.keys(e),a=Object.keys(t)):(o=ER.createLabelsFromArrayValues(e,"input"),a=ER.createLabelsFromArrayValues(t,"output")),!(o instanceof Array))throw new Error("inputLabels must be an array");if(!(a instanceof Array))throw new Error("outputLabels must be an array");const s=this.searchAndFormat(e),u=ER.formatDataAsObject(s,o),l=ER.formatDataAsObject(t,a);this.neuralNetworkData.addData(u,l)}loadDataFromUrl(e,t){return SR(this.loadDataInternal(e),t)}async loadDataInternal(e){const{dataUrl:t,inputs:n,outputs:r}=e,i=await this.neuralNetworkData.loadDataFromUrl(t,n,r);this.createMetadata(i),this.prepareForTraining(i)}createMetaData(e){const{inputs:t}=this.options;let n;Array.isArray(t)&&t.length>0&&(n=t.every((e=>"number"==typeof e))&&t.length>0?t:null),this.neuralNetworkData.createMetadata(e,n)}prepareForTraining(e=null){const t=null===e?this.neuralNetworkData.data.raw:e,n=this.neuralNetworkData.applyOneHotEncodingsToDataRaw(t);return this.data.training=n,this.neuralNetworkData.isWarmedUp=!0,n}normalizeData(e=null){const t=null===e?this.neuralNetworkData.data.raw:e;this.neuralNetworkData.isMetadataReady||this.createMetaData(t),this.neuralNetworkData.isWarmedUp||this.prepareForTraining(t);const n=this.neuralNetworkData.normalizeDataRaw(t);return this.data.training=n,this.neuralNetworkData.meta.isNormalized=!0,n}normalizeInput(e,t,n){const r=t,{min:i,max:o}=n[r];return ER.normalizeValue(e,i,o)}searchAndFormat(e){let t;if(Array.isArray(e))t=e.map((e=>this.formatInputItem(e)));else if("object"==typeof e){const n=Object.assign({},e);Object.keys(e).forEach((t=>{const r=e[t];n[t]=this.formatInputItem(r)})),t=n}return t}formatInputItem(e){let t,n;return OR(e)?t=e:"object"==typeof e&&OR(e.elt)?t=e.elt:"object"==typeof e&&OR(e.canvas)&&(t=e.canvas),n=t?function(e){const t=(e=>{const t=PF(e)?e:zF(e);if(BF(t))return t;if(!t)throw new Error("Invalid image. Image must be one of: HTMLCanvasElement, HTMLImageElement, HTMLVideoElement, ImageData, p5.Image, p5.Graphics, or p5.Video.");const n=t.videoWidth||t.width,r=t.videoHeight||t.height,i=document.createElement("canvas");i.width=n,i.height=r;const o=i.getContext("2d");return PF(e)?o.putImageData(e,0,0):o.drawImage(t,0,0,n,r),i})(e),n=t.getContext("2d").getImageData(0,0,t.width,t.height);return Array.from(n.data)}(t):e,n}convertTrainingDataToTensors(e=null,t=null){const n=null===e?this.data.training:e,r=null===t?this.neuralNetworkData.meta:t;return this.neuralNetworkData.convertRawToTensors(n,r)}formatInputsForPrediction(e,t,n){let r=[];return e instanceof Array?r=n.map(((n,r)=>this.isOneHotEncodedOrNormalized(e[r],n,t.inputs))):e instanceof Object&&(r=n.map((n=>this.isOneHotEncodedOrNormalized(e[n],n,t.inputs)))),r=r.flat(),r}formatInputsForPredictionAll(e,t,n){let r;return e instanceof Array&&e.every((e=>Array.isArray(e)))?(r=e.map((e=>this.formatInputsForPrediction(e,t,n))),O.tensor(r,[e.length,n.length])):(r=this.formatInputsForPrediction(e,t,n),O.tensor([r]))}isOneHotEncodedOrNormalized(e,t,n){const r=e,i=t;let o;return"number"!=typeof e?o=n[i].legend[r]:(o=e,this.neuralNetworkData.meta.isNormalized&&(o=this.normalizeInput(e,i,n))),o}train(e,t,n){let r,i,o;"object"==typeof e&&"function"==typeof t&&"function"==typeof n?(r=e,i=t,o=n):"object"==typeof e&&"function"==typeof t?(r=e,i=null,o=t):"function"==typeof e&&"function"==typeof t?(r={},i=e,o=t):(r={},i=null,o=e),this.trainInternal(r,i,o)}trainInternal(e,t,n){const r={epochs:10,batchSize:32,validationSplit:.1,whileTraining:null,...e};if(!0===this.options.debug||"true"===this.options.debug?r.whileTraining=[this.neuralNetworkVis.trainingVis(),{onEpochEnd:t}]:r.whileTraining=[{onEpochEnd:t}],this.neuralNetworkData.isMetadataReady||this.createMetaData(this.neuralNetworkData.data.raw),this.neuralNetworkData.isWarmedUp||this.prepareForTraining(this.neuralNetworkData.data.raw),!r.inputs&&!r.outputs){const{inputs:e,outputs:t}=this.convertTrainingDataToTensors();r.inputs=e,r.outputs=t}this.neuralNetwork.isLayered||(this.options.layers=this.createNetworkLayers(this.options.layers,this.neuralNetworkData.meta)),this.neuralNetwork.isLayered||(this.options.layers=this.addDefaultLayers(this.options.task,this.neuralNetworkData.meta)),this.neuralNetwork.isCompiled||this.compile(),this.neuralNetwork.train(r,n)}addLayer(e){this.neuralNetwork.addLayer(e)}createNetworkLayers(e,t){const r=[...e],{inputUnits:i,outputUnits:o}=Object.assign({},t),a=r.length;if(!(r.length>=2))return!1;r[0].inputShape=r[0].inputShape?r[0].inputShape:i;const s=r[a-1];return s.units=s.units?s.units:o,r.forEach((e=>{this.addLayer(n[e.type](e))})),r}addDefaultLayers(e,t){let n;switch(e.toLowerCase()){case"classification":return n=[{type:"dense",units:this.options.hiddenUnits,activation:"relu"},{type:"dense",activation:"softmax"}],this.createNetworkLayers(n,t);case"regression":return n=[{type:"dense",units:this.options.hiddenUnits,activation:"relu"},{type:"dense",activation:"sigmoid"}],this.createNetworkLayers(n,t);case"imageclassification":return n=[{type:"conv2d",filters:8,kernelSize:5,strides:1,activation:"relu",kernelInitializer:"varianceScaling"},{type:"maxPooling2d",poolSize:[2,2],strides:[2,2]},{type:"conv2d",filters:16,kernelSize:5,strides:1,activation:"relu",kernelInitializer:"varianceScaling"},{type:"maxPooling2d",poolSize:[2,2],strides:[2,2]},{type:"flatten"},{type:"dense",kernelInitializer:"varianceScaling",activation:"softmax"}],this.createNetworkLayers(n,t);default:return console.log("no imputUnits or outputUnits defined"),n=[{type:"dense",units:this.options.hiddenUnits,activation:"relu"},{type:"dense",activation:"sigmoid"}],this.createNetworkLayers(n,t)}}compile(e=null,t=null){const n=null===t?this.options.learningRate:t;let r={};null!==e?r={...e}:"classification"===this.options.task||"imageClassification"===this.options.task?r={loss:"categoricalCrossentropy",optimizer:O.train.sgd,metrics:["accuracy"]}:"regression"===this.options.task&&(r={loss:"meanSquaredError",optimizer:O.train.adam,metrics:["accuracy"]}),r.optimizer=r.optimizer?this.neuralNetwork.setOptimizerFunction(n,r.optimizer):this.neuralNetwork.setOptimizerFunction(n,O.train.sgd),this.neuralNetwork.compile(r),this.options.debug&&this.neuralNetworkVis.modelSummary({name:"Model Summary"},this.neuralNetwork.model)}predictSync(e){return this.predictSyncInternal(e)}predict(e,t){return SR(this.predictInternal(e),t)}predictMultiple(e,t){return SR(this.predictInternal(e),t)}classifySync(e){return this.classifySyncInternal(e)}classify(e,t){return SR(this.classifyInternal(e),t)}classifyMultiple(e,t){return SR(this.classifyInternal(e),t)}predictSyncInternal(e){const{meta:t}=this.neuralNetworkData,n=Object.keys(t.inputs),r=this.formatInputsForPredictionAll(e,t,n),i=this.neuralNetwork.predictSync(r);if(r.dispose(),null!==t){const e=Object.keys(t.outputs),n=i.map((n=>e.map(((r,i)=>{let o,a;if(t.isNormalized){const{min:e,max:s}=t.outputs[r];o=ER.unnormalizeValue(n[i],e,s),a=n[i]}else o=n[i];const s={[e[i]]:o,label:r,value:o};return a&&(s.unNormalizedValue=a),s}))));return n.length<2?n[0]:n}return i}async predictInternal(e){const{meta:t}=this.neuralNetworkData,n=Object.keys(t.inputs),r=this.formatInputsForPredictionAll(e,t,n),i=await this.neuralNetwork.predict(r);if(r.dispose(),null!==t){const e=Object.keys(t.outputs),n=i.map((n=>e.map(((r,i)=>{let o,a;if(t.isNormalized){const{min:e,max:s}=t.outputs[r];o=ER.unnormalizeValue(n[i],e,s),a=n[i]}else o=n[i];const s={[e[i]]:o,label:r,value:o};return a&&(s.unNormalizedValue=a),s}))));return n.length<2?n[0]:n}return i}classifySyncInternal(e){const{meta:t}=this.neuralNetworkData,n=Object.keys(t.inputs);let r;if("imageClassification"===this.options.task){if(r=this.searchAndFormat(e),r=Array.isArray(r)?r.flat():r[n[0]],t.isNormalized){const{min:e,max:i}=t.inputs[n[0]];r=this.neuralNetworkData.normalizeArray(Array.from(r),{min:e,max:i})}else r=Array.from(r);r=O.tensor([r],[1,...t.inputUnits])}else r=this.formatInputsForPredictionAll(e,t,n);const i=this.neuralNetwork.classifySync(r);if(r.dispose(),null!==t){const e=Object.keys(t.outputs)[0],n=Object.entries(t.outputs[e].legend),r=i.map((e=>n.map(((t,n)=>({[t[0]]:e[n],label:t[0],confidence:e[n]}))).sort(((e,t)=>t.confidence-e.confidence))));return r.length<2?r[0]:r}return i}async classifyInternal(e){const{meta:t}=this.neuralNetworkData,n=Object.keys(t.inputs);let r;if("imageClassification"===this.options.task){if(r=this.searchAndFormat(e),r=Array.isArray(r)?r.flat():r[n[0]],t.isNormalized){const{min:e,max:i}=t.inputs[n[0]];r=this.neuralNetworkData.normalizeArray(Array.from(r),{min:e,max:i})}else r=Array.from(r);r=O.tensor([r],[1,...t.inputUnits])}else r=this.formatInputsForPredictionAll(e,t,n);const i=await this.neuralNetwork.classify(r);if(r.dispose(),null!==t){const e=Object.keys(t.outputs)[0],n=Object.entries(t.outputs[e].legend),r=i.map((e=>n.map(((t,n)=>({[t[0]]:e[n],label:t[0],confidence:e[n]}))).sort(((e,t)=>t.confidence-e.confidence))));return r.length<2?r[0]:r}return i}saveData(e){this.neuralNetworkData.saveData(e)}async loadData(e=null,t){this.neuralNetworkData.loadData(e,t)}save(e,t){const{string:n,callback:r}=GF(e,t),i=n||"model";this.neuralNetwork.save(i,(()=>{this.neuralNetworkData.saveMeta(i,r)}))}async load(e=null,t){let n;t&&(n=t),this.neuralNetwork.load(e,(()=>(this.neuralNetworkData.loadMeta(e,n),this.neuralNetwork.model)))}dispose(){this.neuralNetwork.dispose()}mutate(e,t){this.neuralNetwork.mutate(e,t)}crossover(e){const t=this.copy();return t.neuralNetwork.crossover(e.neuralNetwork),t}}var IR=__webpack_require__(7187),BR=__webpack_require__.n(IR),LR=__webpack_require__(203);class PR{setAlpha(e){(e<=0||e>1)&&console.log("alpha should be in (0.0., 1.0]"),this.a=e}constructor(e,t=0){this.y=this.s=t,this.setAlpha(e),this.initialized=!1}filter(e){var t;return this.initialized?t=this.a*e+(1-this.a)*this.s:(t=e,this.initialized=!0),this.y=e,this.s=t,t}filterWithAlpha(e,t){return this.setAlpha(t),this.filter(e)}hasLastRawValue(){return this.initialized}lastRawValue(){return this.y}lastFilteredValue(){return this.s}reset(){this.initialized=!1}}class $R{alpha(e){var t=1/this.freq;return 1/(1+1/(2*Math.PI*e)/t)}setFrequency(e){e<=0&&console.log("freq should be >0"),this.freq=e}setMinCutoff(e){e<=0&&console.log("mincutoff should be >0"),this.mincutoff=e}setBeta(e){this.beta_=e}setDerivateCutoff(e){e<=0&&console.log("dcutoff should be >0"),this.dcutoff=e}constructor(e,t=1,n=0,r=1){this.setFrequency(e),this.setMinCutoff(t),this.setBeta(n),this.setDerivateCutoff(r),this.x=new PR(this.alpha(t)),this.dx=new PR(this.alpha(r)),this.lasttime=void 0}reset(){this.x.reset(),this.dx.reset(),this.lasttime=void 0}filter(e,t=void 0){null!=this.lasttime&&null!=t&&(this.freq=1/(t-this.lasttime)),this.lasttime=t;var n=this.x.hasLastRawValue()?(e-this.x.lastFilteredValue())*this.freq:0,r=this.dx.filterWithAlpha(n,this.alpha(this.dcutoff)),i=this.mincutoff+this.beta_*Math.abs(r);return this.x.filterWithAlpha(e,this.alpha(i))}}class zR extends(BR()){constructor(e,t,n){super(),this.video=e,this.model=null,this.modelReady=!1,this.config=t,this.poseLandmarker,this.lastVideoTime=-1,this.result=[],this.POSE_CONNECTIONS=LR.qe.POSE_CONNECTIONS,this.ready=SR(this.loadModel(),n),this.filterX=[],this.filterY=[],this.filter=t.filter??!0;let r=t.cutoff??12,i=t.beta??.03;for(let e=0;e<this.config.numPoses;e++){let e=[],t=[];for(let n=0;n<33;n++)e.push(new $R(120,r,i,1)),t.push(new $R(120,r,i,1));this.filterX.push(e),this.filterY.push(t)}}async loadModel(){const e=await LR.n.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.4/wasm"),t={baseOptions:{modelAssetPath:"https://storage.googleapis.com/mediapipe-models/pose_landmarker/pose_landmarker_full/float16/1/pose_landmarker_full.task",delegate:"GPU"},runningMode:"VIDEO",minPoseDetectionConfidence:this.config.minPoseDetectionConfidence??.5,minPosePresenceConfidence:this.config.minPosePresenceConfidence??.5,minTrackingConfidence:this.config.minTrackingConfidence??.5,numPoses:this.config.numPoses??1,outputSegmentationMasks:this.config.outputSegmentationMasks??!1};switch(this.config.modelType){case"full":default:t.baseOptions.modelAssetPath="https://storage.googleapis.com/mediapipe-models/pose_landmarker/pose_landmarker_full/float16/1/pose_landmarker_full.task";break;case"lite":t.baseOptions.modelAssetPath="https://storage.googleapis.com/mediapipe-models/pose_landmarker/pose_landmarker_lite/float16/1/pose_landmarker_lite.task"}return this.poseLandmarker=await LR.qe.createFromOptions(e,t),this.modelReady=!0,this.video&&this.predict(),this}async predict(e,t){const{image:n,callback:r}=GF(this.video,e,t);if(!n)throw new Error("No input image found.");await RR(n,!1);let i=performance.now();return n.currentTime!==this.lastVideoTime&&(this.poseLandmarker.detectForVideo(n,i,(e=>{if(this.filter){let t=[];for(let n=0;n<e.landmarks.length;n++){let r=[];for(let t=0;t<33;t++){let i=this.filterX[n][t].filter(e.landmarks[n][t].x),o=this.filterY[n][t].filter(e.landmarks[n][t].y);r.push({x:i,y:o})}t.push(r)}this.result=t}else this.result=e.landmarks})),this.lastVideoTime=n.currentTime),this.emit("pose",this.result),this.video?O.nextFrame().then((()=>this.predict())):("function"==typeof r&&r(this.result),this.result)}}var jR=__webpack_require__(513),GR=function(e,t){return GR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},GR(e,t)};function UR(e,t){function n(){this.constructor=e}GR(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var WR=function(){return WR=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},WR.apply(this,arguments)};function VR(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function HR(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function qR(e){return e instanceof SVGAnimatedLength?e.baseVal.value:e}function XR(e){return VR(this,void 0,void 0,(function(){var t,n;return HR(this,(function(r){switch(r.label){case 0:return t=document.createElement("canvas"),e instanceof O.Tensor?[4,O.browser.toPixels(e,t)]:[3,2];case 1:return r.sent(),[3,3];case 2:t.width=qR(e.width),t.height=qR(e.height),n=t.getContext("2d"),e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0),r.label=3;case 3:return[2,t]}}))}))}function YR(e){return VR(this,void 0,void 0,(function(){var t,n,r,i,o,a;return HR(this,(function(s){switch(s.label){case 0:return e instanceof O.Tensor?(t=e.shape.slice(0,2),n=t[0],r=t[1],i=ImageData.bind,[4,O.browser.toPixels(e)]):[3,2];case 1:return[2,new(i.apply(ImageData,[void 0,s.sent(),r,n]))];case 2:return o=document.createElement("canvas"),a=o.getContext("2d"),o.width=qR(e.width),o.height=qR(e.height),a.drawImage(e,0,0),[2,a.getImageData(0,0,o.width,o.height)]}}))}))}function KR(e){return VR(this,void 0,void 0,(function(){var t,n;return HR(this,(function(r){switch(r.label){case 0:return e instanceof SVGImageElement||e instanceof OffscreenCanvas?[4,XR(e)]:[3,2];case 1:return n=r.sent(),[3,3];case 2:n=e,r.label=3;case 3:return t=n,[2,O.browser.fromPixels(t,4)]}}))}))}function JR(e){if(e<0||e>=256)throw new Error("Mask value must be in range [0, 255] but got "+e);if(!Number.isInteger(e))throw new Error("Mask value must be an integer but got "+e)}var ZR=[[110,64,170],[143,61,178],[178,60,178],[210,62,167],[238,67,149],[255,78,125],[255,94,99],[255,115,75],[255,140,56],[239,167,47],[217,194,49],[194,219,64],[175,240,91],[135,245,87],[96,247,96],[64,243,115],[40,234,141],[28,219,169],[26,199,194],[33,176,213],[47,150,224],[65,125,224],[84,101,214],[99,81,195]];function QR(e){if(JR(e),e<ZR.length){var t=ZR[e];return{r:t[0],g:t[1],b:t[2],a:255}}throw new Error("Mask value must be in range [0, "+ZR.length+")")}function eN(e){var t=e.shape[2],n=(0,O.argMax)(e,2),r=(0,O.reshape)(n,[-1]);return(0,O.oneHot)(r,t)}function tN(e,t){return(0,O.tidy)((function(){return(0,O.cast)((0,O.greater)(e,(0,O.scalar)(t)),"int32")}))}function nN(e,t){var n=t.shape,r=n[0],i=n[1],o=n[2];return(0,O.tidy)((function(){var n=eN(t),a=(0,O.expandDims)((0,O.range)(0,o,1,"int32"),1),s=(0,O.cast)((0,O.matMul)(n,a),"int32"),u=(0,O.reshape)(s,[r,i]),l=(0,O.add)(u,(0,O.scalar)(1,"int32"));return(0,O.sub)(function(e,t){return(0,O.mul)(e,t)}(l,e),(0,O.scalar)(1,"int32"))}))}var rN=function(){function e(e,t){this.model=e,this.outputStride=t;var n=this.model.inputs[0].shape;O.util.assert(-1===n[1]&&-1===n[2],(function(){return"Input shape ["+n[1]+", "+n[2]+"] must both be equal to or -1"}))}return e.prototype.predict=function(e){var t=this;return(0,O.tidy)((function(){var n=t.preprocessInput((0,O.cast)(e,"float32")),r=(0,O.expandDims)(n,0),i=t.model.predict(r).map((function(e){return(0,O.squeeze)(e,[0])})),o=t.nameOutputResults(i);return{heatmapScores:(0,O.sigmoid)(o.heatmap),offsets:o.offsets,displacementFwd:o.displacementFwd,displacementBwd:o.displacementBwd,segmentation:o.segmentation,partHeatmaps:o.partHeatmaps,longOffsets:o.longOffsets,partOffsets:o.partOffsets}}))},e.prototype.dispose=function(){this.model.dispose()},e}(),iN=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return UR(t,e),t.prototype.preprocessInput=function(e){return(0,O.tidy)((function(){return(0,O.sub)((0,O.div)(e,127.5),1)}))},t.prototype.nameOutputResults=function(e){return{offsets:e[0],segmentation:e[1],partHeatmaps:e[2],longOffsets:e[3],heatmap:e[4],displacementFwd:e[5],displacementBwd:e[6],partOffsets:e[7]}},t}(rN),oN=["nose","leftEye","rightEye","leftEar","rightEar","leftShoulder","rightShoulder","leftElbow","rightElbow","leftWrist","rightWrist","leftHip","rightHip","leftKnee","rightKnee","leftAnkle","rightAnkle"],aN=oN.length,sN=oN.reduce((function(e,t,n){return e[t]=n,e}),{});function uN(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1],s=n.top,u=n.bottom;return[a/(n.left+n.right+i),o/(s+u+r)]}function lN(e,t,n,r){return{y:r.get(e,t,n),x:r.get(e,t,n+aN)}}function cN(e,t,n){var r=lN(e.heatmapY,e.heatmapX,e.id,n),i=r.y,o=r.x;return{x:e.heatmapX*t+o,y:e.heatmapY*t+i}}function pN(e,t,n){return e<t?t:e>n?n:e}function dN(e,t){return{x:e.x+t.x,y:e.y+t.y}}function hN(e,t,n){void 0===n&&(n=.3);for(var r=0,i=0,o=0;o<e.length;o++)t.keypoints[o].score>n&&(i+=1,r+=Math.pow(e[o].x-t.keypoints[o].position.x,2)+Math.pow(e[o].y-t.keypoints[o].position.y,2));return 0===i?r=1/0:r/=i,r}function fN(e,t,n,r,i,o,a){for(var s=a[0],u=a[1],l=n(e),c=l.y*r+l.x,p=i[aN*(2*c)+t],d=i[aN*(2*c+1)+t],h=e.y+p,f=e.x+d,g=0;g<o;g++){h=Math.min(h,s-1);var m=n({x:f=Math.min(f,u-1),y:h}),y=m.y*r+m.x;h+=p=i[aN*(2*y)+t],f+=d=i[aN*(2*y+1)+t]}return{x:f,y:h}}function gN(e,t,n,r,i,o,a,s,u,l){for(var c=i[0],p=i[1],d=o[0],h=o[1],f=s[0],g=s[1],m=[],y=function(e){return function(e,t,n,r){var i=t[0],o=t[1],a=n[0],s=n[1],u=Math.round(((i+e.y+1)*s-1)/r);return{x:Math.round(((o+e.x+1)*a-1)/r),y:u}}(e,[c,p],[d,h],u)},b=0;b<r;b++){var v=fN(e,b,y,a,t,l,[f,g]);m.push(v)}for(var x=-1,_=1/0,w=0;w<n.length;w++){var k=hN(m,n[w]);k<_&&(x=w,_=k)}return x}function mN(e,t){var n=e[0],r=e[1];return[Math.round((r-1)/t+1),Math.round((n-1)/t+1)]}function yN(e,t,n,r,i,o,a,s,u,l,c){for(var p=a[0],d=a[1],h=e.shape,f=h[0],g=h[1],m=t.shape.slice(0,2),y=m[0],b=m[1],v=(0,O.reshape)(t,[y,b,2,aN]),x=new Float32Array(c*aN*3).fill(0),_=0;_<n.length;_++)for(var w=_*aN*3,k=n[_],S=0;S<aN;S++){var C=k.keypoints[S],M=w+3*S;x[M]=C.score,x[M+1]=C.position.y,x[M+2]=C.position.x}var T=uN([r,i],[p,d],s),E=T[0],A=T[1],F=(0,O.tensor)(x,[c,aN,3]),R=s.top,N=s.left,D={variableNames:["segmentation","longOffsets","poses"],outputShape:[f,g],userCode:"\n    int convertToPositionInOutput(int pos, int pad, float scale, int stride) {\n      return round(((float(pos + pad) + 1.0) * scale - 1.0) / float(stride));\n    }\n\n    float convertToPositionInOutputFloat(\n        int pos, int pad, float scale, int stride) {\n      return ((float(pos + pad) + 1.0) * scale - 1.0) / float(stride);\n    }\n\n    float dist(float x1, float y1, float x2, float y2) {\n      return pow(x1 - x2, 2.0) + pow(y1 - y2, 2.0);\n    }\n\n    float sampleLongOffsets(float h, float w, int d, int k) {\n      float fh = fract(h);\n      float fw = fract(w);\n      int clH = int(ceil(h));\n      int clW = int(ceil(w));\n      int flH = int(floor(h));\n      int flW = int(floor(w));\n      float o11 = getLongOffsets(flH, flW, d, k);\n      float o12 = getLongOffsets(flH, clW, d, k);\n      float o21 = getLongOffsets(clH, flW, d, k);\n      float o22 = getLongOffsets(clH, clW, d, k);\n      float o1 = mix(o11, o12, fw);\n      float o2 = mix(o21, o22, fw);\n      return mix(o1, o2, fh);\n    }\n\n    int findNearestPose(int h, int w) {\n      float prob = getSegmentation(h, w);\n      if (prob < 1.0) {\n        return -1;\n      }\n\n      // Done(Tyler): convert from output space h/w to strided space.\n      float stridedH = convertToPositionInOutputFloat(\n        h, "+R+", "+A+", "+o+");\n      float stridedW = convertToPositionInOutputFloat(\n        w, "+N+", "+E+", "+o+");\n\n      float minDist = 1000000.0;\n      int iMin = -1;\n      for (int i = 0; i < "+c+"; i++) {\n        float curDistSum = 0.0;\n        int numKpt = 0;\n        for (int k = 0; k < "+aN+"; k++) {\n          float dy = sampleLongOffsets(stridedH, stridedW, 0, k);\n          float dx = sampleLongOffsets(stridedH, stridedW, 1, k);\n\n          float y = float(h) + dy;\n          float x = float(w) + dx;\n\n          for (int s = 0; s < "+u+"; s++) {\n            int yRounded = round(min(y, float("+(r-1)+")));\n            int xRounded = round(min(x, float("+(i-1)+")));\n\n            float yStrided = convertToPositionInOutputFloat(\n              yRounded, "+R+", "+A+", "+o+");\n            float xStrided = convertToPositionInOutputFloat(\n              xRounded, "+N+", "+E+", "+o+");\n\n            float dy = sampleLongOffsets(yStrided, xStrided, 0, k);\n            float dx = sampleLongOffsets(yStrided, xStrided, 1, k);\n\n            y = y + dy;\n            x = x + dx;\n          }\n\n          float poseScore = getPoses(i, k, 0);\n          float poseY = getPoses(i, k, 1);\n          float poseX = getPoses(i, k, 2);\n          if (poseScore > "+l+") {\n            numKpt = numKpt + 1;\n            curDistSum = curDistSum + dist(x, y, poseX, poseY);\n          }\n        }\n        if (numKpt > 0 && curDistSum / float(numKpt) < minDist) {\n          minDist = curDistSum / float(numKpt);\n          iMin = i;\n        }\n      }\n      return iMin;\n    }\n\n    void main() {\n        ivec2 coords = getOutputCoords();\n        int nearestPose = findNearestPose(coords[0], coords[1]);\n        setOutput(float(nearestPose));\n      }\n  "};return(0,O.backend)().compileAndRun(D,[e,v,F])}function bN(){return"webgl"===(0,O.getBackend)()}function vN(e,t,n,r,i,o,a,s,u,l,c,p){var d=a[0],h=a[1];return void 0===u&&(u=.2),void 0===l&&(l=8),void 0===c&&(c=.3),void 0===p&&(p=10),VR(this,void 0,void 0,(function(){var a,f,g,m,y;return HR(this,(function(b){switch(b.label){case 0:return a=n.filter((function(e){return e.score>=u})),bN()?(g=(0,O.tidy)((function(){var n=yN(e,t,a,r,i,o,[d,h],s,l,c,p),u=(0,O.engine)().makeTensorFromDataId(n.dataId,n.shape,n.dtype);return a.map((function(e,t){return function(e,t){return(0,O.tidy)((function(){return(0,O.cast)((0,O.equal)(e,(0,O.scalar)(t)),"int32")}))}(u,t)}))})),[4,Promise.all(g.map((function(e){return e.data()})))]):[3,2];case 1:return f=b.sent(),g.forEach((function(e){return e.dispose()})),[3,5];case 2:return[4,e.data()];case 3:return m=b.sent(),[4,t.data()];case 4:y=b.sent(),f=function(e,t,n,r,i,o,a,s,u,l){var c=a[0],p=a[1];void 0===l&&(l=5);for(var d=n.map((function(e){return new Uint8Array(r*i).fill(0)})),h=s.top,f=s.left,g=uN([r,i],[c,p],s),m=g[0],y=g[1],b=mN([c,p],o)[0],v=0;v<r;v+=1)for(var x=0;x<i;x+=1){var _=v*i+x;if(1===e[_]){var w=gN({x,y:v},t,n,l,[h,f],[m,y],b,[r,i],o,u);w>=0&&(d[w][_]=1)}}return d}(m,y,a,r,i,o,[d,h],s,l),b.label=5;case 5:return[2,f.map((function(e,t){return{data:e,pose:a[t],width:i,height:r}}))]}}))}))}function xN(e,t,n,r,i,o,a,s,u,l,c,p,d){var h=s[0],f=s[1];return void 0===l&&(l=.2),void 0===c&&(c=8),void 0===p&&(p=.3),void 0===d&&(d=10),VR(this,void 0,void 0,(function(){var s,g,m,y,b,v;return HR(this,(function(x){switch(x.label){case 0:return s=r.filter((function(e){return e.score>=l})),bN()?(m=(0,O.tidy)((function(){var r=yN(e,t,s,i,o,a,[h,f],u,c,p,d),l=(0,O.engine)().makeTensorFromDataId(r.dataId,r.shape,r.dtype);return s.map((function(e,t){return function(e,t,n){return(0,O.tidy)((function(){return(0,O.sub)((0,O.mul)((0,O.cast)((0,O.equal)(e,(0,O.scalar)(n)),"int32"),(0,O.add)(t,1)),1)}))}(l,n,t)}))})),[4,Promise.all(m.map((function(e){return e.data()})))]):[3,2];case 1:return g=x.sent(),m.forEach((function(e){return e.dispose()})),[3,6];case 2:return[4,e.data()];case 3:return y=x.sent(),[4,t.data()];case 4:return b=x.sent(),[4,n.data()];case 5:v=x.sent(),g=function(e,t,n,r,i,o,a,s,u,l,c){var p=s[0],d=s[1];void 0===c&&(c=5);for(var h=r.map((function(e){return new Int32Array(i*o).fill(-1)})),f=u.top,g=u.left,m=uN([i,o],[p,d],u),y=m[0],b=m[1],v=mN([p,d],a)[0],x=0;x<i;x+=1)for(var _=0;_<o;_+=1){var w=x*o+_;if(1===e[w]){var k=gN({x:_,y:x},t,r,c,[f,g],[y,b],v,[i,o],a,l);k>=0&&(h[k][w]=n[w])}}return h}(y,b,v,s,i,o,a,[h,f],u,c),x.label=6;case 6:return[2,g.map((function(e,t){return{pose:s[t],data:e,height:i,width:o}}))]}}))}))}function _N(e){return Math.floor(e/2)}[["leftHip","leftShoulder"],["leftElbow","leftShoulder"],["leftElbow","leftWrist"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["rightHip","rightShoulder"],["rightElbow","rightShoulder"],["rightElbow","rightWrist"],["rightHip","rightKnee"],["rightKnee","rightAnkle"],["leftShoulder","rightShoulder"],["leftHip","rightHip"]].map((function(e){var t=e[0],n=e[1];return[sN[t],sN[n]]}));var wN=function(){function e(e,t){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=t}return e.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},e.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},e.prototype.empty=function(){return-1===this.numberOfElements},e.prototype.size=function(){return this.numberOfElements+1},e.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},e.prototype.max=function(){return this.priorityQueue[0]},e.prototype.swim=function(e){for(;e>0&&this.less(_N(e),e);)this.exchange(e,_N(e)),e=_N(e)},e.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var t=2*e;if(t<this.numberOfElements&&this.less(t,t+1)&&t++,!this.less(e,t))break;this.exchange(e,t),e=t}},e.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},e.prototype.less=function(e,t){return this.getValueAt(e)<this.getValueAt(t)},e.prototype.exchange=function(e,t){var n=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[t],this.priorityQueue[t]=n},e}();function kN(e,t,n,r,i,o){for(var a=o.shape,s=a[0],u=a[1],l=!0,c=Math.max(n-i,0),p=Math.min(n+i+1,s),d=c;d<p;++d){for(var h=Math.max(r-i,0),f=Math.min(r+i+1,u),g=h;g<f;++g)if(o.get(d,g,e)>t){l=!1;break}if(!l)break}return l}var SN=[["nose","leftEye"],["leftEye","leftEar"],["nose","rightEye"],["rightEye","rightEar"],["nose","leftShoulder"],["leftShoulder","leftElbow"],["leftElbow","leftWrist"],["leftShoulder","leftHip"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["nose","rightShoulder"],["rightShoulder","rightElbow"],["rightElbow","rightWrist"],["rightShoulder","rightHip"],["rightHip","rightKnee"],["rightKnee","rightAnkle"]].map((function(e){var t=e[0],n=e[1];return[sN[t],sN[n]]})),CN=SN.map((function(e){return e[1]})),MN=SN.map((function(e){return e[0]}));function TN(e,t,n,r){return{y:pN(Math.round(e.y/t),0,n-1),x:pN(Math.round(e.x/t),0,r-1)}}function EN(e,t,n,r,i,o,a,s){void 0===s&&(s=2);for(var u=r.shape,l=u[0],c=u[1],p=function(e,t,n){var r=n.shape[2]/2;return{y:n.get(t.y,t.x,e),x:n.get(t.y,t.x,r+e)}}(e,TN(t.position,o,l,c),a),d=dN(t.position,p),h=0;h<s;h++){var f=TN(d,o,l,c),g=lN(f.y,f.x,n,i);d=dN({x:f.x*o,y:f.y*o},{x:g.x,y:g.y})}var m=TN(d,o,l,c),y=r.get(m.y,m.x,n);return{position:d,part:oN[n],score:y}}function AN(e,t,n,r,i,o){var a=t.shape[2],s=CN.length,u=new Array(a),l=e.part,c=e.score,p=cN(l,r,n);u[l.id]={score:c,part:oN[l.id],position:p};for(var d=s-1;d>=0;--d){var h=CN[d],f=MN[d];u[h]&&!u[f]&&(u[f]=EN(d,u[h],f,t,n,r,o))}for(d=0;d<s;++d)h=MN[d],f=CN[d],u[h]&&!u[f]&&(u[f]=EN(d,u[h],f,t,n,r,i));return u}function FN(e,t,n,r){var i=n.x,o=n.y;return e.some((function(e){var n,a,s,u,l=e.keypoints[r].position;return n=o,a=i,(s=l.y-n)*s+(u=l.x-a)*u<=t}))}function ON(e,t,n){var r=n.reduce((function(n,r,i){var o=r.position,a=r.score;return FN(e,t,o,i)||(n+=a),n}),0);return r/n.length}function RN(e,t,n,r,i,o,a,s){void 0===a&&(a=.5),void 0===s&&(s=20);for(var u=[],l=function(e,t,n){for(var r=n.shape,i=r[0],o=r[1],a=r[2],s=new wN(i*o*a,(function(e){return e.score})),u=0;u<i;++u)for(var l=0;l<o;++l)for(var c=0;c<a;++c){var p=n.get(u,l,c);p<e||kN(c,p,u,l,1,n)&&s.enqueue({score:p,part:{heatmapY:u,heatmapX:l,id:c}})}return s}(a,0,e),c=s*s;u.length<o&&!l.empty();){var p=l.dequeue();if(!FN(u,c,cN(p.part,i,t),p.part.id)){var d=AN(p,e,t,i,n,r),h=ON(u,c,d);u.push({keypoints:d,score:h})}}return u}var NN,DN=[-123.15,-115.9,-103.06],IN=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return UR(t,e),t.prototype.preprocessInput=function(e){return(0,O.add)(e,DN)},t.prototype.nameOutputResults=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5];return{offsets:o,segmentation:e[6],partHeatmaps:a,longOffsets:i,heatmap:r,displacementFwd:n,displacementBwd:t,partOffsets:e[7]}},t}(rN),BN="https://storage.googleapis.com/tfjs-models/savedmodel/bodypix/resnet50/",LN="https://storage.googleapis.com/tfjs-models/savedmodel/bodypix/mobilenet/";function PN(e){if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas||"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)return function(e){if("offsetHeight"in e&&0!==e.offsetHeight&&"offsetWidth"in e&&0!==e.offsetWidth)return[e.offsetHeight,e.offsetWidth];if(null!=e.height&&null!=e.width)return[e.height,e.width];throw new Error("HTMLImageElement must have height and width attributes set.")}(e);if("undefined"!=typeof ImageData&&e instanceof ImageData)return[e.height,e.width];if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)return function(e){return e.hasAttribute("height")&&e.hasAttribute("width")?[e.height,e.width]:[e.videoHeight,e.videoWidth]}(e);if(e instanceof O.Tensor)return[e.shape[0],e.shape[1]];throw new Error("error: Unknown input type: "+e+".")}function $N(e,t){return function(e,t){return(e-1)%t==0}(e,t)?e:Math.floor(e/t)*t+1}var zN={low:"low",medium:"medium",high:"high",full:"full"},jN=((NN={})[zN.low]=.25,NN[zN.medium]=.5,NN[zN.high]=.75,NN[zN.full]=1,NN);function GN(e,t,n){var r=n[0],i=n[1],o=function(e){if("string"==typeof e){var t=jN[e];return O.util.assert("number"==typeof t,(function(){return"string value of inputResolution must be one of "+Object.values(zN).join(",")+" but was "+e+"."})),t}return O.util.assert("number"==typeof e&&e<=2&&e>=.1,(function(){return"inputResolution must be a string or number between 0.1 and 2, but was "+e})),e}(e);return[$N(r*o,t),$N(i*o,t)]}function UN(e,t,n,r,i){var o=t[0],a=t[1],s=n[0],u=n[1],l=r[0],c=l[0],p=l[1],d=r[1],h=d[0],f=d[1];return void 0===i&&(i=!1),(0,O.tidy)((function(){var t=O.image.resizeBilinear(e,[s,u],!0);return i&&(t=(0,O.sigmoid)(t)),function(e,t,n){var r=t[0],i=t[1],o=n[0],a=o[0],s=o[1],u=n[1],l=u[0],c=u[1];return(0,O.tidy)((function(){var t=(0,O.expandDims)(e);return(0,O.squeeze)(O.image.cropAndResize(t,[[a/(r+a+s-1),l/(i+l+c-1),(a+r-1)/(r+a+s-1),(l+i-1)/(i+l+c-1)]],[0],[r,i]),[0])}))}(t,[o,a],[[c,p],[h,f]])}))}function WN(e,t){var n=t[0],r=t[1],i=PN(e),o=i[0],a=i[1],s=r/n,u=[0,0,0,0],l=u[0],c=u[1],p=u[2],d=u[3];a/o<s?(l=0,c=0,p=Math.round(.5*(s*o-a)),d=Math.round(.5*(s*o-a))):(l=Math.round(.5*(1/s*a-o)),c=Math.round(.5*(1/s*a-o)),p=0,d=0);var h=(0,O.tidy)((function(){var t=function(e){return e instanceof O.Tensor?e:O.browser.fromPixels(e)}(e);return t=(0,O.pad3d)(t,[[l,c],[p,d],[0,0]]),O.image.resizeBilinear(t,[n,r])}));return{resized:h,padding:{top:l,left:p,right:d,bottom:c}}}function VN(e){return VR(this,void 0,void 0,(function(){return HR(this,(function(t){return[2,Promise.all(e.map((function(e){return e.buffer()})))]}))}))}function HN(e,t,n,r,i){var o=t[0],a=t[1],s=n[0],u=n[1],l=function(e,t,n,r,i){return void 0===r&&(r=0),void 0===i&&(i=0),1===n&&1===t&&0===r&&0===i?e:e.map((function(e){return function(e,t,n,r,i){return void 0===r&&(r=0),void 0===i&&(i=0),{score:e.score,keypoints:e.keypoints.map((function(e){var o=e.score,a=e.part,s=e.position;return{score:o,part:a,position:{x:s.x*n+i,y:s.y*t+r}}}))}}(e,t,n,r,i)}))}(e,(o+r.top+r.bottom)/s,(a+r.left+r.right)/u,-r.top,-r.left);return i?function(e,t){return t<=0?e:e.map((function(e){return function(e,t){return{score:e.score,keypoints:e.keypoints.map((function(e){var n=e.score,r=e.part,i=e.position;return{score:n,part:r,position:{x:t-1-i.x,y:i.y}}}))}}(e,t)}))}(l,a):l}var qN={architecture:"MobileNetV1",outputStride:16,quantBytes:4,multiplier:.75},XN=["MobileNetV1","ResNet50"],YN={MobileNetV1:[8,16,32],ResNet50:[32,16]},KN={MobileNetV1:[.5,.75,1],ResNet50:[1]},JN=[1,2,4],ZN={flipHorizontal:!1,internalResolution:"medium",segmentationThreshold:.7,maxDetections:10,scoreThreshold:.4,nmsRadius:20},QN={flipHorizontal:!1,internalResolution:"medium",segmentationThreshold:.7,maxDetections:10,scoreThreshold:.4,nmsRadius:20,minKeypointScore:.3,refineSteps:10};function eD(e){var t=e.segmentationThreshold,n=e.maxDetections,r=e.scoreThreshold,i=e.nmsRadius;if(t<0||t>1)throw new Error("segmentationThreshold "+t+". Should be in range [0.0, 1.0]");if(n<=0)throw new Error("Invalid maxDetections "+n+". Should be > 0");if(r<0||r>1)throw new Error("Invalid scoreThreshold "+r+". Should be in range [0.0, 1.0]");if(i<=0)throw new Error("Invalid nmsRadius "+i+".")}function tD(e){var t=e.segmentationThreshold,n=e.maxDetections,r=e.scoreThreshold,i=e.nmsRadius,o=e.minKeypointScore,a=e.refineSteps;if(t<0||t>1)throw new Error("segmentationThreshold "+t+". Should be in range [0.0, 1.0]");if(n<=0)throw new Error("Invalid maxDetections "+n+". Should be > 0");if(r<0||r>1)throw new Error("Invalid scoreThreshold "+r+". Should be in range [0.0, 1.0]");if(i<=0)throw new Error("Invalid nmsRadius "+i+".");if(o<0||o>1)throw new Error("Invalid minKeypointScore "+o+".Should be in range [0.0, 1.0]");if(a<=0||a>20)throw new Error("Invalid refineSteps "+a+".Should be in range [1, 20]")}var nD=function(){function e(e){this.baseModel=e}return e.prototype.predictForPersonSegmentation=function(e){var t=this.baseModel.predict(e);return{segmentLogits:t.segmentation,heatmapScores:t.heatmapScores,offsets:t.offsets,displacementFwd:t.displacementFwd,displacementBwd:t.displacementBwd}},e.prototype.predictForPersonSegmentationAndPart=function(e){var t=this.baseModel.predict(e);return{segmentLogits:t.segmentation,partHeatmapLogits:t.partHeatmaps,heatmapScores:t.heatmapScores,offsets:t.offsets,displacementFwd:t.displacementFwd,displacementBwd:t.displacementBwd}},e.prototype.predictForMultiPersonInstanceSegmentationAndPart=function(e){var t=this.baseModel.predict(e);return{segmentLogits:t.segmentation,longOffsets:t.longOffsets,heatmapScores:t.heatmapScores,offsets:t.offsets,displacementFwd:t.displacementFwd,displacementBwd:t.displacementBwd,partHeatmaps:t.partHeatmaps}},e.prototype.segmentPersonActivation=function(e,t,n){var r=this;void 0===n&&(n=.5);var i=PN(e),o=i[0],a=i[1],s=GN(t,this.baseModel.outputStride,[o,a]),u=WN(e,s),l=u.resized,c=u.padding,p=(0,O.tidy)((function(){var e=r.predictForPersonSegmentation(l),t=e.segmentLogits,i=e.heatmapScores,s=e.offsets,u=e.displacementFwd,p=e.displacementBwd,d=l.shape,h=d[0],f=d[1],g=UN(t,[o,a],[h,f],[[c.top,c.bottom],[c.left,c.right]],!0);return{segmentation:tN((0,O.squeeze)(g),n),heatmapScores:i,offsets:s,displacementFwd:u,displacementBwd:p}})),d=p.segmentation,h=p.heatmapScores,f=p.offsets,g=p.displacementFwd,m=p.displacementBwd;return l.dispose(),{segmentation:d,heatmapScores:h,offsets:f,displacementFwd:g,displacementBwd:m,padding:c,internalResolutionHeightAndWidth:s}},e.prototype.segmentPerson=function(e,t){return void 0===t&&(t=ZN),VR(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,l,c,p,d,h,f,g,m,y,b,v;return HR(this,(function(x){switch(x.label){case 0:return eD(t=WR(WR({},ZN),t)),n=this.segmentPersonActivation(e,t.internalResolution,t.segmentationThreshold),r=n.segmentation,i=n.heatmapScores,o=n.offsets,a=n.displacementFwd,s=n.displacementBwd,u=n.padding,l=n.internalResolutionHeightAndWidth,c=r.shape,p=c[0],d=c[1],[4,r.data()];case 1:return h=x.sent(),r.dispose(),[4,VN([i,o,a,s])];case 2:return f=x.sent(),g=f[0],m=f[1],y=f[2],b=f[3],v=HN(v=RN(g,m,y,b,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[p,d],l,u,!1),i.dispose(),o.dispose(),a.dispose(),s.dispose(),[2,{height:p,width:d,data:h,allPoses:v}]}}))}))},e.prototype.segmentMultiPerson=function(e,t){return void 0===t&&(t=QN),VR(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,l,c,p,d,h,f,g,m,y,b,v,x,_,w,k=this;return HR(this,(function(S){switch(S.label){case 0:return tD(t=WR(WR({},QN),t)),n=PN(e),r=n[0],i=n[1],o=GN(t.internalResolution,this.baseModel.outputStride,[r,i]),a=WN(e,o),s=a.resized,u=a.padding,l=(0,O.tidy)((function(){var e,n=k.predictForMultiPersonInstanceSegmentationAndPart(s),a=n.segmentLogits,l=n.longOffsets,c=n.heatmapScores,p=n.offsets,d=n.displacementFwd,h=n.displacementBwd,f=UN(a,[r,i],o,[[u.top,u.bottom],[u.left,u.right]],!0);return e=l,{segmentation:tN((0,O.squeeze)(f),t.segmentationThreshold),longOffsets:e,heatmapScoresRaw:c,offsetsRaw:p,displacementFwdRaw:d,displacementBwdRaw:h}})),c=l.segmentation,p=l.longOffsets,d=l.heatmapScoresRaw,h=l.offsetsRaw,f=l.displacementFwdRaw,g=l.displacementBwdRaw,[4,VN([d,h,f,g])];case 1:return m=S.sent(),y=m[0],b=m[1],v=m[2],x=m[3],_=HN(_=RN(y,b,v,x,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[r,i],o,u,!1),[4,vN(c,p,_,r,i,this.baseModel.outputStride,o,u,t.scoreThreshold,t.refineSteps,t.minKeypointScore,t.maxDetections)];case 2:return w=S.sent(),s.dispose(),c.dispose(),p.dispose(),d.dispose(),h.dispose(),f.dispose(),g.dispose(),[2,w]}}))}))},e.prototype.segmentPersonPartsActivation=function(e,t,n){var r=this;void 0===n&&(n=.5);var i=PN(e),o=i[0],a=i[1],s=GN(t,this.baseModel.outputStride,[o,a]),u=WN(e,s),l=u.resized,c=u.padding,p=(0,O.tidy)((function(){var e=r.predictForPersonSegmentationAndPart(l),t=e.segmentLogits,i=e.partHeatmapLogits,s=e.heatmapScores,u=e.offsets,p=e.displacementFwd,d=e.displacementBwd,h=l.shape,f=h[0],g=h[1],m=UN(t,[o,a],[f,g],[[c.top,c.bottom],[c.left,c.right]],!0),y=UN(i,[o,a],[f,g],[[c.top,c.bottom],[c.left,c.right]],!0);return{partSegmentation:nN(tN((0,O.squeeze)(m),n),y),heatmapScores:s,offsets:u,displacementFwd:p,displacementBwd:d}})),d=p.partSegmentation,h=p.heatmapScores,f=p.offsets,g=p.displacementFwd,m=p.displacementBwd;return l.dispose(),{partSegmentation:d,heatmapScores:h,offsets:f,displacementFwd:g,displacementBwd:m,padding:c,internalResolutionHeightAndWidth:s}},e.prototype.segmentPersonParts=function(e,t){return void 0===t&&(t=ZN),VR(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,l,c,p,d,h,f,g,m,y,b,v;return HR(this,(function(x){switch(x.label){case 0:return eD(t=WR(WR({},ZN),t)),n=this.segmentPersonPartsActivation(e,t.internalResolution,t.segmentationThreshold),r=n.partSegmentation,i=n.heatmapScores,o=n.offsets,a=n.displacementFwd,s=n.displacementBwd,u=n.padding,l=n.internalResolutionHeightAndWidth,c=r.shape,p=c[0],d=c[1],[4,r.data()];case 1:return h=x.sent(),r.dispose(),[4,VN([i,o,a,s])];case 2:return f=x.sent(),g=f[0],m=f[1],y=f[2],b=f[3],v=HN(v=RN(g,m,y,b,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[p,d],l,u,!1),i.dispose(),o.dispose(),a.dispose(),s.dispose(),[2,{height:p,width:d,data:h,allPoses:v}]}}))}))},e.prototype.segmentMultiPersonParts=function(e,t){return void 0===t&&(t=QN),VR(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,l,c,p,d,h,f,g,m,y,b,v,x,_,w,k,S=this;return HR(this,(function(C){switch(C.label){case 0:return tD(t=WR(WR({},QN),t)),n=PN(e),r=n[0],i=n[1],o=GN(t.internalResolution,this.baseModel.outputStride,[r,i]),a=WN(e,o),s=a.resized,u=a.padding,l=(0,O.tidy)((function(){var e=S.predictForMultiPersonInstanceSegmentationAndPart(s),n=e.segmentLogits,a=e.longOffsets,l=e.heatmapScores,c=e.offsets,p=e.displacementFwd,d=e.displacementBwd,h=e.partHeatmaps,f=UN(n,[r,i],o,[[u.top,u.bottom],[u.left,u.right]],!0),g=UN(h,[r,i],o,[[u.top,u.bottom],[u.left,u.right]],!0),m=a,y=tN((0,O.squeeze)(f),t.segmentationThreshold),b=function(e){var t=e.shape,n=t[0],r=t[1],i=t[2];return(0,O.tidy)((function(){var t=eN(e),o=(0,O.expandDims)((0,O.range)(0,i,1,"int32"),1),a=(0,O.cast)((0,O.matMul)(t,o),"int32");return(0,O.reshape)(a,[n,r])}))}(g);return{segmentation:y,longOffsets:m,heatmapScoresRaw:l,offsetsRaw:c,displacementFwdRaw:p,displacementBwdRaw:d,partSegmentation:b}})),c=l.segmentation,p=l.longOffsets,d=l.heatmapScoresRaw,h=l.offsetsRaw,f=l.displacementFwdRaw,g=l.displacementBwdRaw,m=l.partSegmentation,[4,VN([d,h,f,g])];case 1:return y=C.sent(),b=y[0],v=y[1],x=y[2],_=y[3],w=HN(w=RN(b,v,x,_,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[r,i],o,u,!1),[4,xN(c,p,m,w,r,i,this.baseModel.outputStride,o,u,t.scoreThreshold,t.refineSteps,t.minKeypointScore,t.maxDetections)];case 2:return k=C.sent(),s.dispose(),c.dispose(),p.dispose(),d.dispose(),h.dispose(),f.dispose(),g.dispose(),m.dispose(),[2,k]}}))}))},e.prototype.dispose=function(){this.baseModel.dispose()},e}();function rD(e){return VR(this,void 0,void 0,(function(){var t,n,r,i,o,a;return HR(this,(function(s){switch(s.label){case 0:if(t=e.outputStride,n=e.quantBytes,r=e.multiplier,null==O)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this\n        model.");return i=function(e,t,n){var r={1:"100",.75:"075",.5:"050"},i="model-stride"+e+".json";return 4===n?LN+"float/"+r[t]+"/"+i:LN+"quant"+n+"/"+r[t]+"/"+i}(t,r,n),[4,gd(e.modelUrl||i)];case 1:return o=s.sent(),a=new iN(o,t),[2,new nD(a)]}}))}))}function iD(e){return VR(this,void 0,void 0,(function(){var t,n,r,i,o;return HR(this,(function(a){switch(a.label){case 0:if(t=e.outputStride,n=e.quantBytes,null==O)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this\n        model.");return r=function(e,t){var n="model-stride"+e+".json";return 4===t?BN+"float/"+n:BN+"quant"+t+"/"+n}(t,n),[4,gd(e.modelUrl||r)];case 1:return i=a.sent(),o=new IN(i,t),[2,new nD(o)]}}))}))}function oD(e){return void 0===e&&(e=qN),VR(this,void 0,void 0,(function(){return HR(this,(function(t){return"ResNet50"===(e=function(e){if(null==(e=e||qN).architecture&&(e.architecture="MobileNetV1"),XN.indexOf(e.architecture)<0)throw new Error("Invalid architecture "+e.architecture+". Should be one of "+XN);if(null==e.outputStride&&(e.outputStride=16),YN[e.architecture].indexOf(e.outputStride)<0)throw new Error("Invalid outputStride "+e.outputStride+". Should be one of "+YN[e.architecture]+" for architecture "+e.architecture+".");if(null==e.multiplier&&(e.multiplier=1),KN[e.architecture].indexOf(e.multiplier)<0)throw new Error("Invalid multiplier "+e.multiplier+". Should be one of "+KN[e.architecture]+" for architecture "+e.architecture+".");if(null==e.quantBytes&&(e.quantBytes=4),JN.indexOf(e.quantBytes)<0)throw new Error("Invalid quantBytes "+e.quantBytes+". Should be one of "+JN+" for architecture "+e.architecture+".");return e}(e)).architecture?[2,iD(e)]:"MobileNetV1"===e.architecture?[2,rD(e)]:[2,null]}))}))}var aD=["left_face","right_face","left_upper_arm_front","left_upper_arm_back","right_upper_arm_front","right_upper_arm_back","left_lower_arm_front","left_lower_arm_back","right_lower_arm_front","right_lower_arm_back","left_hand","right_hand","torso_front","torso_back","left_upper_leg_front","left_upper_leg_back","right_upper_leg_front","right_upper_leg_back","left_lower_leg_front","left_lower_leg_back","right_lower_leg_front","right_lower_leg_back","left_feet","right_feet"],sD=function(){function e(e){this.mask=e}return e.prototype.toCanvasImageSource=function(){return VR(this,void 0,void 0,(function(){return HR(this,(function(e){return[2,XR(this.mask)]}))}))},e.prototype.toImageData=function(){return VR(this,void 0,void 0,(function(){return HR(this,(function(e){return[2,this.mask]}))}))},e.prototype.toTensor=function(){return VR(this,void 0,void 0,(function(){return HR(this,(function(e){return[2,KR(this.mask)]}))}))},e.prototype.getUnderlyingType=function(){return"imagedata"},e}();function uD(e){if(JR(e),255!==e)throw new Error("Foreground id must be 255 but got "+e);return"person"}function lD(e){if(JR(e),e>=aD.length)throw new Error("Invalid body part value "+e);return aD[e]}var cD=function(){function e(e){this.bodyPixModel=e}return e.prototype.segmentPeople=function(e,t){return VR(this,void 0,void 0,(function(){var n,r,i,o;return HR(this,(function(a){switch(a.label){case 0:return e instanceof ImageBitmap&&((n=document.createElement("canvas")).getContext("2d").drawImage(e,0,0),e=n),t.segmentBodyParts?t.multiSegmentation?[4,this.bodyPixModel.segmentMultiPersonParts(e,t)]:[3,2]:[3,5];case 1:return i=a.sent(),[3,4];case 2:return[4,this.bodyPixModel.segmentPersonParts(e,t)];case 3:i=[a.sent()],a.label=4;case 4:return r=i.map((function(e){var t=e.data,n=e.width,r=e.height,i=new Uint8ClampedArray(n*r*4).fill(0);return t.forEach((function(e,t){-1===e?(i[4*t]=aD.length,i[4*t+3]=0):(i[4*t]=e,i[4*t+3]=255)})),{maskValueToLabel:lD,mask:new sD(new ImageData(i,n,r))}})),[3,10];case 5:return t.multiSegmentation?[4,this.bodyPixModel.segmentMultiPerson(e,t)]:[3,7];case 6:return o=a.sent(),[3,9];case 7:return[4,this.bodyPixModel.segmentPerson(e,t)];case 8:o=[a.sent()],a.label=9;case 9:r=o.map((function(e){var t=e.data,n=e.width,r=e.height,i=new Uint8ClampedArray(n*r*4).fill(0);return t.forEach((function(e,t){0===e?(i[4*t]=0,i[4*t+3]=0):(i[4*t]=255,i[4*t+3]=255)})),{maskValueToLabel:uD,mask:new sD(new ImageData(i,n,r))}})),a.label=10;case 10:return[2,r]}}))}))},e.prototype.dispose=function(){this.bodyPixModel.dispose()},e.prototype.reset=function(){},e}();function pD(e){return VR(this,void 0,void 0,(function(){return HR(this,(function(t){return[2,oD(e).then((function(e){return new cD(e)}))]}))}))}var dD={runtime:"mediapipe",modelType:"general"},hD=function(){function e(e){this.mask=e}return e.prototype.toCanvasImageSource=function(){return VR(this,void 0,void 0,(function(){return HR(this,(function(e){return[2,this.mask]}))}))},e.prototype.toImageData=function(){return VR(this,void 0,void 0,(function(){return HR(this,(function(e){return[2,YR(this.mask)]}))}))},e.prototype.toTensor=function(){return VR(this,void 0,void 0,(function(){return HR(this,(function(e){return[2,KR(this.mask)]}))}))},e.prototype.getUnderlyingType=function(){return"canvasimagesource"},e}();function fD(e){return JR(e),"person"}var gD=function(){function e(e){var t,n,r=this;this.selfieMode=!1,this.selfieSegmentationSolution=new jR.SelfieSegmentation({locateFile:null!==(t=e.locateFile)&&void 0!==t?t:function(t,n){return e.solutionPath?e.solutionPath.replace(/\/+$/,"")+"/"+t:n+"/"+t}}),n="landscape"===e.modelType?1:0,this.selfieSegmentationSolution.setOptions({modelSelection:n,selfieMode:this.selfieMode}),this.selfieSegmentationSolution.onResults((function(e){r.segmentation=[{maskValueToLabel:fD,mask:new hD(e.segmentationMask)}]}))}return e.prototype.segmentPeople=function(e,t){return VR(this,void 0,void 0,(function(){var n,r;return HR(this,(function(i){switch(i.label){case 0:return t&&t.flipHorizontal&&t.flipHorizontal!==this.selfieMode&&(this.selfieMode=t.flipHorizontal,this.selfieSegmentationSolution.setOptions({selfieMode:this.selfieMode})),e instanceof O.Tensor?(r=ImageData.bind,[4,O.browser.toPixels(e)]):[3,2];case 1:return n=new(r.apply(ImageData,[void 0,i.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:n=e,i.label=3;case 3:return e=n,[4,this.selfieSegmentationSolution.send({image:e})];case 4:return i.sent(),[2,this.segmentation]}}))}))},e.prototype.dispose=function(){this.selfieSegmentationSolution.close()},e.prototype.reset=function(){this.selfieSegmentationSolution.reset(),this.segmentation=null,this.selfieMode=!1},e.prototype.initialize=function(){return this.selfieSegmentationSolution.initialize()},e}();function mD(e){return VR(this,void 0,void 0,(function(){var t,n;return HR(this,(function(r){switch(r.label){case 0:return t=function(e){if(null==e)return WR({},dD);var t=WR({},e);return t.runtime="mediapipe",null==t.modelType&&(t.modelType=dD.modelType),t}(e),[4,(n=new gD(t)).initialize()];case 1:return r.sent(),[2,n]}}))}))}function yD(e){return e instanceof O.Tensor?{height:e.shape[0],width:e.shape[1]}:{height:e.height,width:e.width}}function bD(e,t){O.util.assert(0!==e.width,(function(){return t+" width cannot be 0."})),O.util.assert(0!==e.height,(function(){return t+" height cannot be 0."}))}var vD={runtime:"tfjs",modelType:"general",modelUrl:"https://tfhub.dev/mediapipe/tfjs-model/selfie_segmentation/general/1"},xD={flipHorizontal:!1},_D={outputTensorSize:{width:256,height:256},keepAspectRatio:!1,borderMode:"zero",outputTensorFloatRange:[0,1]},wD={outputTensorSize:{width:256,height:144},keepAspectRatio:!1,borderMode:"zero",outputTensorFloatRange:[0,1]},kD={activation:"none"},SD=function(){function e(e){this.mask=e}return e.prototype.toCanvasImageSource=function(){return VR(this,void 0,void 0,(function(){return HR(this,(function(e){return[2,XR(this.mask)]}))}))},e.prototype.toImageData=function(){return VR(this,void 0,void 0,(function(){return HR(this,(function(e){return[2,YR(this.mask)]}))}))},e.prototype.toTensor=function(){return VR(this,void 0,void 0,(function(){return HR(this,(function(e){return[2,this.mask]}))}))},e.prototype.getUnderlyingType=function(){return"tensor"},e}();function CD(e){return JR(e),"person"}var MD,TD,ED=function(){function e(e,t){this.modelType=e,this.model=t}return e.prototype.segmentPeople=function(e,t){return VR(this,void 0,void 0,(function(){var n,r=this;return HR(this,(function(i){return t=function(e){if(null==e)return WR({},xD);var t=WR({},e);return null==t.flipHorizontal&&(t.flipHorizontal=xD.flipHorizontal),t}(t),null==e?(this.reset(),[2,[]]):(n=(0,O.tidy)((function(){var t=function(e,t,n){var r=t.outputTensorSize,i=t.keepAspectRatio,o=t.borderMode,a=t.outputTensorFloatRange,s=yD(e),u=function(e,t){return t?{xCenter:t.xCenter*e.width,yCenter:t.yCenter*e.height,width:t.width*e.width,height:t.height*e.height,rotation:t.rotation}:{xCenter:.5*e.width,yCenter:.5*e.height,width:e.width,height:e.height,rotation:0}}(s,n),l=function(e,t,n){if(void 0===n&&(n=!1),!n)return{top:0,left:0,right:0,bottom:0};var r=t.height,i=t.width;bD(t,"targetSize"),bD(e,"roi");var o,a,s=r/i,u=e.height/e.width,l=0,c=0;return s>u?(o=e.width,a=e.width*s,c=(1-u/s)/2):(o=e.height/s,a=e.height,l=(1-s/u)/2),e.width=o,e.height=a,{top:c,left:l,right:l,bottom:c}}(u,r,i),c=function(e,t,n,r){var i=e.width,o=e.height,a=Math.cos(e.rotation),s=Math.sin(e.rotation),u=e.xCenter,l=e.yCenter,c=1/t,p=1/n,d=new Array(16);return d[0]=i*a*1*c,d[1]=-o*s*c,d[2]=0,d[3]=(-.5*i*a*1+.5*o*s+u)*c,d[4]=i*s*1*p,d[5]=o*a*p,d[6]=0,d[7]=(-.5*o*a-.5*i*s*1+l)*p,d[8]=0,d[9]=0,d[10]=i*c,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,function(e){if(16!==e.length)throw new Error("Array length must be 16 but got "+e.length);return[[e[0],e[1],e[2],e[3]],[e[4],e[5],e[6],e[7]],[e[8],e[9],e[10],e[11]],[e[12],e[13],e[14],e[15]]]}(d)}(u,s.width,s.height),p=(0,O.tidy)((function(){var t,n=(t=e)instanceof O.Tensor?t:O.browser.fromPixels(t),i=(0,O.tensor2d)(function(e,t,n){return bD(n,"inputResolution"),[1/n.width*e[0][0]*t.width,1/n.height*e[0][1]*t.width,e[0][3]*t.width,1/n.width*e[1][0]*t.height,1/n.height*e[1][1]*t.height,e[1][3]*t.height,0,0]}(c,s,r),[1,8]),u="zero"===o?"constant":"nearest",l=O.image.transform((0,O.expandDims)((0,O.cast)(n,"float32")),i,"bilinear",u,0,[r.height,r.width]);return null!=a?function(e,t){var n=function(e,t,n,r){var i=(r-n)/255;return{scale:i,offset:n-0*i}}(0,0,t[0],t[1]);return(0,O.tidy)((function(){return(0,O.add)((0,O.mul)(e,n.scale),n.offset)}))}(l,a):l}));return{imageTensor:p,padding:l,transformationMatrix:c}}(e,"general"===r.modelType?_D:wD).imageTensor,n=(0,O.slice)(r.model.predict(t),[0,0,0,1],-1),i=yD(e),o=function(e,t,n){return(0,O.tidy)((function(){var r=(0,O.squeeze)(e,[0]),i=r.shape[2];if(1===i){var o=r;switch(t.activation){case"none":break;case"sigmoid":o=(0,O.sigmoid)(o);break;case"softmax":throw new Error("Softmax activation requires two channels.");default:throw new Error("Activation not supported ("+t.activation+")")}var a=n?O.image.resizeBilinear(o,[n.height,n.width]):o;return(0,O.squeeze)(a,[2])}throw new Error("Unsupported number of tensor channels "+i)}))}(n,kD,i),a=(0,O.expandDims)(o,2),s=(0,O.pad)(a,[[0,0],[0,0],[0,1]]);return(0,O.mirrorPad)(s,[[0,0],[0,0],[0,2]],"symmetric")})),[2,[{maskValueToLabel:CD,mask:new SD(n)}]])}))}))},e.prototype.dispose=function(){this.model.dispose()},e.prototype.reset=function(){},e}();function AD(e){return VR(this,void 0,void 0,(function(){var t,n,r;return HR(this,(function(i){switch(i.label){case 0:return t=function(e){if(null==e)return WR({},vD);var t=WR({},e);if(t.runtime="tfjs",null==t.modelType&&(t.modelType=vD.modelType),"general"!==t.modelType&&"landscape"!==t.modelType)throw new Error("Model type must be one of general or landscape, but got "+t.modelType);return null==t.modelUrl&&("general"===t.modelType?t.modelUrl="https://tfhub.dev/mediapipe/tfjs-model/selfie_segmentation/general/1":t.modelUrl="https://tfhub.dev/mediapipe/tfjs-model/selfie_segmentation/landscape/1"),t}(e),n="string"==typeof t.modelUrl&&t.modelUrl.indexOf("https://tfhub.dev")>-1,[4,gd(t.modelUrl,{fromTFHub:n})];case 1:return r=i.sent(),[2,new ED(t.modelType,r)]}}))}))}function FD(e,t,n,r,i,o){void 0===o&&(o={r:0,g:255,b:255,a:255});for(var a=-i;a<=i;a++)for(var s=-i;s<=i;s++)if(0!==a&&0!==s){var u=(t+a)*r+(n+s);e[4*u+0]=o.r,e[4*u+1]=o.g,e[4*u+2]=o.b,e[4*u+3]=o.a}}function OD(e,t,n,r,i,o,a){void 0===a&&(a=1);for(var s=0,u=-a;u<=a;u++)for(var l=-a;l<=a;l++)if(0!==u&&0!==l){var c=(t+u)*r+(n+l);(!i[e[4*c]]||e[4*c+3]<o)&&(s+=1)}return s>0}function RD(e,t,n,r,i,o){return void 0===t&&(t={r:0,g:0,b:0,a:0}),void 0===n&&(n={r:0,g:0,b:0,a:255}),void 0===r&&(r=!1),void 0===i&&(i=.5),void 0===o&&(o=Array.from(Array(256).keys())),VR(this,void 0,void 0,(function(){var a,s,u,l,c,p,d,h,f,g,m,y,b,v;return HR(this,(function(x){switch(x.label){case 0:return 0===(a=Array.isArray(e)?e:[e]).length?[2,null]:[4,Promise.all(a.map((function(e){return e.mask.toImageData()})))];case 1:for(s=x.sent(),u=s[0],l=u.width,c=u.height,p=new Uint8ClampedArray(l*c*4),d=Math.round(255*i),h=new Array(256).fill(!1),o.forEach((function(e){return h[e]=!0})),f=0;f<c;f++)for(g=0;g<l;g++)for(p[4*(m=f*l+g)+0]=n.r,p[4*m+1]=n.g,p[4*m+2]=n.b,p[4*m+3]=n.a,y=0,b=s;y<b.length;y++)v=b[y],h[v.data[4*m]]&&v.data[4*m+3]>=d&&(p[4*m]=t.r,p[4*m+1]=t.g,p[4*m+2]=t.b,p[4*m+3]=t.a,r&&f-1>=0&&f+1<c&&g-1>=0&&g+1<l&&OD(v.data,f,g,l,h,d)&&FD(p,f,g,l,1));return[2,new ImageData(p,l,c)]}}))}))}async function ND(e){const t=e.height,n=e.width,r=await FR.ImageDataToBlob(e,n,t);return{segmentationResult:e,blob:r,image:await FR.blobToP5Image(r)}}(TD=MD||(MD={})).BodyPix="BodyPix",TD.MediaPipeSelfieSegmentation="MediaPipeSelfieSegmentation";const DD={leftFace:{id:0,color:[110,64,170]},rightFace:{id:1,color:[143,61,178]},leftUpperArmFront:{id:2,color:[178,60,178]},leftUpperArmBack:{id:3,color:[210,62,167]},rightUpperArmFront:{id:4,color:[238,67,149]},rightUpperArmBack:{id:5,color:[255,78,125]},leftLowerArmFront:{id:6,color:[255,94,99]},leftLowerArmBack:{id:7,color:[255,115,75]},rightLowerArmFront:{id:8,color:[255,140,56]},rightLowerArmBack:{id:9,color:[239,167,47]},leftHand:{id:10,color:[217,194,49]},rightHand:{id:11,color:[194,219,64]},torsoFront:{id:12,color:[175,240,91]},torsoBack:{id:13,color:[135,245,87]},leftUpperLegFront:{id:14,color:[96,247,96]},leftUpperLegBack:{id:15,color:[64,243,115]},rightUpperLegFront:{id:16,color:[40,234,141]},rightUpperLegBack:{id:17,color:[28,219,169]},leftLowerLegFront:{id:18,color:[26,199,194]},leftLowerLegBack:{id:19,color:[33,176,213]},rightLowerLegFront:{id:20,color:[47,150,224]},rightLowerLegBack:{id:21,color:[65,125,224]},leftFoot:{id:22,color:[84,101,214]},rightFoot:{id:23,color:[99,81,195]}};class ID extends IR.EventEmitter{constructor(e,t,n){super(),this.p5PreLoadExists()&&window._incrementPreload(),this.video=e,this.model=null,this.modelReady=!1,this.config=t,this.ready=SR(this.loadModel(),n)}async loadModel(){const e=MD.BodyPix,t={architecture:this.config?.architecture??"ResNet50",multiplier:this.config?.multiplier??1,outputStride:this.config?.outputStride??16,quantBytes:this.config?.quantBytes??2};return await O.setBackend("webgl"),this.model=await function(e,t){return VR(this,void 0,void 0,(function(){var n,r;return HR(this,(function(i){switch(e){case MD.MediaPipeSelfieSegmentation:if(n=void 0,null!=(r=t)){if("tfjs"===r.runtime)return[2,AD(r)];if("mediapipe"===r.runtime)return[2,mD(r)];n=r.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got "+n);case MD.BodyPix:return[2,pD(r=t)];default:throw new Error(e+" is not a supported model name.")}}))}))}(e,t),this.modelReady=!0,this.video&&this.segment(),this.p5PreLoadExists&&window._decrementPreload(),this}async segment(e,t){const{image:n,callback:r}=GF(this.video,e,t);if(!n)throw new Error("No input image provided. If you want to classify a video, pass the video element in the constructor.");await RR(n,!1);const i={multiSegmentation:this.config?.multiSegmentation??!1,segmentBodyParts:this.config?.segmentBodyParts??!0,flipHorizontal:this.config?.flipHorizontal??!1},o=await this.model.segmentPeople(n,i),a={segmentation:o,raw:{personMask:null,backgroundMask:null,partMask:null},personMask:null,backgroundMask:null,partMask:null,tensor:null,bodyParts:DD};a.raw.personMask=await RD(o,{r:0,g:0,b:0,a:255},{r:0,g:0,b:0,a:0}),a.raw.backgroundMask=await RD(o),this.config.segmentBodyParts&&(a.raw.partMask=await function(e,t,n,r){return void 0===n&&(n={r:0,g:0,b:0,a:255}),void 0===r&&(r=.5),VR(this,void 0,void 0,(function(){var i,o,a,s,u,l,c,p,d,h,f,g,m,y;return HR(this,(function(b){switch(b.label){case 0:return 0===(i=Array.isArray(e)?e:[e]).length?[2,null]:[4,Promise.all(i.map((function(e){return e.mask.toImageData()})))];case 1:for(o=b.sent(),a=o[0],s=a.width,u=a.height,l=new Uint8ClampedArray(s*u*4),c=Math.round(255*r),p=0;p<u*s;++p)for(l[0+(d=4*p)]=n.r,l[d+1]=n.g,l[d+2]=n.b,l[d+3]=n.a,h=0,f=o;h<f.length;h++)(g=f[h]).data[d+3]>=c&&(m=g.data[d],y=t(m),l[d+0]=y.r,l[d+1]=y.g,l[d+2]=y.b,l[d+3]=y.a);return[2,new ImageData(l,s,u)]}}))}))}(o,QR,{r:255,g:255,b:255,a:255})),this.config.returnTensors&&(a.tensor=await o[0].mask.toTensor());const s=await ND(a.raw.personMask),u=await ND(a.raw.backgroundMask),l=await ND(a.raw.partMask);return a.personMask=s.image||a.raw.personMask,a.backgroundMask=u.image||a.raw.backgroundMask,a.partMask=l.image||a.raw.partMask,this.emit("bodypix",a),this.video?O.nextFrame().then((()=>this.segment())):("function"==typeof r&&r(a),a)}p5PreLoadExists(){return"undefined"!=typeof window&&void 0!==window.p5&&void 0!==window.p5.prototype&&void 0!==window.p5.prototype.registerPreloadMethod}}const BD=Object.assign({p5Utils:FR},{tf:F,tfvis:AR,neuralNetwork:(e,t,n)=>{let r,i;return e instanceof Object?(r=e,i=t):(r={inputs:e,outputs:t},i=n),new DR(r,i)},poseDetection:(...e)=>{const{video:t,options:n={},callback:r}=GF(...e);return new zR(t,n,r)},setBackend:function(e){switch(e){case"cpu":O.setBackend("cpu");break;case"webgl":O.setBackend("webgl");break;case"webgpu":O.setBackend("webgpu");break;default:throw new Error(`Invalid backend: ${e}. The backend parameter must be set to one of the following strings: "cpu", "webgl", or "webgpu".`)}return!0},bodyPix:(...e)=>{const{video:t,options:n={},callback:r}=GF(...e);return new ID(t,n,r)}})})(),__webpack_exports__=__webpack_exports__.default,__webpack_exports__})()));
//# sourceMappingURL=ml5.js.map